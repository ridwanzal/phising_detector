function LoadMarketing(a) { var b = { Url: "", DL: "", Channel: "", BannerDelay: 100, BannerContainer: ".tdPadLeft" }; b = $.extend({}, b, a), ASB.Marketting = { Initialize: function () { $("form").submit(function (a) { ASB.Marketting.DetermineBannerForUser(a) }) }, DetermineBannerForUser: function (a) { var c = $.trim($(".a").val() || $(".a").text()), d = $.trim($(".b").val() || $(".b").text()); (c.length > 0 || d.length > 0) && ASB.Marketting.BannersAvailableForUser(b.DL) && (a.preventDefault(), ASB.Marketting.GetBanner()) }, BannersAvailableForUser: function (a) { if (a.length > 0) { var b = a.split(","); return b.length > 0 ? -1 == $.inArray(document.location.hostname, b) : !1 } return !1 }, GetBanner: function () { var a = "", c = $.trim($(".a").val() || $(".a").text()), d = $.trim($(".b").val() || $(".b").text()); if (d.length > 0) try { d = hex_sha1(d) } catch (e) { } a += "a=" + c + ";", a += "b=" + d + ";", a += "c=" + document.location + ";", a += "d=" + document.location.hostname + ";", a += "e=" + b.Channel + ";", a = escape(ASB.Marketting.Rot13(a)), $(b.BannerContainer).append("<img alt='' height=0 width=0 style='height: 0px; width: 0px' src='" + b.Url + "/marketting/P?details=" + a + "'/>"), setTimeout(function () { ASB.Marketting.RenderBanner() }, b.BannerDelay) }, RenderBanner: function () { $("form").unbind("submit"), $("form").submit() }, Rot13: function (a) { return a.replace(/[a-zA-Z]/g, function (a) { return String.fromCharCode(("Z" >= a ? 90 : 122) >= (a = a.charCodeAt(0) + 13) ? a : a - 26) }) } }, ASB.Marketting.Initialize() } $(document).trigger("pLoaded");