var megamenuResized=false;var bannerFunctions=new (function _bannerFunctions(){var bannerInterval=null,bannerTimeout=null;var SLIDES=5;var DISPLAY_TIME=7000;var TRANSITION_TIME=250;var dir=1;var step=1;this.setSlideCount=function(count){SLIDES=count;if(count<2){document.getElementById("banner-circles").style.display="none"}};this.setStep=function(newstep){switch(newstep){case 1:case -1:if(newstep!==step){window.clearTimeout(bannerTimeout);window.clearInterval(bannerInterval);step=newstep;dir=newstep;var ele=document.getElementById("banners");this.gotoSlide((+ele.className.substr(6,1)+step+SLIDES)%SLIDES)}}};this.gotoSlideFade=function(n,longDelay){var nprev,nnew;var pos=0;if(SLIDES<2){return}window.clearInterval(bannerInterval);window.clearTimeout(bannerTimeout);var ele=document.getElementById("banners");if(n===undefined){nprev=+ele.className.substr(6,1);nnew=(nprev+step+SLIDES)%SLIDES}else{nprev=+ele.className.substr(6,1);if(n<0){nnew=(nprev-1+SLIDES)%SLIDES}else{nnew=n}if(nprev===nnew){document.getElementById("banner"+nnew).style.zIndex=11;ele.className="banner"+n;window.setTimeout(function(){bannerFunctions.gotoSlide()},DISPLAY_TIME);return}}document.getElementById("banner"+nprev).style.opacity=1;document.getElementById("banner"+nprev).style.filter="alpha(opacity=100)";document.getElementById("banner"+nprev).style.zIndex=10;document.getElementById("banner"+nnew).style.opacity=0;document.getElementById("banner"+nnew).style.filter="alpha(opacity=0)";document.getElementById("banner"+nnew).style.zIndex=11;ele.className="banner"+nnew+" banner"+nprev;bannerInterval=window.setInterval(function(){var tmp=pos;document.getElementById("banner"+nnew).style.opacity=(tmp/100);document.getElementById("banner"+nnew).style.filter="alpha(opacity="+tmp+")";pos+=2.5;if(pos>100){window.clearInterval(bannerInterval);ele.className="banner"+nnew;bannerTimeout=window.setTimeout(function(){bannerFunctions.gotoSlide()},DISPLAY_TIME+(longDelay?DISPLAY_TIME:0))}},TRANSITION_TIME/40)};this.gotoSlideOrig=function(n,longDelay){if(SLIDES<2){return}window.clearInterval(bannerInterval);var ele=document.getElementById("banners");if(n===undefined){n=(+ele.className.substr(6)+1)%SLIDES}ele.className="banner"+n;bannerInterval=window.setInterval(function(){bannerFunctions.gotoSlide()},DISPLAY_TIME)};this.gotoSlideHoriz=function(n,longDelay){var nprev,nnew;var pos=0;var ele=document.getElementById("banners");if(SLIDES<2){return}window.clearInterval(bannerInterval);window.clearTimeout(bannerTimeout);if(n===undefined){nprev=+ele.className.substr(6,1);nnew=(nprev+step+SLIDES)%SLIDES}else{nprev=+ele.className.substr(6,1);if(n<0){nnew=(nprev-1+SLIDES)%SLIDES}else{nnew=n}if(nprev===nnew){ele.className="banner"+n;if(SLIDES>1){window.setTimeout(function(){bannerFunctions.gotoSlide()},DISPLAY_TIME+(longDelay?DISPLAY_TIME:0))}return}}document.getElementById("banner"+nprev).style.left="0%";document.getElementById("banner"+nnew).style.left="100%";document.getElementById("banner"+nprev).style.zIndex=10;document.getElementById("banner"+nnew).style.zIndex=20;ele.className="banner"+nnew+" banner"+nprev;bannerInterval=window.setInterval(function(){var tmp=100*Math.sin(pos/100*Math.PI/2);if(dir===+1){document.getElementById("banner"+nprev).style.left=-tmp+"%";document.getElementById("banner"+nnew).style.left=(100-tmp)+"%"}else{document.getElementById("banner"+nprev).style.left=tmp+"%";document.getElementById("banner"+nnew).style.left=-(100-tmp)+"%"}pos++;if(pos>100){window.clearInterval(bannerInterval);ele.className="banner"+nnew;if(SLIDES>1){bannerTimeout=window.setTimeout(function(){bannerFunctions.gotoSlide()},DISPLAY_TIME+(longDelay?DISPLAY_TIME:0))}}},TRANSITION_TIME/100)};this.gotoSlideVert=function(n,longDelay){var nprev,nnew;var pos=0;if(SLIDES<2){return}window.clearInterval(bannerInterval);window.clearTimeout(bannerTimeout);var ele=document.getElementById("banners");if(n===undefined){nprev=+ele.className.substr(6,1);nnew=(nprev+step+SLIDES)%SLIDES}else{nprev=+ele.className.substr(6,1);if(n<0){nnew=(nprev-1+SLIDES)%SLIDES}else{nnew=n}if(nprev===nnew){ele.className="banner"+n;window.setTimeout(function(){bannerFunctions.gotoSlide()},DISPLAY_TIME);return}}document.getElementById("banner"+nprev).style.top="0%";document.getElementById("banner"+nnew).style.top="100%";document.getElementById("banner"+nprev).style.zIndex=10;document.getElementById("banner"+nnew).style.zIndex=20;ele.className="banner"+nnew+" banner"+nprev;bannerInterval=window.setInterval(function(){var tmp=100*Math.sin(pos/100*Math.PI/2);if(dir===+1){document.getElementById("banner"+nprev).style.top=-tmp+"%";document.getElementById("banner"+nnew).style.top=(100-tmp)+"%"}else{document.getElementById("banner"+nprev).style.top=tmp+"%";document.getElementById("banner"+nnew).style.top=-(100-tmp)+"%"}pos++;if(pos>100){window.clearInterval(bannerInterval);ele.className="banner"+nnew;bannerTimeout=window.setTimeout(function(){bannerFunctions.gotoSlide()},DISPLAY_TIME)}},TRANSITION_TIME/100)};this.gotoSlide=this.gotoSlideFade})();var utilityFunctions=new (function _utilityFunctions(){this.setTextSize=function(iSize){try{if(iSize===null){iSize=0}document.getElementById("textSizeLink").href="/ca/textsize-"+iSize+".css";setCookie("CIBC_TextSize",iSize);var buttonId="textsize"+iSize;$(".letterButton#"+buttonId).addClass("on");$(".letterButton:not(#"+buttonId+")").removeClass("on");$("body").removeClass("text0 text1 text2 text3");$("body").addClass("text"+iSize);event.preventDefault()}catch(err){}window.setTimeout(adjustMegamenu,300)};this.setContrast=function(b){document.body.className=document.body.className.replace(/contrast\d/,"contrast"+b);setCookie("CIBC_Contrast",b)};this.gotoSpotlightPage=function(n){var ele=document.getElementById("spotlightLink"+n);if(ele){document.location=ele.href}};this.closeOlbMessage=function(){var TIME=1000;$("#olb-message").slideUp(TIME);document.getElementById("pswPassword").focus()};var currentMenupaneId=null;this.hideMenupane=function(evt,ele){try{var ele2=document.getElementById("menubar-list");ele2.className="no-bullets";currentMenupaneId=null}catch(e){}};this.displayMenupane=function(evt,ele){try{evt=evt||window.event;var ele2=document.getElementById("menubar-list");var curCN=ele2.className;if(currentMenupaneId===ele.parentNode.parentNode.id){return}var newCN="no-bullets "+ele.parentNode.parentNode.id;currentMenupaneId=ele.parentNode.parentNode.id;ele2.className=(curCN===newCN?"no-bullets":newCN);if(evt){evt.cancelBubble=true;if(evt.stopPropagation){evt.stopPropagation()}evt.preventDefault()}}catch(e){}};this.setFocus=function(href){var ele=document.getElementById(href.replace(/^.*#/,""));if(ele){ele.focus()}};this.showOtherSites=function(evt){evt=evt||window.event;var ele=document.getElementById("other-sites");if(!ele){return}if(ele.className==="no-bullets"){ele.className="no-bullets show-hidden-items"}else{ele.className="no-bullets"}evt.cancelBubble=true;if(evt.stopPropagation){evt.stopPropagation()}};$("#other-sites-link").bind("click",function(evt){utilityFunctions.showOtherSites(evt);return false})})();function addHandler(whichEvent,whichObject,attachThis){try{whichObject.addEventListener(whichEvent,attachThis,0)}catch(e){whichObject.attachEvent("on"+whichEvent,attachThis)}}function setSessionCookie(cookieName,cookieValue,cookiePath,cookieDomain){cookieValue=escape(cookieValue);if(cookiePath===""||cookiePath===null||cookiePath===undefined){cookiePath="; path=/"}else{cookiePath="; path="+cookiePath}if(cookieDomain===""||cookieDomain===null||cookieDomain===undefined){cookieDomain=""}else{cookieDomain="; domain="+cookieDomain}document.cookie=cookieName+"="+cookieValue+";"+cookiePath+cookieDomain}function getCookieValue(cookieName){var cookieValue=document.cookie;var cookieStartsAt=cookieValue.indexOf(" "+cookieName+"=");if(cookieStartsAt==-1){cookieStartsAt=cookieValue.indexOf(cookieName+"=")}if(cookieStartsAt==-1){cookieValue=null}else{cookieStartsAt=cookieValue.indexOf("=",cookieStartsAt)+1;var cookieEndsAt=cookieValue.indexOf(";",cookieStartsAt);if(cookieEndsAt==-1){cookieEndsAt=cookieValue.length}cookieValue=unescape(cookieValue.substring(cookieStartsAt,cookieEndsAt))}return cookieValue}function setCookie(cookieName,cookieValue,cookieExpires,cookiePath,cookieDomain){cookieValue=escape(cookieValue);if(cookieExpires===""||cookieExpires===null||cookieExpires===undefined){var nowDate=new Date();nowDate.setMonth(nowDate.getMonth()+1);cookieExpires=nowDate.toGMTString()}if(cookiePath===""||cookiePath===null||cookiePath===undefined){cookiePath="; path=/"}else{cookiePath="; path="+cookiePath}if(cookieDomain===""||cookieDomain===null||cookieDomain===undefined){cookieDomain="; domain="+document.domain.replace(/www\./,"")}else{cookieDomain="; domain="+cookieDomain}document.cookie=cookieName+"="+cookieValue+"; expires="+cookieExpires+cookiePath+cookieDomain}function setInitialAccessibility(){var contrast=getCookieValue("CIBC_Contrast");if(contrast===null){contrast=0}utilityFunctions.setContrast(contrast);var size=getCookieValue("CIBC_TextSize");if(size===null){size=0}utilityFunctions.setTextSize(size)}function formatDate(inDate){var month,today;var outDate=new Date(inDate);var path=""+document.location;var plang=(path.indexOf("-fr.html")>0?"fr":"en");if(plang==="fr"){months=["janvier","f&eacute;vrier","mars","avril","mai","juin","juillet","ao&ucirc;t","septembre","octobre","novembre","d&eacute;cembre"]}else{months=["January"," February","March","April","May","June","July","August","September","October","November","December"]}var odate=outDate.getUTCDate();if(plang==="fr"){odate=((outDate.getUTCDate()<10)?"0":"")+odate;today=odate+" "+months[outDate.getUTCMonth()]+" "+outDate.getUTCFullYear()}else{today=months[outDate.getUTCMonth()]+" "+odate+", "+outDate.getUTCFullYear()}document.write(""+today+"")}function focusInput(ele){if(ele.value===ele.title){ele.value=""}else{ele.select(0)}}function newCustStatusWindow(pop_url,win_width,win_height){var statusbar;statusbar=window.open(pop_url,"newWin1","width="+win_width+",height="+win_height+",directories=no,hotkeys=no,location=no,menubar=no,personalbar=no,resizable=yes,scrollbars=yes,status=yes,titlebar=no,toolbar=no,top="+(screen.availHeight-win_height)/2+",left="+(screen.availWidth-win_width)/2);statusbar.focus()}function newApplyWindowLarge(apply_url){var applyLarge;applyLarge=window.open(apply_url,"applyLarge","width=797,height=550,directories=no,hotkeys=no,location=no,menubar=no,personalbar=no,resizable=yes,scrollbars=yes,status=yes,titlebar=no,toolbar=yes,top="+(screen.availHeight-550)/2+",left="+(screen.availWidth-797)/2);applyLarge.focus()}function loadJS(url){var url=url+"?random="+Math.random();document.write('<script language="javascript" src="'+url+'" type="text/javascript"><\/script>')}function openURL(pop_url){pop_url=olburl+pop_url;window.location.href=pop_url}function submitSearch(){if(document.basicSearch.qt.value==""||document.basicSearch.qt.value=="Search"){alert("The search word is missing. Enter the word or phrase to search.");return false}else{document.location.href="https://www.cibc.com/ca/query/"+lobRedirect()+".html?qt="+encodeURIComponent(document.basicSearch.qt.value).replace(/%20/g,"+");return false}}function submitSearchFR(){if(document.basicSearch.qt.value==""||document.basicSearch.qt.value=="Recherche"){alert("Le terme d'interrogation n'est pas inscrit. Inscrivez un mot ou une phrase ? rechercher.");return false}else{document.location.href="https://www.cibc.com/ca/query/"+lobRedirect()+"-fr.html?qt="+encodeURIComponent(document.basicSearch.qt.value).replace(/%20/g,"+");return false}}function lobRedirect(){var i;var lobs=[{lob:"is",url:"/ca/imperial-service/",redirect:"is-index"},{lob:"pwm",url:"/ca/pwm/",redirect:"pwm-index"},{lob:"pwmg",url:"/ca/pwm-global/",redirect:"pwmg-index"},{lob:"cibc",url:"/ca/",redirect:"index"}];var curLoc=document.location;var curPath=curLoc.pathname;for(i=0;i<lobs.length;i++){if(curPath.indexOf(lobs[i].url)!==-1){return lobs[i].redirect;break}}}var searchInputFlag=0;function clearSearchInput(){if(searchInputFlag==0){document.getElementById("qt").value="";searchInputFlag=1}}function appendAutonomyPageElements(){if(document.getElementById("qt")){try{document.domain="cibc.com"}catch(err){}ifrm=document.createElement("iframe");ifrm.setAttribute("src","https://query.cibc.com/a=query&template=search&forcetemplaterefresh=true");ifrm.setAttribute("id","autonomyFrame");ifrm.setAttribute("name","autonomyFrame");ifrm.style.width=0;ifrm.style.height=0;searchpickdiv=document.createElement("div");searchpickdiv.id="searchInputPick";prefillScript=document.createElement("script");prefillScript.type=("text/javascript");prefillScript.src=("/ca/js/search/typeahead.js");prefillCss=document.createElement("link");prefillCss.rel="stylesheet";prefillCss.type="text/css";prefillCss.href="/ca/css/search/typeahead.css?update=10242013";document.getElementById("qtSearch").parentNode.appendChild(searchpickdiv);document.getElementsByTagName("head")[0].appendChild(prefillScript);document.getElementsByTagName("head")[0].appendChild(prefillCss);document.body.appendChild(ifrm);var inputelement=document.getElementById("qt");inputelement.setAttribute("autocomplete","off");var path=document.location.pathname;if(path.indexOf("-fr.html")!==-1){document.basicSearch.action="/ca/query/index-fr.html"}else{document.basicSearch.action="/ca/query/index.html"}if(inputelement.addEventListener){inputelement.setAttribute("onclick","if(searchInputFlag == 0){qt.value='';searchInputFlag = 1}");inputelement.setAttribute("onblur","checkEmpty(document.getElementById('qt'))");inputelement.setAttribute("onkeydown","typeaheadFunctions.handleKeyDown(event)");inputelement.setAttribute("onkeyup","typeaheadFunctions.handleTextChange(event, this)");inputelement.setAttribute("onfocus","typeaheadFunctions.hidePickList()")}else{inputelement.setAttribute("onclick","");inputelement.attachEvent("onclick",clearSearchInput);inputelement.attachEvent("onblur",function(){checkEmpty(document.getElementById("qt"))});inputelement.attachEvent("onkeydown",function(){typeaheadFunctions.handleKeyDown(event)});inputelement.attachEvent("onkeyup",function(){typeaheadFunctions.handleTextChange(event,inputelement)});inputelement.attachEvent("onfocus",function(){typeaheadFunctions.hidePickList()})}}}addHandler("load",window,appendAutonomyPageElements);(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type=="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.bind("mouseenter",handleHover).bind("mouseleave",handleHover)}})(jQuery);addHandler("load",window,function(){if(window.PRIME){document.getElementById("rates-text").style.display="block"}bannerFunctions.gotoSlide(0);setInitialAccessibility();(function(){addHandler("click",document.getElementsByTagName("html")[0],function(){document.getElementById("other-sites").className="no-bullets"});addHandler("touchend",document.getElementById("header"),function(){if(event&&event.target&&event.target.tagName!=="A"){document.getElementById("other-sites").className="no-bullets"}})})();$(".menubar-item > h2 a").hoverIntent({over:function(evt){utilityFunctions.displayMenupane(evt,evt.target)},out:function(evt){},timeout:50});$("#menubar").hover(function(evt){},function(evt){utilityFunctions.hideMenupane(evt,evt.target)});var signOff=0;var siteloc=0;var srchstring=unescape(location.search.substring(1,location.search.length));if(srchstring.length>0){if(srchstring.charAt(0)===";"){srchstring=srchstring.substring(1,srchstring.length)}var querryArr=srchstring.split("&");for(var x=0;x<querryArr.length;x++){if(querryArr[x]=="loggedOut=true"){signOff=1}else{if(querryArr[x]==="siteloc=1"){siteloc=1}}}}if(signOff===1){var ele=document.getElementById("olb-message");if(ele){ele.style.display="block";window.setTimeout(function(){ele.focus()},1000)}}});function adjustMegamenu(){var menupanes=["menupane-smallbusiness","menupane-commercialcorporate","menupane-bankaccounts","menupane-creditcards","menupane-mortgages","menupane-lending","menupane-investments","menupane-insurance","menupane-waystobank","menupane-advicecentre","menupane-corporateprofile","menupane-corporategovernance","menupane-corporateresponsibility","menupane-investorrelations","menupane-mediacentre","menupane-careers"];$(".menupane-column").css("height","");for(var i=menupanes.length-1;i>=0;i--){$("#"+menupanes[i]).css("height","");$("#"+menupanes[i]+" .promo-column div").css("height","");$("#"+menupanes[i]).css("height","");height=$("#"+menupanes[i]).height();if(height>0){$("#"+menupanes[i]).css({height:height+"px"});var promoColHeight=height-30;$("#"+menupanes[i]+" .promo-column div").css({height:promoColHeight+"px"})}}}function adjustSecondaryAds(){$("#rotating , #anchor , #anchor-rotating-modules , #section-content").css("height","");$("#rotating , #anchor , #anchor-rotating-modules , #section-content").height(Math.max($("#rotating").height(),$("#anchor").height()))}function checkEmpty(a){if(a.value===""){a.value=a.defaultValue;if(a===document.getElementById("qt")){searchInputFlag=0}}}(function(){var ef=false;try{ef=top.location.host!=location.host}catch(err){ef=true}if(ef){top.location.href=location.href}})();function NewsTicker(divid){var WAIT=7000,ANIMATE=1000,COMPLETE=ANIMATE/5;var WIDTH=700;var UL="#"+divid+" ul";var FIRST=UL+" li:first",LAST=UL+" li:last";var thiss=this;var timeout;var hasfocus;addHandler("load",window,function(){if($(UL+" li").length===1){window.clearTimeout(timeout);$("#news-rotator").css("display","none");return}});this.deferTick=function(){timeout=window.setTimeout(function(){thiss.tick()},WAIT)};this.tick=function(){hasfocus=$(document.activeElement).attr("id")===$(FIRST+" a").attr("id");$(FIRST+" a").attr("tabindex",-1);$(UL).animate({left:-WIDTH},ANIMATE,"swing",function(){$(this).css("left","");$(FIRST).appendTo($(this));$(FIRST+" a").removeAttr("tabindex");if(hasfocus){$(FIRST+" a").focus()}thiss.deferTick()})};this.untick=function(){$(UL).animate({left:0},ANIMATE,"swing",function(){$(this).css("left","");thiss.deferTick()})};this.rotate=function(inc){switch(inc){case 1:$(UL).stop(true,true);window.clearTimeout(timeout);thiss.tick();break;case -1:$(UL).stop(true,true);window.clearTimeout(timeout);$(LAST).prependTo($(UL));$(UL).css("left","-"+WIDTH+"px");$(LAST+" a").removeAttr("tabindex");if(hasfocus){$(LAST+" a").focus()}thiss.untick();break}return};$(UL).hover(function(){$(this).stop(true,false);window.clearTimeout(timeout);if($(UL).css("left")!=="0px"&&$(UL).css("left")!=="auto"){$(UL).animate({left:-WIDTH},COMPLETE,"swing",function(){$(this).css("left","");$(FIRST).appendTo($(this))})}},function(){thiss.deferTick()});thiss.deferTick()}var newsTicker=new NewsTicker("news-items");function surveyNotInterested(cookieName){if(document.surveyForm.surveyNone.checked){var nowDate=new Date();declinedDate=nowDate;declinedDate.setMonth(nowDate.getMonth()+6);declinedDate.toGMTString();setCookie(cookieName,2,declinedDate)}document.getElementById("surveyDiv").style.display="none";document.getElementById("screenOverlay").style.display="none"}function surveyTaken(surveyUrl,cookieName){surveyWindow=window.open(surveyUrl,"CIBCsurvey","height=580,width=825,top=20,left=20,scrollbars=yes,resizable=yes");surveyWindow.focus();window.blur();document.getElementById("surveyDiv").style.display="none";document.getElementById("screenOverlay").style.display="none";surveyTakenCookie(cookieName);return false}function surveyTakenCookie(cookieName){var nowDate=new Date();takenDate=nowDate;takenDate.setMonth(nowDate.getMonth()+6);takenDate.toGMTString();setCookie(cookieName,1,takenDate)}function surveyNextPage(){document.getElementById("surveyPage1").style.display="none";document.getElementById("surveyPage2").style.display="block"}function setDocumentProperties(){if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){documentTop=document.documentElement.scrollTop;documentHeight=document.documentElement.clientHeight;documentLeft=document.documentElement.scrollLeft;documentWidth=document.documentElement.clientWidth}else{documentTop=document.body.scrollTop;documentHeight=document.body.clientHeight;documentLeft=document.body.scrollLeft;documentWidth=document.body.clientWidth}}function getElementsByClassName(searchClass,node,tag){var classElements=new Array();if(node==null){node=document}if(tag==null){tag="*"}var els=node.getElementsByTagName(tag);var elsLen=els.length;var pattern=new RegExp("(^|\\s)"+searchClass+"(\\s|$)");for(var i=0,j=0;i<elsLen;i++){if(pattern.test(els[i].className)){classElements[j]=els[i];j++}}return classElements}var IE=(navigator.userAgent.indexOf("Win")!=-1)&&(navigator.appVersion.indexOf("MSIE")!=-1);var IEVersion=IE?parseFloat((new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})")).exec(navigator.userAgent)[1]):-1;var IE6=IEVersion==6?true:false;var Chrome=(navigator.userAgent.indexOf("Chrome")!=-1);var Prototype={Version:"1.5.0_pre1",ScriptFragment:"(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)",emptyFunction:function(){},K:function(x){return x}};var Class={create:function(){return function(){this.initialize.apply(this,arguments)}}};function stopBubble(objEvent){try{if(!objEvent.stopPropagation){objEvent=window.event;objEvent.cancelBubble=true}if(objEvent.stopPropagation){objEvent.stopPropagation()}}catch(e){}}var Cibc=Class.create();Cibc.prototype={initialize:function(){},keyEvent:{ENTER:13,ESC:27,TAB:9},tabElements:{area:true,button:true,input:true,object:true,select:true,textarea:true}};Cibc.prototype.getTabNavigable=function(node){var first,last,lowest,lowestTabindex,highest,highestTabindex;var lowestTabindex=highestTabindex=0;var hasTabNavigable=false;var childNodes=node.getElementsByTagName("*");for(_item in childNodes){child=childNodes[_item];try{var isTabable=this.isTabNavigable(child);if(isTabable){hasTabNavigable=true;addHandler("mouseup",child,stopBubble);var tabindex=isTabable[1];if(!tabindex||tabindex==0){!first?first=child:0;last=child}else{if(tabindex>0){if(!lowest||tabindex<lowestTabindex){lowestTabindex=tabindex;lowest=child}if(!highest||tabindex>=highestTabindex){highestTabindex=tabindex;highest=child}}}}}catch(e){}}return hasTabNavigable?{first:first,last:last,lowest:lowest,highest:highest}:null};Cibc.prototype.isTabNavigable=function(obj){if(this.hasAttribute(obj,"disabled")||!this.isObjVisible(obj)||obj.type.match(/hidden/gi)){return false}var hasTabindex=this.hasAttribute(obj,"tabindex");var tabindex=obj.getAttribute("tabindex");var name=obj.nodeName.toLowerCase();return(hasTabindex&&tabindex>=0)||(((name=="a"&&this.hasAttribute(obj,"href"))||CIBC.tabElements[name])&&(!hasTabindex||tabindex>=0))?[true,tabindex]:false};Cibc.prototype.hasAttribute=function(node,name){var attr=node.getAttributeNode(this.fixAttrName(name));return attr?attr.specified:false};Cibc.prototype.fixAttrName=function(name){return name.match(/tabindex/gi)?IE&&IEVersion<8?"tabIndex":"tabindex":name};Cibc.prototype.isObjVisible=function(obj){return !obj.style.visibility.match(/hidden|collapsed/gi)&&!obj.style.display.match(/none/)&&!obj.className.match(/hide/gi)};Cibc.prototype.getKeyCode=function(e){var evt=window.event?event:e;return{key:evt.keyCode,modifiers:{alt:evt.altKey,ctrl:evt.ctrlKey,shift:evt.shiftKey}}};Cibc.prototype.stopEvent=function(evt){if(IE){evt=window.event;evt.preventDefault=function(){this.bubbledKeyCode=this.keyCode;if(this.ctrlKey){CIBC._trySetKeyCode(this,0)}this.returnValue=false}}evt.preventDefault()};Cibc.prototype._trySetKeyCode=function(e,code){try{return(e.keyCode=code)}catch(e){return 0}};Cibc.prototype.addClass=function(obj,className){try{if(obj instanceof Array){for(var i=0,l=obj.length;i<l;i++){addClass(obj[i],className)}}else{if(className instanceof Array){for(var i=0,l=className.length;i<l;i++){addClass(obj,className[i])}}else{if(className instanceof Object){for(_item in className){addClass(obj,className[_item])}}else{if(!obj.className.match(new RegExp("\\b"+className+"\\b","gi"))){obj.className+=" "+className}}}}}catch(e){}};Cibc.prototype.removeClass=function(obj,className){try{if(obj instanceof Array){for(var i=0,l=obj.length;i<l;i++){removeClass(obj[i],className)}}else{if(className instanceof Array){for(var i=0,l=className.length;i<l;i++){removeClass(obj,className[i])}}else{if(className instanceof Object){for(_item in className){removeClass(obj,className[_item])}}else{obj.className=obj.className.replace(new RegExp("\\b"+className+"\\b","gi"),"")}}}}catch(e){}};Cibc.prototype.hasClass=function(obj,className){hasClass(obj,className)};CIBC=new Cibc();var flyOverObject=null;var wDynLink=null;var FlyOver=Class.create();FlyOver.prototype={clickedObj:null,closer:null,focus:null,fOObj:null,OVERLAY_TOP_OFFSET:0,params:null};FlyOver.prototype.initialize=function(params){if(params==null){return}var self=this;this.params=params;this.getClickedObj(params);try{if(params.replaceFlyOver!=null){this.parentFlyOver=flyOverObject.fOObj.id==params.flyover?flyOverObject.parentFlyOver:flyOverObject;this.parentFlyOver.childFlyOver=this;params.replaceFlyOver==true?flyOverObject.fOObj.opener=null:0}}catch(e){}if(this.detachNested()&&!this.params.reopen){return this.detach()}this.fOObj=document.getElementById(params.flyover);this.fOObj.instance=this;if(this.fOObj.opener==this.clickedObj&&!params.replaceFlyOver){this.fOObj.opener=null;return this.detach()}else{this.fOObj.opener=this.clickedObj}try{this.OVERLAY_TOP_OFFSET=this.params.screenBlockerOffset?this.params.screenBlockerOffset[1]:document.getElementById("contentHeader").offsetHeight}catch(e){this.OVERLAY_TOP_OFFSET=0}this.setTabIndexing();this.focus=params.focus?document.getElementById(params.focus):this.fOObj.tabNavigables.first;this.closer=getElementsByClassName("closer",this.fOObj);for(_item in this.closer){this.closer[_item].onclick=function(){var child=self.childFlyOver;while(child){child.detach({enableEvents:true});child=child.childFlyOver}self.detach({enableEvents:true})}}this.fOObj.onmouseup=function(){this.style.display=="block"&&!wDynLink?self.focusDefault():0;try{this.instance.childFlyOver.detach({enableEvents:true})}catch(e){}};flyOverObject=this;this.disableScreen();if(this.params.screenBlocker==false){this.enableScreen()}setDocumentProperties();if(params.keepHidden==undefined&&params.keepHidden!=true){this.setAndFocus()}addHandler("mousedown",this.fOObj,stopBubble);addHandler("mouseup",this.fOObj,stopBubble);addHandler("mouseup",this.clickedObj,stopBubble);if(this.params.screenBlocker==undefined){addHandler("mousedown",this.objOverlay,stopBubble)}document.body.onmousedown=function(){flyOverObject.detach({enableEvents:true})}};FlyOver.prototype.detach=function(params){var clickedAnchor=this.clickedObj;while(!clickedAnchor.nodeName.match(/^a|button$|input$/i)){clickedAnchor=clickedAnchor.parentNode}if(params&&params.enableEvents){this.fOObj.opener=null;this.parentFlyOver&&this.parentFlyOver.fOObj.opener==null?removeHandler("mousedown",this.clickedObj,stopBubble):0}flyOverObject=this.parentFlyOver&&this.parentFlyOver.fOObj.opener!=null?this.parentFlyOver:null;flyOverObject==null?document.body.onmousedown=null:0;try{flyOverObject.fOObj.childFlyOver=null}catch(e){}this.enableScreen();this.fOObj.style.display="none";if(IE){if(IE6){try{this.fOObj.parentNode.removeChild(this.objIframe)}catch(e){}}if(IEVersion==7){CIBC.addClass(this.clickedObj,"IE7Floater");CIBC.removeClass(this.clickedObj,"IE7Floater")}}setTimeout(function(){try{clickedAnchor.focus()}catch(e){}},0)};FlyOver.prototype.detachNested=function(params){try{var parent=flyOverObject;while(parent.parentFlyOver){parent=parent.parentFlyOver}if((parent&&parent.clickedObj==this.clickedObj)||(params&&params.forceDetach)){var child=parent;while(child){child.detach({enableEvents:true});child=child.childFlyOver}parent.detach({enableEvents:true});flyOverObject=null;return true}else{if(!this.parentFlyOver){this.detachNested({forceDetach:true})}}return false}catch(e){return false}};FlyOver.prototype.enableScreen=function(){try{this.objOverlay.style.display="none";removeClass(document.body,"hasScreenBlocker")}catch(e){}try{window.onresize=window.originalResize}catch(e){}};FlyOver.prototype.disableScreen=function(className){if(this.objOverlay==null||this.objOverlay==undefined){this.initOverlay(className)}this.objOverlay.style.display="block";var self=this;if(this.params.screenBlocker==undefined){this.objOverlay.onclick=function(){self.focusDefault()}}IE6?addClass(document.body,"hasScreenBlocker"):0;window.originalResize=window.onresize};FlyOver.prototype.initOverlay=function(className){if(this.params.screenBlockerAttachPoint){switch(this.params.screenBlockerAttachPoint){case"body":this.objBody=document.body;break;case"html":if(IE){this.objBody=document.body}else{this.objBody=document.documentElement}break;default:this.objBody=document.getElementById(this.params.screenBlockerAttachPoint)}}this.objOverlay=document.createElement("div");objOverlayPositioner=document.createElement("div");if(IE6){this.objIframe=document.createElement("iframe");this.objIframe.className="flyOverIframe";this.objIframe.frameBorder="0";this.objIframe.src="/ca/img/spacer.gif";this.objIframe.style.display="block"}objOverlayPositioner.className="screenOverlayPositioner";this.objOverlay.setAttribute("id","screenOverlay");this.objOverlay.className="screenOverlay"+(this.params.screenBlockerClassName?" "+this.params.screenBlockerClassName:"");this.objOverlay.style.left="0";this.objOverlay.style.top=this.OVERLAY_TOP_OFFSET+"px";this.objOverlay.style.width=this.objBody.offsetWidth+"px";this.objOverlay.style.height=(Math.max(this.objBody.offsetHeight,this.objBody.scrollHeight)-this.OVERLAY_TOP_OFFSET)+"px";objOverlayPositioner.appendChild(this.objOverlay);this.objBody.insertBefore(objOverlayPositioner,this.objBody.firstChild);this.objBody.appendChild(this.fOObj);this.objOverlay.style.display="block"};FlyOver.prototype.overlayResize=function(){this.objOverlay.style.width=this.objBody.offsetWidth+"px";this.objOverlay.style.height=this.objBody.offsetHeight+"px";this.objOverlay.style.display="block"};FlyOver.prototype.setAndFocus=function(){this.setFOPosition();this.focusDefault()};FlyOver.prototype.getClickedObj=function(params){if(this.params.clickedObj){this.clickedObj=this.params.clickedObj instanceof Object?this.params.clickedObj:document.getElementById(this.params.clickedObj);return}if(this.params.replaceFlyOver){return this.clickedObj=flyOverObject.clickedObj}this.clickedObj=params.e.target||params.e.srcElement;addHandler("mousedown",this.clickedObj,stopBubble)};FlyOver.prototype.focusDefault=function(){this.fOObj.style.display="block";setTimeout(function(){try{flyOverObject.fOObj.tabNavigables.first.focus()}catch(e){}},0)};FlyOver.prototype.setTabIndexing=function(){this.fOObj.tabNavigables=CIBC.getTabNavigable(this.fOObj);this.fOObj.tabIndex=0;if(!this.fOObj.tabNavigables){this.fOObj.tabNavigables={first:this.fOObj,last:this.fOObj,lowest:0}}this.fOObj.tabNavigables.first.tabIndex=this.fOObj.tabNavigables.lowest;this.fOObj.onkeydown=function(e){e=e||event;var keyCode=CIBC.getKeyCode(e);var node=e.target||e.srcElement;var singleFocusItem=(this.tabNavigables.first==this.tabNavigables.last);if(keyCode.key==CIBC.keyEvent.ESC){flyOverObject.detach({enableEvents:true})}else{if(node==this.tabNavigables.first&&keyCode.key==CIBC.keyEvent.TAB&&keyCode.modifiers.shift){!singleFocusItem?this.tabNavigables.last.focus():0;CIBC.stopEvent(e)}else{if(node==this.tabNavigables.last&&keyCode.key==CIBC.keyEvent.TAB&&!keyCode.modifiers.shift){!singleFocusItem?this.tabNavigables.first.focus():0;CIBC.stopEvent(e)}}}};this.fOObj.tabNavigables.first=this.fOObj};FlyOver.prototype.getObjPos=function(obj){var leftPos=topPos=0;while(obj.offsetParent){topPos+=obj.offsetTop;leftPos+=obj.offsetLeft;obj=obj.offsetParent}return{left:leftPos,top:topPos}};FlyOver.prototype.setFOPosition=function(){this.fOObj.style.display="block";var coords=this.getObjPos(this.clickedObj);var position=this.params.position;if(position){var isArray=position instanceof Array;var hObj=vObj=sameObj=0;if(isArray&&position.length>1){hObj=position[0];vObj=position[1]}else{eval("sameObj=true; hObj = vObj = position"+(isArray&&position.length==1?"[0]":""))}var getPosition=function(node){return node=typeof(node)=="string"?node.match(/^body$/gi)?document.documentElement:document.getElementById(node):node};hObj=getPosition(hObj);vObj=sameObj?hObj:getPosition(vObj);var offsetLeft=hObj==document.documentElement||typeof(hObj)=="number"?0:hObj.offsetLeft;var offsetTop=vObj==document.documentElement||typeof(vObj)=="number"?0:vObj.offsetLeft;if(this.params.offset){this.params.offset[0]?offsetLeft+=this.params.offset[0]:0;this.params.offset[1]?offsetTop+=this.params.offset[1]:0}this.fOObj.style.left=(typeof(hObj)=="number"?hObj:(hObj.clientWidth/2)+offsetLeft-(this.fOObj.offsetWidth/2))+"px";this.fOObj.style.top=(typeof(vObj)=="number"?vObj:Math.min((vObj.clientHeight,(window.innerHeight||vObj.offsetHeight))/2)+offsetTop-(this.fOObj.offsetHeight/2))+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)+"px"}else{try{var offsetLeft=this.params.replaceFlyOver&&this.params.replaceFlyOver==true?this.parentFlyOver.params.offset[0]:this.params.offset[0]}catch(e){var offsetLeft=0}this.fOObj.style.left=coords.left+offsetLeft+this.clickedObj.offsetWidth+"px";this.fOObj.style.top=this.setFOTop(coords.top)+"px"}if(IE6){this.fOObj.parentNode.insertBefore(this.objIframe,this.fOObj);this.objIframe.style.left=this.fOObj.style.left;this.objIframe.style.top=this.fOObj.style.top;this.objIframe.style.width=this.fOObj.offsetWidth+"px";this.setIframeHeight()}this.fOObj.style.display="none"};FlyOver.prototype.setIframeHeight=function(){IE6?this.objIframe.style.height=this.fOObj.offsetHeight+"px":0};FlyOver.prototype.setFOTop=function(top){topPos=top||this.getObjPos(this.clickedObj).top;try{var offsetTop=this.params.replaceFlyOver&&this.params.replaceFlyOver==true?this.parentFlyOver.params.offset[1]:this.params.offset[1]}catch(e){var offsetTop=0}var result=((topPos+this.fOObj.offsetHeight)>(documentHeight+documentTop))&&(topPos-(this.fOObj.offsetHeight+offsetTop))>documentTop?topPos-=this.fOObj.offsetHeight:topPos+=offsetTop;return result};