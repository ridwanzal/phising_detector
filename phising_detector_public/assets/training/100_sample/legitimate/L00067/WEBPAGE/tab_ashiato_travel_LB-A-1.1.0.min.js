/*
 tab_ashiato_travel_LB-A-1.1.0.js
 Copyright (c) 2015 Rakuten.Inc
 Date : 2015-09-02 18:58:14
*/
(function(q,h){var c=q.jQuery;if("function"===typeof c&&c.RJS_Helpers){var u=function(b,d){var a=this;if(!(b===h||d===h))if(a.mainObj=b,c.extend(this,{settings:{maxitem:5,pagespeed:100,opacityspeed:100,autoslidetime:2,autoslideflag:"",autoslide:0,autoresize:0,verticalmode:0,indicator:0,indicatoralign:0},eobj:{itemsDisplay:!1,prevButton:!1,nextButton:!1,indicatorDisplay:!1},canvas:{front:!1,back:!1,autoPlayTimer:!1},itemPrototype:{html:"",height:0,width:0},indicatorPrototype:{html:"",height:0,width:0},
items:!1,itemIndex:[],itemEvents:{remove:!1},status:{animation:!1,preparingItems:!1,renderReset:!1,resizeCurrStart:!1,resizeCurrEnd:!1,callBackResize:!1,isStopAutoPlay:!1},pageConf:{maxAllowed:5,currStart:0,currEnd:0,currCnt:0,width:0,nowPage:0,maxPage:0},events:{startSlide:!1,afterSlide:!1,afterRemove:!1,onItemRemove:!1,afterFirstRender:!1,beforeFirstRender:!1,onZeroItems:!1,onResize:!1,changePageNumber:!1}},d),c.extend(this,{initialize:function(){var b=0,d,f;if(1>a.items.length||!a.eobj.itemsDisplay||
!a.eobj.prevButton||!a.eobj.nextButton)return a;for(d in a.items)a.itemIndex[b]=d,b++;b=a.itemIndex.length;for(f in a.events)!c.isFunction(a.events[f])&&(a.events[f]=!1);1===a.settings.autoslide&&!c.isFunction(a[a.settings.autoslideflag])?a.settings.autoslide=0:(a.eobj.itemsDisplay.hover(function(){a.isStopAutoPlay=!0;a.stop()},function(){a.isStopAutoPlay=!1;a.play()}),a.eobj.prevButton.hover(function(){a.stop()},function(){a.play()}),a.eobj.nextButton.hover(function(){a.stop()},function(){a.play()}),
a.eobj.backButton!=h&&0<a.eobj.backButton.length&&a.eobj.backButton.hover(function(){a.stop()},function(){a.play()}));a.pageConf.maxAllowed=Math.min(a.settings.maxitem,b);1===a.settings.autoresize&&0===a.settings.verticalmode&&0<a.itemPrototype.width&&(a.resize(!1),c(q).resize(function(){a.resize(!0);c.recommend_light_box.alignLightBox()}),(-1!=q.navigator.userAgent.toLowerCase().indexOf("msie 6.")||-1!=q.navigator.userAgent.toLowerCase().indexOf("msie 7."))&&c(q).load(function(){a.resize(!0)}));
f=Math.min(a.pageConf.maxAllowed,b);a.prepareItems(0,f).updatePageNumber().prepareIndicator().render(0,f,!1).manageControls().prepareItems(f,b);return a},prepareItems:function(b,d){var f=a.itemPrototype.html,g=a.itemPrototype.identifiers,e="",j,k,o;if(a.status.preparingItems)return a;if(a.status.animation)return setTimeout(function(){a.prepareItems(b,d)},a.settings.pagespeed),a;a.status.preparingItems=!0;for(k=b;k<d;k++){e=f;j=a.items[a.itemIndex[k]];for(o in g)e=e.replace(g[o][1],j[o]!=h?g[o][0]+
j[o]+g[o][2]:"");j.ele=c(e)}if(""!=a.itemEvents.remove)for(k=b;k<d;k++)a.items[a.itemIndex[k]].ele.find(a.itemEvents.remove).attr("id","").bind("click",{index:k},function(b){b.preventDefault();a.removeItem(b.data.index);return!1});a.status.preparingItems=!1;return a},render:function(b,d,f,c){function e(){function f(b,d,c){(b=a.items[a.itemIndex[b]])&&b.ele.animate({opacity:0},a.settings.opacityspeed,"linear");(d=a.items[a.itemIndex[d]])&&d.ele.animate({opacity:1},a.settings.opacityspeed,"linear");
c||setTimeout(function(){a.canvas.front[0]!==h&&null!==a.canvas.front[0].parentNode&&a.canvas.front[0].parentNode.removeChild(a.canvas.front[0]);a.canvas.front=a.canvas.back;a.play();a.status.animation=!1;a.status.renderReset=!1;a.status.callBackResize&&a.resize(!0);a.events.afterSlide&&a.events.afterSlide(a.pageConf.currStart,a.mainObj)},a.settings.opacityspeed)}var e=a.pageConf.maxAllowed,o=1,r=d-b,l,s,n=!0;c?(l=a.pageConf.currCnt!=e?Math.ceil(a.pageConf.currEnd/e)*e-1:a.pageConf.currEnd-1,s=r!=
e?Math.ceil(d/e)*e-1:d-1,a.status.renderReset&&(l=-1,r!=e&&(e=r,s=d-1)),o=-1):(l=a.pageConf.currStart,s=b);for(r=0;n;r++,l+=o,s+=o)setTimeout(function(a,b,d){return function(){f(a,b,d)}}(l,s,n=r+1<e),r*a.settings.pagespeed)}if(a.status.animation||a.status.preparingItems)return a;f=typeof f!==h?!1===f?!1:!0:!0;c=typeof c!==h?!0===c?!0:!1:!1;if(0>b)return a;a.status.animation=!0;a.stop();if(d>a.itemIndex.length&&(d=a.itemIndex.length,d-b>a.pageConf.maxAllowed))return a;!1===f?(a.canvas.front=a.prepareElements(b,
d,2,1),a.events.beforeFirstRender&&a.events.beforeFirstRender(a.pageConf.maxAllowed,a.mainObj),a.eobj.itemsDisplay.append(a.canvas.front),a.play(),a.status.animation=!1,a.events.afterFirstRender&&a.events.afterFirstRender(a.pageConf.maxAllowed,a.mainObj)):(a.status.renderReset&&a.canvas.front[0].parentNode.removeChild(a.canvas.front[0]),a.canvas.back=a.prepareElements(b,d,2,0),a.eobj.itemsDisplay.append(a.canvas.back),a.events.animateCanvas?eval("("+a.events.animateCanvas+")();"):e());a.pageConf.currStart=
b;a.pageConf.currEnd=d;a.pageConf.currCnt=d-b;a.manageControls();a.updatePageNumber();a.events.changePageNumber&&a.events.changePageNumber(a.pageConf.nowPage,a.pageConf.maxPage,a.mainObj);1===a.settings.indicator&&a.renderIndicator();return a},prepareElements:function(b,d,f,g){var f={"z-index":f,opacity:g,position:"relative"},e,g=c("<div>").css({position:"absolute",width:"100%","float":"none"});for(e=b;e<d;e++)b=a.items[a.itemIndex[e]].ele,g.append(b.css(f));a.justifyElements(g);return g},manageControls:function(){0===
a.pageConf.currStart&&a.pageConf.currEnd>=a.itemIndex.length?(a.eobj.prevButton.find("a").hide(),a.eobj.nextButton.find("a").hide()):(a.eobj.prevButton.find("a").show().focus(function(){this.blur()}).unbind("click").click(function(b){b.preventDefault();a.prev();return!1}),a.eobj.nextButton.find("a").show().focus(function(){this.blur()}).unbind("click").click(function(b){b.preventDefault();a.next();return!1}));return a},prev:function(){if(0===a.pageConf.currStart&&a.pageConf.currEnd===a.itemIndex.length)return a;
a.events.startSlide&&a.events.startSlide(a.pageConf.currStart,a.mainObj);0===a.pageConf.currStart?a.render(Math.floor((a.itemIndex.length-1)/a.pageConf.maxAllowed)*a.pageConf.maxAllowed,a.itemIndex.length):a.render(a.pageConf.currStart-a.pageConf.maxAllowed,a.pageConf.currStart);return a},next:function(){if(0===a.pageConf.currStart&&a.pageConf.currEnd===a.itemIndex.length)return a;a.events.startSlide&&a.events.startSlide(a.pageConf.currStart,a.mainObj);a.pageConf.currEnd>=a.itemIndex.length?a.render(0,
a.pageConf.maxAllowed,!0,!0):a.render(a.pageConf.currEnd,a.pageConf.currEnd+a.pageConf.maxAllowed,!0,!0);return a},removeItem:function(b){var m=a.canvas.front,f,g,e;f=!1;var j;if(a.status.animation||a.status.preparingItems)return!1;a.items[b].ele.fadeOut(a.settings.opacityspeed,function(){c(this).remove()});a.events.onItemRemove&&a.events.onItemRemove(b,a.mainObj);if(1==a.itemIndex.length)return a.events.onZeroItems&&a.events.onZeroItems(a.mainObj),!1;b=c.inArray(b+"",a.itemIndex);if(-1==b)return!1;
a.itemIndex.splice(b,1);a.pageConf.currEnd==a.itemIndex.length+1&&(a.pageConf.currEnd--,a.pageConf.currCnt--);if(b==a.itemIndex.length)a.events.afterRemove&&a.events.afterRemove(a.mainObj),0==b%a.pageConf.maxAllowed&&a.prev();else{a.status.animation=!0;for(g=b,e=0;!f;g++,e++){f=a.items[a.itemIndex[g]].ele;f.css({"z-index":1,opacity:0});if(j=g==a.pageConf.currEnd-1)m.append(f),g==b&&(e=1);setTimeout(function(b,d){return function(){b.animate({opacity:"1"},a.settings.opacityspeed,"linear",function(){a.status.animation=
d;!a.status.animation&&a.status.callBackResize&&a.resize(!0);d||a.events.afterRemove&&a.events.afterRemove(a.mainObj)})}}(f,!(f=g===a.itemIndex.length-1||j)),e*a.settings.pagespeed)}}a.justifyElements().manageControls();a.updatePageNumber();a.events.changePageNumber&&a.events.changePageNumber(d.nowPage,d.maxPage,a.mainObj);1===a.settings.indicator&&(a.prepareIndicator(),a.renderIndicator());return!1},play:function(){if(0===a.settings.autoslide||a.isStopAutoPlay||a.autoPlayTimer==h||!1!=a.autoPlayTimer)return a;
a.autoPlayTimer=setTimeout(function(){a[a.settings.autoslideflag]()},a.settings.autoslidetime);return a},stop:function(){if(0===a.settings.autoslide)return a;clearTimeout(a.autoPlayTimer);a.autoPlayTimer=!1;return a},justifyElements:function(b){var d=a.pageConf.maxAllowed;if(1!==a.settings.autoresize)return a;if(b===h)b=a.canvas.front;b.children("*").css("width",d>=a.settings.maxitem?Math.floor(1E4*(99/d))/1E4+"%":"");return a},resize:function(b){var d=a.pageConf,f,c,e;if(a.status.animation||a.status.preparingItems)return a.status.callBackResize=
!0,a;f=p.getContentWidth();e=Math.floor(f/a.itemPrototype.width);if(e<a.settings.maxitem)e=a.settings.maxitem;if(e==d.maxAllowed)return a;f=d.maxAllowed;d.maxAllowed=e;if(!b)return a;a.status.animation=!0;a.stop();a.status.renderReset?(b=a.status.resizeCurrStart,c=a.status.resizeCurrEnd):(b=d.currStart,c=d.currEnd);e=c-b;if(d.maxAllowed>f){if(c!=a.itemIndex.length){for(f=a.canvas.front;e<d.maxAllowed;e++){c=b+e;if(c>=a.itemIndex.length)break;if(a.itemIndex[c]===h)break;c=a.items[a.itemIndex[c]].ele;
c.css("z-index",2).animate({opacity:1},0);f.append(c)}c=b+e}}else if(e>d.maxAllowed){for(;e>d.maxAllowed;e--){c=b+e-1;if(a.itemIndex[c]===h)break;c=a.items[a.itemIndex[c]].ele;c[0].parentNode&&c[0].parentNode.removeChild(c[0])}c=b+e}a.status.resizeCurrStart=b;a.status.resizeCurrEnd=c;d.currCnt=c-b;a.status.renderReset=!0;a.justifyElements();f=b%d.maxAllowed;0!=f&&(b+=d.maxAllowed-f);c=b+d.maxAllowed;if(c>a.itemIndex.length)c=a.itemIndex.length;d.currStart=b;d.currEnd=c;a.manageControls();a.events.onResize&&
a.events.onResize(d.maxAllowed,a.mainObj);a.status.animation=a.status.callBackResize=!1;a.play();a.updatePageNumber();a.events.changePageNumber&&a.events.changePageNumber(d.nowPage,d.maxPage,a.mainObj);1===a.settings.indicator&&(a.prepareIndicator(),a.renderIndicator());return a},updatePageNumber:function(){var b=Math.ceil(a.itemIndex.length/a.pageConf.maxAllowed),d;for(d=1;d<b&&!(a.pageConf.currEnd<=d*a.pageConf.maxAllowed);d++);a.pageConf.nowPage=d;a.pageConf.maxPage=b;return a},changePage:function(b){b=
(b-1)*a.pageConf.maxAllowed;a.render(b,b+a.pageConf.maxAllowed);return this},prepareIndicator:function(){if(1!==a.settings.indicator||a.eobj.indicatorDisplay===h)return a;for(var b=a.pageConf.maxPage,d="<div>",f=1;f<=b;f++)d+=a.indicatorPrototype.html;a.eobj.indicatorDisplay.empty().append(d+"</div>");d=a.eobj.indicatorDisplay.children();0===a.settings.indicatoralign?(b*=a.indicatorPrototype.width,d.css({position:"relative",width:b,height:"100%","float":"none"})):(b*=a.indicatorPrototype.height,d.css({position:"relative",
width:"100%",height:b,"float":"none"}));d.children().each(function(b,d){c(d).bind("click",function(d){if(b+1!==a.pageConf.nowPage)return d.preventDefault(),a.changePage(b+1),!1})});return a},renderIndicator:function(){if(a.eobj.indicatorDisplay===h)return a;for(var b=a.pageConf.nowPage,d=a.eobj.indicatorDisplay.children().find("div").removeClass("on"),f=0;f<d.length;f++){var g=c(d[f]);f+1==b&&g.addClass("on")}return a}}),c.extend(this,{prepareItems:function(b,d){var f=a.itemPrototype.html,g=a.itemPrototype.identifiers,
e="",j,k,o;if(a.status.preparingItems)return a;if(a.status.animation)return setTimeout(function(){a.prepareItems(b,d)},a.settings.pagespeed),a;a.status.preparingItems=!0;for(k=b;k<d;k++){e=f;j=a.items[a.itemIndex[k]];for(o in g)e=e.replace(g[o][1],j[o]!=h?g[o][0]+j[o]+g[o][2]:"");j.istravelitem&&(e=e.replace(/src/,"data-src"));j.ele=c(e);j.istravelitem&&function(){var a=j,b=j.ele.find("img[data-src]").eq(0);b.ready(function(){c("<img>").load(function(){this.height>this.width?c(b).height(a.istravelrecopopitem?
100:128):c(b).width(a.istravelrecopopitem?100:128);c(b).attr({src:c(b).attr("data-src")});c(b).removeAttr("data-src")}).attr({src:c(b).attr("data-src")})})}()}if(""!=a.itemEvents.remove)for(k=b;k<d;k++)a.items[a.itemIndex[k]].ele.find(a.itemEvents.remove).attr("id","").bind("click",{index:k},function(b){b.preventDefault();a.removeItem(b.data.index);return!1});a.status.preparingItems=!1;return a},removeItem:function(b){var m=a.canvas.front,f,g,e;f=!1;var j;if(a.status.animation||a.status.preparingItems)return!1;
a.items[b].ele.fadeOut(a.settings.opacityspeed,function(){c(this).remove()});a.events.onItemRemove&&a.events.onItemRemove(b,a.mainObj);if(1==a.itemIndex.length)return a.eobj.existItem.find("#riAshiatoColumn").html(a.eobj.prototypeAshiatoItemNotExists.show()),1>p.checkItemLength()&&a.events.onZeroItems&&a.events.onZeroItems(a.mainObj),!1;b=c.inArray(b+"",a.itemIndex);if(-1==b)return!1;a.itemIndex.splice(b,1);a.pageConf.currEnd==a.itemIndex.length+1&&(a.pageConf.currEnd--,a.pageConf.currCnt--);if(b==
a.itemIndex.length)a.events.afterRemove&&a.events.afterRemove(a.mainObj),0==b%a.pageConf.maxAllowed&&a.prev();else{a.status.animation=!0;for(g=b,e=0;!f;g++,e++){f=a.items[a.itemIndex[g]].ele;f.css({"z-index":1,opacity:0});if(j=g==a.pageConf.currEnd-1)m.append(f),g==b&&(e=1);setTimeout(function(b,d){return function(){b.animate({opacity:"1"},a.settings.opacityspeed,"linear",function(){a.status.animation=d;!a.status.animation&&a.status.callBackResize&&a.resize(!0);d||a.events.afterRemove&&a.events.afterRemove(a.mainObj)})}}(f,
!(f=g===a.itemIndex.length-1||j)),e*a.settings.pagespeed)}}a.justifyElements().manageControls();a.updatePageNumber();a.events.changePageNumber&&a.events.changePageNumber(d.nowPage,d.maxPage,a.mainObj);1===a.settings.indicator&&(a.prepareIndicator(),a.renderIndicator());return!1}}),a.initialize(),b.slideshow!==h)b.slideshow=a};c.fn.RJS_Slideshow_rev3=function(b,d){this.each(function(){new u(b,d)})};var t=function(){var b=this;c.extend(b,{settings:{noready:[0,"Int","^[0-1]$"],maxitem:[4,"Int","^[1-9]$"],
minitem:[1,"Int","^[1-9]$"],pagespeed:[100,"Range","0,9999"],opacityspeed:[100,"Range","0,9999"],omitname:[38,"Range","0,100"],autoslidetime:[2,"Range","1,99"],autoslideflag:["next","Str","^(next|prev)$"],autoslide:[0,"Int","^[0-1]$"],autoresize:[0,"Int","^[0-1]$"],impvar:["","Str","^[a-zA-Z0-9_]{3,64}$"],impdisp:["","Str","^[a-zA-Z0-9_]{3,64}$"],impnodisp:["","Str","^[a-zA-Z0-9_]{3,64}$"],verticalmode:[0,"Int","^[1]$"],ashiato_url:["","Str","^http(s?)+(:\\/\\/[a-zA-Z0-9_\\-\\.]+)(\\.rakuten\\.co\\.jp\\/)+([a-zA-Z0-9_&=\\?\\-\\.\\/]+)$"],
ashiato_del_redirect_url:["","Str","^http(s?)+(:\\/\\/[a-zA-Z0-9_\\-\\.]+)(\\.rakuten\\.co\\.jp\\/)+([a-zA-Z0-9_&=\\#\\?\\-\\.\\/]+)$"],ashiato_sid:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"],ashiato_mebius_prefix:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"],ashiato_imgsize:["80x80","Str","^[1-9]{1}[0-9]{1,2}x[1-9]{1}[0-9]{1,2}"],recopop_imgsize:["64x64","Str","^[1-9]{1}[0-9]{1,2}x[1-9]{1}[0-9]{1,2}"],recommend_url:["","Str","^http(s?)+(:\\/\\/[a-zA-Z0-9_\\-\\.]+)(\\.rakuten\\.co\\.jp\\/)+([a-zA-Z0-9_&=\\?\\-\\.\\/]+)$"],
recommend_sid:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"],ranking_url:["","Str","^http(s?)+(:\\/\\/[a-zA-Z0-9_\\-\\.]+)(\\.rakuten\\.co\\.jp\\/)+([a-zA-Z0-9_&=\\?\\-\\.\\/]+)$"],ranking_sid:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"],ranking_genrelayer:[1,"Int","^[1-5]$"],ajaxtimer:[3,"Range","1,99"],recothreshold:[6,"Int","^[1-9].*$"],rankingshuffle:[1,"Int","^[0-1]$"],requestwait:[500,"Range","0,9999"],itempricedisp:[1,"Int","^[0-1]$"],tailimagesize:[0,"Range","0,9999"],recopopwidth:[0,"Range","0,9999"],doublecolumn:[0,
"Int","^[0-1]$"],recopopmaxitem:[6,"Range","1,7"],indicator:[0,"Int","^[0-1]$"],indicatoralign:[0,"Int","^[0-1]$"],mouseovertimer:[0.5,"Range","0,9999"],genrefilter:["551169","Str","^[0-9,]{1,69}$"],recommend_layer_url:["","Str","^http(s?)+(:\\/\\/[a-zA-Z0-9_\\-\\.]+)(\\.rakuten\\.co\\.jp\\/)+([a-zA-Z0-9_&=\\?\\-\\.\\/]+)$"],shoplogo:[1,"Int","^[0-2]$"],notravel:[0,"Int","^[0-1]$"]},eobj:{config:c("#ashiatoIchibaConfig"),existItem:c("#ashiatoIchibaExistItemDisplay"),overMaxItem:c("#ashiatoOverMaxItemDisplay"),
prototypeAshiatoItem:c("#prototypeIchibaAshiatoItem"),prototypeRecoPopItem:c("#prototypeIchibaRecoPopItem"),prototypeRecoPopFrame:c("#prototypeIchibaRecoPopFrame"),prototypeAshiatoItemNotExists:c("#prototypeAshiatoIchibaItemNotExists"),prevButton:c("#ashiatoIchibaPrevButton"),nextButton:c("#ashiatoIchibaNextButton"),loading:c("#ashiatoLoading"),altContents:c("#ashiatoIchibaAlteredContents"),itemsDisplay:c("#ashiatoIchibaItemsDisplay"),indicatorDisplay:c("#ashiatoIchibaIndicatorArea"),prototypeIndicator:c("#prototypeIchibaAshiatoIndicator")},
recoPop_eobj:{loading:null,itemsFrame:null,itemsDisplay:null,prevButton:null,nextButton:null,wrapper:null},status:{error:!1,isTimeout:!1,isAjax:null},props:{ashiato:{items:[],itemEvents:{remove:"#prototypeAshiatoRemove"},itemPrototype:{html:"",height:0,width:0,identifiers:{itemurl:["",/\#ITEMURL\#/g,""],imageele:['<img src="#ITEMIMGURL#" alt="#ITEMIMGALT#" title="#ITEMIMGTITLE#">',/\#ITEMIMGELE\#/g,""],imageurl:["",/\#ITEMIMGURL\#/g,""],imagealt:["",/\#ITEMIMGALT\#/g,""],imagetitle:["",/\#ITEMIMGTITLE\#/g,
""],itemname:["",/\#ITEMNAME\#/g,""],itemprice:["",/\#ITEMPRICE\#/g,""],index:["",/\#INDEX\#/g,""],itemid:["",/\#ITEMID\#/g,""],shopid:["",/\#SHOPID\#/g,""],shopimage:["",/\#SHOPIMAGE\#/,""],shopimageclass:["",/\#SHOPIMAGECLASS\#/,""],genreidlist:["",/\#GENREID\#/g,""],shopurl:["",/\#SHOPURL\#/g,""],mngnumber:["",/\#MNGNUMBER\#/g,""]}}},recommend:{items:[],cachedObj:[],index:-1,itemPrototype:{html:"",identifiers:{itemimg1:['<img src="#ITEMIMGURL1#" alt="#ITEMIMGALT1#" title="#ITEMIMGTITLE1#">',/\#ITEMIMG1\#/g,
""],itemurl1:["",/\#ITEMURL1\#/g,""],imageurl1:["",/\#ITEMIMGURL1\#/g,""],imagealt1:["",/\#ITEMIMGALT1\#/g,""],imagetitle1:["",/\#ITEMIMGTITLE1\#/g,""],itemprice1:["",/\#ITEMPRICE1\#/g,""],itemimg2:['<img src="#ITEMIMGURL2#" alt="#ITEMIMGALT2#" title="#ITEMIMGTITLE2#">',/\#ITEMIMG2\#/g,""],itemurl2:["",/\#ITEMURL2\#/g,""],imageurl2:["",/\#ITEMIMGURL2\#/g,""],imagealt2:["",/\#ITEMIMGALT2\#/g,""],imagetitle2:["",/\#ITEMIMGTITLE2\#/g,""],itemprice2:["",/\#ITEMPRICE2\#/g,""]}}},indicatorPrototype:{html:"",
width:0,hheight:0},delUrlIndex:"delurl",tailImgHalfSize:0,exclusive:!1,recoPopFocus:!1,recoPopTimer:null},initialize:function(){b.loadSettings()?1===b.settings.noReady?b.begin():jQuery(document).ready(function(){b.begin()}):b.displayDefaultContents()},loadSettings:function(){b.settings=c.RJS_Helpers.readAttr(b.eobj.config,b.settings);if(""==b.settings.ashiato_url||512<b.settings.ashiato_url.length||""==b.settings.recommend_url||512<b.settings.recommend_url.length||""==b.settings.ranking_url||512<
b.settings.ranking_url.length)return!1;b.settings.autoslidetime*=1E3;b.settings.ajaxtimer*=1E3;b.settings.mouseovertimer*=1E3;if(0===b.eobj.prototypeAshiatoItem.length||0===b.eobj.prototypeRecoPopItem.length||0===b.eobj.prototypeRecoPopFrame.length)return!1;b.settings.tailimagesize=Math.floor(b.settings.tailimagesize/2);b.eobj.config.remove();return!0},begin:function(){b.getAshiatoData();b.status.error=!b.getAshiatoPrototype();b.status.error=!b.getRecoPopPrototype()},getAshiatoData:function(){function d(d,
c){if(b.status.isTimeout)return c(),!1;clearTimeout(a);if(d.code===h||d.num===h)return b.displayDefaultContents(),c(),!1;if("1"==d.code||"8"==d.code)return b.displayDefaultContents(b.settings.impnodisp),c(),!1;if("0"!=d.code)return b.displayDefaultContents(),c(),!1;if(1>d.items.length)return b.displayDefaultContents(b.settings.impnodisp),c(),!1;for(var g=0,e=function(){var a=this.data;b.props.ashiato.items[this.i]={index:this.i,delurl:b.editItemDelUrl(a.delurl),itemname:b.editItemname(a.itemname),
itemprice:b.editItemprice(a.itemprice),itemurl:b.editItemurl(a.itemurlfull,b.settings.ashiato_sid)+(b.settings.ashiato_mebius_prefix?"&"+b.settings.ashiato_mebius_prefix+"="+a.itemid:""),imageele:"",imageurl:""!=a.imageurl?b.editImageurl(a.imageurl,b.settings.ashiato_imgsize):a.imageurl64,imagealt:b.editItemname(a.itemname),imagetitle:b.editItemname(a.itemname),mngnumber:a.mngnumber,shopurl:a.shopurl,shopimage:1>=this.width?a.shopname:'<img src="'+this.src+'" alt="'+a.shopname+'" title="'+a.shopname+
'">',shopimageclass:1>=this.width?"ashiatoIchibaShopText":"ashiatoIchibaShopImage",itemid:a.itemid,shopid:a.shopid,genreidlist:a.genreidlist};++g==d.items.length&&(b.status.error?b.displayDefaultContents():(b.startSlideshow(),b.regImpressionCode(b.settings.impdisp)),c())},j=[],i=0;d.items.length>i;i++){var o=d.items[i];j[i]=new Image;j[i].onload=j[i].onerror=e;j[i].data=o;j[i].i=i;2==b.settings.shoplogo?(j[i].width=1,j[i].onload()):j[i].src="http://thumbnail.image.rakuten.co.jp/@0_mall/"+o.shopurl+
"/logo/logo2"+(1==b.settings.shoplogo?"n":"")+".jpg?_ex=280x140"}}var a;b.status.isTimeout=!1;try{a=setTimeout(function(){b.status.isTimeout=!0;b.displayDefaultContents();b.status.isAjax=!1;p.checkTabs()},b.settings.ajaxtimer),c.ajax({url:b.settings.ashiato_url,cache:!1,dataType:"jsonp",scriptCharset:"euc-jp",timeout:b.settings.ajaxtimer,success:function(a){d(a,function(){b.status.isAjax=!0;p.checkTabs()})},error:function(){b.displayDefaultContents();b.status.isTimeout=!0;b.status.isAjax=!1;p.checkTabs()}})}catch(i){return b.displayDefaultContents(),
b.status.isAjax=!1,p.checkTabs(),!1}return!0},getAshiatoPrototype:function(){var d=b.eobj.prototypeAshiatoItem,a=b.props.ashiato.itemPrototype;if(0==d.length)return!1;1!==b.settings.itempricedisp&&d.find(".ashiatoPrice span").remove();a.width=d.outerWidth();a.height=d.outerHeight();a.html=d.html();if(""==a.html)return!1;d.remove();if(1===b.settings.indicator){d=b.eobj.prototypeIndicator;a=b.props.indicatorPrototype;if(0==d.length)return!1;a.width=d.outerWidth();a.height=d.outerHeight();a.html=d.html();
if(""==a.html)return!1}return!0},startSlideshow:function(){b.eobj.existItem.show();b.eobj.itemsDisplay.RJS_Slideshow_rev3(b,{settings:b.settings,itemPrototype:b.props.ashiato.itemPrototype,indicatorPrototype:b.props.indicatorPrototype,eobj:b.eobj,items:b.props.ashiato.items,itemEvents:b.props.ashiato.itemEvents,events:{onItemRemove:b.deleteItem,afterRemove:b.afterRemove,onZeroItems:b.removeSlideShow,afterFirstRender:b.afterFirstRender,beforeFirstRender:b.beforeFirstRender,startSlide:b.startSlide,
afterSlide:b.afterSlide,onResize:b.onResize}});b.eobj.existItem.hide()},getRecommendData:function(d,a,i,m){var f;b.status.isTimeout=!1;try{f=setTimeout(function(){b.status.isTimeout=!0;b.getRankingData(d,a,i,m)},b.settings.ajaxtimer);var g=b.props.ashiato.items[d];c.ajax({url:b.settings.recommend_layer_url,cache:!1,dataType:"jsonp",data:{item_id:g.shopid+"_"+g.itemid},scriptCharset:"euc-jp",timeout:b.settings.ajaxtimer,success:function(c){if(b.status.isTimeout)c=!1;else if(clearTimeout(f),c.status===
h||c.item_count===h||"Success"!=c.status&&"NotFound"!=c.status)c=!1;else{for(var e=[],g=0;g<c.item.length;g++)e.push({itemurl:b.editItemurl(c.item[g].item_url,b.settings.recommend_sid)+(b.settings.ashiato_mebius_prefix?"&"+b.settings.ashiato_mebius_prefix+"="+c.item[g].item_id:""),itemprice:b.editItemprice(c.item[g].item_price),imageele:"",imageurl:b.editImageurl(c.item[g].small_image_url,b.settings.recopop_imgsize),imagealt:b.editItemname(c.item[g].item_name),imagetitle:b.editItemname(c.item[g].item_name),
shopid:c.item[g].shop_id,itemid:c.item[g].item_id});b.props.recommend.items[d]=e;c=c.item_count<b.settings.recothreshold*(1+parseInt(b.settings.doublecolumn))?!1:b.prepareRecoPopItems(d,a,i,m)}c||b.getRankingData(d,a,i,m)},error:function(){b.getRankingData(d,a,i,m)}})}catch(e){return b.getRankingData(d,a,i,m)}return!0},getRankingData:function(d,a,i,m){var f;b.status.isTimeout=!1;try{var g=b.props.ashiato.items[d].genreidlist.replace(/^\//,"").split("/"),e=b.settings.genrefilter.split(","),j;for(j in e)if(-1!=
c.inArray(e[j],g))return b.prepareRecoPopItems(d,a,i,m),!1;g=g[b.settings.ranking_genrelayer];g===h&&(g=0);f=setTimeout(function(){b.status.isTimeout=!0;b.prepareRecoPopItems(d,a,i,m)},b.settings.ajaxtimer);c.ajax({url:b.settings.ranking_url,cache:!0,dataType:"jsonp",data:{gid:g},jsonpCallback:"jsonp0123456789012",scriptCharset:"euc-jp",timeout:b.settings.ajaxtimer,success:function(e){if(!b.status.isTimeout&&(clearTimeout(f),!(e.status===h||e.num===h||"Success"!=e.status&&"GenreNotFound"!=e.status||
0==e.num))){for(var g=b.props.ashiato.items[d],j=[],k=0;k<e.items.length;k++){var l=(/R2=([^\&]+)/.exec(e.items[k].itemurl)||[])[1],n=!0;if(l===h&&/^http:\/\/item.rakuten.co.jp/.test(e.items[k].itemurl))n=!1,l=e.items[k].itemurl;l!==h&&(b.endsWith(l,g.shopurl+"/"+g.mngnumber+"/")||j.push({itemurl:b.editItemurl(e.items[k].itemurl,b.settings.ranking_sid,n)+(b.settings.ashiato_mebius_prefix?"&"+b.settings.ashiato_mebius_prefix+"="+e.items[k].itemid:""),itemprice:b.editItemprice(e.items[k].price),imageele:"",
imageurl:b.editImageurl(e.items[k].imageurl64,b.settings.recopop_imgsize),imagealt:b.editItemname(e.items[k].itemname),imagetitle:b.editItemname(e.items[k].itemname),shopid:e.items[k].shopid,itemid:e.items[k].itemid}))}1===b.settings.rankingshuffle&&(j=b.shuffle(j));e=b.props.recommend.items[d];e==h&&(e=[]);e=c.merge(e,j);for(k=0;k<e.length;k++)if(""==e[k].itemurl||e[k].itemurl==h||""==e[k].itemprice||e[k].itemprice==h)e.splice(k,1),k--;b.props.recommend.items[d]=e}b.prepareRecoPopItems(d,a,i,m)},
error:function(){b.prepareRecoPopItems(d,a,i,m)}})}catch(k){b.prepareRecoPopItems(d,a,i,m)}},getRecoPopPrototype:function(){var d=b.eobj.prototypeRecoPopItem,a=b.props.recommend.itemPrototype;if(0==d.length)return!1;a.html=d.html();if(""==a.html)return!1;d.remove();return!0},prepareRecoPopItems:function(d,a,c,m){if(b.props.recommend.items[d]===h||0==b.props.recommend.items[d].length)return b.displayAlteredContents(d,a,c);var f=b.props.recommend.items[d];if("0"==b.settings.doublecolumn){for(var g=
[],e=0;e<f.length;e++)g.push({index1:e,itemimg1:"",itemurl1:f[e].itemurl,imageurl1:f[e].imageurl,itemprice1:f[e].itemprice,imagealt1:f[e].imagealt,imagetitle1:f[e].imagetitle,shopid1:f[e].shopid,itemid1:f[e].itemid,index2:h,itemimg2:h,itemurl2:h,imageurl2:h,itemprice2:h,imagealt2:h,imagetitle2:h,shopid2:h,itemid2:h});f=g}else if("1"==b.settings.doublecolumn){g=[];1==f.length%2&&f.splice(f.length-1,1);for(e=0;e<f.length;e++)g.push({index1:e,itemimg1:"",itemurl1:f[e].itemurl,imageurl1:f[e].imageurl,
itemprice1:f[e].itemprice,imagealt1:f[e].imagealt,imagetitle1:f[e++].imagetitle,shopid1:f[e].shopid,itemid1:f[e].itemid,itemimg2:"",itemurl2:f[e].itemurl,imageurl2:f[e].imageurl,itemprice2:f[e].itemprice,imagealt2:f[e].imagealt,imagetitle2:f[e].imagetitle,shopid2:f[e].shopid,itemid2:f[e].itemid});f=g}if(0==f.length)return b.displayAlteredContents(d,a,c);b.props.recommend.items[d]=f;b.prepareRecoPopSlideshow(d,a,m);b.startRecoPopSlideshow(d);return!0},prepareRecoPopSlideshow:function(d,a,i){b.props.recommend.cachedObj[d]==
h?(b.recoPop_eobj.loading=a,b.recoPop_eobj.itemsFrame=i,b.recoPop_eobj.itemsDisplay=i.find(".recoPopItemsDisplay"),b.recoPop_eobj.prevButton=i.find(".recoPopPrevButton"),b.recoPop_eobj.nextButton=i.find(".recoPopNextButton"),b.props.recommend.cachedObj[d]=c.extend(!0,{},b.recoPop_eobj)):(d=c.extend(!0,{},b.props.recommend.cachedObj[d]),b.recoPop_eobj.loading=d.loading,b.recoPop_eobj.itemsDisplay=d.itemsDisplay,b.recoPop_eobj.prevButton=d.prevButton,b.recoPop_eobj.nextButton=d.nextButton)},startRecoPopSlideshow:function(d){if(!(b.props.recommend.items[d]===
h||0==b.props.recommend.items[d].length)){var a=b.settings.maxitem;b.settings.maxitem=b.settings.recopopmaxitem;b.recoPop_eobj.itemsDisplay.RJS_Slideshow_rev3(b,{settings:b.settings,itemPrototype:b.props.recommend.itemPrototype,eobj:b.recoPop_eobj,items:b.props.recommend.items[d],events:{beforeFirstRender:b.recoPop_beforeFirstRender}});b.settings.maxitem=a}},displayAlteredContents:function(b,a,c){a.hide();a.siblings(".recoPopPrevButton").hide();a.siblings(".recoPopNextButton").hide();c.show();return!0},
initRecoPop:function(){var d=p.getContentWidth(),a=b.settings.recopopwidth,i=0,m=0,f=0;b.eobj.itemsDisplay.find(".riAshiatoContSpr.travel").unbind("mouseenter").unbind("mouseleave").hover(function(){if(!b.props.exclusive){var a=c(this).attr("index"),d=c(this).find(".recoPopAlteredCnt"),f=c(this).find(".riAshiatoRecoPopList"),i=b.props.recommend.items[a];b.recoPop_eobj.wrapper=c(this).find(".riAshiatoRecoPopWrapper");d.hide();b.props.recommend.index=a;0==f.children().length&&f.append(b.eobj.prototypeRecoPopFrame.html());
var m=c(this).find(".recoPopLoading");i===h?(b.props.recoPopFocus=!0,b.props.recoPopTimer=setTimeout(function(){b.props.recoPopFocus&&(b.getRecommendData(a,m,d,f)?b.startRecoPopSlideshow(a):b.displayAlteredContents(a,m,d))},b.settings.requestwait)):0==i.length?(m.remove(),f.hide(),d.show()):(b.prepareRecoPopSlideshow(a,m,f),f.show());c(this).find(".riAshiatoRecoPopList").css({"margin-left":"auto","margin-right":"auto"});c(this).parent().css("position","");c(this).addClass("hover");c(this).find(".riAshiatoRecoPopFrame").fadeIn()}},
function(){c(this).find(".riAshiatoRecoPopFrame").stop(!0,!0).hide();c(this).removeClass("hover");c(this).parent().css("position","relative");c(this).find(".riAshiatoRecoPopList").hide();c(this).find(".recoPopLoading").show();clearTimeout(b.props.recoPopTimer);b.props.recoPopFocus=!1}).each(function(g){var e=c(this).find(".riAshiatoRecoPopFrame");0==g&&(i=p.getItemWidth(),m=Math.floor(d/i)/2,f=Math.floor((d-a)/2));var j=f;0<g&&(j-=i*g);var h=e.find(".tail");g<m?(g=Math.floor(f*(m-(g+1))/m),0<g&&(j-=
g),j>i/4?(j=i/4,h.css("left","")):(g=i/2-j-b.settings.tailimagesize,h.css("left",g))):(g=Math.floor(f*(g-m)/m),0<g&&(j+=g),j+a<3*i/4?(j+=3*i/4-(j+a),g=i/2+Math.abs(j)-b.settings.tailimagesize):g=i/2-j-b.settings.tailimagesize,h.css("left",g));e.css("left",j)})},regImpressionCode:function(d){return q[b.settings.impvar]===h||""==d?"":q[b.settings.impvar]=d},afterRemove:function(b){b.initRecoPop();b.props.exclusive=!1},deleteItem:function(b,a){a.props.exclusive=!0;try{return(new Image).src=a.props.ashiato.items[b][a.props.delUrlIndex],
!0}catch(c){return!1}},displayDefaultContents:function(d){b.eobj.loading.remove();b.eobj.altContents.show();b.eobj.existItem.find("#riAshiatoColumn").html(b.eobj.prototypeAshiatoItemNotExists.show());d&&b.regImpressionCode(d)},afterFirstRender:function(b,a){a.props.ashiato.items.length>b&&a.eobj.overMaxItem.show();a.initRecoPop()},beforeFirstRender:function(b,a){a.eobj.loading.remove();a.eobj.itemsDisplay.show()},startSlide:function(){b.props.exclusive=!0},afterSlide:function(){b.initRecoPop();b.props.exclusive=
!1},onResize:function(){b.initRecoPop()},removeSlideShow:function(b){c("#ashiatoTabTitle").hide();b.eobj.existItem.css("visibility","hidden").slideUp("fast",function(){c(this).remove()})},recoPop_beforeFirstRender:function(b,a){a.recoPop_eobj.loading.remove();a.recoPop_eobj.itemsFrame.show()},shuffle:function(b){for(var b=Array.apply(null,b),a=b.length;a;){var c=Math.floor(Math.random()*a),h=b[--a];b[a]=b[c];b[c]=h}return b},endsWith:function(b,a){var c=b.length-a.length;return 0<=c&&b.lastIndexOf(a)===
c},editItemprice:function(b){return""!=b&&b!==h?(""+b).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"):b},editItemname:function(d){d=c.RJS_Helpers.omitStr(d,b.settings.omitname,"¡Ä");c.browser.msie||(d=d.split("").join(String.fromCharCode(8203)));return d},editImageurl:function(b,a){""!=b&&a!==h&&(b=c.RJS_Helpers.urlParameter(b,{_ex:a}));return b},editItemurl:function(b,a,i){""!=a&&(b=i?c.RJS_Helpers.urlR2Parameter(b,{"s-id":a},!1):c.RJS_Helpers.urlParameter(b,{"s-id":a},!1));return b},editItemDelUrl:function(d){return d&&
0<d.length?b.settings.ashiato_del_redirect_url?b.settings.ashiato_del_redirect_url.replace(/\#ITEMDELREDIRECTURL\#/g,encodeURIComponent(d)):d:""}})},n,l,p;(function(){n=new t;c.extend(!0,n,{eobj:{config:c("#ashiatoIchibaConfig"),existItem:c("#ashiatoIchibaExistItemDisplay"),prototypeAshiatoItem:c("#prototypeIchibaAshiatoItem"),prototypeRecoPopItem:c("#prototypeIchibaRecoPopItem"),prototypeRecoPopFrame:c("#prototypeIchibaRecoPopFrame"),prevButton:c("#ashiatoIchibaPrevButton"),nextButton:c("#ashiatoIchibaNextButton"),
altContents:c("#ashiatoIchibaAlteredContents"),itemsDisplay:c("#ashiatoIchibaItemsDisplay"),indicatorDisplay:c("#ashiatoIchibaIndicatorArea"),prototypeIndicator:c("#prototypeIchibaAshiatoIndicator")}});n.initialize();if(1==n.settings.notravel)l=null;else{var b;b=l=new t;c.extend(!0,b,{settings:{ashiato_cid:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"],ashiato_img_url:["","Str","^http(s?)+(:\\/\\/[a-zA-Z0-9_\\-\\.]+)(\\.travel\\.rakuten\\.co\\.jp\\/)+([a-zA-Z0-9_&=\\?\\-\\.\\/]+)$"],ashiato_del_url:["","Str",
"^http(s?)+(:\\/\\/[a-zA-Z0-9_\\-\\.]+)(\\.travel\\.rakuten\\.co\\.jp\\/)+([a-zA-Z0-9_&=\\?\\-\\.\\/]+)$"],recommend_img_url:["","Str","^http(s?)+(:\\/\\/[a-zA-Z0-9_\\-\\.]+)(\\.rakuten\\.co\\.jp\\/)+([a-zA-Z0-9_&=\\?\\-\\.\\/]+)$"],recommend_cid:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"]},eobj:{config:c("#ashiatoTravelConfig"),existItem:c("#ashiatoTravelExistItemDisplay"),prototypeAshiatoItem:c("#prototypeTravelAshiatoItem"),prototypeRecoPopItem:c("#prototypeTravelRecoPopItem"),prototypeRecoPopFrame:c("#prototypeTravelRecoPopFrame"),
prototypeAshiatoItemNotExists:c("#prototypeAshiatoItemTravelNotExists"),prevButton:c("#ashiatoTravelPrevButton"),nextButton:c("#ashiatoTravelNextButton"),altContents:c("#ashiatoTravelAlteredContents"),itemsDisplay:c("#ashiatoTravelItemsDisplay"),indicatorDisplay:c("#ashiatoTravelIndicatorArea"),prototypeIndicator:c("#prototypeTravelAshiatoIndicator")},loadSettings:function(){b.settings=c.RJS_Helpers.readAttr(b.eobj.config,b.settings);if(""==b.settings.ashiato_url||512<b.settings.ashiato_url.length||
""==b.settings.ashiato_del_url||512<b.settings.ashiato_del_url.length||""==b.settings.ashiato_img_url||512<b.settings.ashiato_img_url.length||""==b.settings.recommend_url||512<b.settings.recommend_url.length||""==b.settings.recommend_img_url||512<b.settings.recommend_img_url.length||""==b.settings.ranking_url||512<b.settings.ranking_url.length)return!1;b.settings.autoslidetime*=1E3;b.settings.ajaxtimer*=1E3;b.settings.mouseovertimer*=1E3;if(0===b.eobj.prototypeAshiatoItem.length||0===b.eobj.prototypeRecoPopItem.length||
0===b.eobj.prototypeRecoPopFrame.length)return!1;b.settings.tailimagesize=Math.floor(b.settings.tailimagesize/2);b.eobj.config.remove();return!0},getAshiatoData:function(){function d(d){if(b.status.isTimeout)return!1;clearTimeout(a);if("ERROR"==b.status)return!1;if("Success"!=d.header.status||null!=d.header.statusMsg)return b.displayDefaultContents(),!1;if(!d.body.contents||1>d.body.contents.length)return!1;for(var c=0;c<d.body.contents.length;c++){var g=d.body.contents[c].hotelBasicInfo;b.props.ashiato.items.push({index:c,
delurl:b.editItemDelUrl(b.settings.ashiato_del_url,g.hotelNo),itemname:b.editItemname(g.hotelName),itemprice:b.editItemrate(g.reviewAverage),itemurl:g.hotelInformationUrl+(b.settings.ashiato_cid?"?cid="+b.settings.ashiato_cid:"")+(b.settings.ashiato_mebius_prefix?"&"+b.settings.ashiato_mebius_prefix+"="+g.hotelNo:""),imageele:"",imageurl:b.editItemImgUrl(b.settings.ashiato_img_url,g.hotelNo),imagealt:b.editItemname(g.hotelName),imagetitle:b.editItemname(g.hotelName),mngnumber:null,shopurl:"",itemid:g.hotelNo,
shopid:null,genreidlist:null,istravelitem:!0})}if(b.status.error)return b.displayDefaultContents(),!1;b.startSlideshow();b.regImpressionCode(b.settings.impdisp);return!0}var a;b.status.isTimeout=!1;try{a=setTimeout(function(){b.status.isTimeout=!0;b.displayDefaultContents();b.status.isAjax=!1;p.checkTabs()},b.settings.ajaxtimer),c.ajax({url:b.settings.ashiato_url,cache:!1,dataType:"jsonp",scriptCharset:"UTF-8",timeout:b.settings.ajaxtimer,success:function(a){d(a);b.status.isAjax=!0;p.checkTabs()},
error:function(){b.displayDefaultContents();b.status.isTimeout=!0;b.status.isAjax=!1;p.checkTabs()}})}catch(i){return b.displayDefaultContents(),b.status.isAjax=!1,p.checkTabs(),!1}return!0},getRecommendData:function(d,a,i,m){var f;b.status.isTimeout=!1;try{f=setTimeout(function(){b.status.isTimeout=!0;b.getRankingData(d,a,i,m)},b.settings.ajaxtimer),c.ajax({url:b.settings.recommend_url,cache:!1,dataType:"jsonp",data:{hotelNo:b.props.ashiato.items[d].itemid,service:"domesticHotel"},scriptCharset:"UTF-8",
timeout:b.settings.ajaxtimer,success:function(c){if(b.status.isTimeout)c=!1;else if(clearTimeout(f),c.header.status===h||c.body.contents.length===h||"Success"!=c.header.status&&"NotFound"!=c.header.status)c=!1;else{for(var g=[],k=0;k<c.body.contents.length;k++){var l=c.body.contents[k].hotelBasicInfo;g.push({itemurl:l.hotelInformationUrl+(b.settings.recommend_cid?"?cid="+b.settings.recommend_cid:"")+(b.settings.ashiato_mebius_prefix?"&"+b.settings.ashiato_mebius_prefix+"="+l.hotelNo:""),itemrate:b.editItemrate(l.reviewAverage),
imageele:"",imageurl:b.editImageurl(b.settings.recommend_img_url+l.hotelNo,b.settings.recopop_imgsize),imagealt:b.editItemname(l.hotelName),imagetitle:b.editItemname(l.hotelName),istravelitem:!0,istravelrecopopitem:!0})}b.props.recommend.items[d]=g;c=c.item_count<b.settings.recothreshold*(1+parseInt(b.settings.doublecolumn))?!1:b.prepareRecoPopItems(d,a,i,m)}c||b.getRankingData(d,a,i,m)},error:function(){b.getRankingData(d,a,i,m)}})}catch(g){return b.getRankingData(d,a,i,m)}return!0},prepareRecoPopItems:function(d,
a,c,m){if(b.props.recommend.items[d]===h||0==b.props.recommend.items[d].length)return b.displayAlteredContents(d,a,c);var f=b.props.recommend.items[d];if("0"==b.settings.doublecolumn){for(var g=[],e=0;e<f.length;e++)g.push({itemimg1:"",itemurl1:f[e].itemurl,imageurl1:f[e].imageurl,itemprice1:f[e].itemrate,imagealt1:f[e].imagealt,imagetitle1:f[e].imagetitle,itemimg2:h,itemurl2:h,imageurl2:h,itemprice2:h,imagealt2:h,imagetitle2:h,istravelitem:!0,istravelrecopopitem:!0});f=g}else if("1"==b.settings.doublecolumn){g=
[];1==f.length%2&&f.splice(f.length-1,1);for(e=0;e<f.length;e++)g.push({itemimg1:"",itemurl1:f[e].itemurl,imageurl1:f[e].imageurl,itemprice1:f[e].itemrate,imagealt1:f[e].imagealt,imagetitle1:f[e++].imagetitle,itemimg2:"",itemurl2:f[e].itemurl,imageurl2:f[e].imageurl,itemprice2:f[e].itemprice,imagealt2:f[e].imagealt,imagetitle2:f[e].imagetitle,istravelitem:!0,istravelrecopopitem:!0});f=g}if(0==f.length)return b.displayAlteredContents(d,a,c);b.props.recommend.items[d]=f;b.prepareRecoPopSlideshow(d,
a,m);b.startRecoPopSlideshow(d);return!0},editItemrate:function(b){if(""!=b&&b!==h&&null!==b){for(var a=b.length;4>a;a++)b=1==a?b+".":b+"0";return(""+b).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}return"-.--"},editItemImgUrl:function(b,a){return b&&0<b.length&&a&&0<a.length?c.RJS_Helpers.urlParameter(b,{no:a},!1):""},editItemDelUrl:function(d,a){return d&&0<d.length&&a&&0<a.length?b.settings.ashiato_del_redirect_url?b.settings.ashiato_del_redirect_url.replace(/\#ITEMDELREDIRECTURL\#/g,encodeURIComponent(c.RJS_Helpers.urlParameter(d,
{hotelNo:a},!1))):c.RJS_Helpers.urlParameter(d,{hotelNo:a},!1):""}});b.initialize()}})();p=new function(){var b=this,d=!1;c.extend(b,{initialize:function(){},checkTabs:function(){var a=n.status.isAjax,d=0<n.props.ashiato.items.length,h=!1,f=!1;if(null!=l)h=l.status.isAjax,f=0<l.props.ashiato.items.length;if(!(null===a||null===h)){if(a&&d)h&&f?b.activeTabs(0):b.activeTabs(2);else if(h&&f)b.activeTabs(3);else return;c("#ashiatoTabTitle").show()}},activeTabs:function(a){0==a?(c("#ashiatoTab_0_linked").hide(),
c("#ashiatoTab_0_unlink").fadeIn(),c("#ashiatoTab_1_linked").fadeIn(),c("#ashiatoTab_1_unlink").hide(),n.eobj.existItem.fadeIn(),l&&l.eobj.existItem.hide(),c("#ashiatoTabTitle").find(".ashiatoTabLink").each(function(){var a=c(this);a.attr("href",a.attr("data-ichibalink"))}),b.bindEvents()):1==a?(c("#ashiatoTab_0_linked").fadeIn(),c("#ashiatoTab_0_unlink").hide(),c("#ashiatoTab_1_linked").hide(),c("#ashiatoTab_1_unlink").fadeIn(),n.eobj.existItem.hide(),l&&l.eobj.existItem.fadeIn(),c("#ashiatoTabTitle").find(".ashiatoTabLink").each(function(){var a=
c(this);a.attr("href",a.attr("data-travellink"))}),b.bindEvents()):2==a?(c("#ashiatoTab_0_linked").hide(),c("#ashiatoTab_0_unlink").hide(),c("#ashiatoTab_1_linked").hide(),c("#ashiatoTab_1_unlink").hide(),c("#ashiatoTabs").parent().remove(),n.eobj.existItem.fadeIn(),l&&l.eobj.existItem.hide(),c("#ashiatoTabTitle").find(".ashiatoTabLink").each(function(){var a=c(this);a.attr("href",a.attr("data-ichibalink"))})):3==a&&(c("#ashiatoTab_0_linked").hide(),c("#ashiatoTab_0_unlink").hide(),c("#ashiatoTab_0").remove(),
c("#ashiatoTab_1_linked").hide(),c("#ashiatoTab_1_unlink").fadeIn(),n.eobj.existItem.hide(),l&&l.eobj.existItem.fadeIn(),c("#ashiatoTabTitle").find(".ashiatoTabLink").each(function(){var a=c(this);a.attr("href",a.attr("data-travellink"))}))},bindEvents:function(){if(!d){d=!0;var a;c("#ashiatoTab_0").bind({click:function(){b.activeTabs(0)},mouseover:function(){clearTimeout(a);a=null;a=setTimeout(function(){b.activeTabs(0)},n.settings.mouseovertimer)},mouseout:function(){clearTimeout(a);a=null}});c("#ashiatoTab_1").bind({click:function(){b.activeTabs(1)},
mouseover:function(){clearTimeout(a);a=null;a=setTimeout(function(){b.activeTabs(1)},n.settings.mouseovertimer)},mouseout:function(){clearTimeout(a);a=null}})}},checkItemLength:function(){return n.eobj.existItem.find(".riAshiatoContSpr").length+(l?l.eobj.existItem.find(".riAshiatoContSpr").length:0)},getContentWidth:function(){return Math.max(n.eobj.itemsDisplay.width(),l?l.eobj.itemsDisplay.width():0,c("#ashiatoTabTitle").width())},getItemWidth:function(){return Math.max(n.eobj.itemsDisplay.find(".riAshiatoContSpr").parent().width(),
l?l.eobj.itemsDisplay.find(".riAshiatoContSpr").parent().width():0)}})};p.initialize()}})(this);
