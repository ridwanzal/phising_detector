/*
 ashiato_shop_logo 1.1.0
 Copyright (c) 2015 Rakuten.Inc
 Date : 2015-05-29 11:30:24
*/
(function(h,l){var b=h.jQuery;"function"!==typeof b||!b.RJS_Helpers||!b.fn.RJS_Slideshow||(new function(){var a=this;b.extend(a,{slideshow:null,settings:{url:["","Str","^https?://(?:[a-zA-Z0-9\\-]+\\.)+rakuten\\.co\\.jp/[a-zA-Z0-9!~_&='\\(\\)\\*\\?\\-\\.%/]+$"],autoslidetime:[7E3,"Range","0,9999"],autoslide:[0,"Int","^[0-1]$"],autoslideflag:["next","Str","^(next|prev)$"],maxitem:[2,"Int","^[1-9]$"],sid:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"],verticalmode:[0,"Int","^[1]$"],pagespeed:[50,"Range","0,9999"],
imagesize:["190x80","Str","^[1-9]{1}[0-9]{1,2}x[1-9]{1}[0-9]{1,2}"],opacityspeed:[200,"Range","0,9999"],autoresize:[1,"Int","^[0-1]$"],indicator:[0,"Int","^[0-1]$"],indicatoralign:[0,"Int","^[0-1]$"],logotype:[1,"Int","^[123]$"]},eobj:{config:b("#ashiatoShop-config"),frame:b("#ashiatoShop-frame"),prototypeItem:b("#ashiatoShop-item"),itemsDisplay:b("#ashiatoShop-body"),prevButton:b("#ashiatoShop-prev"),nextButton:b("#ashiatoShop-next"),indicatorDisplay:b("#ashiatoShop-indicator"),prototypeIndicator:b("#ashiatoShop-prototypeIndicator"),
shopLogoPrototype:b("#shopLogoPrototype")},status:{error:!1,isTimeout:!1},props:{items:[],itemPrototype:{html:"",height:0,width:0,imgurltmpl:"http://thumbnail.image.rakuten.co.jp/@0_mall/#SHOPURL#/logo/logo1.jpg",identifiers:{banner:["",/\#BANNER\#/g,""],imageele:['<img src="#SHOPIMGURL#" alt="#IMGALT#" title="#IMGTITLE#">',/\#SHOPIMGELE\#/g,""],url:["",/\#SHOPURL\#/g,""],imagealt:["",/\#IMGALT\#/g,""],imagetitle:["",/\#IMGTITLE\#/g,""],imageurl:["",/\#SHOPIMGURL\#/g,""],shopurl:["",/\#SHOPURL\#/g,
""],shopname:["",/\#SHOPNAME\#/g,""]}},indicatorPrototype:{html:"",width:0,height:0}},initialize:function(){a.loadSettings();a.begin()},loadSettings:function(){a.settings=b.RJS_Helpers.readAttr(a.eobj.config,a.settings);a.eobj.config.remove();return!0},begin:function(){a.status.error=!a.getPrototype();a.getData()},getData:function(){b.ajax({url:a.settings.url,cache:!1,dataType:"jsonp",scriptCharset:"euc-jp",timeout:1E3*a.settings.ajaxtimer,success:a.prepareHTML,error:function(){}});return!0},prepareHTML:function(e){var c=
"<div><ul>",g=a.props.itemPrototype.identifiers,h=a.settings.imagesize;a.props.items=e.shops;a.props.itemPrototype.imgurltmpl=a.props.itemPrototype.imgurltmpl.replace(/1(?=\.jpg$)/,a.settings.logotype);for(var j=0;e.shops&&j<e.shops.length;j++){var d=a.props.items[j];if(""!=a.settings.sid)d.url=b.RJS_Helpers.urlParameter(d.url,{"s-id":a.settings.sid},!1);d.shopname=b.RJS_Helpers.omitStr(d.shopname,a.settings.omitname,"¡Ä");d.imageele="";d.imagealt=d.shopname;d.imagetitle=d.shopname;d.imageurl=a.props.itemPrototype.imgurltmpl;
d.imageurl=""!=d.imageurl?b.RJS_Helpers.urlParameter(d.imageurl,{_ex:h}):d.imageurl64;var k=a.eobj.shopLogoPrototype.html(),f;for(f in g)k=k.replace(g[f][1],d[f]!=l?g[f][0]+d[f]+g[f][2]:"");c+=k}e=b(c+"</ul></div>");a.prepareData(b("li",e))},prepareData:function(e){var c=e.length;if(!(0>=c)){for(i=0;i<c;i++)a.props.items[i]=[],a.props.items[i].banner=b(e[i]).html();a.startSlideshow()}},getPrototype:function(){var b=a.eobj.prototypeItem,c=a.props.itemPrototype;if(0==b.length)return!1;c.width=b.outerWidth();
c.height=b.outerHeight();c.html=b.html();if(""==c.html)return!1;b.remove();if(1==a.settings.indicator){b=a.eobj.prototypeIndicator;c=a.props.indicatorPrototype;if(0==b.length)return!1;c.width=b.outerWidth();c.height=b.outerHeight();c.html=b.html();if(""==c.html)return!1;b.remove()}return!0},startSlideshow:function(){a.eobj.frame.show();a.eobj.itemsDisplay.RJS_Slideshow(a,{settings:a.settings,itemPrototype:a.props.itemPrototype,indicatorPrototype:a.props.indicatorPrototype,eobj:a.eobj,items:a.props.items})}})}).initialize()})(this);
