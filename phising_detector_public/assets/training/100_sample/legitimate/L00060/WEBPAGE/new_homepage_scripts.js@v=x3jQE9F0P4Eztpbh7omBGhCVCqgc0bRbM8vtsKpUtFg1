function scrollShelfFix(){var r=$(".diply-explore-shelf"),f=$(".diply-nav"),n=document.getElementsByClassName("diply-nav")[0].getBoundingClientRect(),u=$(".header-mask"),t=u.height(),i;scrollCalc.window.curr=$(window).scrollTop();scrollCalc.dir=scrollCalc.window.curr>scrollCalc.window.prev;scrollCalc.window.prev=$(window).scrollTop();console.log("SCROLL DIRECTION: %s [val::%s]",scrollCalc.dir?"DOWN":"UP",scrollCalc.dir);scrollCalc.prev==null?(scrollCalc.prev=n.top,console.log("MouseWheel Scroll Distance: [PREV: %s, CURR: %s, DIST: %s]",scrollCalc.prev,scrollCalc.curr,scrollCalc.dist)):(scrollCalc.curr=n.top,scrollCalc.dist==null&&(scrollCalc.dist=scrollCalc.prev-scrollCalc.curr,scrollCalc.dist<0&&(scrollCalc.dist*=-1),console.log("MouseWheel Scroll Distance: [PREV: %s, CURR: %s, DIST: %s]",scrollCalc.prev,scrollCalc.curr,scrollCalc.dist),console.log("Saved Scroll Distance As: %s",scrollCalc.dist),scrollCalc.prev=n.top));console.log("Nav [TOP: %s, HEIGHT: %s]",n.top,n.height);i=scrollCalc.dir?n.top<0?0:n.top:$(window).scrollTop()-t<0&&($(window).scrollTop()-t)*-1<scrollCalc.dist?n.top+t-$(window).scrollTop():n.top;console.log("NAVRECT < 0 ? %s | SCROLLCALC.DIR ? %s | TOTAL: %s |",n.top<0,scrollCalc.dir,i);r.css({top:i+n.height+"px"})}function boardInitialize(){var n=200,t=3500,i=t+500,r=i+1300;$(".header-mask").css({opacity:0});maskResize();setTimeout(function(){var t=Number($(".header-mask")[0].getBoundingClientRect().width);resizeBoard(t);setTimeout(function(){resetBoardColumns()},n)},n);setTimeout(function(){$(".header-mask").animate({opacity:1},300)},1e3);setTimeout(function(){shuffleBoard()},t);setTimeout(function(){$(".diply-header-brand").animate({opacity:"0","z-index":"-1"},400,function(){})},r);setTimeout(function(){ShuffleInterval=setInterval(shuffleBoard,masterInterval);shuffleFlag=!0},i)}function maskResize(){var r=document.getElementsByClassName("triangle-left"),u=document.getElementsByClassName("triangle-right"),n=$(window).width(),t=n/1.5,f=n*.09,i=f>115?115:n*.09;dipMaskHeight=i;dipMaskWidth=t;$(r).css({"border-width":i+"px 0 0 "+t+"px"});$(u).css({"border-width":"0 0 "+i+"px "+t+"px"})}function resetBoardColumns(){var t=$(".header-column")[0].getBoundingClientRect().height,n=t/2;$(".header-column:nth-child(even)").css({"-webkit-transform":"translate3d(0,-"+n+"px,0)",transform:"translate3d(0,-"+n+"px,0)"});$(".header-column:nth-child(odd)").css({"-webkit-transform":"translate3d(0,0,0)",transform:"translate3d(0,0,0)"})}function resizeBoard(n){n=Number(n);var r=$(".header-mask")[0].getBoundingClientRect().height,t=null,i=null;n>=1500?(t=n/7,i=r/3):n<1500&&n>=1300?(t=n/5,i=r/3):n<1300&&n>=1e3?(t=n/5,i=r/3):n<1e3&&n>=700?(t=n/4,i=r/3):n<700&&n>=400?(t=n/4,i=r/3):n<400&&(t=n/3,i=r/3);setTimeout(function(){$(".header-container").css({"min-width":n+"px"})},0);setTimeout(function(){$(".header-column").css({width:t+"px"})},0);setTimeout(function(){$(".header-column-item").css({height:i+"px"})},100)}function disappearLogo(n){$(".triangle-left").animate({"border-width":"0px 0 0 "+dipMaskWidth+"px"},n,function(){});$(".triangle-right").animate({"border-width":"0 0 0 "+dipMaskWidth+"px"},n,function(){});setTimeout(function(){$(".triangle-mask").css({"z-index":"-1"})},n+100)}function bringBackLogo(n){setTimeout(function(){$(".triangle-mask").css({"z-index":"2200"})},0);setTimeout(function(){$(".triangle-left").animate({"border-width":dipMaskHeight+"px 0 0 "+dipMaskWidth+"px"},n,function(){});$(".triangle-right").animate({"border-width":"0 0 "+dipMaskHeight+"px "+dipMaskWidth+"px"},n,function(){})},n+100)}function shuffleBoard(){var t=$(".header-column")[0].getBoundingClientRect(),n=t.height/2;shuffledBoardToken===!0?($(".header-column:nth-child(odd)").css({"-webkit-transform":"translate3d(0,-"+n+"px,0)",transform:"translate3d(0,-"+n+"px,0)"}),$(".header-column:nth-child(even)").css({"-webkit-transform":"translate3d(0,0,0)",transform:"translate3d(0,0,0)"}),shuffledBoardToken=!1):shuffledBoardToken===!1&&($(".header-column:nth-child(odd)").css({"-webkit-transform":"translate3d(0,0,0)",transform:"translate3d(0,0,0)"}),$(".header-column:nth-child(even)").css({"-webkit-transform":"translate3d(0,-"+n+"px,0)",transform:"translate3d(0,-"+n+"px,0)"}),shuffledBoardToken=!0)}var diplyApp=angular.module("diplyApp",["ui.router","ui.bootstrap","ngResource","ngSanitize","DiplyControllers","DiplyServices","app.i18n","infinite-scroll"]),diplyServices,diplyControllers,angularizer,ArticleConstructor,_colors,Modal;angular.module("ngToggle",[]).controller("SocialMediaToggle",["$scope",function(n){n.secondary=!0}]);diplyApp.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(n,t,i){i.html5Mode(!0).hashPrefix("!");t.otherwise(function(n,t){window.location.href=window.location.origin?window.location.origin+t.url():t.url()});n.state("home",{url:"/",templateUrl:"Content/static/diply-new-angular/src/app/home/home.html",controller:"HomeController"})}]);diplyServices=angular.module("DiplyServices",[]);diplyControllers=angular.module("DiplyControllers",["DiplyServices"]);diplyServices.factory("watch_dog",["$rootScope","$location",function(n){return{handleError:function(t){if(!t.hasOwnProperty("status")){console.group("watch_dog | -1 :: Malformed Error");console.log("Unable to extract status code from error. watch_dog cannot process this error");console.log(t);console.groupEnd();return}switch(t.status){case 400:n.debug&&(console.group("watch_dog | 400 :: Bad Request"),console.log("Code: "+t.status),console.log("Message: "+t.statusText),console.log(t),console.groupEnd());break;case 404:n.debug&&(console.group("watch_dog | 404 :: Not Found"),console.log("Code: "+t.status),console.log("Message: "+t.statusText),console.log(t),console.groupEnd());break;default:n.debug&&(console.group("watch_dog | ("+t.status+") :: Error"),console.log("Message: "+t.statusText),console.log(t),console.groupEnd())}}}}]);diplyServices.factory("HomeServices",["$resource",function(n){return{Content:n("/api/v1/content/homepage",{},{get:{method:"GET",isArray:!0}}),publication:n("/api/v1/articlecard/publication/:slug",{slug:"@slug"}).get,mustRead:n("/api/v1/articlecard/mustread").get}}]);diplyServices.factory("ExploreServices",["$resource",function(n){return{Content:n("/api/v1/content/shelf",{},{get:{method:"GET",isArray:!0}})}}]);diplyServices.factory("HeaderServices",["$resource",function(n){return{Content:n("/api/v1/content/header",{},{get:{method:"GET",isArray:!0}})}}]);diplyControllers.controller("HomeController",["$scope","$rootScope","watch_dog","HomeServices","$filter","$location",function(n,t,i,r,u,f){function s(n){for(var i,t=n.concat(),r=0;r<t.length;++r)for(i=r+1;i<t.length;++i)t[r].id.replace("/","_").split("_")[1]===t[i].id.replace("/","_").split("_")[1]&&t.splice(i--,1);return t}var e,o;n.raw=null;n.content={posts:{},sidebar:{},shelf:{}};n.loginSubmit=function(){alert("You pressed it dawg")};n.process=function(){var i=0,t=null,r=0,f=null,e,o;if(i=_.findIndex(n.raw,function(n){return n.Id===2}),t=n.raw[i].ContentItems,r=Math.floor(Math.random()*t.length),f=t[r],n.content.posts.top=f,i=_.findIndex(n.raw,function(n){return n.Id===3}),t=n.raw[i].ContentItems,r=Math.floor(Math.random()*t.length),f=t[r],n.content.posts.feature_one=f,i=_.findIndex(n.raw,function(n){return n.Id===4}),t=n.raw[i].ContentItems,r=Math.floor(Math.random()*t.length),f=t[r],n.content.posts.feature_two=f,i=_.findIndex(n.raw,function(n){return n.Id===5}),t=n.raw[i].ContentItems,r=Math.floor(Math.random()*t.length),f=t[r],n.content.posts.feature_three=f,i=_.findIndex(n.raw,function(n){return n.Id===6}),t=n.raw[i].ContentItems,r=Math.floor(Math.random()*t.length),f=t[r],n.content.posts.feature_four=f,i=_.findIndex(n.raw,function(n){return n.Id===7}),t=n.raw[i].ContentItems,r=Math.floor(Math.random()*t.length),f=t[r],n.content.posts.feature_large=f,i=_.findIndex(n.raw,function(n){return n.Id===8}),t=n.raw[i].ContentItems,t.length>5)for(n.content.sidebar.mustRead=[],e=0;e<5;++e)r=Math.floor(Math.random()*t.length),n.content.sidebar.mustRead.push(t[r]),t.splice(r,1);else n.content.sidebar.mustRead=t;i=_.findIndex(n.raw,function(n){return n.Id===9});n.content.sidebar.news=n.raw[i].ContentItems;for(o in n.content.sidebar.news)n.content.sidebar.news[o].age=Utils.Date.calcAge(n.content.sidebar.news[o].PostProperties.CreatedAt,u);i=_.findIndex(n.raw,function(n){return n.Id===10});t=n.raw[i].ContentItems;n.content.sidebar.productions=t};n.search=function(){$window.location.href="/search?q="+window.escape(n.form.search)};n.go=function(){r.Content.get(function(i){t.debug;n.raw=i;n.process()},function(n){i.handleError(n)})};n.setup=function(){angularizer.Home.create_callToAction();n.go()};n.setup();e=9;n.articleCards=[];n.next=null;n.loading=!0;n.endOfResults=!1;n.pageSize=e;n.itemCount=0;n.getPublicationCards=function(){n.loading=!0;r.mustRead({next:n.next,pageSize:n.pageSize},function(t){n.next=t.Next;n.articleCards=s(n.articleCards.concat(t.Items));n.itemCount=n.articleCards.length;(n.next===null||n.itemCount>=63)&&(n.endOfResults=!0);n.loading=!1;e<n.pageSize&&(n.pageSize=e)},function(n){console.log(n)})};o=getCookie("_scroll-"+f.path()+"-count");o!=""&&(n.pageSize=parseInt(o));n.getPublicationCards()}]);diplyControllers.controller("HeaderController",["$scope","$rootScope","HeaderServices","watch_dog","languageService",function(n,t,i,r,u){n.currentLang=u.currentLanguage();t.$on("language-changed",function(t,i){n.currentLang=i});n.tiles=[];n.columns=[[],[],[],[],[],[],[]];n.setupTiles=function(){for(var r,i,t=0;t<7;++t)for(r=n.columns[t],i=0;i<6;++i)r.push(n.tiles[t*6+i])};n.go=function(){};n.setup=function(){boardInitialize();i.Content.get(function(t){n.tiles=t;n.setupTiles()},function(n){r.handleError(n)});setTimeout(function(){$(".header-mask").mouseover(function(){clearInterval(ShuffleInterval);shuffleFlag=!1;$(".header-mask").mousemove(function(n){var t=$(".header-column-item")[0].getBoundingClientRect(),i=2;clearTimeout(mouseMoveTimer);mouseMoveTimer=setTimeout(function(){n.clientY>=t.height*i?(disappearLogo(disappearAnimTime),setTimeout(function(){clearInterval(ShuffleInterval);shuffleFlag=!1;mousepositiontoken=!0},disappearAnimTime)):n.clientY<t.height*i&&(bringBackLogo(reappearAnimTime),setTimeout(function(){clearInterval(ShuffleInterval);shuffleFlag=!1;mousepositiontoken=!1},reappearAnimTime))},mouseWaitTimeout)})});$(".create-wrap").mouseover(function(){setTimeout(function(){bringBackLogo(reappearAnimTime)},300);mouseOutTimer=setTimeout(function(){shuffleFlag===!1?(ShuffleInterval=setInterval(shuffleBoard,masterInterval),shuffleFlag=!0):setTimeout(function(){bringBackLogo(reappearAnimTime)},300)},50)});$(".create-wrap").mouseout(function(){clearTimeout(mouseOutTimer)})},headerWaitTime);$(document).scroll(function(){var n=$(window).scrollTop(),t=$(".header-mask")[0].getBoundingClientRect();clearTimeout(userScrollTimer);userScrollTimer=setTimeout(function(){n>=t.height/2?mousepositiontoken===!0?(bringBackLogo(reappearAnimTime),mousepositiontoken=!1,clearInterval(ShuffleInterval),shuffleFlag=!1):(clearInterval(ShuffleInterval),shuffleFlag=!1):n<t.height/2&&(clearInterval(ShuffleInterval),ShuffleInterval=setInterval(shuffleBoard,masterInterval),shuffleFlag=!0)},scrollFuncTimeout)});$(window).resize(function(){clearTimeout(resizeTimer);clearInterval(ShuffleInterval);var n=Number($(".header-mask")[0].getBoundingClientRect().width);resizeTimer=setTimeout(function(){clearInterval(ShuffleInterval);maskResize();resizeBoard(n);setTimeout(function(){resetBoardColumns();ShuffleInterval=setInterval(shuffleBoard,masterInterval);shuffledBoardToken=!0},200)},resizeFuncTimeout)});n.go()};n.setup()}]);diplyControllers.controller("PostController",["$scope",function(n){n.go=function(){};n.setup=function(){n.go();n.setup=function(){throw new Error("« $scope.setup » CAN ONLY BE RUN ONCE.");}}}]);angularizer={Home:{create_callToAction:function(){$("#cta-btn").on("click",function(){$(".card-create").toggleClass("open")})},scrollToTop:function(){var n=$(".header-mask");n=n.length>0;n&&$("body,html").animate({scrollTop:0})}},Nav:{setPosition:function(){},reposition:function(){},exploreSetup:function(){$("#nav-explore").on("click",function(){$(".diply-explore-shelf").toggleClass("open");$(".explore").toggleClass("active")})},menuSetup:function(){var n=$(".diply-nav-account-menu-inner").height()+15;$(".diply-nav-account-menu").css({height:n+"px"});$(".diply-nav-account-btn").on("click",function(){$(".diply-nav-account-menu").toggleClass("closed")});$(".diply-nav-account-menu li a").on("click",function(){$(".diply-nav-account-btn").click()})},accountMenu:function(){var n=$(".diply-account-menu").height()+15;$(".diply-account-menu-holder").css({height:n+"px"});$(".diply-menu-btn").on("click",function(){$(".diply-account-menu-holder").toggleClass("closed")});$(".diply-account-menu li a").on("click",function(){$(".diply-menu-btn").click()})}},Create:{toggle:function(n){var t,i,u,f,r,e;$(n).hasClass("shrink")?(t=$(n),t.html('<i class="fa fa-fw fa-plus-circle"><\/i>'),t.removeClass("shrink"),t.addClass("expand"),i=$(t.parent()),u=$(i.children(".trash-control")),u.addClass("control-hidden"),f=$(i.children(".move-control")),f.addClass("control-hidden"),r=$(t.parent().parent()),console.log(r),e=$(r.children(".block-content").children(".block-content-body")),e.addClass("block-hidden")):(t=$(n),$(n).html('<i class="fa fa-fw fa-minus-circle"><\/i>'),t.removeClass("expand"),t.addClass("shrink"),i=$(t.parent()),u=$(i.children(".trash-control")),u.removeClass("control-hidden"),f=$(i.children(".move-control")),f.removeClass("control-hidden"),r=$(t.parent().parent()),console.log(r),e=$(r.children(".block-content").children(".block-content-body")),e.removeClass("block-hidden"))},activateFileBlocks:function(){for(var i,r,t=$(".file-input"),n=0;n<t.length;++n){i=$(t[n]);r=$(i.children(".browse-btn"));r.on("click",function(n){var t=$(n).parent(),i=$(t.children('input[type="file"]'));i.click()})}}}};diplyControllers.controller("NavController",["$rootScope","$scope",function(n,t){t.currentLang="en";n.$on("language-changed",function(n,i){t.currentLang=i});t.go=function(){};t.setup=function(){angularizer.Nav.exploreSetup();angularizer.Nav.setPosition();angularizer.Nav.menuSetup();t.go()};t.setup()}]);diplyControllers.controller("ExploreController",["$scope","$rootScope","$window","ExploreServices","watch_dog",function(n,t,i,r,u){n.raw={};n.content={shelf:{articles:[]}};n.search=function(){i.location.href="/search?q="+window.escape(n.form.search)};n.process=function(){var u=0,t=null,i=0,r;if(u=_.findIndex(n.raw,function(n){return n.Id===11}),t=n.raw[u].ContentItems,t.length>4)for(n.content.shelf.articles=[],r=0;r<4;++r)i=Math.floor(Math.random()*t.length),n.content.shelf.articles.push(t[i]),t.splice(i,1);else n.content.shelf.articles=t};n.go=function(){};n.setup=function(){r.Content.get(function(t){n.raw=t;n.process()},function(n){u.handleError(n)});$(".diply-explore-close").on("click",function(){$(".diply-explore-shelf").toggleClass("open");$(".explore").toggleClass("active")})};n.setup()}]);ArticleConstructor={Image:function(){return this.Type="Image",this.Color=_colors.imagery,this.UUID=Utils.UUID.generate(),this.Title="",this.Url="",this.Attributions=[],this.Attributions.push(new ArticleConstructor.Extras.Attribution),this},Gallery:function(){return this.Type="Gallery",this.Color=_colors.imagery,this.UUID=Utils.UUID.generate(),this.Title="",this.Images=[],this.Attributions=[],this.Attributions.push(new ArticleConstructor.Extras.Attribution),this},SplitImage:function(){return this.Type="SplitImage",this.Color=_colors.imagery,this.UUID=Utils.UUID.generate(),this.Title="",this.Caption="",this.Images=[],this.Percentage=0,this.Attributions=[],this.Images.push(new ArticleConstructor.Image),this.Images.push(new ArticleConstructor.Image),this.Attributions.push(new ArticleConstructor.Extras.Attribution),this},Video:function(){return this.Type="Video",this.Color=_colors.imagery,this.UUID=Utils.UUID.generate(),this.Title="",this.Url="",this.Attributions=[],this.Attributions.push(new ArticleConstructor.Extras.Attribution),this},Text:function(){return this.Type="Text",this.Color=_colors.text,this.UUID=Utils.UUID.generate(),this.Content="",this},Quotation:function(){return this.Type="Quotation",this.Color=_colors.text,this.UUID=Utils.UUID.generate(),this.Content="",this.Attributions=[],this.Attributions.push(new ArticleConstructor.Extras.Attribution),this},PageBreak:function(){return this.Type="PageBreak",this.Color=_colors.utilities,this.UUID=Utils.UUID.generate(),this},AdPlaceholder:function(){return this.Type="AdPlaceholder",this.Color=_colors.utilities,this.UUID=Utils.UUID.generate(),this},Extras:{Attribution:function(n){return{Name:n&&n.Name?n.Name:"",SourceName:n&&n.SourceName?n.SourceName:"",UserUrl:n&&n.UserUrl?n.UserUrl:"",SourceUrl:n&&n.SourceUrl?n.SourceUrl:"",Date:"0001-01-01T00:00:00"}}}};ArticleConstructor.Image.prototype.addAttribution=function(n){this.Attributions.push(new ArticleConstructor.Extras.Attribution(n))};ArticleConstructor.Gallery.prototype.addAttribution=function(n){this.Attributions.push(new ArticleConstructor.Extras.Attribution(n))};ArticleConstructor.Gallery.prototype.addImage=function(){this.Images.push(new ArticleConstructor.Image)};ArticleConstructor.Gallery.prototype.removeImage=function(n){this.Images.splice(n,1)};ArticleConstructor.Video.prototype.addAttribution=function(n){this.Attributions.push(new ArticleConstructor.Extras.Attribution(n))};ArticleConstructor.Quotation.prototype.addAttribution=function(n){this.Attributions.push(new ArticleConstructor.Extras.Attribution(n))};_colors={imagery:"#18C910",text:"#9E2AA3",utilities:"#E94040"};diplyControllers.controller("CreateController",["$scope","$rootScope","$timeout","watch_dog",function(n,t,i){n.stage=0;n.upStage=function(){n.stage++};n.downStage=function(){n.stage--};n.addingBlock=!1;n.ai={title:null,previewImage:null};n.Article={Type:null,Tags:["None"],Title:n.ai.title,Excerpt:"",UserId:-1,MainImageUrl:null,CreatedAt:null,UpdatedAt:null,Components:[],Category:{},Subcategory:{}};n.blocks=[{properties:{title:"Imagery",color:"#18C910"},items:[{type:"Image",title:"Image",icon:"fa-image"},{type:"Gallery",title:"Gallery",icon:"fa-image"},{type:"SplitImage",title:"20/20 Image",icon:"fa-eye-slash"},{type:"Video",title:"Video",icon:"fa-video-camera"}]},{properties:{title:"Text",color:"#9E2AA3"},items:[{type:"Text",title:"Text Block",icon:"fa-align-left"},{type:"Quotation",title:"Quotation",icon:"fa-quote-left"}]},{properties:{title:"Utilities",color:"#E94040"},items:[{type:"AdSlot",title:"Ad Slot",icon:"fa-usd"},{type:"PageBreak",title:"Page Break",icon:"fa-file-o"}]}];n.newArticle=function(t){$(".diply-create-content").css({height:"inherit"});n.Article.Type=t;n.upStage()};n.addBlock=function(t){if(n.addingBlock){swal("Hold Up!","We're still processing that last request","error");return}n.addingBlock=!0;var r={};switch(t){case"Image":r=new ArticleConstructor.Image;n.Article.Components.push(r);break;case"Gallery":r=new ArticleConstructor.Gallery;n.Article.Components.push(r);break;case"SplitImage":r=new ArticleConstructor.SplitImage;n.Article.Components.push(r);break;default:r=null}if(r==null){swal("Well this is embarrasing...","That feature either isn't available yet, or we messed up.","warning");n.addingBlock=!1;return}i(n.activateBlock,100)};n.activateBlock=function(){var t,r;console.log("Activating Block");t=n.Article.Components.length-1;r=n.Article.Components[t];switch(r.Type){case"Image":var i=n.Article.Components[t].UUID,u=$("#JS_BROWSE-"+i),f=$("#JS_FILE-"+i);u.on("click",function(){f.click()});n.$watch("Article.Components["+t+"].File",function(){typeof n.Article.Components[t].File!="undefined"&&(n.Article.Components[t].Url=n.Article.Components[t].File.name)});break;case"SplitImage":var i=n.Article.Components[t].UUID,e=$("#JS_BROWSE_ONE-"+i),o=$("#JS_FILE_ONE-"+i),s=$("#JS_BROWSE_TWO-"+i),h=$("#JS_FILE_TWO-"+i);e.on("click",function(){o.click()});s.on("click",function(){h.click()})}n.addingBlock=!1};n.removeBlock=function(t){swal({title:"Are you sure?",text:"This will remove this block (this action is not undoable).",type:"warning",showCancelButton:!0,closeOnConfirm:!1,closeOnCancel:!0,confirmButtonColor:"#E5524C",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, nevermind."},function(i){i&&(n.Article.Components.splice(t,1),n.$apply(),swal({title:"Deleted!",text:"Successfully removed the block.",type:"success",confirmButtonColor:"#57E56B",confirmButtonText:"Awesome. Ty."}))})};n.updateTags=function(){n.Article.Tags=n.ai.tags.split(" ")};n.updateTitle=function(){n.Article.Title=n.ai.title};n.updateImagePreview=function(){var t=new FileReader;t.onload=function(t){console.log(t.target.result);n.ai.previewImage=t.target.result;n.ai.mainImageFile=n.ai.mainImageFileFile.name;n.$apply()};t.readAsDataURL(n.ai.mainImageFileFile)};n.getBlockTemplate=function(n){switch(n){case"Image":return"/Content/static/diply-new-angular/src/app/create/blocks/image.html";case"Gallery":return"/Content/static/diply-new-angular/src/app/create/blocks/gallery.html";case"SplitImage":return"/Content/static/diply-new-angular/src/app/create/blocks/split-image.html";default:return""}};n.$watch("ai.mainImageFileFile",function(){typeof n.ai.mainImageFileFile!="undefined"&&n.ai.mainImageFileFile!=null&&n.updateImagePreview()});n.$watch("ai.mainImageFile",function(){if(n.ai.mainImageFileFile==null){n.ai.previewImage=n.ai.mainImageFile;return}n.ai.mainImageFile!=n.ai.mainImageFileFile.name&&(n.ai.mainImageFileFile=null,n.ai.previewImage=n.ai.mainImageFile)});n.go=function(){window.scope=n};n.setup=function(){var t=!1||!!document.documentMode;t&&(console.log("IE. Great..."),$("#ai-title").keyup(event,n.updateTitle),swal({title:"Uh oh.",text:"We've noticed you're using Internet Explorer. You might have a better experience on a more mainstream browser.",confirmButtonColor:"#E5524C",confirmButtonText:"Noted.",type:"error"}));$(".diply-nav").css({margin:"-193px 0 0 0",display:"none"});$(".diply-create-content").css({height:$(window).height()+"px"});n.ai.title='<span class="tempTitle" onclick="$(\'.tempTitle\').remove()">Title...<\/span>';$(".main-img-btn").on("click",function(){$(".main-img-file").click()});n.types=["Article","Video","Opinion","News","Sponsored"];n.go()};n.setup()}]);angular.module("diplyApp").directive("autoScroll",["$document","$timeout","$location","$window",function(n,t,i,r){return{restrict:"A",link:function(u){function e(n,r){t(function(){u.scrollPos[i.path()]=n;$(window).scrollTop(u.scrollPos[i.path()]?u.scrollPos[i.path()]:0);$(window).scrollTop()!=n?e(n,250):u.pageSize=9},r)}function s(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}function o(n,t){document.cookie=n+"="+t+"; path=/"}function h(n){document.cookie=n+"=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}u.okSaveScroll=!0;u.scrollPos={};var f=s("_scroll-"+i.path());f!=""&&e(f,0);n.bind("scroll",function(){var n,t;if(u.okSaveScroll){n=$(window).scrollTop();u.scrollPos[i.path()]=n;o("_scroll-"+i.path(),u.scrollPos[i.path()]);var f=angular.element(document.querySelector(".infinite-wrapper"))[0],a=f.ownerDocument.documentElement,e=f.getBoundingClientRect().top+r.pageYOffset-a.clientTop;if(n>e){for(var s=e,c=angular.element(document.querySelectorAll(".infinite-wrapper .infinite-main")),v=c[0].offsetHeight,y=c[0].offsetWidth,l=1;s<n+r.innerHeight;)s+=v,l+=1;t=l*Math.floor(r.innerWidth/y);o("_scroll-"+i.path()+"-count",t>63?63:t)}else h("_scroll-"+i.path()+"-count")}})}}}]);diplyApp.directive("ngEnter",function(){return function(n,t,i){t.bind("keydown keypress",function(t){t.which===13&&(n.$apply(function(){n.$eval(i.ngEnter)}),t.preventDefault())})}});var dipMaskHeight=0,dipMaskWidth=0,shuffledBoardToken=!0,mousepositiontoken=!1,shuffleFlag=null,ShuffleInterval=null,resizeTimer=null,mouseMoveTimer=null,mouseOutTimer=null,userScrollTimer=null,mouseWaitTimeout=100,scrollFuncTimeout=400,resizeFuncTimeout=150,headerWaitTime=3500,disappearAnimTime=300,reappearAnimTime=600,masterInterval=1e4;Modal={Core:{showCover:function(){$(".diply-modal-cover").css({display:"block"});var n=setTimeout(function(){$(".diply-modal-cover").css({opacity:"1"});$("body").addClass("modal-open")},0)},hideCover:function(){$(".diply-modal-cover").css({opacity:"0"});var n=setTimeout(function(){$(".diply-modal-cover").css({display:"none"})},401);$("body").removeClass("modal-open")},"default":function(){event.stopPropagation();event.preventDefault()}},Signin:{show:function(){Modal.Core.showCover();var n=setTimeout(function(){$("#diply_signin_modal").addClass("fade-in")},300);$(".diply-modal-cover").on("click",Modal.Signin.hide)},hide:function(){Modal.Core.hideCover();var n=setTimeout(function(){$("#diply_signin_modal").removeClass("fade-in")},400)}}}