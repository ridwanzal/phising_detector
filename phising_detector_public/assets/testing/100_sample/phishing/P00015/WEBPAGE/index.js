define(["nougat","jquery","backbone","BaseView","lib/business/businessHelper","widget/explore"],function(e,t,n,r,i,s){"use strict";var o=n.View.extend({el:"#index",variables:{},events:{"show #pp-modal":"playVideo","hide #pp-modal":"stopVideo"},transactionsFetchLimit:t("#transactionsFetchLimit").val(),bannerWrapper:t(".bannerWrapper"),arrowIcon:t(".bannerBttnWrapper .arrowIcon"),showText:t(".bannerBttnWrapper .showText"),hideText:t(".bannerBttnWrapper .hideText"),moneyModuleStartTime:null,activityModuleStartTime:null,customersModuleStartTime:null,fetchMoneyData:function(){var e,s=t("#moneyModule");s.length>0&&(e=new r,e.model=new n.Model,i.simpleFetchAndRender("moneyBasic","#moneyModule","summary/moneyModule",e),this.moneyModuleStartTime=t.now())},fetchTransactionsData:function(){var e,s=t("#ActivityTile"),o="activity?limit="+this.transactionsFetchLimit;s.length>0&&(e=new r,e.model=new n.Model,i.simpleFetchAndRender(o,"#ActivityTile","summary/activityModule",e,this.setRowClickHeight),this.activityModuleStartTime=t.now())},fetchCustomerInfo:function(){var e,s=t("#custModule");s.length>0&&(e=new r,e.model=new n.Model,i.simpleFetchAndRender("customerCount","#custModule","summary/customersModule",e),this.customersModuleStartTime=t.now())},setRowClickHeight:function(){t(".rowClickTable .desc").each(function(){t(this).find(".rowClick").height(t(this).height())})},bannerShowHideClickHandler:function(e){this.hideText.is(":visible")?this.hideBanner(!0):this.showBanner(!0)},hideBanner:function(e){this.hideText.hide(),this.showText.show(),this.arrowIcon.removeClass("hideArrow").addClass("showArrow"),this.bannerWrapper.slideUp(500),e&&this.postBannerState(this.bannerWrapper.attr("id"),!1),this.arrowIcon.parent("a").removeClass("scTrack:"+this.bannerWrapper.attr("id")+"_banner_open"),this.arrowIcon.parent("a").addClass("scTrack:"+this.bannerWrapper.attr("id")+"_banner_close")},showBanner:function(e){this.showText.hide(),this.hideText.show(),this.arrowIcon.removeClass("showArrow").addClass("hideArrow"),this.arrowIcon.parent("a").removeClass("scTrack:"+this.bannerWrapper.attr("id")+"_banner_close"),this.arrowIcon.parent("a").addClass("scTrack:"+this.bannerWrapper.attr("id")+"_banner_open"),this.bannerWrapper.slideDown(),e&&this.postBannerState(this.bannerWrapper.attr("id"),!0)},postBannerState:function(e,n){t.post("/webapps/business/dismissOpenBanner","type="+e+"&isOpenState="+n)},playVideo:function(){!this.variables.previewVideo||typeof this.variables.previewVideo[0].play!="function"?!!this.variables.previewVideoIeFallBack&&typeof this.variables.previewVideoIeFallBack[0].controls=="object"&&this.variables.previewVideoIeFallBack[0].controls.play():this.variables.previewVideo[0].play(),console.log("play")},stopVideo:function(){!this.variables.previewVideo||typeof this.variables.previewVideo[0].pause!="function"?!!this.variables.previewVideoIeFallBack&&typeof this.variables.previewVideoIeFallBack[0].controls=="object"&&this.variables.previewVideoIeFallBack[0].controls.pause():this.variables.previewVideo[0].pause(),console.log("stop")},initialize:function(){var e=this;this.fetchMoneyData(),this.fetchTransactionsData(),this.fetchCustomerInfo(),this.variables.previewVideo=t("#previewVideo"),this.variables.previewVideoIeFallBack=t("#previewVideoIeFallBack"),t(".bannerWrapper").hasClass("show")?this.showBanner():this.hideBanner(),t(".bannerBttnWrapper").find("a").click(function(t){t.preventDefault(),e.bannerShowHideClickHandler(t)});if(t("body").hasClass("explore")&&t("html").data("device-type")==="desktop")var n=new s({ajaxUrl:"/webapps/business/dismissBubbles?name=summary_bubble",onViewLoaded:["summary/customersModule","summary/moneyModule","transactions/activity"],exploreBubble_0:{left:-6,top:-18},exploreBubble_1:{left:-9,top:-26},exploreBubble_2:{left:-9,top:-7},exploreBubble_3:{left:50,top:0,arrow:"topLeft"}});t("body").on("viewLoaded",t.proxy(function(e,n){n=="summary/moneyModule"?(fpti.e="im",fpti.page="main:business:::home:summary:moneyModule",fpti.tajst=this.moneyModuleStartTime,fpti.tajdn=t.now()):n=="transactions/activity"?(fpti.e="im",fpti.page="main:business:::home:summary:activityModule",fpti.tajst=this.activityModuleStartTime,fpti.tajdn=t.now()):n=="summary/customersModule"?(fpti.e="im",fpti.page="main:business:::home:summary:customersModule",fpti.tajst=this.customersModuleStartTime,fpti.tajdn=t.now()):(delete fpti.page,delete fpti.tajst,delete fpti.tajdn),PAYPAL.analytics.instance.record()},this)),t("#ActivityTile").tooltip({selector:"a[data-toggle=tooltip]",placement:"bottom",delay:{show:1e3,hide:10},template:'<div class="tooltip ppCustom"><div class="tooltip-arrow"></div><div class="tooltip-outer"><strong>'+t("#notesContent").val()+'</strong><div class="tooltip-inner"></div></div></div>'})}});return new o})