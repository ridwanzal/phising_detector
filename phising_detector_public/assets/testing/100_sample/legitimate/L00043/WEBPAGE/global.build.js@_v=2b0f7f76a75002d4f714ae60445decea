webpackJsonp([19],[function(e,t,i){i(1484),i(1485),i(1486),i(1487),i(1488),i(1489),i(1490),i(1491),i(1492),i(1493),i(1494),i(1495),i(1496),i(1497),i(1498),i(1499),i(1500),i(1501),i(1502),i(1503),i(1504),i(1505),i(1506),i(1507),i(1508),i(1509),i(1510),i(1511),i(1512),i(1513),i(1514),i(1515),i(1516),i(1517),i(1518),i(1519),i(1520),i(1521),i(1522),i(1523),i(1524),i(1525),i(1526),i(1527),i(1528),i(1529),i(1530),e.exports=i(1531)},,,,,function(e,t,i){"use strict";var n=i(3),s=i(6).sprintf,o=i(7),r=i(10),a=i(97),l=i(106),c=i(103),u=i(108),h=i(109),d=i(111),p=i(154),g=i(696),m=i(699),f=i(713),v=i(717),_=a.extend({getName:function(){return this.name=l.get("Context/name"),s("Context/%s",this.name)},logs:function(){var e=[i(750),i(767),i(768),i(769),i(770),i(771),i(772),i(773),i(774),i(775),i(776),i(777),i(778),i(779),i(780),i(781),i(782),i(783),i(784),i(785),i(788),i(789),i(790),i(791),i(792),i(793),i(794),i(795)];return n.union(e,a.prototype.logs.apply(this))},constructor:function(){a.apply(this,arguments),this.startHistory(),this.initializeApp()},bootloader:function(e){a.prototype.bootloader.apply(this,arguments),h.init(),c.log("Exec","Bootstrap/DOMEventor"),c.log("Exec","Bootstrap/Legacy"),i(796)},initializeApp:function(){u.bool("is_mobile_handset")&&u.bool("responsive_help_docs")?new v:new p,new g,u.bool("indash_blogs")&&(this.peepr=new m),u.bool("ask_form")&&(this.askForm=new f({user:d()})),r.locale(l.get("Context.language"))},startHistory:function(e){o.History.started||n.isEmpty(this.routes)||(this.routeFound=o.history.start({pushState:"pushState"in window.history,hashChange:e?!("pushState"in window.history):!1,root:this.root}))}});e.exports=_},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var n=i(3),s=i(7),o=i(98),r=i(100),a=i(106),l=i(101),c=i(103),u=i(107),h=s.Router.extend({root:"/",getName:function(){return"Prima/Router"},logs:function(){return[]},constructor:function(e){e||(e={}),e.bootstrap||(e.bootstrap=o()),this.bootloader(e.bootstrap),s.Router.apply(this,arguments)},bootloader:function(e){n.isEmpty(e),a.setup(e),c.log("Exec","Bootstrap/Data"),l.setup(e.Translations),c.log("Exec","Bootstrap/Translations"),u.startLogs(this.logs()),c.log("Exec","Bootstrap/logs")}},{start:function(e){return new this(e)}});r(),e.exports=h},function(e,t,i){"use strict";var n=i(99),s=function(){var e=n("JSON"),t={},i=document.getElementById("bootloader");if(i){try{t=e.parse(i.getAttribute("data-bootstrap"))}catch(s){}i.parentNode.removeChild(i)}return t};e.exports=s},function(e,t){"use strict";function i(e,t){if(e in n)return n[e];var i=window[e];if(!t||!t(i)){var s=document.createElement("iframe");document.body.appendChild(s),i=s.contentWindow[e],document.body.removeChild(s)}return n[e]=i,i}var n={};e.exports=i},function(e,t,i){"use strict";var n=i(3),s=i(6).sprintf,o=i(101),r=i(105),a=(i(103),{__:o,sprintf:s,_subview:r}),l=function(){return n.extend(n.templateSettings.imports,a),a};e.exports=l},function(e,t,i){"use strict";function n(e){r.addEntries(s.isObject(e)?e:{})}var s=i(3),o=i(102),r=new o({name:"Translations"}),a=s.bind(r.get,r);a.setup=s.once(n),e.exports=a},function(e,t,i){"use strict";function n(e){e=s.extend({entries:{},name:"Dictionary"},e),this._hadLastLookup=!1,this._entries=e.entries,this._name=e.name}var s=i(3),o=(i(103),i(6).sprintf),r=function(e,t,i){null!=i||(i=this);var n=e.apply(i,t);return t=Array.prototype.slice.call(t,1),t.unshift(n),t};n.prototype.addEntries=function(e){return s.extend(this._entries,e),this},n.prototype.lookup=function(e){return s.has(this._entries,e)?(this._hadLastLookup=!0,this._entries[e]):(this._hadLastLookup=!1,e)},n.prototype.lookupWithFormatting=function(e){var t;return arguments.length>1?(t=this.lookup(o.apply(this,arguments)),this._hadLastLookup||(t=o.apply(this,r(this.lookup,arguments,this)))):t=this.lookup(e),t},n.prototype.get=function(e){var t=this.lookupWithFormatting.apply(this,arguments);return!this._hadLastLookup&&this.logMissing,t},n.prototype.getEntries=function(){return s.cloneDeep(this._entries)},e.exports=n},,,function(e,t){"use strict";e.exports=function(e){return'<noscript data-subview="'+e+'"></noscript>'}},function(e,t,i){"use strict";function n(e){if(!r)throw new Error("Data hasn't been initialized with `setup`.");if(!a.isString(e))return null;var t=a.get(r,e.replace(/\//g,"."));return a.cloneDeep(t)}function s(e){if(!r)throw new Error("Data hasn't been initialized with `setup`.");return a.isString(e)?a.has(r,e.replace(/\//g,".")):null}function o(e){r=a.isObject(e)?e:{}}var r,a=i(3);e.exports={get:n,has:s,setup:a.once(o)}},function(e,t,i){"use strict";var n=i(3),s={loadedLogs:[],startLogs:function(e){n.each(e,function(e){var t=e.start();this.loadedLogs.push(t.logKey)},this)},startLog:function(e){this.startLogs([e])}};e.exports=s},,function(e,t,i){"use strict";function n(){g.documentHeight=p.documentHeight,p.documentHeight=h.height(),g.windowHeight=p.windowHeight,p.windowHeight=d.height(),g.windowWidth=p.windowWidth,p.windowWidth=d.width(),g.windowScrollTop=g.windowScrollY=p.windowScrollTop,p.windowScrollTop=p.windowScrollY=d.scrollTop()}function s(){function e(e){n(),u.trigger("DOMEventor:flatresize",p),t=!1}var t;d.on("resize.DOMEventor-nextResizeLoop",function(){t||(f(e),t=!0)})}function o(){function e(e){i--||(g.documentHeight=p.documentHeight,p.documentHeight=h.height(),i=1),g.windowScrollTop=g.windowScrollY=p.windowScrollTop,p.windowScrollTop=p.windowScrollY=d.scrollTop(),u.trigger("DOMEventor:flatscroll",p),t=!1}var t,i=0;d.on("scroll.DOMEventor-nextScrollLoop",function(){t||(f(e),t=!0)})}function r(){h.off("keydown.DOMEventor keyup.DOMEventor"),u.on("DOMEventor:startKeyboardObserver",m),u.off("DOMEventor:stopKeyboardObserver")}function a(){n(),o(),s(),m(),u.on("DOMEventor:updateRect",n)}var l=i(3),c=i(9),u=i(110),h=c(document),d=c(window),p={},g={};p.documentHeight=g.documentHeight=null,p.windowHeight=g.windowHeight=null,p.windowWidth=g.windowHeight=null,p.windowScrollTop=g.windowScrollTop=null,p.windowScrollY=g.windowScrollY=null;var m,f=!Object.hasOwnProperty.call(window,"requestAnimationFrame")&&window.requestAnimationFrame||!Object.hasOwnProperty.call(window,"webkitRequestAnimationFrame")&&window.webkitRequestAnimationFrame||!Object.hasOwnProperty.call(window,"mozRequestAnimationFrame")&&window.mozRequestAnimationFrame||!Object.hasOwnProperty.call(window,"oRequestAnimationFrame")&&window.oRequestAnimationFrame||function(e){window.setTimeout(function(){e()},50)};m=function(){var e=[],t={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"leftmeta",92:"rightmeta",93:"rightmeta",96:"num0",97:"num1",98:"num2",99:"num3",100:"num4",101:"num5",102:"num6",103:"num7",104:"num8",105:"num9",106:"multiply",107:"add",109:"subtract",110:"decimal",111:"devide",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:"semicolon",187:"equal",188:"comma",189:"dash",190:"period",191:"forwardslash",192:"graveaccent",219:"openbracket",220:"backslash",221:"closebracket",222:"singlequote"};h.on("keydown.DOMEventor keyup.DOMEventor",function(i){var n=i.type;if("keyup"===n||"keydown"===n){var s=c(i.target),o=i.which;if(!((s.is("input")||s.is("textarea")||s.is("select"))&&o>=48&&90>=o)||i.metaKey||i.ctrlKey||i.altKey){o>=48&&90>=o&&"keydown"===n&&(e[o]=1);var r="";for(var a in e)"keydown"===n&&o!==parseInt(a,10)&&(r+=t[a]?t[a]+"+":"");var l=n+":"+(i.altKey&&18!==o?"alt+":"")+(i.ctrlKey&&17!==o?"ctrl+":"")+(i.metaKey&&91!==o&&92!==o&&93!==o?"meta+":"")+(i.shiftKey&&16!==o?"shift+":"")+(r||"")+(t[o]||"");u.trigger("DOMEventor:"+l,i,l),"keyup"===n&&(e=[])}}}),u.off("DOMEventor:startKeyboardObserver"),u.on("DOMEventor:stopKeyboardObserver",r)};var v={init:l.once(a),rect:function(){return p},lastRect:function(){return g}};e.exports=v},function(e,t,i){"use strict";var n=i(3),s=i(7),o=function(){};o.extend=s.Model.extend,n.extend(o.prototype,s.Events),o.prototype.trigger=function(){return n.isObject(arguments[1])&&(arguments[1].loggingData=arguments[1].loggingData||{}),s.Events.trigger.apply(this,arguments)},e.exports=new o},function(e,t,i){"use strict";var n,s=i(112),o=i(106),r=i(110),a=function(){if(null==n){var e=o.get("Context/userinfo");n=e&&e.name?new s(e):!1,n&&(n.listenTo(r,"post:like:set",n.incrementLikeCount),n.listenTo(r,"post:unlike:set",n.decrementLikeCount),n.listenTo(r,"tumblelog:follow",n.incrementFollowingCount),n.listenTo(r,"tumblelog:unfollow",n.decrementFollowingCount))}return n};e.exports=a},function(e,t,i){"use strict";var n=i(113),s=i(114),o=i(118),r=n.extend({idAttribute:"name",initialize:function(e){this.channels=new o(e.channels)},incrementLikeCount:function(){var e=this.get("liked_post_count");this.set("liked_post_count",e+1)},decrementLikeCount:function(){var e=this.get("liked_post_count");e>0&&this.set("liked_post_count",e-1)},incrementFollowingCount:function(){var e=this.get("friend_count");this.set("friend_count",e+1)},decrementFollowingCount:function(){var e=this.get("friend_count");e>0&&this.set("friend_count",e-1)},getUnreadCount:function(){return this.channels.reduce(function(e,t){return parseInt(e,10)+parseInt(t.get("unread_count"),10)},0)},getChannel:function(e){return null==e&&(e=this.get("primary")),this.channels.findWhere({name:e})},canMessage:function(){return this.get("can_message")},isSoundsEnabled:function(){return this.get("is_sounds_enabled")},isVerifiedEmail:function(){return this.get("is_verified_email")},getChannelsEnabledForMessaging:function(){return this.channels.where({can_send_messages:!0})},toJSON:function(){var e=s.prototype.toJSON.apply(this,arguments);return e.channels=this.channels.toJSON(),e},getChannelProperty:function(e,t){var i=this.getChannel(e);if(!(i&&"get"in i))return null;var n=i.get(t);return"undefined"==typeof n?null:n}});e.exports=r},function(e,t,i){"use strict";function n(e,t){function i(e,t){var i,n;if(!s.isObject(e))throw new Error("SingletonModel requires attributes");if(i=e[d],s.isEmpty(i)&&!s.isNumber(i)&&s.defer(function(){throw new Error('SingletonModel attributes require a "'+d+'"')}),n=u[i],h[i]++||(h[i]=1),n)s.keys(e).length>=2&&n.set(e,t),n.collection!==!0&&(n.collection=!0);else{u[i]=this;try{Object.defineProperty(this,"collection",{value:!0,configurable:!1,enumerable:!0,writable:!1})}finally{this.collection||(this.collection=!0)}this.constructor.__super__.constructor.call(this,e,t),c.add(this)}return n||this}function n(){return this.id}function a(){return c}function l(){0===--h[this.id]&&(delete u[this.id],delete h[this.id],c.remove(this))}e||(e={}),t||(t={});var c=new o.Collection,u=Object.create(null),h=Object.create(null),d=e.idAttribute||r.prototype.idAttribute;return e.constructor=i,e.release=l,e.toString=n,e.toJSON=e.toJSON||r.prototype.toJSON,t.getCollection=a,r.extend(e,t)}var s=i(3),o=i(7),r=i(114);e.exports.extend=n},function(e,t,i){"use strict";var n=i(7),s=i(115),o=i(117),r=n.Model.extend({});s.applyTo(r.prototype),o.applyTo(r),e.exports=r},function(e,t,i){"use strict";var n=i(116),s=new n({before:{sync:function(e,t,i){i.with_form_key=!0}}});e.exports=s},function(e,t,i){"use strict";function n(e,t){u.each(t,function(t,i){var n=e[i];e[i]=function(){return t.apply(this,arguments),n.apply(this,arguments)}})}function s(e,t){u.each(t,function(t,i){var n=e[i];e[i]=function(){var e=n.apply(this,arguments);return t.apply(this,arguments),e}})}function o(e,t){u.each(t,function(t,i){var n=e[i];e[i]=function(){var e=u.toArray(arguments);return e.unshift(u.bind(n,this)),t.apply(this,e)}})}function r(e,t){u.each(t,function(t,i){var n=i in e?e[i]:!1;e[i]=function(){var e=u.toArray(arguments),i=n?u.bind(n,this):u.noop;return e.unshift(i),t.apply(this,e)}})}function a(e,t){u.defaults(e,t)}function l(e,t){u.extend(e,t)}function c(){this.mixins=u.filter(arguments,function(e){return e instanceof c}),this.properties=arguments[this.mixins.length]||{}}var u=i(3);c.prototype.mixins=null,c.prototype.properties=null,c.prototype.applyTo=function(e){var t=this.properties;a(e,t.defaults),l(e,t.extend),u.extend(e,u.omit(t,"before","after","around","onto","defaults","extend","applyTo")),u.invoke(this.mixins,"applyTo",e),n(e,t.before),s(e,t.after),o(e,t.around),r(e,t.onto),u.isFunction(t.applyTo)&&t.applyTo.apply(this,arguments)},c.before=n,c.after=s,c.around=o,c.onto=r,e.exports=c},function(e,t,i){"use strict";function n(e){var t=r.apply(this,arguments);return o.has(e,"mixins")&&e.mixins.forEach(function(e){e.applyTo(t.prototype)}),t}function s(e){e.extend=n}var o=i(3),r=i(7).Model.extend;e.exports.applyTo=s},function(e,t,i){var n=i(119),s=i(120),o=n.extend({model:s});e.exports=o},function(e,t,i){"use strict";var n=i(7).Collection,s=i(115),o=i(117),n=n.extend();s.applyTo(n.prototype),o.applyTo(n),e.exports=n},function(e,t,i){"use strict";function n(e,t,i){var n=a.Deferred(),s={data:{tumblelog:e.get("name")}};i.placement_id&&(s.data.placement_id=i.placement_id),i.pt&&(s.data.pt=i.pt),i.source&&(s.data.source=i.source),i.context&&(s.data.context=i.context),i.tlt&&(s.data.tlt=i.tlt);var o=function(){i.wait||e.set({following:t.following},i)},r=function(s,o){i.wait||e.set({following:!t.following},i),n.reject(o)},l=function(){i.wait&&e.set({following:t.following},i),n.resolve()},c=t.following?"/svc/follow":"/svc/unfollow";return a.ajax({beforeSend:o,cache:!i.force,data:s,error:r,type:"POST",success:l,url:c,with_form_key:!0}),n.promise()}function s(e,t){var i=a.Deferred(),n={};l.has(t,"is_tumblelog_popover")&&(n.is_tumblelog_popover=t.is_tumblelog_popover),l.has(t,"is_user_mention")&&(n.is_user_mention=t.is_user_mention);var s=function(e,t){i.reject(t)},o=function(t){l.has(t,"highlighted_posts")||(t={highlighted_posts:t}),e.set(t),i.resolve()};return a.ajax({cache:!t.force,data:n,error:s,type:"GET",success:o,url:p(e),with_form_key:!0}),i.promise()}function o(e,t){return c.promise(function(i,n){var s={tumblelog:e.get("name")};l.has(t,"include_member_data")&&(s.include_member_data=t.include_member_data),l.has(t,"include_activity_data")&&l.has(t,"include_member_data")&&(s.include_activity_data=t.include_activity_data),l.has(t,"include_activity_notifications")&&l.has(t,"include_member_data")&&(s.include_activity_notifications=t.include_activity_notifications);var o=function(e,t){n(t)},r=function(t){e.set(t.response),i()};a.ajax({data:s,type:"GET",error:o,success:r,url:"/svc/data/tumblelog",with_form_key:!0})})}function r(e,t){return a.ajax({cache:!t.force,data:t.data,type:"GET",url:"/svc/tumblelog_popover/"+e,with_form_key:!0})}var a=i(9),l=i(3),c=i(121),u=i(110),h=i(142),d=i(113),p=function(){function e(e){return e.has("avatar_url")&&e.has("global_theme_params")}return function(t){return e(t)?"/svc/"+t.get("name")+"/posts/highlighted":"/svc/tumblelog_popover/"+t.get("name")}}(),g=d.extend({save_following:function(e,t){t||(t={}),e||(e={}),e.following=!!e.following;var i=this;return t.force||i.get("following")!==e.following?n(i,e,t).then(l.bindKey(i,"save_following",e)):a.when(i.get("following"))},fetch_popover_data:function(e){e||(e={}),e.is_user_mention=!!e.is_user_mention,e.is_tumblelog_popover=!!e.is_tumblelog_popover;var t=this;return!e.force&&t.has("highlighted_posts")?a.when(t.get("highlighted_posts")):s(t,e).then(l.bindKey(t,"fetch_popover_data",null))},fetch_analytics_data:function(){return o(this,{include_member_data:!0,include_activity_data:!0})},fetch_activity_notifications:function(){return o(this,{include_member_data:!0,include_activity_data:!0,include_activity_notifications:!0})},toggle_spam:function(){return a.ajax({url:"/spam/toggle",type:"POST",data:{tumblelog:this.id},with_form_key:!0})},toggle_nsfw:function(){return a.ajax({url:"/nsfw/toggle",type:"POST",data:{tumblelog:this.id},with_form_key:!0})},toggle_adult:function(){return a.ajax({url:"/adult/toggle",type:"POST",data:{tumblelog:this.id},with_form_key:!0})},toggle_uniblock:function(){return a.ajax({url:"/uniblock/toggle",type:"POST",data:{tumblelog:this.id},with_form_key:!0})},toggle_suspended:function(){return a.ajax({url:"/suspended/toggle",type:"POST",data:{tumblelog:this.id},with_form_key:!0})},follow:function(e){this.save_following({following:!0},e)},_unfollow:function(e){this.save_following({following:!1},e)},requestUnfollow:function(e){var t=c.defer();return t.promise.then(l.bind(this._unfollow,this,e))["catch"](l.noop),t},block:function(){return h.block({blockedTumblelog:this.id})},unblock:function(){return h.unblock({blockedTumblelog:this.id})},toggleSubscription:function(){var e=this.get("name"),t=!!this.get("is_subscribed"),i=t?"DELETE":"POST";return c.promise(function(t,n){a.ajax({url:"/svc/blog/"+e+"/subscription",type:i,with_form_key:!0,success:t,error:n})}).then(l.bind(function(){this.set({is_subscribed:!t})},this))},defaults:null,idAttribute:"name",initialize:function(){this.bindEvents()},bindEvents:function(){var e=this.get("name");this.on("change:following",function(){if(this.previous("following")){var t=this.get("following")?"tumblelog:follow":"tumblelog:unfollow";u.trigger(t,{name:e,loggingData:e})}this._updateSubscriptionStatus()},this),this.on("change:twitter_send_posts",this._updateUserSocial),this.on("change:facebook_opengraph_send_posts",this._updateUserSocial)},_updateSubscriptionStatus:function(){this.get("following")?this.set("can_subscribe",!0):this.set({can_subscribe:!1,is_subscribed:!1})},_updateUserSocial:function(){var e={tumblelog_name_or_id:this.get("name"),page:"tumblelog","tumblelog[facebook_opengraph_send_posts]":this.get("facebook_opengraph_send_posts")?"on":"off","tumblelog[twitter_send_posts]":this.get("twitter_send_posts")?"on":"off"};a.ajax({data:e,type:"POST",url:"/settings/save",with_form_key:!0})},getDisplayName:function(){return this.get("is_legacy_private_channel")?this.get("directory_safe_title"):this.get("name")},parse:function(e){return e},validate:function(){return!1},destroy:function(){return this},fetch:function(){return this},save:function(){return this},url:function(){},urlRoot:function(){}},{collection:null,modelFromToken:function(e){var t,i=g.getCollection(),n=a.Deferred(),s=i.findWhere({token:e});return s?n.resolve(s):(t={data:{is_user_mention:!0}},r(e,t).then(function(t){var i=new g(t);i.set({token:e}),n.resolve(i)},function(){n.reject()})),n.promise()}});g.collection=g.getCollection(),e.exports=g},,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(101),r=i(106),a=i(143),l=i(121),c={_getCurrentTumblelog:function(){var e="",t=r.get("Context/userinfo");return t&&s.each(t.channels,function(t){t.is_current&&(e=t.name)}),e},block:function(e){e=e||{};var t={};return t.tumblelog=e.currentTumblelog||this._getCurrentTumblelog(),e.blockedTumblelog?t.blocked_tumblelog=e.blockedTumblelog:e.blockedPost&&(t.blocked_post=e.blockedPost),e.context&&(t.block_context=e.context),n.ajax({url:"/svc/block/add",type:"POST",data:t,with_form_key:!0})},unblock:function(e){e=e||{};var t={};return t.tumblelog=e.currentTumblelog||this._getCurrentTumblelog(),t.blocked_tumblelog=e.blockedTumblelog,n.ajax({url:"/svc/block/remove",type:"POST",data:t,with_form_key:!0})},confirmBlock:function(e){e=e||{};var t,i=e.currentTumblelog||this._getCurrentTumblelog(),n=l.defer();if(e.blockedTumblelog)t=o("%1$sAre you sure you want to block %2$s from %3$s?%4$sThey won't be able to follow %3$s, send %3$s messages, see %3$s in search results, or interact with any of %3$s's posts.%5$s","<h3>",e.blockedTumblelog,i,"</h3><small>","</small>");else{if(!e.blockedPost)return n.reject(),n.promise;t=o("%1$sBlock messages from this sender?%2$sAny further messages sent from their IP address will be blocked from your inbox. This can't be undone, by the way.%3$s","<h3>","</h3><small>","</small>")}return a.confirm(t,function(){n.resolve(e.blockedTumblelog?e.blockedTumblelog:e.blockedPost)},function(){n.reject()},o("Block"),o("Nevermind")),n.promise["catch"](s.noop),n.promise}};e.exports=c},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(148),r=s.extend({name:"Dialog",initialize:function(e){this.dialogView=o,this.options=n.extend({},this.defaults,e)},alert:function(e,t,i){return this.dialogView.alert.call(this.dialogView,e,t,i)},confirm:function(e,t,i,n,s){return this.dialogView.confirm.call(this.dialogView,e,t,i,n,s)},dialog:function(e){return this.dialogView.dialog.call(this.dialogView,e)},isActive:function(e){return this.dialogView.isActive.call(this.dialogView,e)},close:function(e){return this.dialogView.close.call(this.dialogView,e)},getDialogEl:function(){return this.dialogView.getDialogEl.call(this.dialogView)},__:function(e){return this.dialogView.__.call(this.dialogView,e)}});e.exports=new r},function(e,t,i){"use strict";var n=i(3),s=i(7),o=i(145),r=i(106),a=(i(103),i(146)),l=i(147),c=["selector","container","rootEl","view","viewOptions","autoAppend"],u=o.extend({name:null,rootEl:null,selector:null,view:null,viewOptions:{},autoAppend:!1,defaults:{},constructor:function(e){e||(e={}),this.cid=n.uniqueId("component"),n.extend(this,n.pick(e,c));var t=n.result(this,"defaults"),i=n.extend({},t,n.pick(e,n.keys(t)));this.attributes={},this.set(i,{silent:!0}),this.changed={},(this.autoAppend||this.selector)&&this.setContainer(),this.selector||(this.selector=this.defaultSelector),this.view&&this.view.prototype&&this.view.prototype instanceof s.View?this.view=new this.view(this.viewOptions):n.isFunction(this.view)&&(this.view=this.view.call(this,this.viewOptions)),this.initialize.apply(this,arguments),this.autoAppend&&this.append()},initialize:n.noop,setContainer:function(){return this.selector||(this.selector=this.defaultSelector),this.container=this.selector,this.container},getOwnData:function(){return this.data},remove:function(){n.result(this,"beforeRemove"),this.view&&n.isFunction(this.view.remove)&&this.view.remove();var e=["container","view","defaults","attributes"];return n.each(e,n.bind(function(e){this[e]&&delete this[e]},this)),this.stopListening(),this.trigger("remove"),this},append:function(){return this.view&&n.isFunction(this.view.render)&&(this.container?this.container.appendChild(this.view.render().el):this.view.render()),this.trigger("append"),this}});Object.defineProperties(u.prototype,{defaultSelector:{get:function(){return"[prima-component="+this.name+"]"},set:function(){}},container:{get:function(){return this._container},set:function(e){var t=a(e,this.rootEl);this._container=t}},data:{get:function(){return this._data||(this._data=r.get("Components/"+this.name)),this._data},set:function(e){this._data=e}}}),l.mixin.applyTo(u.prototype),e.exports=u},function(e,t,i){"use strict";function n(){}var s=i(7),o=i(117);n.extend=s.Model.extend,o.applyTo(n),e.exports=n},function(e,t,i){"use strict";function n(e){return e&&e.nodeType&&1===e.nodeType}var s=i(3);e.exports=function(e,t){if(n(e))return e;if(s.isString(e)){var i=(t||document).querySelector(e);if(n(i))return i}return e&&e.jquery?e.get(0):!1}},function(e,t,i){"use strict";var n=i(3),s=i(7),o=i(116),r=s.Model.prototype,a={get:r.get,has:r.has,set:r.set,unset:r.unset,clear:r.clear,hasChanged:r.hasChanged,changedAttributes:r.changedAttributes,previous:r.previous,toJSON:r.toJSON,toggle:function(e){this.set(e,!this.get(e))},_validate:n.constant(!0)},l=new o(n.extend({},a,{defaults:n.extend({},s.Events)}));e.exports={props:a,mixin:l}},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(149),r=i(110),a=i(101),l=i(150),c=o.extend({el:".ui_dialog",translations:{},defaultTemplates:{dialog:i(151),content:i(152),button:i(153)},events:{"click .ui_button":"buttonClick"},defaultDialog:{text:"",type:"default",has_form:"auto",visible_glass:!0,confirm_by_enter:!0,close_by_space:!0,key_tab:!0,key_close:!0,scroll_lock:!1,keycommand_maintain:!1,animate:!0,animate_in:{dialog_el:".ui_dialog",dialog_class:"fade-in-up"},on_close:function(){},on_open:function(){}},initialize:function(e){this.options=s.extend(this.defaults,this.options),this.templates=this.defaultTemplates,this.is_visible=!1,this.dialogQueueOrder=[],this.dialogQueue={},this.queueCounter=0,this.currentDialog=!1,this.currentDialogId=0,this.uid=0,this.$body=n("body"),this._initClickLock(),this._setupKeys(),r&&!t.Dialog&&(this.listenTo(r,"dialog:dialog",this.dialog),this.listenTo(r,"dialog:confirm",this.confirm),this.listenTo(r,"dialog:confirm:promise",this.confirmPromise),this.listenTo(r,"dialog:alert",this.alert),this.listenTo(r,"dialog:close",this.close))},dialog:function(e){return s.isObject(e)?this._dialog(e):!1},confirm:function(e,t,i,n,o){s.isString(e)&&(e={text:e});var r={callback_ok:t,callback_cancel:i,text_ok:n,text_cancel:o};e=s.extend(this.defaultDialog,r,e);var l={text:e.text,customClass:e.customClass||null,type:"confirm",visible_glass:!0,keycommand_maintain:e.keycommand_maintain||!1,templates:e.templates||null,escape_button:0,animate_in:{dialog_el:e.animate_in.dialog_el||".ui_dialog",dialog_class:e.animate_in.dialog_class||"fade-in-up"},buttons:{0:{text:e.text_cancel||a("Cancel"),close:!0,callback:s.isFunction(e.callback_cancel)?e.callback_cancel:function(){}},1:{text:e.text_ok||a("OK"),selected:!0,btn_class:"blue",close:!0,callback:s.isFunction(e.callback_ok)?e.callback_ok:function(){}}}};return this._dialog(l)},confirmPromise:function(e,t){this.confirm(t,e.resolve,e.reject)},alert:function(e,t,i){s.isString(e)&&(e={text:e});var n={callback_ok:t,text_ok:i};e=s.extend({},n,e);var o={text:e.text,customClass:e.customClass||null,type:"alert",visible_glass:!0,keycommand_maintain:e.keycommand_maintain||!1,templates:e.templates||null,escape_button:0,buttons:{0:{text:e.text_ok||a("OK"),selected:!0,btn_class:"blue",close:!0,callback:s.isFunction(e.callback_ok)?e.callback_ok:function(){}}}};return this._dialog(o)},getDialogEl:function(){return this.el},buttonClick:function(e){var t=n(e.currentTarget),i=t.data("btn-id");if(s.isUndefined(this.currentDialog.buttons[i])||t.hasClass("disabled"))return!1;var o=this.currentDialog.buttons[i],r=null;s.isFunction(o.callback)&&(r=o.callback(this)),r!==!1&&(!s.isUndefined(o.close)&&o.close||s.isUndefined(o.close))&&this.close()},isActive:function(e){return this.currentDialog!==!1&&this.currentDialog.uid===e},close:function(e){if(this.currentDialog===!1)return!1;if(s.isUndefined(e)&&(e=!1),e!==!1&&this.currentDialog.uid!==e)return!1;if(this.$dialog_lock.removeClass("opaque"),this.$dialog_el.addClass("fade-out-down"),l.transition(this.$dialog_lock,s.bind(function(){this.$dialog_lock.hide()},this)),l.animation(this.$dialog_el,s.bind(function(){n(".ui_dialog_pos").remove()},this)),this.is_visible=!1,this.currentDialog.keycommand_maintain||r.trigger("keycommands:resume"),s.isFunction(this.currentDialog.on_close)&&this.currentDialog.on_close(),r.trigger("dialog:closed"),this.currentDialog=!1,n("html").removeClass("dialog_lock"),this.dialogQueueOrder.length>0){var t=this.dialogQueueOrder.shift(),i=this.dialogQueue[t];delete this.dialogQueue[t],this._dialog(i)}},_tab:function(e){var t=this.$el.find(".buttons .tab_frame"),i=t.filter(".focus"),n=t.index(i),s=t.length,o=!1;o=s>n+1?n+1:0,i.removeClass("focus init_focus");var r=t.eq(o);r.length>0&&(r.addClass("focus"),r.find("button").focus())},_formIsTabToButton:function(e,t){var i=this.$el.find(":focus");if(0===i.length)return!0;var n=this.$el.find(".buttons .tab_frame"),s=this.$el.find(":input:visible"),o=s.index(i);if(t&&o===s.length-1)return this.$el.find(":input:visible:first").focus(),e.preventDefault(),n.removeClass("focus init_focus"),!1;if(o>=0){var r=this.$el.find(":input:visible:eq("+(o+1)+")");if(r.length>0&&r.hasClass("ui_button"))return!0}return n.removeClass("focus init_focus"),!1},_select:function(e){var t=this.$el.find(".buttons .tab_frame.focus"),i=t;1===i.length&&i.find(".ui_button").click()},_formIsFocusOnButton:function(e){var t=this.$el.find(":focus");return 0===t.length?!1:t.hasClass("ui_button")},_escape:function(e){if(!s.isUndefined(this.currentDialog.escape_button)){var t=this.$el.find(".btn_"+this.currentDialog.escape_button);t.length&&t.click()}},_dialog:function(e){if(s.isUndefined(e.uid)&&(e.uid=this._getUid()),this.currentDialog!==!1)return this.dialogQueueOrder.push(this.queueCounter),this.dialogQueue[this.queueCounter]=e,this.queueCounter++,e.uid;s.defaults(e,this.defaultDialog);var t=this._buildButtons(e.buttons);s.extend(e,{buttons_html:t});var i=this.templates;s.isObject(e.templates)&&(i=s.extend({},this.templates,e.templates));var o=s.isString(i.dialog)?s.template(i.dialog):i.dialog,a=s.isString(i.content)?s.template(i.content):i.content;e.content_html=a(e);var l=o(e);this.$dialog_lock.show(),s.isUndefined(e.visible_glass)?this.$dialog_lock.removeClass("opaque"):e.visible_glass&&s.defer(s.bind(function(){this.$dialog_lock.addClass("opaque")},this)),!s.isUndefined(e.scroll_lock)&&e.scroll_lock&&n("html").addClass("dialog_lock"),this.currentDialogId=e.uid,this.currentDialog=e;var c=n('<div id="dialog_'+this.currentDialogId+'" class="ui_dialog_pos">'+l+"</div>");return s.isString(e.customClass)&&c.addClass(e.customClass),c.appendTo(this.$body),this.setElement(c),this.is_visible=!0,this.$dialog_el=this.$el.find(e.animate_in.dialog_el),e.animate&&s.isObject(e.animate_in)&&this.$dialog_el.length&&this.$dialog_el.addClass(e.animate_in.dialog_class),this._focus(),this.currentDialog.keycommand_maintain||r.trigger("keycommands:suspend"),s.isUndefined(e.has_form)&&(e.has_form="auto"),"auto"===e.has_form&&(e.has_form=this.$el.find("form, input").length>0),s.isFunction(e.on_open)&&e.on_open(),this.el=this.$el[0],this.delegateEvents(),r.trigger("dialog:opened"),e.uid},_button:function(e,t,i,n){var o=s.isString(this.templates.button)?s.template(this.templates.button):this.templates.button,r=o({btn_class:t,text:e,btn_id:s.isUndefined(i)?"":i});return r='<div class="tab_frame">'+r+"</div>"},_focus:function(){if(!this.currentDialog)return!1;for(var e in this.currentDialog.buttons){var t=this.currentDialog.buttons[e];if(!s.isUndefined(t.selected)&&t.selected){var i=this.$el.find(".btn_"+e);i.length>0&&i.parent().addClass("focus init_focus")}}},_setupKeys:function(){n(document).on("keydown",s.bind(function(e){var t=e.ctrlKey||e.shiftKey||e.metaKey;if(this.is_visible&&!t){var i=e.keyCode||e.which;if(9===i&&this.currentDialog.key_tab){if(this.currentDialog.has_form&&!this._formIsTabToButton(e,!0))return;e.preventDefault(),this._tab(e)}if(13===i&&this.currentDialog.confirm_by_enter||32===i&&this.currentDialog.close_by_space){if(this.currentDialog.has_form&&32===i&&!this._formIsFocusOnButton(e))return;e.preventDefault(),this._select(e)}27===i&&this.currentDialog.key_close&&(e.preventDefault(),this._escape(e))}},this))},_buildButtons:function(e){if(!s.isObject(e))return"";var t=0;for(var i in e)e.hasOwnProperty(i)&&t++;for(var n="",o=0;t>o;o++)if(!s.isUndefined(e[o])){var r=s.isUndefined(e[o].text)?"":e[o].text,a=s.isUndefined(e[o].btn_class)?"":e[o].btn_class,l=s.isUndefined(e[o].selected)?!1:e[o].selected;n+=this._button(r,a,o,l)}return n},_initClickLock:function(){var e=this.$dialog_lock=n("<div>",{"class":"ui_dialog_lock",css:{display:"none"}});n(document).ready(function(){e.prependTo("body")})},_getUid:function(){return this.uid++},__:function(e){return a(e)}});e.exports=new c},function(e,t,i){"use strict";function n(e,t){t||(t={}),e||(e=[]),s.each(e,function(e){s.isFunction(this[e])&&this[e].call(this,t)},this)}var s=i(3),o=i(7),r=i(117),a=["model","collection","el","id","attributes","className","tagName","events"],l=["_setup"],c=o.View.extend({constructor:function(e){this.cid=s.uniqueId("view"),e||(e={}),s.extend(this,s.pick(e,a)),this._elAttributes=this.attributes,this.attributes={},this._ensureElement(),this.setupMethods=s.union(l,this.constructor.__super__.setupMethods,this.setupMethods),
n.call(this,this.setupMethods,e),this.initialize.apply(this,arguments),this.delegateEvents()},_setup:s.noop,_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var e=s.extend({},s.result(this,"_elAttributes"));this.id&&(e.id=s.result(this,"id")),this.className&&(e["class"]=s.result(this,"className"));var t=o.$("<"+s.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}}});r.applyTo(c),e.exports=c},function(e,t,i){"use strict";function n(){var e,t,i={animation:null,transition:null},n=document.createElement("div"),s={animation:"animationend",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(t in s)if(t in n.style){i.animation=s[t];break}var o={transition:"transitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in o)if(e in n.style){i.transition=o[e];break}return i}function s(e,t){a.animation?r(e).one(a.animation,function(e){t(e)}):setTimeout(function(e){t(e)},0)}function o(e,t){a.transition?r(e).one(a.transition,function(e){t(e)}):setTimeout(function(e){t(e)},0)}var r=i(9),a=n();e.exports={animation:s,transition:o}},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="ui_dialog '+(null==(__t=type)?"":__t)+'"> '+(null==(__t=content_html)?"":__t)+' <div class="buttons">'+(null==(__t=buttons_html)?"":__t)+"</div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<span class="text">'+(null==(__t=text)?"":__t)+"</span>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<button class="ui_button btn_'+(null==(__t=btn_id)?"":__t)+" chrome "+(null==(__t=btn_class)?"":__t)+'" data-btn-id="'+(null==(__t=btn_id)?"":__t)+'"><span>'+(null==(__t=text)?"":__t)+"</span></button>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n,s=i(144),o=i(155),r=s.extend({name:"header",autoAppend:!0,append:function(){this.headerView=new o({el:this.container}),this.enableFunctionality()},enableFunctionality:function(){this.headerView.enableCompose()},disableSticky:function(){this.headerView.disableSticky()}});e.exports=function(){return n||(n=new r),n}},function(e,t,i){"use strict";var n=i(9),s=i(156),o=i(108),r=i(110),a=i(159),l=i(161),c=i(540),u=i(541),h=i(550),d=i(579),p=i(111),g=s.extend({defaults:{headerHeight:52,headerTop:0},events:{"click .tab_discover > a":"onClickExplore",mouseenter:"__mouseenter",mouseleave:"__mouseleave"},initialize:function(){var e=o.bool("is_logged_in");this.logo=new c({el:'[prima-component="svg-logo"]'}),e&&(this.accountMenu=new u({el:".tab_nav_account"}),n(".tab_activity").length&&(this.activityMenu=new h({el:".tab_activity"})),this._initializeMessaging()),this.set("headerTop",this.$el.position().top),this.listenTo(r,"Header:hide",this.hide),this.listenTo(r,"Header:show",this.show),this.listenTo(r,"Header:setTransparent",this.setTransparent),this.$window=n(window)},enableCompose:function(){this.composeBtn=new a,this.switcher=new l},disableSticky:function(){this.$el.addClass("l-header-container--unstuck")},setTransparent:function(e){this.$el.toggleClass("l-header-container--transparent",!!e)},hide:function(){var e=this.$window.scrollTop()+this.get("headerTop"),t=e<this.get("headerHeight")?e:this.get("headerHeight");this.$el.css({position:"absolute",top:e+"px"}),this.$el.velocity({translateY:[-t,0],translateZ:"0px"},150).velocity({translateY:"0px",translateZ:"0px",top:0},0)},show:function(){var e=this.$window.scrollTop(),t=e<this.get("headerHeight")?e:this.get("headerHeight");this.$el.css({position:"absolute",top:e+"px",transform:"translateY("+-t+"px) translateZ(0)"}),this.$el.velocity({translateY:[0,-t],translateZ:"0px"},150).css({position:"fixed",top:this.get("headerTop")})},onClickExplore:function(){r.trigger("explore-links:click",{loggingData:{source:"app-header"}})},_initializeMessaging:function(){var e=p(),t=this.$(".tab_messaging"),i=o.bool("is_logged_in")&&t.length>0&&e.canMessage();i?this.messaging=new d({inboxAnchorEl:t,inboxPopoverOptions:{isFixedPosition:"fixed"===this.$el.css("position")}}).render():t.length&&t.hide()},__mouseenter:function(){r.trigger("Header:mouseenter")},__mouseleave:function(){r.trigger("Header:mouseleave")}});e.exports=g},function(e,t,i){"use strict";function n(e,t,i){return s.isFunction(e)&&(e=e(t,i)),e instanceof o?e:t.$(e)}var s=i(3),o=i(9),r=i(7),a=i(121),l=i(157),c=i(158),u=i(147),h=i(149),d=h.extend({rendered:!1,disposed:!1,keepElement:!1,_setup:function(e){e||(e={});var t=s.extend({},s.result(this.constructor.__super__,"defaults"),s.result(this,"defaults"));s.extend(t,s.pick(e,s.keys(t))),this.attributes={},this.set(t),this.changed={};var i=this.render;this.render=s.bind(function(){this._beforeRender.apply(this,arguments),this.beforeRender.apply(this,arguments);var e=i.apply(this,arguments);return this.afterRender.apply(this,arguments),this._afterRender.apply(this,arguments),e},this);var n=this.remove;this.remove=s.bind(function(){if(this.disposed)return this;this._beforeRemove.apply(this,arguments),this.beforeRemove.apply(this,arguments);var e=n.apply(this,arguments);return this.afterRemove.apply(this,arguments),this._afterRemove.apply(this,arguments),e},this),this.subviews=s.extend({},this.subviews,e.subviews)},initialize:s.noop,_registerSubview:function(e){return this._subviews||(this._subviews=[]),this._subviews.push(e),e},appendSubview:function(e,t){return s.isString(t)&&(t=this.$(t)),this._registerSubview(e),e.render(),(t||this.$el).append(e.el),e},removeSubviews:function(){var e=s.flatten(this._subviews);e&&(s.invoke(e,"remove"),delete this._subviews)},renderSubviews:function(){this.subviews&&s.forEach(this.subviews,function(e,t){e instanceof r.View?this.renderSubview(e,{name:t}):e.collection?this.renderCollectionSubviews(t):this.renderSubview(t)},this)},_createDefaultContainerFunction:function(e){return s.bind(function(){return this.$('[data-subview="'+e+'[]"]')},this)},_createDefaultPrepareViewFunction:function(e){var t=this.subviews[e];return s.bind(function(i,n){var s=new t.constructor(n);return s.$el.attr("data-subview",e),i.append(s.$el),s},this)},renderCollectionSubviews:function(e){var t=this.subviews[e];if(t){var i=t.container||this._createDefaultContainerFunction(e),n=t.prepareView||this._createDefaultPrepareViewFunction(e),s=t.options||{},o=this.createCollectionSubviewRenderer(t.collection,i,n,s,e);this.rendered?o():this.once("rendered",o,this)}},renderSubview:function(e,t){var i,n,o,a;if(s.isString(e)){if(a=e,e=this.subviews[a],!e)return;i=e.container||'[data-subview="'+a+'"]',o=e.options||{},n=e.prepareView||function(t,i){if(!s.isEmpty(t)){var n=new e.constructor(i);return n.$el.attr("data-subview",a),t.replaceWith(n.$el),n}}}else e instanceof r.View&&(t||(t={}),a=t.name||"",i=t.container||'[data-subview="'+a+'"]',o=t.options||{},n=t.prepareView||function(t){return e.$el.attr("data-subview",a),t.replaceWith(e.$el),e});var l=this.createSubviewRenderer(i,n,o,a);this.rendered?l():this.once("rendered",l,this)},createSubviewRenderer:function(e,t,i,o){return s.bind(function(){if(this.el){i=i||{},s.isFunction(i)&&(i=i.call(i,this));var r=n(e,this,o);if(!s.isEmpty(r)){var a=t.call(this,r,i);o&&s.set(this,o,a),a.render(),this._registerSubview(a)}}},this)},createCollectionSubviewRenderer:function(e,t,i,o,a,l,c){var u;return s.bind(function(){if(this.el){var h=0;if(a&&(l?h=this[a].length:this[a]=[]),e===!0&&(e=this.collection),s.isFunction(e)&&(e=e(this)),e instanceof r.Collection&&(e=e.models),!s.isEmpty(e)){var d=n(t,this,a);s.isEmpty(d)||(l||(u=d,d=u.clone()),s.forEach(e,function(e,t){var n;n=s.isFunction(o)?o.call(o,this,e)||{}:s.extend({},o),n.model||(n.model=e);var r="";a&&(r=a+"["+(h+t)+"]"),c&&s.extend(n,c),this.createSubviewRenderer(d,i,n,r).call(this)},this),l||u.replaceWith(d))}}},this)},_beforeRender:s.noop,beforeRender:s.noop,render:function(){return this.disposed?!1:(this.renderWithTemplate(),this)},afterRender:s.noop,_afterRender:function(){this.renderSubviews(),this.rendered=!0,this.trigger("rendered",this),this._verifySubviewsRendered()},getTemplateData:function(){var e=l(this);return this.model&&(e.model=l(this.model)),this.collection&&(e.collection={items:l(this.collection),length:this.collection.length}),e},renderWithTemplate:function(e){if(s.isUndefined(this.template))throw new Error("Template function needed.");var t;return t=s.isFunction(this.template)?this.template(e||this.getTemplateData()):this.template,this.$el.html(t),this},afterRenderSubviews:s.noop,_verifySubviewsRendered:function(){var e=s.bind(function(){this.afterRenderSubviews(),this.trigger("renderedSubviews")},this),t=s.reject(this._subviews,function(e){return e.rendered===!0||e._rendered===!0});s.isEmpty(t)?e():a.map(t,function(e){return a.promise(s.partial(function(t,i){e.once("rendered",t)},e))}).then(e)},_beforeRemove:function(){this.removeSubviews()},beforeRemove:s.noop,remove:function(){return this.keepElement?(this.undelegateEvents(),this.stopListening()):h.prototype.remove.apply(this,arguments),this},afterRemove:s.noop,_afterRemove:function(){var e=["el","$el","options","model","collection","subviews","_subviews","defaults","attributes"];s.forEach(e,s.bind(function(e){this[e]&&delete this[e]},this)),this.rendered=!1,this.disposed=!0}},{subviewWithOptions:function(e){return c.call(null,this,e)}});u.mixin.applyTo(d.prototype),e.exports=d},function(e,t,i){"use strict";function n(e){return s.isFunction(e.serialize)?e.serialize():s.isFunction(e.toJSON)?e.toJSON():void 0}var s=i(3);e.exports=n},function(e,t,i){"use strict";function n(e,t){return{constructor:e,options:function(e){var i=s.isFunction(t)?t(e):t;return s.extend(s.pick(e,e.viewOptionKeys),i)}}}var s=i(3);e.exports=n},function(e,t,i){"use strict";var n=i(108),s=i(149),o=i(110),r=i(160),a=s.extend({mixins:[r],el:".compose-button",events:{click:"toggleOpen"},defaults:{open:!1},loggingData:{source:"compose-button"},initialize:function(){this.on("change:open",this.onChangeOpen),n.bool("dashboard_refresh")?(this.listenTo(o,"fastCompose:init:complete",this.open),this.listenTo(o,"fastCompose:dismiss:complete",this.close)):(this.listenTo(o,"fastCompose:init:complete",this.open),this.listenTo(o,"fastCompose:dismiss:complete",this.close))},toggleOpen:function(){this.toggle("open")},open:function(){this.set("open",!0)},close:function(){this.set("open",!1)},onChangeOpen:function(e,t){n.bool("dashboard_refresh")?t?o.trigger("fastCompose:init",{loggingData:this.loggingData}):o.trigger("fastCompose:dismiss",{loggingData:this.loggingData}):t?o.trigger("fastCompose:init"):o.trigger("fastCompose:dismiss")}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(7),o=i(116),r=i(147),a=new o(n.extend({},r.props,{defaults:n.extend({},s.Events),before:{initialize:function(){var e=n.defaults({},n.result(this,"defaults"));this.attributes={},this.set(e),this.changed={}}}}));e.exports=a},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(144),r=i(110),a=i(162),l=i(164),c=o.extend({name:"switcher",mixins:[a],keycommands:{"keydown:alt+c":"macFastCompose","keydown:z+c":"winFastCompose"},loggingData:{},initialize:function(){this.$body=n("body"),this.$glass=null,this.suspended=!1,this.bindEvents()},bindEvents:function(){this.listenTo(r,"keycommands:suspend",this.suspend),this.listenTo(r,"keycommands:resume",this.resume),this.listenTo(r,"fastCompose:close:complete",this.dismissFastCompose),this.listenTo(r,"fastCompose:dismiss",this.dismissFastCompose),this.listenTo(r,"fastCompose:init",this.initFastCompose)},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},macFastCompose:function(e){"MacIntel"===navigator.platform&&this.initFastCompose(e)},winFastCompose:function(e){"Win32"===navigator.platform&&this.initFastCompose(e)},initFastCompose:function(e){this.suspended||this.fastCompose||(this.determineSource(e),this.fastCompose=new l({loggingData:this.loggingData}),this.$body.append(this.fastCompose.render().el),this.showPlexi(),this.fastCompose.open(),r.trigger("fastCompose:init:complete"))},dismissFastCompose:function(){this.fastCompose&&(this.hidePlexi(),this.fastCompose.teardown(),this.fastCompose=null),r.trigger("fastCompose:dismiss:complete")},showPlexi:function(){this.$glass=n("<div>",{"class":"glass show"}).appendTo(this.$body),s.defer(s.bind(function(){this.$glass.addClass("blue")},this)),r.trigger("drawer:suspend")},hidePlexi:function(){this.$glass.remove(),this.$glass=null,r.trigger("drawer:resume")},determineSource:function(e){this.loggingData.source="fast-compose",e&&(e.originalEvent instanceof window.KeyboardEvent?this.loggingData.source="keycommand":e.loggingData&&e.loggingData.source&&(this.loggingData.source=e.loggingData.source))}});e.exports=c},function(e,t,i){"use strict";var n=i(116),s=i(110),o=i(3),r=i(163),a=new n({__bindKeycommands:function(){o.result(this,"keycommands")&&(o.each(o.result(this,"keycommands"),this.__bindKey,this),r.add({id:this.__keyId,keys:o.keys(o.result(this,"keycommands"))}))},__bindKey:function(e,t){this.listenTo(s,"DOMEventor:"+t,this.__keyFn)},__keyFn:function(e,t){!this.__keysDisabled&&r.shouldRun(t,this.__keyId)&&this[this.keycommands[t]].apply(this,arguments)},focusKeys:function(){r.focus(this.__keyId)},unfocusKeys:function(){r.unfocus(this.__keyId)},soloKeys:function(e){r.solo(this.__keyId,e)},unSoloKeys:function(){r.unSolo(this.__keyId)},disableKeys:function(){this.__keysDisabled=!0},enableKeys:function(){this.__keysDisabled=!1},before:{initialize:function(){this.keycommands||(this.keycommands={}),this.__keysDisabled=!1,this.__keyId=o.uniqueId("keycomms"),this.__bindKeycommands()},stopListening:function(e){(o.isEmpty(e)||e===this)&&r.remove(this.__keyId)}}});e.exports=a},function(e,t,i){"use strict";var n=i(145),s=i(3),o=n.extend({soloId:null,constructor:function(){this.keySets=[],this.soloBubblingWhitelist=[]},add:function(e){this.keySets.unshift(e)},remove:function(e){var t=this.getSetForId(e);t&&(this.unSolo(e),this.keySets=s.without(this.keySets,t),this.soloBubblingWhitelist=s.without(this.soloBubblingWhitelist,e))},focus:function(e){var t=this.getSetForId(e);t&&(this.keySets=s.without(this.keySets,t),this.keySets.unshift(t))},unfocus:function(e){var t=this.getSetForId(e);t&&(this.keySets=s.without(this.keySets,t),this.keySets.push(t))},solo:function(e,t){var i=this.getSetForId(e);i&&(this.soloId=e,t===!0&&this.soloBubblingWhitelist.push(e))},unSolo:function(e){this.soloId===e&&(this.soloId=null,this.soloBubblingWhitelist=s.without(this.soloBubblingWhitelist,e))},getSetForId:function(e){return this.keySets[s.findIndex(this.keySets,{id:e})]},getSetsWithKey:function(e){return s.where(this.keySets,{keys:[e]})},shouldRun:function(e,t){var i=this.getSetsWithKey(e);return this.soloId===t?!0:s.isEmpty(this.soloBubblingWhitelist)||s.contains(this.soloBubblingWhitelist,t)?i.length>1?i[0].id===t:!0:!1}});e.exports=new o},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(165),r=i(106),a=i(101),l=i(121),c=i(149),u=i(110),h=i(108),d=i(162),p=i(160),g=i(166),m=i(539),f=c.extend({template:m,className:"fast-compose",defaults:{tabIndex:-1,icons:[{name:"text",label:"Text"},{name:"photo",label:"Photo"},{name:"quote",label:"Quote"},{name:"link",label:"Link"},{name:"chat",label:"Chat"},{name:"audio",label:"Audio"},{name:"video",label:"Video"}]},events:{"click .post-tab-switching .tab-post-type":"clickCreate","mouseover .post-tab-switching .tab-post-type":"mouseoverIcon","click .post-tab-switching":"close"},mixins:[p,d],keycommands:{"keydown:c":"nextIcon","keydown:shift+c":"previousIcon","keydown:tab":"nextIcon","keydown:shift+tab":"previousIcon","keydown:right":"nextIcon","keydown:left":"previousIcon","keydown:enter":"enterCreate","keydown:escape":"close"},initialize:function(e){this.loggingData=e?e.loggingData:{},s.forEach(this.get("icons"),function(e){e.label=a(e.label)}),this.$body=n("body"),this.$glass=null,this.$plexiInstance=n('.plexi[data-token="body-plexi"]'),this.resumeKeycommandsOnClose=!0},bindEvents:function(){this.listenTo(u,"DOMEventor:keydown:tab",this.disableKey),this.listenTo(u,"DOMEventor:keydown:shift+tab",this.disableKey),this.listenTo(this,"change:tabIndex",function(e,t){this.$(".selected").removeClass("selected"),this.$('[data-index="'+t+'"]').addClass("selected")})},render:function(){return this.$el.append(this.template(this.toJSON())),this.bindEvents(),this},open:function(){s.defer(s.bind(this.show,this))},show:function(){u.trigger("keycommands:suspend");var e=50;s.forEach(this.$(".tab-post-type"),function(t,i){var s=n(t),r=s.find(".post-type-icon"),a=s.find(".post-type-name");o.animate(r,{opacity:["1","0"],translateY:["0px","15px"]},{duration:150,delay:i*e}),o.animate(a,{opacity:["1","0"],translateY:["0px","-15px"]},{duration:150,delay:i*e})},this),n(".post-tab-switching").addClass("finish-animating")},enterCreate:function(e){var t=this.$(".selected");if(t.length){var i=t.attr("data-post-type");this.createNew(i),this.close()}},clickCreate:function(e){this.createNew(n(e.currentTarget).data("postType"))},disableKey:function(e){e.preventDefault()},mouseoverIcon:function(e){this.$(".selected").removeClass("selected"),this.set("tabIndex",n(e.currentTarget).data("index"))},nextIcon:function(e){var t=this.get("tabIndex")+1;t>=this.get("icons").length&&(t=0),this.set("tabIndex",t)},previousIcon:function(e){var t=this.get("tabIndex")-1;0>t&&(t=this.get("icons").length-1),this.set("tabIndex",t)},createNew:function(e){this.resumeKeycommandsOnClose=!1,r.has("Components/PostFormBuilder")?u.trigger("postForms:open",{updateURL:!1,postFormType:g.containerType("modal"),postType:e,fastCompose:!0,loggingData:this.loggingData}):u.trigger("fastCompose:create",{type:e,loggingData:this.loggingData})},close:function(){var e=50,t=this.$(".tab-post-type"),i=Math.floor(.5*(t.length-1));l.all(s.map(t,function(t,s){var r=n(t),a=Math.floor(Math.abs(s-i))*e;return o.animate(r,{opacity:["0","1"],translateY:["-500px","0px"]},{duration:150,delay:a})},this)).then(function(){u.trigger("fastCompose:close:complete")})},teardown:function(){return this.resumeKeycommandsOnClose&&u.trigger("keycommands:resume"),this.remove()}});e.exports=h.bool("is_logged_in")?f:s.noop},,function(e,t,i){"use strict";var n=(i(167),i(3)),s=i(9),o=i(121),r=i(168),a=i(170),l=i(144),c=i(110),u=i(109),h=(i(103),i(7)),d=(i(171),i(172)),p=i(173),g=i(176),m="/dashboard",f=i(101),v=s("body"),_=i(177),b=i(143),w=i(111),y=i(179),k=i(282),x=i(530),C=i(531),S=i(533),E=i(538),T=l.extend({name:"PostFormBuilder",initialize:function(){var e=this.data;if(this.user=w(),this.user){var t={baseRoute:null,currentChannel:null,supportImageSearch:!1,minFullWidthSize:{},redirectTo:!1,reblogActionContext:!1,updateURL:!0};n.extend(this,t,n.pick(e,n.keys(t))),this._addGlobalEventListeners(),this.user.set(e.limits),this.user.set(e.dashboardSettings),this.user.set("language",e.language||"en_US"),k.setEmbedRegexes(e.embedRegexes),this.glass=new x,this.modal=new C,this.modalContainer=new S({className:"post-form-modal-content",animateHeightWithContent:!0}),this.modal.setContentSubView(this.modalContainer),this.postButtons=new E({el:"#new_post"}),this.postButtonsContainer=new S({el:this.postButtons.$el.parent(),originalContent:this.postButtons,transitionBackground:!0,animateHeightWithContent:!0,useLoader:!1}),this.scrollHelper=new d,this.saveHook=new p(n.extend({$postButtonsContainer:this.postButtonsContainer.$el},e)),this.legacyEvents(),this._updateData=n.once(this.updateData),this.render()}},updateData:function(){var e=s.ajax({url:"/svc/post/get_post_form_builder_data",type:"POST",with_form_key:!0,data:{}});return e.then(n.bind(function(e){var t=e.response;return n.forEach(t.channels,function(e){var t=e.name?this.user.getChannel(e.name):!1;t&&t.set(n.omit(e,"name"))},this),this.user.set(t.limits),t},this))},legacyEvents:function(){var e={"postForms:closed":["post:form:hide","keycommands:resume"],"postForms:saved":["post:form:success"],"postForms:opened":["post:form:show","keycommands:suspend"]};n.forEach(e,function(e,t){this.listenTo(c,t,function(){var t=n.toArray(arguments);n.each(e,function(e){c.trigger.apply(c,[].concat(e,t))},this)})},this)},_addGlobalEventListeners:function(){this.listenTo(c,"postForms:open",this.createPostForm),this.listenTo(c,"postForms:new",this._createPostFormNew),this.listenTo(c,"postForms:edit",this._createPostFormEdit),this.listenTo(c,"postForms:reblog",this._createPostFormReblog),this.listenTo(c,"postForms:saved",this.destroyPostForm),this._registerDismissListener(),this.listenTo(c,"postForms:dismissListener:suspend",function(){this._toggleDismissListener(!1)}),this.listenTo(c,"postForms:dismissListener:resume",function(){this._toggleDismissListener(!0)})},_toggleDismissListener:function(e){this.stopListening(c,"postForms:close"),e&&this._registerDismissListener()},_registerDismissListener:function(){this.listenTo(c,"postForms:close",this.dismissPostForm)},createInlineContainer:function(e){return e?new S({el:e.parent(),originalContent:e,transitionBackground:!0}):!1},_createPostFormNew:function(e){return this.createPostForm(e)},_createPostFormEdit:function(e){return e.postEl&&(e.containerView=this.createInlineContainer(e.postEl),e.postFormType=g.inline),this.createPostForm(e)},_createPostFormReblog:function(e){return this.createPostForm(e)},createPostForm:function(e){if(this.postForm)return this.destroyPostForm(e).then(n.bind(function(){return this.createPostForm(e)},this));e=n.extend({fastCompose:!1,supportImageSearch:this.supportImageSearch,minFullWidthSize:this.minFullWidthSize,updateURL:this.updateURL,glass:!0,postFormType:g.modal},e),n.defaults(e,{containerView:e.postFormType===g.inline?this.postButtonsContainer:null}),e.post||(e.post=this._createPostModel(e)),e.url||(e.url=this._postFormUrl(e.post)),e.containerView===this.postButtonsContainer&&this.postButtons.setPostType(e.post.get("type")),this._updateData();var t=e.postFormType===g.modal,i=["supportImageSearch","minFullWidthSize","post"];"photo"===e.post.get("type")&&i.push("showPhotoBooth");var a=this.postForm=new _(n.extend(n.pick(e,i),{isModal:t,popoverContainer:t?this.modal.$el:v,redirectTo:this.redirectTo,reblogActionContext:this.reblogActionContext,fastCompose:e.fastCompose})),l=this.postFormContainer=e.containerView||this.modalContainer;if(!l)throw new Error("No post form container!");this.listenTo(a,"pauseScrollHelper",this.pauseScrollHelper),this.listenTo(a,"resumeScrollHelper",this.resumeScrollHelper),l.isRendered()||l.render(),l.setPostFormComponent(a);var d=n.once(n.bind(function(){return e.glass?this.glass.show():o.resolve()},this)),p=r([function(){return c.trigger("Header:hide"),o.join(l.prepare(d),a.whenRendered(!0))},function(){return a.disable(),l.attach(d)},function(){return e.updateURL&&h.history.navigate(e.url,{replace:!0}),function(){var e=u.rect(),i=e.windowScrollTop,o=e.windowHeight,r=a.getRect(),h=r.offsetHeight,d=l.$el.offset().top,p=d+h,g=20,m=s("[prima-component=header]").height()||0,f=o>h+2*g,v=this.scrollHelper.calculateScrollTop(d-g,p+g+m,o,f),_=400,b=t?this.modal.$el:null;l===this.postButtonsContainer&&v>i&&o>h&&(v=i),this.previousScrollPosition=t?!1:i,this.scrollHelper.scrollToPosition(v,_,b),this.listenTo(c,"Photoset:dragScroll",function(e,t){n.isNumber(t)||(t=50);var i=u.rect().windowScrollTop+e;this.scrollHelper.scrollToPosition(i,t,b)}),this.listenTo(c,"Photoset:scrollToRow",function(e,t,i){n.isNumber(i)||(i=50),e+=0,this.scrollHelper.checkScrollBounds(!1,{keepInside:!0,contentPadding:70,contentRect:{offsetTop:e,offsetHeight:t}})})}.call(this),l.showPostForm(d)},function(){return d()},function(){a.enable()}],this).then(n.bind(function(){return c.trigger("postForms:opened"),v.addClass("postforms-open"),a},this),n.bind(function(){this.destroyPostForm()},this));return e.postFormType===g.inline&&p.then(n.bind(function(){this.scrollHelper.start({el:l.$el})},this)),p["catch"](function(e){e instanceof Error&&n.defer(function(){throw e})}),p},_postFormStateChanged:function(e){if(this.postForm){var t=this.postForm.initialPostState,i=this.postForm.post;return i.deepHasChanged(t)}return!1},dismissPostForm:function(){this.postForm&&!this.postForm.isEnabled()||(this._postFormStateChanged()?this._buildDismissPrompt():this.destroyPostForm())},_buildDismissPrompt:function(){var e=f("Discard this post?");this.postForm&&this.postForm.post&&"edit"===this.postForm.post.get("mode")&&(e=f("Discard edits to this post?"));var t={text:e,text_ok:f("Discard"),text_cancel:f("Nevermind"),keycommand_maintain:!0};b.confirm(t,n.bind(function(){this.destroyPostForm(),c.trigger("postForms:dismissListener:resume")},this),function(){n.defer(function(){c.trigger("postForms:dismissListener:resume")})}),c.trigger("postForms:dismissListener:suspend")},destroyPostForm:function(e,t){e=n.extend({updateURL:this.updateURL,url:this.baseRoute,glass:!0},e),this.scrollHelper.stop();var i=this.postForm,s=this.postFormContainer,a=!!i.fastCompose;this.postForm=null,this.postFormContainer=null,this.stopListening(i),this.stopListening(c,"Photoset:dragScroll");var l=n.once(n.bind(function(){return e.glass?this.glass.hide():o.resolve()},this)),u=i&&!!i.postForm.get("saved"),d=r([function(){u&&this.saveHook.preExecute(t)},function(){i&&i.disable()},function(){return function(){if(this.previousScrollPosition!==!1){var e=this.previousScrollPosition,t=400;this.scrollHelper.scrollToPosition(e,t)}}.call(this),s?s.hidePostForm(l).then(function(){s.teardown()}):void 0},function(){if(i&&i.remove(),e.updateURL){var t=h.history.root||"",n=e.url?e.url.replace(new RegExp("^"+t),""):"";h.history.navigate(n,{replace:!0})}},function(){return l()},function(){u&&t&&(this.saveHook.$inlinePostEl=s.$el,this.saveHook.execute(t,{fastCompose:a}))}],this).then(function(){return c.trigger("postForms:closed"),c.trigger("Header:show"),v.removeClass("postforms-open"),i});return d["catch"](function(e){e instanceof Error&&n.defer(function(){throw e})}),d},pauseScrollHelper:function(){this.scrollHelper&&this.scrollHelper.pause()},resumeScrollHelper:function(){this.scrollHelper&&this.scrollHelper.resume()},_createPostModel:function(e){"string"==typeof e&&(e={postType:e});var t=n.extend({tumblelog:e.channelId||this.currentChannel,editorType:this.user.get("defaultEditorType"),contextData:{baseRoute:this.baseRoute}},n.pick(e,"tags","sourceUrl","loggingData"));return e.reblogId?n.defaults(t,{lookupData:{reblog_id:e.reblogId,reblog_key:e.reblogKey},mode:"reblog",pt:e.pt,reblogSource:e.reblogSource}):e.editId?n.defaults(t,{lookupData:{post_id:e.editId,channel_id:e.channelId||this.redirectChannel},mode:"edit"}):n.defaults(t,{type:e.postType||e.type||"text",mode:"new"}),new y(t)},_postFormUrl:function(e){if(e){if(e.has("lookupData")){var t=e.get("lookupData");return t.reblog_id?this._reblogPostUrl(t.reblog_id,t.reblog_key):t.post_id?this._editPostUrl(t.post_id):this._newPostUrl(e.get("type"))}return e.has("reblog_id")?this._reblogPostUrl(e.get("reblog_id"),e.get("reblog_key")):e.has("id")?this._editPostUrl(e.get("id")):this._newPostUrl(e.get("type"))}return this._newPostUrl("text")},_newPostUrl:function(e){var t=this.baseRoute!==m?this.baseRoute:"";return t+"/new/"+e},_editPostUrl:function(e){return"/edit/"+e},_reblogPostUrl:function(e,t){return"/reblog/"+e+"/"+t},render:function(){return this.glass.render().$el.appendTo("body"),this.modal.render().$el.appendTo("body"),this},updateBaseRoute:function(e){var t;e?this.baseRoute=e:(t=h&&h.history?h.history.location.pathname:m,this.baseRoute=t)}},{containerType:function(e){return g[e]}});a.applyTo(T.prototype),e.exports=T},function(e,t,i){"use strict";function n(e,t){t=t||"Exposer";var i=window;s.each(e,function(e,n){if(s.has(i,n))throw new Error('"'+n+'" already exists');o.log(t,"%s.%s",i,n),s.set(i,n,e)})}var s=i(3),o=i(103);e.exports=n},function(e,t,i){"use strict";var n=i(3),s=i(169),o=function(e,t){e=n.map(e,function(e){return n.bind(e,this)},t||this);var i=Array.prototype.slice.call(arguments,1);return i[0]=e,s.apply(null,i)};e.exports=o},function(e,t,i){var n;/** @license MIT License (c) copyright 2011-2013 original author or authors */
!function(s){n=function(e){var t=i(121),n=t.Promise.all,s=Array.prototype.slice;return function(e){function i(e){return o.push(e),o}var o=[];return n(s.call(arguments,1)).then(function(n){return t.reduce(e,function(e,s){return t(s.apply(void 0,n),i)},o)})}}.call(t,i,t,e),!(void 0!==n&&(e.exports=n))}(i(126))},function(e,t,i){"use strict";var n=i(3),s=i(121),o=i(116),r=new o({defaults:{whenEvent:function(e,t){return 1===arguments.length&&(t=e,e=this),s.promise(n.bind(function(i,n){this.listenToOnce(e,t,function(){i.call(null,arguments)})},this))}}});e.exports=r},function(e,t){"use strict";var i=1,n=function(e){return e*i};n.get=function(){return i},n.set=function(e){i=e},e.exports=n},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(165).animate,r=i(171),a=i(145),l=i(7),c=i(109),u=i(110),h=(i(103),s("html")),d=a.extend({defaults:{keepInside:!1,scrollSpeedMs:250,triggerPadding:-50,contentPadding:20,debounceMs:200},start:function(e){return this._running&&this.stop(),this._running=!0,e&&!n.isPlainObject(e)&&(e={el:e}),this.options=e=n.extend({},this.defaults,e),this.$el=s(e.el),this.updateContentRect(),this.listenTo(u,"DOMEventor:flatscroll",this.checkScrollBounds),this},stop:function(){return this._running=!1,this._scrollTop=!1,this.cancelEnforceScrollBounds(),this.stopListening(),this},pause:function(){this._running&&(this._ignoreScroll=!0)},resume:function(){this._running&&this._ignoreScroll&&(this._ignoreScroll=!1,this.checkScrollBounds())},updateContentRect:function(){this.contentRect||(this.contentRect={}),this.lastContentRect&&(this.lastContentRect.offsetTop=this.contentRect.offsetTop,this.lastContentRect.offsetLeft=this.contentRect.offsetLeft,this.lastContentRect.offsetHeight=this.contentRect.offsetHeight,this.lastContentRect.offsetWidth=this.contentRect.offsetWidth);var e=this.$el.offset();return this.contentRect.offsetTop=e.top,this.contentRect.offsetLeft=e.left,this.contentRect.offsetHeight=this.$el.outerHeight(),this.contentRect.offsetWidth=this.$el.outerWidth(),this.lastContentRect||(this.lastContentRect=n.clone(this.contentRect)),this.contentRect},calculateScrollTop:function(e,t,i,n){return n?e:t-i},checkScrollBounds:function(e,t){if(!this._ignoreScroll){t=t?n.extend({},this.defaults,this.options,t):this.options,e||(e=c.rect());var i,s,o=t.contentRect||this.updateContentRect(),r=t.triggerPadding||0,a=t.contentPadding||0,l=o.offsetHeight,u=o.offsetTop,h=u+l,d=e.windowHeight,p=Math.max(0,e.windowScrollTop),g=p+d;return t.keepInside?(i=p-u,s=h-g):(i=p-h,s=u-g),s>r?(this._scrollTop=this.calculateScrollTop(u-a,h+a,d,l+2*a>d),this.enforceScrollBounds(t),!0):i>r?(this._scrollTop=this.calculateScrollTop(u-a,h+a,d,t.bottom||d>l+2*a),this.enforceScrollBounds(t),!0):(this._scrollTop=!1,this.cancelEnforceScrollBounds(),!1)}},enforceScrollBounds:function(e){var t=null!=e.scrollTop?e.scrollTop:this._scrollTop,i=e.scrollSpeedMs,s=e.debounceMs,o=e.container;s?this._enforceTimeout||(this._enforceTimeout=n.delay(n.bind(function(){null==e.scrollTop&&(t=this._scrollTop),this.scrollTop!==!1&&this.scrollToPosition(t,i,o)},this),s)):this.scrollToPosition(t,i,o)},cancelEnforceScrollBounds:function(){this._enforceTimeout,clearTimeout(this._enforceTimeout),this._enforceTimeout=!1},scrollToPosition:function(e,t,i){this._ignoreScroll=!0,o(h,"stop"),o(h,"scroll",{offset:e,container:i,duration:r(t||this.defaults.scrollSpeedMs)}).then(n.bind(function(){this._ignoreScroll=!1},this))}});n.extend(d.prototype,l.Events),e.exports=d},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(174),r=i(110),a=i(175),l=i(111),c=function(){var e=".post_container",t=".post:not([data-is-pinned])",i=["dashboard","drafts","inbox"],c={preExecute:function(){return"queue"===this.contextData.contextPage?(s(window).off("beforeunload"),void window.location.replace(this.contextData.baseRoute)):void 0},execute:function(e,t){if(t=n.merge({fastCompose:!1},t||{}),this.saveResponse=e.responseJSON,-1!==i.indexOf(this.contextData.contextPage)){var r=!this.saveResponse.post.is_edit&&!this.saveResponse.post.is_reblog,a="post_dashboard_html"in this.saveResponse,c=!(!this.saveResponse.post||!this.saveResponse.post.is_edit)&&this.contextData.contextPage!==this.saveResponse.post_context_page&&this.$inlinePostEl.hasClass("post_container");if(r?this._fetchMorePosts():a&&(c?this._removeInline():this._updateInline()),this._displayNotification(this.saveResponse,t),this.saveResponse.context_tumblelog){var u=this.saveResponse.context_tumblelog.name_or_id,h=s('#dashboard_controls_open_blog[data-blog-name="'+u+'"]');n.forEach(this.saveResponse.context_tumblelog,function(e,t){if(t.match(/_count$/i)){var i=h.find('[data-blog-controls-count="'+t+'"]');i.toggleClass("count_0","0">=e),i.find(".count").text(o(e).format("0,0"))}},this);var d=l().getChannel(u),p=n.pick(this.saveResponse.context_tumblelog,d.keys());d.set(p)}}},_fetchMorePosts:function(){var e=this.contextData.baseRoute.replace(/^\/|\/$/g,""),t="drafts"===this.contextData.contextPage?"after":"before",i=this._findLatestPostId(),s=new a;s.fetch({pageRoot:e,direction:t,refPostID:i,success:n.bind(this._fetchSuccess,this),error:this._fetchFailure})},_fetchSuccess:function(i){var n=s(i.get("dashboardHTML")),o=this.contextData.$postButtonsContainer.nextAll(e).has(t).first();0===o.length?this.contextData.$postButtonsContainer.parent().append(n):n.insertBefore(o),s(".no_posts_found").remove(),r.trigger("posts:load")},_fetchFailure:function(){console.error("Failed loading dashboard HTML after successful post submission.")},_findLatestPostId:function(){var i=this.contextData.$postButtonsContainer.nextAll(e).find(t).first().data("post-id");return i},_updateInline:function(){var e=s(this.saveResponse.post_dashboard_html.trim());this.$inlinePostEl.replaceWith(e.eq(0)),r.trigger("posts:load")},_removeInline:function(){var e=this.contextData.baseRoute.split("/");e.splice(-1,1);var t=this.$inlinePostEl;return t.fadeOut(200,function(){t.remove()}),s("#posts .post").not(".new_post").length<=1?void(window.location=e.join("/")):void 0},_displayNotification:function(e,t){var i=this.contextData.baseRoute.split("/"),s=i[1]||"",o=e.message,a=n.parseInt(this.contextData.notificationDelay),l={type:"dashboard"===e.post_context_page?"dashReblog":e.post_context_page,url:e.post_tumblelog.post_url,tumblelog:{name:e.post_tumblelog.name_or_id,url:e.post_tumblelog.url,avatar:e.post_tumblelog.avatar}};(!e.created_post||e.post.is_reblog||t&&t.fastCompose||"tagged"===s.toLowerCase())&&n.delay(function(){r.trigger("postForms:saveHook:toast",o,l)},a)}},u=function(e){this.contextData=n.defaults(e||{},{notificationDelay:250}),n.extend(this,c)};return u}();e.exports=c},,function(e,t,i){"use strict";var n=i(3),s=i(6).sprintf,o=i(114),r=o.extend({endpoint:"/svc/post/%s/%s/%s",parse:function(e){return{dashboardHTML:e.trim()}},sync:function(e,t,i){if("read"!==e)throw new Error("The DashboardPostFetch model may only READ from server!");if(i=n.defaults(i||{},{pageRoot:!1,direction:!1,refPostID:!1}),!1===(i.pageRoot&&i.direction))throw new Error(s("These two fetch params must be passed: pageRoot [%s], direction [%s]",i.pageRoot,i.direction));return n.defaults(i,{dataType:"html",emulateHTTP:!0,url:s(this.endpoint,i.pageRoot,i.direction,i.refPostID)}),o.prototype.sync.call(this,e,t,i)}});e.exports=r},function(e,t){"use strict";var i={modal:1,inline:2};e.exports=i},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(121),r=i(170),a=i(110),l=i(168),c=i(144),u=(i(103),i(178)),h=i(179),d=i(111),p=i(201),g=i(203),m=i(529),f=new m("body"),v=i(143),_=c.extend({name:"PostForm",viewOptionKeys:["showPhotoBooth","supportImageSearch","minFullWidthSize","isModal","popoverContainer","dragEvents","redirectTo","reblogActionContext","closeLabel","disableNavigation","disablePhotoFromUrl"],initialize:function(e){e=n.extend({dragEvents:f,autoFetch:!0},e),this.user=e.user||d(),this.post=e.post||new h,this.uploads=new p,this._preloadAvatars(),this.postForm=new g(n.extend(n.pick(e,this.viewOptionKeys),{user:this.user,post:this.post,uploads:this.uploads,model:this.post})),this.fastCompose=!!e.fastCompose,e.autoFetch&&(this.postFetch=this.fetchPostData(this.post))},_preloadAvatars:function(e){e||(e=this.user.channels.pluck("avatar_url")),n.forEach(e,function(e){var t=new Image;t.src=u(e)(128)})},fetchPostData:function(e){if(this.postFetch)return this.postFetch;e||(e=this.post);var t=this.user;return o.promise(function(i,n){e.has("lookupData")?e.fetch(e.get("lookupData")).then(function(){e.unset("lookupData"),t&&"html"===t.get("defaultEditorType")&&"edit"===e.get("mode")&&"rich"===e.get("editorType")&&e.set("editorType","html"),i(e)},function(e){403===e.status?n("blocked"):n()}):i(e)})},addEventListeners:function(){this.listenTo(a,"DOMEventor:keydown:escape",function(){this.isEnabled()&&a.trigger("postForms:close")}),this.listenTo(this.postForm,"all",function(){this.trigger.apply(this,arguments)}),this.listenToOnce(this.postForm,"postForms:changePostType",this.reloadPostForm)},_logInteraction:function(e){var t={action:e,tumblelog:this.post.get("tumblelog"),mode:this.post.get("mode"),postType:this.post.get("type"),editorType:this.post.get("editorType")};a.trigger("postform-interaction:"+e,{loggingData:t})},enable:function(){this.postForm.set("enabled",!0)},disable:function(){this.postForm.set("enabled",!1)},isEnabled:function(){return this.postForm.get("enabled")||!1},getRect:function(){return this.postForm.getRect()},isRendered:function(){return this.postForm.isRendered()},whenRendered:function(e){return null==e&&(e=!this.isRendered()),o.promise(n.bind(function(t,i){e?(this.listenToOnce(this,"ready",function(){t(this)}),this.listenToOnce(this,"reject",function(){i()}),this.render()):t(this)},this))},_render:function(){this._logInteraction("open-postform");var e=this.whenEvent(this.postForm,"media:ready");return this.postForm.render(),this.initialPostState=this.postForm.post.toJSON(),this.postForm.set("initialPostState",this.initialPostState),this.addEventListeners(),this.postForm.get("useMediaReady")?e.then(n.bind(function(){this.trigger("ready")},this)):this.trigger("ready"),delete this.postFetch,this},_reject:function(e){"blocked"===e&&v.alert(s("This post cannot be reblogged.")),this.trigger("reject")},render:function(){return this.fetchPostData(this.post).then(n.bind(this._render,this),n.bind(this._reject,this))},teardown:function(){return this.stopListening(),this},remove:function(){this.stopListening(),this.postForm.remove()},reloadPostForm:function(e){e=e||{};var t=l([function(){return this.postForm.animateHide(200)},function(){this.postForm.teardown();var t={lookupData:this.post.getLookupData(),tumblelog:this.post.get("tumblelog"),mode:this.post.get("mode"),loggingData:this.post.loggingData};n.extend(t,e.postParams||{}),this.post=this.postForm.post=this.postForm.model=new h(t),this.render()},function(){n.isFunction(e.afterReload)&&e.afterReload.call(this,this.postForm)}],this);return t}});r.applyTo(_.prototype),e.exports=_},function(e,t,i){"use strict";var n=i(3),s=[16,24,30,40,48,64,96,128,512],o=n.last(s),r=128,a=function(e){return e>=o?o:n.find(s,function(t){return t>=e})},l=function(e,t){var i=function(t){return t=null==t?r:a(t),e.replace(/^(.*_)?(\d+)(\D.*)?$/,"$1"+t+"$3")};return i.toString=function(){return this()},null!=t?i(t):i};e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(114),o=i(167),r=i(180),a=i(181),l=i(183),c=i(190),u=i(191),h=i(194),d=i(195),p=i(196),g=i(199),m=i(200),f=i(182),v=i(192),_=i(193),b=s.extend({mixins:[r],typeDelegateMap:{text:a,photo:l,quote:c,link:u,chat:h,audio:d,video:p,note:g},_VALID_STATES:{published:"0",draft:"1",queued:"2",scheduled:"on.2","private":"private",unapproved:"0 3",transcoding:"4"},_FORMAT_CODE_TO_EDITOR_TYPE:{0:"rich",1:"html",2:"markdown"},_STATE_CODE_TO_TEXT:{0:"published","0 3":"published",1:"draft",2:"queued",3:"unapproved",4:"transcoding","on.2":"scheduled","private":"private"},defaults:{allow_photo_replies:Boolean(),postDate:String(),customUrl:String(),sourceUrl:String(),state:"published",editorType:"rich",tags:[],publish_on:String(),tumblelog:String(),uploading:!1,mode:"new",contentStats:{},loading:!1,hasLoadingInlineImages:!1,members_only:!1},shortUrlLength:29,typeAttributes:{},editorField:!1,resetPreserveFields:[],resetAttributes:[],allowAnswerFields:[],_syntheticAttributes:{pseudoState:function(){var e=this.get("state"),t=this.get("publish_on");return"published"===e&&1===parseInt(this.get("is_private"),10)&&(e="private"),"queued"===e?n.isEmpty(t)?"queued":"scheduled":e},formattedSourceUrl:function(){var e,t=this.get("sourceUrl");return n.isEmpty(t)?"":(e=v.addProtocolIfMissing(t,"http:"),_.isUrl(e)?e:t)}},initialize:function(e,t){n.has(e,"tags")||this.set("tags",[]),this._assignPostTypeFunctionality()},_assignPostTypeFunctionality:function(){var e=this.get("type"),t=n.bind(function(e){return e in this.typeDelegateMap?this.typeDelegateMap[e].prototype:!1},this);e?(this.delegateObject(t(e)),this.afterDelegate()):this.listenToOnce(this,"change:type",function(e,i){this.delegateObject(t(i)),this.afterDelegate()})},afterDelegate:function(){n.defaults(this.attributes,this.typeAttributes)},_normalizeType:function(e,t){var i={regular:"text",conversation:"chat"};return t===!1&&(i=n.invert(i)),e in i?i[e]:e},get:function(e){return(this._syntheticAttributes[e]||s.prototype.get).apply(this,arguments)},getHtmlStripped:function(e,t,i){return"undefined"!=typeof t||(t=!0),"undefined"!=typeof i||(i=" "),n.trim(f.stripHtml(this.get(e)||"",t,i))},fetch:function(e){var t={data:e};return s.prototype.fetch.call(this,t)},parse:function(e,t){if(t.parse===!1)return this.attributes;var i=e.post,s=t.data,o={},r=i.id?"edit":"reblog";o.type=this._normalizeType(i.type,!0),o.can_reblog_as=n.map(i.can_reblog_as,n.bind(function(e){return this._normalizeType(e,!0)},this)),this.set("type",o.type),n.forEach(this.genericFieldMap,function(e,t){o[e]=i[t]});var a=["one","two","three","state","publish_on","tags","type","can_reblog_as"];return n.extend(o,n.omit(i,a),{createdPost:!!e.created_post,postTumblelog:e.post_tumblelog||{},postContextPage:e.post_context_page}),"edit"===r?(o["post-id"]=i.id,o.tags=i.tags?i.tags.split(","):[],o.tumblelog=o.postTumblelog.name_or_id||!1):"reblog"===r&&n.extend(o,n.pick(s,["reblog_id","reblog_key"])),"state"in i&&(o.state=this._extractState(i)),i.from_app&&1===n.parseInt(i.format)||(o.editorType=this._FORMAT_CODE_TO_EDITOR_TYPE[n.parseInt(i.format||0)]),o.editorType||(o.editorType=this.get("editorType")||this._FORMAT_CODE_TO_EDITOR_TYPE[0]),n.has(i,"custom_tweet")&&(o.customTweet=i.custom_tweet),n.extend(o,{sourceUrl:o.source_url||"",htmlEdited:"rich"!==o.format&&!(this.editorField&&!i[this.editorField]),postDate:o.date||"",customUrl:o.slug||""},n.mapValues(n.pick(o,["allow_answers","allow_photo_replies","html_mode","members_only"]),m)),"edit"!==r||"queued"!==o.state||n.isEmpty(i.publish_on)||(o.state="scheduled",o.publish_on=i.publish_on),this.parseForType(o,i)},parseForType:function(e,t){return e},sync:function(e,t,i){var o={create:"/svc/post/update",read:"/svc/post/fetch",update:"/svc/post/update"};return n.defaults(i||(i={}),{emulateHTTP:!0,forServer:!0,url:o[e]}),i.parse="read"===e,s.prototype.sync.call(this,e,t,i)},toJSON:function(e){return e=n.defaults(e||{},{forServer:!1}),e.forServer?this.serializeForServer(e):s.prototype.toJSON.call(this,e)},serializeForServer:function(){var e=this,t=e.attributes,i={channel_id:t.tumblelog,post_id:t["post-id"],"post[date]":t.postDate,"post[one]":this.getAttributeFromGeneric("one"),"post[publish_on]":t.publish_on,"post[slug]":t.customUrl,"post[tags]":t.tags.join(),"post[two]":this.getAttributeFromGeneric("two"),"post[three]":this.getAttributeFromGeneric("three"),thumbnail:this.getAttributeFromGeneric("thumbnail"),editor_type:t.editorType,send_to_twitter:t.send_to_twitter,custom_tweet:t.customTweet,send_to_fbog:t.send_to_fbog,loggingData:t.loggingData,allow_photo_replies:t.allow_photo_replies,members_only:t.members_only,content_stats:t.contentStats};"edit"===t.mode&&(i.edit_post_id=t["post-id"]),i["post[source_url]"]=e.get("formattedSourceUrl"),i["post[state]"]=e._VALID_STATES[t.state],i["post[type]"]=this._normalizeType(t.type,!1);var s={reblog:t.is_reblog,reblog_key:t.reblog_key,reblog_post_id:t.reblog_id,pt:t.pt,remove_reblog_tree:t.remove_reblog_tree,reblog_source:t.reblogSource};n.extend(i,n.pick(s,function(e){return!n.isUndefined(e)})),t.allow_answers&&(i.allow_answers="on"),this.getAttributeFromGeneric("thumbnail")&&(i.thumbnail_pre_upload="1");var o=this.getContextPage();return n.extend(i,{context_id:t.tumblelog,context_page:o,"is_rich_text[one]":"0","is_rich_text[two]":"0","is_rich_text[three]":"0"}),this.editorField&&(i["is_rich_text["+this.editorField+"]"]="1"),t.reblogActionContext&&(i.reblog_source=t.reblogActionContext),t.shareData&&n.isObject(t.shareData)&&(t.shareData.canonicalUrl=i["post[source_url]"],i.share_data=t.shareData),i},validate:function(e,t){var i="errors"in t?t.errors:[];return e.state&&(n.has(this._VALID_STATES,e.state)||i.push('Invalid "state" value')),e.hasLoadingInlineImages&&i.push("There are still pending images."),n.each(this.defaults,function(t,n){typeof t!=typeof e[n]&&i.push('Invalid "'+n+'" type. Expected '+typeof t+", got "+typeof e[n]+".")}),i.length?i:void 0},_extractState:function(e){var t=this._STATE_CODE_TO_TEXT[e.state];return 1===parseInt(e.is_private,10)&&(t="private"),t},findBlogChannelByName:function(e){return this.attributes.tumblelog&&this.attributes.tumblelog.collection&&"findWhere"in this.attributes.tumblelog.collection?this.attributes.tumblelog.collection.findWhere({name_or_id:e}):void 0},getPreservedData:function(){return this.resetPreserveFields.some(n.bind(function(e){return this.get(e)&&this.get(e).length>0},this))},softReset:function(){n.forEach(this.resetAttributes,function(e){n.has(this.typeAttributes,e)?this.set(e,this.typeAttributes[e]):n.has(this.defaults,e)?this.set(e,this.defaults[e]):this.unset(e)},this)},getLookupData:function(){return"reblog"===this.get("mode")?{reblog_id:this.get("reblog_id"),reblog_key:this.get("reblog_key"),post_type:this.get("type")}:void 0},getContextPage:function(){var e=this.attributes,t="dashboard";return e.contextData&&"baseRoute"in e.contextData&&(t=e.contextData.baseRoute.split("/").pop()),t},getAttributeFromGeneric:function(e){return this.get(this.genericFieldMap[e])},getTweetText:function(){var e=this.get("customTweet");return n.isString(e)||(e=this.generateTweetText(140-this.shortUrlLength-1),e?e+=" [URL]":e="[URL]"),e},getTweetTextLength:function(e){n.isString(e)||(e=this.getTweetText()),e=n.trim(e).replace(/([^\s])\[URL\]/gi,"$1 [URL]").replace(/\[URL\]([^\s])/gi,"[URL] $1");var t=e.length;return t+=(this.shortUrlLength-5)*(e.match(/\[URL\]/gi)||"").length},generateTweetText:function(e){return""},canEditMedia:function(){return!this.get("is_reblog")},isReblog:function(){return!!this.get("is_reblog")},allowsTypeSwitch:function(e){return!1},canPreview:function(){return this.isValid()},deepHasChanged:function(e){var t=this.toJSON(),i=this.get("mode"),s=n.keys(e),o=n.keys(t);if(n.isEqual(e,t))return!1;if("new"!==i)return!0;var r=n.difference(o,s),a=n.reduce(r,function(e,i){var s=t[i],o=n.isUndefined(s)||n.isNull(s)?0:s.length;return e+o},0);return a>0?!0:(e=n.omit(e,r),t=n.omit(t,r),!n.isEqual(e,t))}});o({"Tumblr.Prima.PostForms.Post":b}),e.exports=b},function(e,t,i){"use strict";var n=i(3),s=i(116),o=new s({delegateObject:function(e){var t={},i={};e&&(n.each(e,function(e,n){"undefined"!=typeof e&&("function"==typeof e?t[n]=e:i[n]=e)},this),s.onto(this,t),n.extend(this,i))}});e.exports=o},function(e,t,i){"use strict";function n(){}var s=i(3),o=i(6).sprintf,r=i(182).truncateLongStrings;n.prototype.genericFieldMap={one:"title",two:"body"},n.prototype.editorField="two",n.prototype.typeAttributes={title:"",body:""},n.prototype.allowAnswerFields=["title","body"],n.prototype.generateTweetText=function(e,t){var i=this.getHtmlStripped("title"),n=this.getHtmlStripped("body");n=n.replace(/[\r\n\s]*\[\[MORE\]\].*$/gi,"");var s;return s=i&&n?o("%s - %s",i,n):i||n||"",r(s,t)},n.prototype.validate=function(e,t,i){var n=[],o=!s.isUndefined(t.reblog_tree)&&t.reblog_tree!==!1&&""!==t.reblog_tree;return(!t.body||t.body.length<1)&&(!t.title||t.title.length<1)&&(o||n.push("Post body empty.")),e.call(this,t,{errors:n})},e.exports=n},function(e,t,i){"use strict";var n=i(3),s={normalizeSpace:function(e){return e.trim().replace(""," ").replace(/\s\s+/," ")},stripScripts:function(e){return e.replace(new RegExp("<script[^>]*>([\\S\\s]*?)</script\\s*>","img"),"")},stripTags:function(e){return e.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")},truncateLongStrings:function(e,t,i){return n.isString(e)||(e=""),i||(i=""),e.length<=t?e:n.trunc(e,t-i.length,i)},stripHtml:function(e,t,i){if(!e)return"";"undefined"==typeof t&&(t=!0);var s=e;"string"==typeof i&&(s=n.trim(s.replace(/(<br\s*\/?>)/gi,"$1"+i).replace(/(<\/(?:p|figure|h[1-6])\s*>)/gi,"$1"+i)));try{var o=document.implementation.createHTMLDocument("");o.body.innerHTML=this.stripScripts(s),s=o.body.textContent||o.body.innerText||"",s=s.trim()}catch(r){s=this.stripScripts(this.stripTags(s)).trim()}return t&&(s=this.normalizeSpace(s)),s}};e.exports=s},function(e,t,i){"use strict";function n(){}var s=i(3),o=i(184),r=i(182).truncateLongStrings;n.prototype.genericFieldMap={two:"caption",three:"linkthrough"},n.prototype.editorField="two",n.prototype.typeAttributes={caption:"",layout:"",linkthrough:"",photos:[]},n.prototype.allowAnswerFields=["caption"],n.prototype.generateTweetText=function(e,t){var i=this.getHtmlStripped("caption");return i=i.replace(/[\r\n\s]*\[\[MORE\]\].*$/gi,""),r(i,t)},n.prototype.MAX_IMAGES=10,n.prototype.resetPreserveFields=["caption","tags"],n.prototype.afterDelegate=function(e){e.apply(this,s.rest(arguments)),this.photos=new o(this.attributes.photos,{parse:!0}),this.on("change:photos",function(e,t){this.photos.reset(t,{parse:!0}),delete this.attributes.photos},this),this.trigger("change:photos",this,this.get("photos")),this.listenTo(this.photos,"add remove change:preuploadUrl change:externalUrl",function(){this.trigger("validate")})},n.prototype.parseForType=function(e,t,i){return t.layout=i.photoset_layout,delete t.photoset_layout,t},n.prototype.serializeForServer=function(e){var t=this,i=e.apply(this,s.rest(arguments));return s.forEach(this.photos.toJSON(),function(e){i["images["+e.id+"]"]=e.uploadUrl,i["caption["+e.id+"]"]=(e.caption||"").substr(0,200),e.photoRaw&&(i.photo_raw=e.photoRaw,i.is_selfie_gif=e.isSelfieGif,i.is_selfie=e.isSelfie)}),i["post[photoset_layout]"]=t.get("layout"),i["post[photoset_order]"]=this.photos.pluck("id").join(","),i},n.prototype.canAddPhotos=function(e){return this.photos.length<this.MAX_IMAGES},n.prototype.validate=function(e,t,i){var n=[];0===this.photos.length&&n.push("No photos specified.");var s=this.photos.all(function(e){return e.getUploadUrl()||!e.has("upload")});return s||n.push("Uploads in progress."),e.call(this,t,{errors:n})},e.exports=n},function(e,t,i){"use strict";var n=i(3),s=i(119),o=i(185),r=s.extend({model:o,add:function(e,t){return e&&!n.isArray(e)&&(e=[e]),n.forEach(e,function(e,t){e.id||(n.isFunction(e.set)?e.set("id",this.generateId(t)):e.id=this.generateId(t))},this),s.prototype.add.apply(this,arguments)},generateId:function(e){var t=1+(e||0),i=n.map(n.range(this.length+1),function(e){return"o"+(t+e)});return n.find(i,function(e){return!this.get(e)},this)},setIdOrder:function(e,t){t||(t={}),this.models=n.map(e,function(e){return this.get(e)},this),t.silent||this.trigger("sort",this,t)}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(114),r=i(186),a=i(187),l=i(189),c=1080,u=o.extend({defaults:{url:"",preuploadUrl:"",externalUrl:"",file:null,photoRaw:null,base64:null,isSelfie:!1,isSelfieGif:!1,width:null,height:null,caption:"",id:""},initialize:function(){this.on("change:externalUrl",function(e,t){t&&this.readUrl(t),this.set({preuploadUrl:null,base64:null})},this),this.get("externalUrl")&&!this.get("base64")&&this.trigger("change:file",this,this.get("file")),this.on("change:file",function(e,t){t&&this.readFile(t),this.set({externalUrl:null,base64:null})},this),this.get("file")&&!this.get("base64")&&this.trigger("change:file",this,this.get("file"))},readUrl:function(e,t){t||(t="photo:readUrl"),r.load(e).then(n.bind(function(e){this.set({url:e.src,width:e.width,height:e.height}),this.trigger(t,!0,this)},this),n.bind(function(i){this.set({url:e,width:null,height:null}),this.trigger(t,!1,this)},this))},readFile:function(e){return a.canReadFiles()?void a.read(e).then(n.bind(function(e){if(!e.file.type.match(/image\/(jpg|jpeg|png)/i))return this.readUrl(e.objectUrl||e.base64,"photo:readFile");var t=s("<img/>");t.attr("src",e.objectUrl||e.base64),r.load(e.objectUrl||e.base64).then(n.bind(function(i){var n=l.drawScaledAndRotated(t,i.width,i.height,e.rotation,e.mirrored,c);return this.readUrl(n.toDataURL(e.file.type),"photo:readFile")},this))},this),n.bind(function(){this.trigger("photo:readFile",!1,this)},this)):void this.trigger("photo:readFile",!1,this)},getDisplayUrl:function(){return this.get("preuploadUrl")?this.get("preuploadUrl"):this.get("externalUrl")?this.get("externalUrl"):this.get("base64")?this.get("base64"):this.get("url")},getUploadUrl:function(){return this.get("preuploadUrl")?this.get("preuploadUrl"):this.get("externalUrl")?this.get("externalUrl"):""},toJSON:function(){var e=o.prototype.toJSON.apply(this,arguments);return e.displayUrl=this.getDisplayUrl(),e.uploadUrl=this.getUploadUrl(),e}});e.exports=u},function(e,t,i){"use strict";var n=i(3),s=i(121),o=i(145),r=o.extend({constructor:function(e){null!=e&&this.load(e)},load:function(e,t){if(this.src=e,!e)return s.reject("No URL to load");var i=this,o=s.promise(function(s,o){var r=new Image;r.src=e,i._img=r;var a;if(r.onload=function(){s(r),r.onload=null,r.error=null,clearInterval(a)},r.onerror=function(){o(r),r.onload=null,r.error=null,clearInterval(a)},r.complete)r.naturalWidth||r.naturalHeight?"function"==typeof r.onload&&r.onload():"function"==typeof r.onerror&&r.onerror();else if(t){var l=function(){return r.naturalWidth||r.naturalHeight?("function"==typeof r.onload&&r.onload(),!0):!1};l()||(n.isNumber(t)||(t=100),a=setInterval(l,t))}});return this.promise=o=o.then(n.bind(this._onLoad,this),n.bind(this._onError,this)),o},_onLoad:function(e){return this._img===e?(this.width=e.naturalWidth,this.height=e.naturalHeight,this.src=e.src,this.loaded=!0,s.resolve({width:this.width,height:this.height,src:this.src})):this.promise},_onError:function(e){return this._img===e?(this.width=null,this.height=null,this.src=e.src,this.loaded=!1,s.reject(this.src+" failed to load")):this.promise}},{load:function(e,t){var i=new r(e,t);return i.promise}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(121),o=i(145),r="FileReader"in window&&"readAsDataURL"in FileReader.prototype,a=(window.URL||window.webkitURL||window.mozURL||window.msURL||{}).createObjectURL,l=[],c=i(188).JpegFile,u=o.extend({constructor:function(e){null!=e&&this.read(e)},read:function(e,t){if(!n.isUndefined(t)||(t=!0),this.file=e,!e)return s.reject("No file to read");if(!r)return s.reject("FileReader is not supported");e.type.match(/image\/(jpg|jpeg)/i)||(t=!1);var i;return i=t&&"readAsBinaryString"in FileReader.prototype?this.readBinaryString(e).then(n.bind(function(t){try{var i=new c(t.binary,e.name);t.rotation=function(e){switch(e){case 1:return 0;case 2:return 0;case 3:return 180;case 4:return 180;case 5:return 270;case 6:return 90;case 7:return 90;case 8:return 270;default:return 0}}(i.tiff.Orientation.value),t.mirrored=function(e){switch(e){case 2:return!0;case 4:return!0;case 5:return!0;case 7:return!0;default:return!1}}(i.tiff.Orientation.value)}catch(s){}return this.readDataUrl(e).then(n.bind(function(e){return n.extend(t,e)},this))},this)):this.readDataUrl(e),this.promise=i,i},readDataUrl:function(e){var t=new FileReader;return"readAsDataURL"in t?s.promise(function(i,n){t.onload=function(e){var n=e.target.result;i(n),t.onload=null,t.onerror=null},t.onerror=function(){n(),t.onload=null,t.onerror=null},t.readAsDataURL(e)}).then(n.bind(this._onLoadDataUrl,this),n.bind(this._onError,this)):s.reject("FileReader.readAsDataURL is not supported")},_onLoadDataUrl:function(e){var t={base64:e,file:this.file};return a&&(t.objectUrl=a(this.file),l.push(t.objectUrl)),s.resolve(t)},readBinaryString:function(e){var t=new FileReader;return"readAsBinaryString"in t?s.promise(function(i,n){t.onload=function(e){var n=e.target.result;i(n),t.onload=null,t.onerror=null},t.onerror=function(){n(),t.onload=null,t.onerror=null},t.readAsBinaryString(e)}).then(n.bind(this._onLoadBinaryString,this),n.bind(this._onError,this)):s.reject("FileReader.readAsBinaryString is not supported")},_onLoadBinaryString:function(e){return s.resolve({binary:e,file:this.file})},_onError:function(e){return s.reject("Failed to read file")}},{read:function(e,t){var i=new u(e,t);return i.promise},canReadFiles:function(){return r}});e.exports=u},function(e,t,i){"use strict";var n=function(){},s=e.exports={};s.stringIsClean=function(e){for(var t=0;t<e.length;t++)if(e.charCodeAt(t)<32)return!1;return!0},s.parseNum=function(e,t,i,n){var s,o,r=">"===e;for(void 0===i&&(i=0),void 0===n&&(n=t.length-i),s=r?i:i+n-1;r?i+n>s:s>=i;r?s++:s--)o<<=8,o+=t.charCodeAt(s);return o},s.parseSnum=function(e,t,i,n){var s,o,r,a=">"===e;for(void 0===i&&(i=0),void 0===n&&(n=t.length-i),s=a?i:i+n-1;a?i+n>s:s>=i;a?s++:s--)void 0===r&&(r=128===(128&t.charCodeAt(s))),o<<=8,o+=r?255&~t.charCodeAt(s):t.charCodeAt(s);return r&&(o+=1,o*=-1),o},s.Rational=function(e,t){return this.num=e,this.den=t||1,this},s.Rational.prototype.toString=function(){return 0===this.num?""+this.num:1===this.den?""+this.num:1===this.num?this.num+" / "+this.den:this.num/this.den},s.Rational.prototype.asFloat=function(){return this.num/this.den},s.MetaGroup=function(e,t){return this.fieldName=e,this.description=t,this.metaProps={},this},s.MetaGroup.prototype._addProperty=function(e,t,i){var n=new s.MetaProp(e,t,i);this[n.fieldName]=n,this.metaProps[n.fieldName]=n},s.MetaGroup.prototype.toString=function(){return"[MetaGroup "+this.description+"]"},s.MetaProp=function(e,t,i){return this.fieldName=e,this.description=t,this.value=i,this},s.MetaProp.prototype.toString=function(){return""+this.value},s.JpegFile=function(e,t){var i=this._SOS;this.metaGroups={},this._binary_data=e,this.filename=t;var n,o,r,a,l,c,u,h=0,d=0;if(this._binary_data.slice(0,2)!==this._SOI_MARKER)throw new Error("Doesn't look like a JPEG file. First two bytes are "+this._binary_data.charCodeAt(0)+","+this._binary_data.charCodeAt(1)+".");for(h+=2;h<this._binary_data.length&&(n=this._binary_data.charCodeAt(h++),o=this._binary_data.charCodeAt(h++),d=h,n==this._DELIM)&&o!==i;){for(l=s.parseNum(">",this._binary_data,h,2),h+=l;h<this._binary_data.length;)if(n=this._binary_data.charCodeAt(h++),n==this._DELIM&&(r=this._binary_data.charCodeAt(h++),0!==r)){h-=2;break}a=h-d,this._markers[o]?(c=this._markers[o][0],u=this._markers[o][1]):(c="UNKN",u=void 0),u&&this[u](o,d+2)}if(void 0===this.general)throw Error("Invalid JPEG file.");return this},s.JpegFile.prototype.toString=function(){return"[JpegFile "+this.filename+" "+this.general.type+" "+this.general.pixelWidth+"x"+this.general.pixelHeight+" Depth: "+this.general.depth+"]"},s.JpegFile.prototype._SOI_MARKER="",s.JpegFile.prototype._DELIM=255,s.JpegFile.prototype._EOI=217,s.JpegFile.prototype._SOS=218,s.JpegFile.prototype._sofHandler=function(e,t){if(void 0!==this.general)throw Error("Unexpected multiple-frame image");this._addMetaGroup("general","General"),this.general._addProperty("depth","Depth",s.parseNum(">",this._binary_data,t,1)),this.general._addProperty("pixelHeight","Pixel Height",s.parseNum(">",this._binary_data,t+1,2)),this.general._addProperty("pixelWidth","Pixel Width",s.parseNum(">",this._binary_data,t+3,2)),this.general._addProperty("type","Type",this._markers[e][2])},s.JpegFile.prototype._JFIF_IDENT="JFIF\x00",
s.JpegFile.prototype._JFXX_IDENT="JFXX\x00",s.JpegFile.prototype._EXIF_IDENT="Exif\x00",s.JpegFile.prototype._types={1:["BYTE",1],2:["ASCII",1],3:["SHORT",2],4:["LONG",4],5:["RATIONAL",8],6:["SBYTE",1],7:["UNDEFINED",1],8:["SSHORT",2],9:["SLONG",4],10:["SRATIONAL",8],11:["FLOAT",4],12:["DOUBLE",8]},s.JpegFile.prototype._tifftags={256:["Image width","ImageWidth"],257:["Image height","ImageLength"],258:["Number of bits per component","BitsPerSample"],259:["Compression scheme","Compression",{1:"uncompressed",6:"JPEG compression"}],262:["Pixel composition","PhotmetricInerpretation",{2:"RGB",6:"YCbCr"}],274:["Orientation of image","Orientation",{1:"Normal",2:"Reverse?",3:"Upside-down",4:"Upside-down Reverse",5:"90 degree CW",6:"90 degree CW reverse",7:"90 degree CCW",8:"90 degree CCW reverse"}],277:["Number of components","SamplesPerPixel"],284:["Image data arrangement","PlanarConfiguration",{1:"chunky format",2:"planar format"}],530:["Subsampling ratio of Y to C","YCbCrSubSampling"],531:["Y and C positioning","YCbCrPositioning",{1:"centered",2:"co-sited"}],282:["X Resolution","XResolution"],283:["Y Resolution","YResolution"],296:["Resolution Unit","ResolutionUnit",{2:"inches",3:"centimeters"}],273:["Image data location","StripOffsets"],278:["Number of rows per strip","RowsPerStrip"],279:["Bytes per compressed strip","StripByteCounts"],513:["Offset to JPEG SOI","JPEGInterchangeFormat"],514:["Bytes of JPEG Data","JPEGInterchangeFormatLength"],301:["Transfer function","TransferFunction"],318:["White point chromaticity","WhitePoint"],319:["Chromaticities of primaries","PrimaryChromaticities"],529:["Color space transformation matrix coefficients","YCbCrCoefficients"],532:["Pair of black and white reference values","ReferenceBlackWhite"],306:["Date and time","DateTime"],270:["Image title","ImageDescription"],271:["Make","Make"],272:["Model","Model"],305:["Software","Software"],315:["Person who created the image","Artist"],316:["Host Computer","HostComputer"],33432:["Copyright holder","Copyright"],34665:["Exif tag","ExifIfdPointer"],34853:["GPS tag","GPSInfoIfdPointer"]},s.JpegFile.prototype._exiftags={36864:["Exif Version","ExifVersion"],40960:["FlashPix Version","FlashpixVersion"],40961:["Color Space","ColorSpace"],37121:["Meaning of each component","ComponentsConfiguration"],37122:["Compressed Bits Per Pixel","CompressedBitsPerPixel"],40962:["Pixel X Dimension","PixelXDimension"],40963:["Pixel Y Dimension","PixelYDimension"],37500:["Manufacturer notes","MakerNote"],37510:["User comments","UserComment"],40964:["Related audio file","RelatedSoundFile"],36867:["Date Time Original","DateTimeOriginal"],36868:["Date Time Digitized","DateTimeDigitized"],37520:["DateTime subseconds","SubSecTime"],37521:["DateTimeOriginal subseconds","SubSecTimeOriginal"],37522:["DateTimeDigitized subseconds","SubSecTimeDigitized"],33434:["Exposure time","ExposureTime"],33437:["FNumber","FNumber"],34850:["Exposure program","ExposureProgram"],34852:["Spectral sensitivity","SpectralSensitivity"],34855:["ISO Speed Ratings","ISOSpeedRatings"],34856:["Optoelectric coefficient","OECF"],37377:["Shutter Speed","ShutterSpeedValue"],37378:["Aperture Value","ApertureValue"],37379:["Brightness","BrightnessValue"],37380:["Exposure Bias Value","ExposureBiasValue"],37381:["Max Aperture Value","MaxApertureValue"],37382:["Subject Distance","SubjectDistance"],37383:["Metering Mode","MeteringMode"],37384:["Light Source","LightSource"],37385:["Flash","Flash"],37386:["Focal Length","FocalLength"],37396:["Subject Area","SubjectArea"],41483:["Flash Energy","FlashEnergy"],41484:["Spatial Frequency Response","SpatialFrequencyResponse"],41486:["Focal Plane X Resolution","FocalPlaneXResolution"],41487:["Focal Plane Y Resolution","FocalPlaneYResolution"],41488:["Focal Plane Resolution Unit","FocalPlaneResolutionUnit"],41492:["Subject Location","SubjectLocation"],41493:["Exposure Index","ExposureIndex"],41495:["Sensing Method","SensingMethod"],41728:["File Source","FileSource"],41729:["Scene Type","SceneType"],41730:["CFA Pattern","CFAPattern"],41985:["Custom Rendered","CustomRendered"],41986:["Exposure Mode","Exposure Mode"],41987:["White Balance","WhiteBalance"],41988:["Digital Zoom Ratio","DigitalZoomRatio"],41989:["Focal length in 35 mm film","FocalLengthIn35mmFilm"],41990:["Scene Capture Type","SceneCaptureType"],41991:["Gain Control","GainControl"],41992:["Contrast","Contrast"],41993:["Saturation","Saturation"],41994:["Sharpness","Sharpness"],41995:["Device settings description","DeviceSettingDescription"],41996:["Subject distance range","SubjectDistanceRange"],42016:["Unique image ID","ImageUniqueID"],40965:["Interoperability tag","InteroperabilityIFDPointer"]},s.JpegFile.prototype._gpstags={0:["GPS tag version","GPSVersionID"],1:["North or South Latitude","GPSLatitudeRef"],2:["Latitude","GPSLatitude"],3:["East or West Longitude","GPSLongitudeRef"],4:["Longitude","GPSLongitude"],5:["Altitude reference","GPSAltitudeRef"],6:["Altitude","GPSAltitude"],7:["GPS time (atomic clock)","GPSTimeStamp"],8:["GPS satellites usedd for measurement","GPSSatellites"],9:["GPS receiver status","GPSStatus"],10:["GPS mesaurement mode","GPSMeasureMode"],11:["Measurement precision","GPSDOP"],12:["Speed unit","GPSSpeedRef"],13:["Speed of GPS receiver","GPSSpeed"],14:["Reference for direction of movement","GPSTrackRef"],15:["Direction of movement","GPSTrack"],16:["Reference for direction of image","GPSImgDirectionRef"],17:["Direction of image","GPSImgDirection"],18:["Geodetic survey data used","GPSMapDatum"],19:["Reference for latitude of destination","GPSDestLatitudeRef"],20:["Latitude of destination","GPSDestLatitude"],21:["Reference for longitude of destination","GPSDestLongitudeRef"],22:["Longitude of destination","GPSDestLongitude"],23:["Reference for bearing of destination","GPSDestBearingRef"],24:["Bearing of destination","GPSDestBearing"],25:["Reference for distance to destination","GPSDestDistanceRef"],26:["Distance to destination","GPSDestDistance"],27:["Name of GPS processing method","GPSProcessingMethod"],28:["Name of GPS area","GPSAreaInformation"],29:["GPS Date","GPSDateStamp"],30:["GPS differential correction","GPSDifferential"]},s.JpegFile.prototype._markers={192:["SOF0","_sofHandler","Baseline DCT"],193:["SOF1","_sofHandler","Extended sequential DCT"],194:["SOF2","_sofHandler","Progressive DCT"],195:["SOF3","_sofHandler","Lossless (sequential)"],197:["SOF5","_sofHandler","Differential sequential DCT"],198:["SOF6","_sofHandler","Differential progressive DCT"],199:["SOF7","_sofHandler","Differential lossless (sequential)"],200:["JPG",null,"Reserved for JPEG extensions"],201:["SOF9","_sofHandler","Extended sequential DCT"],202:["SOF10","_sofHandler","Progressive DCT"],203:["SOF11","_sofHandler","Lossless (sequential)"],205:["SOF13","_sofHandler","Differential sequential DCT"],206:["SOF14","_sofHandler","Differential progressive DCT"],207:["SOF15","_sofHandler","Differential lossless (sequential)"],196:["DHT",null,"Define Huffman table(s)"],204:["DAC",null,"Define arithmetic coding conditioning(s)"],208:["RST0",null,"Restart with modulo 8 count 0"],209:["RST1",null,"Restart with modulo 8 count 1"],210:["RST2",null,"Restart with modulo 8 count 2"],211:["RST3",null,"Restart with modulo 8 count 3"],212:["RST4",null,"Restart with modulo 8 count 4"],213:["RST5",null,"Restart with modulo 8 count 5"],214:["RST6",null,"Restart with modulo 8 count 6"],215:["RST7",null,"Restart with modulo 8 count 7"],216:["SOI",null,"Start of image"],217:["EOI",null,"End of image"],218:["SOS",null,"Start of scan"],219:["DQT",null,"Define quantization table(s)"],220:["DNL",null,"Define number of lines"],221:["DRI",null,"Define restart interval"],222:["DHP",null,"Define hierarchical progression"],223:["EXP",null,"Expand reference component(s)"],224:["APP0","_app0Handler","Reserved for application segments"],225:["APP1","_app1Handler"],226:["APP2",null],227:["APP3",null],228:["APP4",null],229:["APP5",null],230:["APP6",null],231:["APP7",null],232:["APP8",null],233:["APP9",null],234:["APP10",null],235:["APP11",null],236:["APP12",null],237:["APP13",null],238:["APP14",null],239:["APP15",null],240:["JPG0",null],241:["JPG1",null],242:["JPG2",null],243:["JPG3",null],244:["JPG4",null],245:["JPG5",null],246:["JPG6",null],247:["JPG7",null],248:["JPG8",null],249:["JPG9",null],250:["JPG10",null],251:["JPG11",null],252:["JPG12",null],253:["JPG13",null],254:["COM",null],1:["JPG13",null]},s.JpegFile.prototype._addMetaGroup=function(e,t){var i=new s.MetaGroup(e,t);return this[i.fieldName]=i,this.metaGroups[i.fieldName]=i,i},s.JpegFile.prototype._parseIfd=function(e,t,i,o,r,a,l){var c,u,h,d,p,g,m,f,v,_,b,w=s.parseNum(e,t,i+o,2);b=this._addMetaGroup(a,l);for(var y=0;w>y;y++)if(c=i+o+2+12*y,u=s.parseNum(e,t,c,2),d=s.parseNum(e,t,c+2,2),g=s.parseNum(e,t,c+4,4),m=s.parseNum(e,t,c+8,4),void 0!==this._types[d]){if(h=this._types[d][0],p=this._types[d][1],m=4>=p*g?c+8:i+m,"UNDEFINED"==h)f=void 0;else if("ASCII"==h)f=t.slice(m,m+g),f=f.split("\x00")[0],s.stringIsClean(f)||(f="");else{f=[];for(var k=0;g>k;k++,m+=p)"BYTE"!=h&&"SHORT"!=h&&"LONG"!=h||f.push(s.parseNum(e,t,m,p)),"SBYTE"!=h&&"SSHORT"!=h&&"SLONG"!=h||f.push(s.parseSnum(e,t,m,p)),"RATIONAL"==h&&(v=s.parseNum(e,t,m,4),_=s.parseNum(e,t,m+4,4),f.push(new s.Rational(v,_))),"SRATIONAL"==h&&(v=s.parseSnum(e,t,m,4),_=s.parseSnum(e,t,m+4,4),f.push(new s.Rational(v,_))),f.push();1===g&&(f=f[0])}r.hasOwnProperty(u)?b._addProperty(r[u][1],r[u][0],f):n("WARNING(jpegmeta.js): Unknown tag: ",u)}},s.JpegFile.prototype._jfifHandler=function(e,t){if(void 0!==this.jfif)throw Error("Multiple JFIF segments found");this._addMetaGroup("jfif","JFIF"),this.jfif._addProperty("version_major","Version Major",this._binary_data.charCodeAt(t+5)),this.jfif._addProperty("version_minor","Version Minor",this._binary_data.charCodeAt(t+6)),this.jfif._addProperty("version","JFIF Version",this.jfif.version_major.value+"."+this.jfif.version_minor.value),this.jfif._addProperty("units","Density Unit",this._binary_data.charCodeAt(t+7)),this.jfif._addProperty("Xdensity","X density",s.parseNum(">",this._binary_data,t+8,2)),this.jfif._addProperty("Ydensity","Y Density",s.parseNum(">",this._binary_data,t+10,2)),this.jfif._addProperty("Xthumbnail","X Thumbnail",s.parseNum(">",this._binary_data,t+12,1)),this.jfif._addProperty("Ythumbnail","Y Thumbnail",s.parseNum(">",this._binary_data,t+13,1))},s.JpegFile.prototype._app0Handler=function(e,t){var i=this._binary_data.slice(t,t+5);i==this._JFIF_IDENT?this._jfifHandler(e,t):i==this._JFXX_IDENT},s.JpegFile.prototype._app1Handler=function(e,t){var i=this._binary_data.slice(t,t+5);i==this._EXIF_IDENT&&this._exifHandler(e,t+6)},s.JpegFile.prototype._exifHandler=function(e,t){if(void 0!==this.exif)throw new Error("Multiple JFIF segments found");var i,n,o,r=this._binary_data.slice(t,t+2);if("II"===r)i="<";else{if("MM"!==r)throw new Error("Malformed TIFF meta-data. Unknown endianess: "+r);i=">"}if(n=s.parseNum(i,this._binary_data,t+2,2),42!==n)throw new Error("Malformed TIFF meta-data. Bad magic: "+n);if(o=s.parseNum(i,this._binary_data,t+4,4),this._parseIfd(i,this._binary_data,t,o,this._tifftags,"tiff","TIFF"),this.tiff.ExifIfdPointer&&this._parseIfd(i,this._binary_data,t,this.tiff.ExifIfdPointer.value,this._exiftags,"exif","Exif"),this.tiff.GPSInfoIfdPointer){if(this._parseIfd(i,this._binary_data,t,this.tiff.GPSInfoIfdPointer.value,this._gpstags,"gps","GPS"),this.gps.GPSLatitude){var a;a=this.gps.GPSLatitude.value[0].asFloat()+1/60*this.gps.GPSLatitude.value[1].asFloat()+1/3600*this.gps.GPSLatitude.value[2].asFloat(),"S"===this.gps.GPSLatitudeRef.value&&(a=-a),this.gps._addProperty("latitude","Dec. Latitude",a)}if(this.gps.GPSLongitude){var l;l=this.gps.GPSLongitude.value[0].asFloat()+1/60*this.gps.GPSLongitude.value[1].asFloat()+1/3600*this.gps.GPSLongitude.value[2].asFloat(),"W"===this.gps.GPSLongitudeRef.value&&(l=-l),this.gps._addProperty("longitude","Dec. Longitude",l)}}}},function(e,t,i){"use strict";var n=i(9),s=function(e,t,i){if(0===i)return 0;var n=null==i?t:t/i;return 2===arguments.length?Math.round(e*n):void 0},o=function(e,t,i){if(0===i)return 0;var n=null==i?t:t/i;return Math.round(e/n)},r=function(e,t,i,n){var r=e,a=t,l=e/t,c=i/n;return(e>i||t>n)&&(l>c?(r=i,a=o(r,l)):(a=n,r=s(a,l))),{width:r,height:a}},a=function(e,t,i,n,r,a){null!=r||(r=.5),null!=a||(a=.5);var l=0,c=0,u=e,h=t,d=e/t,p=i/n;return d>p?(u=s(t,p),l=Math.round(r*(e-u))):p>d&&(h=o(e,p),l=Math.round(a*(t-h))),{left:l,top:c,width:u,height:h}},l=function(e){var t;e instanceof n?(t=e,e=t.get(0)):t=n(e);var i=document.createElement("canvas");return i.width=e.width||t.width(),i.height=e.height||t.height(),i},c=function(e,t,i){var s;e instanceof n?(s=e,e=s.get(0)):s=n(e),t?t instanceof n&&(t=t.get(0)):t=l(e);var o=t.width,r=t.height,a=t.getContext("2d");return a.save(),i&&(a.translate(t.width,0),a.scale(-1,1)),a.drawImage(e,0,0,o,r),a.restore(),t},u=function(e,t,i,s,r,a){var l;e instanceof n?(l=e,e=l.get(0)):l=n(e);var c=90===s||270===s;c?a&&i>a&&(t=o(a,i,t),i=a):a&&t>a&&(i=o(a,t,i),t=a);var u=document.createElement("canvas");c?(u.width=i,u.height=t):(u.width=t,u.height=i);var h=u.getContext("2d");return h.save(),h.translate(.5*u.width,.5*u.height),h.rotate(s*Math.PI/180),r&&h.scale(-1,1),h.drawImage(e,-.5*t,-.5*i,t,i),h.restore(),u},h={widthForHeight:s,heightForWidth:o,maxSize:r,cropBox:a,createCanvasForEl:l,drawElToCanvas:c,drawScaledAndRotated:u};e.exports=h},function(e,t,i){"use strict";function n(){}var s=i(6).sprintf,o=i(182).truncateLongStrings;n.prototype.genericFieldMap={one:"quote",two:"source"},n.prototype.typeAttributes={quote:"",source:""},n.prototype.generateTweetText=function(e,t){var i=this.getHtmlStripped("quote"),n=this.getHtmlStripped("source");n=n.replace(/[\r\n\s]*\[\[MORE\]\].*$/gi,"");var r;return r=n&&i.length+(n.length>1?7:6)<=t?r=s("%s - %s",i,n):i?s("%s",o(i,t-2)):n,o(r,t)},n.prototype.editorField="two",n.prototype.validate=function(e,t,i){var n=[];return(!t.quote||t.quote.length<1)&&n.push("No quote."),e.call(this,t,{errors:n})},e.exports=n},function(e,t,i){"use strict";function n(){}var s=i(3),o=i(6).sprintf,r=i(192),a=i(182).truncateLongStrings,l=i(193);n.prototype.genericFieldMap={one:"title",two:"url",three:"caption",thumbnail:"thumbnail",excerpt:"excerpt",author:"author"},n.prototype.typeAttributes={title:"",url:"",caption:"",excerpt:"",author:""},n.prototype.allowAnswerFields=["caption"],n.prototype.generateTweetText=function(e,t){var i=this.getHtmlStripped("title"),n=this.getHtmlStripped("url"),s=this.getHtmlStripped("caption");s=s.replace(/[\r\n\s]*\[\[MORE\]\].*$/gi,"");var l;return l=i&&s?o("%s - %s",i,s):i||s||r.parseUrl(n).host||"",a(l,t)},n.prototype.editorField="three",n.prototype.typeAttributes={title:"",url:"",excerpt:"",author:""},n.prototype.resetPreserveFields=["caption","tags"],n.prototype.resetAttributes=["title","url","thumbnail","excerpt","author"],n.prototype.softReset=function(e){e.apply(this,s.rest(arguments)),s.isEmpty(this.get("thumbnail"))||"new"===this.get("mode")||this.set("remove_thumbnail",1)},n.prototype.serializeForServer=function(e){var t=e.apply(this,s.rest(arguments));return this.get("remove_thumbnail")&&(t.remove_thumbnail=this.get("remove_thumbnail")),s.extend(t,{author:this.getAttributeFromGeneric("author"),excerpt:this.getAttributeFromGeneric("excerpt")}),t},n.prototype.validate=function(e,t,i){var n=[];return t.loading&&n.push("Loading OpenGraph data."),(!t.url||t.url.length<1)&&n.push("No url."),l.isUrl(t.url)||n.push("Not a valid URL"),e.call(this,t,{errors:n})},e.exports=n},function(e,t,i){"use strict";var n=i(3),s={aElement:document.createElement("a"),acceptedProtocols:["http:","https:","tumblr:","mailto:"],_setUrl:function(e){return this.aElement.setAttribute("href",e),this.aElement.setAttribute("href",this.aElement.href),this.aElement.href},parseUrl:function(e){if(!n.startsWith(e,"http"))throw new URIError("Missing protocol in URL to be parsed. Must be http or https");return this._setUrl(e),{url:e,href:this.aElement.href,protocol:this.aElement.protocol,host:this.aElement.hostname,port:this.aElement.port,query:this.aElement.search,hash:this.aElement.hash,path:this.aElement.pathname}},parseTumblelogUrl:function(e){try{-1===e.indexOf("://")&&(e="http://"+e);var t=this.parseUrl(e),i=!1;if(n.endsWith(t.host,"tumblr.com")?i=t.host.match(/([a-zA-Z0-9-_]+)\.tumblr\.com/i):n.endsWith(t.host,"tumblr.net")?i=t.host.match(/(?:^|\/\/)(?:([\w\-\_]+)\.)(?:[\w\-\_]+\.)*tumblr\.net/i):n.endsWith(t.host,"t.dev")&&(i=t.host.match(/([a-zA-Z0-9-_]+)\.t\.dev/i)),i){var s=i[1];if("www"===s)return!1;var o={tumblelog_name:s},r=t.path.match(/post\/([0-9]+)/i);return r&&(o.post_id=r[1]),o}return!1}catch(a){return!1}},isTumblelogUrl:function(e){return this.parseTumblelogUrl(e)!==!1},parseTumblelogShortUrl:function(e){try{-1===e.indexOf("://")&&(e="http://"+e);var t=this.parseUrl(e);return"tmblr.co"!==t.host?!1:n.startsWith(t.path,"/m")?{mentionKey:t.path.match(/^\/m([^\/]+)/)[0]}:n.startsWith(t.path,"/Z")?{postTinyUrlHash:t.path.match(/^\/Z([^\/]+)/)[0]}:!1}catch(i){return!1}},isTumblelogShortUrl:function(e){return this.parseTumblelogShortUrl(e)!==!1},isTumblrMediaUrl:function(e){return e?(-1===e.indexOf("://")&&(e="http://"+e),!!e.match(/^https?:\/\/(\d+\.)media\.tumblr\.com\//i)):!1},hasAllowedProtocol:function(e){this._setUrl(e);var t=this.aElement.protocol;if(":"===t&&(t=location.protocol),-1===this.acceptedProtocols.indexOf(t))throw new Error("Unsupported protocol detected in URL: "+e);return!0},isAbsoluteUrl:function(e){var t=new RegExp("^(?:[a-z]+:)?//","i");return!!t.test(e||"")},getParameter:function(e){var t=new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)"),i=t.exec(location.search)||[null,""],n=i[1].replace(/\+/g,"%20"),s=decodeURIComponent(n);return s||null},httpBuildQuery:function(e,t){var i=[];for(var n in e)if(e.hasOwnProperty(n)){var s=t?t+"["+n+"]":n,o=e[n];if(!o)continue;i.push("object"==typeof o?this.httpBuildQuery(o,s):encodeURIComponent(s)+"="+encodeURIComponent(o))}return i.join("&")},buildUrl:function(e,t){var i=this.httpBuildQuery(t);return e+(n.isEmpty(i)?"":"?"+i)},getQueryStringHash:function(e){var t={};return e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,i,n,s){t[i]=s}),t},isProtocolRelative:function(e){var t=new RegExp("^//[^/]","i");return t.test(e||"")},getExtension:function(e){var t,i;return this.isProtocolRelative(e)&&(e=this.addProtocolIfMissing(e,"http:")),n.startsWith(e,"http")&&(i=this.parseUrl(e),n.isEmpty(i.path)||(t=i.path)),t||(t=e),n.last(t.split("."))},addProtocolIfMissing:function(e,t){if(n.any(this.acceptedProtocols,function(t){return n.startsWith(e,t)}))return e;if(-1===this.acceptedProtocols.indexOf(t))throw new Error("Attempting to add an unsupported protocol: "+t);return(this.isProtocolRelative(e)?t:t+"//")+e}};e.exports=s},function(e,t){"use strict";var i={isUrl:function(e){var t="%[0-9a-fA-F]{2}",i="(http|https):\\/\\/",n='([a-zA-Z0-9$\\-_.+!*"(),;:&=]|'+t+")+@",s="(25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])",o="("+s+"(\\."+s+"){3})",r="a-zA-Z0-9\\-\\_\\~",a="\\u00C0-\\u017F",l="(["+r+a+"]+\\.)+([a-zA-Z]{2,})",c="[0-9]+",u="("+o+"|localhost|"+l+")(:"+c+")?",h="a-zA-Z0-9-._\\~:\\[\\]@!$&'()*+,;=",d="(["+h+"]|"+t+")*",p=d+"(\\/"+d+")*",g="\\?(["+h+"/?]|"+t+")*",m="\\#(["+h+"/?]|"+t+")*",f=new RegExp("^"+i+"("+n+")?"+u+"(\\/?("+p+")?("+g+")?("+m+")?)?$");return f.test(e)===!0},isImageUrl:function(e){var t=i.isUrl(e),n=/.+[.](jpg|jpeg|png|gif)([?]|$)/.test(e)===!0;return t&&n}};e.exports=i},function(e,t,i){"use strict";function n(){}var s=i(3),o=i(6).sprintf,r=i(182).truncateLongStrings;n.prototype.genericFieldMap={one:"title",two:"chat"},n.prototype.typeAttributes={title:"",chat:""},n.prototype.generateTweetText=function(e,t){var i,n=this.getHtmlStripped("title"),s=this.getHtmlStripped("chat");return i=n&&s?o("%s - %s",n,s):n||s||"",r(i,t)},n.prototype.validate=function(e,t,i){var n=[];return(!t.chat||t.chat.length<1)&&n.push("No chat."),e.call(this,t,{errors:n})},n.prototype.serializeForServer=function(e){var t=this,i=e.apply(this,s.rest(arguments));return i["post[two]"]=t.get("chat").replace(/\u00A0/gm," "),i},e.exports=n},function(e,t,i){"use strict";function n(){}var s=i(3),o=i(101),r=i(182).truncateLongStrings;n.prototype.genericFieldMap={two:"caption",three:"url"},n.prototype.editorField="two",n.prototype.allowsTypeSwitch=function(){return"new"===this.get("mode")},n.prototype.typeAttributes={service:!1,preuploadUrl:"",trackTitle:"",trackArtist:"",trackAlbum:"",preuploadAlbumArt:!1,albumArt:"",caption:"",confirmTos:!1},n.prototype.allowAnswerFields=["caption"],n.prototype.generateTweetText=function(e,t){var i=this.getHtmlStripped("caption");return i=i.replace(/[\r\n\s]*\[\[MORE\]\].*$/gi,""),r(i,t)},n.prototype.resetPreserveFields=["caption","tags"],n.prototype.resetAttributes=["service","url","preuploadUrl","trackTitle","trackArtist","trackAlbum","confirmTos","preuploadAlbumArt","albumArt","copyrightFallback"],n.prototype.parseForType=function(e,t,i){i.service&&"direct"!==i.service||(t.url=i.audio_url),delete t.audio_url,t.albumArt=i.audio_artwork,delete t.audio_artwork;var n=i.id3_tags||{};return delete t.id3_tags,t.trackTitle=n.Title||"",t.trackArtist=n.Artist||"",t.trackAlbum=n.Album||"",t},n.prototype.serializeForServer=function(e){var t=e.apply(this,s.rest(arguments)),i={"id3_tags[title]":this.get("trackTitle")||null,"id3_tags[artist]":this.get("trackArtist")||null,"id3_tags[album]":this.get("trackAlbum")||null,preuploaded_url:this.get("preuploadUrl"),confirm_tos:this.get("confirmTos"),artwork_pre_upload:this.get("preuploadAlbumArt"),album_art:this.get("albumArt"),remove_album_art:"edit"===this.get("mode")&&s.isEmpty(this.get("albumArt")),copyright_fallback:this.get("copyrightFallback")};return s.extend(t,s.pick(i,function(e){return!s.isUndefined(e)})),s.isEmpty(t.preuploaded_url)||(t["post[three]"]=null),t},n.prototype.validate=function(e,t,i){var n=[];return s.isEmpty(t.url)?n.push(o("Please choose an audio source before continuing.")):t.preuploadUrl?t.confirmTos||n.push(o("You must agree that you have permission to share this file.")):s.isEmpty(t.url)&&n.push(o("Please choose an audio source before continuing.")),e.call(this,t,{errors:n})},e.exports=n},function(e,t,i){"use strict";function n(){}var s=i(3),o=i(101),r=i(197),a=i(198),l=i(182).truncateLongStrings;n.prototype.genericFieldMap={one:"embedCode",two:"caption"},n.prototype.allowAnswerFields=["caption"],n.prototype.editorField="two",n.prototype.resetPreserveFields=["caption","tags"],n.prototype.resetAttributes=["preuploadUrl","preuploadKey","embedCode","confirmTos","copyrightFallback"],n.prototype.typeAttributes={caption:"",confirmTos:!1},n.prototype.generateTweetText=function(e,t){var i=this.getHtmlStripped("caption");return i=i.replace(/[\r\n\s]*\[\[MORE\]\].*$/gi,""),l(i,t)},n.prototype.validate=function(e,t,i){var n=[];return t.embedCode?0===t.embedCode.length&&n.push("No embed specified."):t.preuploadUrl?t.confirmTos||n.push(o("You must agree that you have permission to share this file.")):t.video?0===t.video.embed_code.length&&n.push("Direct embed missing."):n.push("No video specified."),e.call(this,t,{errors:n})},n.prototype.canPreview=function(){return!this.get("preuploadKey")&&this.isValid()},n.prototype.serializeForServer=function(e){var t=e.apply(this,s.rest(arguments)),i=s.omit({preuploaded_url:this.get("preuploadUrl"),preuploaded_ch:this.get("preuploadKey"),confirm_tos:this.get("confirmTos"),copyright_fallback:this.get("copyrightFallback")},s.isUndefined);return s.extend(t,i),t=r(t,"snake",["embedCode"])},n.prototype.getEmbedData=function(e){var t=!1;return this.has("video")?(t=a(this.get("video")),t={isNativeVideo:!0,embedRenderContext:"inline",width:t.dimensions.width,height:t.dimensions.height,previewIframe:t.previewIframe,embedCode:t.embedCode}):this.has("video_embed")&&(t=a(this.get("video_embed"))),t},e.exports=n},function(e,t,i){"use strict";var n=i(3),s={camel:n.camelCase,snake:n.snakeCase,kebab:n.kebabCase},o=function(e,t){return n.isString(t)&&(t=n.result(s,t)),n.isFunction(t)?n.map(e,t):e},r=function(e,t,i){return n.isString(t)&&(t=o(i||n.keys(e),t)),n.transform(e,function(e,i,s){e[n.result(t,s)||s]=i},{})};e.exports=r},function(e,t,i){"use strict";var n=i(3),s=function(e,t){return null==t?t=5:n.isNumber(t)||(t=0),n.transform(e,function(e,i,o){t&&n.isObject(i)&&(i=s(i,t-1)),e[n.camelCase(o)]=i})};e.exports=s},function(e,t,i){"use strict";function n(){}var s=i(3),o=i(182).truncateLongStrings;n.prototype.genericFieldMap={one:"ask",two:"answer",three:"caption"},n.prototype.editorField="three",n.prototype.typeAttributes={ask:"",answer:"",caption:""},n.prototype.generateTweetText=function(e,t){return o(this.getHtmlStripped("ask"),t)},n.prototype.parseForType=function(e,t,i){return t.ask=s.escape(t.ask),t},n.prototype.validate=function(e,t,i){var n=[];return t.ask||n.push("Post question empty."),e.call(this,t,{errors:n})},e.exports=n},function(e,t,i){"use strict";var n=i(3),s=function(e){if(n.isString(e)){if(e=e.toLowerCase(),"true"===e||"1"===e||"on"===e)return!0;if("false"===e||""===e||"off"===e)return!1;if(e=n.parseInt(e),n.isNaN(e))return!0}return!!e};e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(119),o=i(202),r=i(121),a=s.extend({model:o,_listenToUploadModel:function(e){this.listenTo(e,"change",this._onUploadModelChange)},_stopListeningToUploadModel:function(e){this.stopListening(e)},_onUploadModelChange:function(e){n.has(e.changed,"complete")&&this.trigger("complete",this,e),n.has(e.changed,"error")&&e.get("error")&&this.trigger("error",this,e),n.has(e.changed,"complete")&&this.allComplete()&&this.trigger("allComplete",this)},add:function(e){return n.isArray(e)?n.forEach(e,this._listenToUploadModel,this):this._listenToUploadModel(e),s.prototype.add.apply(this,arguments)},remove:function(e){return n.isArray(e)?n.forEach(e,this._stopListeningToUploadModel,this):this._stopListeningToUploadModel(e),s.prototype.remove.apply(this,arguments)},removeIncomplete:function(e){var t=this.where({uploading:!1,complete:!1});return this.remove(t,e)},removeFailed:function(e){var t=this.filter(function(e){return e.get("error")});return this.remove(t,e)},allComplete:function(){return this.length?this.every(function(e){return e.get("complete")}):!1},anyUploading:function(){return this.length>0&&this.any(function(e){return e.get("uploading")})},getProgress:function(){var e=0,t=0;return this.forEach(function(i){i.get("error")&&(e+=i.get("bytesLoaded")||0,t+=i.get("bytesTotal")||0)}),t?e/t:0},promise:function(){if(this.allComplete())return r.resolve(this);var e=r.promise(n.bind(function(e,t){var i,s;i=n.bind(function(){this.stopListening(this,"uploads:allComplete",i),this.stopListening(this,"uploads:error",s),e.apply(this,arguments)},this),s=n.bind(function(){this.stopListening(this,"uploads:allComplete",i),this.stopListening(this,"uploads:error",s),t.apply(this,arguments)},this),this.listenToOnce(this,"uploads:allComplete",i),this.listenToOnce(this,"uploads:error",s)},this));return e}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(114),o=s.extend({defaults:{url:"",file:null,error:!1,uploading:!1,complete:!1,bytesLoaded:0,bytesTotal:0},initialize:function(e,t){this.options=n.extend({},t),this.options.jqXHR&&this.setUploadRequest(this.options.jqXHR)},setUploadRequest:function(e){return this.jqXHR=e,e.then(function(){}),e},_uploadDone:function(){this.set({error:!1,uploading:!1,complete:!0})},_uploadFail:function(){this.set({error:!0,uploading:!1,complete:!1})},cancelUpload:function(){var e;return this.jqXHR&&(e=this.jqXHR.abort(),this.jqXHR=null),e},getProgress:function(){return this.get("bytesTotal")?this.get("bytesLoaded")/this.get("bytesTotal"):0}});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(121),r=i(165).animate,a=i(168),l=i(150),c=i(101),u=i(149),h=i(110),d=i(204),p=i(205),g=i(160),m=i(206),f=i(208),v=i(214),_=i(219),b=i(246),w=i(247),y=i(251),k=i(261),x=i(263),C=i(264),S=i(266),E=i(268),T=i(280),A=i(338),F=i(528),R=u.extend({className:"post-form",defaults:{useMediaReady:!1,showFooter:!0,hideControlsLine:!1,enabled:!0,locked:!1,saving:!1,hasRichTextTutorial:!1,hasInlineControlsTutorial:!1,hasImageSearchTutorial:!1,showRichTextTutorial:!1,showInlineControlsTutorial:!1,showImageSearchTutorial:!1,disablePhotoFromUrl:!1,closeLabel:null},events:{"click [data-js-clickableClose]":"_onClickClose","click [data-js-clickableSave]":"_onClickSave","mousedown [data-js-clickableClose]":"cancelEditorBlur","mousedown [data-js-clickableSave]":"cancelEditorBlur",keydown:"_onKeyDown"},mixins:[d,p,g],template:F,_setup:function(){this.defaults.closeLabel=c("Close")},initialize:function(e){this.options=e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"post","user","uploads","dragEvents")),n.extend(this.attributes,n.pick(this.post.attributes,["mode"])),this.__onBeforeUnload=n.bind(this._onBeforeUnload,this)},_targetHandlesDrag:function(e){var t=s(e);return n.isEmpty(t.closest(".editable-photoset"))&&n.isEmpty(t.closest(".media-dropzone"))&&n.isEmpty(t.closest("input"))?!n.isEmpty(t.closest('[contenteditable="true"]')):!0},_onDragOver:function(e){this._targetHandlesDrag(e.target)&&!n.isEmpty(e.originalEvent.dataTransfer.files)&&(e.originalEvent.dataTransfer.dropEffect="copy"),e.preventDefault()},_onDrop:function(e){this._targetHandlesDrag(e.target)||e.preventDefault()},_onModelChange:function(){this.subViews.errorBar.hideErrorBar()},_onChangeHideControlsLine:function(e,t){this.$el.toggleClass("no-controls-line",t)},_onChangeShowFooter:function(e,t){this.isRendered()&&(t?this.js$("footer").css({display:"block",opacity:1}):this.js$("footer").css({display:"none",opacity:0}))},_onChangeEnabled:function(e,t){t?this.$el.removeClass("no-pointer-events"):this.$el.addClass("no-pointer-events")},_onChangeLocked:function(e,t){t?this.$$(".post-form--guard").addClass("visible"):this.$$(".post-form--guard").removeClass("visible")},_onClickClose:function(e){this.options.redirectTo?(s(window).off("beforeunload",this.__onBeforeUnload),window.location=this.options.redirectTo):(this.resumeEditorBlur(),h.trigger("postForms:close"))},_onClickSave:function(e){this.resumeEditorBlur(n.bind(this.save,this))},_onTypeSwitch:function(e,t){this.post.set("type",e),this.trigger("postForms:changePostType",t)},_getCurrentRichTextEditor:function(){return this.postTypeForm?this.postTypeForm.getRichTextEditor():void 0},_getEditorType:function(){return this.model.get("editorType")||"rich"},_sendTutorialReadFlag:function(){s.ajax({url:"/svc/post/set_seen_rte",type:"POST",with_form_key:!0})},_setHasTutorialStates:function(){var e=n.contains(["text","photo","audio","video","link"],this.post.get("type"));this.set("hasRichTextTutorial",e&&this.user.get("hasRichTextTutorial")),this.set("hasInlineControlsTutorial",e&&this.user.get("hasInlineControlsTutorial")),this.set("hasImageSearchTutorial",e&&this.user.get("hasImageSearchTutorial"))},_setShowRichTextTutorialState:function(){this.set("showRichTextTutorial",this.get("hasRichTextTutorial")&&"rich"===this._getEditorType()&&this.get("showFooter"))},_setShowInlineControlsTutorialState:function(){this.set("showInlineControlsTutorial",this.get("hasInlineControlsTutorial")&&"rich"===this._getEditorType()&&!this.get("hasRichTextTutorial"))},_setShowImageSearchTutorialState:function(){this.set("showImageSearchTutorial",this.get("hasImageSearchTutorial")&&"rich"===this._getEditorType()&&this.get("showFooter"))},_onChangeHasRichTextTutorial:function(e,t){this.$el.toggleClass("has-richtext-tutorial",t)},_onChangeShowRichTextTutorial:function(e,t){this.$el.toggleClass("show-richtext-tutorial",t),t&&this.user.get("hasRichTextTutorial")&&(this._sendTutorialReadFlag(),this.user.set("hasRichTextTutorial",!1))},_onRichTextTutorialRemoved:function(e){var t,i=function(e){this.set("hasRichTextTutorial",!1),this.$el.removeClass("closing-richtext-tutorial")};this.stopListening(e),this.stopListening(this,"change:showFooter",this._setShowRichTextTutorialState),
this.stopListening(this.model,"change:editorType",this._setShowRichTextTutorialState),this.options.isModal?n.defer(function(){l.animation(this.$el,i.bind(this)),this.$el.addClass("closing-richtext-tutorial")}.bind(this)):i.call(this),t=this._getCurrentRichTextEditor(),t&&t.focus(),this.set("showRichTextTutorial",!1)},_onInlineControlsTutorialHide:function(e){this.stopListening(e),this.stopListening(this,"change:hasRichTextTutorial",this._setShowInlineControlsTutorialState),this.stopListening(this.model,"change:editorType",this._setShowInlineControlsTutorialState),this.user.set("hasInlineControlsTutorial",!1),e.remove()},_onImageSearchTutorialHide:function(e){this.stopListening(e),this.stopListening(this.model,"change:editorType",this._setShowImageSearchTutorialState),this.user.set("hasImageSearchTutorial",!1),this._sendTutorialReadFlag(),e.remove()},_onChangeShowInlineControlsTutorial:function(e,t){var i=this._getCurrentRichTextEditor(),n=this.options.supportImageSearch,s=n?"animate-inline-controls-tutorial":"animate-inline-controls-tutorial-original",o=c(n?"Click the plus sign to insert photos, videos, reaction GIFs, horizontal lines, or read-more links.":"Click the plus sign to insert photos, videos, horizontal lines, or read-more links.");t&&i?(this.inlineControlsTutorial=new E({richTextEditor:i,animationClass:s,animationShowDelay:"text"===this.post.get("type")?500:750,title:c("But wait, there's more"),content:o}),this.listenToOnce(this.inlineControlsTutorial,"hide",this._onInlineControlsTutorialHide)):this.inlineControlsTutorial&&(this.inlineControlsTutorial.remove(),this.inlineControlsTutorial=null)},_onChangeShowImageSearchTutorial:function(e,t){var i=this._getCurrentRichTextEditor();t&&i?(this.imageSearchTutorial=new E({richTextEditor:i,animationClass:"animate-image-search-tutorial",animationShowDelay:"text"===this.post.get("type")?500:750,title:c("GIF your words"),content:c("Hit this button. Type a word. Pick a GIF. Express thyself."),buttonLabel:c("Dare thee try it?")}),this.listenToOnce(this.imageSearchTutorial,{hide:this._onImageSearchTutorialHide,dismiss:function(){i.openImageSearch()}})):this.imageSearchTutorial&&(this.imageSearchTutorial.remove(),this.imageSearchTutorial=null)},_createContentStatsSupport:function(){this.contentStatsSupport&&this.contentStatsSupport.remove(),this.contentStatsSupport=new T({model:this.model,editor:this._getCurrentRichTextEditor()})},getRect:function(){var e=this.$el.css("display");this.$el.css("display","block");var t=this.$el.offset(),i={};return i.offsetTop=t.top,i.offsetLeft=t.left,i.offsetHeight=this.$el.outerHeight(),i.offsetWidth=this.$el.outerWidth(),this.$el.css("display",e),i},measureHeight:function(){if(!this.isRendered())return null;var e=this.$el.css("display");this.$el.css("display","block");var t=this.$el.outerHeight();return this.$el.css("display",e),t},animateShow:function(e,t){e||(e=0),t||(t=0),e||this.js$("container-outer").css("opacity",1);var i=[r(this.js$("container-outer"),{opacity:[1,0]},{duration:e}),r(this.js$("container-inner"),{translateY:[0,10]},{duration:e,delay:t,complete:function(e){s(e).removeAttr("style")}})];return this.options.isModal&&i.push(r(this.js$("margin"),{opacity:[1,0]},{duration:e})),this.avatar&&this.avatar.updateViewState(),o.all(i)},animateHide:function(e,t){e||(e=0),t||(t=0),e||this.js$("container-outer").css("opacity",0),this.options.isModal||this.avatar.resetAvatar();var i=[];return this.js$("container-outer").length&&this.js$("container-inner").length&&(i.push(r(this.js$("container-outer"),{opacity:[0,1]},{duration:e})),i.push(r(this.js$("container-inner"),{translateY:[10,0]},{duration:e,delay:t}))),this.options.isModal&&this.js$("margin").length&&i.push(r(this.js$("margin"),{opacity:[0,1]},{duration:e})),o.all(i)},forceHidden:function(){return this.js$("container-outer").css("opacity",0),this.options.isModal&&this.js$("margin").css("opacity",0),r(this.js$("container-inner"),{translateY:[10,10]},{duration:0}),this},save:function(e){if(!this.get("saving")||e){var t;h.trigger("postForms:saving"),this.subViews.errorBar.hideErrorBar();var i=a([function(){!1===this.model.isValid()},function(){this.set({enabled:!1,locked:!0,saving:!0})},function(){},function(){try{this.model.set("contentStats",this.contentStatsSupport.getStats())}catch(e){}return t=this.model.save(this.options)},function(){this.set({enabled:!1,locked:!0,saving:!1,saved:!0})}],this).then(n.bind(function(e){if(e=e.filter(function(e){return e}),e.length&&(e=e[0]),n.isEmpty(e.errors)){if(this.options.redirectTo)s(window).off("beforeunload",this.__onBeforeUnload),window.location=this.options.redirectTo;else if(h.trigger("postForms:saved",{},t),"reblog"===this.model.get("mode")){var i=this.model.get("reblog_id"),o=window.Tumblr.Posts.find({id:i});o&&(o.updateReblogControl(),h.trigger("post:reblog:set",{model:o,toastOptions:{avatar:this.avatar.get("avatarUrl"),message:this.model.get("message")}}))}}else{var r=[];for(var a in e.errors)r.push(n.escape(e.errors[a]));this.set({enabled:!0,locked:!1,saving:!1,saved:!1});var l=r.join("<br>");this.subViews.errorBar.showErrorBar(l),h.trigger("postForms:error")}},this));return i["catch"](n.bind(function(e){this.set({enabled:!0,locked:!1,saving:!1,saved:!1}),h.trigger("postForms:error")},this)),i}},createSubViews:function(){var e,t=["showPhotoBooth","supportImageSearch","minFullWidthSize","popoverContainer","dragEvents"],i=n.extend({user:this.user,post:this.post,uploads:this.uploads,model:this.model},n.pick(this.options,t),this.attributes),s=this.post.get("tumblelog");this.avatar=this.subViews.avatar=new m(n.extend(this.options.isModal?{}:{determineViewState:!1,showSubavatar:this.user.getChannel(s).get("show_author_avatar"),avatarUrl:this.user.getChannel(s).get("avatar_url")},i)),this.tumblelogSelect=this.subViews.tumblelogSelect=new f(i),this.postSettings=this.subViews.postSettings=new v(i),this.tagEditor=this.subViews.tagEditor=new _(i),this.editorButtons=this.subViews.editorButtons=new b(i),this.socialButtons=this.subViews.socialButtons=new w(i),this.savePostButton=this.subViews.savePostButton=new y(i),this.uploadIndicator=this.subViews.uploadingIndicator=new C(i),e=n.extend({},i,{tagEditor:this.tagEditor}),this.postTypeForm=this.subViews.postTypeForm=A(e),this.set("useMediaReady",this.postTypeForm.get("hasMediaView")),this.listenTo(this.postTypeForm,"media:ready",function(){var e=n.toArray(arguments);e.unshift("media:ready"),this.trigger.apply(this,e)}),this.set("hideControlsLine",this.postTypeForm.get("hideControlsLine")),this.listenTo(this.postTypeForm,"change:hideControlsLine",function(e,t){this.set("hideControlsLine",t)}),this.postTypeForm.has("showCaption")&&(this.set("showFooter",this.postTypeForm.get("showCaption")),this.listenTo(this.postTypeForm,"change:showCaption",function(e,t){this.set("showFooter",t)})),this.listenTo(h,"postForms:tumblelogSelectDropdown:open",function(){this.trigger("checkScrollSize"),this.trigger("pauseScrollHelper")}),this.listenTo(h,"postForms:tumblelogSelectDropdown:close",function(){this.trigger("checkScrollSize",!0),this.trigger("resumeScrollHelper")}),this.listenTo(this.savePostButton,"dropdown:intent",this.cancelEditorBlur),this.post.allowsTypeSwitch()&&this.listenTo(this.postTypeForm,"switchPostType",this._onTypeSwitch),this.subViews.allowAnswers=new k(i),this.subViews.errorBar=new x,this._setHasTutorialStates(),this._setShowRichTextTutorialState(),this._setShowInlineControlsTutorialState(),this._setShowImageSearchTutorialState(),this.get("hasRichTextTutorial")&&(this.richTextEditorTutorial=this.subViews.richTextEditorTutorial=new S,this.listenToOnce(this.richTextEditorTutorial,"removed",this._onRichTextTutorialRemoved),this.listenTo(this,"change:showFooter",this._setShowRichTextTutorialState),this.listenTo(this.model,"change:editorType",this._setShowRichTextTutorialState)),this.get("hasInlineControlsTutorial")&&(this.listenTo(this,"change:hasRichTextTutorial",this._setShowInlineControlsTutorialState),this.listenTo(this.model,"change:editorType",this._setShowInlineControlsTutorialState)),this.get("hasImageSearchTutorial")&&(this.listenTo(this,"change:showFooter",this._setShowImageSearchTutorialState),this.listenTo(this.model,"change:editorType",this._setShowImageSearchTutorialState))},addStateListeners:function(){this.listenTo(this,"change:hideControlsLine",this._onChangeHideControlsLine),this.listenTo(this,"change:showFooter",this._onChangeShowFooter),this.listenTo(this,"change:enabled",this._onChangeEnabled),this.listenTo(this,"change:locked",this._onChangeLocked),this.listenTo(this.model,"change",this._onModelChange),this.listenTo(this.dragEvents,"dragover",this._onDragOver),this.listenTo(this.dragEvents,"drop",this._onDrop),this.listenTo(this.tagEditor,"postForms:focusOnNextEditor",this.focusOnNextEditor),this.listenTo(this,"change:showRichTextTutorial",this._onChangeShowRichTextTutorial),this.listenTo(this,"change:hasRichTextTutorial",this._onChangeHasRichTextTutorial),this.listenTo(this,"change:showInlineControlsTutorial",this._onChangeShowInlineControlsTutorial),this.listenTo(this,"change:showImageSearchTutorial",this._onChangeShowImageSearchTutorial)},serialize:function(){return this.toJSON()},beforeRender:function(){this.dragEvents.start(),this.createSubViews(),this.addStateListeners(),s(window).on("beforeunload",this.__onBeforeUnload)},render:function(){return this.$el.html(this.template(this.serialize())),this.attachSubViews(),this.post.get("type")&&this.$el.addClass("post-form--"+this.post.get("type")),this.user.get("hasGifSearchVariation")&&this.$el.addClass("gif-search-variation"),this},afterRender:function(){this.$el.toggleClass("no-controls-line",this.get("hideControlsLine")),this.get("showFooter")||this.js$("footer").css({display:"none",opacity:0}),this.renderSubViews(),this._onChangeHasRichTextTutorial(this,this.get("hasRichTextTutorial")),this._onChangeShowRichTextTutorial(this,this.get("showRichTextTutorial")),this._onChangeShowInlineControlsTutorial(this,this.get("showInlineControlsTutorial")),this._onChangeShowImageSearchTutorial(this,this.get("showImageSearchTutorial")),this._createContentStatsSupport()},teardown:function(){return this.dragEvents.stop(),this.stopListening(),this.contentStatsSupport&&this.contentStatsSupport.remove(),this.inlineControlsTutorial&&this.inlineControlsTutorial.remove(),s(window).off("beforeunload",this.__onBeforeUnload),this},remove:function(){return this.teardown(),u.prototype.remove.apply(this,arguments)},_onKeyDown:function(e){this.focusOnNextEditor(e),this.keyboardSave(e)},focusOnNextEditor:function(e){if(9===e.keyCode){var t=this.$el.find(".editor[contenteditable]:visible, .post-form--close, .post-form--save-button .create_post_button:enabled"),i=s.inArray(e.target,t);if(-1!==i){e.preventDefault();var n=(i+(e.shiftKey?-1:1))%t.length;0>n&&(n+=t.length),s(t[n]).focus()}}},keyboardSave:function(e){var t=/Mac/.test(navigator.platform)?e.metaKey:e.ctrlKey;13===e.keyCode&&t&&this.post.isValid()&&(e.preventDefault(),e.stopPropagation(),this.save())},_onBeforeUnload:function(){if(this.model.deepHasChanged(this.get("initialPostState"))){var e=c("Sure you want to leave this page without saving? Your post will be discarded.");return"edit"===this.model.get("mode")&&(e=c("Sure you want to leave this page without saving? All your edits will be lost.")),e}},cancelEditorBlur:function(){var e=this._getCurrentRichTextEditor();e&&e.cancelBlur()},resumeEditorBlur:function(e){var t=this._getCurrentRichTextEditor();t&&n.isFunction(t.resumeBlur)?t.resumeBlur(e):n.isFunction(e)&&e()}});e.exports=R},function(e,t,i){"use strict";var n=i(3),s=i(116),o=new s({defaults:{teardown:function(){return this},beforeTeardown:function(){},afterTeardown:function(){return this.teardownSubViews()},render:function(){return this},beforeRender:function(){},afterRender:function(){return this.renderSubViews()},attachSubView:function(e,t){if(1===arguments.length)if("string"==typeof e){if(t=e,e=this.subViews[t],!e)return this}else t=e.$el.data("subview")||"";var i=this.$('[data-subview="'+t+'"]');return i.length>1&&(i=i.first()),e&&i.length&&(i.replaceWith(e.$el),e.$el.attr("data-subview",t)),this},attachSubViews:function(e){return n.forEach(this.subViews,this.attachSubView,this),this},teardownSubViews:function(){return n.forEach(this.subViews,function(e,t){e&&n.isFunction(e.teardown)&&e.teardown(),this.subViews[t]=null},this),this.subViews={},this},renderSubViews:function(){return n.forEach(this.subViews,function(e){e&&n.isFunction(e.render)&&e.render()},this),this},isInitialized:function(){return this._initialized},isRendered:function(){return this._rendered},isRendering:function(){return this._rendering},isRemoved:function(){return this._removed}},around:{initialize:function(e){this._initialized=!1,this._rendering=!1,this._rendered=!1,this._removed=!1,this.subViews={};var t=e.apply(this,n.rest(arguments));return this._initialized=!0,t},teardown:function(e){var t=n.rest(arguments);n.isFunction(this.beforeTeardown)&&this.beforeTeardown.apply(this,t);var i=e.apply(this,t);return n.isFunction(this.afterTeardown)&&this.afterTeardown.apply(this,t),this._rendered=!1,i},render:function(e){var t=n.rest(arguments);this._rendering=!0,n.isFunction(this.beforeRender)&&this.beforeRender.apply(this,t);var i=e.apply(this,t);return n.isFunction(this.afterRender)&&this.afterRender.apply(this,t),this._rendering=!1,this._rendered=!0,this.trigger("rendered"),i}},after:{remove:function(){this._removed=!0,this.subViews=null}}});e.exports=o},function(e,t,i){"use strict";function n(e){return s.trim(e)}var s=i(3),o=i(116),r=function(e,t){return e=n(e),t&&s.isFunction(this.$$)&&this.$$.cache["delete"](e),e},a=function(e){return this.$$?(e=n(e),this.$(e)):void 0},l=function(e){this.$$&&(e=n(e),this.$$.cache["delete"](e))},c=function(e){return this.$$?(e=n(e),this.$$.cache["delete"](e),this.$(e)):void 0},u=function(){this.$$&&(this.$$.cache=new s.memoize.Cache)},h=function(e){return"[data-js-"+e+"]"},d=function(e){return function(){var e=s.memoize(s.bind(a,this),s.bind(r,this));e.update=s.bind(c,this),e.remove=s.bind(l,this),e.empty=s.bind(u,this);var t=function(t,i){return e(h(t),i)};return t.update=function(t){e.update(h(t))},t.remove=function(t){e.remove(h(t))},this.$$=e,this.js$=t,this.$$initialize=s.noop,e}.call(e)},p=new o({defaults:{$$cacheKeys:{},$$cacheSelectors:function(e){return"undefined"==typeof e&&(e=this.$$cacheKeys),s.forEach(e,function(e){this.$$.update(e)},this),this},$$initialize:function(){return d(this)},$$:function(){return d(this).apply(this,arguments)}},before:{initialize:function(){this.$$initialize()},render:function(){this.$$.empty()}},after:{setElement:function(){s.isFunction(this.$$.empty)&&this.$$.empty()},remove:function(){s.isFunction(this.$$.empty)&&this.$$.empty()},render:function(){s.isFunction(this.$$cacheSelectors)&&this.$$cacheSelectors()}}});e.exports=p},function(e,t,i){"use strict";var n=i(3),s=i(121),o=i(165).animate,r=i(168),a=i(171),l=i(149),c=i(178),u=i(204),h=i(205),d=i(160),p=i(111),g=i(207),m=l.extend({className:"post-form--avatar",mixins:[u,h,d],template:g,defaultOptions:{size:128,determineViewState:!0},defaults:{flipQueued:!1,showSubavatar:!1,avatarUrl:""},initialize:function(e){if(this.options=e=n.extend({},this.defaultOptions,e),this.user=e.user||p(),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),e.post&&(this.post=e.post,this.tumblelog=e.tumblelog||this.user.getChannel(this.post.get("tumblelog")),this.listenTo(this.post,"change:tumblelog",this._onChangePostTumblelog)),!this.tumblelog)throw new Error("AvatarView requires a Tumblelog model!");this.options.determineViewState?this.updateViewState():this.get("avatarUrl")||this.set("avatarUrl",this.tumblelog.get("avatar_url")),this.listenTo(this,"change:showSubavatar",this._onChangeShowSubavatar),this.listenTo(this,"change:avatarUrl",this._onChangeAvatarUrl)},_onChangeShowSubavatar:function(e,t){t?this.showSubavatar():this.hideSubavatar()},_onChangeAvatarUrl:function(e,t){return this.queueFlipAvatar()},updateViewState:function(){this.set({showSubavatar:this.tumblelog.get("show_author_avatar"),avatarUrl:this.tumblelog.get("avatar_url")})},_onChangePostTumblelog:function(e,t){this.tumblelog=this.user.getChannel(t),this.updateViewState()},showSubavatar:function(e,t){return null!=e||(e=a(150)),null!=t||(t=a(300)),o(this.$$(".primary-avatar"),{scale:1},{display:"block",duration:e,delay:t,easing:[.25,1.5,.75,1]})},hideSubavatar:function(e,t){return null!=e||(e=a(100)),null!=t||(t=0),o(this.$$(".primary-avatar"),{scale:0},{display:"none",duration:e,delay:t,easing:[0,0,.6,1]})},queueFlipAvatar:function(e,t){if(this._avatarFlipping)return void this.set("flipQueued",!0);var i=this.flipAvatar();i.then(n.bind(function(){this.get("flipQueued")&&(this.set("flipQueued",!1),this.flipAvatar())},this))},flipAvatar:function(e,t){null!=e||(e=a(300)),null!=t||(t=a(50));var i=c(this.get("avatarUrl"),this.options.size),n=this.tumblelog.get("name"),l=this.$$(".channel-avatar"),u=l.clone();return this._avatarFlipping=!0,r([function(){return u.children(".avatar-link").css("background-image","url('"+i+"')"),u.children(".avatar-image").attr({src:i,alt:n}),o(u,{rotateY:[180,180]},{duration:0}).then(function(){u.insertAfter(l)})},function(){return s.join(o(l,{rotateY:[180,0]},{duration:e}),o(u,{rotateY:[360,180]},{duration:e}))},function(){return l.remove(),this.$$.remove(".channel-avatar"),o(u,{rotateY:[0,0]},{duration:0})},function(){this._avatarFlipping=!1}],this)},resetAvatar:function(){return this.set(n.defaults(n.pick(this.options,["showSubavatar","avatarUrl"]),n.pick(this.attributes,["showSubavatar","avatarUrl"]))),this},serialize:function(){return n.extend(this.toJSON(),{avatarUrl:c(this.get("avatarUrl"),this.options.size),subavatarUrl:c(this.user.getChannel().get("avatar_url"),this.options.size),primary:this.user.getChannel().toJSON(),channel:this.tumblelog.toJSON()})},render:function(){return this.$el.html(this.template(this.serialize())),this.get("showSubavatar")||(this.$$(".primary-avatar").css("display","none"),this.hideSubavatar(0)),this}});e.exports=m},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="channel-avatar avatar-container"><a class="avatar-link" href="'+(null==(__t=channel.url)?"":_.escape(__t))+'" target="_blank" title="'+(null==(__t=channel.directory_safe_title)?"":__t)+'" style="background-image: url(\''+(null==(__t=avatarUrl)?"":_.escape(__t))+'\')"><img class="avatar-image" src="'+(null==(__t=avatarUrl)?"":_.escape(__t))+'" alt="'+(null==(__t=channel.name)?"":_.escape(__t))+'"></a></div><div class="primary-avatar avatar-container"><a class="avatar-link" href="'+(null==(__t=primary.url)?"":_.escape(__t))+'" target="_blank" title="'+(null==(__t=primary.directory_safe_title)?"":__t)+'" style="background-image: url(\''+(null==(__t=subavatarUrl)?"":_.escape(__t))+'\')"><img class="avatar-image" src="'+(null==(__t=subavatarUrl)?"":_.escape(__t))+'" alt="'+(null==(__t=primary.name)?"":_.escape(__t))+'"></a></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(204),a=i(205),l=i(209),c=i(210),u=s.extend({defaults:{modeRequiresDropdown:!0},events:{"click [data-js-clickableTumblelogLabel]":"toggleTumblelogSelectDropdown"},mixins:[o,r,a],template:l,initialize:function(e){this.options=e||{},this.user=e.user,this.listenTo(this.model,"change:tumblelog",this.adjustLabel),this.set("modeRequiresDropdown","edit"!==this.model.get("mode"))},render:function(){return this.$el.html(this.template({post:this.model})),this.adjustLabel(),this.createDropdown(),this},createDropdown:function(){var e=n.extend(this.options,{shift:{x:0,y:10},identifier:"postForms:tumblelogSelectDropdown"});this.get("modeRequiresDropdown")&&(this.tumblelogSelectDropdown=new c(e),this.tumblelogSelectDropdown.setPinnedTarget(this.js$("tumblelogSelectPin")))},toggleTumblelogSelectDropdown:function(){this.get("modeRequiresDropdown")&&(this.tumblelogSelectDropdown.isOrWasRecentlyRendered()||this.tumblelogSelectDropdown.render())},adjustLabel:function(){var e,t;this.user&&this.model&&(e=this.model.get("tumblelog"),t=this.user.getChannel(e),this.js$("tumblelogLabel").text(t?t.getDisplayName():e))}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<button class="tumblelog-select '+(null==(__t="edit"===post.get("mode")?"inactive":"")?"":_.escape(__t))+'" data-js-clickabletumbleloglabel><span class="caption" data-js-tumbleloglabel></span> ',"edit"!==post.get("mode")&&(__p+=' <span class="dropdown icon_arrow_carrot_down" data-js-tumblelogselectpin></span> '),__p+=" ","reblog"===post.get("mode")&&(__p+=' <span class="reblog_source"><i class="reblog-icon"></i><span class="reblog_name">'+(null==(__t=post.get("reblog_name"))?"":_.escape(__t))+"</span></span> "),__p+=" </button>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(110),r=i(178),a=i(160),l=i(204),c=i(205),u=i(211),h=i(111),d=i(213),p=s.extend({className:"popover--tumblelog-select-dropdown",events:{"click [data-js-tumblelogChoice]":"selectBlog"},mixins:[a,l,c,u],template:d,defaultOptions:{size:128},defaults:{tumblelog:!1},initialize:function(e){this.options=e=n.extend({},this.defaultOptions,e),this.user=e.user||h(),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),this.get("tumblelog")||this.set("tumblelog",this.user.getChannel().get("name"))},render:function(){return this.delegateEvents(),this.$el.html(this.template(this.serialize())),o.trigger("postForms:dismissListener:suspend"),this},teardown:function(){return this.$el.remove(),o.trigger("postForms:dismissListener:resume"),this},serialize:function(){var e=this.toJSON();return e.channels=this.user.channels.map(function(e){return n.extend({avatarUrl:r(e.get("avatar_url"),this.options.size),displayName:e.getDisplayName()},e.toJSON())},this),e},selectBlog:function(e){var t=this.$(e.currentTarget).index();this.model.set("tumblelog",this.user.channels.at(t).get("name")),this.teardown()}});e.exports=p},function(e,t,i){"use strict";function n(e){return o.noop}var s=i(9),o=i(3),r=(i(6).sprintf,i(116)),a=i(110),l=!1,c=s("body"),u=s(window),h=i(212),d=new r({removeAutoTeardown:function(){this._popoverBase.clickOutside&&(this._popoverBase.clickOutside.remove(),this._popoverBase.clickOutside=null)},setupAutoTeardown:function(){this.isRendered()&&(this.removeAutoTeardown(),this._popoverBase.autoTeardown&&(this._popoverBase.clickOutside=new h(this.el,this.options),this._popoverBase.clickOutside.on("click:outside",this.onClickOutside,this)))},onClickOutside:function(){this._popoverBase.shouldTeardown?(this._popoverBase.lastAutoTeardown=o.now(),this.teardown()):this._popoverBase.shouldTeardown=!0},reposition:function(){if(!this.$pinned.closest("body").length)return void this.$el.css("visibility","hidden");var e=this.pinnedRect(),t={scrollTop:this.isContainerBody?0:this.$container.scrollTop(),scrollLeft:this.isContainerBody?0:this.$container.scrollLeft(),realTop:this.isContainerBody?0:this.$container.offset().top,realLeft:this.isContainerBody?0:this.$container.offset().left},i=this._popoverBase.shift,n=this._popoverBase.pinnedSide,s={visibility:"visible"},r={},a=this.$el.width(),l=null,c=null,u=null,h=null;this.debug("reposition: pinnedSide=%s, shift=%O, pinnedRect=%O",n,i,e),this._popoverBase.isFixedPosition&&(s.position="fixed"),"top"===n||"bottom"===n?(o.extend(s,{left:e.left+Math.floor(e.width/2)+i.x}),r={top:e.top+t.scrollTop-i.y,bottom:e.top+t.scrollTop+e.height+i.y,left:e.left+t.scrollLeft-i.x,right:e.left+t.scrollLeft+e.width+i.x},r.center=(r.right-r.left)/2,l=t.realTop+r.top-this.$el.height(),c=t.realTop+r.bottom+this.$el.height(),"top"===n&&this._crossesViewportEdge("top",l)&&!this._crossesViewportEdge("bottom",c)&&(n="bottom"),"bottom"===n&&this._crossesViewportEdge("bottom",c)&&!this._crossesViewportEdge("top",l)&&(n="top"),"bottom"===n?o.extend(s,{top:r.bottom,transform:"translateX(-50%)"}):"top"===n&&o.extend(s,{top:r.top,transform:"translateX(-50%) translateY(-100%)"}),u=t.realLeft+(r.center+r.left)-a/2,h=t.realLeft+(r.center+r.left)+a/2,this._crossesViewportEdge("left",u)&&!this._crossesViewportEdge("right",h)&&o.extend(s,{left:this._popoverBase.minDistanceFromContainer+"px",transform:"top"===n?"translateX(0) translateY(-100%)":"translateX(0)"}),!this._crossesViewportEdge("left",u)&&this._crossesViewportEdge("right",h)&&o.extend(s,{left:"auto",right:this._popoverBase.minDistanceFromContainer+"px",transform:"top"===n?"translateX(0) translateY(-100%)":"translateX(0)"})):"left"===n||"right"===n?(o.extend(s,{top:e.top-i.y}),r={left:e.left+t.scrollLeft-i.x,right:e.left+t.scrollLeft+e.width+i.x},u=t.realLeft+r.left-this.$el.width(),h=t.realLeft+r.right+this.$el.width(),"left"===n&&this._crossesViewportEdge("left",u)&&!this._crossesViewportEdge("right",h)&&(n="right"),"right"===n&&this._crossesViewportEdge("right",h)&&!this._crossesViewportEdge("left",u)&&(n="left"),"left"===n?o.extend(s,{left:r.left,transform:"translateX(-100%) translateY(-50%)"}):"right"===n&&o.extend(s,{left:r.right,transform:"translateY(-50%)"})):o.extend(s,{top:e.top-i.y,left:e.left+i.x,transform:""}),o.extend(s,{transform:s.transform}),this.$el.css(s),this.debug("reposition: ad-hoc css %O",s),this.$el.removeClass("top bottom left right").addClass(n)},_crossesViewportEdge:function(e,t){var i=s(window),n={top:i.scrollTop(),left:i.scrollLeft(),right:i.scrollLeft()+i.width(),bottom:i.scrollTop()+i.height()};return n=this._popoverBase.isFixedPosition?{top:0,left:0,right:i.width(),bottom:i.height()}:{top:i.scrollTop(),left:i.scrollLeft(),right:i.scrollLeft()+i.width(),bottom:i.scrollTop()+i.height()},this.debug("viewportCheck against %s side (%s) coordinate=[%s]",e,n[e],t),"top"===e?n.top>t:"bottom"===e?n.bottom<t:"left"===e?n.left>t:"right"===e?n.right<t:void 0},isRendered:function(){return this.rendered||this._rendered},isOrWasRecentlyRendered:function(e){o.isNumber(e)||(e=100);var t=this._popoverBase.lastAutoTeardown,i=o.now()-t;return e>i||this.isRendered()},setPinnedSide:function(e){return this._popoverBase.pinnedSide=e,this},setPinnedTarget:function(e){return this.$pinned=s(e).addClass("pinned-target"),this.debug("setPinnedTarget: %O",this.$pinned),this},setPopoverContainer:function(e){return this.$container=s(e),this.isContainerBody=this.$container.is(c),this.debug("setPopoverContainer: %O, isContainerBody=%s",this.$container,this.isContainerBody),this},setShift:function(e){if(!o.isObject(e)||!o.isNumber(e.x)||!o.isNumber(e.y))throw new Error("Popover shift needs to be: {Object} => x: {Number}, y: {Number}");return this._popoverBase.shift.x=e.x,this._popoverBase.shift.y=e.y,this},getShift:function(){return this._popoverBase.shift},_initializeDebugger:function(){this.debug=l?n(this):o.noop},defaults:{pinnedRect:function(){var e,t,i=this.$container.offset();e=this.$pinned.offset(),t=e,this._popoverBase.isFixedPosition&&(this.isContainerBody?e.top-=u.scrollTop():e.top-=this.$container.scrollTop());var n={};return n.height=this.$pinned.outerHeight(),n.width=this.$pinned.outerWidth(),n.top=Math.round(e.top-i.top),n.left=Math.round(t.left-i.left),n.bottom=Math.round(n.top+n.height),n.right=Math.round(n.left+n.width),this.debug("pinnedRect calculation: container %O, pinned %O, containerOffset %O, pinnedOffset %O",this.$container,this.$pinned,i,t),this.debug("pinnedRect results: height(pinnedOuterHeight)=%s, width(pinnedOuterWidth)=%s, top(pTop-cTop)=%s, left=(pLeft-cLeft)=%s, bottom(top+height)=%s, right(left+width)=%s",n.height,n.width,n.top,n.left,n.bottom,n.right),n},teardown:o.noop},after:{initialize:function(e){var t={identifier:"popover",pinnedSide:"bottom",className:"popover--base",autoTeardown:!0,teardownOnEscape:!0,minDistanceFromContainer:10,shift:{x:0,y:0},clickOutside:null,lastAutoTeardown:0,shouldTeardown:!0,isFixedPosition:!1};this._popoverBase=o.defaults(o.pick(e||{},o.keys(t)),t),this._initializeDebugger(),this.setPinnedTarget(e.pinnedTarget||null),this.setPopoverContainer(e.popoverContainer||c),this._popoverBase.autoTeardown&&this.listenTo(this,"rendered",this.setupAutoTeardown)},render:function(){this.$el.addClass(this._popoverBase.className),this.$el.appendTo(this.$container);var e=this.$el.children().first(),t=e.width();e.width(t-t%2),this.reposition(),this.isContainerBody&&(this.debug("DOMEventor subscribe: flatresize + flatscroll reposition active"),this.listenTo(a,"DOMEventor:flatresize",this.reposition),this._popoverBase.isFixedPosition||this.listenTo(a,"DOMEventor:flatscroll",this.reposition)),this._popoverBase.teardownOnEscape&&this.listenTo(a,"DOMEventor:keyup:escape",this.teardown),this.trigger("open",this),a.trigger(this._popoverBase.identifier+":open",this)},teardown:function(){this.$pinned.removeClass("pinned-target"),this._popoverBase.teardownOnEscape&&this.stopListening(a,"DOMEventor:keyup:escape"),this.removeAutoTeardown(),this.trigger("close",this),a.trigger(this._popoverBase.identifier+":close",this)}},before:{teardown:function(){this.$el.off("mousewheel DOMMouseScroll")}}});e.exports=d},function(e,t,i){"use strict";function n(e,t){this.options=s.extend({preventInteraction:!1,ignoreSelectors:[]},t),this._onClick=s.bind(this._onClick,this,e),document.addEventListener("click",this._onClick,!0)}var s=i(3),o=i(9),r=i(7);n.prototype._isForcedInsideTarget=function(e){return s.isEmpty(this.options.ignoreSelectors)?!1:!s.isEmpty(e.closest(this.options.ignoreSelectors.join(",")))},n.prototype._onClick=function(e,t){var i=o(t.target);e===t.target||o.contains(e,t.target)||this._isForcedInsideTarget(i)?this.trigger("click:inside",t):(this.trigger("click:outside"),this.options.preventInteraction&&(t.preventDefault(),t.stopPropagation()))},n.prototype.remove=function(){return document.removeEventListener("click",this._onClick,!0),this.off(),this},s.extend(n.prototype,r.Events),e.exports=n},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="pop-menu"><ul class="inner select-right"> ',_.forEach(channels,function(e){__p+=' <li class="item-option '+(null==(__t=e.name===tumblelog?"select":"")?"":_.escape(__t))+'" data-js-tumblelogchoice><img class="ts-avatar" src="'+(null==(__t=e.avatarUrl)?"":_.escape(__t))+'" alt="'+(null==(__t=e.name)?"":_.escape(__t))+'"><div class="ts-info"><p class="ts-name">'+(null==(__t=e.displayName)?"":_.escape(__t))+'</p><p class="ts-title">'+(null==(__t=e.directory_safe_title)?"":__t)+"</p></div></li> "}),__p+=" </ul></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(204),r=i(205),a=i(215),l=i(216),c=s.extend({className:"post-form--post-settings-button",events:{"click [data-js-clickablePostSettingsCog]":"togglePostSettingsDropdown"},mixins:[o,r],template:a,initialize:function(e){e=n.extend({},e,{shift:{x:0,y:10},identifier:"postForms:postSettingsDropdown"}),this.postSettingsDropdown=new l(e)},render:function(){return this.$el.html(this.template()),this.postSettingsDropdown.setPinnedTarget(this.js$("postSettingsCog")),this},togglePostSettingsDropdown:function(e){this.postSettingsDropdown.isOrWasRecentlyRendered()||this.postSettingsDropdown.render()}});e.exports=c},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<button class="post-settings" data-js-clickablepostsettingscog><span class="dropdown settings-icon" data-js-postsettingscog></span></button>';
return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(101),r=i(110),a=i(108),l=i(143),c=i(160),u=i(205),h=i(204),d=i(211),p=i(217),g=i(218),m=s.extend({className:"popover--post-settings-dropdown",defaults:{textFields:["customUrl","sourceUrl","postDate"],checkboxFields:["allowPhotoReplies","membersOnlyPost"],selectFields:["editorType"]},mixins:[c,u,h,d,p],template:g,initialize:function(e){this.options=e=n.extend({},e),n.extend(this,n.pick(e,["post","user","uploads"]))},render:function(){return this.$el.html(this.template(this.serialize())),this.setupTextInputFields(),this.setupCheckboxInputFields(),this.setupSelectFields(),this.delegateEvents(),r.trigger("postForms:dismissListener:suspend"),this},teardown:function(){return this.$el.remove(),r.trigger("postForms:dismissListener:resume"),this},serialize:function(){return n.extend({showEditorSelection:"chat"!==this.post.get("type"),showPhotoRepliesOption:!a.bool("disable_public_replies"),allowMembersOnlyPost:a.bool("labs_experiment_inside_blogs")},this.model.toJSON())},setupTextInputFields:function(){n.each(this.get("textFields"),function(e){var t=this["$"+e]=this.js$(e);return"sourceUrl"===e&&this.model.isReblog()?void t.attr("readonly",!0):(t.on("input",n.bind(function(){this.model.set(t.attr("name"),t.val())},this)),void t.on("keydown",n.bind(function(e){var t=e.which||e.keyCode;13===t&&this.teardown()},this)))},this)},setupCheckboxInputFields:function(){n.each(this.get("checkboxFields"),function(e){var t=this["$"+e]=this.js$(e),i=t.attr("name");t.prop("checked",!!this.model.get(i)),t.on("change",n.bind(function(){var s="_onChange"+n.camelCase("-"+e);n.isFunction(this[s])?this[s]():this.model.set(i,t.prop("checked"))},this))},this)},setupSelectFields:function(){n.each(this.get("selectFields"),function(e){var t=this["$"+e]=this.js$(e),i=t.attr("name");this.setUpSelector(t),t.children('[value="'+this.model.get(i)+'"]').attr("selected",!0),t.trigger("change"),t.on("change",n.bind(function(){var s="_onChange"+n.camelCase("-"+e);n.isFunction(this[s])?this[s]():this.model.set(i,t.val())},this))},this)},setupInputListeners:function(){var e=this.get("checkboxFields");n.each(this.get("inputSelectorNames"),function(t){var i=this["$"+t];i.on("change",n.bind(function(){var n=-1!==e.indexOf(t)?i.prop("checked"):i.val();this.model.set(i.attr("name"),n)},this))},this)},_onChangeEditorType:function(){var e=this.model.get("editorType"),t=this.js$("editorType").val();if(!e)return void this.model.set("editorType",this.user.get("defaultEditorType")||"rich");if(e!==t)if("rich"!==e&&"rich"===t&&this.model.get("htmlEdited")){var i={text:o("%1$sGoing back to normal?%2$sYou might lose any code that doesn't get along with our text editor.%3$s","<h3>","</h3><small>","</small>"),keycommand_maintain:!0};l.confirm(i,n.bind(function(){this.js$("editorType").blur(),this.model.set({htmlEdited:!1,editorType:t}),this._delayedClose()},this))}else n.defer(n.bind(function(){this.model.set("editorType",t)},this)),this._delayedClose()},_delayedClose:function(e){n.isNumber(e)||(e=50),n.delay(n.bind(function(){this.teardown()},this),e)}});e.exports=m},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(116),r=new o({setUpSelector:function(e){e.on("change",s.bind(this.__select_change,this))},__select_change:function(e){var t=n(e.currentTarget);this.__update_select(t)},__update_select:function(e){var t=e.siblings("label");t.text(e.find(":selected").text())}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="pop-menu"><div class="inner"><div class="form-horizontal"><div class="form-group"><div class="group-label"><label for="customUrl_input">'+(null==(__t=__("Custom URL"))?"":_.escape(__t))+'</label></div><div class="group-content"><div class="adjacent-content"><label for="customUrl_input" class="prefix" data-js-customurllabel>/post/123/</label><input name="customUrl" id="customUrl_input" class="field crystal" type="text" autocomplete="off" data-js-customurl value="'+(null==(__t=customUrl)?"":_.escape(__t))+'"></div></div></div><div class="form-group"><div class="group-label"><label for="sourceUrl_input">'+(null==(__t=__("Content source"))?"":_.escape(__t))+'</label></div><div class="group-content"><input id="sourceUrl_input" name="sourceUrl" class="field crystal" type="text" placeholder="http://..." autocomplete="off" data-js-sourceurl value="'+(null==(__t=sourceUrl)?"":_.escape(__t))+'"></div></div><div class="form-group"><div class="group-label"><label for="postDate_input">'+(null==(__t=__("Post date"))?"":_.escape(__t))+'</label></div><div class="group-content"><input id="postDate_input" name="postDate" class="field crystal" type="text" placeholder="'+(null==(__t=__("Now"))?"":_.escape(__t))+'" autocomplete="off" data-js-postdate value="'+(null==(__t=postDate)?"":_.escape(__t))+'"></div></div> ',showPhotoRepliesOption&&(__p+=' <div class="form-group"><div class="group-label">'+(null==(__t=__("Replies"))?"":_.escape(__t))+'</div><div class="group-content"><div class="checkbox field row"><label class="binary_switch"><input name="allow_photo_replies" type="checkbox" id="allowPhotoReplies" type="checkbox" data-js-allowphotoreplies> <span class="binary_switch_track"></span><span class="binary_switch_button"></span></label><label for="allowPhotoReplies">'+(null==(__t=__("Let people photo reply"))?"":_.escape(__t))+"</label></div></div></div> "),__p+=" ",allowMembersOnlyPost&&(__p+=' <div class="form-group"><div class="group-label">'+(null==(__t=__("Members Only"))?"":_.escape(__t))+'</div><div class="group-content"><div class="checkbox field row"><label class="binary_switch"><input name="members_only" type="checkbox" id="membersOnlyPost" type="checkbox" data-js-membersonlypost> <span class="binary_switch_track"></span><span class="binary_switch_button"></span></label><label for="membersOnlyPost">'+(null==(__t=__("Visible to Blog Members Only"))?"":_.escape(__t))+"</label></div></div></div> "),__p+=" ",showEditorSelection&&(__p+=' <div class="form-group"><div class="group-label">'+(null==(__t=__("Text editor"))?"":_.escape(__t))+'</div><div class="group-content"><div class="flat_select field row"><select name="editorType" id="editorType" data-js-editortype><option value="rich">'+(null==(__t=__("Rich text"))?"":_.escape(__t))+'</option><option value="html">'+(null==(__t=__("HTML"))?"":_.escape(__t))+'</option><option value="markdown">'+(null==(__t=__("Markdown"))?"":_.escape(__t))+'</option></select><label for="editorType" class="current_selection">'+(null==(__t=__("Rich text"))?"":_.escape(__t))+'</label><i class="icon"></i></div></div></div> '),__p+=" </div></div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(101),a=i(160),l=i(204),c=i(205),u=i(220),h=i(240),d=i(243),p=i(244),g=i(245),m=o.extend({className:"post-form--tag-editor",defaults:{maxTagLength:140,suggestMinLength:2,showSuggestPopover:!1,editorHistory:[],sortableTags:null,currentlySelectedTags:[],tagEntryPlaceholder:".tag-input-wrapper .editor-plaintext",currentTag:null},mixins:[a,l,c],template:p,events:{click:"focusOnTagEditor"},initialize:function(e){this.options=e=n.pick(e,"post","user","model"),n.extend(this,n.pick(e,"post","user")),this.placeholder=r("#tags")},addTagProperties:function(e,t){this.listenTo(e,"toggleTagSelection",this.toggleTagSelection),this.listenTo(e,"addHoverStyle",this.addHoverStyle),this.listenTo(e,"removeHoverStyle",this.removeHoverStyle),e.el.draggable=!0,this.subViews["tagLabel_"+t]=e,this.tagLabelViews.push(e)},createSubViews:function(){var e=n.extend({placeholder:this.model.get("tags").length>0?!1:this.placeholder,name:"tagInput",forceSingleLine:!0,onClientEvent:n.bind(this.handleInputKeys,this),ariaLabel:r("Post tags")},this.options),t={post:this.post,user:this.user,shift:{x:0,y:15},identifier:"postForms:tagSuggest"};this.tagInput=this.subViews.tagInputField=new u(e),this.tagSuggest=new h(t),this.tagLabelViews=[],n.forEach(this.post.get("tags"),function(e){var t=new g({label:e});this.addTagProperties(t,e)},this),this.makeTagsSortable()},attachSubViews:function(e){return this.attachSubView(this.tagInput,"tagInputField"),n.forEach(this.tagLabelViews,function(e){this.js$("tagInputFieldWrapper").before(e.$el)},this),this},beforeRender:function(){this.createSubViews(),this.addTagEditorListeners()},render:function(){return this.$el.html(this.template()),this.attachSubViews(),this},afterRender:function(){this.renderSubViews(),this.tagSuggest.setPinnedTarget(this.js$("tagInputGhost")),s(this.tagInput.editor.element).on("blur",n.bind(this.submitTag,this))},teardown:function(){return this.stopListening(),this.tagLabelViews=[],this.set("sortableTags",null),this.set("currentlySelectedTags",[]),this},makeTagsSortable:function(){this.set("sortableTags",new d({el:this.el,itemSelector:".tag-label",dropInParent:!0,afterDragEnd:n.bind(this.saveTagOrder,this),transparentPlaceholder:!0,scrollable:!1})).on("dragstart",this.selectCurrentTag,this)},selectCurrentTag:function(e){this.set("currentlySelectedTags",[]),this.$(".tag-label").removeClass("selected"),this.set("currentTag",this.$(".sortable-dragging").text())},getTagOrder:function(){return n.map(this.$(".tag-label"),function(e){return s(e).text()})},setTagOrder:function(e){e||(e=this.getTagOrder()),n.forEach(this.tagLabelViews,function(e){this.stopListening(e)},this),this.removeTags(),this.removePlaceholder();for(var t=0;t<e.length;t++)this.addTag(e[t]);this.post.set("tags",e)},saveTagOrder:function(){if(this.post.get("tags").length<=1)return!1;var e=this.getTagOrder();return n.isEqual(e,this.post.get("tags"))||this.setTagOrder(e),!0},addTagEditorListeners:function(){this.listenTo(this.model,"change:tagInput",this.handleTagInput),this.listenTo(this.tagInput,"tagInput:submitTag",this.submitTag),this.listenTo(this.tagSuggest,"tagSuggest:submitTag",this.submitTag),this.listenTo(this.tagInput,"tagInput:backspace",this.handleBackspace),this.tagSuggest.listenTo(this,"tagEditor:fetchSuggestions",this.tagSuggest.fetchSuggestions),this.tagSuggest.listenTo(this.tagInput,"tagInput:cycleUp",this.tagSuggest.cycleUp),this.tagSuggest.listenTo(this.tagInput,"tagInput:cycleDown",this.tagSuggest.cycleDown),this.tagSuggest.listenTo(this.tagInput,"tagInput:dismissSuggestions",this.tagSuggest.dismiss)},handleInputKeys:function(e){var t,i=["keyup","keydown","keypress"],n={keydown:{38:"tagInput:cycleUp",40:"tagInput:cycleDown",8:"tagInput:backspace",9:"tagInput:submitTag",13:"tagInput:submitTag"},keypress:{44:"tagInput:submitTag"}};if(-1!==i.indexOf(e.type))if(e=e||window.event,t=e.which||e.keyCode,"keydown"===e.type||"keypress"===e.type)if(t in n[e.type]){this.tagInput.trigger(n[e.type][t],e);var s=/Mac/.test(navigator.platform)?e.metaKey:e.ctrlKey;8===t||13===t&&s||(e.preventDefault(),e.stopImmediatePropagation())}else this.tagInput.getEditorValue().length>=this.get("maxTagLength")&&(e.preventDefault(),e.stopImmediatePropagation());else if(t in n.keypress||t in n.keydown&&8!==t)return!1},handleTagInput:function(e,t){var i=t&&t.length>=this.get("suggestMinLength");i?this.trigger("tagEditor:fetchSuggestions",t,this._postTags()):this.tagInput.trigger("tagInput:dismissSuggestions"),this.js$("tagInputGhost").text(t)},handleBackspace:function(){if(0===this.tagInput.getEditorValue().length){var e=this.get("currentlySelectedTags");e.length>0?(n.forEach(e,function(e){this.removeTag(e)},this),this.set("currentlySelectedTags",[]),this.$(this.get("tagEntryPlaceholder")).removeClass("tiny-width")):this._postTags().length&&this.removeTag()}},submitTag:function(e){if(e&&"blur"===e.type){if(this._postTags().length||this.tagInput.editor.setPlaceholder(this.placeholder),this.tagSuggest.get("interactive"))return}else this.tagInput.editor.setPlaceholder(!1);var t=this.tagSuggest.get("interactive")?this.tagSuggest.getCycledTag():this.tagInput.getEditorValue();if(""===t)return void this.trigger("postForms:focusOnNextEditor",e);t=t.toString().replace(/[,#]/g,""),t.match(/<.*>/)&&(t=t.replace(/[<>]/g,function(e){return n.escape(e)}));var i=t.match(/"/g),s=i?i.length:0;if(s%2===1){var o=t.lastIndexOf('"');t=t.replace(/"/g,function(e,t){return t===o?'"':""})}else s>0&&(t=t.replace(/"/g,""));t=t.trim().substr(0,this.get("maxTagLength")),this.clearInput();var r=this.addTag(t);if(r){var a=e?e.which||e.keyCode:!1;if(a===!1||"focusout"!==e.type&&(9!==a||!e.shiftKey))return this.tagInput.focus(),!1}},addTag:function(e){if(e&&!n.contains(this._postTags(!0),e.toLowerCase())){this.post.get("tags").push(e);var t=new g({label:e});return this.addTagProperties(t,e),this.js$("tagInputFieldWrapper").before(t.render().$el),this.removePlaceholder(),!0}return!1},removeTag:function(e){if(e||(e=n.last(this.post.get("tags"))),!e)return!1;var t=n.without(this._postTags(),e);n.isEmpty(t)&&(this.setPlaceholder(this.placeholder),this.tagInput.editor.setPlaceholder(this.placeholder)),this.model.set("tags",t);var i=this.subViews["tagLabel_"+e];return i&&(i.remove(),this.subViews["tagLabel_"+e]=null,n.remove(this.tagLabelViews,function(e){return i===e})),!0},removeTags:function(){n.each(this.model.get("tags"),function(e){this.removeTag(e)},this),this.setPlaceholder(this.placeholder)},clearInput:function(){this.tagInput.trigger("tagInput:dismissSuggestions"),this.tagInput.setEditorValue("")},removePlaceholder:function(){this.setPlaceholder(null),this.$(this.get("tagEntryPlaceholder")).addClass("tiny-width")},setPlaceholder:function(e){this.tagInput.editor.setPlaceholder(e),this.$(this.get("tagEntryPlaceholder")).removeClass("tiny-width")},_postTags:function(e){return e?n.map(this.model.get("tags"),function(e){return e.toLowerCase()}):n.clone(this.model.get("tags"))},focusOnTagEditor:function(e){this.subViews.tagInputField.focus()},toggleTagSelection:function(e){var t=s(e.target),i=s(e.target).text(),n=this.get("currentlySelectedTags"),o=n.indexOf(i),r=/Mac/.test(navigator.platform)?e.metaKey:e.ctrlKey;r?0>o?(n.push(i),this.set("currentlySelectedTags",n),t.addClass("selected")):(n.splice(o,1),this.set("currentlySelectedTags",n),t.removeClass("selected"),t.removeClass("hover-style")):0>o||n.length>1?(this.set("currentlySelectedTags",[i]),this.$(".tag-label").removeClass("selected"),t.addClass("selected")):(this.unselectAllTags(),t.removeClass("hover-style"))},addHoverStyle:function(e){this.get("currentTag")&&e.label!==this.get("currentTag")||this.$(e.eventTarget).addClass("hover-style")},removeHoverStyle:function(e){this.$(".tag-label").removeClass("hover-style"),this.set("currentTag",null)},unselectAllTags:function(e){this.set("currentlySelectedTags",[]),this.$(".tag-label").removeClass("selected")}});e.exports=m},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(110),a=i(221),l=i(204),c=i(205),u=i(160),h=i(239),d=o.extend({defaults:{placeholder:"",name:"",syncWithModel:!0,forceSingleLine:!1,smartQuotesEnabled:!1},events:{},mixins:[u,l,c],template:h,initialize:function(e){this.set(e),this.onChange=e.onChange||n.noop,this.onClientEvent=e.onClientEvent||n.noop,this.pasteHook=e.pasteHook||n.noop,this.smartQuotesEnabled=e.smartQuotesEnabled,this.disableEdit=e.disableEdit||!1;var t=this.get("name");t&&this.get("syncWithModel")&&this.$el.attr("data-name",t)},_initializeEditor:function(e,t){var i={placeholder:t,onChange:this._composeOnChange(),onClientEvent:this._composeOnClientEvent(),pasteHook:this.pasteHook,runIFrameSanitization:!0,forceSingleLine:this.get("forceSingleLine"),filterRules:{elements:["p","br"],attributes:{},remove_contents:["style","noscript","script","meta"],protocols:{}},smartQuotes:{enabled:this.smartQuotesEnabled}};this.editor=new a.PlainTextEditor(e,i),this.disableEdit&&this.disable()},_composeOnChange:function(){var e=[this.onChange],t=this;return this.get("syncWithModel")&&e.unshift(this.updateModelFromEditor),function(i){n.each(e,function(e){e.call(t,i)})}},_composeOnClientEvent:function(){var e=this.onClientEvent,t=this;return function(i){r.trigger("plainTextEditor:onClientEvent",i,t.editor),e.call(this,i)}},render:function(){this.$el.html(this.template({ariaLabel:this.get("ariaLabel")}));var e=this.js$("plainTextEditor").get(0);if(this._initializeEditor(e,this.get("placeholder")),this.get("syncWithModel")){var t=this._modelValue().length>0;t&&this.set("placeholder",!1),this.updateEditorFromModel()}return this},teardown:function(){return this.$el.empty(),delete this.editor,this},serialize:function(){return this.toJSON()},getEditorValue:function(e){return"undefined"!=typeof e||(e=!0),this.editor?this.editor.getData(e):null},setEditorValue:function(e){this.editor&&this.editor.setData(e)},updateModelFromEditor:function(){if(!this.editor)return!1;var e=this.get("name"),t=this.getEditorValue();""!==t?s(this.editor.element).addClass("has-text"):s(this.editor.element).removeClass("has-text"),this.model.get(e)!==t&&this.model.set(e,t)},updateEditorFromModel:function(){var e=this.getEditorValue(),t=this._modelValue();t.trim()&&t.trim()!==e.trim()&&this.setEditorValue(t)},_modelValue:function(){return this.model.get(this.get("name"))||""},focus:function(e){this.editor&&this.editor.focus(e)},blur:function(){this.editor&&this.editor.element.blur()},setCursorToEnd:function(){this.editor&&n.isFunction(this.editor.setCursorToEnd)&&this.editor.setCursorToEnd()},enable:function(){s(this.editor.element).attr("contenteditable",!0)},disable:function(){s(this.editor.element).removeAttr("contenteditable")}});e.exports=d},function(e,t,i){var n=i(3),s=i(222);e.exports=n.extend(s,{RichTextEditor:i(223),PlainTextEditor:i(238),SelectionContext:i(232),SelectionPersistence:i(226),Utils:i(225),HumanKeys:i(237)})},function(e,t){var i={debugMode:!1};e.exports=i},function(e,t,i){var n=i(3),s=i(9),o=i(165).animate,r=i(224),a=i(229),l=i(230),c=i(226),u=i(232),h=i(233),d=i(225),p=i(234),g=i(235),m=i(236),f=i(237),v=(window.URL||window.webkitURL||window.mozURL||window.msURL||{}).createObjectURL,_=i(228),b=function(){function e(e,t){return n.mapValues(e,function(e,t){return t.match(/^on[A-Z]/)&&n.isFunction(e)?n.bind(e,this):e},t)}function t(){N.call(this,ue);var e=s("<div />",{"data-js":"editor-wrapper","class":"editor-wrapper"}).css("position","relative"),t=s("<div />",{"data-js":"editor-slot","class":"editor-slot"}).css("position","relative");s(this.element).wrap(e).wrap(t),t=s(this.element).parent(),this.wrapper=t.parent().get(0),this.placeholderElement=s("<div />",{"data-js":"editor-placeholder","class":"editor-placeholder"}).css("position","absolute"),t.append(this.contextualControls.element),t.append(this.linkControl.element),t.append(this.placeholderElement),t.append(this.inlineControls.element),O.call(this),this.controlBar=s("<div />",{"data-js":"control-bar","class":"control-bar disabled"});var o=s("<div />",{"class":"static-controls control"});this.controlBar.append(o),this.controlBar.append(this.staticControls.element);var r=this;o.on("mousedown",function(e){e.preventDefault(),e.stopPropagation();var t=u.getNodeList();r.staticControls.setActives(n.pluck(t,"nodeName"));var i=s(this).position();return r.staticControls.isShown?r.staticControls.hide():r.staticControls.open(i.left+s(this).width()/2,0),r.contextualControls.hide(),r.linkControl.close(),!1}),this.config.showStaticControls&&s(this.wrapper).append(this.controlBar),i.call(this),S.call(this)}function i(){var e=this,t=function(){var t=e.inlineControls.isTrayOpen||e.contextualControls.isShown||e.staticControls.isShown||e.linkControl.isShown;return t};s(this.element).on("input keydown keyup keypress mousedown mouseup",function(t){e.controlBar.removeClass("disabled"),e.config.onClientEvent.call(e,t)});var i=function(){P.call(this),this.onChange()};s(this.element).on("keydown",function(i){if(i.keyCode===_e.shift)e.keyModifiers.shift=!0;else{if(i.keyCode===_e.esc)return void(t()&&(e.contextualControls.hide(),e.staticControls.hide(),e.inlineControls.isTrayOpen&&e.inlineControls.toggleTrayWithIntent(!1),i.stopPropagation()));i.keyCode===_e.backspace?(C.call(e,i),W.call(e)):i.keyCode===_e.enter&&(y.call(e,i),w.call(e,i),d.browser.safari&&i.shiftKey&&(i.preventDefault(),b.call(e)))}F.call(e,i),P.call(e,i)}),s(this.element).on("keyup",function(t){t.keyCode===_e.shift?e.keyModifiers.shift=!1:t.keyCode===_e.enter?W.call(e):t.keyCode!==_e.backspace&&t.keyCode!==_e["delete"]||(D.call(e),n.defer(function(){x.call(e)}));var s=!1;t.keyCode===_e.right&&!t.shiftKey&&e.inlineControls&&(s=e.inlineControls.isShown),t.keyCode===_e.esc||s||i.call(e)}),s(this.element).on("input",function(){i.call(e)});var o=!1;s(this.element).on("mouseup",function(){o=!1,P.call(e)}),s(this.element).on("mousedown",function(e){o=!0}),document.addEventListener("mousedown",function(t){var i=function(){o=!1,k.call(e),e.controlBar.addClass("disabled")};e.wrapper===t.target||s.contains(e.wrapper,t.target)||e.config.documentMousedownHook(t,i)||i()},!0),document.addEventListener("mouseup",function(t){o&&(P.call(e),o=!1)},!0),s(this.element).on("focus",function(){if(e.controlBar.removeClass("disabled"),!U.call(e)){var t=s(e.element).children(de.join());if(t.length){var i=t.first().get(0);c.setToStart(i)}}n.defer(function(){e.onChange()})}),s(this.element).on("blur",function(i){var s=function(i){if(!t()){var s=u.getSelection();s&&u.isInContext(s,e.element)&&s.removeAllRanges(),e.lastSelection=null,P.call(e,function(){e.onChange(),n.isFunction(i)&&i()})}};e.config.blurHook(i,s)||n.defer(s)}),s(this.element).on("paste",function(t){var i=(t.originalEvent||t).clipboardData;i&&(e.config.pasteHook(i,e.keyModifiers.shift)||j.call(e,i),B.call(e),t.preventDefault())}),s(this.element).on("cut",function(t){e.contextualControls.hide(),e.staticControls.hide(),e.linkControl.close(),n.defer(function(){x.call(e),B.call(e),e.onChange()})})}function b(){for(var e=U.call(this),t=n.contains(ge,e.nodeName)?"\n":"<br>",i=u.isCursorAtEnd(e)&&!u.isCursorAtStart(e)?1:0,s=0;i>s;s++)t+=t;q.call(this,t)}function w(e){var t,i,o=u.getNodeByNames(ge);o&&!this.keyModifiers.shift&&u.isCursorAtEnd(o)&&(i=s(o),t=i.text(),e.preventDefault(),t.match(/\n\n$/)?(n.last(i.contents()).remove(),this.insertNewParagraphAfter(o)):(i.append("\n\n"),c.setToEnd(o)))}function y(e){var t=u.getNodeByNames(["BLOCKQUOTE"]);if(t&&!this.keyModifiers.shift&&u.isCursorAtEnd(t,!0)){var i="P"===t.lastElementChild.nodeName?t.lastChild:null;i&&i.previousSibling&&this.dataFilter.isEmptyElement(i,!0)&&(e.preventDefault(),s(i).remove(),this.insertNewParagraphAfter(t))}}function k(){this.contextualControls.hide(),this.staticControls.hide(),this.linkControl.close(),this.inlineControls.close()}function x(){if(!s(this.element).has(ve.join()).length){var e=s(this.element).find("ul:not(:has(li)),ol:not(:has(li))");e.remove();var t=n.some(s(this.element).children().toArray(),function(e){return e.textContent.length>0});t||(N.call(this,""),W.call(this),O.call(this))}}function C(e){var t=u.getSelection();if(t.isCollapsed){var i=U.call(this);if(i&&!(c.saveSelection(i).start>0)){var n=s(i).prev().get(0);n&&ae.call(this,n)&&(s(n).remove(),e.preventDefault())}}}function S(){var e=this,t=s(e.element).offset().top,i=null,o="dragstart dragenter dragleave dragover dragend drop",r=!1,a=function(e){var t=e.dataTransfer.types&&n.some(e.dataTransfer.types,function(e){return"Files"===e});return t},l=function(e){return"false"===s(e.target||e.srcElement).attr("contenteditable")},c=function(t,i,s){t.length&&(e.onChange(),n.each(t,function(t){e.config.onFileAdded.call(e,t,i,s)}),P.call(e))},u=function(e,t){return e<t.top+.66*t.height},h=function(e,i){var n=s(i).offset().top-t,o=s(i).get(0).getBoundingClientRect().height,r=e>n+.66*o;return{element:i,top:n,bottom:n+o,height:o,isAfter:r}},d=function(){s(e.element).find(".over-top, .over-bottom").each(function(){s(this).removeClass("over-top").removeClass("over-bottom"),""===s(this).attr("class").trim()&&s(this).removeAttr("class")})},p=function(n){var o=null,r=n.pageY-t,a=s(e.element).children();i&&r>i.top&&u(r,i)||(a.each(function(){var e=h(r,this);return u(r,e)&&(n.target||n.srcElement)!==this?(o=e,!1):void 0}),o||(o=h(r,a.last().get(0)),o.isAfter=!0),o&&i&&i.element===o.element&&i.isAfter===o.isAfter||(d(),i=o))};s(e.element).unbind(o),s(e.element).on("dragleave",function(e){d()}),s(e.element).on("dragover",function(e){return r?(n.debounce(p,100)(e.originalEvent),i&&(s(i.element).addClass(i.isAfter?"over-bottom":"over-top"),a(e.originalEvent)&&e.stopPropagation()),void e.preventDefault()):(e.preventDefault(),void e.stopPropagation())}),s(e.element).on("dragenter",function(e){e.preventDefault(),a(e.originalEvent)&&(r="file")}),s(e.element).on("dragstart",function(t){if(k.call(e),l(t.originalEvent)){r="media";var i=t.originalEvent.target||t.originalEvent.srcElement,o=t.originalEvent.dataTransfer;if(o){o.effectAllowed="move",o.dropEffect="move";try{var a=s(i).find("img").attr("src")||"";a.match(/^\s*data:/)&&(a=""),o.setData("text/uri-list",a),o.setData("text/plain",a)}catch(t){}}n.defer(function(){s(i).addClass("dragging")})}}),s(e.element).on("drop",function(e){d(),a(e.originalEvent)&&c(e.originalEvent.dataTransfer.files,i.element,i.isAfter?1:-1),e.stopPropagation(),e.preventDefault()}),s(e.element).on("dragend",function(t){if(l(t.originalEvent)){d();var n=t.originalEvent.target||t.originalEvent.srcElement,o=s(n).data("origHeight"),a=n;if(i&&a!==i.element){var c=s(n).remove();i.isAfter?s(i.element).after(c):s(i.element).before(c),ne.call(e,c)}s(a).animate({height:o},200,function(){s(a).removeClass("dragging")}),e.onChange(),P.call(e)}r=!1})}function E(e,t,i){var n=s(this.element),o=c.saveSelection(this.element);n.find(i).wrap("<"+t+">"),n.find(i).contents().unwrap(),c.restoreSelection(o),window.document.execCommand(e),n.find(t).wrap("<"+i+">"),n.find(t).contents().unwrap(),c.restoreSelection(o)}function T(e,t,i){var o=this,r=function(){window.document.execCommand(e),o.config.flattenBlocks&&$.call(o)},a=function(){var e=c.saveSelection(o.element),t=200,n=240;!i||i.isAnimating||e.selection.isCollapsed||setTimeout(function(){s(o.linkControl.linkEditInput).focus();var r=function(i,n){var r=i-s(o.wrapper).offset().left,a=n-s(o.wrapper).offset().top;o.linkControl.size(t),o.linkControl.show(r,a),o.linkControl.createLink(e)};i.closeWithShim(i.element.find(".link").get(0),t,n,r),e.selection.removeAllRanges(),o.blur(!0)},30)},l=function(e){var t=c.saveSelection(o.element),i=u.getRootElements();switch(n.each(pe,function(e){var t=u.getNodesByNames(i,[e]);t.length&&A.call(o,"formatBlock",e)}),L.call(o),e.toLowerCase()){case"blockquote":i=u.getRootElements();var r=[],a=[];i=n.each(i,function(e){n.contains(fe,e.nodeName.toUpperCase())?a.push(e):(r.push(a),a=[])}),a.length&&r.push(a),n.each(r,function(t){s(t).wrapAll(document.createElement(e))});break;case"pre":window.document.execCommand("formatBlock",!1,"<"+e+">"),R.call(this);break;default:window.document.execCommand("formatBlock",!1,"<"+e+">")}c.restoreSelection(t)},h=function(){var e=o.contextualControls.controls,t=o.contextualControls.getActiveStates();n.each(t,function(t,i){var n=e[i];t&&A.call(o,n.command,n.el)}),window.document.execCommand("removeFormat")};switch(e){case"formatBlock":l(t);break;case"createLink":a();break;case"insertOrderedList":r();break;case"insertUnorderedList":r();break;case"removeFormat":h();break;case"insertHTML":E.call(this,"underline","U",t);break;default:window.document.execCommand(e)}P.call(this),D.call(this),o.onChange()}function A(e,t){var i=this;switch(e){case"formatBlock":var o=c.saveSelection(this.element);L.call(i),n.each(u.getRootElements(),function(e){i.dataFilter.unBlock(e),"pre"===e.nodeName.toLowerCase()&&(e.innerHTML=e.innerHTML.replace("\n","<br>"));var t=e.nodeName.toUpperCase();if(n.contains(pe,t)){var o=s(e).contents();s(o).wrapAll("<p>"),s(e.firstChild).unwrap()}}),c.restoreSelection(o);break;case"insertOrderedList":L.call(this);break;case"insertUnorderedList":L.call(this);break;case"createLink":window.document.execCommand("unlink");break;case"insertHTML":E.call(this,"underline","U",t);break;default:window.document.execCommand(e)}D.call(this),P.call(this),this.onChange()}function F(e){var t=function(){var e=u.getNodeByNames(["UL","OL"]);return!!e};e.keyCode===_e.tab&&t()&&(e.preventDefault(),e.stopPropagation(),e.shiftKey?(T.call(this,"outdent"),t()||T.call(this,"formatBlock","p")):T.call(this,"indent"))}function R(){var e=u.getNodeByNames(ge);e&&s(e).find("br").replaceWith("\n")}function L(){var e=u.getNodeByNames(me);if(e){do window.document.execCommand("outdent");while(u.getNodeByNames(me));u.getNodeByNames(["H2"])||window.document.execCommand("formatBlock",!1,"<p>"),this.dataFilter.blockifyInlineNodes(this.element)}}function $(){var e=c.saveSelection(this.element),t=u.getNodeList(null,!0);this.dataFilter.unwrapParentBlocks(t),c.restoreSelection(e)}function D(){var e=c.saveSelection(this.element),t=u.getNodeList(),i=this.dataFilter.scrubSpansAndBadAttrs(t);i&&e.end>e.start&&c.restoreSelection(e)}function P(e){var t=this;setTimeout(function(){var i=u.getSelection();return i?(i.isCollapsed?M.call(t,i):I.call(t,i),ee.call(t),H.call(t),t.config.onSelection.call(t,i),u.isInContext(i,t.element)&&(t.lastSelection=c.saveSelection(t.element)),B.call(t),O.call(t),void(n.isFunction(e)&&e())):(ee.call(t),void(n.isFunction(e)&&e()))},20)}function I(e){if(u.isInContext(e,this.element)){var t=u.getContextCoordinates(s(this.element).parent().parent()),i=u.getNodeList(e);this.contextualControls.setActives(n.pluck(i,"nodeName")),this.staticControls.setActives(n.pluck(i,"nodeName")),this.linkControl.close(),this.inlineControls.close(),""!==e.toString().trim()&&t&&!this.staticControls.isShown&&this.contextualControls.open(t.x,t.y)}}function M(e){this.contextualControls.hide();var t=u.getNodeList(e),i=n.find(t,function(e){return"A"===e.nodeName});if(this.linkControl.isValidLink(i)){var o=u.getContextCoordinates(s(this.element).parent().parent(),i);this.linkControl.showOptions(i),this.linkControl.showOverTarget(o.x,o.y)}else this.linkControl.close();this.staticControls.setActives(n.pluck(t,"nodeName"))}function B(){var e=u.getSelection(),t=e&&e.isCollapsed;if(!t||!u.isInContext(e,this.element))return void this.inlineControls.close();var i=U.call(this);if(i&&"P"===i.nodeName&&this.dataFilter.isEmptyElement(i)&&!this.isEmpty())this.inlineControls.open(i);else if(this.isEmpty()){this.inlineControls.open(i);var n=d.calcTextWidth(this.placeholderElement,this.config.placeholder);this.inlineControls.open(i,n)}else this.inlineControls.close()}function O(){var e=this.isEmpty()?this.config.placeholder:"",t=s(this.placeholderElement);t.html(e);var i=t.outerHeight();i&&s(this.element).css("min-height",Math.max(parseInt(t.css("min-height"),10)||0,i))}function j(e){var t="";if(e.items&&e.items.length){var i=n.find(e.items,function(e){return/image\/\w+/.test(e.type)});if(i){var o=i.getAsFile();if(o)return void this.config.onFileAdded.call(this,o)}}n.contains(e.types,"text/html")?t=e.getData("text/html"):(t=e.getData("text/plain"),t=this.dataFilter.filterPlaintext(t,!0)),t=t.replace(new RegExp("</t(d|h)></tr>","g"),"<br></td></tr>"),t=t.replace(/\u00a0/g," "),t=this.dataFilter.filterHTML(t),t=this.dataFilter.convertToBrowserSpaces(t);var r=document.createElement("div");r.innerHTML=t,this.dataFilter.flattenBlocksDown(r,!0),s(r).find(ve.join()).remove();var a=n.some(r.children,function(e){return n.contains(de,e.nodeName)});if(a){var l=u.getSelection(),c=l.getRangeAt(0);c.deleteContents();var h=U.call(this);if(""===s(h).text().trim()){var d=s(h).index(),p=s(h).parent(),g=d+r.children.length-1;s(h).replaceWith(r.children);var m=s(p).children().eq(g).get(0);c.selectNodeContents(m),c.collapse(!1),l.removeAllRanges(),l.addRange(c)}else this.dataFilter.inlinify(r),q.call(this,r.innerHTML)}else q.call(this,r.innerHTML);this.onChange()}function N(e){s(this.element).html(e);
}function V(){return s(this.element).html().trim()}function q(e){if(!e)return void _.warn("Cannot insert empty data");var t=u.getSelection();if(!t||!t.focusNode)return void _.warn("Cannot insert without the editor having a cursor or selection");var i=t.getRangeAt(0);i.deleteContents(),e=this.dataFilter.convertToBrowserSpaces(e);var n=document.createElement("div");n.innerHTML=e;for(var s,o=n.lastChild,r=document.createDocumentFragment();s=n.firstChild;)r.appendChild(s);i.insertNode(r),i.setStartAfter(o),i.collapse(!1),t.removeAllRanges(),t.addRange(i)}function z(){var e=U.call(this);if(!e){var t=s(this.element).children(de.join());if(!t.length)return null;e=t.last().get(0)}return e}function U(){var e=u.getSelection()||this.lastSelection;return u.getNodeByNames(de,!0,e)}function W(){var e=z.call(this);if(e){if("div"===e.nodeName.toLowerCase())try{window.document.execCommand("formatBlock",!1,"<p>")}catch(t){}}else N.call(this,ue),this.setCursorToStart()}function H(){var e=s(this.element).children(fe.join()).last().get(0);e||s(this.element).append(ue)}function G(e,t,i,o,r){var a=this,l=function(e){var l,c,u,h,d=n.uniqueId(),p=0===e.lastIndexOf("data:",0)?"file":e;a.mediaTracker[d]={originalSource:p,file:t},c=s("<img />",{src:e}),l=c.get(0),h=s("<figure />"),u=h.get(0),c.attr(a.config.imgKeyAttr,d),h.append(c),X.call(a,u,i,o,r),Y.call(a,l,function(i){K.call(a,l,i),a.config.onAsyncImageAdded.call(a,d,e,t,i||{})}),a.onChange()};if(!e&&t)if(v)l(v(t));else{var c=new FileReader;c.onload=function(e){l(e.target.result)},c.readAsDataURL(t)}else{if("string"!=typeof e)return void a.config.onAsyncImageFailed.call(a);l(e)}}function K(e,t){var i,o={},r=this.config,a=s(e).parent("figure").get(0),l={toImg:e,toImgParent:a};r.addImgAttrs&&(i=n.reduce(l,function(e,t,i){return r.addImgAttrs!==!0&&r.addImgAttrs[i]!==!0||e.push(t),e},[])),n.isEmpty(i)||!r.imgSizeAttrs||n.isEmpty(t)||(r.imgSizeAttrs.height&&(o[r.imgSizeAttrs.height]=t.height),r.imgSizeAttrs.height&&(o[r.imgSizeAttrs.width]=t.width),s(i).attr(o))}function Y(e,t){var i=function(e){var i={width:e.naturalWidth,height:e.naturalHeight};n.isFunction(t)&&t.call(this,i)};e.complete?i.call(this,e):s(e).one({"load.getImageAttributes":n.bind(n.partial(i,e),this),error:n.bind(function(){s(e).off(".getImageAttributes"),t.call(this,null)},this)})}function J(e){return s(this.element).find("img["+this.config.imgKeyAttr+'="'+e+'"]').get(0)}function Q(e,t,i){var o=J.call(this,e);n.isEmpty(i)||o&&K.call(this,o,i),t&&(s(o).attr("src",t),this.mediaTracker[e].updatedSource=t)}function X(e,t,i,n){var o;t=t||z.call(this),o=this.dataFilter.isEmptyElement(t.outerHTML,!0)?0:u.isCursorAtStart(t)?-1:1,i="number"==typeof i?i:o;var r=s(e).get(0),a=ie.call(this,r);ne.call(this,a),0>i?s(t).before(a):i>0?s(t).after(a):0===i&&s(t).replaceWith(a),k.call(this);var l=s(a).nextAll(fe.join()).get(0);l||(l=s(ue).get(0),s(a).after(l)),n||(this.focus(!0),c.setToStart(l)),Z.call(this,a,!1,P)}function Z(e,t,i){var r=this;t=t||!1,i=i||n.noop;var a=s(e),l=a.find("figure"),c=a.find(".media-button"),u=200;return a.length&&l.length?(t&&c.length&&c.hide(),o(l,{opacity:t?0:[1,0],translateY:t?-25:[0,-25]},{duration:.9*u,easing:"easeOutQuad",complete:function(){l.removeAttr("style")}}),void o(e,t?"slideUp":"slideDown",{duration:u,easing:"easeOutQuart",begin:function(){a.css("pointer-events","none")},complete:function(){a.css("pointer-events",""),i.call(r,e)}})):void i.call(r)}function ee(){var e=this,t=U.call(this);s(t).removeClass(e.config.fakeClass),s(e.element).children("p").each(function(i,n){t!==n&&e.dataFilter.isEmptyElement(n)&&(0===i&&ae.call(e,s(n).next().get(0))||s(n).is(":last-child")&&ae.call(e,s(n).prev().get(0))?te.call(e,n):ae.call(e,s(n).prev().get(0))&&ae.call(e,s(n).next().get(0))?te.call(e,n):s(n).hasClass(e.config.fakeClass)&&s(n).remove()),void 0!==s(n).attr("class")&&""===s(n).attr("class").trim()&&s(n).removeAttr("class")}),s(this.element).children("."+this.config.mediaHolderClass).each(function(t,i){var n=s(this).next().get(0);n&&!ae.call(e,n)||s(this).after(te.call(e));var o=s(this).prev().get(0);o||s(this).before(te.call(e))})}function te(e){return e=e||s(ue).get(0),s(e).addClass(this.config.fakeClass),e}function ie(e){var t=s(e),i=s("<div />",{"class":this.config.mediaHolderClass,contentEditable:!1,draggable:!0});t.wrap(i),i=t.parent(),n.isFunction(this.config.mediaHolderCallback)&&this.config.mediaHolderCallback(this,e,t,i);var o=s(this.config.mediaKillerMarkup);o.addClass("media-killer"),i.append(o);var r=!i.hasClass("media-holder-draggable");if(r){var a=s(this.config.mediaMoverMarkup);a.addClass("media-mover"),i.append(a)}return i}function ne(e){var t=this,i=e?s(e):s(this.element).find('[contenteditable="false"]'),n=this.config.mediaHolderEvents;i.each(function(e,i){var o=s(i),r=null;o.off("keydown").on("keydown",function(e){n.keydown.call(null,e,o),e.isPropagationStopped()||(e.keyCode!==_e["delete"]&&e.keyCode!==_e.backspace||o.remove(),e.preventDefault(),e.stopPropagation())}),o.off("keyup").on("keyup",function(e){n.keyup.call(null,e,o)}),o.on("mousedown",function(e){r=e.originalEvent.target,n.mousedown.call(null,e,o,r)}),o.on("mouseup",function(e){n.mouseup.call(null,e,o,r);var i=s(r);i.hasClass("media-killer")&&r===e.target&&Z.call(t,o,!0,function(){o.remove(),x.call(t),P.call(t),t.onChange()})}),o.on("mouseenter",function(e){s(e.currentTarget).addClass("show-controls"),n.mouseenter.call(null,e,o,r)}),o.on("mouseleave",function(e){s(e.currentTarget).removeClass("show-controls"),n.mouseleave.call(null,e,o,r)}),o.on("dragstart",function(e){var t=s(r);t.hasClass("media-killer")&&(e.preventDefault(),e.stopPropagation()),o.hasClass("media-holder-draggable")||t.hasClass("media-mover")||(e.preventDefault(),e.stopPropagation()),n.dragstart.call(null,e,o,r)})})}function se(e){n.each(s(e).find("."+this.config.mediaHolderClass),function(e){s(e).find(".media-killer, .media-mover").remove();var t=s(e).children().first();t.length?s(t).unwrap():(s(e).contents().wrap("<div>"),s(e).children().first().unwrap().contents().unwrap())})}function oe(e){var t=this,i=s(e).find("."+this.config.fakeClass+", ."+this.config.fakeClass+"-intent");n.each(i,function(e){t.dataFilter.isEmptyElement(e)&&s(e).remove()})}function re(){var e=this;n.each(s(this.element).find(ve.join()),function(t){var i=u.getParentNodes(t),s=n.some(i,function(e){return n.contains(ve,e.nodeName)});le.call(e,t)||s||ie.call(e,t)})}function ae(e){return s(e).hasClass(this.config.mediaHolderClass)}function le(e){var t=s(e).closest("[class="+this.config.mediaHolderClass+"]");return t.length?t.get(0):null}function ce(e,t,i){var o,r;return t=n.isBoolean(t)?t:!1,e=e||z.call(this),o=s(e)[t?"prev":"next"](),!i&&o.length>0&&this.dataFilter.isEmptyElement(o)?(c.setToStart(o.get(0)),o):(r=s(ue).get(0),s(e)[t?"before":"after"](r),c.setToStart(r),r)}var ue="<p><br></p>",he="<p></p>",de=["P","FIGURE","H2","BLOCKQUOTE","UL","OL","DIV","PRE"],pe=["H2","BLOCKQUOTE","PRE"],ge=["PRE"],me=["UL","OL"],fe=["P","H2","BLOCKQUOTE","UL","OL","PRE"],ve=["IMG","IFRAME","FIGURE","HR"],_e={shift:16,enter:13,esc:27,backspace:8,"delete":46,tab:9,right:39},be=function(i,o){if(!i)throw new Error("A valid element parameter is required to initalize the editor");o=o||{},this.element=i,this.humanKeys=new f,this.keyComboEvents=o.keyComboEvents||new m({element:this.element,humanKeys:this.humanKeys});var d=n.template("<%= title %> (<%= shortcut %>)"),v=n.bind(function(e,t){return d({title:e,shortcut:this.humanKeys.pretty(t)})},this);this.config={labels:{},placeholder:!1,onChange:n.noop,onSelection:function(e){},onAsyncImageAdded:function(e,t,i,n){},onAsyncImageFailed:function(){_.warn("Unknown source type for inserting an image.")},onFileAdded:function(e,t,i){},onClientEvent:function(e){},flattenBlocks:!0,smartQuotes:{enabled:!1,config:{}},runIFrameSanitization:!1,mediaHolderClass:"media-holder",mediaHolderCallback:function(e,t,i,s){i.is("hr, img, figure")&&n.isEmpty(i.find("iframe"))&&s.addClass("media-holder-draggable"),s.addClass("media-holder-"+i.prop("tagName").toLowerCase())},mediaHolderEvents:{keydown:n.noop,keyup:n.noop,mousedown:n.noop,mouseup:n.noop,mouseenter:n.noop,mouseleave:n.noop,click:n.noop,dragstart:n.noop},imgKeyAttr:"data-img-key",imgSizeAttrs:{width:"data-orig-width",height:"data-orig-height"},addImgAttrs:{toImg:!1,toImgParent:!1},fakeClass:"fake",mediaKillerMarkup:"<div></div>",mediaMoverMarkup:"<div>&#8597;</div>",pasteHook:function(e,t){return!1},blurHook:function(e){return!1},documentMousedownHook:function(e){return!1},filterForSetData:function(e){return e},filterForGetData:function(e){return e},filterRules:{elements:["a","b","i","ul","ol","li","p","h2","blockquote","img","iframe","figure","br","hr","pre","sub","sup","small"],attributes:{a:["href","title"],img:["src","alt","data-orig-width","data-orig-height"],hr:["data-label"],iframe:["src","width","height","frameborder"],figure:["data-orig-width","data-orig-height"]},classnames:{hr:["read-more"]},remove_contents:["style","noscript","script","meta"],protocols:{a:{href:["http","https","mailto"]}}},animateShowControls:function(e){e.element.show()},animateHideControls:function(e){e.element.hide()},linkConfig:{bypassClasses:[],labels:o.labels,onChange:function(){this.onChange.call(this)},onDismiss:function(){this.lastSelection&&(c.restoreSelection(this.lastSelection),P.call(this))}},inlineControlsConfig:{openTray:h.prototype.openTray,closeTray:h.prototype.closeTray,onTrayOpened:function(e){},onTrayClosed:function(e){},keyboardEvents:this.keyComboEvents},formattingControlsConfig:{controls:{bold:{el:"b",className:"bold",command:"bold",type:"inline",title:v("Bold","meta+b"),keyboard:"meta+b"},italic:{el:"i",className:"italic",command:"italic",type:"inline",title:v("Italic","meta+i"),keyboard:"meta+i"},headline:{el:"h2",className:"headline",command:"formatBlock",type:"block",title:v("Headline","meta+shift+2"),keyboard:"meta+shift+2"},link:{el:"a",className:"link",command:"createLink",type:"inline",title:v("Link","meta+k"),keyboard:"meta+k"},strikethrough:{el:"strike",className:"strikethrough",command:"strikethrough",type:"inline",title:v("Strikethrough","meta+shift+6"),keyboard:"meta+shift+6"},orderedList:{el:"ol",className:"ordered-list",command:"insertOrderedList",type:"list",title:v("Ordered List","meta+shift+7"),keyboard:"meta+shift+7"},unorderedList:{el:"ul",className:"unordered-list",command:"insertUnorderedList",type:"list",title:v("Unordered List","meta+shift+8"),keyboard:"meta+shift+8"},blockquote:{el:"blockquote",className:"quote",command:"formatBlock",type:"block",title:v("Blockquote","meta+shift+9"),keyboard:"meta+shift+9"},clear:{el:"",command:"removeFormat",type:"inline",keyboard:"meta+shift+0"},pre:{el:"pre",command:"formatBlock",type:"block",keyboard:"meta+alt+1"},superscript:{el:"sup",command:"superscript",type:"inline",keyboard:"meta+dot"},subscript:{el:"sub",command:"subscript",type:"inline",keyboard:"meta+comma"},small:{el:"small",command:"insertHTML",type:"inline",keyboard:"meta+shift+minus",keyboardInverse:"meta+shift+plus"}},controlsOrder:["bold","italic","headline","link","strikethrough","orderedList","unorderedList","blockquote"],onShow:function(e){n.isFunction(this.animateShowControls)?this.animateShowControls.call(this,e):e.element.show()},onHide:function(e){n.isFunction(this.animateHideControls)?this.animateHideControls.call(this,e):e.element.hide()},onAction:function(e){var t=u.getNodeList();e.setActives(t)}},showStaticControls:!0},n.merge(this.config,o||{}),this.applyCommand=n.bind(T,this),this.inverseCommand=n.bind(A,this),this.animateShowControls=n.bind(this.config.animateShowControls,this),this.animateHideControls=n.bind(this.config.animateHideControls,this),this.onChange=function(e){var t=V.call(this);this.previousRawData!==t&&(O.call(this),this.config.onChange.call(this),this.previousRawData=t)};var b=e(this.config.linkConfig,this);this.linkControl=new r(b);var w=e(this.config.inlineControlsConfig,this);this.inlineControls=new h(w);var y=e(n.defaults({keyboardEvents:this.keyComboEvents},this.config.formattingControlsConfig),this);this.contextualControls=new a(this.applyCommand,this.inverseCommand,y);var k=this.config.formattingControlsConfig.onShow,x=this.config.formattingControlsConfig.onHide,C=e(n.defaults({onShow:function(e){k.apply(this,arguments),e.listener=e.listener||function(t){var i=u.getNodeList();e.setActives(i),document.removeEventListener("mousedown",e.listener,!1)},document.addEventListener("mousedown",e.listener)},onHide:function(e){x.apply(this,arguments),document.removeEventListener("mousedown",e.listener,!1)}},this.config.formattingControlsConfig),this);this.staticControls=new a(this.applyCommand,this.inverseCommand,C),this.dataFilter=new l(this.config.filterRules),this.keyModifiers={shift:!1},this.undoManager=new p(this,n.bind(function(){for(var e in this.mediaTracker){var t=this.mediaTracker[e].updatedSource;if(t){var i=J.call(this,e);s(i).attr("src",t)}}B.call(this)},this)),this.config.smartQuotes.enabled&&(this.smartQuoter=new g(this,this.config.smartQuotes.config)),this.mediaTracker={},t.call(this)};return be.prototype.getData=function(e,t){var i=this,o=V.call(this);o=this.config.filterForGetData.call(this,o),this.config.runIFrameSanitization&&(o=this.dataFilter.unSanitizeIFrames(o));var r=document.createElement("div");if(r.innerHTML=o,se.call(this,r),oe.call(this,r),t||s(r).find("["+i.config.imgKeyAttr+"]").removeAttr(i.config.imgKeyAttr),e)for(var a=function(e){var t=s(r).children(":"+e+"-child").get(0);return t&&i.dataFilter.isEmptyElement(t,!0)?t:null},l=function(){return n.compact([a("first"),a("last")])};l().length;)n.forEach(l(),function(e){s(e).remove()});return r.innerHTML},be.prototype.setData=function(e,t,i){t&&(e=this.config.filterForSetData.call(this,e),e=this.dataFilter.filterHTML(e)),this.config.runIFrameSanitization&&(e=this.dataFilter.sanitizeIFrames(e)),N.call(this,e),i?this.dataFilter.flattenBlocksDown(this.element):this.dataFilter.blockifyInlineNodes(this.element),W.call(this),re.call(this),ne.call(this),H.call(this),this.onChange()},be.prototype.insertData=function(e,t,i){t&&(e=this.dataFilter.filterHTML(e)),q.call(this,e),i&&this.dataFilter.flattenBlocksDown(u.getNearestElement()),this.onChange()},be.prototype.blur=function(e){return e||k.call(this),s(this.element).blur()},be.prototype.focus=function(e){var t=s(this.element).focus();return e||this.setCursorToEnd(),t},be.prototype.hasFocus=function(){return s(this.element).is(":focus")},be.prototype.setPlaceholder=function(e){this.config.placeholder=e,O.call(this)},be.prototype.insertMedia=function(e,t,i,n){t&&(e=this.dataFilter.filterHTML(e)),X.call(this,e,i,n),this.onChange()},be.prototype.addControl=function(e){var t=s(this.wrapper).find("[data-js=control-bar]");t.append(e)},be.prototype.isEmpty=function(){var e=V.call(this);return""===e||"<br>"===e||e===ue||e===he},be.prototype.getCurrentElement=function(){return u.getNearestElement()},be.prototype.getAsyncImage=function(e){return J.call(this,e)},be.prototype.insertAsyncImage=function(e,t,i,n,s){G.call(this,e,t,i,n,s),this.onChange()},be.prototype.updateAsyncImage=function(e,t,i){Q.call(this,e,t,i),this.onChange("updateAsyncImage")},be.prototype.setCursorToStart=function(e,t){var i=s(this.element);e=e&&i.find(e).first().get(0)||i.children().first().get(0),e&&c.setToStart(e),t||P.call(this)},be.prototype.setCursorToEnd=function(e,t){var i=s(this.element);e=e&&i.find(e).last().get(0)||i.children().last().get(0),e&&c.setToEnd(e),t||P.call(this)},be.prototype.insertNewParagraphAfter=function(e,t){return ce.call(this,e,!1,t)},be.prototype.insertNewParagraphBefore=function(e,t){return ce.call(this,e,!0,t)},be.prototype.isEmptyElement=function(e){return e=e||z.call(this),this.dataFilter.isEmptyElement(e)},be.prototype.hasSelection=function(e){return e=e||z.call(this),u.hasSelection(e)},be.prototype.isCursorAtEnd=function(e){return e=e||z.call(this),u.isCursorAtEnd(e)},be.prototype.isCursorAtStart=function(e){return e=e||z.call(this),u.isCursorAtStart(e)},be.prototype.teardown=function(){this.undoManager.teardown(),this.keyComboEvents.off()},be}();e.exports=b},function(e,t,i){var n=i(3),s=i(9),o=i(165),r=i(225),a=i(226),l=i(227),c=i(228),u=function(){function e(){this.element=s("<div />",{"class":"link-bubbles"}).css({position:"absolute",top:0,left:0}),this.linkUrl=s("<div />",{"class":"url"}),this.linkEditInput=s("<input />",{type:"text",placeholder:"http://"}),this.linkEditDone=s("<div />",{"class":"done"}).text(this.actionNames.done),this.linkUrl.hide(),this.linkUrl.append(this.linkEditInput).append(this.linkEditDone),t.call(this),this.element.append(this.linkUrl),this.hide()}function t(){var e=this,t=s("<div />",{"class":"options"}),n={edit:function(){i.call(this)},remove:function(){var e=window.getSelection(),t=document.createRange();t.selectNodeContents(this.linkElement),e.removeAllRanges(),e.addRange(t),window.document.execCommand("unlink",!1,null),e.removeAllRanges(),this.onChange(),this.hide()},open:function(){var e=s(this.linkElement).attr("href");-1===e.indexOf("://")&&(e="http://"+e),window.open(e,"_blank")}};for(var o in n){var r=s("<div />",{"class":o}).text(this.actionNames[o]);s(r).on("click",function(t){return function(){t.call(e)}}(n[o])),t.append(r)}t.hide(),s(this.element).append(t)}function i(){this.linkElement||c.error("Cannot edit link without a valid linkElement");var e=this.linkElement;u.call(this,function(t){s(e).attr("href",t)},s(e).attr("href"))}function u(e,t){t&&(this.linkEditInput.val(t),this.linkUrl.addClass("modified"));var i=this,n=function(){var t=s(i.linkEditInput).val().trim();e(t),i.onChange(),i.close()};s(this.linkEditInput).on("keydown",function(e){i.linkUrl.addClass("modified"),e.keyCode===d.enter?(e.preventDefault(),n()):e.keyCode===d.esc&&(i.close(),i.onDismiss(),e.stopPropagation())}),s(this.linkEditInput).on("keyup",function(e){e.keyCode!==d.esc&&e.keyCode!==d.enter&&h.call(i)}),s(this.linkEditInput).on("paste",function(e){i.linkUrl.addClass("modified"),h.call(i)}),this.linkEditDone.on("click",function(e){e.preventDefault(),n()}),this.element.find(".options").hide(),this.linkUrl.show(),this.show(),h.call(this),s(this.linkEditInput).focus()}function h(){var e=s(this.linkEditInput).val(),t=s(this.linkEditDone).outerWidth(),i=s(this.linkUrl).outerWidth()-s(this.linkUrl).width(),n=r.calcTextWidth(s(this.linkEditInput).get(0),e),a=r.calcTextWidth(s(this.linkEditInput).get(0),"A"),l=n+t+i+a,c=l<this.minWidth?this.minWidth:l;c=c>this.maxWidth?this.maxWidth:c;var u=s(this.element),h=c-u.width();if(0!==h){var d=Math.floor(h/2);o(u,{width:c,left:"-="+d},{duration:40,easing:"ease"})}}var d={shift:16,enter:13,esc:27,"delete":8,tab:9},p=function(t){this.onChange="onChange"in t&&n.isFunction(t.onChange)?t.onChange:n.noop,this.onDismiss=t.onDismiss||n.noop,this.bypassClasses="bypassClasses"in t&&n.isArray(t.bypassClasses)?t.bypassClasses:[],this.maxWidth="maxWidth"in t&&n.isNumber(t.maxWidth)?t.maxWidth:600,this.minWidth="minWidth"in t&&n.isNumber(t.minWidth)?t.minWidth:200,this.linkElement=null,this.labels=n.extend({},{Edit:"Edit",Remove:"Remove",Open:"Open",Done:"Done"},t.labels),this.actionNames={edit:this.labels.Edit,remove:this.labels.Remove,open:this.labels.Open,done:this.labels.Done},e.call(this),l.call(this)};return n.assign(p.prototype,l.prototype),p.prototype.createLink=function(e){u.call(this,function(t){a.restoreSelection(e),window.document.execCommand("createLink",!1,t);var i=window.getSelection(),n=i.getRangeAt(0);n.collapse(!1),i.removeAllRanges(),i.addRange(n)})},p.prototype.showOptions=function(e){this.linkElement=e,this.linkUrl.hide(),this.element.css({width:"",left:0}),this.element.find(".options").show()},p.prototype.close=function(){this.linkUrl.hide(),this.element.find(".options").hide(),this.element.css("width",""),this.linkEditInput.val("").unbind(),this.linkEditDone.unbind(),this.linkUrl.removeClass("modified"),this.linkElement=null,this.hide()},p.prototype.isValidLink=function(e){return e?!n.some(this.bypassClasses,function(t){return s(e).hasClass(t)}):!1},p}();e.exports=u},function(e,t,i){var n=i(3),s=i(9),o=function(){var e=function(){};return e.calcTextWidth=function(e,t){var i=["font-style","font-weight","font-size","font-family"],o=n.reduce(i,function(t,i){return t+" "+s(e).css(i)},"").trim(),r=document.createElement("canvas"),a=r.getContext("2d");a.font=o;var l=a.measureText(t);return Math.round(l.width)},e.browser=function(){var e=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(trident)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},t=e(navigator.userAgent),i={};return t.browser&&(i[t.browser]=!0,i.version=t.version),i.trident&&(i.msie=!0),i.chrome?i.webkit=!0:i.webkit&&(i.safari=!0),i}(),e}();e.exports=o},function(e,t){var i=function(){return{saveSelection:function(e,t){if(t=t||window.getSelection(),!t||!t.rangeCount)return null;for(var i,n,s,o=t.getRangeAt(0),r=0,a=[e];!s&&(i=a.pop());){if(i.nodeType===i.TEXT_NODE)i===o.startContainer?(r+=o.startOffset,s=!0):r+=i.length;else{var l=i.childNodes.length;if("false"!==i.getAttribute("contenteditable"))for(;l--;)a.push(i.childNodes[l])}n=i}return{container:e,endContainer:o.endContainer,start:r,end:r+o.toString().length,selection:t,anchorNode:t.anchorNode}},restoreSelection:function(e){if(e){var t=0,i=document.createRange();i.setStart(e.container,0),i.collapse(!0);for(var n,s,o=[e.container],r=!1,a=!1;!a&&(n=o.pop());){if(n.nodeType===n.TEXT_NODE){var l=t+n.length;!r&&e.start>=t&&e.start<l&&(i.setStart(n,e.start-t),r=!0),r||l!==e.end||(i.setStart(n,e.end-t),r=!0),r&&e.end>=t&&e.end<=l&&(i.setEnd(n,e.end-t),a=!0),t=l}else{var c=n.childNodes.length;if("false"!==n.getAttribute("contenteditable"))for(;c--;)o.push(n.childNodes[c])}s=n}if(!a){var u=e.end-t;try{i.setEnd(e.endContainer,u)}catch(h){}}var d=window.getSelection();d.removeAllRanges();try{d.addRange(i)}catch(h){}}},setToStart:function(e){if(e){var t=document.createRange();t.setStart(e,0),t.setEnd(e,0),t.collapse(!0);var i=window.getSelection();i.removeAllRanges();try{i.addRange(t)}catch(n){}}},setToEnd:function(e){for(var t=[e],i=null,n=e,s=0;i=t.pop();)if(3===i.nodeType)n=i,s=i.length;else for(var o=i.childNodes.length;o--;)t.push(i.childNodes[o]);var r=document.createRange();r.setStart(n,s),r.setEnd(n,s),r.collapse(!0);var a=window.getSelection();a.removeAllRanges();try{a.addRange(r)}catch(l){}}}}();e.exports=i},function(e,t,i){var n=i(228),s=function(){function e(e,t){"number"==typeof e&&"number"==typeof t&&this.element.css({left:e+"px",top:t+"px"})}function t(){var e=this.element.get(0).getBoundingClientRect().left;0>e&&this.element.css("left","+="+-1*e+"px");var t=this.element.get(0).getBoundingClientRect().top;0>t&&this.element.css("top","+="+-1*t+"px")}var i=function(e){return this.element?(e=e||{},this.onShow=e.onShow||function(e){e.element.show()},this.onHide=e.onHide||function(e){e.element.hide()},this.isShown=!1,void this.element.hide()):(n.error("ControlBase requires an element"),null)};return i.prototype.hide=function(){this.isShown&&(this.isShown=!1,this.onHide(this))},i.prototype.showOverTarget=function(e,i){var n=e-this.element.width()/2,s=i-this.element.height()-10;this.show(n,s),t.call(this)},i.prototype.show=function(t,i){e.call(this,t,i),this.isShown||(this.isShown=!0,this.onShow(this))},i.prototype.size=function(e,t){e&&"number"==typeof e&&this.element.width(e),t&&"number"==typeof t&&this.element.width(t)},i}();e.exports=s},function(e,t,i){var n=i(3),s=i(222),o=["assert","clear","constructor","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","timeline","timelineEnd","trace","warn"],r=function(e){return function(){return s.debugMode?window.console[e].bind(window.console).apply(this,arguments):n.noop}},a={};n.each(o,function(e){a[e]=r(e)}),e.exports=a},function(e,t,i){var n=i(3),s=i(9),o=i(165),r=o.animate,a=i(227),l=function(){function e(){var e=this,t=n.reduce(this.controlsOrder,function(e,t){return n.has(this.controls,t)&&e.push(this.template(n.extend({name:t},this.controls[t]))),e},[],this);this.element=s("<div />",{"class":"bubbles"}).css({position:"absolute",top:0,left:0}).html(t),this.buttons=s(this.element).find("[data-command]"),this.hide(),this.buttons.on("mousedown",function(e){e.preventDefault()}),this.buttons.on("mouseup",function(t){t.preventDefault(),l.call(e,this)})}function t(){n.each(this.controls,function(e,t){n.has(e,"keyboard")&&this.keyboardEvents.on(e.keyboard,n.partial(o.bind(this),t)),n.has(e,"keyboardInverse")&&this.keyboardEvents.on(e.keyboardInverse,n.partial(i.bind(this),t))},this)}function i(e){n.has(this.controls,e)&&d[e]&&o.call(this,e)}function o(e){var t,i,s,o;n.has(this.controls,e)&&(t=d[e],i=this.controls[e],s=i.command,o=i.el,t&&this.inverseCommand&&"function"==typeof this.inverseCommand?this.inverseCommand(s,o,this):this.applyCommand&&"function"==typeof this.applyCommand&&this.applyCommand(s,o,this),this.onAction(this))}function l(e){o.call(this,s(e).attr("data-name"))}function c(){this.buttons.removeClass("active"),this.buttons.filter(function(){return d[s(this).attr("data-name")]}).addClass("active")}function u(e,t){var i=!1;return s.each(e,function(e,n){return n===t||"undefined"!=typeof n.nodeName&&n.nodeName===t?(i=!0,!1):void 0}),i}var h='<div class="<%= className %>" title="<%= title %>" data-name="<%= name %>" data-el="<%= el %>" data-command="<%= command %>" data-type="<%= type %>">&nbsp;</div>',d={},p=function(i,s,o){o=o||{},this.applyCommand=i,this.inverseCommand=s,this.template=n.template(o.template||h),this.controls=o.controls||{},this.controlsOrder=o.controlsOrder||n.keys(this.controls),this.onAction=o.onAction||n.noop,this.keyboardEvents=o.keyboardEvents,e.call(this),this.keyboardEvents&&t.call(this),a.call(this,o)};return n.assign(p.prototype,a.prototype),p.prototype.setActives=function(e){d=n.reduce(this.controls,function(t,i,n){var s=i.command,o=(i.el||"").toUpperCase(),r=u(e,o),a=!1;try{a=document.queryCommandEnabled(s)&&document.queryCommandState(s)}catch(l){a=!1}return t[n]=a||r,t},{},this),c.call(this)},p.prototype.open=function(e,t){if(!this.isShown){var i=s(this.element).children("[data-command]"),n=s(this.element).find(".shim");s(this.element).css({width:"auto"}),n.remove(),i.removeAttr("style")}this.showOverTarget(e,t)},p.prototype.closeWithShim=function(e,t,i,o){var a=s(this.element),l=s(e),c=s('<div class="shim">&nbsp;</div>').get(0),u=n.has(r,"Promise");i=u?i:200;var h=a.width();a.css("width",h+t);var d=l.position().left,p=h/2-(d+t/2);l.before(c).hide();var g=s(c).offset().left+p,m=s(c).offset().top;this.isAnimating=!0,n.forEach(this.buttons,function(e,t){r(e,"stop"),r(e,{opacity:0},{duration:.5*i})}),r(a,{left:"+="+p},{easing:"ease",duration:i});var f=r(c,{width:t},{easing:"ease",duration:i}),v=n.bind(function(){n.isFunction(o)&&o.call(this,g,m),this.isAnimating=!1,this.hide()},this);u?f.then(v):n.delay(v,i)},p.prototype.getActiveStates=function(){return d},p}();e.exports=l},function(e,t,i){var n=i(3),s=i(9),o=i(231),r=function(){function e(e){e.normalize();for(var t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);t.nextNode();){var i=t.currentNode,n=s(i).parent().is(e);n&&""!==i.nodeValue.trim()&&s(i).wrap("<p>")}}function t(t){e(t),s(t).children().each(function(){var e=s(this).get(0),t=e.nodeName===f,i=e.nodeName===v;_(e)||b(e)||t||i||s(this).wrap("<p>")})}function i(e){return n.filter(s(e).find("*").toArray(),function(e){return _(e)||y(e)})}function r(e,o){e.normalize(),o||t(e);var r=i(e);!r.length&&o||(o&&(t(e),r=i(e)),s(e).empty(),n.each(r,function(t){var i=n.some(s(t).children().toArray(),function(e){return _(e)});(y(t)||!h(t)&&!i)&&s(e).append(t)}))}function a(e){if(!y(e)){var t=s(e).children(g.join()).toArray(),i=!1;n.each(t,function(e){i||(s(e).unwrap(),i=!0),a(e)})}}function l(e,t){var o=i(e);n.each(o,function(e){s(e).find("li").contents().unwrap(),t&&(s(e).find("br:last-child").remove(),s(e).append("<br>")),s(e).contents().unwrap()})}function c(e){var i=k(e);i.shift();for(var n=i.shift();n&&!s(n).is("[contentEditable]");){var o=n.parentNode;s(n).contents().unwrap(),t(o),n=i.shift()}}function u(e){if(e&&e.length){for(var t=e.shift(),i=!1,o=["style","dir"];t;){var r=s(t).find("span").toArray();"SPAN"===t.nodeName&&r.push(t),r.length&&(i=!0),s(r).contents().unwrap(),n.each(o,function(e){s(t).removeAttr(e),s(t).find("["+e+"]").removeAttr(e)}),t=e.shift()}return i}}function h(e,t){var i=s(e).text();t&&(i=i.replace(/\n|\r/gm,"").trim());var n=e&&e.nodeName===v;return""===i&&!b(e)&&!w(e)&&!n}function d(e){var t=document.implementation.createHTMLDocument("");return t.body.innerHTML=e,t.body}function p(e){var t=document.implementation.createHTMLDocument("");return t.body.appendChild(e.cloneNode(!0)),t.body}var g=["P","FIGURE","H2","BLOCKQUOTE","UL","OL","PRE"],m=["FIGURE","IFRAME","IMG","HR"],f="DIV",v="HR",_=function(e){return n.contains(g,e.nodeName)},b=function(e){return e&&n.contains(m,e.nodeName)},w=function(e){return s(e).find(m.join()).length},y=function(e){return"false"===s(e).attr("contenteditable")},k=function(e){return n.filter(e,function(e){return n.contains(g,e.nodeName)})},x=function(e){this.sanitizeConfig=e};return x.prototype.flattenBlocksDown=function(e,t){r(e,t)},x.prototype.unBlock=function(e){a(e)},x.prototype.unwrapParentBlocks=function(e){c(e)},x.prototype.scrubSpansAndBadAttrs=function(e,t){return u(e,t)},x.prototype.blockifyInlineNodes=function(e){t(e)},x.prototype.inlinify=function(e,t){l(e,t)},x.prototype.getBlockNodes=function(e){return i(e)},x.prototype.isEmptyElement=function(e,t){return h(e,t)},x.prototype.filterHTML=function(e){var t=d(e),i=new o(this.sanitizeConfig),n=i.clean_node(t),s=p(n),r=s.innerHTML,a=r.replace(/[<]p[>][ ]*[<]\/p[>]/g,"");return a},x.prototype.filterPlaintext=function(e,t){var i=n.escape(e);return i=i.replace(/\r\n/g,"\n"),i=i.replace(/\r/g,"\n"),t&&(i=i.replace(/\n([ ]*\n)+/g,"</p><p>")),i=i.replace(/\n/g,"<br>"),t&&(i="<p>"+i+"</p>"),i},x.prototype.convertToBrowserSpaces=function(e){return e.replace(/[ ]{2}/g," ").replace(/[ ]$/,"")},x.prototype.sanitizeIFrames=function(e){var t=d(e);return s(t).find("iframe").each(function(){s(this).attr("data-original-src",s(this).attr("src")),s(this).attr("src","javascript:''")}),t.innerHTML},x.prototype.unSanitizeIFrames=function(e){var t=d(e);return s(t).find("iframe[data-original-src]").each(function(){s(this).attr("src",s(this).attr("data-original-src")),s(this).removeAttr("data-original-src")}),t.innerHTML},x}();e.exports=r},function(e,t){function i(){var e,t;for(t=arguments[0]||{},this.config={},this.config.elements=t.elements?t.elements:[],this.config.attributes=t.attributes?t.attributes:{},this.config.attributes[i.ALL]=this.config.attributes[i.ALL]?this.config.attributes[i.ALL]:[],this.config.allow_comments=t.allow_comments?t.allow_comments:!1,this.allowed_elements={},this.config.protocols=t.protocols?t.protocols:{},this.config.classnames=t.classnames?t.classnames:{},this.config.add_attributes=t.add_attributes?t.add_attributes:{},this.dom=t.dom?t.dom:document,e=0;e<this.config.elements.length;e++)this.allowed_elements[this.config.elements[e]]=!0;if(this.config.remove_element_contents={},this.config.remove_all_contents=!1,t.remove_contents)if(t.remove_contents instanceof Array)for(e=0;e<t.remove_contents.length;e++)this.config.remove_element_contents[t.remove_contents[e]]=!0;else this.config.remove_all_contents=!0;this.transformers=t.transformers?t.transformers:[]}i.REGEX_PROTOCOL=/^([A-Za-z0-9\+\-\.\&\;\*\s]*?)(?:\:|&*0*58|&*x0*3a)/i,i.RELATIVE="__RELATIVE__",i.ALL="__ALL__",i.prototype.clean_node=function(e){function t(e,t){var i;for(i=0;i<t.length;i++)if(t[i]===e)return i;return-1}function n(){var e,t,i=[],n={};for(e=0;e<arguments.length;e++)if(arguments[e]&&arguments[e].length)for(t=0;t<arguments[e].length;t++)n[arguments[e][t]]||(n[arguments[e][t]]=!0,
i.push(arguments[e][t]));return i}function s(e){var t;switch(e.nodeType){case 1:r.call(this,e);break;case 3:t=e.cloneNode(!1),this.current_element.appendChild(t);break;case 5:t=e.cloneNode(!1),this.current_element.appendChild(t);break;case 8:this.config.allow_comments&&(t=e.cloneNode(!1),this.current_element.appendChild(t));break;default:console&&console.log&&console.log("unknown node type",e.nodeType)}}function o(e,i){for(var n=[],s=0;s<e.length;s++)-1!==t(e[s],i)&&n.push(e[s]);return n}function r(e){var r,l,c,u,h,d,p,g,m,f,v=a.call(this,e);if(e=v.node,c=e.nodeName.toLowerCase(),l=this.current_element,this.allowed_elements[c]||v.whitelist){this.current_element=this.dom.createElement(e.nodeName),l.appendChild(this.current_element);var _=this.config.attributes;for(u=n(_[c],_[i.ALL],v.attr_whitelist),this.config.classnames[c]&&this.config.classnames[c].length&&u.push("class"),r=0;r<u.length;r++){d=u[r];var b="object"==typeof u[r]||u[r]instanceof Object;if(d=b?u[r].name:u[r],h=e.attributes[d]){g=h.value;var w=g.toLowerCase();if(f=!0,this.config.protocols[c]&&this.config.protocols[c][d]){f=!1,m=this.config.protocols[c][d],m.push(i.RELATIVE);for(var r in m)if(0===w.indexOf(m[r].toLowerCase())){f=!0;break}}"class"===d&&this.config.classnames[c]&&(g=o(g.split(" "),this.config.classnames[c]).join(" "),f=!!g),b&&(f=w.match(u[r].value)),f&&(p=document.createAttribute(d),p.value=g,this.current_element.setAttributeNode(p))}}if(this.config.add_attributes[c])for(d in this.config.add_attributes[c])p=document.createAttribute(d),p.value=this.config.add_attributes[c][d],this.current_element.setAttributeNode(p)}else if(-1!==t(e,this.whitelist_nodes)){for(this.current_element=e.cloneNode(!0);this.current_element.childNodes.length>0;)this.current_element.removeChild(this.current_element.firstChild);l.appendChild(this.current_element)}if(!this.config.remove_all_contents&&!this.config.remove_element_contents[c])for(r=0;r<e.childNodes.length;r++)s.call(this,e.childNodes[r]);this.current_element.normalize&&this.current_element.normalize(),this.current_element=l}function a(e){var i,s,o,r={attr_whitelist:[],node:e,whitelist:!1};for(i=0;i<this.transformers.length;i++)if(o=this.transformers[i]({allowed_elements:this.allowed_elements,config:this.config,node:e,node_name:e.nodeName.toLowerCase(),whitelist_nodes:this.whitelist_nodes,dom:this.dom}),null!==o){if("object"!=typeof o)throw new Error("transformer output must be an object or null");if(o.whitelist_nodes&&o.whitelist_nodes instanceof Array)for(s=0;s<o.whitelist_nodes.length;s++)-1===t(o.whitelist_nodes[s],this.whitelist_nodes)&&this.whitelist_nodes.push(o.whitelist_nodes[s]);r.whitelist=!!o.whitelist,o.attr_whitelist&&(r.attr_whitelist=n(r.attr_whitelist,o.attr_whitelist)),r.node=o.node?o.node:r.node}return r}var l=this.dom.createDocumentFragment();this.current_element=l,this.whitelist_nodes=[];for(var c=0;c<e.childNodes.length;c++)s.call(this,e.childNodes[c]);return l.normalize&&l.normalize(),l},e.exports=i},function(e,t,i){var n=i(3),s=i(9),o=function(){var e=function(e){return Array.prototype.indexOf.call(e.parentNode.childNodes,e)},t=function(e){return e instanceof HTMLElement},i={getParentNodes:function(e,t){if(t=t||[],!e||i.isEditorNode(e))return t;var n=e.parentNode;return i.isEditorNode(n)?t:n?(t.push(n),i.getParentNodes(n,t)):t},getRootElements:function(n){n=n||i.getSelection();var s=n&&n.anchorNode?n.anchorNode:null;if(!s||i.isEditorNode(s))return[];var o=i.getParentNodes(s),r=n.focusNode,a=i.getParentNodes(r),l=o.length?o.pop():s,c=a.length?a.pop():r,u=e(l),h=e(c);if(u>h){var d=u;u=h,h=d}for(var p=[],g=l.parentNode,m=u;h>=m;m++){var f=g.childNodes[m];t(f)&&p.push(f)}return p},getNodeList:function(e,t){e=e||i.getSelection();var s=e&&e.anchorNode?e.anchorNode:null;if(!s||i.isEditorNode(s))return[];var o=e.focusNode,r=[s];o&&!i.isEditorNode(o)&&(r=r.concat([o]));var a=i.getParentNodes(s);if(r=r.concat(a),!t){var l=i.getParentNodes(o);r=r.concat(l)}var c=n.union(r);return c},getNodeByNames:function(e,t,n){var s=i.getNodeList(n);return s=t?s.reverse():s,this.getNodesByNames(s,e)[0]},getNodesByNames:function(e,t){return n.filter(e,function(e){return-1!==n.indexOf(t,e.nodeName)})},getNearestElement:function(e){e=e||i.getSelection();var t=i.getNodeList();return n.find(t,function(e){return 1===e.nodeType})},getContextCoordinates:function(e,t){var n=i.getSelection(),o=n.getRangeAt(0).cloneRange(),r=s(e).offset();if(t||!n.isCollapsed){var a=(t||o).getBoundingClientRect();return{x:a.left+a.width/2-r.left,y:a.top-r.top+s(window).scrollTop()}}if(o.getClientRects){o.collapse(!0);var l=o.getClientRects()[0];if(l)return{x:l.left-r.left,y:l.top-r.top+s(window).scrollTop()}}},getSelection:function(){var e=window.getSelection();if(e.anchorNode){var t=s(e.anchorNode).closest("[contenteditable]").length;return t?e:null}return null},collapseToEnd:function(){var e=i.getSelection();e&&e.collapseToEnd()},collapseToStart:function(){var e=i.getSelection();e&&e.collapseToStart()},isInContext:function(e,t){return s(e.anchorNode).closest(t).length>0},isEditorNode:function(e){return s(e).is('[contentEditable="true"]')},hasSelection:function(){var e=i.getSelection();return e&&!e.isCollapsed},rangeFromElement:function(e){var t,n,s=i.getSelection();return s&&s.isCollapsed?(n=s.getRangeAt(0),t=n.cloneRange(),t.selectNodeContents(e),t.setEnd(n.startContainer,n.startOffset),t):!1},isCursorAtEnd:function(e,t){var i=this.rangeFromElement(e);if(!i)return!1;var n=i.toString(),s=e.textContent;return t&&(n=n.trim(),s=s.trim()),n.length===s.length},isCursorAtStart:function(e){var t=this.rangeFromElement(e);return t?0===t.startOffset&&0===t.endOffset:!1}};return i}();e.exports=o},function(e,t,i){var n=i(3),s=i(9),o=i(227),r=function(){function e(){this.element=s("<div />",{"class":"inline-controls"}).css({position:"absolute",top:0,left:0}),this.opener=s("<div />",{"class":"opener"}),this.isTrayOpen=!1;var e=this;this.opener.on("mousedown",function(i){return i.preventDefault(),i.stopPropagation(),t.call(e,null,!0),!1}),this.tray=s("<div />",{"class":"tray"}),this.element.append(this.opener),this.element.append(this.tray),this.hide()}function t(e,t){"boolean"!=typeof e&&(e=!this.isTrayOpen),e?(this.openTray.call(this,this.tray),this.isTrayOpen=!0,this.onTrayOpened.call(this,t)):(this.closeTray.call(this,this.tray),this.isTrayOpen=!1,this.onTrayClosed.call(this,t)),s(this.opener).toggleClass("open",this.isTrayOpen),t?s(this.opener).toggleClass("closed",!this.isTrayOpen):s(this.opener).removeClass("closed")}var i=function(t){t=t||{},this.openTray=t.openTray||this.openTray,this.closeTray=t.closeTray||this.closeTray,this.onTrayOpened=t.onTrayOpened||function(e){},this.onTrayClosed=t.onTrayClosed||function(e){},this.customOffset=t.customOffset||n.noop,this.keyboardEvents=t.keyboardEvents,e.call(this),o.call(this,t)};n.assign(i.prototype,o.prototype);var r=n.memoize(function(e,t){var i;return n.isFunction(t)?i=t.call():n.isObject(t)&&(i=t),n.pick(n.defaults(n.isObject(i)?i:{},{x:e.x||e,y:e.y||0}),["x","y"])});return i.prototype.addToTray=function(e,t){var i;t=t||{},this.tray.append(e),i=t.keyboard,this.keyboardEvents&&i&&this.keyboardEvents.on(i.shortcut,i.callback,i.context)},i.prototype.openTray=function(e){e.show()},i.prototype.closeTray=function(e){e.hide()},i.prototype.open=function(e,i){if(e){i=r(i||0,this.customOffset||0);var n=s(e).position(),o=parseInt(s(e).css("margin-top"),10)||0;t.call(this,!1),this.show(n.left+i.x,n.top+i.y+o)}},i.prototype.close=function(){t.call(this,!1),this.hide()},i.prototype.toggleTrayWithIntent=function(e){t.call(this,e,!0)},i}();e.exports=r},function(e,t,i){var n=i(3),s=i(9),o=i(226),r=function(){function e(){var e=this,n=function(e){return/Mac/.test(navigator.platform)?e.metaKey:e.ctrlKey};s(this.editor.element).on("keydown.undoManager",function(s){return s.keyCode===u.z&&n(s)&&!s.altKey?(s.shiftKey?i.call(e):t.call(e),s.preventDefault(),!1):void 0})}function t(){if(l.call(this),this.undoStates.length){var e=this.undoStates.pop();c.call(this,e),this.redoStates.push(this.currState),r.call(this)}}function i(){if(this.redoStates.length){var e=this.redoStates.pop();c.call(this,e),this.undoStates.push(this.currState),r.call(this)}}function r(){this.currState=a.call(this)}function a(){var e={data:this.editor.getData(!0,!0),selection:o.saveSelection(this.editor.element)};return e}function l(){var e=a.call(this);return this.currState?void(e.data!==this.currState.data&&(this.undoStates.push(this.currState),this.currState=e)):void(this.currState=e)}function c(e){if(this.isRestoring=!0,this.editor.setData(e.data,!0),e.selection)o.restoreSelection(e.selection);else{var t=window.getSelection();t.removeAllRanges()}this.afterRestore()}var u={command:91,control:17,shift:16,z:90},h=500,d=function(t,i){this.editor=t,this.modifierKeyCode=!1,this.isShift=!1,this.currState=null,this.undoStates=[],this.redoStates=[],this.afterRestore=i||function(){},this.isRestoring=!1;var s=this,o=n.debounce(function(){s.isTorndown||l.call(s)},h);this.defaultOnChange=t.onChange,t.onChange=function(e){if(s.isRestoring)s.isRestoring=!1;else{if("updateAsyncImage"===e)return;s.currState?o():l.call(s)}s.defaultOnChange.call(this)},e.call(this)};return d.prototype.undo=function(){t.call(this)},d.prototype.redo=function(){i.call(this)},d.prototype.teardown=function(){this.isTorndown=!0,this.editor.onChange=this.defaultOnChange,this.undoStates.length=0,this.redoStates.length=0,this.currState=null,s(this.editor.element).off(".undoManager")},d}();e.exports=r},function(e,t,i){var n=i(3),s=i(9),o=i(232),r=i(226),a=i(225),l=function(){function e(){var e=this;s(this.editor.element).on("keypress",function(n){var s=!1;if(34===n.charCode)s=i.call(e);else{if(39!==n.charCode)return;s=t.call(e)}s&&n.preventDefault()})}function t(){var e=this.config.singleQuotes;return l.call(this,e.open,e.close,e.prime)}function i(){var e=this.config.doubleQuotes;return l.call(this,e.open,e.close,e.prime)}function l(e,t,i){var a=o.getSelection();if(!a.isCollapsed)return!1;var l=a.anchorNode;l.normalize();var c=r.saveSelection(l),u=l.textContent,h=u.slice(0,c.start),d=h.charAt(h.length-1),p=l.lastChild&&"BR"===l.lastChild.nodeName?l.lastChild:null,g=n.any(this.config.openingMatches,function(e){return e.test(d)})||p,m="";m=!d||g?e:/\d/.test(d)?i:t;var f=document.createTextNode(m),v=a.getRangeAt(0);return v.deleteContents(),v.insertNode(f),p&&p.previousSibling&&"BR"===p.previousSibling.nodeName&&s(p).remove(),v.setEndAfter(f),v.collapse(!1),a.removeAllRanges(),a.addRange(v),!0}var c=function(t,i){return a.browser.msie?null:(this.editor=t,this.config={openingMatches:[/\s/,/\u200B/,/[=]/],singleQuotes:{open:"",close:"",prime:""},doubleQuotes:{open:"",close:"",prime:""}},n.extend(this.config,i||{}),void e.call(this))};return c}();e.exports=l},function(e,t,i){var n=i(3),s=i(9),o=i(237),r=function(){function e(){s(this.element).on("keydown.keycombos",i.bind(this)),this.listening=!0}function t(){s(this.element).off("keydown.keycombos"),this.listening=!1}function i(e){var t=this.humanKeys.translate(e);t&&a.call(this,t)&&(r.call(this,t,e),e.preventDefault(),e.stopImmediatePropagation())}function r(e,t){n.each(c.call(this,e),function(i){n.has(i,"callback")&&n.has(i,"context")&&i.callback.call(i.context,t,e)})}function a(e){return c.call(this,e).length>0}function l(e,t){var i=c.call(this,e);return n.filter(i,{callback:t}).length>0}function c(e){return n.has(this.subscribers,e)?this.subscribers[e]:[]}function u(t,i,s){return l.call(this,t,i)?void 0:(n.has(this.subscribers,t)||(this.subscribers[t]=[]),this.subscribers[t].push({callback:i,context:s}),this.listening||e.call(this),this)}function h(){this.subscribers={},t.call(this)}function d(e,i){return e?n.has(this.subscribers,e)?(i&&(this.subscribers[e]=n.reject(this.subscribers[e],{callback:i})),i&&0!==this.subscribers[e].length||delete this.subscribers[e],0===n.values(this.subscribers).length&&t.call(this),this):this:(h.call(this),this)}var p=function(e){e=e||{},this.debounceRate=e.debounceRate||100,this.element=e.element||document,this.humanKeys=e.humanKeys||new o,this.subscribers={},this.listening=!1};return p.prototype.on=function(e,t,i){n.each((e||"").split(" "),function(e){u.call(this,this.humanKeys.normalize(e),t,i)},this)},p.prototype.off=function(e,t){e?n.each(e.split(" "),function(e){d.call(this,this.humanKeys.normalize(e),t)},this):d.call(this,null,t)},p}();e.exports=r},function(e,t,i){var n=i(3),s=function(){function e(){return navigator.platform.match(/^Win/i)?"Win":navigator.platform.match(/^Mac/i)?"Mac":navigator.platform.match(/^Linux/i)?"Linux":navigator.platform}function t(){return n.extend({},this.prettyMapping,this.platformPrettyMapping[e.call(this)])}function i(){return this.platformModifiers[e.call(this)]||{}}function s(){var t=e.call(this);return n.has(this.platformPrettySeperators,t)?this.platformPrettySeperators[t]:this.seperator}function o(e){return this.specialKeys[e.keyCode]||String.fromCharCode(e.keyCode)}function r(e){return n.filter(this.modifiers,function(t){return e[t+"Key"]})}function a(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}var l=["ctrl","meta","alt","shift"],c="+",u={37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",187:"PLUS",61:"PLUS",188:"COMMA",189:"MINUS",173:"MINUS",190:"DOT",32:"SPACE"},h={LEFT:"",RIGHT:"",DOWN:"",UP:"",PLUS:"+",COMMA:",",MINUS:"-",DOT:".",SPACE:"Space"},d={Win:{meta:"ctrl"},Linux:{meta:"ctrl"}},p={Mac:{meta:"",shift:"",alt:""}},g={Win:"-",Linux:"-",Mac:""},m=function(e){e=e||{},this.modifiers=e.modifiers||l,this.separator=e.separator||c,this.specialKeys=e.specialKeys||u,this.prettyMapping=e.prettyMapping||h,this.platformModifiers=e.platformsModififiers||d,this.platformPrettyMapping=e.platformPrettyModifiers||p,this.platformPrettySeperators=e.platformPrettySeperators||g};return m.prototype.translate=function(e){var t=r.call(this,e);return 0===t.length?null:t.concat(o.call(this,e)).join(this.separator)},m.prototype.normalize=function(e){var t=e.split(this.separator),s=i.call(this),o="";return n.each(this.modifiers,function(e){var i=n.indexOf(t,e.toLowerCase()),r=s[e]||e;i>=0&&(o+=r+this.separator,t.splice(i,1))},this),o+t.join(this.separator).toUpperCase()},m.prototype.pretty=function(e){var i=this.normalize(e),o=t.call(this),r=s.call(this);return n.map(i.split(this.separator),function(e){return o[e]||a(e)},this).join(r)},m}();e.exports=s},function(e,t,i){var n=i(3),s=i(9),o=i(230),r=i(226),a=i(232),l=i(234),c=i(235),u=i(236),h=i(228),d=function(){function e(){m.call(this,C);var e=s("<div />",{"data-js":"editor-wrapper","class":"editor-wrapper"}).css("position","relative"),i=s("<div />",{"data-js":"editor-slot","class":"editor-slot"}).css("position","relative");s(this.element).wrap(e).wrap(i),this.placeholderElement=s("<div />",{"data-js":"editor-placeholder","class":"editor-placeholder"}).css("position","absolute"),i=s(this.element).parent(),i.append(this.placeholderElement),d.call(this),t.call(this)}function t(){var e=this,t=function(){w.call(this),i.call(this),this.onChange()};s(this.element).on("input keydown keyup keypress mousedown mouseup",function(t){e.config.onClientEvent.call(e,t)}),s(this.element).on("keydown",function(t){if(t.keyCode===T.shift)e.keyModifiers.shift=!0;else if(t.keyCode===T.backspace)x.call(e);else if(t.keyCode===T.enter)return e.config.forceSingleLine||t.metaKey||_.call(e,this,!1),void t.preventDefault();n.defer(function(){e.onChange(t)})}),s(this.element).on("keyup",function(i){i.keyCode===T.shift?e.keyModifiers.shift=!1:i.keyCode===T.enter?x.call(e):i.keyCode!==T.backspace&&i.keyCode!==T["delete"]||n.defer(function(){x.call(e)}),t.call(e)}),s(this.element).on("input",function(i){t.call(e)}),s(this.element).on("blur",function(t){e.onChange()});var o=!1;s(this.element).on("mouseup",function(){o=!1,i.call(e)}),s(this.element).on("mousedown",function(e){o=!0}),s(this.element).on("mouseleave",function(){o&&i.call(e)}),s(this.element).on("paste",function(t){var i=(t.originalEvent||t).clipboardData;e.config.pasteHook(i,e.keyModifiers.shift)||p.call(e,i,t),t.preventDefault()}),s(this.element).on("drop",function(e){e.stopPropagation(),e.preventDefault()}),this.placeholderElement.on("click",function(){e.isEmpty()&&s(e.element).focus()}),s(this.element).on("focus",function(){n.defer(function(){e.onChange()})})}function i(){var e=this;setTimeout(function(){var t=a.getSelection();e.config.onSelection.call(e,t)},200)}function d(){var e=this.isEmpty()?this.config.placeholder:"",t=s(this.placeholderElement);t.html(e);var i=t.outerHeight();i&&s(this.element).css("min-height",Math.max(parseInt(t.css("min-height"),10)||0,i))}function p(e,t){var i="";if(n.contains(e.types,"text/plain"))i=e.getData("text/plain"),i=this.dataFilter.filterPlaintext(i),v.call(this,i);else{if(!n.contains(e.types,"text/html"))return;i=e.getData("text/html"),i=this.dataFilter.filterHTML(i);var s=i.replace(/<br(\s*)\/*>/gi,"\n").replace(/(<[p|div])/gi,"\n$1"),o=document.implementation.createHTMLDocument("");o.body.innerHTML=s;var r=o.body,a=r.textContent||r.innerText||"",l=a.split("\n").join("<br>");v.call(this,l)}if(this.config.forceSingleLine){var c=f.call(this).replace(/<br\s*\/*>/g," ");m.call(this,c)}this.onChange(t)}function g(){s(this.element).contents().filter(function(){return 3===this.nodeType}).wrap("<span></span>")}function m(e){s(this.element).html(e)}function f(){return s(this.element).html().trim()}function v(e){if(e=e.replace(/[<]br\s?\/?[>]$/,""),e=this.dataFilter.convertToBrowserSpaces(e),!e)return void h.warn("Cannot insert empty data");var t=a.getSelection();if(!t||!t.focusNode)return void h.warn("Cannot insert without the editor having a cursor or selection");var i=t.getRangeAt(0);i.deleteContents();var n=i.createContextualFragment(e);i.insertNode(n),t.removeAllRanges(),i.collapse(!1),t.addRange(i)}function _(e,t){t||e.lastChild&&"br"===e.lastChild.nodeName.toLowerCase()||e.appendChild(document.createElement("br"));var i=a.getSelection();if(i){var n=i.getRangeAt(0),s=document.createElement("br");n.deleteContents(),n.insertNode(s),n.setStartAfter(s),n.setEndAfter(s),n.collapse(!1),i.removeAllRanges(),i.addRange(n)}}function b(e){s(e).contents().each(function(e,t){t.nodeType===Node.TEXT_NODE?t.textContent=t.textContent.replace(E,""):t.nodeType===Node.ELEMENT_NODE&&b(t)})}function w(){if(!this.isEmpty()){var e=y.call(this);if(e&&e.nodeType===Node.ELEMENT_NODE){var t=e.textContent||e.innerText||"",i=t.match(E);if(i){var n=r.saveSelection(e);n.start-=(t.substr(0,n.start).match(E)||"").length||0,n.end-=(t.substr(0,n.end).match(E)||"").length||0,b(e),r.restoreSelection(n)}}}}function y(){var e=k.call(this);if(!e){var t=s(this.element).children();if(!t.length)return null;e=t.last().get(0)}return e}function k(e){return e||(e=!a.getSelection()&&this.lastSelection?a.getParentNodes(this.lastSelection.anchorNode):a.getNodeList()),n.find(e.reverse(),function(e){return e.nodeType===Node.ELEMENT_NODE})}function x(){this.isEmpty()&&(m.call(this,C),this.setCursorToEnd())}var C="<span>&#8203;</span>",S="<span></span>",E=/\u200B/g,T={shift:16,enter:13,esc:27,backspace:8,"delete":46,tab:9,right:39},A=function(t,i){if(!t)throw new Error("A valid element parameter is required to initalize the editor");this.element=t,this.keyComboEvents=i.keyComboEvents||new u({element:this.element}),this.keyComboEvents.on("meta+b meta+i meta+k meta+u",n.noop),this.config={placeholder:!1,onChange:function(){},onSelection:function(e){},onClientEvent:function(e){},pasteHook:function(e,t){return!1},filterForSetData:function(e){return e},filterForGetData:function(e){return e},filterRules:{elements:["p","br","div"],attributes:{},remove_contents:["style","noscript","script","meta"],protocols:{}},forceSingleLine:!1,smartQuotes:{enabled:!1,config:{}}},n.extend(this.config,i||{}),this.dataFilter=new o(this.config.filterRules),this.onChange=function(){this.previousRawData!==f.call(this)&&(g.call(this),d.call(this),this.config.onChange.apply(this,arguments),this.previousRawData=f.call(this))},this.keyModifiers={shift:!1},this.undoManager=new l(this),this.config.smartQuotes.enabled&&(this.smartQuoter=new c(this)),e.call(this)};return A.prototype.getData=function(e){var t=f.call(this);t=this.config.filterForGetData.call(this,t);var i=t.replace(/<br(\s*)\/*>/gi,"\n").replace(/(<[p|div])/gi,"\n$1").replace(E,""),n=document.createElement("div");n.innerHTML=i;var s=n.textContent||n.innerText||"",o=e?s.trim():s;return o},A.prototype.setData=function(e){e=this.config.filterForSetData.call(this,e),e=this.dataFilter.filterPlaintext(e),m.call(this,e),x.call(this),this.onChange()},A.prototype.setHTML=function(e){m.call(this,e),this.onChange()},A.prototype.getHTML=function(){return f.call(this)},A.prototype.insertData=function(e,t){t&&(e=this.dataFilter.filterHTML(e)),v.call(this,e),this.onChange()},A.prototype.blur=function(){return s(this.element).blur()},A.prototype.focus=function(e){var t=s(this.element).focus();return e||this.setCursorToEnd(),t},A.prototype.hasFocus=function(){return s(this.element).is(":focus")},A.prototype.setPlaceholder=function(e){this.config.placeholder=e,d.call(this)},A.prototype.isEmpty=function(){var e=this.getData(!1);if(""===e||"\n"===e||"\r\n"===e)return!0;var t=f.call(this);return t===C||t===S||""===t},A.prototype.getCurrentElement=function(){return a.getNearestElement()},A.prototype.setCursorToStart=function(e){var t=s(this.element);e=e&&t.find(e).first().get(0)||t.children().first().get(0),e&&r.setToStart(e)},A.prototype.setCursorToEnd=function(e){var t=s(this.element);e=e&&t.find(e).last().get(0)||t.children().last().get(0),e&&r.setToEnd(e)},A.prototype.teardown=function(){this.undoManager.teardown(),this.keyComboEvents.off()},A}();e.exports=d},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="editor editor-plaintext" aria-label="'+(null==(__t=ariaLabel)?"":_.escape(__t))+'" contenteditable="true" data-js-plaintexteditor></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(110),a=i(241),l=i(160),c=i(204),u=i(211),h=i(205),d=i(242),p=o.extend({className:"popover--tag-suggest",defaults:{currentKeyedChoice:-1,currentMousedChoice:-1,interactive:!1,numSuggestions:0,suggestPending:!1,lastResults:{}},mixins:[l,c,h,u],template:d,initialize:function(e){this.model=new a(e),this.post=e.post,this.listenTo(this.model,"error",this._fetchSuggestionsError),this.listenTo(this,"change:lastResults",this.preRender)},preRender:function(e,t){var i=n.reduce(t.results,function(e,t){return e+(n.isArray(t)?t.length:0)},0);this.set({currentKeyedChoice:-1,interactive:!1});var s=this.get("suggestPending");i>0&&s!==!1&&-1===this.post.get("tags").indexOf(s)&&this.render()},render:function(){return this.$el.html(this.template(this.get("lastResults"))),r.trigger("postForms:dismissListener:suspend"),this},afterRender:function(){this.$tagSuggestWrapper=this.js$("tagSuggestWrapper"),s(".item-option",this.$el).on("click",n.bind(this.selectCurrentCycledChoice,this)),s(".item-option",this.$el).on("mouseover",n.bind(this.handleMouseOver,this)),this.$el.on("mouseout",n.bind(this.handleMouseOut,this))},teardown:function(){return this.$el.remove(),r.trigger("postForms:dismissListener:resume"),this},cycleUp:function(){this._cycle(-1)},cycleDown:function(){this._cycle(1)},_cycle:function(e){var t=this.get("currentKeyedChoice"),i=this.get("currentMousedChoice"),s=n.isNumber(i)&&-1!==i,o=s?i:t,r=(o+e)%this.get("numSuggestions");this.get("numSuggestions")&&(this.set({currentKeyedChoice:r>=0?r:-1,currentMousedChoice:-1}),this.styleMenuItems(),this.set("interactive",this.get("currentKeyedChoice")>=0))},getCycledTag:function(){return s(".item-option.cycled",this.$el).data("tag")},selectCurrentCycledChoice:function(e){this.set("interactive",!0),s(e.currentTarget).addClass("cycled"),this.trigger("tagSuggest:submitTag")},styleMenuItems:function(e){var t,i=e&&"mouseout"!==e.type,o=this.get("currentKeyedChoice");n.each(s(".item-option",this.$el),function(n,r){i?s(n).toggleClass("cycled",e.currentTarget===n):(s(n).toggleClass("cycled",r===o),r===o&&(t=s(n)))},this),i||-1===o||this.cycleScroll(t)},cycleScroll:function(e){var t=parseInt(e.position().top,10),i=t+parseInt(e.height(),10),n=parseInt(e.outerHeight(),10),s=parseInt(this.$tagSuggestWrapper.height(),10),o=parseInt(this.$tagSuggestWrapper.scrollTop(),10);i>s?this.$tagSuggestWrapper.scrollTop(o+n):0>t&&this.$tagSuggestWrapper.scrollTop(t+o)},handleMouseOver:function(e){this.styleMenuItems(e),this.set({interactive:!0,currentMousedChoice:s(e.currentTarget).index(".item-option")})},handleMouseOut:function(e){this.styleMenuItems(e),this.set({interactive:-1!==this.get("currentKeyedChoice"),currentMousedChoice:-1})},fetchSuggestions:n.debounce(function(e,t){var i={query:e,success:n.bind(this.renderQueryResults,this),existing:t};this.set("suggestPending",e),this.model.fetch(i)},100),_fetchSuggestionsError:n.noop,renderQueryResults:function(e,t,i){var n=this.finalResultsFilter(e.attributes.tagSuggestions,i.existing);this.set("numSuggestions",n.userTags.length+n.suggestions.length),this._rendered&&this.teardown(),this.set("lastResults",{results:n,queryRegex:new RegExp(this.model._escapeRegex(i.query),"i")})},finalResultsFilter:function(e,t){return n.mapValues(e,function(e){return n.difference(e,t)})},dismiss:function(){this.teardown(),this.set({interactive:!1,suggestPending:!1,lastResults:{}})}});e.exports=p},function(e,t,i){"use strict";var n=i(3),s=i(114),o=s.extend({defaults:{fetchOptions:{url:"/svc/tag_suggest",with_form_key:!0},suggestCache:{},queryHistory:[],maxCacheSize:20,maxSuggests:5,tagSuggestions:{}},initialize:function(e){if(!1==("user"in e&&"post"in e))throw new Error("Tag Suggestions must be provided user and post models.")},fetch:function(e){return"query"in e&&"success"in e&&n.isFunction(e.success)||console.error("TagSuggestion must be provided a query and a success callback."),n.extend(e,this.get("fetchOptions")),e.query in this.get("suggestCache")?(this.set("tagSuggestions",this.get("suggestCache")[e.query]),e.success.call(this,this,"suggestCache",e)):(e.data={q:e.query},s.prototype.fetch.call(this,e))},parse:function(e,t){var i=this.get("user"),n=this.get("post").get("tumblelog"),s={suggestions:"tags"in e?e.tags:[],userTags:n?i.getChannelProperty(n,"tags"):[]};return s.userTags||(s.userTags=[]),s=this._processQueryResults(s,t),this._cacheQueryResults(s,t),{tagSuggestions:s}},_processQueryResults:function(e,t){var i=new RegExp(this._escapeRegex(t.query),"i");return e.suggestions=n.compact(n.map(e.suggestions,function(e){return e.tag})).slice(0,this.get("maxSuggests")),e.userTags=n.compact(n.filter(e.userTags,function(e){return i.test(e)})).slice(0,this.get("maxSuggests")),e},_cacheQueryResults:function(e,t){var i=n.clone(this.get("suggestCache")),s=n.clone(this.get("queryHistory"));i[t.query]=e,s.push(t.query),n.size(i)>this.get("maxCacheSize")&&(delete i[s[0]],s.shift()),this.set("suggestCache",i),this.set("queryHistory",s)},_escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}});e.exports=o},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="pop-menu"><div class="inner select-center"><div class="item-option-wrapper" data-js-tagsuggestwrapper> ',_.each(results.userTags,function(e){__p+=" ";var t=_.escape(e).replace(queryRegex,"<u>$&</u>");__p+=' <div class="item-option user-tags" data-tag="'+(null==(__t=_.escape(e))?"":__t)+'"><span class="tag-suggest-tag"> '+(null==(__t=t)?"":__t)+" </span></div> "}),__p+=' <div class="header-item">'+(null==(__t=__("Popular"))?"":_.escape(__t))+"</div> ",_.each(results.suggestions,function(e){__p+=" ";var t=_.escape(e).replace(queryRegex,"<u>$&</u>");__p+=' <div class="item-option suggest-tags" data-tag="'+(null==(__t=_.escape(e))?"":__t)+'"><span class="tag-suggest-tag"> '+(null==(__t=t)?"":__t)+" </span></div> "}),__p+=" </div></div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(165),a=o.extend({initialize:function(e){this.el=e.el||null,this.itemSelector=e.itemSelector||".item",this.dropInParent=e.dropInParent||!1,this.transparentPlaceholder=e.transparentPlaceholder,this.beforeDragStart=e.beforeDragStart||n.noop,this.afterDragEnd=e.afterDragEnd||n.noop,this.scrollable=e.scrollable||!1,this.$items=this.$(this.itemSelector),this.isAnimating=!1,this.disableAnimation=e.disableAnimation||!1,this.disableAnimation&&(this.calculateDropTarget=n.throttle(this.calculateDropTarget,500)),this.$currentlyDraggedItem=null,this.$placeholder=null,this.placeholderElement=null,this.renderedPlaceholder=!1,this.reloadItems()},itemEvents:function(e){e||(e=this.itemSelector);var t={};return t["dragstart "+e]="setPlaceholder",t["dragenter "+e]="calculateDropTarget",t["dragend "+e]="resetPlaceholder",this.dropInParent?(t.dragover="cancelEvent",t.drop="dropItemAndResetPlaceholder"):(t["dragover "+e]="cancelEvent",t["drop "+e]="dropItem"),t},setPlaceholder:function(e){this.renderedPlaceholder=!1,e.originalEvent.dataTransfer.effectAllowed="move";try{e.originalEvent.dataTransfer.setData("text/html","")}catch(t){}if(this.$currentlyDraggedItem=s(e.currentTarget),this.$currentlyDraggedItem){if(this.$placeholder=this.$currentlyDraggedItem.clone().addClass("sortable-placeholder"),this.transparentPlaceholder&&this.$placeholder.addClass("transparent-placeholder"),!this.disableAnimation){var i=this.$currentlyDraggedItem.outerWidth();this.$placeholder.data("item-width",i).data("need-animation",!1)}this.placeholderElement=this.$placeholder.get(0),this.$currentlyDraggedItem.addClass("sortable-dragging"),this.beforeDragStart(),this.trigger("dragstart",this),this.scrollable&&(this.$el.on("dragover."+this.cid,n.throttle(function(e){var t=.2,i=window.innerHeight,n=e.originalEvent.clientY/i,s=this.getBoundingClientRect();t>n&&s.top<0?window.scrollBy(0,-(200*(t-n))):n>1-t&&window.scrollBy(0,200*(t+n-1)),e.preventDefault()},50)),this.$currentlyDraggedItem.one("dragend",n.bind(function(){this.$el.off(["dragenter."+this.cid,"dragover."+this.cid].join(" "))},this)))}},calculateDropTarget:function(e){if(this.$currentlyDraggedItem&&!this.isAnimating){e.preventDefault(),this.renderedPlaceholder=!0;var t=e.currentTarget,i=s(t);if(t===this.placeholderElement)return!1;this.$currentlyDraggedItem.hide();var n,o=i.index(this.itemSelector),r=this.$placeholder.index(this.itemSelector),a=this.$placeholder.data("need-animation")||!1,l=this.$placeholder.data("item-width");return this.disableAnimation||(n=s("<span>").css({width:l,display:"inline-block"}),this.$placeholder.after(n),a&&this.$placeholder.css({width:0,padding:0})),o>r?i.after(this.placeholderElement):i.before(this.placeholderElement),this.disableAnimation||(a?this.animatePlaceholderWidth(n,this.$placeholder,l,200):this.$placeholder.data("need-animation",!0)),this.lastDroppable=t,!1}},animatePlaceholderWidth:function(e,t,i,s){this.isAnimating=!0,r.animate(e,"stop"),r.animate(t,"stop"),r.animate(e,{width:0},s,"easeInOutQuart",n.bind(function(){e.remove(),this.isAnimating=!1},this)),r.animate(t,{width:i},s,"easeInOutQuart")},cancelEvent:function(e){this.$currentlyDraggedItem&&e.preventDefault()},dropItem:function(e){return this.$currentlyDraggedItem&&this.renderedPlaceholder&&this.placeholderElement&&(e.stopPropagation(),this.$currentlyDraggedItem.insertAfter(this.placeholderElement)),!1},resetPlaceholder:function(e){this.renderedPlaceholder=!1,this.placeholderElement=null,this.$currentlyDraggedItem&&(this.$currentlyDraggedItem.removeClass("sortable-dragging").show(),this.$currentlyDraggedItem=null,this.$placeholder.detach(),e.stopPropagation(),
this.afterDragEnd(),this.trigger("dragend",this),this.lastDroppable=null)},dropItemAndResetPlaceholder:function(e){return this.dropItem(e),this.resetPlaceholder(e)},sequence:function(){var e=this.$(this.itemSelector).toArray();return n.uniq(n.pluck(e,"id"))},reloadItems:function(){return this.$items=this.$(this.itemSelector),n.each(this.$items,function(e){e.draggable=!0,s(e).find("a").attr("draggable",!1),s(e).find("img").attr("draggable",!1)}),this.delegateEvents(this.itemEvents(this.itemSelector)),this},disableItems:function(){return n.each(this.$items,function(e){e.draggable=!1}),this.undelegateEvents(),this},teardown:function(){return this.undelegateEvents(),this.scrollable&&this.$el.off(["dragenter."+this.cid,"dragover."+this.cid].join(" ")),n.each(this.$items,function(e){s(e).add("a, img",e).removeAttr("draggable")}),this.$items=null,this.$placeholder=null,this.beforeDragStart=null,this.afterDragEnd=null,this.calculateDropTarget=null,this}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="tag-input-wrapper" data-js-taginputfieldwrapper><div data-subview="tagInputField"></div><div class="ghost" data-js-taginputghost></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(204),a=i(205),l=s.extend({className:"tag-label",defaults:{label:""},mixins:[o,r,a],events:{click:"toggleTagSelection",mouseover:"hoveredTag",mouseout:"unhoveredTag"},tagName:"span",initialize:function(e){e=n.extend({},e),this.set(n.pick(e,n.keys(this.defaults)))},render:function(){return this.$el.text(this.get("label")),this},toggleTagSelection:function(e){this.trigger("toggleTagSelection",e)},hoveredTag:function(e){this.trigger("addHoverStyle",{label:this.get("label"),eventTarget:e.target})},unhoveredTag:function(e){this.trigger("removeHoverStyle",e)}});e.exports=l},function(e,t,i){"use strict";var n=i(149),s=i(204),o=i(205),r=n.extend({mixins:[s,o],initialize:function(){},render:function(){return this}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(204),r=i(205),a=i(160),l=i(248),c=i(249),u=s.extend({className:"post-forms--social-buttons",events:{"click [data-js-shareIcon]":"_onClickShareIcon","mouseenter [data-js-twitterIcon]":"_onMouseEnterTwitterIcon"},mixins:[o,r,a],services:["facebook","twitter"],template:l,defaults:{facebook:!1,twitter:!1,facebookOn:!1,twitterOn:!1},initialize:function(e){this.options=e=n.extend({},e,{shift:{x:90,y:10},identifier:"postForms:tweetDropdown"}),n.extend(this,n.pick(e,"post","user","uploads","dragEvents")),this.updateStateFromPost(),this.shouldShowSocialIcons()||this.set({twitter:!1,facebook:!1}),this.updatePostFromState()},_onClickShareIcon:function(e){e.preventDefault();var t=this.$(e.currentTarget),i=t.parent(),n=i.data("service"),s=this.post.get("tumblelog"),o=this.user.getChannel(s);switch(n){case"twitter":o.set("twitter_send_posts",!this.get("twitterOn")),this.post.set("send_to_twitter",!this.get("twitterOn")),this.toggleTweetDropdown(this.post.get("send_to_twitter"));break;case"facebook":o.set("facebook_opengraph_send_posts",!this.get("facebookOn")),this.post.set("send_to_fbog",!this.get("facebookOn"))}},_onMouseEnterTwitterIcon:function(e){this.get("twitterOn")&&(e.preventDefault(),this.toggleTweetDropdown(!0))},_onChangeTumblelog:function(){this.teardown(),this.updateStateFromPost(),this.updatePostFromState(),this.render()},_onChangePostState:function(){"private"===this.post.get("pseudoState")&&this.post.changed.is_private?(this.lastSettings=n.pick(this.attributes,"twitter","facebook"),this.set({twitter:!1,facebook:!1})):this.set(this.lastSettings)},shouldShowSocialIcons:function(){return"new"===this.post.get("mode")||"reblog"===this.post.get("mode")||"published"!==this.post.get("state")&&"private"!==this.post.get("state")},updateStateFromPost:function(){var e=this.post.get("tumblelog"),t=this.user.getChannel(e),i=t.get("can_send_to_twitter"),s=t.get("can_send_to_facebook");this.shouldShowSocialIcons()||(i=s=!1);var o=this.post.get("send_to_twitter"),r=this.post.get("send_to_fbog");"edit"!==this.post.get("mode")&&(o=t.get("twitter_send_posts"),r=t.get("facebook_opengraph_send_posts")),this.set({twitter:i,facebook:s,twitterOn:!!o,facebookOn:!!r}),this.lastSettings=n.pick(this.attributes,"twitter","facebook")},updatePostFromState:function(){this.post.set({send_to_twitter:this.get("twitterOn"),send_to_fbog:this.get("facebookOn")})},toggleTweetDropdown:function(e){e?!1===this.tweetDropdown.isRendered()&&this.tweetDropdown.render():this.tweetDropdown.teardown()},serialize:function(){return this.toJSON()},beforeRender:function(){this.tweetDropdown=new c(this.options),this.listenTo(this.post,"change:send_to_fbog",function(e,t){this.set("facebookOn",!!t)}),this.listenTo(this.post,"change:send_to_twitter",function(e,t){this.set("twitterOn",!!t)}),this.listenTo(this,"change:twitterOn",function(e,t){this.js$("twitter").toggleClass("hidden",!this.get("twitter")).toggleClass("checked",t)}),this.listenTo(this,"change:facebookOn",function(e,t){this.js$("facebook").toggleClass("hidden",!this.get("facebook")).toggleClass("checked",t)})},render:function(){return this.$el.html(this.template(this.toJSON())),this.tweetDropdown.setPinnedTarget(this.js$("tweetDropdownPin")),this},afterRender:function(){this.listenTo(this.post,"change:state",this._onChangePostState),this.listenTo(this.post,"change:tumblelog",this._onChangeTumblelog),this.listenTo(this.post,"change:send_to_twitter",function(e,t){t||this.post.unset("customTweet")})},teardown:function(){return this.stopListening(),this.tweetDropdown.teardown(),this}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<ul class="social-buttons"><li data-js-twitter data-service="twitter" data-js-tweetdropdownpin class="social-button twitter '+(null==(__t=twitter?"":"hidden")?"":_.escape(__t))+" "+(null==(__t=twitterOn?"checked":"")?"":_.escape(__t))+'"><label class="social-button--label social-button--twitter" data-js-shareicon data-js-twittericon></label></li><li data-js-facebook data-service="facebook" class="social-button facebook '+(null==(__t=facebook?"":"hidden")?"":_.escape(__t))+" "+(null==(__t=facebookOn?"checked":"")?"":_.escape(__t))+'"><label class="social-button--label social-button--facebook" data-js-shareicon data-js-facebookicon></label></li></ul>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(110),r=i(160),a=i(204),l=i(205),c=i(211),u=i(250),h=i(182).truncateLongStrings,d=s.extend({className:"popover--tweet-dropdown",defaults:{focused:!1},events:{"input [data-js-customTweet]":"_onCustomTweetInput","keyup [data-js-customTweet]":"_onCustomTweetInput","change [data-js-customTweet]":"_onCustomTweetInput","click [data-js-dismissTweet]":"_onClickDismissTweet",keydown:"_onKeyDown"},mixins:[r,a,l,c],template:u,_onCustomTweetInput:function(){var e=n.trim(this.js$("customTweet").val());this.model.set("customTweet",e),this.truncateTweet()},_onClickDismissTweet:function(){this.teardown()},_onKeyDown:function(e){27===e.keyCode&&(e.stopPropagation(),this.teardown())},_onChangePost:function(){n.isString(this.model.get("customTweet"))||this.js$("customTweet").val(this.model.getTweetText()),this.updateTweetLengthCount()},updateTweetLengthCount:function(){var e=this.model.getTweetTextLength();this.js$("tweetRemaining").text(140-e)},truncateTweet:function(){var e=this.js$("customTweet"),t=e.get(0),i=e.val(),n=i;if(!(this.model.getTweetTextLength(i)<=140)){var s=this.model.shortUrlLength,o=i.match(/\[URL\]/gi),r=!0;if(o&&1===o.length){var a=i.toLowerCase().indexOf("[url]");140-s-1>a?(i=h(i,140-s+5),r=!1):a&&(i=h(i.split(/\[URL\]/i).join(""),140-s-1)+" [URL]")}else i=h(i,140);if(this.model.set("customTweet",i),n!==i){var l=t.selectionEnd||0,c=e.scrollTop();if(r){var u=i.toLowerCase().lastIndexOf(" [url]");0>u&&(u=i.toLowerCase().lastIndexOf("[url]")),0>u&&(u=i.toLowerCase().lastIndexOf(" [url]")),0>u&&(u=i.toLowerCase().lastIndexOf("[url]")),u>=0&&l>u&&(l=u)}if(l=Math.max(0,Math.min(l,i.length)),e.val(i).focus(),t.setSelectionRange)t.setSelectionRange(l,l);else if(t.createRange){var d=t.createRange();d.setStart("character",l),d.setEnd("character",l),d.select()}e.scrollTop(c)}}},setCaret:function(e){var t=this.js$("customTweet"),i=t.get(0),n=t.val(),s=n.toLowerCase().lastIndexOf(" [url]");if(0>s&&(s=n.toLowerCase().lastIndexOf("[url]"),e&&s>=0&&(n=n.slice(0,s)+" "+n.slice(s),this.js$("customTweet").val(n))),0>s&&(s=n.length),t.focus(),i.setSelectionRange)i.setSelectionRange(s,s);else if(i.createRange){var o=i.createRange();o.setStart("character",s),o.setEnd("character",s),o.select()}},serialize:function(){return n.extend({tweetText:this.model.getTweetText(),tweetRemaining:140-this.model.getTweetTextLength()},this.toJSON())},afterRender:function(){this.listenTo(this.model,"change",this._onChangePost),n.defer(n.bind(function(){this.setCaret(!0)},this))},render:function(){return this.delegateEvents(),this.$el.html(this.template(this.serialize())),this.model.get("customTweet")&&this.js$("customTweet").val(this.model.get("customTweet")),o.trigger("postForms:dismissListener:suspend"),this},teardown:function(){return""===this.model.get("customTweet")&&this.model.set("send_to_twitter",!1),this.remove(),o.trigger("postForms:dismissListener:resume"),this}});e.exports=d},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div data-js-tweetpopover><div class="tweet-container"><textarea aria-label="'+(null==(__t=__("Custom tweet"))?"":_.escape(__t))+'" data-js-customtweet class="tweet-textarea">'+(null==(__t=tweetText)?"":_.escape(__t))+'</textarea><div data-js-tweetremaining class="tweet-remaining">'+(null==(__t=tweetRemaining)?"":_.escape(__t))+'</div></div><button data-js-dismisstweet type="button" class="tweet-dismiss-button">'+(null==(__t=__("Done"))?"":_.escape(__t))+"</button></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(101),r=i(110),a=i(160),l=i(204),c=i(205),u=i(252),h=i(253),d=i(258),p=s.extend({className:"post-form--save-button",events:{"click [data-js-clickableSaveDropdown]":"toggleSavePostDropdown","mousedown [data-js-clickableSaveDropdown]":"savePostDropdownIntent"},mixins:[a,l,c],template:u,initialize:function(e){this.options=e=n.extend({shift:{x:0,y:10},identifier:"postForms:savePostDropdown"},e),n.extend(this,n.pick(e,"post","user","uploads")),this.savePostDropdown=new h(e),this.set("initialPostPseudoState",this.post.get("pseudoState"))},checkCanPost:function(){this.set("canPost",this.post.isValid()&&!this.uploads.anyUploading())},checkIsActive:function(){this.set("isActive",this.get("canPost")&&!this.savePostDropdown.isRendered())},setStateForContext:function(){if("new"===this.post.get("mode")){var e=this.post.getContextPage();"drafts"===e?this.savePostDropdown.setOptionDraft():"queue"===e&&this.savePostDropdown.setOptionQueue()}},render:function(){return this.$el.html(this.template()),this.loader=this.subViews.loader=new d({variation:"centered small"}),this.savePostDropdown.setPinnedTarget(this.js$("clickableSaveDropdown")),this.attachSubViews(),this.loader.render(),this.setStateForContext(),this.checkCanPost(),this.checkIsActive(),this.set("buttonLabel",this.buttonLabelForPseudoState()),this.updateButtonLabel(),this.updateButtonEnabledState(),this},afterRender:function(){this.listenTo(this.post,"change validate",this.checkCanPost),this.listenTo(this.uploads,"change:uploading",this.checkCanPost),this.listenTo(this.savePostDropdown,"open close",this.checkIsActive),this.listenTo(this.post,"change:state",function(e,t){this.set("buttonLabel",this.buttonLabelForPseudoState(e.get("pseudoState")))}),this.listenTo(r,"postForms:saving",this.showLoader),this.listenTo(r,"postForms:error",this.hideLoader),this.listenTo(this,"change:canPost",this.checkIsActive),this.listenTo(this,"change:isActive",this.updateButtonEnabledState),this.listenTo(this,"change:buttonLabel",this.updateButtonLabel)},updateButtonEnabledState:function(e,t){!n.isUndefined(t)||(t=this.get("isActive")),this.js$("clickableSave").toggleClass("disabled",!t).prop("disabled",!t)},updateButtonLabel:function(e,t){t||(t=this.get("buttonLabel")),this.js$("clickableSave").text(t)},showLoader:function(){this.toggleLoader(!0)},hideLoader:function(){this.toggleLoader(!1)},toggleLoader:function(e){var t=!!e;this.$el.css({width:t?this.$el.width():"",height:t?this.$el.height():""}),this.loader.set("loading",t),this.js$("clickableSaveDropdown").toggle(!t),this.js$("clickableSave").toggle(!t)},buttonLabelForPseudoState:function(e,t,i){switch(e||(e=this.post.get("pseudoState")),t||(t=this.get("initialPostPseudoState")),i||(i=this.post.get("mode")),e){case"published":return o("reblog"===i?"Reblog":"edit"===i&&"published"===t?"Save":"Post");case"queued":return o("Queue");case"scheduled":return o("Schedule");case"draft":return o("Save draft");case"private":return o("edit"===i&&"private"===t?"Save":"Post privately");default:return o("Post")}},toggleSavePostDropdown:function(e){n.isBoolean(e)||(e=!this.savePostDropdown.isOrWasRecentlyRendered()),e?this.savePostDropdown.render():this.savePostDropdown.remove()},savePostDropdownIntent:function(){this.trigger("dropdown:intent")}});e.exports=p},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="split-button"><div data-subview="loader"></div><button class="button-area create_post_button" data-js-clickablesave></button><div class="dropdown-area icon_arrow_carrot_down" data-js-clickablesavedropdown></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(149),r=i(101),a=i(110),l=i(160),c=i(204),u=i(205),h=i(211),d=i(254),p=i(256),g=i(257),m=o.extend({className:"popover--save-post-dropdown",events:{"click [data-js-preview]":"triggerPostPreview","click [data-js-publish]":"setOptionPublish","click [data-js-draft]":"setOptionDraft","click [data-js-private]":"setOptionPrivate","click [data-js-queue]":"setOptionQueue","click [data-js-schedule]":"setOptionSchedule","input [data-js-scheduleText]":"scheduleInputUpdated","keypress [data-js-scheduleText]":"checkScheduleComplete"},mixins:[l,c,u,h],postStateOptions:["published","queued","scheduled","draft","private"],template:g,initialize:function(e){this.user=e.user},render:function(){return this.delegateEvents(),this._updateViewAttributes(),this.$el.html(this.template(this.serialize())),this._updateViewElements(),a.trigger("postForms:dismissListener:suspend"),this},teardown:function(){return this.$el.remove(),a.trigger("postForms:dismissListener:resume"),this},serialize:function(){var e=s.extend({__:r},this.attributes);return e},_updateViewAttributes:function(){this.set({showPreview:this.model.canPreview(),state:this.model.get("pseudoState"),activeOptions:"edit"===this.model.get("mode")&&this.model.get("createdPost")?["published","private"]:this.postStateOptions})},_updateViewElements:function(){"scheduled"===this.model.get("state")?this.js$("scheduleText").val(this.model.get("publish_on")):n("[data-js-scheduleText]",this.$el).hide(),this.js$("preview").toggleClass("disabled",!this.model.isValid())},triggerPostPreview:function(){if(this.model.isValid()){var e=this._previewPost();e&&this.teardown()}},setOptionPublish:function(){this._unSchedule(),this.model.set({state:"published",is_private:!1}),this.teardown()},setOptionDraft:function(){this._unSchedule(),this.model.set("state","draft"),this.teardown()},setOptionPrivate:function(){this._unSchedule(),this.model.set({state:"private",is_private:!0}),this.teardown()},setOptionQueue:function(){this._unSchedule(),this.model.set("state","queued"),this.teardown()},setOptionSchedule:function(){if(!this.scheduling){this.scheduling=!0,this._selectOption(this.js$("schedule")),this.model.set("state","scheduled");var e=this.js$("scheduleText");if(!e.value){var t=e.attr("placeholder");e.val(t),this.model.set("publish_on",t)}this.js$("scheduleText").show()}},scheduleInputUpdated:function(e){this.model.set("publish_on",e.target.value)},checkScheduleComplete:function(e){13===e.which&&this.teardown()},_selectOption:function(e){this.js$("options").children().removeClass("selected"),e.addClass("selected")},_unSchedule:function(){this.scheduling=!1,this.model.set("publish_on","")},_previewPost:function(){var e=this.model.get("tumblelog"),t=this.user.getChannel(e).get("blog_url")+"post/preview",i=this.model.toJSON({url:"/svc/post/update",forServer:!0});if(i.preview_key=p.fetchForBlog(e),s.isEmpty(i.preview_key))return!1;var n=new d({action:t,inputs:i});return n.render().$("form").css({"pointer-events":"none",overflow:"hidden",position:"absolute",bottom:0,right:0,width:1,height:1,opacity:0}).appendTo("body").submit().remove(),!0}});e.exports=m},function(e,t,i){"use strict";var n=i(149),s=i(255),o=n.extend({template:s,initialize:function(e){this.options=e},render:function(){return this.$el.html(this.template(this.options)),this}});e.exports=o},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<form method="POST" target="_blank" action="'+(null==(__t=action)?"":_.escape(__t))+'"> ',_.each(inputs,function(e,t){__p+=' <input type="hidden" name="'+(null==(__t=t)?"":_.escape(__t))+'" value="'+(null==(__t=e)?"":_.escape(__t))+'"> '}),__p+=" </form>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(114),o=i(115),r=s.extend({url:"/svc/post/get_preview_key",defaults:{name:"",key:""},parse:function(e,t){var i=n.get(e,"response.blog_preview_key");return{key:i}}},{fetchForBlog:function(e){var t=new r({name:e});return t.fetch({async:!1,type:"POST",data:{name:t.get("name")}}),t.get("key")}});o.applyTo(r.prototype),e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="pop-menu"><ul class="inner select-left" data-js-options><li class="item-option '+(null==(__t="published"===state?"selected":"")?"":_.escape(__t))+'" data-js-publish><span class="">'+(null==(__t=__("Post now"))?"":_.escape(__t))+'</span></li><li class="item-option '+(null==(__t="queued"===state?"selected":"")?"":_.escape(__t))+" "+(null==(__t=-1===activeOptions.indexOf("queued")?"hidden":"")?"":_.escape(__t))+'" data-js-queue><span class="">'+(null==(__t=__("Add to queue"))?"":_.escape(__t))+'</span></li><li class="item-option '+(null==(__t="draft"===state?"selected":"")?"":_.escape(__t))+" "+(null==(__t=-1===activeOptions.indexOf("draft")?"hidden":"")?"":_.escape(__t))+'" data-js-draft><span class="">'+(null==(__t=__("Save as draft"))?"":_.escape(__t))+'</span></li><li class="item-option '+(null==(__t="private"===state?"selected":"")?"":_.escape(__t))+'" data-js-private><span class="">'+(null==(__t=__("Post privately"))?"":_.escape(__t))+'</span></li><li class="item-option '+(null==(__t="scheduled"===state?"selected":"")?"":_.escape(__t))+" "+(null==(__t=-1===activeOptions.indexOf("scheduled")?"hidden":"")?"":_.escape(__t))+'" data-js-schedule><span class="">'+(null==(__t=__("Schedule"))?"":_.escape(__t))+'</span><br><input class="field square solid" type="text" autocomplete="off" placeholder="Next Tuesday, 10am" data-js-scheduletext></li> ',showPreview&&(__p+=' <li class="item-option full" data-js-preview><button class="tx-button">'+(null==(__t=__("Preview on blog"))?"":_.escape(__t))+"</button></li> "),__p+=" </ul></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(259);e.exports=n},function(e,t,i){"use strict";var n=i(156),s=i(260),o=n.extend({className:"knight-rider-container",template:s,defaults:{variation:"",loading:!1},_onChangeLoading:function(e,t){this.$el.toggleClass("loading",t),this.$el.find("[data-js-knightRider]").toggleClass("animate",t),this.$el.toggle(t)},afterRender:function(){this._onChangeLoading(this,this.get("loading")),this.listenTo(this,"change:loading",this._onChangeLoading)}});e.exports=o},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="knight-rider-loader '+(null==(__t=variation)?"":_.escape(__t))+'" data-js-knightrider><div class="knight-rider-bar"></div><div class="knight-rider-bar"></div><div class="knight-rider-bar"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(149),s=i(3),o=i(182),r=i(205),a=i(262),l=n.extend({mixins:[r],template:a,className:"post-form--allow-answers",events:{"click [data-js-allowAnswersCheckbox]":"updateModel"},initialize:function(e){this.model=e.model},_onModelChange:function(){var e=!1;s.each(this.model.allowAnswerFields,function(t){return this.endsWithQuestionMark(this.model.get(t))?(e=!0,!1):void 0},this),e?this.$el.slideDown():(this.js$("allowAnswersCheckbox").removeAttr("checked"),this.updateModel(),this.$el.slideUp())},endsWithQuestionMark:function(e){return e=o.stripHtml(e,!1),-1!==e.indexOf("?",e.length-1)},updateModel:function(){this.model.set("allow_answers",this.js$("allowAnswersCheckbox").is(":checked"))},render:function(){return this.addStateListeners(),this.$el.html(this.template()),this},addStateListeners:function(){"new"===this.model.get("mode")&&this.listenTo(this.model,"change",this._onModelChange)},teardown:function(){return this.stopListening(),this}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<label class="binary_switch"><input type="checkbox" id="allowAnswers" type="checkbox" data-js-allowanswerscheckbox> <span class="binary_switch_track"></span><span class="binary_switch_button"></span></label><label class="allow-answers-label" for="allowAnswers">'+(null==(__t=__("Let people answer this"))?"":_.escape(__t))+"</label>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(149),s=n.extend({className:"post-form--error-bar",showErrorBar:function(e){this.$el.html(e).slideDown()},hideErrorBar:function(){this.$el.hide()}});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(204),a=i(205),l=i(265),c=i(258),u=s.extend({className:"post-form--uploading-indicator",mixins:[o,r,a],template:l,defaults:{isUploading:!0,isVisible:!0,delay:200},initialize:function(e){this.options=e=n.extend({},e),n.extend(this,n.pick(e,"post","user","uploads")),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),this.updateIsUploading(),this.set("isVisible",this.get("isUploading"))},_onChangeIsUploading:function(e,t){t?(clearTimeout(this._changeIsVisibleTimeout),this._changeIsVisibleTimeout=!1,this.set("isVisible",t)):this._changeIsVisibleTimeout||(this._changeIsVisibleTimeout=n.delay(n.bind(function(){this._changeIsVisibleTimeout=!1,this.set("isVisible",t)},this),this.get("delay")))},_onChangeIsVisible:function(e,t){this.loader.set("loading",t)},updateIsUploading:function(){this.set("isUploading",this.post.get("hasLoadingInlineImages")||this.uploads.anyUploading()||this.post.get("loading"))},serialize:function(){return this.toJSON()},beforeRender:function(){this.loader=this.subViews.loader=new c({variation:"small"}),this.listenTo(this.uploads,"change:uploading",this.updateIsUploading),this.listenTo(this.post,"change:loading",this.updateIsUploading),this.listenTo(this.post,"change:hasLoadingInlineImages",this.updateIsUploading),this.listenTo(this,"change:isUploading",this._onChangeIsUploading),this.listenTo(this,"change:isVisible",this._onChangeIsVisible)},render:function(){return this.$el.html(this.template(this.serialize())),this.updateIsUploading(),this.loader.set("loading",this.get("isVisible")),this.attachSubViews(),this}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="loader"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(149),s=i(150).animation,o=i(267),r=n.extend({className:"post-form--richtext-editor-tutorial popover tutorial",template:o,events:{"click > button":"close"},remove:function(){return this.trigger("removed",this),n.prototype.remove.apply(this,arguments)},close:function(){s(this.$el,this.remove.bind(this)),this.trigger("closing",this),this.$el.addClass("closing")},render:function(){return this.$el.html(this.template(this.attributes)),this}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<h3 class="title">'+(null==(__t=__("Want to style your text?"))?"":_.escape(__t))+'</h3><p class="content">'+(null==(__t=__("Just select it. You'll see."))?"":_.escape(__t))+'</p><button class="blue ok_button tx-button" type="button">'+(null==(__t=__("I see"))?"":_.escape(__t))+"</button>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(144),r=i(269).FeatureHelpPopoverView,a=o.extend({name:"InlineControlsTutorial",initialize:function(e){this.options=e=s.extend({},e),this.editor=this.options.richTextEditor,this.popover=new r,this.animationShowDelay=s.isNumber(this.options.animationShowDelay)?this.options.animationShowDelay:500,this.animationHideDelay=s.isNumber(this.options.animationHideDelay)?this.options.animationHideDelay:500,this.animationClass=this.options.animationClass,this.config={name:"inline-controls",template:"standard",glass:!1,title:this.options.title,content:this.options.content,ok_text:this.options.buttonLabel,position:r.POSITION.BOTTOM|r.POSITION.LEFT},this.listenTo(this.editor,"controls:show",this._onInlineControlsShow)},show:function(){this.editor.toggleInlineControlsTray(!0),this.listenToOnce(this.editor,"controls:hide controls:embed:prompt controls:gif:prompt",this._onInlineControlsHide),this.listenToOnce(this.editor,"controls:close",this._onInlineControlsClose),this.listenToOnce(this.popover,"dismiss",this._onPopoverDismiss),this.popover.setHighlighted(n(".post-form .inline-controls .opener")),this.popover.show(this.config),this.animationClass&&setTimeout(s.bind(function(){n("body").addClass(this.animationClass)},this),this.animationShowDelay),this.editor.addElementToControlsCloseWhitelist(this.popover.getPopoverElement())},showWithDelay:function(){setTimeout(this.show.bind(this),this.animationShowDelay)},hide:function(){this.animationClass&&n("body").removeClass(this.animationClass),this.editor.removeElementFromControlsCloseWhitelist(this.popover.getPopoverElement()),this.stopListening(this.editor,"controls:hide controls:close controls:embed:prompt controls:gif:prompt"),this.stopListening(this.popover),this.popover.hide(),this.trigger("hide",this)},hideWithDelay:function(){setTimeout(this.hide.bind(this),this.animationHideDelay)},_onInlineControlsShow:function(){this.showWithDelay()},_onInlineControlsClose:function(){this.hideWithDelay()},_onInlineControlsHide:function(){this.hide()},_onPopoverDismiss:function(){this.trigger("dismiss")},remove:function(){this.hide(),o.prototype.remove.apply(this,arguments)}});e.exports=a},function(e,t,i){"use strict";e.exports={SharePopoverView:i(270),FeatureHelpPopoverView:i(278)}},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(149),r=i(110),a=i(271),l=i(204),c=i(211),u=i(272),h=i(273),d=i(276),p=i(277),g=o.extend({className:"popover--post-share-popover",mixins:[l,c,p],template:u,defaults:{popoverData:{},forceSocialFallback:!1,forceEmailFallback:!1},events:{"click .embed_post":"__embedPostClick","click .share_email":"__emailTriggerClick","click .share_facebook":"__shareFacebookClick","click .share_pinterest":"__sharePinterestClick","click .share_twitter":"__shareTwitterClick","click .share_reddit":"__shareRedditClick","click .share_permalink":"__sharePermalinkClick","click .flag_post":"__flagPostClick","click .cancel":"__cancelClick","click .popover_menu_item_anchor":"__checkIfPremiumPost","input .email_address":"__emailFormInput","input .twitter .share_message":"__shareTwitterInput","change .reply_to_input":"__replyToChange","keydown .share_form":"__submitKeydown","submit .share_form":"__submit","focus input":"__suspendKeyCommands","focus textarea":"__suspendKeyCommands","blur textarea":"__resumeKeyCommands","blur input":"__resumeKeyCommands"},__embedPostClick:function(e){e.preventDefault(),r.trigger("dashboard-share:embed"),this._showEmbedCode()},__emailTriggerClick:function(e){e.preventDefault(),r.trigger("dashboard-share:email"),this._toggleEmailForm()},__shareFacebookClick:function(e){e.preventDefault(),r.trigger("dashboard-share:facebook"),this._shareFacebook()},__sharePinterestClick:function(e){e.preventDefault(),r.trigger("dashboard-share:pinterest"),this._sharePinterest()},__shareRedditClick:function(e){e.preventDefault(),r.trigger("dashboard-share:reddit"),this._shareReddit()},__shareTwitterClick:function(e){e.preventDefault(),r.trigger("dashboard-share:twitter"),this._shareTwitter()},__sharePermalinkClick:function(){this.resetAndHide()},__flagPostClick:function(e){e.preventDefault(),this.onClickOutside(),r.trigger("abuseform:open",{mode:"post",post:this.model})},__cancelClick:function(e){e.preventDefault(),this._cancelOrClose()},__emailFormInput:function(){var e=g.validateEmail(this.$emailAddress.val());this.$submitButton.attr("disabled",!e)},__shareTwitterInput:function(e){e.preventDefault();var t=g.validateTwitter(this.$shareMessage.val(),this.$characterCount);this.$submitButton.attr("disabled",!t)},__replyToChange:function(e){var t=n(e.currentTarget).is(":checked");a.set("share_popover_reply_to",t,31536e3)},__submitKeydown:function(e){13===e.keyCode&&(e.ctrlKey||e.metaKey||e.altKey)&&(e.preventDefault(),e.stopPropagation(),this.submitForm())},__submit:function(){return this.submitForm(),!1},__submitSuccess:function(){this.$status.show(),this._fadeoutPopover()},__submitError:function(){this.$errorStatus.html(this.errorText),this.$submitButton.html(this.$submitButton.data("label")),this.$submitButton.attr("disabled",!1),this.$errorStatus.addClass("active")},__suspendKeyCommands:function(){r.trigger("keycommands:suspend indashblog:keycommands:suspend")},__resumeKeyCommands:function(){r.trigger("keycommands:resume indashblog:keycommands:resume")},__checkIfPremiumPost:function(){var e=n("[data-id="+this.options.popoverData.post_id+"]").data("json");if(e&&e.pt){var t=new d(e),i=this.loggingData({userAction:"share"});i&&i.modelData&&(i.modelData=t.toJSON()),r.trigger("useraction:explore_click:share",{model:t,loggingData:i})}},_shareTwitter:function(){!this.options.forceSocialFallback&&this.twitterUsername?(this.$serviceCancel.show(),
this.$submitButton.html("Tweet"),this.$shareForm.data("type","twitter"),this.$shareLabel.text("@"+this.twitterUsername),this.$shareMessage.val(" [URL]"),this.$shareForm.addClass("active"),this.$shareOptions.removeClass("active"),this.$shareMessage.get(0).setSelectionRange(0,0),this.$shareMessage.attr("placeholder",""),this.$submitButton.attr("disabled",!1),this.$shareForm.addClass("twitter"),g.validateTwitter(this.$shareMessage.val(),this.$characterCount),this.$shareForm.hasClass("active")&&(this.$shareMessage.focus(),this.$shareMessage.get(0).setSelectionRange(0,0))):this._shareTwitterFallback()},_shareTwitterFallback:function(){window.open("https://twitter.com/intent/tweet?url="+encodeURIComponent(this.tinyUrl||this.url),"twitter-share-dialog","width=626,height=258");var e=this._getGenericShareData();this.model.shareTwitter(e),this.resetAndHide()},_shareFacebook:function(){!this.options.forceSocialFallback&&this.hasFacebook?this.model.facebookStatus().done(s.bind(this._shareFacebookSuccess,this)).fail(s.bind(this._shareFacebookFallback,this)):this._shareFacebookFallback()},_shareFacebookSuccess:function(e){e?(this.$serviceCancel.show(),this.$submitButton.html(this.$submitButton.data("label")),this.$shareForm.data("type","facebook"),this.$shareLabel.text(e),this.$submitButton.attr("disabled",!1),this.$shareForm.addClass("facebook"),this.$shareOptions.toggleClass("active"),this.$shareForm.toggleClass("active"),this.$shareForm.hasClass("active")&&this.$shareMessage.focus()):this._shareFacebookFallback()},_shareFacebookFallback:function(){window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(this.url),"facebook-share-dialog","width=626,height=436");var e=this._getGenericShareData();this.model.shareFacebook(e),this.resetAndHide()},_sharePinterest:function(){var e=this.model.get("pinterest_share_window");window.open(e.url,e.name,e.dimensions);var t=this._getGenericShareData();this.model.sharePinterest(t),this.resetAndHide()},_shareReddit:function(){window.open("https://reddit.com/submit?url="+this.model.get("post_url"),"reddit-share-dialog","scrollbars=1,width=860,height=600");var e=this._getGenericShareData();this.model.shareReddit(e),this.resetAndHide()},_toggleEmailForm:function(){return this.options.forceEmailFallback||!this.model.get("has_user")?void this._emailFormFallback():(this.$submitButton.html(this.$submitButton.data("label")),this.$shareForm.data("type","email"),this.$shareOptions.toggleClass("active"),this.$shareForm.toggleClass("active"),this.$replyTo.addClass("active"),void(this.$shareForm.hasClass("active")&&this.$emailAddress.length&&this.$emailAddress.focus()))},_emailFormFallback:function(){var e=this._getGenericShareData();this.model.shareEmail(e);var t="mailto:?body="+this.url;if(this.model.get("embed_key")){var i=window.open();i.document.write('<html><script>location.href = "'+t+'";setTimeout(function(){window.close();},500);</script></html>'),i.document.close()}else window.location.href=t;this.resetAndHide()},_showEmbedCode:function(){this.$serviceCancel.show(),this.$shareForm.data("type","embed"),this.$shareLabel.text(this.$shareLabel.data("embed-label")),this.$shareForm.addClass("active"),this.$shareOptions.removeClass("active"),this.$shareMessage.attr("placeholder",""),this.$shareForm.addClass("embed");var e=this.$shareForm.find(".embed_code_text");e.length&&(e.click(function(){e.select()}),setTimeout(function(){e.trigger("click")},100))},_fadeoutPopover:function(){setTimeout(s.bind(function(){this.$el.fadeOut(150,s.bind(this.resetAndHide,this))},this),1250)},_cancelOrClose:function(){var e=this.$emailAddress.val()||"";"email"===this.$shareForm.data("type")&&e.length?(this.$emailAddress.val(""),this.$submitButton.attr("disabled",!0)):this.resetForm()},_getGenericShareData:function(){return[{name:"post_id",value:this.model.get("post_id")},{name:"tumblelog_name",value:this.model.get("tumblelog_name")},{name:"share_fallback",value:!0}]},initialize:function(e){this.options=s.extend({},this.defaults,e),this.model=new h(this.options.popoverData),this.listenTo(this.model,"error",this.__submitError),this.listenTo(this.model,"success",this.__submitSuccess)},cacheSelectors:function(){this.$shareForm=this.$(".share_form"),this.$shareLabel=this.$(".share_label"),this.$replyTo=this.$(".reply_to"),this.$shareOptions=this.$(".share_options"),this.$submitButton=this.$("button.email_submit"),this.$emailAddress=this.$(".email_address"),this.$shareMessage=this.$(".share_message"),this.$embedCode=this.$(".embed_code_text"),this.$characterCount=this.$(".character_count"),this.$serviceCancel=this.$(".cancel.service"),this.$status=this.$(".status"),this.$errorStatus=this.$(".error_status"),this.$statusMessage=this.$(".status_message"),this.$replyToInput=this.$(".reply_to_input"),this.sentText=this.$status.data("sent")||"",this.errorText=this.$status.data("error")||"",this.$(".share_twitter").length&&(this.twitterUsername=this.$(".share_twitter").data("twitter-username")),this.$(".share_facebook").length&&(this.hasFacebook=this.$(".share_facebook").data("has-facebook")),this.url=this.$shareOptions.data("post-url"),this.tinyUrl=this.$shareOptions.data("post-tiny-url"),this.tumblelogName=this.$shareOptions.data("tumblelog-name"),this.embedKey=this.$shareOptions.data("embed-key"),this.postId=this.$shareOptions.data("post-id"),this.rootId=this.$shareOptions.data("root-id")},render:function(){return this.delegateEvents(),this.$el.html(this.template(this.model.toJSON())),this.cacheSelectors(),this.$replyToInput.prop("checked","true"===a.get("share_popover_reply_to")),this},resetForm:function(){this.$serviceCancel.hide(),this.$submitButton.html(this.$submitButton.data("label")),this.$submitButton.attr("disabled",!0),this.$emailAddress.val(""),this.$shareMessage.val(""),this.$shareMessage.attr("placeholder",this.$shareMessage.attr("title")),this.$shareOptions.addClass("active"),this.$shareForm.removeClass("active"),this.$shareForm.removeClass("facebook"),this.$shareForm.removeClass("twitter"),this.$shareForm.removeClass("embed"),this.$status.hide(),this.$statusMessage.html(this.sentText),this.$replyTo.removeClass("active"),this.$errorStatus.removeClass("active"),this.$el.show()},resetAndHide:function(){this.resetForm(),this.teardown()},submitForm:function(){var e=this.$shareForm.serializeArray();switch(this.$shareForm.data("type")){case"facebook":this.model.shareFacebook(e);break;case"twitter":this.model.shareTwitter(e);break;default:this.model.shareEmail(e)}this.$submitButton.attr("disabled",!0),this.$submitButton.html(this.$submitButton.data("label-sending"))},teardown:function(){return this.__resumeKeyCommands(),this.$el.remove(),this}},{placeholderSupport:function(){var e=document.createElement("input");return"placeholder"in e},validateEmail:function(e){var t=/\S+@\S+\.\S+/;return t.test(e)},validateTwitter:function(e,t){var i=e.match(/\[URL\]/gi),n=i?24*i.length:0,s=140-e.length-n,o=t&&t.length?t:!1;return o&&(o.removeClass("character-limit").html(s),10>s&&o.addClass("character-limit")),!(0>s||140===s)}});e.exports=g},function(e,t,i){"use strict";function n(e){return new RegExp(e+"=([^;]+)").test(decodeURIComponent(document.cookie))}function s(e){var t=decodeURIComponent(document.cookie).match(new RegExp(e+"=([^;]+)"));return t&&t.length>1?t[1]:null}function o(e,t,i,n){"object"==typeof t&&(t=JSON.stringify(t));var s=encodeURIComponent(e)+"="+encodeURIComponent(t);if(c.isPlainObject(i)&&(n=i,i=n?n.expires:!1),n=c.extend({expires:i},u,n),n.expires instanceof Date)s+=";expires="+n.expires.toGMTString();else if("number"==typeof n.expires){var o=new Date;o.setTime(o.getTime()+1e3*n.expires),s+=";expires="+o.toGMTString()}n.path&&(s+=";path="+encodeURI(n.path)),n.secure&&(s+=";secure"),n.domain&&(s+=";domain="+encodeURI(n.domain)),document.cookie=s}function r(e){o(e,"",-1)}function a(e,t){var i=s(e);try{i=JSON.parse(i)}catch(n){return i}return t?c.get(i,t):i}function l(e,t,i,n){var s;c.isPlainObject(t)?(n=i,s=t):(s=a(e)||{},c.isPlainObject(s)||(s={}),c.set(s,t,i)),o(e,JSON.stringify(s),n)}var c=i(3),u={path:"/",secure:!1,domain:""},h={has:n,get:s,set:o,unset:r,getHash:a,setHash:l};e.exports=h},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="popover popover_menu popover_gradient popover_share_social"><div class="popover_inner"><ul class="share_options active" data-tumblelog-name="'+(null==(__t=tumblelog_name)?"":_.escape(__t))+'" data-post-id="'+(null==(__t=post_id)?"":_.escape(__t))+'" data-root-id="'+(null==(__t=root_id)?"":_.escape(__t))+'" data-post-url="'+(null==(__t=post_url)?"":_.escape(__t))+'" data-post-tiny-url="'+(null==(__t=post_tiny_url)?"":_.escape(__t))+'" data-embed-key="'+(null==(__t=embed_key)?"":_.escape(__t))+'" data-embed-did="'+(null==(__t=embed_did)?"":_.escape(__t))+'"> ',is_private||(__p+=" ",show_permalink&&(__p+=' <li class="share_permalink popover_menu_item"><a class="popover_menu_item_anchor" data-share-type="permalink" href="'+(null==(__t=post_url)?"":_.escape(__t))+'" target="_blank" class="external" title="'+(null==(__t=permalink_label)?"":_.escape(__t))+'" rel="noopener"> '+(null==(__t=permalink_label)?"":_.escape(__t))+' <i class="icon icon_arrow_carrot_right"></i></a></li> '),__p+=" ",show_embed&&(__p+=' <li class="embed_post popover_menu_item"><a class="popover_menu_item_anchor" data-share-type="embed" href="#">'+(null==(__t=__("Embed"))?"":_.escape(__t))+"</a></li> "),__p+=" ",show_email&&(__p+=' <li class="share_email popover_menu_item"><a class="popover_menu_item_anchor" data-share-type="email" href="#">'+(null==(__t=__("Email"))?"":_.escape(__t))+"</a></li> "),__p+=" ",show_twitter&&(__p+=' <li class="share_twitter popover_menu_item" data-twitter-username="'+(null==(__t=twitter_username)?"":_.escape(__t))+'"><a class="popover_menu_item_anchor" data-share-type="twitter" href="#">'+(null==(__t=__("Twitter"))?"":_.escape(__t))+"</a></li> "),__p+=" ",show_facebook&&(__p+=' <li class="share_facebook popover_menu_item" data-has-facebook="'+(null==(__t=has_facebook?"1":"")?"":__t)+'"><a class="popover_menu_item_anchor" data-share-type="facebook" href="#">'+(null==(__t=__("Facebook"))?"":_.escape(__t))+"</a></li> "),__p+=" ",show_pinterest&&(__p+=' <li class="share_pinterest popover_menu_item"><a class="popover_menu_item_anchor" data-share-type="pinterest" href="#">'+(null==(__t=__("Pinterest"))?"":_.escape(__t))+"</a></li> "),__p+=" ",show_reddit&&(__p+=' <li class="share_reddit popover_menu_item"><a class="popover_menu_item_anchor" data-share-type="reddit" href="#">'+(null==(__t=__("Reddit"))?"":_.escape(__t))+"</a></li> "),__p+=" ",show_flagging&&(__p+=' <li class="flag_post popover_menu_item"><a class="popover_menu_item_anchor" href="#">'+(null==(__t=__("Flag this post"))?"":_.escape(__t))+"</a></li> "),__p+=" ",show_reporting_links&&(__p+=' <li class="popover_menu_item"><a class="popover_menu_item_anchor" target="_blank" href="'+(null==(__t=abuse_url)?"":_.escape(__t))+'">'+(null==(__t=__("Report Abuse"))?"":_.escape(__t))+"</a></li> "),__p+=" "),__p+=" </ul> ",is_private||(__p+=' <form method="post" class="share_form email_form" id="share_email_'+(null==(__t=post_id)?"":_.escape(__t))+'" novalidate><div class="form_wrapper"><div class="share_label" data-embed-label="'+(null==(__t=__("Embed"))?"":_.escape(__t))+'"></div><span class="cancel service icon_arrow_thin_left"></span><div class="input_group"><ul><li><input type="email" class="email_address" name="email_address" maxlength="100" placeholder="'+(null==(__t=__("Email"))?"":_.escape(__t))+'" title="'+(null==(__t=__("Email"))?"":_.escape(__t))+'"> <input type="hidden" name="post_id" value="'+(null==(__t=post_id)?"":_.escape(__t))+'"> <input type="hidden" name="tumblelog_name" value="'+(null==(__t=tumblelog_name)?"":_.escape(__t))+'"> <span class="cancel icon_close"></span></li><li><textarea name="message" class="share_message" maxlength="255" placeholder="'+(null==(__t=__("Message (Optional)"))?"":_.escape(__t))+'" title="'+(null==(__t=__("Message (Optional)"))?"":_.escape(__t))+'"></textarea><div class="character_count">140</div></li></ul></div> ',show_embed&&(__p+=' <div class="embed_code_wrapper"><textarea name="embed_code" class="embed_code_text" spellcheck="false" readonly="readonly">'+(null==(__t=embed_code)?"":_.escape(__t))+"</textarea></div> "),__p+=" ",has_user&&(__p+=' <div class="reply_to" title="'+(null==(__t=__("Let them reply to"))?"":_.escape(__t))+'"><div class="menu_item_option"><label class="binary-switch"><input type="checkbox" id="allow_reply_to_'+(null==(__t=post_id)?"":_.escape(__t))+'" class="reply_to_input" name="allow_reply_to"> <span class="binary-switch-track"></span><span class="binary-switch-button"></span></label></div><label class="menu_item_label" for="allow_reply_to_'+(null==(__t=post_id)?"":_.escape(__t))+'"> '+(null==(__t=__("Let them reply to <span>"))?"":__t)+" </label></div> "),__p+=' <div class="error_status"></div><button type="submit" class="tx-button blue email_submit" data-label-sending="'+(null==(__t=__("Sending..."))?"":_.escape(__t))+'" data-label="'+(null==(__t=__("Send"))?"":_.escape(__t))+'" disabled="disabled">'+(null==(__t=__("Send"))?"":_.escape(__t))+'</button></div></form><div class="status" data-sent="'+(null==(__t=__("Sent!"))?"":_.escape(__t))+'" data-error="'+(null==(__t=__("Error!"))?"":_.escape(__t))+'"><span class="status_message">'+(null==(__t=__("Sent!"))?"":_.escape(__t))+"</span></div> "),__p+=" </div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(114),r=i(106),a=i(108),l=i(274),c=o.extend({url:function(){return"/svc/post/share/"+this.get("tumblelog_name")+"/"+this.get("post_id")},parse:function(e){return!s.isUndefined(e)&&s.has(e,"response")?s.result(e.response,"share_popover_data")||{}:{}},hostname:function(){var e=r.get("Context/hosts");return s.isEmpty(e)?"http://www.tumblr.com":e.www_host},defaults:{abuse_url:"",embed_code:"",embed_did:"",form_key:n("#tumblr_form_key").attr("content"),has_facebook:!1,has_user:!1,is_private:!1,permalink_label:"",post_id:"",post_tiny_url:"",post_url:"",root_id:"",show_email:!0,show_embed:!0,show_facebook:!0,show_permalink:!0,show_pinterest:!0,show_reporting_links:!0,show_twitter:!0,show_reddit:!0,show_flagging:!0,tumblelog_name:"",twitter_username:"",embed_key:"",pinterest_share_window:{}},initialize:function(e){this.get("embed_code")||this.set("embed_code",new l(this.toJSON()).getCode()),a.bool("enable_share_embed_code")||this.set("show_embed",!1),a.bool("pinterest_sharing")||this.set("show_pinterest",!1),a.bool("reddit_sharing")||this.set("show_reddit",!1)},shareEmail:function(e){return this.share("/svc/share/email",e)},shareTwitter:function(e){return this.share("/svc/share/twitter",e)},shareFacebook:function(e){return this.share("/svc/share/facebook",e)},sharePinterest:function(e){return this.share("/svc/share/pinterest",e)},shareReddit:function(e){return this.share("/svc/share/reddit",e)},facebookStatus:function(){return n.ajax({url:this.hostname()+"/svc/facebook_status",type:"post",data:{form_key:this.get("form_key")}})},share:function(e,t){return t=t||[],t.push({name:"form_key",value:this.get("form_key")}),n.ajax({url:this.hostname()+e,type:"post",data:t,success:s.bind(function(){this.trigger("success")},this),error:s.bind(function(){this.trigger("error")},this)}),this}});e.exports=c},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(275),r=i(106),a=s.extend({name:"PostEmbedCodeGenerator",defaults:{embed_host:"//embed.tumblr.com",secure_assets_host:"https://secure.assets.tumblr.com",tumblelog_mention_key:"",post_id:"",post_url:"",embed_key:"",embed_did:""},initialize:function(e){this.options=n.extend({},this.defaults,e);var t=r.get("Context/hosts");t&&(t.embed_host&&(this.options.embed_host=t.embed_host),t.secure_assets_host&&(this.options.secure_assets_host=t.secure_assets_host)),this.template=o},getCode:function(){return this.template(this.options)}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="",__p+="undefined"!=typeof language&&"undefined"!=typeof width?' <div class="tumblr-post" data-href="'+(null==(__t=embed_host)?"":_.escape(__t))+"/embed/post/"+(null==(__t=embed_key)?"":_.escape(__t))+"/"+(null==(__t=post_id)?"":_.escape(__t))+'" data-did="'+(null==(__t=embed_did)?"":_.escape(__t))+'" data-language="'+(null==(__t=language)?"":_.escape(__t))+'" data-width="'+(null==(__t=width)?"":_.escape(__t))+'"><a href="'+(null==(__t=post_url)?"":_.escape(__t))+'">'+(null==(__t=post_url)?"":_.escape(__t))+"</a></div> ":"undefined"!=typeof language?' <div class="tumblr-post" data-href="'+(null==(__t=embed_host)?"":_.escape(__t))+"/embed/post/"+(null==(__t=embed_key)?"":_.escape(__t))+"/"+(null==(__t=post_id)?"":_.escape(__t))+'" data-did="'+(null==(__t=embed_did)?"":_.escape(__t))+'" data-language="'+(null==(__t=language)?"":_.escape(__t))+'"><a href="'+(null==(__t=post_url)?"":_.escape(__t))+'">'+(null==(__t=post_url)?"":_.escape(__t))+"</a></div> ":"undefined"!=typeof width?' <div class="tumblr-post" data-href="'+(null==(__t=embed_host)?"":_.escape(__t))+"/embed/post/"+(null==(__t=embed_key)?"":_.escape(__t))+"/"+(null==(__t=post_id)?"":_.escape(__t))+'" data-did="'+(null==(__t=embed_did)?"":_.escape(__t))+'" data-width="'+(null==(__t=width)?"":_.escape(__t))+'"><a href="'+(null==(__t=post_url)?"":_.escape(__t))+'">'+(null==(__t=post_url)?"":_.escape(__t))+"</a></div> ":' <div class="tumblr-post" data-href="'+(null==(__t=embed_host)?"":_.escape(__t))+"/embed/post/"+(null==(__t=embed_key)?"":_.escape(__t))+"/"+(null==(__t=post_id)?"":_.escape(__t))+'" data-did="'+(null==(__t=embed_did)?"":_.escape(__t))+'"><a href="'+(null==(__t=post_url)?"":_.escape(__t))+'">'+(null==(__t=post_url)?"":_.escape(__t))+"</a></div> ",__p+=' <script async src="'+(null==(__t=secure_assets_host)?"":_.escape(__t))+'/post.js"></script>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(114),r=i(110),a=i(120),l=i(143),c=i(274),u=i(101),h=o.extend({defaults:{},endpoints:{like:"/svc/like",unlike:"/svc/unlike",reblog:"/fast_reblog",reply:"/svc/reply",publish:"/publish",queue:"/publish",destroy:"/svc/post/delete",promote:"/svc/promote",unpromote:"/svc/unpromote",answer:"/answer",deny:"/deny_submission",approve:"/approve_submission",remove_source:"remove_app_attribution"},initialize:function(e){this._createPostTumblelogModel("tumblelog",this.get("tumblelog-data")),this._createPostTumblelogModel("parentTumblelog",this.get("tumblelog-parent-data")),this._createPostTumblelogModel("rootTumblelog",this.get("tumblelog-root-data"))},_createPostTumblelogModel:function(e,t){e=e||"tumblelog",t=t||!1;var i=!1;t&&t.name&&(i=new a(n(t).omit(n.isUndefined).omit(n.isNull).value())),this[e]=i},_setTumblelog:function(){this.tumblelog=new a(n({name:this.get("tumblelog"),ignoring:!1,sponsor:this.get("sponsored"),following:this.get("following"),mention_key:this.get("tumblelog_mention_key")}).omit(n.isUndefined).omit(n.isNull).value())},_setReblogTumblelog:function(){var e=this.get("reblog_source");e&&e.name&&(this.reblogTumblelog=new a(n({name:e.name,ignoring:!1,following:e.following}).omit(n.isUndefined).omit(n.isNull).value()))},_xhrRequest:function(e,t,i){i.init&&i.init();var o=s.ajax({data:t,type:"POST",url:e,with_form_key:!0});return o.done(n.bind(function(e){i[200]&&i[200].call(this,e)},this)),o.fail(n.bind(function(e){i[e.status]&&i[e.status].call(this,e.status)},this)),o.always(n.bind(function(){i.always&&i.always()},this)),o},_xhrSuccess:function(e){this.trigger(e+":success")},_xhrFailure:function(e){l.alert(u("Sorry, we seem to be having technical trouble.  Please try again later.")),this.trigger(e+":failure")},_xhrForbidden:function(e){this.trigger(e+":forbidden")},save:function(e,t,i){if(i||(i={}),this.endpoints[e]){var s={200:n.bind(this._xhrSuccess,this,e),401:n.bind(this._xhrFailure,this,e),404:n.bind(this._xhrFailure,this,e),403:n.bind(this._xhrForbidden,this,e),500:n.bind(this._xhrFailure,this,e)};return this._xhrRequest(this.endpoints[e],t,n.defaults(i,s))}throw new Error("Missing endpoint url for "+e)},like:function(e){if(!this.get("is_mine")){if(this.get("liked")===!1){this.set("liked",!0);var t=this.likePayload(e,this.getLikeSource("like"));this.save("like",{data:t})}this.trigger("like:set",this),r.trigger("post:like:set",this.get("id"),this,e)}},unlike:function(){if(this.get("liked")===!0){this.set("liked",!1);var e=this.likePayload("mouse",this.getLikeSource("unlike"));this.save("unlike",{data:e})}this.trigger("unlike:set",this),r.trigger("post:unlike:set",this.get("id"))},toggleLike:function(){this.get("liked")?this.unlike():this.like()},getLikeSource:function(e){e=e||"like";var t="LIKE_";switch(e){case"unlike":t="UNLIKE_";break;case"reply":t="REPLY_";break;case"ignore":t="IGNORE_"}var i=location.pathname;return i.match(/^\/dashboard/)?t+"SOURCE_DASHBOARD":i.match(/^\/tagged/)?t+"SOURCE_TAG_PAGE":i.match(/^\/likes/)?t+"SOURCE_LIKES_PAGE":i.match(/^\/inbox/)?t+"SOURCE_INBOX":i.match(/^\/search/)?t+"SOURCE_SEARCH_RESULTS_PAGE":i.match(/^\/explore/)?t+"SOURCE_DISCOVER":i.match(/^\/tv/)?t+"SOURCE_TV":i.match(/^\/indash_blog\/peepr/)?t+this.getPeeprSource():t+"SOURCE_UNKNOWN"},getPeeprSource:function(){if(window.parent&&window.parent.location){var e=window.parent.location.pathname;if(e.match(/search/))return"SOURCE_SEARCH_PEEPR"}return"SOURCE_PEEPR"},getEmbedCode:function(e,t){var i={embed_key:this.get("embed_key"),embed_did:this.get("embed_did"),post_id:this.get("id"),post_url:this.get("post_url")};e&&(i.language=e),t&&(i.width=t);var n=new c(i);return n.getCode()},likePayload:function(e,t){return e=e||"mouse",t=t||"LIKE_SOURCE_UNKNOWN",{id:this.get("id"),root_id:this.get("root_id"),key:this.get("reblog_key"),method:e,source:t,placement_id:this.get("placement_id")||!1,is_recommended:this.get("is_recommended")||"",pt:this.get("pt")}},reblog:function(e){e=n.extend({},e,{reblogId:this.get("id"),reblogKey:this.get("reblog_key"),pt:this.get("pt")}),r.trigger("postForms:reblog",e)},fastReblog:function(e){e||(e=!1),this.trigger("fastreblog:success",e),r.trigger("post:fastreblog:set",{model:this});var t={reblog_key:this.get("reblog_key"),reblog_post_id:this.get("id"),queue:e,pt:this.get("pt")},i={200:n.bind(function(e){this.set("reblogged",!0),this.trigger("fastreblog:ajax:success",e.response)},this)};this.save("reblog",t,i)},reply:function(e){var t={reply_text:e,post_id:this.get("id"),tumblelog:this.get("tumblelog"),tumblelog_key:this.get("tumblelog-key")||this.get("tumblelog_key"),source:this.getLikeSource("reply")},i={200:n.bind(function(){this.trigger("replied")},this)};return this.save("reply",{data:t},i)},destroy:function(){var e={post_id:this.get("id"),channel_id:this.get("tumblelog")};this.save("destroy",e)},publish:function(){var e=this.save("publish",{id:this.get("id")});e.fail(n.bind(function(e){this.trigger("publish:failure",s.parseJSON(e.responseText))},this))},promote:function(e){var t={tag:e,post_id:this.get("id"),reblog_key:this.get("reblog_key"),tumblelog_name:this.get("tumblelog")};return this.save("promote",t)},unpromote:function(e){var t={tag_id:e,post_id:this.get("id"),reblog_key:this.get("reblog_key"),tumblelog_name:this.get("tumblelog")};return this.save("unpromote",t)},queue:function(){var e={id:this.get("id"),queue:"queue"};this.save("queue",e)},removeSource:function(){var e={post_id:this.get("id"),tumblelog_id:this.get("tumblelog")};return this.save("remove_source",e)},approve:function(e){var t={id:this.get("id"),queue:e};return this.save("approve",t)},deny:function(){return this.save("deny",{pid:this.get("id")})},answer:function(e){var t={post_id:this.get("id"),tumblelog:this.get("tumblelog"),key:this.get("tumblelog-key"),answer_text:e};return this.save("answer",t)},embedFocus:function(){this.trigger("embed:focus",this)},updateReblogControl:function(e){this.trigger("reblog:success",e)},dismiss:function(){this.trigger("dismiss",this)}});e.exports=h},function(e,t,i){"use strict";var n=i(3),s=i(116),o=new s({loggingData:function(e){var t={};return!n.isEmpty(this.model)&&n.isFunction(this.model.toJSON)&&(t.modelData=this.model.toJSON()),n.isObject(e)&&(t=n.extend(t,e)),t}});e.exports=o},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(149),r=i(110),a=i(109),l=i(150).transition,c=i(279),u={TOP:1,BOTTOM:2,LEFT:4,RIGHT:8,CENTER:16},h=o.extend({className:"tour_guide",template:c,events:{"click .glass":"_onHide","click .ok_button":"_onDismiss"},_onDismiss:function(e){this.trigger("dismiss"),this._onHide(e)},_onHide:function(e){e.preventDefault(),this.hide(),this.trigger("hide")},_onScroll:function(e){s.get(this.config,"isFadeOnScroll",!0)&&(this.scrollPosition=e,this.isDim&&this.fadeGlass())},initialize:function(e){this.$body=n("body"),this.$highlighted=n(),this.$glass=n(),this.$popover=n(),this.isDim=!1,this.isOpen=!1,this.openScrollPosition=0,this.highlightedClass="",this.scrollPosition=a.rect(),this.listenTo(r,"DOMEventor:flatscroll",this._onScroll)},setHighlighted:function(e,t){this.$highlighted=e,this.highlightedClass=t},show:function(e){return this.config=e,this.$el.html(this.template(e)),this.$body.addClass("tour_guide_open").append(this.$el),this.isOpen=!0,this.config.pinnedTarget&&(this.$highlighted=n(this.config.pinnedTarget)),this.config.highlightedClass&&(this.highlightedClass=this.config.highlightedClass),this.config.glass&&(this.$el.addClass("dim"),this.isDim=!0),this.config.name&&this.$body.attr("data-help-popover",this.config.name),this.config.glass&&this.$highlighted.length&&this.$highlighted.addClass("tour_guide_element").addClass(this.highlightedClass),this.$highlighted.length?this.openScrollPosition=this.scrollPosition.windowScrollTop:this.openScrollPosition=this.scrollPosition.windowScrollTop+.5*this.scrollPosition.windowHeight,this.$glass=this.$(".glass"),this.$popover=this.$(".popover"),this.config.className&&this.$popover.addClass(this.config.className),this.delegateEvents(),this.positionPopover(),this},hide:function(){this.$el.addClass("removing"),this.$body.addClass("help-popover-removing"),l(this.$el,this.remove.bind(this))},remove:function(){this.undelegateEvents(),this.isDim=!1,this.isOpen=!1,this.config=null,this.$el.removeClass("dim removing").remove(),this.$body.removeClass("tour_guide_open help-popover-removing").removeAttr("data-help-popover"),this.$highlighted.length&&(this.$highlighted.off(".tour_guide_highlighted").removeClass("tour_guide_element").removeClass(this.highlightedClass),this.$highlighted=n(),this.highlightedClass=""),this.trigger("removed")},fadeGlass:function(){var e=(this.openScrollPosition-this.scrollPosition.windowScrollTop)/this.scrollPosition.windowHeight,t=e>0?1-e:e+1;return 0>=t?(this.isDim=!1,this.hide(),void this.trigger("hide")):void this.$glass.css("opacity",t)},positionPopover:function(){if(this.$popover.length){var e=this.$popover.outerHeight(!0),t=this.$popover.outerWidth(!0);if(this.$highlighted.length){var i,s,o=this.config.position,r=this.$highlighted.offset(),a=this.$highlighted.outerWidth(),l=r.left,c=r.top,h=c-e<this.scrollPosition.windowScrollTop+80;if(o||(o=u.CENTER|h?u.BOTTOM:u.TOP),o&u.LEFT?(s=l,this.$popover.addClass("horizontal-left")):o&u.RIGHT?(s=l-t+a,this.$popover.addClass("horizontal-right")):(s=l-.5*(t-a),this.$popover.addClass("horizontal-center")),this.$popover.css("left",s),this.config.fixed_position)return this.$popover.css("position","fixed"),void(n("#site_notice").length&&this.$popover.css("margin-top","+="+n("#site_notice").outerHeight()+"px"));o&u.TOP?(i=c-e,this.$popover.addClass("vertical-top")):(i=c+this.$highlighted.outerHeight(),this.$popover.addClass("vertical-bottom")),this.$popover.css("top",i)}else this.$popover.addClass("centered").css({top:.5*this.scrollPosition.windowHeight-.5*e,left:.5*this.scrollPosition.windowWidth-.5*t})}},getPopoverElement:function(){return this.$popover?this.$popover.get(0):void 0},getGlassElement:function(){return this.$glass}},{POSITION:u});e.exports=h},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="","undefined"!=typeof template&&"standard"===template?(__p+=' <div class="popover tutorial '+(null==(__t=name)?"":_.escape(__t))+'_step"> ',"undefined"!=typeof title&&(__p+=' <h3 class="title">'+(null==(__t=title)?"":__t)+"</h3> "),__p+=' <p class="content">'+(null==(__t=content)?"":_.escape(__t))+"</p> ","undefined"!=typeof ok_text&&(__p+=' <button class="chrome blue ok_button" type="button">'+(null==(__t=ok_text)?"":_.escape(__t))+"</button> "),__p+=" </div> "):"undefined"!=typeof template&&"appearance"===template&&(__p+=' <div class="popover tutorial '+(null==(__t=name)?"":_.escape(__t))+'_step"><div class="popover_inner"> ',"undefined"!=typeof title&&(__p+=' <h3 class="title">'+(null==(__t=title)?"":__t)+"</h3> "),__p+=' <p class="content">'+(null==(__t=content)?"":_.escape(__t))+'</p></div><div class="appearance small" style="background-color:'+(null==(__t=appearance_data.global_theme_params.background_color)?"":_.escape(__t))+"; color:"+(null==(__t=appearance_data.global_theme_params.background_color)?"":_.escape(__t))+'"><div class="navigation"><a class="chrome edit_button" href="/settings/blog/'+(null==(__t=appearance_data.name)?"":_.escape(__t))+'">'+(null==(__t=edit_text)?"":_.escape(__t))+'</a></div><div class="header_image" style="background-image:url('+(null==(__t=appearance_data.global_theme_params.header_image_focused)?"":_.escape(__t))+')"></div><div class="avatar '+(null==(__t=appearance_data.global_theme_params.avatar_shape)?"":_.escape(__t))+'" style="background-image:url('+(null==(__t=appearance_data.avatar_url)?"":_.escape(__t))+')"><img src="'+(null==(__t=appearance_data.avatar_url)?"":_.escape(__t))+'" alt=""></div><div class="info" style="color:'+(null==(__t=appearance_data.global_theme_params.title_color)?"":_.escape(__t))+'"> ',appearance_data.title&&(__p+=' <h1 class="title" style="font-weight:'+(null==(__t=appearance_data.global_theme_params.title_font_weight)?"":_.escape(__t))+'">'+(null==(__t=appearance_data.title)?"":_.escape(__t))+"</h1> "),__p+=" ",appearance_data.description&&(__p+=' <div class="description"><p class="description_inner">'+(null==(__t=appearance_data.description)?"":_.escape(__t))+"</p></div> "),__p+=" </div></div></div> "),__p+=' <div class="glass blue"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";function n(e){var t=d.parseUrl(e);return t&&t.path?t.path.replace(/^\/([^\/]+)\/.*/i,"$1"):""}var s=i(3),o=i(9),r=i(144),a=i(281),l=i(282),c=i(284),u=new c({html:!0}),h=i(283),d=i(192),p=r.extend({name:"ContentStatsSupport",initialize:function(e){e=e||{},this.model=e.model,this.editor=e.editor,this.dateInitialized=new Date,this.mentionStats={},this.gifSearchStats={},this.editor&&this.editor.mentionSupport&&this.listenTo(this.editor.mentionSupport,"mention:set",this._onSetMention),this.editor&&this.editor.imageSearchSupport&&(this.listenTo(this.editor.imageSearchSupport,"gifSearch:query",this._onGifSearchQuery),this.listenTo(this.editor.imageSearchSupport,"gifSearch:accept",this._onGifSearchAccept)),this.contentStats=new a({htmlLength:function(e){return e.html().length},textLength:function(e){return e.text().length},textTools:{hr:"hr",h2:"h2",more:function(e){var t;return e&&(t=e.text())?t.match(/\[\[MORE\]\]/gi)||[]:[]},mentions:"a.tumblelog"},embeds:{selector:"figure.tmblr-embed, figure.tmblr-embed-placeholder",attribute:function(e){var t=e.attr("data-provider");return l.isValidEmbedServiceName(t)?t:"unknown";
}},images:{selector:"img",attribute:function(e){var t;if(e&&e.attr("src")){if(t=e.attr("src").match(/.+[.](jpg|jpeg|png|gif)([?]|$)/i),t&&t.length>1)return t[1].toLowerCase()}else if(e&&""===e.attr("src"))return"empty";return"unknown"}},mentions:s.bind(this._getPurgedMentionStats,this),gifs:s.bind(this._getConsolidatedGifStats,this),gifSearch:s.bind(this._getGifSearchStats,this)})},_onSetMention:function(e,t){s.has(e,"name")&&s.has(t,"len")&&!s.has(this.mentionStats,e.name)&&(this.mentionStats[e.name]=t.len,this.mentionStats=this._getPurgedMentionStats(this._getWrappedContentDocument()))},_getPurgedMentionStats:function(e){return s.pick(this.mentionStats,s.map(e.find("a.tumblelog"),o.text))},_ensureGifSearchQueryEntry:function(e){return this.gifSearchStats[e]||(this.gifSearchStats[e]={added:[],searches:0}),this.gifSearchStats[e]},_onGifSearchQuery:function(e,t){var i=this._ensureGifSearchQueryEntry(e);i.searches++},_onGifSearchAccept:function(e,t,i){var s=this._ensureGifSearchQueryEntry(e);s.added.push(i+":"+n(t))},_getAttributionImages:function(e){return s.map(e.find("[data-tumblr-attribution]"),function(e){var t=o(e),i=t.find("img");return t.attr("data-tumblr-attribution")+":"+n(i.attr("src"))})},_getConsolidatedGifStats:function(e){var t=this._getAttributionImages(e),i={searches:0,added:0,kept:0};return s.forEach(this.gifSearchStats,function(e,n){i.searches+=e.searches,i.added+=e.added.length,i.kept+=s.intersection(t,e.added).length}),i},_getGifSearchStats:function(e){var t=this._getAttributionImages(e);return s.transform(this.gifSearchStats,function(e,i,n){s.forEach(i.added,function(i){s.contains(t,i)&&(e[i]=n)})},{})},_getContentNode:function(){var e="";return this.model&&this.model.editorField&&(e=this.model.getAttributeFromGeneric(this.model.editorField),"markdown"===this.model.get("editorType")&&(e=u.render(e))),h.nodeFromString(e)},_getWrappedContentDocument:function(){return o(this._getContentNode())},getStats:function(){var e={elapsed:parseInt((new Date-this.dateInitialized)/1e3,10)};return s.extend(e,this.contentStats.parse(this._getWrappedContentDocument())),e}});e.exports=p},function(e,t,i){"use strict";function n(e,t){return"function"==typeof t?t(e):e.find(t)}function s(e,t){return"function"==typeof t?t(e):e.attr(t)}function o(e,t){var i=n(e,t);return!l.isNumber(i)&&l.has(i,"length")?i.length:i}function r(e,t){var i=n(e,t.selector);return l.countBy(i,function(e){return s(c(e),t.attribute)})}function a(e,t){return l.isFunction(t)||l.isString(t)?o(e,t):l.has(t,"attribute")?r(e,t):null}var l=i(3),c=i(9),u=function(e){this.lookups=e||{}};u.prototype.parse=function(e){var t={},i=c(e),n=function(e,t){l.each(e,function(e,s){var o=a(i,e);null!==o?t[s]=o:l.isObject(e)?(t[s]={},n(e,t[s])):t[s]=e})};return n(this.lookups,t),t},e.exports=u},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(121),r=i(283),a=2e3,l=i(145),a=2e3,c=function(e,t,i){this.name="EmbedError",this.message=e,this.input=t,this.data=i,this.stack=(new Error).stack};c.prototype=new Error;var u=l.extend({constructor:function(e){this.setEmbedRegexes(e||[])},setEmbedRegexes:function(e){this.regexes=e,this.services=n.unique(n.values(e))},isValidEmbedService:function(e){return n.any(this.regexes,function(t,i){return new RegExp(i,"mi").test(e)})},isValidEmbedServiceName:function(e){return n.contains(this.services,e)},getUrlFromEmbedCode:function(e){var t=s(r.nodeFromString(e)),i=t.find("iframe[src], embed[src], script[src]").first(),n=t.find("object[data]").first();return i.attr("src")||n.attr("data")||!1},fetchEmbedData:function(e,t,i){var r=s.ajax({url:"/svc/post/get_video_data",type:"POST",with_form_key:!0,data:JSON.stringify({embed_url:e,embed_width:t})});return o(r).then(n.bind(function(s){if(n.isEmpty(s)||"false"===s||!n.isPlainObject(s))throw new c("Invalid embed response",e,s);if(s.thumbnail||i)return s;var r=n.bind(this.fetchEmbedData,this,e,t,!0);return o.promise(function(e,t){n.delay(function(){r().then(function(e){return e},function(){return s})},a)})},this))["catch"](function(e){return o.reject(e)})},parseEmbedData:function(e,t){if(!n.isString(e))throw"The input is invalid. Expected a string";var i=n.trim(e);if(this.isValidEmbedService(i))return this.fetchEmbedData(i,t);var s=this.getUrlFromEmbedCode(i);return n.isEmpty(s)?o.reject(new c("Invalid embed code",e)):o.resolve({unsupported:!0,thumbnail:!1,embed_render_context:"blank",url:s,preview_iframe:"",embed_code:e})}});e.exports=new u},function(e,t,i){"use strict";function n(e){var t=document.implementation.createHTMLDocument("");return t.body.innerHTML=e,t.body}function s(e){var t=document.implementation.createHTMLDocument("");return t.body.appendChild(e.cloneNode(!0)),t.body}function o(e){return s(e).innerHTML}function r(e){var t,i=document.implementation.createHTMLDocument("");return i.body.innerHTML=e,t=i.body.textContent||i.body.innerText||"",t=t.trim()}e.exports={nodeFromString:n,wrapNode:s,outerHTML:o,stripTags:r}},function(e,t,i){"use strict";e.exports=i(285)},function(e,t,i){"use strict";function n(e,t,i){this.src=t,this.env=i,this.options=e.options,this.tokens=[],this.inlineMode=!1,this.inline=e.inline,this.block=e.block,this.renderer=e.renderer,this.typographer=e.typographer}function s(e,t){t||r(e)||(t=e||{},e="default"),this.inline=new u,this.block=new c,this.core=new l,this.renderer=new a,this.ruler=new h,this.options={},this.configure(d[e]),t&&this.set(t)}var o=i(286).assign,r=i(286).isString,a=i(288),l=i(289),c=i(305),u=i(318),h=i(290),d={"default":i(335),full:i(336),commonmark:i(337)};s.prototype.set=function(e){o(this.options,e)},s.prototype.configure=function(e){var t=this;if(!e)throw new Error("Wrong `remarkable` preset, check name/content");e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(i){e.components[i].rules&&t[i].ruler.enable(e.components[i].rules,!0)})},s.prototype.use=function(e,t){return e(this,t),this},s.prototype.parse=function(e,t){var i=new n(this,e,t);return this.core.process(i),i.tokens},s.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)},s.prototype.parseInline=function(e,t){var i=new n(this,e,t);return i.inlineMode=!0,this.core.process(i),i.tokens},s.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)},e.exports=s},function(e,t,i){"use strict";function n(e){return Object.prototype.toString.call(e)}function s(e){return"[object String]"===n(e)}function o(e){var t=Array.prototype.slice.call(arguments,1);return t.forEach(function(t){if(t){if("object"!=typeof t)throw new TypeError(t+"must be object");Object.keys(t).forEach(function(i){e[i]=t[i]})}}),e}function r(e){return e.indexOf("\\")<0?e:e.replace(h,"$1")}function a(e){return e>=55296&&57343>=e?!1:e>=64976&&65007>=e?!1:65535===(65535&e)||65534===(65535&e)?!1:e>=0&&8>=e?!1:11===e?!1:e>=14&&31>=e?!1:e>=127&&159>=e?!1:!(e>1114111)}function l(e){if(e>65535){e-=65536;var t=55296+(e>>10),i=56320+(1023&e);return String.fromCharCode(t,i)}return String.fromCharCode(e)}function c(e,t){var i=0;return g.hasOwnProperty(t)?g[t]:35===t.charCodeAt(0)&&p.test(t)&&(i="x"===t[1].toLowerCase()?parseInt(t.slice(2),16):parseInt(t.slice(1),10),a(i))?l(i):e}function u(e){return e.indexOf("&")<0?e:e.replace(d,c)}var h=/\\([\\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g,d=/&([a-z#][a-z0-9]{1,31});/gi,p=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i,g=i(287);t.assign=o,t.isString=s,t.unescapeMd=r,t.isValidEntityCode=a,t.fromCodePoint=l,t.replaceEntities=u},function(e,t){"use strict";e.exports={Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",GT:">",Gt:"",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"","in":"",incare:"",infin:"",infintie:"",inodot:"",Int:"","int":"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",LT:"<",Lt:"",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:"\n",nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",
YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}},function(e,t,i){"use strict";function n(e){return p[e]}function s(e){return h.test(e)?e.replace(d,n):e}function o(e,t){return++t>=e.length-2?t:"paragraph_open"===e[t].type&&e[t].tight&&"inline"===e[t+1].type&&0===e[t+1].content.length&&"paragraph_close"===e[t+2].type&&e[t+2].tight?o(e,t+2):t}function r(e,t){return t=o(e,t),t<e.length&&"list_item_close"===e[t].type?"":"\n"}function a(){this.rules=l({},g)}var l=i(286).assign,c=i(286).unescapeMd,u=i(286).replaceEntities,h=/[&<>"]/,d=/[&<>"]/g,p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},g={};g.blockquote_open=function(){return"<blockquote>\n"},g.blockquote_close=function(e,t){return"</blockquote>"+r(e,t)},g.code=function(e,t){return e[t].block?"<pre><code>"+s(e[t].content)+"</code></pre>"+r(e,t):"<code>"+s(e[t].content)+"</code>"},g.fence=function(e,t,i){var n,o,a=e[t],l="",h=i.langPrefix,d="";return a.params&&(n=a.params.split(/ +/g),d=s(u(c(n[0]))),l=' class="'+h+d+'"'),o=i.highlight?i.highlight(a.content,d)||s(a.content):s(a.content),"<pre><code"+l+">"+o+"</code></pre>"+r(e,t)},g.heading_open=function(e,t){return"<h"+e[t].hLevel+">"},g.heading_close=function(e,t){return"</h"+e[t].hLevel+">\n"},g.hr=function(e,t,i){return(i.xhtmlOut?"<hr />":"<hr>")+r(e,t)},g.bullet_list_open=function(){return"<ul>\n"},g.bullet_list_close=function(e,t){return"</ul>"+r(e,t)},g.list_item_open=function(){return"<li>"},g.list_item_close=function(){return"</li>\n"},g.ordered_list_open=function(e,t){var i=e[t];return"<ol"+(i.order>1?' start="'+i.order+'"':"")+">\n"},g.ordered_list_close=function(e,t){return"</ol>"+r(e,t)},g.paragraph_open=function(e,t){return e[t].tight?"":"<p>"},g.paragraph_close=function(e,t){var i=!(e[t].tight&&t&&"inline"===e[t-1].type&&!e[t-1].content);return(e[t].tight?"":"</p>")+(i?r(e,t):"")},g.link_open=function(e,t){var i=e[t].title?' title="'+s(u(e[t].title))+'"':"";return'<a href="'+s(encodeURI(decodeURI(u(e[t].href))))+'"'+i+">"},g.link_close=function(){return"</a>"},g.image=function(e,t,i){var n=' src="'+s(encodeURI(e[t].src))+'"',o=e[t].title?' title="'+s(u(e[t].title))+'"':"",r=' alt="'+(e[t].alt?s(u(e[t].alt)):"")+'"',a=i.xhtmlOut?" /":"";return"<img"+n+r+o+a+">"},g.table_open=function(){return"<table>\n"},g.table_close=function(){return"</table>\n"},g.thead_open=function(){return"<thead>\n"},g.thead_close=function(){return"</thead>\n"},g.tbody_open=function(){return"<tbody>\n"},g.tbody_close=function(){return"</tbody>\n"},g.tr_open=function(){return"<tr>"},g.tr_close=function(){return"</tr>\n"},g.th_open=function(e,t){var i=e[t];return"<th"+(i.align?' style="text-align:'+i.align+'"':"")+">"},g.th_close=function(){return"</th>"},g.td_open=function(e,t){var i=e[t];return"<td"+(i.align?' style="text-align:'+i.align+'"':"")+">"},g.td_close=function(){return"</td>"},g.strong_open=function(){return"<strong>"},g.strong_close=function(){return"</strong>"},g.em_open=function(){return"<em>"},g.em_close=function(){return"</em>"},g.del_open=function(){return"<del>"},g.del_close=function(){return"</del>"},g.ins_open=function(){return"<ins>"},g.ins_close=function(){return"</ins>"},g.mark_open=function(){return"<mark>"},g.mark_close=function(){return"</mark>"},g.sub=function(e,t){return"<sub>"+s(e[t].content)+"</sub>"},g.sup=function(e,t){return"<sup>"+s(e[t].content)+"</sup>"},g.hardbreak=function(e,t,i){return i.xhtmlOut?"<br />\n":"<br>\n"},g.softbreak=function(e,t,i){return i.breaks?i.xhtmlOut?"<br />\n":"<br>\n":"\n"},g.text=function(e,t){return s(e[t].content)},g.htmlblock=function(e,t){return e[t].content},g.htmltag=function(e,t){return e[t].content},g.abbr_open=function(e,t){return'<abbr title="'+s(u(e[t].title))+'">'},g.abbr_close=function(){return"</abbr>"},a.prototype.renderInline=function(e,t,i){for(var n="",s=this.rules,o=0,r=e.length;r>o;o++)n+=s[e[o].type](e,o,t,i);return n},a.prototype.render=function(e,t,i){var n,s,o="",r=this.rules;for(n=0,s=e.length;s>n;n++)o+="inline"===e[n].type?this.renderInline(e[n].children,t,i):r[e[n].type](e,n,t,i);return o},e.exports=a},function(e,t,i){"use strict";function n(){this.options={},this.ruler=new s;for(var e=0;e<o.length;e++)this.ruler.push(o[e][0],o[e][1])}var s=i(290),o=[["block",i(291)],["abbr",i(292)],["references",i(295)],["inline",i(299)],["abbr2",i(300)],["replacements",i(301)],["smartquotes",i(302)],["linkify",i(303)]];n.prototype.process=function(e){var t,i,n;for(n=this.ruler.getRules(""),t=0,i=n.length;i>t;t++)n[t](e)},e.exports=n},function(e,t){"use strict";function i(){this.rules=[],this.cache=null}i.prototype.find=function(e){for(var t=0;t<this.rules.length;t++)if(this.rules[t].name===e)return t;return-1},i.prototype.at=function(e,t,i){var n=this.find(e),s=i||{};if(-1===n)throw new Error("Parser rule not found: "+e);this.rules[n].fn=t,this.rules[n].alt=s.alt||[],this.cache=null},i.prototype.before=function(e,t,i,n){var s=this.find(e),o=n||{};if(-1===s)throw new Error("Parser rule not found: "+e);this.rules.splice(s,0,{name:t,enabled:!0,fn:i,alt:o.alt||[]}),this.cache=null},i.prototype.after=function(e,t,i,n){var s=this.find(e),o=n||{};if(-1===s)throw new Error("Parser rule not found: "+e);this.rules.splice(s+1,0,{name:t,enabled:!0,fn:i,alt:o.alt||[]}),this.cache=null},i.prototype.push=function(e,t,i){var n=i||{};this.rules.push({name:e,enabled:!0,fn:t,alt:n.alt||[]}),this.cache=null},i.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]),t&&this.rules.forEach(function(e){e.enabled=!1}),e.forEach(function(e){var t=this.find(e);if(0>t)throw new Error("Rules manager: invalid rule name "+e);this.rules[t].enabled=!0},this),this.cache=null},i.prototype.disable=function(e){Array.isArray(e)||(e=[e]),e.forEach(function(e){var t=this.find(e);if(0>t)throw new Error("Rules manager: invalid rule name "+e);this.rules[t].enabled=!1},this),this.cache=null},i.prototype.compile=function(){var e=this,t=[""];e.rules.forEach(function(e){e.enabled&&e.alt.forEach(function(e){t.indexOf(e)<0&&t.push(e)})}),e.cache={},t.forEach(function(t){e.cache[t]=[],e.rules.forEach(function(i){i.enabled&&(t&&i.alt.indexOf(t)<0||e.cache[t].push(i.fn))})})},i.prototype.getRules=function(e){return null===this.cache&&this.compile(),this.cache[e]},e.exports=i},function(e,t){"use strict";e.exports=function(e){e.inlineMode?e.tokens.push({type:"inline",content:e.src.replace(/\n/g," ").trim(),level:0,lines:[0,1],children:[]}):e.block.parse(e.src,e.options,e.env,e.tokens)}},function(e,t,i){"use strict";function n(e,t,i,n){var r,a,l,c,u,h;if(42!==e.charCodeAt(0))return-1;if(91!==e.charCodeAt(1))return-1;if(-1===e.indexOf("]:"))return-1;if(r=new s(e,t,i,n,[]),a=o(r,1),0>a||58!==e.charCodeAt(a+1))return-1;for(c=r.posMax,l=a+2;c>l&&10!==r.src.charCodeAt(l);l++);return u=e.slice(2,a),h=e.slice(a+2,l).trim(),0===h.length?-1:(n.abbreviations||(n.abbreviations={}),n.abbreviations[u]=n.abbreviations[u]||h,l)}var s=i(293),o=i(294);e.exports=function(e){var t,i,s,o,r=e.tokens;if(!e.inlineMode)for(t=1,i=r.length-1;i>t;t++)if("paragraph_open"===r[t-1].type&&"inline"===r[t].type&&"paragraph_close"===r[t+1].type){for(s=r[t].content;s.length&&(o=n(s,e.inline,e.options,e.env),!(0>o));)s=s.slice(o).trim();r[t].content=s,s.length||(r[t-1].tight=!0,r[t+1].tight=!0)}}},function(e,t){"use strict";function i(e,t,i,n,s){this.src=e,this.env=n,this.options=i,this.parser=t,this.tokens=s,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache=[],this.isInLabel=!1,this.linkLevel=0,this.linkContent="",this.labelUnmatchedScopes=0}i.prototype.pushPending=function(){this.tokens.push({type:"text",content:this.pending,level:this.pendingLevel}),this.pending=""},i.prototype.push=function(e){this.pending&&this.pushPending(),this.tokens.push(e),this.pendingLevel=this.level},i.prototype.cacheSet=function(e,t){for(var i=this.cache.length;e>=i;i++)this.cache.push(0);this.cache[e]=t},i.prototype.cacheGet=function(e){return e<this.cache.length?this.cache[e]:0},e.exports=i},function(e,t){"use strict";e.exports=function(e,t){var i,n,s,o=-1,r=e.posMax,a=e.pos,l=e.isInLabel;if(e.isInLabel)return-1;if(e.labelUnmatchedScopes)return e.labelUnmatchedScopes--,-1;for(e.pos=t+1,e.isInLabel=!0,i=1;e.pos<r;){if(s=e.src.charCodeAt(e.pos),91===s)i++;else if(93===s&&(i--,0===i)){n=!0;break}e.parser.skipToken(e)}return n?(o=e.pos,e.labelUnmatchedScopes=0):e.labelUnmatchedScopes=i-1,e.pos=a,e.isInLabel=l,o}},function(e,t,i){"use strict";function n(e,t,i,n){var c,u,h,d,p,g,m,f,v;if(91!==e.charCodeAt(0))return-1;if(-1===e.indexOf("]:"))return-1;if(c=new s(e,t,i,n,[]),u=o(c,0),0>u||58!==e.charCodeAt(u+1))return-1;for(d=c.posMax,h=u+2;d>h&&(p=c.src.charCodeAt(h),32===p||10===p);h++);if(!r(c,h))return-1;for(m=c.linkContent,h=c.pos,g=h,h+=1;d>h&&(p=c.src.charCodeAt(h),32===p||10===p);h++);for(d>h&&g!==h&&a(c,h)?(f=c.linkContent,h=c.pos):(f="",h=g);d>h&&32===c.src.charCodeAt(h);)h++;return d>h&&10!==c.src.charCodeAt(h)?-1:(v=l(e.slice(1,u)),n.references[v]=n.references[v]||{title:f,href:m},h)}var s=i(293),o=i(294),r=i(296),a=i(297),l=i(298);e.exports=function(e){var t,i,s,o,r=e.tokens;if(e.env.references=e.env.references||{},!e.inlineMode)for(t=1,i=r.length-1;i>t;t++)if("inline"===r[t].type&&"paragraph_open"===r[t-1].type&&"paragraph_close"===r[t+1].type){for(s=r[t].content;s.length&&(o=n(s,e.inline,e.options,e.env),!(0>o));)s=s.slice(o).trim();r[t].content=s,s.length||(r[t-1].tight=!0,r[t+1].tight=!0)}}},function(e,t,i){"use strict";var n=i(286).unescapeMd;e.exports=function(e,t){var i,s,o=t,r=e.posMax;if(60===e.src.charCodeAt(t)){for(t++;r>t;){if(i=e.src.charCodeAt(t),10===i)return!1;if(62===i)return e.pos=t+1,e.linkContent=n(e.src.slice(o+1,t)),!0;92===i&&r>t+1?t+=2:t++}return!1}for(s=0;r>t&&(i=e.src.charCodeAt(t),32!==i)&&!(32>i||127===i);)if(92===i&&r>t+1)t+=2;else{if(40===i&&(s++,s>1))break;if(41===i&&(s--,0>s))break;t++}return o===t?!1:(e.linkContent=n(e.src.slice(o,t)),e.parser.validateLink(e.linkContent)?(e.pos=t,!0):!1)}},function(e,t,i){"use strict";var n=i(286).unescapeMd;e.exports=function(e,t){var i,s=t,o=e.posMax,r=e.src.charCodeAt(t);if(34!==r&&39!==r&&40!==r)return!1;for(t++,40===r&&(r=41);o>t;){if(i=e.src.charCodeAt(t),i===r)return e.pos=t+1,e.linkContent=n(e.src.slice(s+1,t)),!0;92===i&&o>t+1?t+=2:t++}return!1}},function(e,t){"use strict";e.exports=function(e){return e.trim().replace(/\s+/g," ").toLowerCase()}},function(e,t){"use strict";e.exports=function(e){var t,i,n,s=e.tokens;for(i=0,n=s.length;n>i;i++)t=s[i],"inline"===t.type&&e.inline.parse(t.content,e.options,e.env,t.children)}},function(e,t){"use strict";function i(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}var n=" \n()[]'\".,!?-";e.exports=function(e){var t,s,o,r,a,l,c,u,h,d,p,g,m=e.tokens;if(e.env.abbreviations)for(e.env.abbrRegExp||(g="(^|["+n.split("").map(i).join("")+"])("+Object.keys(e.env.abbreviations).sort(function(e,t){return t.length-e.length}).map(i).join("|")+")($|["+n.split("").map(i).join("")+"])",e.env.abbrRegExp=new RegExp(g,"g")),d=e.env.abbrRegExp,s=0,o=m.length;o>s;s++)if("inline"===m[s].type)for(r=m[s].children,t=r.length-1;t>=0;t--)if(a=r[t],"text"===a.type){for(u=0,l=a.content,d.lastIndex=0,h=a.level,c=[];p=d.exec(l);)d.lastIndex>u&&c.push({type:"text",content:l.slice(u,p.index+p[1].length),level:h}),c.push({type:"abbr_open",title:e.env.abbreviations[p[2]],level:h++}),c.push({type:"text",content:p[2],level:h}),c.push({type:"abbr_close",level:--h}),u=d.lastIndex-p[3].length;c.length&&(u<l.length&&c.push({type:"text",content:l.slice(u),level:h}),m[s].children=r=[].concat(r.slice(0,t),c,r.slice(t+1)))}}},function(e,t){"use strict";function i(e){return e.indexOf("(")<0?e:e.replace(s,function(e,t){return o[t.toLowerCase()]})}var n=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,s=/\((c|tm|r|p)\)/gi,o={c:"",r:"",p:"",tm:""};e.exports=function(e){var t,s,o,r,a;if(e.options.typographer)for(a=e.tokens.length-1;a>=0;a--)if("inline"===e.tokens[a].type)for(r=e.tokens[a].children,t=r.length-1;t>=0;t--)s=r[t],"text"===s.type&&(o=s.content,o=i(o),n.test(o)&&(o=o.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/gm,"$1$2").replace(/(^|\s)--(\s|$)/gm,"$1$2").replace(/(^|[^-\s])--([^-\s]|$)/gm,"$1$2")),s.content=o)}},function(e,t){"use strict";function i(e,t){return 0>t||t>=e.length?!1:!r.test(e[t])}function n(e,t,i){return e.substr(0,t)+i+e.substr(t+1)}var s=/['"]/,o=/['"]/g,r=/[-\s()\[\]]/,a="";e.exports=function(e){var t,r,l,c,u,h,d,p,g,m,f,v,_,b,w,y,k;if(e.options.typographer)for(k=[],w=e.tokens.length-1;w>=0;w--)if("inline"===e.tokens[w].type)for(y=e.tokens[w].children,k.length=0,t=0;t<y.length;t++)if(r=y[t],"text"===r.type&&!s.test(r.text)){for(d=y[t].level,_=k.length-1;_>=0&&!(k[_].level<=d);_--);k.length=_+1,l=r.content,u=0,h=l.length;e:for(;h>u&&(o.lastIndex=u,c=o.exec(l));)if(p=!i(l,c.index-1),u=c.index+1,b="'"===c[0],g=!i(l,u),g||p){if(f=!g,v=!p)for(_=k.length-1;_>=0&&(m=k[_],!(k[_].level<d));_--)if(m.single===b&&k[_].level===d){m=k[_],b?(y[m.token].content=n(y[m.token].content,m.pos,e.options.quotes[2]),r.content=n(r.content,c.index,e.options.quotes[3])):(y[m.token].content=n(y[m.token].content,m.pos,e.options.quotes[0]),r.content=n(r.content,c.index,e.options.quotes[1])),k.length=_;continue e}f?k.push({token:t,pos:c.index,single:b,level:d}):v&&b&&(r.content=n(r.content,c.index,a))}else b&&(r.content=n(r.content,c.index,a))}}},function(e,t,i){"use strict";function n(e){return/^<a[>\s]/i.test(e)}function s(e){return/^<\/a\s*>/i.test(e)}function o(){var e=[],t=new r({stripPrefix:!1,url:!0,email:!0,twitter:!1,replaceFn:function(t,i){switch(i.getType()){case"url":e.push({text:i.matchedText,url:i.getUrl()});break;case"email":e.push({text:i.matchedText,url:"mailto:"+i.getEmail().replace(/^mailto:/i,"")})}return!1}});return{links:e,autolinker:t}}var r=i(304),a=/www|@|\:\/\//;e.exports=function(e){var t,i,r,l,c,u,h,d,p,g,m,f,v,_=e.tokens,b=null;if(e.options.linkify)for(i=0,r=_.length;r>i;i++)if("inline"===_[i].type)for(l=_[i].children,m=0,t=l.length-1;t>=0;t--)if(c=l[t],"link_close"!==c.type){if("htmltag"===c.type&&(n(c.content)&&m>0&&m--,s(c.content)&&m++),!(m>0)&&"text"===c.type&&a.test(c.content)){if(b||(b=o(),f=b.links,v=b.autolinker),u=c.content,f.length=0,v.link(u),!f.length)continue;for(h=[],g=c.level,d=0;d<f.length;d++)e.inline.validateLink(f[d].url)&&(p=u.indexOf(f[d].text),p&&(g=g,h.push({type:"text",content:u.slice(0,p),level:g})),h.push({type:"link_open",href:f[d].url,title:"",level:g++}),h.push({type:"text",content:f[d].text,level:g}),h.push({type:"link_close",level:--g}),u=u.slice(p+f[d].text.length));u.length&&h.push({type:"text",content:u,level:g}),_[i].children=l=[].concat(l.slice(0,t),h,l.slice(t+1))}}else for(t--;l[t].level!==c.level&&"link_open"!==l[t].type;)t--}},function(e,t,i){var n,s;!function(i,o){n=[],s=function(){return i.returnExportsGlobal=o()}.apply(t,n),!(void 0!==s&&(e.exports=s))}(this,function(){/*!
		 * Autolinker.js
		 * 0.12.5
		 *
		 * Copyright(c) 2014 Gregory Jacobs <greg@greg-jacobs.com>
		 * MIT Licensed. http://www.opensource.org/licenses/mit-license.php
		 *
		 * https://github.com/gregjacobs/Autolinker.js
		 */
var e=function(t){e.Util.assign(this,t)};return e.prototype={constructor:e,urls:!0,email:!0,twitter:!0,newWindow:!0,stripPrefix:!0,className:"",htmlCharacterEntitiesRegex:/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;)/gi,matcherRegex:function(){var e=/(^|[^\w])@(\w{1,15})/,t=/(?:[\-;:&=\+\$,\w\.]+@)/,i=/(?:[A-Za-z]{3,9}:(?![A-Za-z]{3,9}:\/\/)(?:\/\/)?)/,n=/(?:www\.)/,s=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,o=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,r=/(?:[\-A-Za-z0-9+&@#\/%?=~_()|!:,.;'\$\*]*[\-A-Za-z0-9+&@#\/%=~_()|'\$\*])?/;return new RegExp(["(",e.source,")","|","(",t.source,s.source,o.source,")","|","(","(?:","(?:",i.source,s.source,")","|","(?:","(.?//)?",n.source,s.source,")","|","(?:","(.?//)?",s.source,o.source,")",")",r.source,")"].join(""),"gi")}(),invalidProtocolRelMatchRegex:/^[\w]\/\//,charBeforeProtocolRelMatchRegex:/^(.)?\/\//,link:function(t){var i=this,n=this.getHtmlParser(),s=this.htmlCharacterEntitiesRegex,o=0,r=[];return n.parse(t,{processHtmlNode:function(e,t,i){"a"===t&&(i?o=Math.max(o-1,0):o++),r.push(e)},processTextNode:function(t){if(0===o)for(var n=e.Util.splitAndCapture(t,s),a=0,l=n.length;l>a;a++){var c=n[a],u=i.processTextNode(c);r.push(u)}else r.push(t)}}),r.join("")},getHtmlParser:function(){var t=this.htmlParser;return t||(t=this.htmlParser=new e.HtmlParser),t},getTagBuilder:function(){var t=this.tagBuilder;return t||(t=this.tagBuilder=new e.AnchorTagBuilder({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),t},processTextNode:function(e){var t=this;return e.replace(this.matcherRegex,function(e,i,n,s,o,r,a,l){var c=t.processCandidateMatch.apply(t,arguments);if(c){var u=t.createMatchReturnVal(c.match,c.matchStr);return c.prefixStr+u+c.suffixStr}return e})},processCandidateMatch:function(t,i,n,s,o,r,a,l){var c,u=a||l,h="",d="";if(!this.isValidMatch(i,o,r,u))return null;if(this.matchHasUnbalancedClosingParen(t)&&(t=t.substr(0,t.length-1),d=")"),o)c=new e.match.Email({matchedText:t,email:o});else if(i)n&&(h=n,t=t.slice(1)),c=new e.match.Twitter({matchedText:t,twitterHandle:s});else{if(u){var p=u.match(this.charBeforeProtocolRelMatchRegex)[1]||"";p&&(h=p,t=t.slice(1))}c=new e.match.Url({matchedText:t,url:t,protocolRelativeMatch:u,stripPrefix:this.stripPrefix})}return{prefixStr:h,suffixStr:d,matchStr:t,match:c}},isValidMatch:function(e,t,i,n){return!(e&&!this.twitter||t&&!this.email||i&&!this.urls||i&&-1===i.indexOf(".")||i&&/^[A-Za-z]{3,9}:/.test(i)&&!/:.*?[A-Za-z]/.test(i)||n&&this.invalidProtocolRelMatchRegex.test(n))},matchHasUnbalancedClosingParen:function(e){var t=e.charAt(e.length-1);if(")"===t){var i=e.match(/\(/g),n=e.match(/\)/g),s=i&&i.length||0,o=n&&n.length||0;if(o>s)return!0}return!1},createMatchReturnVal:function(t,i){var n;if(this.replaceFn&&(n=this.replaceFn.call(this,this,t)),"string"==typeof n)return n;if(n===!1)return i;if(n instanceof e.HtmlTag)return n.toString();var s=this.getTagBuilder(),o=s.build(t);return o.toString()}},e.link=function(t,i){var n=new e(i);return n.link(t)},e.match={},e.Util={abstractMethod:function(){throw"abstract"},assign:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},extend:function(t,i){var n=t.prototype,s=function(){};s.prototype=n;var o;o=i.hasOwnProperty("constructor")?i.constructor:function(){n.constructor.apply(this,arguments)};var r=o.prototype=new s;return r.constructor=o,r.superclass=n,delete i.constructor,e.Util.assign(r,i),o},ellipsis:function(e,t,i){return e.length>t&&(i=null==i?"..":i,e=e.substring(0,t-i.length)+i),e},indexOf:function(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1},splitAndCapture:function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var i,n=[],s=0;i=t.exec(e);)n.push(e.substring(s,i.index)),n.push(i[0]),s=i.index+i[0].length;return n.push(e.substring(s)),n}},e.HtmlParser=e.Util.extend(Object,{htmlRegex:function(){var e=/[0-9a-zA-Z:]+/,t=/[^\s\0"'>\/=\x01-\x1F\x7F]+/,i=/(?:".*?"|'.*?'|[^'"=<>`\s]+)/,n=t.source+"(?:\\s*=\\s*"+i.source+")?";return new RegExp(["<(?:!|(/))?","("+e.source+")","(?:","\\s+","(?:",n,"|",i.source+")",")*","\\s*/?",">"].join(""),"g")}(),parse:function(e,t){t=t||{};for(var i,n=t.processHtmlNode||function(){},s=t.processTextNode||function(){},o=this.htmlRegex,r=0;null!==(i=o.exec(e));){var a=i[0],l=i[2],c=!!i[1],u=e.substring(r,i.index);u&&s(u),n(a,l,c),r=i.index+a.length}if(r<e.length){var h=e.substring(r);h&&s(h)}}}),e.HtmlTag=e.Util.extend(Object,{whitespaceRegex:/\s+/,constructor:function(t){e.Util.assign(this,t),this.innerHtml=this.innerHtml||this.innerHTML},setTagName:function(e){return this.tagName=e,this},getTagName:function(){return this.tagName||""},setAttr:function(e,t){var i=this.getAttrs();return i[e]=t,this},getAttr:function(e){return this.getAttrs()[e]},setAttrs:function(t){var i=this.getAttrs();return e.Util.assign(i,t),this},getAttrs:function(){return this.attrs||(this.attrs={})},setClass:function(e){return this.setAttr("class",e)},addClass:function(t){for(var i,n=this.getClass(),s=this.whitespaceRegex,o=e.Util.indexOf,r=n?n.split(s):[],a=t.split(s);i=a.shift();)-1===o(r,i)&&r.push(i);return this.getAttrs()["class"]=r.join(" "),this},removeClass:function(t){for(var i,n=this.getClass(),s=this.whitespaceRegex,o=e.Util.indexOf,r=n?n.split(s):[],a=t.split(s);r.length&&(i=a.shift());){var l=o(r,i);-1!==l&&r.splice(l,1)}return this.getAttrs()["class"]=r.join(" "),this},getClass:function(){return this.getAttrs()["class"]||""},hasClass:function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},setInnerHtml:function(e){return this.innerHtml=e,this},getInnerHtml:function(){return this.innerHtml||""},toString:function(){var e=this.getTagName(),t=this.buildAttrsStr();return t=t?" "+t:"",["<",e,t,">",this.getInnerHtml(),"</",e,">"].join("")},buildAttrsStr:function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i+'="'+e[i]+'"');return t.join(" ")}}),e.AnchorTagBuilder=e.Util.extend(Object,{constructor:function(t){e.Util.assign(this,t)},build:function(t){var i=new e.HtmlTag({tagName:"a",attrs:this.createAttrs(t.getType(),t.getAnchorHref()),innerHtml:this.processAnchorText(t.getAnchorText())});return i},createAttrs:function(e,t){var i={href:t},n=this.createCssClass(e);return n&&(i["class"]=n),this.newWindow&&(i.target="_blank"),i},createCssClass:function(e){var t=this.className;return t?t+" "+t+"-"+e:""},processAnchorText:function(e){return e=this.doTruncate(e)},doTruncate:function(t){return e.Util.ellipsis(t,this.truncate||Number.POSITIVE_INFINITY)}}),e.match.Match=e.Util.extend(Object,{constructor:function(t){e.Util.assign(this,t)},getType:e.Util.abstractMethod,getMatchedText:function(){return this.matchedText},getAnchorHref:e.Util.abstractMethod,getAnchorText:e.Util.abstractMethod}),e.match.Email=e.Util.extend(e.match.Match,{getType:function(){return"email"},getEmail:function(){return this.email},getAnchorHref:function(){return"mailto:"+this.email},getAnchorText:function(){return this.email}}),e.match.Twitter=e.Util.extend(e.match.Match,{getType:function(){return"twitter"},getTwitterHandle:function(){return this.twitterHandle},getAnchorHref:function(){return"https://twitter.com/"+this.twitterHandle},getAnchorText:function(){return"@"+this.twitterHandle}}),e.match.Url=e.Util.extend(e.match.Match,{urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,protocolRelativeRegex:/^\/\//,checkForProtocolRegex:/^[A-Za-z]{3,9}:/,getType:function(){return"url"},getUrl:function(){var e=this.url;return this.protocolRelativeMatch||this.checkForProtocolRegex.test(e)||(e=this.url="http://"+e),e},getAnchorHref:function(){var e=this.getUrl();return e.replace(/&amp;/g,"&")},getAnchorText:function(){var e=this.getUrl();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix&&(e=this.stripUrlPrefix(e)),e=this.removeTrailingSlash(e)},stripUrlPrefix:function(e){return e.replace(this.urlPrefixRegex,"")},stripProtocolRelativePrefix:function(e){return e.replace(this.protocolRelativeRegex,"")},removeTrailingSlash:function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e}}),e})},function(e,t,i){"use strict";function n(){this.ruler=new s;for(var e=0;e<r.length;e++)this.ruler.push(r[e][0],r[e][1],{alt:(r[e][2]||[]).slice()})}var s=i(290),o=i(306),r=[["code",i(307)],["fences",i(308),["paragraph","blockquote","list"]],["blockquote",i(309),["paragraph","blockquote","list"]],["hr",i(310),["paragraph","blockquote","list"]],["list",i(311),["paragraph","blockquote"]],["heading",i(312),["paragraph","blockquote"]],["lheading",i(313)],["htmlblock",i(314),["paragraph","blockquote"]],["table",i(316),["paragraph"]],["paragraph",i(317)]];n.prototype.tokenize=function(e,t,i){for(var n,s,o=this.ruler.getRules(""),r=o.length,a=t,l=!1;i>a&&(e.line=a=e.skipEmptyLines(a),!(a>=i))&&!(e.tShift[a]<e.blkIndent);){for(s=0;r>s&&!(n=o[s](e,a,i,!1));s++);if(e.tight=!l,e.isEmpty(e.line-1)&&(l=!0),a=e.line,i>a&&e.isEmpty(a)){if(l=!0,a++,i>a&&"list"===e.parentType&&e.isEmpty(a))break;e.line=a}}};var a=/[\n\t]/g,l=/\r[\n\u0085]|[\u2424\u2028\u0085]/g,c=/\u00a0/g;n.prototype.parse=function(e,t,i,n){var s,r=0,u=0;return e?(e=e.replace(c," "),e=e.replace(l,"\n"),e.indexOf("	")>=0&&(e=e.replace(a,function(t,i){var n;return 10===e.charCodeAt(i)?(r=i+1,u=0,t):(n="    ".slice((i-r-u)%4),u=i-r+1,n)})),s=new o(e,this,t,i,n),void this.tokenize(s,s.line,s.lineMax)):[]},e.exports=n},function(e,t){"use strict";function i(e,t,i,n,s){var o,r,a,l,c,u,h;for(this.src=e,this.parser=t,this.options=i,this.env=n,this.tokens=s,this.bMarks=[],this.eMarks=[],this.tShift=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.level=0,this.result="",r=this.src,u=0,h=!1,a=l=u=0,c=r.length;c>l;l++){if(o=r.charCodeAt(l),!h){if(32===o){u++;continue}h=!0}10!==o&&l!==c-1||(10!==o&&l++,this.bMarks.push(a),this.eMarks.push(l),this.tShift.push(u),h=!1,u=0,a=l+1)}this.bMarks.push(r.length),this.eMarks.push(r.length),this.tShift.push(0),this.lineMax=this.bMarks.length-1}i.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]},i.prototype.skipEmptyLines=function(e){for(var t=this.lineMax;t>e&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e},i.prototype.skipSpaces=function(e){for(var t=this.src.length;t>e&&32===this.src.charCodeAt(e);e++);return e},i.prototype.skipChars=function(e,t){for(var i=this.src.length;i>e&&this.src.charCodeAt(e)===t;e++);return e},i.prototype.skipCharsBack=function(e,t,i){if(i>=e)return e;for(;e>i;)if(t!==this.src.charCodeAt(--e))return e+1;return e},i.prototype.getLines=function(e,t,i,n){var s,o,r,a,l,c=e;if(e>=t)return"";if(c+1===t)return o=this.bMarks[c]+Math.min(this.tShift[c],i),r=n?this.bMarks[t]:this.eMarks[t-1],this.src.slice(o,r);for(a=new Array(t-e),s=0;t>c;c++,s++)l=this.tShift[c],l>i&&(l=i),0>l&&(l=0),o=this.bMarks[c]+l,r=t>c+1||n?this.eMarks[c]+1:this.eMarks[c],a[s]=this.src.slice(o,r);return a.join("")},e.exports=i},function(e,t){"use strict";e.exports=function(e,t,i){var n,s;if(e.tShift[t]-e.blkIndent<4)return!1;for(s=n=t+1;i>n;)if(e.isEmpty(n))n++;else{if(!(e.tShift[n]-e.blkIndent>=4))break;n++,s=n}return e.line=n,e.tokens.push({type:"code",content:e.getLines(t,s,4+e.blkIndent,!0),block:!0,lines:[t,e.line],level:e.level}),!0}},function(e,t){"use strict";e.exports=function(e,t,i,n){var s,o,r,a,l,c=!1,u=e.bMarks[t]+e.tShift[t],h=e.eMarks[t];if(u+3>h)return!1;if(s=e.src.charCodeAt(u),126!==s&&96!==s)return!1;if(l=u,u=e.skipChars(u,s),o=u-l,3>o)return!1;if(r=e.src.slice(u,h).trim(),r.indexOf("`")>=0)return!1;if(n)return!0;for(a=t;(a++,!(a>=i))&&(u=l=e.bMarks[a]+e.tShift[a],h=e.eMarks[a],!(h>u&&e.tShift[a]<e.blkIndent));)if(e.src.charCodeAt(u)===s&&!(e.tShift[a]-e.blkIndent>=4||(u=e.skipChars(u,s),o>u-l||(u=e.skipSpaces(u),h>u)))){c=!0;break}return o=e.tShift[t],e.line=a+(c?1:0),e.tokens.push({type:"fence",params:r,content:e.getLines(t+1,a,o,!0),lines:[t,e.line],level:e.level}),!0}},function(e,t){"use strict";e.exports=function(e,t,i,n){var s,o,r,a,l,c,u,h,d,p,g,m=e.bMarks[t]+e.tShift[t],f=e.eMarks[t];if(m>f)return!1;if(62!==e.src.charCodeAt(m++))return!1;if(e.level>=e.options.maxNesting)return!1;if(n)return!0;for(32===e.src.charCodeAt(m)&&m++,l=e.blkIndent,e.blkIndent=0,a=[e.bMarks[t]],e.bMarks[t]=m,m=f>m?e.skipSpaces(m):m,o=m>=f,r=[e.tShift[t]],e.tShift[t]=m-e.bMarks[t],h=e.parser.ruler.getRules("blockquote"),s=t+1;i>s&&(m=e.bMarks[s]+e.tShift[s],f=e.eMarks[s],!(m>=f));s++)if(62!==e.src.charCodeAt(m++)){if(o)break;for(g=!1,d=0,p=h.length;p>d;d++)if(h[d](e,s,i,!0)){g=!0;break}if(g)break;a.push(e.bMarks[s]),r.push(e.tShift[s]),e.tShift[s]=-1337}else 32===e.src.charCodeAt(m)&&m++,a.push(e.bMarks[s]),e.bMarks[s]=m,m=f>m?e.skipSpaces(m):m,o=m>=f,r.push(e.tShift[s]),e.tShift[s]=m-e.bMarks[s];for(c=e.parentType,e.parentType="blockquote",e.tokens.push({type:"blockquote_open",lines:u=[t,0],level:e.level++}),e.parser.tokenize(e,t,s),e.tokens.push({type:"blockquote_close",level:--e.level}),e.parentType=c,u[1]=e.line,d=0;d<r.length;d++)e.bMarks[d+t]=a[d],e.tShift[d+t]=r[d];return e.blkIndent=l,!0}},function(e,t){"use strict";e.exports=function(e,t,i,n){var s,o,r,a=e.bMarks[t],l=e.eMarks[t];if(a+=e.tShift[t],a>l)return!1;if(s=e.src.charCodeAt(a++),42!==s&&45!==s&&95!==s)return!1;for(o=1;l>a;){if(r=e.src.charCodeAt(a++),r!==s&&32!==r)return!1;r===s&&o++}return 3>o?!1:n?!0:(e.line=t+1,e.tokens.push({type:"hr",lines:[t,e.line],level:e.level}),!0)}},function(e,t){"use strict";function i(e,t){var i,n,s;return n=e.bMarks[t]+e.tShift[t],s=e.eMarks[t],n>=s?-1:(i=e.src.charCodeAt(n++),42!==i&&45!==i&&43!==i?-1:s>n&&32!==e.src.charCodeAt(n)?-1:n)}function n(e,t){var i,n=e.bMarks[t]+e.tShift[t],s=e.eMarks[t];if(n+1>=s)return-1;if(i=e.src.charCodeAt(n++),48>i||i>57)return-1;for(;;){if(n>=s)return-1;if(i=e.src.charCodeAt(n++),!(i>=48&&57>=i)){if(41===i||46===i)break;return-1}}return s>n&&32!==e.src.charCodeAt(n)?-1:n}function s(e,t){var i,n,s=e.level+2;for(i=t+2,n=e.tokens.length-2;n>i;i++)e.tokens[i].level===s&&"paragraph_open"===e.tokens[i].type&&(e.tokens[i+2].tight=!0,e.tokens[i].tight=!0,i+=2)}e.exports=function(e,t,o,r){var a,l,c,u,h,d,p,g,m,f,v,_,b,w,y,k,x,C,S,E,T,A,F=!0;if((g=n(e,t))>=0)b=!0;else{if(!((g=i(e,t))>=0))return!1;b=!1}if(e.level>=e.options.maxNesting)return!1;if(_=e.src.charCodeAt(g-1),r)return!0;for(y=e.tokens.length,b?(p=e.bMarks[t]+e.tShift[t],v=Number(e.src.substr(p,g-p-1)),e.tokens.push({type:"ordered_list_open",order:v,lines:x=[t,0],level:e.level++})):e.tokens.push({type:"bullet_list_open",lines:x=[t,0],level:e.level++}),a=t,k=!1,S=e.parser.ruler.getRules("list");!(!(o>a)||(w=e.skipSpaces(g),m=e.eMarks[a],f=w>=m?1:w-g,f>4&&(f=1),1>f&&(f=1),l=g-e.bMarks[a]+f,e.tokens.push({type:"list_item_open",lines:C=[t,0],level:e.level++}),u=e.blkIndent,h=e.tight,c=e.tShift[t],d=e.parentType,e.tShift[t]=w-e.bMarks[t],e.blkIndent=l,e.tight=!0,e.parentType="list",e.parser.tokenize(e,t,o,!0),e.tight&&!k||(F=!1),k=e.line-t>1&&e.isEmpty(e.line-1),e.blkIndent=u,e.tShift[t]=c,e.tight=h,e.parentType=d,e.tokens.push({type:"list_item_close",level:--e.level}),a=t=e.line,C[1]=a,w=e.bMarks[t],a>=o)||e.isEmpty(a)||e.tShift[a]<e.blkIndent);){for(A=!1,E=0,T=S.length;T>E;E++)if(S[E](e,a,o,!0)){A=!0;break}if(A)break;if(b){if(g=n(e,a),0>g)break}else if(g=i(e,a),0>g)break;if(_!==e.src.charCodeAt(g-1))break}return e.tokens.push({type:b?"ordered_list_close":"bullet_list_close",level:--e.level}),x[1]=a,e.line=a,F&&s(e,y),!0}},function(e,t){"use strict";e.exports=function(e,t,i,n){var s,o,r,a=e.bMarks[t]+e.tShift[t],l=e.eMarks[t];if(a>=l)return!1;if(s=e.src.charCodeAt(a),35!==s||a>=l)return!1;for(o=1,s=e.src.charCodeAt(++a);35===s&&l>a&&6>=o;)o++,s=e.src.charCodeAt(++a);return o>6||l>a&&32!==s?!1:n?!0:(l=e.skipCharsBack(l,32,a),r=e.skipCharsBack(l,35,a),r>a&&32===e.src.charCodeAt(r-1)&&(l=r),e.line=t+1,e.tokens.push({type:"heading_open",hLevel:o,lines:[t,e.line],level:e.level}),l>a&&e.tokens.push({type:"inline",content:e.src.slice(a,l).trim(),level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"heading_close",hLevel:o,level:e.level}),!0)}},function(e,t){"use strict";e.exports=function(e,t,i){var n,s,o,r=t+1;return r>=i?!1:e.tShift[r]<e.blkIndent?!1:e.tShift[r]-e.blkIndent>3?!1:(s=e.bMarks[r]+e.tShift[r],o=e.eMarks[r],s>=o?!1:(n=e.src.charCodeAt(s),45!==n&&61!==n?!1:(s=e.skipChars(s,n),s=e.skipSpaces(s),o>s?!1:(s=e.bMarks[t]+e.tShift[t],e.line=r+1,e.tokens.push({type:"heading_open",hLevel:61===n?1:2,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:e.src.slice(s,e.eMarks[t]).trim(),level:e.level+1,lines:[t,e.line-1],children:[]}),e.tokens.push({type:"heading_close",hLevel:61===n?1:2,level:e.level}),!0))))}},function(e,t,i){"use strict";function n(e){var t=32|e;return t>=97&&122>=t}var s=i(315),o=/^<([a-zA-Z]{1,15})[\s\/>]/,r=/^<\/([a-zA-Z]{1,15})[\s>]/;e.exports=function(e,t,i,a){var l,c,u,h=e.bMarks[t],d=e.eMarks[t],p=e.tShift[t];if(h+=p,!e.options.html)return!1;if(p>3||h+2>=d)return!1;if(60!==e.src.charCodeAt(h))return!1;if(l=e.src.charCodeAt(h+1),33===l||63===l){if(a)return!0}else{if(47!==l&&!n(l))return!1;if(47===l){if(c=e.src.slice(h,d).match(r),!c)return!1}else if(c=e.src.slice(h,d).match(o),!c)return!1;if(s[c[1].toLowerCase()]!==!0)return!1;if(a)return!0}for(u=t+1;u<e.lineMax&&!e.isEmpty(u);)u++;return e.line=u,e.tokens.push({type:"htmlblock",level:e.level,lines:[t,e.line],content:e.getLines(t,u,0,!0)}),!0}},function(e,t){"use strict";var i={};["article","aside","button","blockquote","body","canvas","caption","col","colgroup","dd","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","li","map","object","ol","output","p","pre","progress","script","section","style","table","tbody","td","textarea","tfoot","th","tr","thead","ul","video"].forEach(function(e){i[e]=!0}),e.exports=i},function(e,t){"use strict";function i(e,t){var i=e.bMarks[t]+e.blkIndent,n=e.eMarks[t];return e.src.substr(i,n-i)}e.exports=function(e,t,n,s){var o,r,a,l,c,u,h,d,p,g;if(t+2>n)return!1;if(c=t+1,e.tShift[c]<e.blkIndent)return!1;if(a=e.bMarks[c]+e.tShift[c],a>=e.eMarks[c])return!1;if(o=e.src.charCodeAt(a),124!==o&&45!==o&&58!==o)return!1;if(r=i(e,t+1),!/^[-:| ]+$/.test(r))return!1;if(u=r.split("|"),2>=u)return!1;for(h=[],l=0;l<u.length;l++){if(d=u[l].trim(),!d){if(0===l||l===u.length-1)continue;return!1}if(!/^:?-+:?$/.test(d))return!1;58===d.charCodeAt(d.length-1)?h.push(58===d.charCodeAt(0)?"center":"right"):58===d.charCodeAt(0)?h.push("left"):h.push("")}if(r=i(e,t).trim(),-1===r.indexOf("|"))return!1;if(u=r.replace(/^\||\|$/g,"").split("|"),h.length!==u.length)return!1;if(s)return!0;for(e.tokens.push({type:"table_open",lines:p=[t,0],level:e.level++}),e.tokens.push({type:"thead_open",lines:[t,t+1],level:e.level++}),e.tokens.push({type:"tr_open",lines:[t,t+1],level:e.level++}),l=0;l<u.length;l++)e.tokens.push({type:"th_open",align:h[l],lines:[t,t+1],level:e.level++}),e.tokens.push({type:"inline",content:u[l].trim(),lines:[t,t+1],level:e.level,children:[]}),e.tokens.push({type:"th_close",level:--e.level});for(e.tokens.push({type:"tr_close",level:--e.level}),e.tokens.push({type:"thead_close",level:--e.level}),e.tokens.push({type:"tbody_open",lines:g=[t+2,0],level:e.level++}),c=t+2;n>c&&!(e.tShift[c]<e.blkIndent)&&(r=i(e,c).trim(),-1!==r.indexOf("|"));c++){for(u=r.replace(/^\||\|$/g,"").split("|"),e.tokens.push({type:"tr_open",level:e.level++}),l=0;l<u.length;l++)e.tokens.push({type:"td_open",align:h[l],level:e.level++}),e.tokens.push({type:"inline",content:u[l].replace(/^\|? *| *\|?$/g,""),level:e.level,children:[]}),e.tokens.push({type:"td_close",level:--e.level});e.tokens.push({type:"tr_close",level:--e.level})}return e.tokens.push({type:"tbody_close",level:--e.level}),e.tokens.push({type:"table_close",level:--e.level}),p[1]=g[1]=c,e.line=c,!0}},function(e,t){"use strict";e.exports=function(e,t){var i,n,s,o,r,a,l=t+1;if(i=e.lineMax,i>l&&!e.isEmpty(l))for(a=e.parser.ruler.getRules("paragraph");i>l&&!e.isEmpty(l);l++)if(!(e.tShift[l]-e.blkIndent>3)){for(s=!1,o=0,r=a.length;r>o;o++)if(a[o](e,l,i,!0)){s=!0;break}if(s)break}return n=e.getLines(t,l,e.blkIndent,!1).trim(),e.line=l,n.length&&(e.tokens.push({type:"paragraph_open",tight:!1,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:n,level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"paragraph_close",tight:!1,level:e.level})),!0}},function(e,t,i){"use strict";function n(e){var t=decodeURI(e).trim().toLowerCase();return!(t.indexOf(":")>=0&&l.indexOf(t.split(":")[0])>=0)}function s(){this.validateLink=n,this.ruler=new o;for(var e=0;e<a.length;e++)this.ruler.push(a[e][0],a[e][1])}var o=i(290),r=i(293),a=[["text",i(319)],["newline",i(320)],["escape",i(321)],["backticks",i(322)],["del",i(323)],["ins",i(324)],["mark",i(325)],["emphasis",i(326)],["sub",i(327)],["sup",i(328)],["links",i(329)],["autolink",i(330)],["htmltag",i(332)],["entity",i(334)]],l=["vbscript","javascript","file"];s.prototype.skipToken=function(e){var t,i,n=e.pos,s=this.ruler.getRules(""),o=s.length;if((i=e.cacheGet(n))>0)return void(e.pos=i);for(t=0;o>t;t++)if(s[t](e,!0))return void e.cacheSet(n,e.pos);e.pos++,e.cacheSet(n,e.pos)},s.prototype.tokenize=function(e){for(var t,i,n=this.ruler.getRules(""),s=n.length,o=e.posMax;e.pos<o;){for(i=0;s>i&&!(t=n[i](e,!1));i++);if(t){if(e.pos>=o)break}else e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()},s.prototype.parse=function(e,t,i,n){var s=new r(e,this,t,i,n);this.tokenize(s)},e.exports=s},function(e,t){"use strict";function i(e){switch(e){case 10:case 92:case 96:case 42:case 95:case 94:case 91:case 93:case 33:case 38:case 60:case 62:case 123:case 125:case 36:case 37:case 64:case 126:case 43:case 61:case 58:return!0;default:return!1}}e.exports=function(e,t){for(var n=e.pos;n<e.posMax&&!i(e.src.charCodeAt(n));)n++;return n===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}},function(e,t){"use strict";e.exports=function(e,t){var i,n,s=e.pos;if(10!==e.src.charCodeAt(s))return!1;for(i=e.pending.length-1,n=e.posMax,t||(i>=0&&32===e.pending.charCodeAt(i)?i>=1&&32===e.pending.charCodeAt(i-1)?(e.pending=e.pending.replace(/ +$/,""),e.push({type:"hardbreak",level:e.level})):(e.pending=e.pending.slice(0,-1),e.push({type:"softbreak",level:e.level})):e.push({type:"softbreak",level:e.level})),s++;n>s&&32===e.src.charCodeAt(s);)s++;return e.pos=s,!0}},function(e,t){"use strict";for(var i=[],n=0;256>n;n++)i.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){i[e.charCodeAt(0)]=1}),e.exports=function(e,t){var n,s=e.pos,o=e.posMax;if(92!==e.src.charCodeAt(s))return!1;if(s++,o>s){if(n=e.src.charCodeAt(s),256>n&&0!==i[n])return t||(e.pending+=e.src[s]),e.pos+=2,!0;if(10===n){for(t||e.push({type:"hardbreak",level:e.level}),s++;o>s&&32===e.src.charCodeAt(s);)s++;return e.pos=s,!0}}return t||(e.pending+="\\"),e.pos++,!0}},function(e,t){"use strict";e.exports=function(e,t){var i,n,s,o,r,a=e.pos,l=e.src.charCodeAt(a);if(96!==l)return!1;for(i=a,a++,n=e.posMax;n>a&&96===e.src.charCodeAt(a);)a++;for(s=e.src.slice(i,a),o=r=a;-1!==(o=e.src.indexOf("`",r));){for(r=o+1;n>r&&96===e.src.charCodeAt(r);)r++;if(r-o===s.length)return t||e.push({type:"code",content:e.src.slice(a,o).replace(/[ \n]+/g," ").trim(),block:!1,level:e.level}),e.pos=r,!0}return t||(e.pending+=s),e.pos+=s.length,!0}},function(e,t){"use strict";e.exports=function(e,t){var i,n,s,o,r,a=e.posMax,l=e.pos;if(126!==e.src.charCodeAt(l))return!1;if(t)return!1;if(l+4>=a)return!1;if(126!==e.src.charCodeAt(l+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(o=l>0?e.src.charCodeAt(l-1):-1,r=e.src.charCodeAt(l+2),126===o)return!1;if(126===r)return!1;if(32===r||10===r)return!1;for(n=l+2;a>n&&126===e.src.charCodeAt(n);)n++;if(n>l+3)return e.pos+=n-l,t||(e.pending+=e.src.slice(l,n)),!0;for(e.pos=l+2,s=1;e.pos+1<a;){if(126===e.src.charCodeAt(e.pos)&&126===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),r=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1,126!==r&&126!==o&&(32!==o&&10!==o?s--:32!==r&&10!==r&&s++,0>=s))){i=!0;break}e.parser.skipToken(e)}return i?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"del_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"del_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}},function(e,t){"use strict";e.exports=function(e,t){var i,n,s,o,r,a=e.posMax,l=e.pos;if(43!==e.src.charCodeAt(l))return!1;if(t)return!1;if(l+4>=a)return!1;if(43!==e.src.charCodeAt(l+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(o=l>0?e.src.charCodeAt(l-1):-1,r=e.src.charCodeAt(l+2),43===o)return!1;if(43===r)return!1;if(32===r||10===r)return!1;for(n=l+2;a>n&&43===e.src.charCodeAt(n);)n++;if(n!==l+2)return e.pos+=n-l,t||(e.pending+=e.src.slice(l,n)),!0;for(e.pos=l+2,s=1;e.pos+1<a;){if(43===e.src.charCodeAt(e.pos)&&43===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),r=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1,43!==r&&43!==o&&(32!==o&&10!==o?s--:32!==r&&10!==r&&s++,0>=s))){i=!0;break}e.parser.skipToken(e)}return i?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"ins_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"ins_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}},function(e,t){"use strict";e.exports=function(e,t){var i,n,s,o,r,a=e.posMax,l=e.pos;if(61!==e.src.charCodeAt(l))return!1;if(t)return!1;if(l+4>=a)return!1;if(61!==e.src.charCodeAt(l+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(o=l>0?e.src.charCodeAt(l-1):-1,r=e.src.charCodeAt(l+2),61===o)return!1;if(61===r)return!1;if(32===r||10===r)return!1;for(n=l+2;a>n&&61===e.src.charCodeAt(n);)n++;if(n!==l+2)return e.pos+=n-l,t||(e.pending+=e.src.slice(l,n)),!0;for(e.pos=l+2,s=1;e.pos+1<a;){if(61===e.src.charCodeAt(e.pos)&&61===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),r=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1,61!==r&&61!==o&&(32!==o&&10!==o?s--:32!==r&&10!==r&&s++,0>=s))){i=!0;break}e.parser.skipToken(e)}return i?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"mark_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"mark_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}},function(e,t){"use strict";function i(e){return e>=48&&57>=e||e>=65&&90>=e||e>=97&&122>=e}function n(e,t){var n,s,o,r=t,a=!0,l=!0,c=e.posMax,u=e.src.charCodeAt(t);for(n=t>0?e.src.charCodeAt(t-1):-1;c>r&&e.src.charCodeAt(r)===u;)r++;return r>=c&&(a=!1),o=r-t,o>=4?a=l=!1:(s=c>r?e.src.charCodeAt(r):-1,32!==s&&10!==s||(a=!1),32!==n&&10!==n||(l=!1),95===u&&(i(n)&&(a=!1),i(s)&&(l=!1))),{can_open:a,can_close:l,delims:o}}e.exports=function(e,t){var i,s,o,r,a,l,c,u=e.posMax,h=e.pos,d=e.src.charCodeAt(h);if(95!==d&&42!==d)return!1;if(t)return!1;if(c=n(e,h),i=c.delims,!c.can_open)return e.pos+=i,t||(e.pending+=e.src.slice(h,e.pos)),!0;if(e.level>=e.options.maxNesting)return!1;for(e.pos=h+i,l=[i];e.pos<u;)if(e.src.charCodeAt(e.pos)!==d)e.parser.skipToken(e);else{if(c=n(e,e.pos),s=c.delims,c.can_close){for(r=l.pop(),a=s;r!==a;){if(r>a){l.push(r-a);break}if(a-=r,0===l.length)break;e.pos+=r,r=l.pop()}if(0===l.length){i=r,o=!0;break}e.pos+=s;continue}c.can_open&&l.push(s),e.pos+=s}return o?(e.posMax=e.pos,e.pos=h+i,t||(2!==i&&3!==i||e.push({type:"strong_open",level:e.level++}),1!==i&&3!==i||e.push({type:"em_open",level:e.level++}),e.parser.tokenize(e),1!==i&&3!==i||e.push({type:"em_close",level:--e.level}),2!==i&&3!==i||e.push({type:"strong_close",level:--e.level})),e.pos=e.posMax+i,e.posMax=u,!0):(e.pos=h,!1)}},function(e,t){"use strict";var i=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;e.exports=function(e,t){var n,s,o=e.posMax,r=e.pos;if(126!==e.src.charCodeAt(r))return!1;if(t)return!1;if(r+2>=o)return!1;if(e.level>=e.options.maxNesting)return!1;for(e.pos=r+1;e.pos<o;){if(126===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return n&&r+1!==e.pos?(s=e.src.slice(r+1,e.pos),s.match(/(^|[^\\])(\\\\)*\s/)?(e.pos=r,!1):(e.posMax=e.pos,e.pos=r+1,t||e.push({type:"sub",level:e.level,content:s.replace(i,"$1")}),e.pos=e.posMax+1,e.posMax=o,!0)):(e.pos=r,!1)}},function(e,t){"use strict";var i=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;e.exports=function(e,t){var n,s,o=e.posMax,r=e.pos;if(94!==e.src.charCodeAt(r))return!1;if(t)return!1;if(r+2>=o)return!1;if(e.level>=e.options.maxNesting)return!1;for(e.pos=r+1;e.pos<o;){if(94===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return n&&r+1!==e.pos?(s=e.src.slice(r+1,e.pos),s.match(/(^|[^\\])(\\\\)*\s/)?(e.pos=r,!1):(e.posMax=e.pos,e.pos=r+1,t||e.push({type:"sup",level:e.level,content:s.replace(i,"$1")}),e.pos=e.posMax+1,e.posMax=o,!0)):(e.pos=r,!1)}},function(e,t,i){"use strict";var n=i(294),s=i(296),o=i(297),r=i(298);e.exports=function(e,t){var i,a,l,c,u,h,d,p,g=!1,m=e.pos,f=e.posMax,v=e.pos,_=e.src.charCodeAt(v);if(33===_&&(g=!0,_=e.src.charCodeAt(++v)),91!==_)return!1;if(e.level>=e.options.maxNesting)return!1;if(i=v+1,a=n(e,v),0>a)return!1;if(h=a+1,f>h&&40===e.src.charCodeAt(h)){for(h++;f>h&&(p=e.src.charCodeAt(h),32===p||10===p);h++);if(h>=f)return!1;for(v=h,s(e,h)?(c=e.linkContent,h=e.pos):c="",v=h;f>h&&(p=e.src.charCodeAt(h),32===p||10===p);h++);if(f>h&&v!==h&&o(e,h))for(u=e.linkContent,h=e.pos;f>h&&(p=e.src.charCodeAt(h),32===p||10===p);h++);else u="";if(h>=f||41!==e.src.charCodeAt(h))return e.pos=m,!1;h++}else{if(e.linkLevel>0)return!1;for(;f>h&&(p=e.src.charCodeAt(h),32===p||10===p);h++);if(f>h&&91===e.src.charCodeAt(h)&&(v=h+1,h=n(e,h),h>=0?l=e.src.slice(v,h++):h=v-1),l||(l=e.src.slice(i,a)),d=e.env.references[r(l)],!d)return e.pos=m,!1;c=d.href,u=d.title}return t||(e.pos=i,e.posMax=a,g?e.push({type:"image",src:c,title:u,alt:e.src.substr(i,a-i),level:e.level}):(e.push({type:"link_open",href:c,title:u,level:e.level++}),e.linkLevel++,e.parser.tokenize(e),e.linkLevel--,e.push({type:"link_close",level:--e.level}))),e.pos=h,e.posMax=f,!0}},function(e,t,i){"use strict";var n=i(331),s=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,o=/^<([a-zA-Z.\-]{1,25}):([^<>\x00-\x20]*)>/;e.exports=function(e,t){var i,r,a,l,c=e.pos;return 60!==e.src.charCodeAt(c)?!1:(i=e.src.slice(c),i.indexOf(">")<0?!1:(r=i.match(o))?n.indexOf(r[1].toLowerCase())<0?!1:(l=r[0].slice(1,-1),
e.parser.validateLink(l)?(t||(e.push({type:"link_open",href:l,level:e.level}),e.push({type:"text",content:l,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=r[0].length,!0):!1):(a=i.match(s),a?(l=a[0].slice(1,-1),e.parser.validateLink("mailto:"+l)?(t||(e.push({type:"link_open",href:"mailto:"+l,level:e.level}),e.push({type:"text",content:l,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=a[0].length,!0):!1):!1))}},function(e,t){"use strict";e.exports=["coap","doi","javascript","aaa","aaas","about","acap","cap","cid","crid","data","dav","dict","dns","file","ftp","geo","go","gopher","h323","http","https","iax","icap","im","imap","info","ipp","iris","iris.beep","iris.xpc","iris.xpcs","iris.lwz","ldap","mailto","mid","msrp","msrps","mtqp","mupdate","news","nfs","ni","nih","nntp","opaquelocktoken","pop","pres","rtsp","service","session","shttp","sieve","sip","sips","sms","snmp","soap.beep","soap.beeps","tag","tel","telnet","tftp","thismessage","tn3270","tip","tv","urn","vemmi","ws","wss","xcon","xcon-userid","xmlrpc.beep","xmlrpc.beeps","xmpp","z39.50r","z39.50s","adiumxtra","afp","afs","aim","apt","attachment","aw","beshare","bitcoin","bolo","callto","chrome","chrome-extension","com-eventbrite-attendee","content","cvs","dlna-playsingle","dlna-playcontainer","dtn","dvb","ed2k","facetime","feed","finger","fish","gg","git","gizmoproject","gtalk","hcp","icon","ipn","irc","irc6","ircs","itms","jar","jms","keyparc","lastfm","ldaps","magnet","maps","market","message","mms","ms-help","msnim","mumble","mvn","notes","oid","palm","paparazzi","platform","proxy","psyc","query","res","resource","rmi","rsync","rtmp","secondlife","sftp","sgn","skype","smb","soldat","spotify","ssh","steam","svn","teamspeak","things","udp","unreal","ut2004","ventrilo","view-source","webcal","wtai","wyciwyg","xfire","xri","ymsgr"]},function(e,t,i){"use strict";function n(e){var t=32|e;return t>=97&&122>=t}var s=i(333).HTML_TAG_RE;e.exports=function(e,t){var i,o,r,a=e.pos;return e.options.html?(r=e.posMax,60!==e.src.charCodeAt(a)||a+2>=r?!1:(i=e.src.charCodeAt(a+1),(33===i||63===i||47===i||n(i))&&(o=e.src.slice(a).match(s))?(t||e.push({type:"htmltag",content:e.src.slice(a,a+o[0].length),level:e.level}),e.pos+=o[0].length,!0):!1)):!1}},function(e,t){"use strict";function i(e,t){return e=e.source,t=t||"",function i(n,s){return n?(s=s.source||s,e=e.replace(n,s),i):new RegExp(e,t)}}var n=/[a-zA-Z_:][a-zA-Z0-9:._-]*/,s=/[^"'=<>`\x00-\x20]+/,o=/'[^']*'/,r=/"[^"]*"/,a=i(/(?:unquoted|single_quoted|double_quoted)/)("unquoted",s)("single_quoted",o)("double_quoted",r)(),l=i(/(?:\s+attr_name(?:\s*=\s*attr_value)?)/)("attr_name",n)("attr_value",a)(),c=i(/<[A-Za-z][A-Za-z0-9]*attribute*\s*\/?>/)("attribute",l)(),u=/<\/[A-Za-z][A-Za-z0-9]*\s*>/,h=/<!--([^-]+|[-][^-]+)*-->/,d=/<[?].*?[?]>/,p=/<![A-Z]+\s+[^>]*>/,g=/<!\[CDATA\[([^\]]+|\][^\]]|\]\][^>])*\]\]>/,m=i(/^(?:open_tag|close_tag|comment|processing|declaration|cdata)/)("open_tag",c)("close_tag",u)("comment",h)("processing",d)("declaration",p)("cdata",g)();e.exports.HTML_TAG_RE=m},function(e,t,i){"use strict";var n=i(287),s=i(286).isValidEntityCode,o=i(286).fromCodePoint,r=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,a=/^&([a-z][a-z0-9]{1,31});/i;e.exports=function(e,t){var i,l,c,u=e.pos,h=e.posMax;if(38!==e.src.charCodeAt(u))return!1;if(h>u+1)if(i=e.src.charCodeAt(u+1),35===i){if(c=e.src.slice(u).match(r))return t||(l="x"===c[1][0].toLowerCase()?parseInt(c[1].slice(1),16):parseInt(c[1],10),e.pending+=o(s(l)?l:65533)),e.pos+=c[0].length,!0}else if(c=e.src.slice(u).match(a),c&&n.hasOwnProperty(c[1]))return t||(e.pending+=n[c[1]]),e.pos+=c[0].length,!0;return t||(e.pending+="&"),e.pos++,!0}},function(e,t){"use strict";e.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","replacements","linkify","smartquotes","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph","table"]},inline:{rules:["autolink","backticks","del","emphasis","entity","escape","htmltag","links","newline","text"]}}}},function(e,t){"use strict";e.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{},block:{},inline:{}}}},function(e,t){"use strict";e.exports={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","htmltag","links","newline","text"]}}}},function(e,t,i){"use strict";var n=i(3),s={text:i(339),photo:i(433),link:i(474),quote:i(477),chat:i(479),audio:i(481),video:i(497),note:i(524)},o=i(339),r=function(e){var t,i;return n.isPlainObject(e)?t=e.model:(t=e,e={model:t}),new(i=s[t.get("type")]||o)(e)};e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(108),r=i(340),a=i(220),l=i(342),c=i(356),o=i(108),u=i(432),h=r.extend({events:{},template:u,createSubViews:function(){var e=this.subViewOptions(),t=this.post.isReblog(),i=t&&o.bool("reblog_ui_refresh"),r=n.extend({className:"title-field",name:"title",placeholder:s("Title"),ariaLabel:s("Post title"),smartQuotesEnabled:!0,disableEdit:i},e),u=n.extend({className:"caption-field",name:"body",placeholder:s("Your text here"),ariaLabel:s("Post body")},e),h=n.extend({isRemovable:!0,origType:this.post.get("type")},e);i&&"text"===this.post.get("type")?this.title=this.subViews.title=null:this.title=this.subViews.title=new a(r),this.body=this.subViews.body=new c(u),t&&(this.reblogTree=this.subViews.reblogTree=new l(h)),this.registerTitleKeyboardShortcut(this.title)},afterRender:function(){this.renderSubViews(),this.delayedFocus(this.body)},getRichTextEditor:function(){return this.body}});e.exports=h},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(204),a=i(205),l=i(110),c=i(341),u=n.template(""),h=s.extend({template:u,mixins:[o,r,a],defaults:{hasMediaView:!1,hideControlsLine:!1},defaultOptions:{supportImageSearch:!1,minFullWidthSize:{}},initialize:function(e){if(this.options=e=n.extend({},this.defaultOptions,e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),!e.post)throw new Error("PostFormView requires a Post model!");if(!e.user)throw new Error("PostFormView requires a User model");n.extend(this,n.pick(e,["post","user","uploads"])),n.isFunction(this.afterInitialize)&&this.afterInitialize.apply(this,arguments)},createSubViews:function(){},subViewOptions:function(){return n.extend({},n.pick(this.options,"supportImageSearch","minFullWidthSize","dragEvents"),n.pick(this,"model","uploads","user","post"))},addStateListeners:function(){},getRichTextEditor:function(){},serialize:function(){return n.extend({canEditMedia:this.post.canEditMedia()},this.post.toJSON(),this.toJSON())},teardown:function(){return this.stopListening(),this.$el.empty(),this},beforeRender:function(){this.createSubViews(),this.addStateListeners()},render:function(){return this.$el.html(this.template(this.serialize())),this.attachSubViews(),this},registerTitleKeyboardShortcut:function(e){var t=/Mac/.test(navigator.platform)?"meta":"ctrl";return this.listenTo(l,"DOMEventor:keydown:"+t+"+shift+1",function(){e.focus()}),e},delayedFocus:function(e,t,i){"undefined"!=typeof i||(i=!0),"number"==typeof t||(t=200),n.delay(n.bind(function(){e.focus(i),i&&e.setCursorToEnd()},this),t||0)},getMinFullWidthSize:function(e){var t=this.options.minFullWidthSize||{};return n.isEmpty(t)?null:n.isNumber(t)?t:(e=c.convertToNormalizedType(e),n.has(t,e)?t[e]:null)}});e.exports=h},function(e,t,i){"use strict";function n(e){return/.+[.](jpg|jpeg|png|gif)([?]|$)/.test(e)===!0}function s(e){var t={jpeg:"jpg"},i=r.last((e||"").split("/")).toLowerCase();return r.has(t,i)?t[i]:i}function o(e){var t,i;return r.isString(e)&&(i=e.match(/^data:(image\/.*?);/i),i?t=i[1]:n(e)&&(t=a.getExtension(e))),t?s(t):void 0}var r=i(3),a=i(192);e.exports={convertToNormalizedType:s,getImageType:o,isImageUrl:n}},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(101),r=i(108),a=i(204),l=i(205),c=i(160),u=i(343),h=i(344),d=s.extend({className:"post-reblog-tree",events:{"click .btn-toggle-reblog":"toggleRemoveReblogTree"},mixins:[a,l,c],template:u,render:function(){return this.removeButton=this.subViews.removeButton=new h({tooltip:o("Remove reblogs"),buttonClass:"btn-remove-tree btn-toggle-reblog"}),this.$el.html(this.template(this.serialize())),this.attachSubViews(),this},teardown:function(){return this.$el.empty(),this},serialize:function(){return{showReblogTree:!n.isUndefined(this.model.get("reblog_tree"))&&this.model.get("reblog_tree"),post:this.model}},toggleRemoveReblogTree:function(e){var t=this.$(e.currentTarget),i=t.closest(".control-reblog-tree"),n=this.model.has("remove_reblog_tree")&&this.model.get("remove_reblog_tree")===!0;this.model.set("remove_reblog_tree",!n),i.toggleClass("removed",!n)}});r.bool("reblog_ui_refresh")?e.exports=i(347):e.exports=d},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="",showReblogTree&&(__p+=' <div class="control-reblog-tree post"><div class="reblog-tree post_content"> '+(null==(__t=post.get("reblog_tree"))?"":__t)+' </div><div data-subview="removeButton"></div><div class="btn-show-tree btn-toggle-reblog">'+(null==(__t=__("Put reblogs back"))?"":_.escape(__t))+"</div></div> "),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(345);e.exports=n},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(204),a=i(205),l=i(346),c=s.extend({events:{click:"_onClick",mouseenter:"_onMouseEnter",mouseleave:"_onMouseLeave"},template:l,mixins:[o,r,a],defaults:{dataJsName:"removeButton",buttonClass:""},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),this.onClick=e.onClick},serialize:function(){return this.toJSON()},render:function(){return this.$el.html(this.template(this.serialize())),this.get("dataJsName")&&this.$$(".remove-button").attr("data-js-"+this.get("dataJsName"),""),this},setActive:function(){this.$$(".remove-button").addClass("active")},setInactive:function(){this.$$(".remove-button").removeClass("active")},_onClick:function(){n.isFunction(this.onClick)?this.onClick(this):this.trigger("remove")},_onMouseEnter:function(){this.trigger("mouseenter")},_onMouseLeave:function(){this.trigger("mouseleave")}});e.exports=c},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="remove-button '+(null==(__t=buttonClass)?"":_.escape(__t))+'"><span class="icon"></span></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(205),o=i(101),r=i(156),a=i(348),l=i(344),c=i(350),u=i(355),h=r.extend({template:u,defaults:{isRemovable:!1},mixins:[s],events:{"click .btn-toggle-reblog":"toggleRemoveReblogTree","mouseenter .reblog-trail-post-content":"_onMouseEnter","mouseleave .reblog-trail-post-content":"_onMouseLeave"},initialize:function(e){if(this.options=n.merge({},this.defaults,e),this._getReblogTrail(this.model)&&(this.reblogListCollection=new a(this._getReblogTrail(this.model))),this.reblogListCollection){var t=this.reblogListCollection.length?this.reblogListCollection.first().get("title"):!1,i=this._getCurrentTitleMeta(this.model);this.reblogCollectionView=this.subviews.reblogCollectionView=new c({collection:this.reblogListCollection,titleData:!t&&i?i:!1,postType:this.model.get("type")}),this.get("isRemovable")&&(this.removeButton=this.subviews.removeButton=new l({tooltip:o("Remove reblogs"),buttonClass:"btn-remove-trail btn-toggle-reblog"}),this.listenTo(this.removeButton,"mouseenter",this._onMouseEnterRemoveButton),this.listenTo(this.removeButton,"mouseleave",this._onMouseLeaveRemoveButton))}},_getReblogData:function(e){return JSON.parse(e.get("reblog_trail"))},_getReblogTrail:function(e){return n.get(this._getReblogData(e),"reblog_entries")},_getCurrentTitleMeta:function(e){return n.get(this._getReblogData(e),"current_title_meta")},getTemplateData:function(){return{isRemovable:this.get("isRemovable")}},toggleRemoveReblogTree:function(){var e=this.$$(".control-reblog-trail"),t=this.model.has("remove_reblog_tree")&&this.model.get("remove_reblog_tree");this.model.set("remove_reblog_tree",!t),e.toggleClass("removed",!t)},_onMouseEnter:function(){this.removeButton.setActive()},_onMouseLeave:function(){this.removeButton.setInactive()},_onMouseEnterRemoveButton:function(){this.reblogCollectionView.$el.addClass("fade")},_onMouseLeaveRemoveButton:function(){this.reblogCollectionView.$el.removeClass("fade")}});e.exports=h},function(e,t,i){var n=i(119),s=i(349),o=n.extend({model:s});e.exports=o},function(e,t,i){var n=i(114),s=n.extend({defaults:{pid:null,name:null,permalink:null,content:null}});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(351),r=i(349),a=i(353),l=s.extend({className:"reblog-list",initialize:function(e){this.options=n.merge({},this.defaults,e);var t=this.collection,i="text"===this.options.postType,s=this.options.titleData;if(s){var l=new r(s);this.subviews["reblog-list-item-title"]=new a({model:l})}t.each(function(e,t){var n=i&&e.get("is_original_entry");this.subviews["reblog-list-item-"+t]=new o({model:e,origTextPost:n,isFirstEntry:0===t})},this)},render:function(){return n.each(this.subviews,n.bind(function(e){this.$el.append(e.render().$el)},this)),this},teardown:function(){return n.each(this.subviews,function(e){e.remove()}),this}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(352),r=s.extend({className:"reblog-list-item",template:o,defaults:{},initialize:function(e){this.options=n.merge({},this.defaults,e),this.options.origTextPost&&this.$el.addClass("reblog-list-item--text-post-original")},getTemplateData:function(){var e={name:this.model.get("name"),permalink:this.model.get("permalink"),avatar_url:this.model.get("avatar_url"),title:this.model.get("title"),content:n.trim(this.model.get("content"))?this.model.get("content"):"",isOriginalEntry:this.model.get("is_original_entry"),isFirstEntry:this.options.isFirstEntry};return e}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="reblog-header"> ',permalink?(__p+=' <a class="reblog-avatar '+(null==(__t=isOriginalEntry||isFirstEntry?"":"sub-icon-reblog")?"":__t)+'" href="'+(null==(__t=permalink)?"":_.escape(__t))+'" rel="noopener"> ',avatar_url&&(__p+=' <img class="reblog-avatar-image-thumb" src="'+(null==(__t=avatar_url)?"":_.escape(__t))+'"> '),__p+=' </a><a class="reblog-tumblelog-name" href="'+(null==(__t=permalink)?"":_.escape(__t))+'" rel="noopener"> '+(null==(__t=name)?"":_.escape(__t))+" </a> "):(__p+=' <span class="reblog-avatar inactive '+(null==(__t=isOriginalEntry?"":"sub-icon-reblog")?"":__t)+'"> ',avatar_url&&(__p+=' <img class="reblog-avatar-image-thumb" src="'+(null==(__t=avatar_url)?"":_.escape(__t))+'"> '),__p+=' </span><span class="reblog-tumblelog-name inactive"> '+(null==(__t=name)?"":_.escape(__t))+" </span> "),__p+=" </div> ",title&&(__p+=' <div class="reblog-title"> '+(null==(__t=title)?"":_.escape(__t))+" </div> "),__p+=" ",content&&""!==content&&(__p+=' <div class="reblog-content">'+(null==(__t=content)?"":__t)+"</div> "),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(354),r=s.extend({className:"reblog-list-title reblog-list-item",template:o,defaults:{},initialize:function(e){this.options=n.merge({},this.defaults,e)},getTemplateData:function(){var e={name:this.model.get("name"),avatar_url:this.model.get("avatar_url"),title:this.model.get("title")};return e}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="reblog-header"><span class="reblog-avatar"> ',avatar_url&&(__p+=' <img class="reblog-avatar-image-thumb" src="'+(null==(__t=avatar_url)?"":_.escape(__t))+'"> '),__p+=' </span><span class="reblog-tumblelog-name inactive"> '+(null==(__t=name)?"":_.escape(__t))+" </span></div> ",title&&(__p+=' <div class="reblog-title"> '+(null==(__t=title)?"":_.escape(__t))+" </div> "),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="control-reblog-trail post"><div class="reblog-trail-post-content"> ',isRemovable&&(__p+=' <div class="remove-button-wrapper" data-subview="removeButton"></div><div class="btn-show-trail btn-toggle-reblog">'+(null==(__t=__("Put reblogs back"))?"":_.escape(__t))+"</div> "),__p+=" ",this.subviews.reblogCollectionView&&(__p+=" "+(null==(__t=_subview("reblogCollectionView"))?"":__t)+" "),__p+=" </div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";function n(e,t){t.find(".velocity-animating").each(function(e,t){u(t).removeClass("velocity-animating").removeAttr("style")}),t.find('[class=""]').removeAttr("class"),t.find('img[src^="data:"]').attr("src","")}function s(e,t,i,n){c.each(e,function(e,i){n.find("["+t+'="'+i+'"]').attr("data-uploading-key",i).removeAttr("src")})}function o(e,t,i,n){c.each(e,function(e,i){n.find("["+t+'="'+i+'"]').remove()})}function r(e,t,i,n){c.each(e,function(e,i){n.find("["+t+'="'+i+'"]').attr("src",e)})}function a(e,t,i,n){n.find("["+e+"]").filter(t?":not([ "+t+"])":"*").removeAttr(e)}function l(e,t,i,n,s,o){o.find("["+n+'="'+e+'"]').removeAttr("data-uploading-key").removeAttr(n).attr("src",t)}var c=i(3),u=i(9),h=i(121),d=i(149),p=i(165).animate,g=i(165).hook,m=i(167),f=i(143),v=(i(103),i(101)),_=i(110),b=i(284),w=new b({html:!0}),y=i(357).toMarkdown,k=i(221),x=i(221).HumanKeys,C=i(359),S=i(360),E=i(364),T=i(401),A=i(404),F=i(424),R=i(204),L=i(205),$=i(160),D=i(427),P=i(428),I=i(106),M=i(193),B=i(192),O=i(186),j=i(187),N=i(189),V=i(429),q=i(430),z=i(388),U=i(283),W=i(431),H=i(341).convertToNormalizedType,G=1080,K=1,Y=2,J=d.extend({defaults:{placeholder:"",ariaLabel:"",name:"",syncWithModel:!0,supportImages:!0,supportImageSearch:!1,supportInlineEmbeds:!0,supportMentions:!0,fullWidthInlineMedia:!0,inlineMediaWidthReblog:250,inlineEmbedsPerPost:5,minFullWidthSize:{jpg:300,png:300,gif:300},fullWidthClass:"tmblr-full",animateInlineControls:!0},events:{},mixins:[$,R,L,D],template:P,pendingMedia:{},filtersToModel:[],filtersToEditor:[],initialize:function(e){e||(e=c.extend({},e)),c.extend(this.attributes,c.pick(e,c.keys(this.defaults))),c.extend(this,c.pick(e,"post")),c.has(e,"user")&&e.user.has("inlineEmbedsPerPost")?this.set("inlineEmbedsPerPost",e.user.get("inlineEmbedsPerPost")):this.set("inlineEmbedsPerPost",I.get("Components/PostFormBuilder/limits/inlineEmbedsPerPost")),this.hosts=I.get("Context/hosts"),this.editor=null,this.humanKeys=new x,this.keyCommands=J.KEYCOMMANDS,c.forEach(["onChange","onClientEvent","onImageAdded","pasteHook"],function(t){var i=e[t]||this[t];c.isFunction(i)?this[t]=c.bind(i,this):this[t]=c.noop},this);var t=this.get("name");t&&this.get("syncWithModel")&&(this.$el.attr("data-name",t),this.listenTo(this.model,"change:editorType",this._onChangeEditorType)),c.has(e,"user")&&e.user.has("inlineEmbedsPerPost")&&this.set("inlineEmbedsPerPost",e.user.get("inlineEmbedsPerPost")),c.has(e,"user")&&e.user.has("hasGifSearchVariation")&&this.set("hasGifSearchVariation",e.user.get("hasGifSearchVariation"))},_onChangeEditorType:function(e,t){var i=e.previous("editorType");"rich"===i?this.updateModelFromEditor("markdown"!==t?Y:K):"markdown"===i&&this.convertModelFromMarkdown(),"markdown"===t&&this.convertModelToMarkdown(),this.updateEditorType(t,!0),this.focus()},_initializeEditor:function(e,t){var i=c.bind(this.humanKeys.pretty,this.humanKeys),n={placeholder:t,flattenBlocks:!0,onChange:this._composeOnChange(),onAsyncImageAdded:c.bind(this.onAsyncImageAdded,this),onFileAdded:c.bind(this.insertImageFromFile,this),inlineControlsConfig:{openTray:c.bind(this.openInlineControlsTray,this),closeTray:c.bind(this.closeInlineControlsTray,this),onTrayOpened:c.bind(this.onInlineControlsTrayOpened,this),onTrayClosed:c.bind(this.onInlineControlsTrayClosed,this),onShow:c.bind(this.onInlineControlsShow,this),onHide:c.bind(this.onInlineControlsHide,this),customOffset:{x:0,y:0}},addImgAttrs:{toImg:!0,toImgParent:!0},formattingControlsConfig:{controls:{bold:{el:"b",className:"bold",command:"bold",type:"inline",title:v("Bold (%1$s)",i(this.keyCommands.BOLD)),keyboard:this.keyCommands.BOLD},italic:{el:"i",className:"italic",command:"italic",type:"inline",title:v("Italic (%1$s)",i(this.keyCommands.ITALIC)),keyboard:this.keyCommands.ITALIC},headline:{el:"h2",className:"headline",command:"formatBlock",type:"block",title:v("Headline (%1$s)",i(this.keyCommands.HEADLINE)),keyboard:this.keyCommands.HEADLINE},link:{el:"a",className:"link",command:"createLink",type:"inline",title:v("Link (%1$s)",i(this.keyCommands.LINK)),keyboard:this.keyCommands.LINK},strikethrough:{el:"strike",className:"strikethrough",command:"strikethrough",type:"inline",title:v("Strikethrough (%1$s)",i(this.keyCommands.STRIKETHROUGH)),keyboard:this.keyCommands.STRIKETHROUGH},orderedList:{el:"ol",className:"ordered-list",command:"insertOrderedList",type:"list",title:v("Ordered list (%1$s)",i(this.keyCommands.ORDEREDLIST)),keyboard:this.keyCommands.ORDEREDLIST},unorderedList:{el:"ul",className:"unordered-list",command:"insertUnorderedList",type:"list",title:v("Unordered list (%1$s)",i(this.keyCommands.UNORDEREDLIST)),keyboard:this.keyCommands.UNORDEREDLIST},blockquote:{el:"blockquote",className:"quote",command:"formatBlock",type:"block",title:v("Blockquote (%1$s)",i(this.keyCommands.BLOCKQUOTE)),keyboard:this.keyCommands.BLOCKQUOTE},clear:{el:"",command:"removeFormat",type:"inline",keyboard:this.keyCommands.REMOVEFORMAT},pre:{el:"pre",command:"formatBlock",type:"block",keyboard:this.keyCommands.PRE},superscript:{el:"sup",command:"superscript",type:"inline",keyboard:this.keyCommands.SUPERSCRIPT},subscript:{el:"sub",command:"subscript",type:"inline",keyboard:this.keyCommands.SUBSCRIPT},small:{el:"small",command:"insertHTML",type:"inline",keyboard:this.keyCommands.SMALL,keyboardInverse:this.keyCommands.SMALLINVERSE}},controlsOrder:["bold","italic","headline","link","strikethrough","orderedList","unorderedList","blockquote"]},pasteHook:this.pasteHook,blurHook:c.bind(this.blurHook,this),documentMousedownHook:c.bind(this.documentMousedownHook,this),runIFrameSanitization:!1,mediaHolderCallback:c.bind(this._mediaHolderCallback,this),filterRules:{elements:["a","b","i","strike","h2","blockquote","p","ul","ol","li","iframe","figure","img","br","hr","pre","code","small","sup","sub","figcaption"],attributes:{a:["href","title"],img:["src","alt","data-img-key","data-orig-width","data-orig-height","data-orig-src"],iframe:["src","width","height","allowfullscreen","mozallowfullscreen","webkitallowfullscreen","frameborder"],figure:["data-provider","data-url","data-orig-width","data-orig-height","data-orig-src","data-embed-code","data-tumblr-attribution"],hr:["data-label"]},classnames:{a:["tumblr_blog","tmblr-truncated-link"],hr:["tmblr-truncated"],blockquote:["link_og_blockquote"],figure:["tmblr-embed","tmblr-embed-placeholder","tmblr-full"]},remove_contents:["style","noscript","script","meta"],protocols:{a:!1,iframe:{src:["https://","http://","//"]}}},labels:{Edit:v("Edit"),Remove:v("Remove"),Open:v("Open"),Done:v("Done")},animateShowControls:function(e){e.element.show();var t=60,i=8;c.forEach(e.buttons,function(e,n){var s=u(e);p(s,"stop"),g(s,"translateY",i),s.css("opacity",0),p(s,{translateY:[0,i],opacity:[1,0]},{delay:.25*n*t,duration:t,complete:function(){s.attr("style","")}})},this)},animateHideControls:function(e){var t=100,i=8;c.forEach(e.buttons,function(n,s){var o=u(n);p(o,"stop");var r=p(o,{translateY:i,opacity:0},{duration:t});s===e.buttons.length-1&&r.then(function(){e.element.hide()})},this)},mediaKillerMarkup:'<div class="media-button icon_close"></div>',mediaMoverMarkup:'<div class="media-button icon_drag"></div>',showStaticControls:!1,smartQuotes:{enabled:!0}};this._setupEditorFilters(),this.editor=new k.RichTextEditor(e,n),this.inlineControlNode=!1,this.get("supportImages")&&this._initializeImageSupport(),this.inlineEmbedSupport=!1,this.get("supportInlineEmbeds")&&this._initializeInlineEmbedSupport(),this.imageSearchSupport=!1,this.get("supportImageSearch")&&this._initializeImageSearchSupport(),this.mentionSupport=!1,this.get("supportMentions")&&this._initializeMentionSupport(),this._initializeReadMoreSupport(),this.editor.config.filterForSetData=c.compose.apply(this,this.editorFilters.preSet),this.editor.config.filterForGetData=c.compose.apply(this,this.editorFilters.preGet),this.updateEditorType(),"markdown"===this.getEditorType()&&(this.model.set(this.get("name"),this._modelValue().replace(/^\s*<p>([\S\s]*)<\/p>\s*$/i,"$1")),this.htmlField.updateValueFromModel(),this.htmlField.updateEditor())},_setupEditorFilters:function(){this.editorFilters={preSet:[],preGet:[]},this.editorFilters.preSet.push(this._tagTranslator)},_tagTranslator:function(e,t){return t||(t={h1:"h2",h3:"b",h4:"b",h5:"b",h6:"b",strong:"b",em:"i"}),q(e,t)},updateInlineImages:function(){var e=!1,t=u(this.editor.element).find("img["+this.editor.config.imgKeyAttr+"]");t.each(c.bind(function(t,i){c.get(this.editor.mediaTracker[u(i).attr(this.editor.config.imgKeyAttr)],"updatedSource")||(e=!0)},this)),this.post.set("hasLoadingInlineImages",e)},_composeOnChange:function(){var e=[this.onChange],t=this;return this.get("syncWithModel")&&e.unshift(this.updateModelFromEditor),e.unshift(this.updateInlineImages),function(){c.each(e,function(e){e.call(t)})}},pasteHook:function(e,t){var i=e.getData("text/plain"),n=i.trim();return M.isImageUrl(n)&&!t?(this.insertImageFromUrl(n,i),!0):M.isUrl(n)&&!t?(this.editor.insertData('<a href="'+n+'">'+n+"</a>"),!0):void 0},cancelBlur:function(){this.cancelNextBlur=!0},resumeBlur:function(e){this.defaultBlur?this.defaultBlur(e):c.isFunction(e)&&e()},blurHook:function(e,t){return this.cancelNextBlur?(this.cancelNextBlur=!1,this.defaultBlur=t,!0):void 0},addElementToControlsCloseWhitelist:function(e){this.controlsCloseWhitelist||(this.controlsCloseWhitelist=[]),this.controlsCloseWhitelist.push(e)},removeElementFromControlsCloseWhitelist:function(e){c.isEmpty(this.controlsCloseWhitelist)||(this.controlsCloseWhitelist=c.without(this.controlsCloseWhitelist,e))},documentMousedownHook:function(e,t){return this.imageSearchSupport&&this.imageSearchSupport.isOpen()?!0:c.isEmpty(this.controlsCloseWhitelist)?void 0:c.find(this.controlsCloseWhitelist,function(t){return t===e.target||u.contains(t,e.target)})},_mediaHolderCallback:function(){this.mediaHolderCallback.apply(this,arguments)},mediaHolderCallback:function(e,t,i,n){i.is("hr, img, figure")&&c.isEmpty(i.find("iframe"))&&(n.addClass("media-holder-draggable"),c.isEmpty(i.find("[data-tumblr-query]"))||n.addClass("media-holder--gif-search")),n.addClass("media-holder-"+i.prop("tagName").toLowerCase())},_initializeImageSupport:function(){this.imageUploader=new F({name:"image",maxUploadSize:10485760,uploadPattern:/^image\/(?:.*)$/i,accept:"image/*",url:"/svc/post/upload_text_image"});var e=u("<div />",{"class":"control add-image","data-control-name":"inline-image",tabindex:"0",title:v("Insert photo (%1$s)",this.humanKeys.pretty(this.keyCommands.PHOTO))});e.on("click",c.bind(function(e){this.editor.staticControls.hide()},this)),e.append('<input type="file" accept="image/*" tabindex="-1" multiple="true">'),e.on('change input[type="file"]',c.bind(function(t){var i=u(t.target),n=c.toArray(i.prop("files"));c.forEach(n,function(e){this.insertImageFromFile(e)},this),i.remove(),e.append('<input type="file" accept="image/*" multiple="true">'),this.editor.inlineControls.close()},this)),this.editor.inlineControls.addToTray(e,{keyboard:{shortcut:this.keyCommands.PHOTO,callback:c.bind(function(){this._inlineControlKeyboardFocus(e)},this)}}),this.listenTo(this.imageUploader,"error",this._onFileUploadError)},_initializeImageSearchSupport:function(){var e=function(){this._inlineControlKeyboardFocus(this.imageSearchSupport.getButton(),function(){this.openImageSearch()},this)};this.imageSearchSupport=new E({editorView:this,editor:this.editor,title:v("Insert GIF (%1$s)",this.humanKeys.pretty(this.keyCommands.GIF)),trayOptions:{keyboard:{shortcut:this.keyCommands.GIF,callback:e,context:this}}}),this.mediaHolderCallback=W([this.mediaHolderCallback,c.bind(this.imageSearchSupport.addTumblrAttribution,this.imageSearchSupport)],this),this.filtersToModel.push(c.bind(this.imageSearchSupport.cleanupMarkup,this)),this.listenTo(this.imageSearchSupport,"prompt",function(){this.trigger("controls:gif:prompt")})},_onFileUploadError:function(e,t){var i=t.get("error")||v("Error uploading photo");f.alert("<p>"+i+"</p>")},insertImageFromUrl:function(e,t,i){t===!1||t||(t=e),i||(i={});var n=h.defer(),s=c.bind(function(){n.reject()},this);return O.load(e).then(c.bind(function(e){this.listenToOnce(this,"asyncImageAdded",function(e,t,i){n.resolve(e,t)}),this.editor.insertAsyncImage(e.src,null,i.targetNode,i.direction,i.skipSelectionUpdate)},this),c.bind(function(){t&&this.editor.insertData(t),s()},this)),n.promise},insertImageFromFile:function(e,t){t||(t={});var i=h.defer(),n=c.bind(function(){i.reject()},this);return e.type.match(/image\/(jpg|jpeg|png)/i)?j.read(e).then(c.bind(function(s){O.load(s.objectUrl||s.base64).then(c.bind(function(n){var o=new Image;o.src=n.src;var r=N.drawScaledAndRotated(o,n.width,n.height,s.rotation,s.mirrored,G);this.listenToOnce(this,"asyncImageAdded",function(e,t,n){i.resolve(e,t)}),this.editor.insertAsyncImage(r.toDataURL(s.file.type),e,t.targetNode,t.direction,t.skipSelectionUpdate)},this),n)},this),n):e.type.match(/image\/*/i)&&this.editor.insertAsyncImage(null,e,t.targetNode,t.direction,t.skipSelectionUpdate),i.promise},getMinFullWidthSize:function(e){var t=this.get("minFullWidthSize");return c.isNumber(t)?t:(e=H(e),c.has(t,e)?t[e]:null)},shouldBeFullWidth:function(e,t){var i;return this.get("fullWidthInlineMedia")&&(t=c.isNumber(t)?t:parseInt(t,10))?(i=this.getMinFullWidthSize(e),c.isNumber(i)?t>=i:!1):!1},addASyncImageFullWidthAttributes:function(e,t,i){var n;return t&&i&&this.shouldBeFullWidth(t,i)&&(n=this.editor.getAsyncImage(e))?(u(n).parent("figure").addClass(this.get("fullWidthClass")),!0):!1},onAsyncImageAdded:function(e,t,i,n){var s=c.has(n,"width")?n.width:null;if(i instanceof Blob)this.uploadInlineImage(e,i),this.pendingMedia[e]=t,this.addASyncImageFullWidthAttributes(e,i.type,s);else{if(!t||0!==t.lastIndexOf("http",0))return;B.isTumblrMediaUrl(t)?this.editor.updateAsyncImage(e,t):(this.uploadInlineImageUrl(e,t),this.pendingMedia[e]=t),this.addASyncImageFullWidthAttributes(e,B.getExtension(t),s)}this.trigger("asyncImageAdded",e,t,i)},updateImageAttributes:function(e,t,i){var n=this.model.get("editorType");"html"===n||"markdown"===n?("markdown"===n&&this.convertModelFromMarkdown(),this.model.set(this.get("name"),z(this._modelValue(),c.partial(l,e,t,i,this.editor.config.imgKeyAttr))),
"markdown"===n&&this.convertModelToMarkdown(),this.htmlField.updateValueFromModel(),this.htmlField.updateEditor()):(this.editor.updateAsyncImage(e,t,i),this.updateModelFromEditor()),delete this.pendingMedia[e]},uploadInlineImageUrl:function(e,t){V.uploadImageUrl(t,c.bind(function(t){this.updateImageAttributes(e,t.response.url)},this),c.bind(function(){this.updateImageAttributes(e,t)},this),c.bind(function(){this.updateInlineImages()},this))},uploadInlineImage:function(e,t){var i,n=c.bind(function(e,t){this.listenTo(t,"change:complete change:error",c.bind(function(t){var i,n=t.get("url");t.get("raw_width")&&t.get("raw_height")&&(i={width:t.get("raw_width"),height:t.get("raw_height")}),c.has(t.changed,"error"),O.load(n).then(c.bind(function(t){this.updateImageAttributes(e,n,i)},this)).done(c.bind(function(){this.updateInlineImages()},this)),this.stopListening(t,"change:complete change:error")},this))},this),s=function(i){i.get("file")===t&&(n.call(this,e,i),this.stopListening(this.imageUploader,"add",s))},o=function(n,s){if(s.get("file")===t){var o=u(this.editor.getAsyncImage(e)),r=o.closest(".media-holder");r.length?r.remove():o.remove(),this.updateModelFromEditor();var a;a=s.get("error")||v("Error uploading photo"),c.isArray(a)&&(a=a.join("</p><p>")),f.alert("<p>"+a+"</p>",c.bind(this.editor.focus,this.editor)),i.call(this,n,s)}};i=function(e,n){var r=n.files?n.files[0]:n.file;r=r||n.get("file"),r===t&&(this.stopListening(this.imageUploader,"add",s),this.stopListening(this.imageUploader,"invalid",o),this.stopListening(this.imageUploader,"send",i))},this.listenTo(this.imageUploader,"add",s),this.listenTo(this.imageUploader,"invalid",o),this.listenTo(this.imageUploader,"send",i),this.imageUploader.addFiles([t])},toggleInlineControlsTray:function(e){c.has(this.editor,"inlineControls")&&(e=e||!1,this.editor.inlineControls.toggleTrayWithIntent(e))},openInlineControlsTray:function(e){e=e||this.editor.inlineControls.tray||u(),this.editor.inlineControls.isShown||this.editor.inlineControls.show(),p(e,"stop",!0),e.css({opacity:"",left:"",right:""}),this._logInteraction("open-inline-controls"),this.editor.setPlaceholder(!1),this.get("hasGifSearchVariation")||this.editor.blur(!0),this.$el.addClass("tray-open"),this.catchTabs(e),this.get("hasGifSearchVariation")||e.attr("tabindex",0).focus(),this.catchEsc(e,this.toggleInlineControlsTray),c.forEach(e.find("[data-control-name]"),function(e,t){var i=u(e);i.on("click.inline-control-logging",c.bind(function(e){var t=u(e.currentTarget);this._logInteraction("click-inline-control",{controlName:t.attr("data-control-name")})},this))},this);var t=function(){this.$el.closest(".gif-search-variation").addClass("gs-variation-ran-once"),this.set("gsVariationRanOnce",!0)};this.get("animateInlineControls")&&!this.get("gsVariationRanOnce")&&c.forEach(e.find(".control"),function(e,i,n){var s=u(e),o={opacity:0},r={opacity:1};this.get("hasGifSearchVariation")?(o.right="-25px",r.right=0):(o.left="-25px",r.left=0),p(e,"stop",!0),s.css(o),p(e,r,{delay:30*i,duration:300,easing:[.175,.885,.32,1.275],complete:e===c.last(n)?c.bind(t,this):null})},this)},closeInlineControlsTray:function(e){if(e=e||u(),this.releaseTabs(),this.releaseEsc(e),!this.get("hasGifSearchVariation")){e.find(".control").off("click.inline-control-logging");var t=function(){e.css({opacity:"",left:""}),e.length&&e.is(":visible")&&this.editor.focus(!0),this.editor.setPlaceholder(this.get("placeholder")),this.$el.removeClass("tray-open")};p(e,{opacity:0,left:"-=20px"},{duration:150,complete:c.bind(t,this)})}},onInlineControlsTrayOpened:function(e){this.inlineControlNode=this.editor.getCurrentElement(),this.inlineEmbedSupport&&(this.inlineEmbedSupport.trayOpened(e),this.trigger("controls:open",e))},onInlineControlsTrayClosed:function(e){this.get("delayGifSearchVariationUponEditMode")&&this.get("gsVariationRanOnce")&&(this.set("delayGifSearchVariationUponEditMode",!1),this.$(".inline-controls").removeClass("edit-mode-init-hide")),this.inlineControlNode=!1,this.inlineEmbedSupport&&(this.inlineEmbedSupport.trayClosed(e),this.trigger("controls:close",e))},onInlineControlsShow:function(e){this.get("delayGifSearchVariationUponEditMode")&&this.$(".inline-controls").addClass("edit-mode-init-hide"),e.element.show(),this.$el.addClass("inline-controls-show"),this.trigger("controls:show")},onInlineControlsHide:function(e){e.element.hide(),this.$el.removeClass("inline-controls-show"),this.trigger("controls:hide")},_initializeMentionSupport:function(){var e=["tumblelog"];c.isArray(this.editor.config.linkConfig.bypassClasses||!1)&&(e=c.union(this.editor.config.linkConfig.bypassClasses,e)),this.editor.linkControl.bypassClasses=e,this.mentionPopover=new T({pinnedSide:"none",teardownOnEscape:!1,identifier:"postForms:mentionDropdown"}),this.mentionSupport=new C(this.editor,this.mentionPopover),this.getEditorValue=c.compose(this.mentionSupport.stripGhost,this.getEditorValue)},_getReadMoreMarkup:function(){return'<hr class="tmblr-truncated" data-label="'+v("Keep reading")+'">'},convertReadMoreMagicKey:function(e){var t=e.replace(/\[\[MORE\]\]/g,this._getReadMoreMarkup());return t},convertReadMoreHtml:function(e){var t=u(U.nodeFromString(e));return t.find(".tmblr-truncated").replaceWith("[[MORE]]"),t.html()},_createEmptyParagraph:function(){return this.editor.isCursorAtStart()?this.editor.insertNewParagraphBefore():this.editor.insertNewParagraphAfter()},_inlineControlKeyboardFocus:function(e,t,i){var n;this.editor.hasSelection()||(n=function(){var n=this.get("animateInlineControls");this.set("animateInlineControls",!1),this.toggleInlineControlsTray(!0),e&&u(e).focus(),"function"==typeof t&&t.call(i||this,e),this.set("animateInlineControls",n)},this.editor.isEmptyElement()?n.call(this):(this.listenToOnce(this,"controls:show",function(){setTimeout(c.bind(n,this),50)}),this._createEmptyParagraph()))},_initializeReadMoreSupport:function(){var e=function(e){return e.stopPropagation(),e.preventDefault(),!1},t=c.bind(function(){this.editor.hasSelection()||this.editor.insertMedia("<hr>")},this),i=c.bind(function(){if(!this.editor.hasSelection()){var e=this.$(".media-holder .tmblr-truncated");e.length&&e.closest(".media-holder").remove(),this.editor.insertMedia(this._getReadMoreMarkup())}},this),n=u("<div />",{"class":"control add-hr","data-control-name":"hr",tabindex:"0",title:v("Insert horizontal line (%1$s)",this.humanKeys.pretty(this.keyCommands.HR))});n.on("click",t),n.on("mousedown",e);var s=u("<div />",{"class":"control add-read-more","data-control-name":"read-more",tabindex:"0",title:v("Insert read-more link (%1$s)",this.humanKeys.pretty(this.keyCommands.MORE))});s.on("click",i),s.on("mousedown",e),this.editor.inlineControls.addToTray(n,{keyboard:{shortcut:this.keyCommands.HR,callback:t}}),this.editor.inlineControls.addToTray(s,{keyboard:{shortcut:this.keyCommands.MORE,callback:i}}),this.editorFilters.preSet.push(c.bind(function(e){var t=e;return t=this.convertReadMoreMagicKey(t)},this)),this.editorFilters.preGet.push(c.bind(function(e){var t=e;return t=this.convertReadMoreHtml(t)},this))},_initializeInlineEmbedSupport:function(){var e=function(){this.inlineEmbedSupport&&!this.inlineEmbedSupport.isDisabled&&this._inlineControlKeyboardFocus(this.inlineEmbedSupport.getButton(),function(){this.inlineEmbedSupport.prompt()},this)};this.inlineEmbedSupport=new S({editorView:this,editor:this.editor,inlineEmbedsPerPost:this.get("inlineEmbedsPerPost"),inlineMediaWidthReblog:this.get("inlineMediaWidthReblog"),inlineMediaWidthFull:this.get("fullWidthInlineMedia")?540:500,fullWidthInlineMedia:this.get("fullWidthInlineMedia"),fullWidthClass:this.get("fullWidthClass"),title:v("Insert video (%1$s)",this.humanKeys.pretty(this.keyCommands.EMBED)),disabledTitle:v("Sorry, you can't add more than %1$s videos",this.get("inlineEmbedsPerPost")),trayOptions:{keyboard:{shortcut:this.keyCommands.EMBED,callback:e,context:this}}}),this.editorFilters.preSet.push(c.bind(function(e){return this.inlineEmbedSupport?this.inlineEmbedSupport.addEmbedPlaceholders(e):e},this)),this.editorFilters.preGet.push(c.bind(function(e){return this.inlineEmbedSupport?this.inlineEmbedSupport.removeEmbedPlaceholders(e):e},this)),this.listenTo(this.inlineEmbedSupport,"prompt",function(){this.trigger("controls:embed:prompt")})},beforeRender:function(){this.htmlField=this.subViews.htmlField=new A({model:this.model,name:this.get("name")})},afterRender:function(){if(this.renderSubViews(),this.get("hasGifSearchVariation")){this.getEditorValue()&&this.set("delayGifSearchVariationUponEditMode",!0);var e=setTimeout(c.bind(function(){this.openInlineControlsTray(),this.editor.setPlaceholder(this.get("placeholder"))},this),400);this.set("openTrayTimeout",e)}},remove:function(){this._removed=!0,this.subViews=null,clearTimeout(this.get("openTrayTimeout"))},render:function(){var e=this._modelValue().length>0;e&&this.set("placeholder",!1),this.$el.html(this.template({ariaLabel:this.get("ariaLabel")}));var t=this.js$("richTextEditor").get(0);return this._initializeEditor(t,this.get("placeholder")),e&&("rich"!==this.getEditorType()||this.editorValueMatchesModel()||this.updateEditorFromModel()),this.attachSubViews(),this},teardown:function(){return this.$el.empty(),this.editor.teardown(),this.imageUploader&&(this.stopListening(this.imageUploader),this.imageUploader.teardown(),delete this.imageUploader),this.imageSearchSupport&&this.imageSearchSupport.teardown(),delete this.mentionSupport,delete this.inlineEmbedSupport,delete this.imageSearchSupport,this.editorFilters&&delete this.editorFilters,this},serialize:function(){return this.toJSON()},getEditorType:function(){return this.model.get("editorType")},getEditorValue:function(e,t){return"undefined"!=typeof e||(e=!0),"undefined"!=typeof t||(t=!0),this.editor?this.editor.getData(e,t):null},setEditorValue:function(e,t,i){this.editor&&this.editor.setData(e,t,i)},convertModelFromMarkdown:function(){var e=w.render(this._modelValue());return this.model.set(this.get("name"),e),e},convertModelToMarkdown:function(){var e=y(this._modelValue());return e=e.replace(new RegExp(/<figcaption\b([^>]*)>([\s\S]*?)<\/figcaption>/gi),"$2"),e=e.replace(new RegExp(/<figure\b([^>]*)>([\s\S]*?)<\/figure>/gi),"$2"),this.model.set(this.get("name"),e),e},updateModelFromEditor:function(e,t){if(!this.editor)return!1;var i=this.get("name"),r=this.getEditorValue(),l=[n];c.isEmpty(this.pendingMedia)||(e===Y?l.push(c.partial(s,this.pendingMedia,this.editor.config.imgKeyAttr)):e===K&&l.push(c.partial(o,this.pendingMedia,this.editor.config.imgKeyAttr))),t||l.push(c.partial(a,this.editor.config.imgKeyAttr,"data-uploading-key")),c.isEmpty(this.filtersToModel)||(l=l.concat(this.filtersToModel)),r=z(r,l),this.model.set(i,r)},updateEditorFromModel:function(){var e=this.getEditorValue(),t=this._modelValue();e=z(e,n),c.isEmpty(this.filtersToEditor)||(t=z(t,this.filtersToEditor)),this.setEditorValue(t,!0)},editorValueMatchesModel:function(){var e=this.getEditorValue(),t=this._modelValue(),i=[n];return c.isEmpty(this.pendingMedia)||i.push(c.partial(s,this.pendingMedia,this.editor.config.imgKeyAttr)),i.push(c.partial(a,this.editor.config.imgKeyAttr,"data-uploading-key")),c.isEmpty(this.filtersToModel)||(i=i.concat(this.filtersToModel)),e=z(e,i),t.trim()===e.trim()},updateEditorType:function(e,t){e||(e=this.model.get("editorType"));var i=u(this.editor.wrapper),n=!!this.model.get("hasSeenHtml");if("rich"===e){this.htmlField.hide();var s=this._modelValue(!0),o=[];c.isEmpty(this.pendingMedia)||o.push(c.partial(r,this.pendingMedia,this.editor.config.imgKeyAttr)),o.push(c.partial(a,this.editor.config.imgKeyAttr,"data-uploading-key")),s=z(s,o),this.setEditorValue(s,!0,n),i.show()}else i.hide(),this.htmlField.updateValueFromModel(),this.htmlField.set("isMarkdown","markdown"===e),t&&this.htmlField.set("editedSincePreview",!0),this.htmlField.show(),this.htmlField.showSource(n),this.model.set("hasSeenHtml",!0)},_modelValue:function(e){var t=this.model.get(this.get("name"))||"";return t=t.replace(/<!-- +more +-->/gi,"[[MORE]]"),e&&c.result(this.model,"isReblog")&&(t=t.replace(/<p>\s*<br\s*\/?>\s<\/p>$/i,"")+"<p><br></p>"),t},focus:function(e){this.editor&&"rich"===this.getEditorType()?this.editor.focus(e):this.htmlField&&this.htmlField.focus()},blur:function(e){this.editor&&"rich"===this.getEditorType()?this.editor.blur(e):this.htmlField&&this.htmlField.blur()},catchEsc:function(e,t){u(e).on("keydown.rteCatchEsc",c.bind(function(e){27===e.keyCode&&(t.call(this),e.stopPropagation())},this))},releaseEsc:function(e){u(e).off("keydown.rteCatchEsc")},setCursorToEnd:function(){this.editor&&c.isFunction(this.editor.setCursorToEnd)&&this.editor.setCursorToEnd()},_logInteraction:function(e,t){var i={action:e,tumblelog:this.model.get("tumblelog"),mode:this.model.get("mode"),postType:this.model.get("type"),editorType:this.model.get("editorType")};i.inputLength=this.getEditorValue().length,t&&(i=c.extend(i,t)),_.trigger("postform-interaction:"+e,{loggingData:i})},openImageSearch:function(){this.imageSearchSupport&&this.imageSearchSupport.prompt(this.imageSearchSupport.get("query",!1))}},{KEYCOMMANDS:{BOLD:"meta+b",ITALIC:"meta+i",HEADLINE:"meta+shift+2",LINK:"meta+k",STRIKETHROUGH:"meta+shift+6",ORDEREDLIST:"meta+shift+7",UNORDEREDLIST:"meta+shift+8",BLOCKQUOTE:"meta+shift+9",REMOVEFORMAT:"meta+shift+0",PRE:"meta+shift+x",SUPERSCRIPT:"meta+dot",SUBSCRIPT:"meta+comma",SMALL:"meta+shift+minus",SMALLINVERSE:"meta+shift+plus",PHOTO:"meta+shift+p",GIF:"meta+shift+g",EMBED:"meta+shift+m",HR:"meta+shift+l",MORE:"meta+shift+k"}});m({"Tumblr.Prima.RichTextEditorView":J}),e.exports=J},function(e,t,i){if("object"!=typeof n)var n=i(358);var s=function(e){function t(e,t){var i="void"===t.type?"<"+t.tag+"\\b([^>]*)\\/?>":"<"+t.tag+"\\b([^>]*)>([\\s\\S]*?)<\\/"+t.tag+">",n=new RegExp(i,"gi"),s="";return s="string"==typeof t.replacement?e.replace(n,t.replacement):e.replace(n,function(e,i,n,s){return t.replacement.call(this,e,i,n,s)})}function i(e){return new RegExp(e+"\\s*=\\s*[\"']?([^\"']*)[\"']?","i")}function s(e){return e=e.replace(/<(ul|ol)\b[^>]*>([\s\S]*?)<\/\1>/gi,function(e,t,i){var n=i.split("</li>");for(n.splice(n.length-1,1),l=0,c=n.length;c>l;l++)if(n[l]){var s="ol"===t?l+1+".  ":"*   ";n[l]=n[l].replace(/\s*<li[^>]*>([\s\S]*)/i,function(e,t){return t=t.replace(/^\s+/,""),t=t.replace(/\n\n/g,"\n\n    "),t=t.replace(/\n([ ]*)+(\*|\d+\.) /g,"\n$1    $2 "),s+t})}return n.join("\n")}),"\n\n"+e.replace(/[ \t]+\n|\s+$/g,"")}function o(e){return e=e.replace(/<blockquote\b[^>]*>([\s\S]*?)<\/blockquote>/gi,function(e,t){return t=t.replace(/^\s+|\s+$/g,""),t=r(t),t=t.replace(/^/gm,"> "),t=t.replace(/^(>([ \t]{2,}>)+)/gm,"> >")})}function r(e){return e=e.replace(/^[\t\r\n]+|[\t\r\n]+$/g,""),e=e.replace(/\n\s+\n/g,"\n\n"),e=e.replace(/\n{3,}/g,"\n\n")}for(var a=[{patterns:"p",replacement:function(e,t,i){return i?"\n\n"+i+"\n":""}},{patterns:"br",type:"void",replacement:"\n"},{patterns:"h([1-6])",replacement:function(e,t,i,n){for(var s="",o=0;t>o;o++)s+="#";return"\n\n"+s+" "+n+"\n"}},{patterns:"hr",type:"void",replacement:"\n\n* * *\n"},{patterns:"a",replacement:function(e,t,n){var s=t.match(i("href")),o=t.match(i("title"));return s?"["+n+"]("+s[1]+(o&&o[1]?' "'+o[1]+'"':"")+")":e}},{patterns:["b","strong"],replacement:function(e,t,i){return i?"**"+i+"**":""}},{patterns:["i","em"],replacement:function(e,t,i){return i?"_"+i+"_":""}},{patterns:"code",replacement:function(e,t,i){return i?"`"+n.decode(i)+"`":""}},{patterns:"img",type:"void",replacement:function(e,t,n){var s=t.match(i("src")),o=t.match(i("alt")),r=t.match(i("title"));return"!["+(o&&o[1]?o[1]:"")+"]("+s[1]+(r&&r[1]?' "'+r[1]+'"':"")+")"}}],l=0,c=a.length;c>l;l++)if("string"==typeof a[l].patterns)e=t(e,{tag:a[l].patterns,replacement:a[l].replacement,type:a[l].type});else for(var u=0,h=a[l].patterns.length;h>u;u++)e=t(e,{tag:a[l].patterns[u],replacement:a[l].replacement,type:a[l].type});e=e.replace(/<pre\b[^>]*>`([\s\S]*)`<\/pre>/gi,function(e,t){var i=n.decode(t);return i=i.replace(/^\t+/g,"  "),i=i.replace(/\n/g,"\n    "),"\n\n    "+i+"\n"}),e=e.replace(/^(\s{0,3}\d+)\. /g,"$1\\. ");for(var d=/<(ul|ol)\b[^>]*>(?:(?!<ul|<ol)[\s\S])*?<\/\1>/gi;e.match(d);)e=e.replace(d,function(e){return s(e)});for(var p=/<blockquote\b[^>]*>((?:(?!<blockquote)[\s\S])*?)<\/blockquote>/gi;e.match(p);)e=e.replace(p,function(e){return o(e)});return r(e)};t.toMarkdown=s},function(e,t,i){var n;(function(e,s){!function(o){var r="object"==typeof t&&t,a=("object"==typeof e&&e&&e.exports==r&&e,"object"==typeof s&&s);a.global!==a&&a.window!==a||(o=a);var l=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,c=/[\x01-\x7F]/g,u=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,h=/<\u20D2|=\u20E5|>\u20D2|\u205F\u200A|\u219D\u0338|\u2202\u0338|\u2220\u20D2|\u2229\uFE00|\u222A\uFE00|\u223C\u20D2|\u223D\u0331|\u223E\u0333|\u2242\u0338|\u224B\u0338|\u224D\u20D2|\u224E\u0338|\u224F\u0338|\u2250\u0338|\u2261\u20E5|\u2264\u20D2|\u2265\u20D2|\u2266\u0338|\u2267\u0338|\u2268\uFE00|\u2269\uFE00|\u226A\u0338|\u226A\u20D2|\u226B\u0338|\u226B\u20D2|\u227F\u0338|\u2282\u20D2|\u2283\u20D2|\u228A\uFE00|\u228B\uFE00|\u228F\u0338|\u2290\u0338|\u2293\uFE00|\u2294\uFE00|\u22B4\u20D2|\u22B5\u20D2|\u22D8\u0338|\u22D9\u0338|\u22DA\uFE00|\u22DB\uFE00|\u22F5\u0338|\u22F9\u0338|\u2933\u0338|\u29CF\u0338|\u29D0\u0338|\u2A6D\u0338|\u2A70\u0338|\u2A7D\u0338|\u2A7E\u0338|\u2AA1\u0338|\u2AA2\u0338|\u2AAC\uFE00|\u2AAD\uFE00|\u2AAF\u0338|\u2AB0\u0338|\u2AC5\u0338|\u2AC6\u0338|\u2ACB\uFE00|\u2ACC\uFE00|\u2AFD\u20E5|[\xA0-\u0113\u0116-\u0122\u0124-\u012B\u012E-\u014D\u0150-\u017E\u0192\u01B5\u01F5\u0237\u02C6\u02C7\u02D8-\u02DD\u0311\u0391-\u03A1\u03A3-\u03A9\u03B1-\u03C9\u03D1\u03D2\u03D5\u03D6\u03DC\u03DD\u03F0\u03F1\u03F5\u03F6\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E\u045F\u2002-\u2005\u2007-\u2010\u2013-\u2016\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2025\u2026\u2030-\u2035\u2039\u203A\u203E\u2041\u2043\u2044\u204F\u2057\u205F-\u2063\u20AC\u20DB\u20DC\u2102\u2105\u210A-\u2113\u2115-\u211E\u2122\u2124\u2127-\u2129\u212C\u212D\u212F-\u2131\u2133-\u2138\u2145-\u2148\u2153-\u215E\u2190-\u219B\u219D-\u21A7\u21A9-\u21AE\u21B0-\u21B3\u21B5-\u21B7\u21BA-\u21DB\u21DD\u21E4\u21E5\u21F5\u21FD-\u2205\u2207-\u2209\u220B\u220C\u220F-\u2214\u2216-\u2218\u221A\u221D-\u2238\u223A-\u2257\u2259\u225A\u225C\u225F-\u2262\u2264-\u228B\u228D-\u229B\u229D-\u22A5\u22A7-\u22B0\u22B2-\u22BB\u22BD-\u22DB\u22DE-\u22E3\u22E6-\u22F7\u22F9-\u22FE\u2305\u2306\u2308-\u2310\u2312\u2313\u2315\u2316\u231C-\u231F\u2322\u2323\u232D\u232E\u2336\u233D\u233F\u237C\u23B0\u23B1\u23B4-\u23B6\u23DC-\u23DF\u23E2\u23E7\u2423\u24C8\u2500\u2502\u250C\u2510\u2514\u2518\u251C\u2524\u252C\u2534\u253C\u2550-\u256C\u2580\u2584\u2588\u2591-\u2593\u25A1\u25AA\u25AB\u25AD\u25AE\u25B1\u25B3-\u25B5\u25B8\u25B9\u25BD-\u25BF\u25C2\u25C3\u25CA\u25CB\u25EC\u25EF\u25F8-\u25FC\u2605\u2606\u260E\u2640\u2642\u2660\u2663\u2665\u2666\u266A\u266D-\u266F\u2713\u2717\u2720\u2736\u2758\u2772\u2773\u27C8\u27C9\u27E6-\u27ED\u27F5-\u27FA\u27FC\u27FF\u2902-\u2905\u290C-\u2913\u2916\u2919-\u2920\u2923-\u292A\u2933\u2935-\u2939\u293C\u293D\u2945\u2948-\u294B\u294E-\u2976\u2978\u2979\u297B-\u297F\u2985\u2986\u298B-\u2996\u299A\u299C\u299D\u29A4-\u29B7\u29B9\u29BB\u29BC\u29BE-\u29C5\u29C9\u29CD-\u29D0\u29DC-\u29DE\u29E3-\u29E5\u29EB\u29F4\u29F6\u2A00-\u2A02\u2A04\u2A06\u2A0C\u2A0D\u2A10-\u2A17\u2A22-\u2A27\u2A29\u2A2A\u2A2D-\u2A31\u2A33-\u2A3C\u2A3F\u2A40\u2A42-\u2A4D\u2A50\u2A53-\u2A58\u2A5A-\u2A5D\u2A5F\u2A66\u2A6A\u2A6D-\u2A75\u2A77-\u2A9A\u2A9D-\u2AA2\u2AA4-\u2AB0\u2AB3-\u2AC8\u2ACB\u2ACC\u2ACF-\u2ADB\u2AE4\u2AE6-\u2AE9\u2AEB-\u2AF3\u2AFD\uFB00-\uFB04]|\uD835[\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDD6B]/g,d={"":"Aacute","":"aacute","":"Abreve","":"abreve","":"ac","":"acd","":"acE","":"Acirc","":"acirc","":"acute","":"Acy","":"acy","":"AElig","":"aelig","":"af","":"Afr","":"afr","":"Agrave","":"agrave","":"aleph","":"Alpha","":"alpha","":"Amacr","":"amacr","":"amalg","&":"amp","":"andand","":"And","":"and","":"andd","":"andslope","":"andv","":"ang","":"ange","":"angmsdaa","":"angmsdab","":"angmsdac","":"angmsdad","":"angmsdae","":"angmsdaf","":"angmsdag","":"angmsdah","":"angmsd","":"angrt","":"angrtvb","":"angrtvbd","":"angsph","":"angst","":"angzarr","":"Aogon","":"aogon","":"Aopf","":"aopf","":"apacir","":"ap","":"apE","":"ape","":"apid","'":"apos","":"aring","":"Ascr","":"ascr","":"colone","*":"ast","":"CupCap","":"Atilde","":"atilde","":"Auml","":"auml","":"awconint","":"awint","":"bcong","":"bepsi","":"bprime","":"bsim","":"bsime","":"setmn","":"Barv","":"barvee","":"barwed","":"Barwed","":"bbrk","":"bbrktbrk","":"Bcy","":"bcy","":"bdquo","":"becaus","":"bemptyv","":"Bscr","":"Beta","":"beta","":"beth","":"twixt","":"Bfr","":"bfr","":"xcap","":"xcirc","":"xcup","":"xodot","":"xoplus","":"xotime","":"xsqcup","":"starf","":"xdtri","":"xutri","":"xuplus","":"Vee","":"Wedge","":"rbarr","":"lozf","":"squf","":"utrif","":"dtrif","":"ltrif","":"rtrif","":"blank","":"blk12","":"blk14","":"blk34","":"block","=":"bne","":"bnequiv","":"bNot","":"bnot","":"Bopf","":"bopf","":"bot","":"bowtie","":"boxbox","":"boxdl","":"boxdL","":"boxDl","":"boxDL","":"boxdr","":"boxdR","":"boxDr","":"boxDR","":"boxh","":"boxH","":"boxhd","":"boxHd","":"boxhD","":"boxHD","":"boxhu","":"boxHu","":"boxhU","":"boxHU","":"minusb","":"plusb","":"timesb","":"boxul","":"boxuL","":"boxUl","":"boxUL","":"boxur","":"boxuR","":"boxUr","":"boxUR","":"boxv","":"boxV","":"boxvh","":"boxvH","":"boxVh","":"boxVH","":"boxvl","":"boxvL","":"boxVl","":"boxVL","":"boxvr","":"boxvR","":"boxVr","":"boxVR","":"breve","":"brvbar","":"bscr","":"bsemi","":"bsolb","\\":"bsol","":"bsolhsub","":"bull","":"bump","":"bumpE","":"bumpe","":"Cacute","":"cacute","":"capand","":"capbrcup","":"capcap","":"cap","":"Cap","":"capcup","":"capdot","":"DD","":"caps","":"caret","":"caron","":"Cfr","":"ccaps","":"Ccaron","":"ccaron","":"Ccedil","":"ccedil","":"Ccirc","":"ccirc","":"Cconint","":"ccups","":"ccupssm","":"Cdot","":"cdot","":"cedil","":"cemptyv","":"cent","":"middot","":"cfr","":"CHcy","":"chcy","":"check","":"Chi","":"chi","":"circ","":"cire","":"olarr","":"orarr","":"oast","":"ocir","":"odash","":"odot","":"reg","":"oS","":"ominus","":"oplus","":"otimes","":"cir","":"cirE","":"cirfnint","":"cirmid","":"cirscir","":"cwconint","":"rdquo","":"rsquo","":"clubs",":":"colon","":"Colon","":"Colone",",":"comma","@":"commat","":"comp","":"compfn","":"Copf","":"cong","":"congdot","":"equiv","":"oint","":"Conint","":"copf","":"coprod","":"copy","":"copysr","":"crarr","":"cross","":"Cross","":"Cscr","":"cscr","":"csub","":"csube","":"csup","":"csupe","":"ctdot","":"cudarrl","":"cudarrr","":"cuepr","":"cuesc","":"cularr","":"cularrp","":"cupbrcap","":"cupcap","":"cup","":"Cup","":"cupcup","":"cupdot","":"cupor","":"cups","":"curarr","":"curarrm","":"cuvee","":"cuwed","":"curren","":"cwint","":"cylcty","":"dagger","":"Dagger","":"daleth","":"darr","":"Darr","":"dArr","":"dash","":"Dashv","":"dashv","":"rBarr","":"dblac","":"Dcaron","":"dcaron","":"Dcy","":"dcy","":"ddarr","":"dd","":"DDotrahd","":"eDDot","":"deg","":"Del","":"Delta","":"delta","":"demptyv","":"dfisht","":"Dfr","":"dfr","":"dHar","":"dharl","":"dharr","":"dot","`":"grave","":"tilde","":"diam","":"diams","":"die","":"gammad","":"disin","":"div","":"divonx","":"DJcy","":"djcy","":"dlcorn","":"dlcrop",$:"dollar","":"Dopf","":"dopf","":"DotDot","":"doteq","":"eDot","":"minusd","":"plusdo","":"sdotb","":"lArr","":"iff","":"xlArr","":"xhArr","":"xrArr","":"rArr","":"vDash","":"uArr","":"vArr","":"par","":"DownArrowBar","":"duarr","":"DownBreve","":"DownLeftRightVector","":"DownLeftTeeVector","":"DownLeftVectorBar","":"lhard","":"DownRightTeeVector","":"DownRightVectorBar","":"rhard","":"mapstodown","":"top","":"RBarr","":"drcorn","":"drcrop","":"Dscr","":"dscr","":"DScy","":"dscy","":"dsol","":"Dstrok","":"dstrok","":"dtdot","":"dtri","":"duhar","":"dwangle","":"DZcy","":"dzcy","":"dzigrarr","":"Eacute","":"eacute","":"easter","":"Ecaron","":"ecaron","":"Ecirc","":"ecirc","":"ecir","":"ecolon","":"Ecy","":"ecy","":"Edot","":"edot","":"ee","":"efDot","":"Efr","":"efr","":"eg","":"Egrave","":"egrave","":"egs","":"egsdot","":"el","":"in","":"elinters","":"ell","":"els","":"elsdot","":"Emacr","":"emacr","":"empty","":"EmptySmallSquare","":"EmptyVerySmallSquare","":"emsp13","":"emsp14","":"emsp","":"ENG","":"eng","":"ensp","":"Eogon","":"eogon","":"Eopf","":"eopf","":"epar","":"eparsl","":"eplus","":"epsi","":"Epsilon","":"epsiv","":"esim","":"Equal","=":"equals","":"equest","":"rlhar","":"equivDD","":"eqvparsl","":"erarr","":"erDot","":"escr","":"Escr","":"Esim","":"Eta","":"eta","":"ETH","":"eth","":"Euml","":"euml","":"euro","!":"excl","":"exist","":"Fcy","":"fcy","":"female","":"ffilig","":"fflig","":"ffllig","":"Ffr","":"ffr","":"filig","":"FilledSmallSquare",fj:"fjlig","":"flat","":"fllig","":"fltns","":"fnof","":"Fopf","":"fopf","":"forall","":"fork","":"forkv","":"Fscr","":"fpartint","":"half","":"frac13","":"frac14","":"frac15","":"frac16","":"frac18","":"frac23","":"frac25","":"frac34","":"frac35","":"frac38","":"frac45","":"frac56","":"frac58","":"frac78","":"frasl","":"frown","":"fscr","":"gacute","":"Gamma","":"gamma","":"Gammad","":"gap","":"Gbreve","":"gbreve","":"Gcedil","":"Gcirc","":"gcirc","":"Gcy","":"gcy","":"Gdot","":"gdot","":"ge","":"gE","":"gEl","":"gel","":"ges","":"gescc","":"gesdot","":"gesdoto","":"gesdotol","":"gesl","":"gesles","":"Gfr","":"gfr","":"gg","":"Gg","":"gimel","":"GJcy","":"gjcy","":"gla","":"gl","":"glE","":"glj","":"gnap","":"gne","":"gnE","":"gnsim","":"Gopf","":"gopf","":"GreaterGreater","":"gsim","":"Gscr","":"gscr","":"gsime","":"gsiml","":"gtcc","":"gtcir",">":"gt","":"gtdot","":"gtlPar","":"gtquest","":"gtrarr","":"gvnE","":"hairsp","":"Hscr","":"HARDcy","":"hardcy","":"harrcir","":"harr","":"harrw","^":"Hat","":"hbar","":"Hcirc","":"hcirc","":"hearts","":"mldr","":"hercon","":"hfr","":"Hfr","":"searhk","":"swarhk","":"hoarr","":"homtht","":"larrhk","":"rarrhk","":"hopf","":"Hopf","":"horbar","":"hscr","":"Hstrok","":"hstrok","":"hybull","":"Iacute","":"iacute","":"ic","":"Icirc","":"icirc","":"Icy","":"icy","":"Idot","":"IEcy","":"iecy","":"iexcl","":"ifr","":"Im","":"Igrave","":"igrave","":"ii","":"qint","":"tint","":"iinfin","":"iiota","":"IJlig","":"ijlig","":"Imacr","":"imacr","":"Iscr","":"imath","":"imof","":"imped","":"incare","":"infin","":"infintie","":"intcal","":"int","":"Int","":"Zopf","":"intlarhk","":"iprod","":"it","":"IOcy","":"iocy","":"Iogon","":"iogon","":"Iopf","":"iopf","":"Iota","":"iota","":"iquest","":"iscr","":"isindot","":"isinE","":"isins","":"isinsv","":"Itilde","":"itilde","":"Iukcy","":"iukcy","":"Iuml","":"iuml","":"Jcirc","":"jcirc","":"Jcy","":"jcy","":"Jfr","":"jfr","":"jmath","":"Jopf","":"jopf","":"Jscr","":"jscr","":"Jsercy","":"jsercy","":"Jukcy","":"jukcy","":"Kappa","":"kappa","":"kappav","":"Kcedil","":"kcedil","":"Kcy","":"kcy","":"Kfr","":"kfr","":"kgreen","":"KHcy","":"khcy","":"KJcy","":"kjcy","":"Kopf","":"kopf","":"Kscr","":"kscr","":"lAarr","":"Lacute","":"lacute","":"laemptyv","":"Lscr","":"Lambda","":"lambda","":"lang","":"Lang","":"langd","":"lap","":"laquo","":"larrb","":"larrbfs","":"larr","":"Larr","":"larrfs","":"larrlp","":"larrpl","":"larrsim","":"larrtl","":"latail","":"lAtail","":"lat","":"late","":"lates","":"lbarr","":"lBarr","":"lbbrk","{":"lcub","[":"lsqb","":"lbrke","":"lbrksld","":"lbrkslu","":"Lcaron","":"lcaron","":"Lcedil","":"lcedil","":"lceil","":"Lcy","":"lcy","":"ldca","":"ldquo","":"ldrdhar","":"ldrushar","":"ldsh","":"le","":"lE","":"lrarr","":"lobrk","":"LeftDownTeeVector","":"LeftDownVectorBar","":"lfloor","":"lharu","":"llarr","":"lrhar","":"LeftRightVector","":"mapstoleft","":"LeftTeeVector","":"lthree","":"LeftTriangleBar","":"vltri","":"ltrie","":"LeftUpDownVector","":"LeftUpTeeVector","":"LeftUpVectorBar","":"uharl","":"LeftVectorBar","":"lEg","":"leg","":"les","":"lescc","":"lesdot","":"lesdoto","":"lesdotor","":"lesg","":"lesges","":"ltdot","":"lg","":"LessLess","":"lsim","":"lfisht","":"Lfr","":"lfr","":"lgE","":"lHar","":"lharul","":"lhblk","":"LJcy","":"ljcy","":"ll","":"Ll","":"llhard","":"lltri","":"Lmidot","":"lmidot","":"lmoust","":"lnap","":"lne","":"lnE","":"lnsim","":"loang","":"loarr","":"xlarr","":"xharr","":"xmap","":"xrarr","":"rarrlp","":"lopar","":"Lopf","":"lopf","":"loplus","":"lotimes","":"lowast",_:"lowbar","":"swarr","":"searr","":"loz","(":"lpar","":"lparlt","":"lrhard","":"lrm","":"lrtri","":"lsaquo","":"lscr","":"lsh","":"lsime","":"lsimg","":"lsquo","":"sbquo","":"Lstrok","":"lstrok","":"ltcc","":"ltcir","<":"lt","":"ltimes","":"ltlarr","":"ltquest","":"ltri","":"ltrPar","":"lurdshar","":"luruhar","":"lvnE","":"macr","":"male","":"malt","":"Map","":"map","":"mapstoup","":"marker","":"mcomma","":"Mcy","":"mcy","":"mdash","":"mDDot","":"MediumSpace","":"Mscr","":"Mfr","":"mfr","":"mho","":"micro","":"midcir","":"mid","":"minus","":"minusdu","":"mp","":"mlcp","":"models","":"Mopf","":"mopf","":"mscr","":"Mu","":"mu","":"mumap","":"Nacute","":"nacute","":"nang","":"nap","":"napE","":"napid","":"napos","":"natur","":"Nopf","":"nbsp","":"nbump","":"nbumpe","":"ncap","":"Ncaron","":"ncaron","":"Ncedil","":"ncedil","":"ncong","":"ncongdot","":"ncup","":"Ncy","":"ncy","":"ndash","":"nearhk","":"nearr","":"neArr","":"ne","":"nedot","":"ZeroWidthSpace","":"nequiv","":"toea","":"nesim","\n":"NewLine","":"nexist","":"Nfr","":"nfr","":"ngE","":"nge","":"nges","":"nGg","":"ngsim","":"nGt","":"ngt","":"nGtv","":"nharr","":"nhArr","":"nhpar","":"ni","":"nis","":"nisd","":"NJcy","":"njcy","":"nlarr","":"nlArr","":"nldr","":"nlE","":"nle","":"nles","":"nlt","":"nLl","":"nlsim","":"nLt","":"nltri","":"nltrie","":"nLtv","":"nmid","":"NoBreak","":"nopf","":"Not","":"not","":"NotCupCap","":"npar","":"notin","":"ntgl","":"notindot","":"notinE","":"notinvb","":"notinvc","":"NotLeftTriangleBar","":"ntlg","":"NotNestedGreaterGreater","":"NotNestedLessLess","":"notni","":"notnivb","":"notnivc","":"npr","":"npre","":"nprcue","":"NotRightTriangleBar","":"nrtri","":"nrtrie","":"NotSquareSubset","":"nsqsube","":"NotSquareSuperset","":"nsqsupe","":"vnsub","":"nsube","":"nsc","":"nsce","":"nsccue","":"NotSucceedsTilde","":"vnsup","":"nsupe","":"nsim","":"nsime","":"nparsl","":"npart","":"npolint","":"nrarrc","":"nrarr","":"nrArr","":"nrarrw","":"Nscr","":"nscr","":"nsub","":"nsubE","":"nsup","":"nsupE","":"Ntilde","":"ntilde","":"Nu","":"nu","#":"num","":"numero","":"numsp","":"nvap","":"nvdash","":"nvDash","":"nVdash","":"nVDash","":"nvge",">":"nvgt","":"nvHarr","":"nvinfin","":"nvlArr","":"nvle","<":"nvlt","":"nvltrie","":"nvrArr","":"nvrtrie","":"nvsim","":"nwarhk","":"nwarr","":"nwArr","":"nwnear","":"Oacute","":"oacute","":"Ocirc","":"ocirc","":"Ocy","":"ocy",
"":"Odblac","":"odblac","":"odiv","":"odsold","":"OElig","":"oelig","":"ofcir","":"Ofr","":"ofr","":"ogon","":"Ograve","":"ograve","":"ogt","":"ohbar","":"ohm","":"olcir","":"olcross","":"oline","":"olt","":"Omacr","":"omacr","":"omega","":"Omicron","":"omicron","":"omid","":"Oopf","":"oopf","":"opar","":"operp","":"Or","":"or","":"ord","":"oscr","":"ordf","":"ordm","":"origof","":"oror","":"orslope","":"orv","":"Oscr","":"Oslash","":"oslash","":"osol","":"Otilde","":"otilde","":"otimesas","":"Otimes","":"Ouml","":"ouml","":"ovbar","":"OverBrace","":"tbrk","":"OverParenthesis","":"para","":"parsim","":"parsl","":"part","":"Pcy","":"pcy","%":"percnt",".":"period","":"permil","":"pertenk","":"Pfr","":"pfr","":"Phi","":"phi","":"phiv","":"phone","":"Pi","":"pi","":"piv","":"planckh","":"plusacir","":"pluscir","+":"plus","":"plusdu","":"pluse","":"pm","":"plussim","":"plustwo","":"pointint","":"popf","":"Popf","":"pound","":"prap","":"Pr","":"pr","":"prcue","":"pre","":"prsim","":"prnap","":"prnE","":"prnsim","":"prE","":"prime","":"Prime","":"prod","":"profalar","":"profline","":"profsurf","":"prop","":"prurel","":"Pscr","":"pscr","":"Psi","":"psi","":"puncsp","":"Qfr","":"qfr","":"qopf","":"Qopf","":"qprime","":"Qscr","":"qscr","":"quatint","?":"quest",'"':"quot","":"rAarr","":"race","":"Racute","":"racute","":"Sqrt","":"raemptyv","":"rang","":"Rang","":"rangd","":"range","":"raquo","":"rarrap","":"rarrb","":"rarrbfs","":"rarrc","":"rarr","":"Rarr","":"rarrfs","":"rarrpl","":"rarrsim","":"Rarrtl","":"rarrtl","":"rarrw","":"ratail","":"rAtail","":"ratio","":"rbbrk","}":"rcub","]":"rsqb","":"rbrke","":"rbrksld","":"rbrkslu","":"Rcaron","":"rcaron","":"Rcedil","":"rcedil","":"rceil","":"Rcy","":"rcy","":"rdca","":"rdldhar","":"rdsh","":"Re","":"Rscr","":"Ropf","":"rect","":"rfisht","":"rfloor","":"rfr","":"rHar","":"rharu","":"rharul","":"Rho","":"rho","":"rhov","":"rlarr","":"robrk","":"RightDownTeeVector","":"RightDownVectorBar","":"rrarr","":"vdash","":"RightTeeVector","":"rthree","":"RightTriangleBar","":"vrtri","":"rtrie","":"RightUpDownVector","":"RightUpTeeVector","":"RightUpVectorBar","":"uharr","":"RightVectorBar","":"ring","":"rlm","":"rmoust","":"rnmid","":"roang","":"roarr","":"ropar","":"ropf","":"roplus","":"rotimes","":"RoundImplies",")":"rpar","":"rpargt","":"rppolint","":"rsaquo","":"rscr","":"rsh","":"rtimes","":"rtri","":"rtriltri","":"RuleDelayed","":"ruluhar","":"rx","":"Sacute","":"sacute","":"scap","":"Scaron","":"scaron","":"Sc","":"sc","":"sccue","":"sce","":"scE","":"Scedil","":"scedil","":"Scirc","":"scirc","":"scnap","":"scnE","":"scnsim","":"scpolint","":"scsim","":"Scy","":"scy","":"sdot","":"sdote","":"seArr","":"sect",";":"semi","":"tosa","":"sext","":"Sfr","":"sfr","":"sharp","":"SHCHcy","":"shchcy","":"SHcy","":"shcy","":"uarr","":"shy","":"Sigma","":"sigma","":"sigmaf","":"sim","":"simdot","":"sime","":"simg","":"simgE","":"siml","":"simlE","":"simne","":"simplus","":"simrarr","":"smashp","":"smeparsl","":"smile","":"smt","":"smte","":"smtes","":"SOFTcy","":"softcy","":"solbar","":"solb","/":"sol","":"Sopf","":"sopf","":"spades","":"sqcap","":"sqcaps","":"sqcup","":"sqcups","":"sqsub","":"sqsube","":"sqsup","":"sqsupe","":"squ","":"Sscr","":"sscr","":"Star","":"star","":"sub","":"Sub","":"subdot","":"subE","":"sube","":"subedot","":"submult","":"subnE","":"subne","":"subplus","":"subrarr","":"subsim","":"subsub","":"subsup","":"sum","":"sung","":"sup1","":"sup2","":"sup3","":"sup","":"Sup","":"supdot","":"supdsub","":"supE","":"supe","":"supedot","":"suphsol","":"suphsub","":"suplarr","":"supmult","":"supnE","":"supne","":"supplus","":"supsim","":"supsub","":"supsup","":"swArr","":"swnwar","":"szlig","	":"Tab","":"target","":"Tau","":"tau","":"Tcaron","":"tcaron","":"Tcedil","":"tcedil","":"Tcy","":"tcy","":"tdot","":"telrec","":"Tfr","":"tfr","":"there4","":"Theta","":"theta","":"thetav","":"ThickSpace","":"thinsp","":"THORN","":"thorn","":"timesbar","":"times","":"timesd","":"topbot","":"topcir","":"Topf","":"topf","":"topfork","":"tprime","":"trade","":"utri","":"trie","":"tridot","":"triminus","":"triplus","":"trisb","":"tritime","":"trpezium","":"Tscr","":"tscr","":"TScy","":"tscy","":"TSHcy","":"tshcy","":"Tstrok","":"tstrok","":"Uacute","":"uacute","":"Uarr","":"Uarrocir","":"Ubrcy","":"ubrcy","":"Ubreve","":"ubreve","":"Ucirc","":"ucirc","":"Ucy","":"ucy","":"udarr","":"Udblac","":"udblac","":"udhar","":"ufisht","":"Ufr","":"ufr","":"Ugrave","":"ugrave","":"uHar","":"uhblk","":"ulcorn","":"ulcrop","":"ultri","":"Umacr","":"umacr","":"UnderBrace","":"UnderParenthesis","":"uplus","":"Uogon","":"uogon","":"Uopf","":"uopf","":"UpArrowBar","":"varr","":"upsi","":"Upsi","":"Upsilon","":"uuarr","":"urcorn","":"urcrop","":"Uring","":"uring","":"urtri","":"Uscr","":"uscr","":"utdot","":"Utilde","":"utilde","":"Uuml","":"uuml","":"uwangle","":"vangrt","":"vsubne","":"vsubnE","":"vsupne","":"vsupnE","":"vBar","":"Vbar","":"vBarv","":"Vcy","":"vcy","":"Vdash","":"VDash","":"Vdashl","":"veebar","":"veeeq","":"vellip","|":"vert","":"Vert","":"VerticalSeparator","":"wr","":"Vfr","":"vfr","":"Vopf","":"vopf","":"Vscr","":"vscr","":"Vvdash","":"vzigzag","":"Wcirc","":"wcirc","":"wedbar","":"wedgeq","":"wp","":"Wfr","":"wfr","":"Wopf","":"wopf","":"Wscr","":"wscr","":"Xfr","":"xfr","":"Xi","":"xi","":"xnis","":"Xopf","":"xopf","":"Xscr","":"xscr","":"Yacute","":"yacute","":"YAcy","":"yacy","":"Ycirc","":"ycirc","":"Ycy","":"ycy","":"yen","":"Yfr","":"yfr","":"YIcy","":"yicy","":"Yopf","":"yopf","":"Yscr","":"yscr","":"YUcy","":"yucy","":"yuml","":"Yuml","":"Zacute","":"zacute","":"Zcaron","":"zcaron","":"Zcy","":"zcy","":"Zdot","":"zdot","":"Zfr","":"Zeta","":"zeta","":"zfr","":"ZHcy","":"zhcy","":"zigrarr","":"zopf","":"Zscr","":"zscr","":"zwj","":"zwnj"},p=/["&'<>`]/g,g={'"':"&quot;","&":"&amp;","'":"&#x27;","<":"&lt;",">":"&gt;","`":"&#x60;"},m=/&#(?:[xX][^a-fA-F0-9]|[^0-9xX])/,f=/[\0-\x08\x0B\x0E-\x1F\x7F-\x9F\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,v=/&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+);|&(Aacute|iacute|Uacute|plusmn|otilde|Otilde|Agrave|agrave|yacute|Yacute|oslash|Oslash|Atilde|atilde|brvbar|Ccedil|ccedil|ograve|curren|divide|Eacute|eacute|Ograve|oacute|Egrave|egrave|ugrave|frac12|frac14|frac34|Ugrave|Oacute|Iacute|ntilde|Ntilde|uacute|middot|Igrave|igrave|iquest|aacute|laquo|THORN|micro|iexcl|icirc|Icirc|Acirc|ucirc|ecirc|Ocirc|ocirc|Ecirc|Ucirc|aring|Aring|aelig|AElig|acute|pound|raquo|acirc|times|thorn|szlig|cedil|COPY|Auml|ordf|ordm|uuml|macr|Uuml|auml|Ouml|ouml|para|nbsp|Euml|quot|QUOT|euml|yuml|cent|sect|copy|sup1|sup2|sup3|Iuml|iuml|shy|eth|reg|not|yen|amp|AMP|REG|uml|ETH|deg|gt|GT|LT|lt)([=a-zA-Z0-9])?/g,_={Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",amp:"&",AMP:"&",andand:"",And:"",and:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angmsd:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",apacir:"",ap:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",barwed:"",Barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",because:"",Because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxdl:"",boxdL:"",boxDl:"",boxDL:"",boxdr:"",boxdR:"",boxDr:"",boxDR:"",boxh:"",boxH:"",boxhd:"",boxHd:"",boxhD:"",boxHD:"",boxhu:"",boxHu:"",boxhU:"",boxHU:"",boxminus:"",boxplus:"",boxtimes:"",boxul:"",boxuL:"",boxUl:"",boxUL:"",boxur:"",boxuR:"",boxUr:"",boxUR:"",boxv:"",boxV:"",boxvh:"",boxvH:"",boxVh:"",boxVH:"",boxvl:"",boxvL:"",boxVl:"",boxVL:"",boxvr:"",boxvR:"",boxVr:"",boxVR:"",bprime:"",breve:"",Breve:"",brvbar:"",bscr:"",Bscr:"",bsemi:"",bsim:"",bsime:"",bsolb:"",bsol:"\\",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",capand:"",capbrcup:"",capcap:"",cap:"",Cap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",centerdot:"",CenterDot:"",cfr:"",Cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cir:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",colon:":",Colon:"",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",conint:"",Conint:"",ContourIntegral:"",copf:"",Copf:"",coprod:"",Coproduct:"",copy:"",COPY:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",cross:"",Cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",cupbrcap:"",cupcap:"",CupCap:"",cup:"",Cup:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",dagger:"",Dagger:"",daleth:"",darr:"",Darr:"",dArr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",ddagger:"",ddarr:"",DD:"",dd:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",diamond:"",Diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrowBar:"",downarrow:"",DownArrow:"",Downarrow:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVectorBar:"",DownLeftVector:"",DownRightTeeVector:"",DownRightVectorBar:"",DownRightVector:"",DownTeeArrow:"",DownTee:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",Ecirc:"",ecirc:"",ecir:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",edot:"",eDot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp13:"",emsp14:"",emsp:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",escr:"",Escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",exponentiale:"",ExponentialE:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",forall:"",ForAll:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",fscr:"",Fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",ge:"",gE:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",gescc:"",ges:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",gg:"",Gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gla:"",gl:"",glE:"",glj:"",gnap:"",gnapprox:"",gne:"",gnE:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",gtcc:"",gtcir:"",gt:">",GT:">",Gt:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",harrcir:"",harr:"",hArr:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",hfr:"",Hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",hopf:"",Hopf:"",horbar:"",HorizontalLine:"",hscr:"",Hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",ifr:"",Ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",Im:"",imof:"",imped:"",Implies:"",incare:"","in":"",infin:"",infintie:"",inodot:"",intcal:"","int":"",Int:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",iscr:"",Iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",lang:"",Lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",larrb:"",larrbfs:"",larr:"",Larr:"",lArr:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",latail:"",lAtail:"",lat:"",late:"",lates:"",lbarr:"",lBarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",le:"",lE:"",LeftAngleBracket:"",LeftArrowBar:"",leftarrow:"",LeftArrow:"",Leftarrow:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVectorBar:"",LeftDownVector:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",leftrightarrow:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTeeArrow:"",LeftTee:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangleBar:"",LeftTriangle:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVectorBar:"",LeftUpVector:"",LeftVectorBar:"",LeftVector:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",lescc:"",les:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",llarr:"",ll:"",Ll:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoustache:"",lmoust:"",lnap:"",lnapprox:"",lne:"",lnE:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",longleftarrow:"",LongLeftArrow:"",Longleftarrow:"",longleftrightarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longmapsto:"",longrightarrow:"",LongRightArrow:"",Longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",lscr:"",Lscr:"",lsh:"",Lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",ltcc:"",ltcir:"",lt:"<",LT:"<",Lt:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",midast:"*",midcir:"",mid:"",middot:"",minusb:"",minus:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",mscr:"",Mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natural:"",naturals:"",natur:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",nearhk:"",nearr:"",neArr:"",nearrow:"",ne:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:"\n",nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nharr:"",nhArr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlarr:"",nlArr:"",nldr:"",nlE:"",nle:"",nleftarrow:"",nLeftarrow:"",nleftrightarrow:"",nLeftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",nopf:"",Nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangleBar:"",NotLeftTriangle:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangleBar:"",NotRightTriangle:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",nparallel:"",npar:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",nprec:"",npreceq:"",npre:"",nrarrc:"",nrarr:"",nrArr:"",nrarrw:"",nrightarrow:"",nRightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nvdash:"",nvDash:"",nVdash:"",nVDash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwarr:"",nwArr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",Ocirc:"",ocirc:"",ocir:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",orarr:"",Or:"",or:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",otimesas:"",Otimes:"",otimes:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",para:"",parallel:"",par:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plusacir:"",plusb:"",pluscir:"",plus:"+",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",popf:"",Popf:"",pound:"",prap:"",Pr:"",pr:"",prcue:"",precapprox:"",prec:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",pre:"",prE:"",precsim:"",prime:"",Prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportional:"",Proportion:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",qopf:"",Qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",quot:'"',QUOT:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",rang:"",Rang:"",rangd:"",range:"",rangle:"",raquo:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarr:"",Rarr:"",rArr:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",ratail:"",rAtail:"",ratio:"",rationals:"",rbarr:"",rBarr:"",RBarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",real:"",realine:"",realpart:"",reals:"",Re:"",rect:"",reg:"",REG:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",rfr:"",Rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrowBar:"",rightarrow:"",RightArrow:"",Rightarrow:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVectorBar:"",RightDownVector:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTeeArrow:"",RightTee:"",RightTeeVector:"",rightthreetimes:"",RightTriangleBar:"",RightTriangle:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVectorBar:"",RightUpVector:"",RightVectorBar:"",RightVector:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoustache:"",rmoust:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",ropf:"",Ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",rscr:"",Rscr:"",rsh:"",Rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",scap:"",Scaron:"",scaron:"",Sc:"",sc:"",sccue:"",sce:"",scE:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdotb:"",sdot:"",sdote:"",searhk:"",searr:"",seArr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",solbar:"",solb:"",sol:"/",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",square:"",Square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squ:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",sub:"",Sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",subset:"",Subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succapprox:"",succ:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",sum:"",Sum:"",sung:"",sup1:"",sup2:"",sup3:"",sup:"",Sup:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",supset:"",Supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swarr:"",swArr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",therefore:"",Therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",ThinSpace:"",thinsp:"",thkap:"",thksim:"",THORN:"",thorn:"",tilde:"",Tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",timesbar:"",timesb:"",times:"",timesd:"",tint:"",toea:"",topbot:"",topcir:"",top:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",trade:"",TRADE:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",uarr:"",Uarr:"",uArr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrowBar:"",uparrow:"",UpArrow:"",Uparrow:"",UpArrowDownArrow:"",updownarrow:"",UpDownArrow:"",Updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",upsi:"",Upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTeeArrow:"",UpTee:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",varr:"",vArr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",vBar:"",Vbar:"",vBarv:"",Vcy:"",vcy:"",vdash:"",vDash:"",Vdash:"",VDash:"",Vdashl:"",veebar:"",vee:"",Vee:"",veeeq:"",vellip:"",verbar:"|",Verbar:"",vert:"|",Vert:"",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",wedge:"",Wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xharr:"",xhArr:"",Xi:"",xi:"",xlarr:"",xlArr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrarr:"",xrArr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",
yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",yuml:"",Yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",zfr:"",Zfr:"",ZHcy:"",zhcy:"",zigrarr:"",zopf:"",Zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""},b={Aacute:"",aacute:"",Acirc:"",acirc:"",acute:"",AElig:"",aelig:"",Agrave:"",agrave:"",amp:"&",AMP:"&",Aring:"",aring:"",Atilde:"",atilde:"",Auml:"",auml:"",brvbar:"",Ccedil:"",ccedil:"",cedil:"",cent:"",copy:"",COPY:"",curren:"",deg:"",divide:"",Eacute:"",eacute:"",Ecirc:"",ecirc:"",Egrave:"",egrave:"",ETH:"",eth:"",Euml:"",euml:"",frac12:"",frac14:"",frac34:"",gt:">",GT:">",Iacute:"",iacute:"",Icirc:"",icirc:"",iexcl:"",Igrave:"",igrave:"",iquest:"",Iuml:"",iuml:"",laquo:"",lt:"<",LT:"<",macr:"",micro:"",middot:"",nbsp:"",not:"",Ntilde:"",ntilde:"",Oacute:"",oacute:"",Ocirc:"",ocirc:"",Ograve:"",ograve:"",ordf:"",ordm:"",Oslash:"",oslash:"",Otilde:"",otilde:"",Ouml:"",ouml:"",para:"",plusmn:"",pound:"",quot:'"',QUOT:'"',raquo:"",reg:"",REG:"",sect:"",shy:"",sup1:"",sup2:"",sup3:"",szlig:"",THORN:"",thorn:"",times:"",Uacute:"",uacute:"",Ucirc:"",ucirc:"",Ugrave:"",ugrave:"",uml:"",Uuml:"",uuml:"",Yacute:"",yacute:"",yen:"",yuml:""},w={0:"",128:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",142:"",145:"",146:"",147:"",148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",158:"",159:""},y=[1,2,3,4,5,6,7,8,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,64976,64977,64978,64979,64980,64981,64982,64983,64984,64985,64986,64987,64988,64989,64990,64991,64992,64993,64994,64995,64996,64997,64998,64999,65e3,65001,65002,65003,65004,65005,65006,65007,65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111],k=String.fromCharCode,x={},C=x.hasOwnProperty,S=function(e,t){return C.call(e,t)},E=function(e,t){for(var i=-1,n=e.length;++i<n;)if(e[i]==t)return!0;return!1},T=function(e,t){if(!e)return t;var i,n={};for(i in t)n[i]=S(e,i)?e[i]:t[i];return n},A=function(e,t){var i="";return e>=55296&&57343>=e||e>1114111?(t&&R("character reference outside the permissible Unicode range"),""):S(w,e)?(t&&R("disallowed character reference"),w[e]):(t&&E(y,e)&&R("disallowed character reference"),e>65535&&(e-=65536,i+=k(e>>>10&1023|55296),e=56320|1023&e),i+=k(e))},F=function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"},R=function(e){throw Error("Parse error: "+e)},L=function(e,t){t=T(t,L.options);var i=t.strict;i&&f.test(e)&&R("forbidden code point");var n=t.encodeEverything,s=t.useNamedReferences,o=t.allowUnsafeSymbols;return n?(e=e.replace(c,function(e){return s&&S(d,e)?"&"+d[e]+";":F(e)}),s&&(e=e.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;").replace(/&#x66;&#x6A;/g,"&fjlig;")),s&&(e=e.replace(h,function(e){return"&"+d[e]+";"}))):s?(o||(e=e.replace(p,function(e){return"&"+d[e]+";"})),e=e.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;"),e=e.replace(h,function(e){return"&"+d[e]+";"})):o||(e=e.replace(p,F)),e.replace(l,function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1),n=1024*(t-55296)+i-56320+65536;return"&#x"+n.toString(16).toUpperCase()+";"}).replace(u,F)};L.options={allowUnsafeSymbols:!1,encodeEverything:!1,strict:!1,useNamedReferences:!1};var $=function(e,t){t=T(t,$.options);var i=t.strict;return i&&m.test(e)&&R("malformed character reference"),e.replace(v,function(e,n,s,o,r,a,l,c){var u,h,d,p,g;return n?(u=n,h=s,i&&!h&&R("character reference was not terminated by a semicolon"),A(u,i)):o?(d=o,h=r,i&&!h&&R("character reference was not terminated by a semicolon"),u=parseInt(d,16),A(u,i)):a?(p=a,S(_,p)?_[p]:(i&&R("named character reference was not terminated by a semicolon"),e)):(p=l,g=c,g&&t.isAttributeValue?(i&&"="==g&&R("`&` did not start a character reference"),e):(i&&R("named character reference was not terminated by a semicolon"),b[p]+(g||"")))})};$.options={isAttributeValue:!1,strict:!1};var D=function(e){return e.replace(p,function(e){return g[e]})},P={version:"0.5.0",encode:L,decode:$,escape:D,unescape:$};n=function(){return P}.call(t,i,t,e),!(void 0!==n&&(e.exports=n))}(this)}).call(t,i(4)(e),function(){return this}())},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(110),r=i(221).SelectionContext,a=i(7),l=function(){var e=function(){},t={rangeDebounce:10},i=function(e){e=e||r.getSelection();var t=function(e){return/[^\-a-z0-9]/i.test(e)},i={isMention:!1,len:0,string:"",stringBefore:"",stringAfter:"",range:!1,mentionRange:!1,suffixRange:!1,caretRange:!1,offsetStart:!1,offsetEnd:!1,caretPosition:!1,caretNode:!1};if(i.caretRange=e&&e.rangeCount>0?e.getRangeAt(0):!1,i.caretRange===!1||i.caretRange.startOffset!==i.caretRange.endOffset)return!1;var s=i.caretRange.commonAncestorContainer;s.normalize(),i.caretNode=1===s.nodeType?s.firstChild:s;var o=null==i.caretNode?"":i.caretNode.nodeValue;if(i.caretPosition=i.caretRange.startOffset,null==o||0===o.length)return!1;for(var a=0,l=0;l<i.caretPosition;l++)t(o.charAt(l))?a=0:a++;i.stringBefore=o.substr(i.caretPosition-a,a);var c=!1;if(i.caretPosition-(a+2)>=0){c=o.substr(i.caretPosition-a-1,1);var u=o.substr(i.caretPosition-a-2,1);n.contains([32,160],u.charCodeAt(0))||(c=!1)}else i.caretPosition-(a+1)>=0&&(c=o.substr(i.caretPosition-a-1,1));for(i.isMention="@"===c,a=0,l=i.caretPosition;l<o.length&&!t(o.charAt(l));l++)a++;return i.stringAfter=o.substr(i.caretPosition,a),i.string=i.stringBefore+i.stringAfter,i.len=i.string.length,i.isMention||0!==i.len&&""!==i.string?(i.range=document.createRange(),i.offsetStart=i.caretRange.startOffset-i.stringBefore.length,i.offsetEnd=i.caretRange.startOffset+i.stringAfter.length,i.range.setStart(i.caretNode,i.offsetStart),i.range.setEnd(i.caretNode,i.offsetEnd),i.isMention?(i.mentionRange=document.createRange(),i.mentionRange.setStart(i.caretNode,i.offsetStart-1),i.mentionRange.setEnd(i.caretNode,i.offsetEnd),i.suffixRange=document.createRange(),i.suffixRange.setStart(i.caretNode,i.caretRange.startOffset+i.stringAfter.length),i.suffixRange.setEnd(i.caretNode,i.caretRange.startOffset+i.stringAfter.length),i):i):!1},l={enterMention:function(t){this.currentMention=t,this.inMention=!0,this.renderGhost(t),this.dropdown.setPinnedTarget(this.editor.element),this.updatePopoverPosition(t),this.trigger("mention:enter"),e("MentionSupport:enterMention - querying server for [%s]",t.string),this.queryServer(t.string)},updateMention:function(t){if(this.inMention&&t.string!==this.currentMention.string){if(!this.isSameMention(t))return this.exitMention(t),void this.enterMention(t);this.currentMention=t,this.inMention=!0,this.renderGhost(t),this.trigger("mention:update"),e("MentionSupport:updateMention - querying server for [%s]",t.string),this.queryServer(t.string)}},exitMention:function(){this.currentMention=!1,this.inMention=!1,this.lastTypeahead="",this.teardownGhost(),this.editor.onChange(),this.trigger("mention:exit")},softConfirm:function(e){var t=i();t.caretPosition===t.offsetEnd&&this.confirmMention(e)},spaceConfirm:function(e){var t=i(),n=this.dropdown.getCurrentBlogChoice();n&&n.name===t.string&&this.confirmMention(e,n)},confirmMention:function(e,t){t=t||this.dropdown.getCurrentBlogChoice(),t&&this.setMention(t)},setMention:function(e){var t=this.lastInfo,i=e.name,n=document.createTextNode(""),s=document.createElement("a"),o=this.lastSelection;s.setAttribute("class","tumblelog"),s.spellcheck=!1,s.innerHTML="@"+i,t.mentionRange.deleteContents(),t.mentionRange.insertNode(n),t.mentionRange.insertNode(s),t.mentionRange.setStartAfter(n),t.mentionRange.setEndAfter(n),o.removeAllRanges(),o.addRange(t.mentionRange),this.exitMention(t),this.trigger("mention:set",e,t)},linkToMention:function(t){var i,n,o,a=r.getSelection(),l=t.range.commonAncestorContainer.parentElement||s(t.range.commonAncestorContainer).parent().get(0);return this.currentMention!==!1&&this.exitMention(t),l.classList.contains("tumblelog")?(i=document.createRange(),i.selectNode(l),i.deleteContents(),n=document.createTextNode("@"+t.string),i.insertNode(n),o=document.createRange(),a.removeAllRanges(),o.setStart(n,t.caretPosition),o.setEnd(n,t.caretPosition),a.addRange(o),this.cleanupRangeArea(a,o),e("MentionSupport:linkToMention",t.string),void this.onSelection(a)):!1},abortMention:function(){this.escapeMention=i(),this.inMention&&this.exitMention(this.escapeMention)},isSameMention:function(e){return this.currentMention&&this.currentMention.offsetStart===e.offsetStart},isMentionLink:function(e){var t,i=document.createElement("div"),n=this.adjustRange(e);return n?(i.appendChild(n.cloneContents()),t=s(i).find("a:first"),t.length?t.hasClass("tumblelog"):!1):!1},cleanupRangeArea:function(e,t){var i,n,o=document.createElement("span");o.setAttribute("id","mention_cleanup_placeholder"),o.innerHTML="",t.insertNode(o),this.normalize(e,t),i=t.commonAncestorContainer.parentElement,i||(i=s(t.commonAncestorContainer).parent().get(0)),i.normalize(),1===s(i).length&&(n=s(i).html(),n=n.replace(/[\u200B]/g,""),s(i).html(n));var r=s(document).find("#mention_cleanup_placeholder");r.length>0&&(e.removeAllRanges(),t.selectNode(r.get(0)),t.deleteContents(),e.addRange(t),i.normalize())},adjustRange:function(e){var t,i;return n.isUndefined(e)?!1:(e=e.cloneRange(),t=e.commonAncestorContainer,i=3===t.nodeType?t.parentNode:t,i.textContent==="@"+e.toString()&&e.selectNode(i),e)},normalize:function(e,t){this.editor.element.normalize(),null===e||n.isUndefined(t)||(e.removeAllRanges(),e.addRange(t))},renderGhost:function(e){if(this.$ghost=s(document).find("#ui_mention_util_ghost"),!(this.$ghost.length>0)){var t=document.createElement("q");t.setAttribute("id","ui_mention_util_ghost"),t.innerHTML="&#8203;",t.className="mention-ghost",e.suffixRange.surroundContents(t),this.$ghost=s(document).find("#ui_mention_util_ghost"),this.trigger("ghost:render",this.$ghost)}},updatePopoverPosition:function(e){if(n.has(e,"range")){var t=this.getMentionRect(e),i=s(this.editor.element).offset(),o=s(window).scrollTop();this.dropdown.setShift({x:t.left-i.left-10,y:-(t.bottom-i.top+o+10)})}},teardownGhost:function(e){if(e&&e.range||(e=this.lastInfo),this.$ghost=s(document).find("#ui_mention_util_ghost"),0!==this.$ghost.length){var t=this.$ghost.parent().get(0),i=e.caretRange.commonAncestorContainer,n=r.getSelection(0),o=n?n.getRangeAt(0):!1;n&&"ui_mention_util_ghost"===s(i).attr("id")&&(o.selectNode(i),o.deleteContents(),o.collapse(!1)),this.$ghost=s(document).find("#ui_mention_util_ghost"),1===this.$ghost.length&&(this.$ghost.remove(),this.trigger("ghost:teardown")),t&&t.normalize(),n&&o&&(n.removeAllRanges(),n.addRange(o))}},insertGhost:function(e){var t=r.getSelection(0),i=t.getRangeAt(0);this.$ghost=s(document).find("#ui_mention_util_ghost"),0!==this.$ghost.length&&(this.$ghost.html(e),null===t||n.isUndefined(i)||(t.removeAllRanges(),t.addRange(i)))},maintainTypeaheadGhost:function(t,n){var s=this.dropdown.getBlogChoice(0),o=s?s.name:this.lastTypeahead;if(e("MentionSupport:maintainGhost - topSuggestion = %s, typeahead = %s, lastChar = %s",s,o,n),n&&this.lastTypeahead.length&&n===this.$ghost.text().substr(0,1))this.$ghost.text(this.$ghost.text().substr(1));else if(t&&8===t.keyCode){var r=o.substr(this.lastTypeahead.length-this.$ghost.text().length-1);e("MentionSupport:maintainGhost BACKSPACE"),this.$ghost.text(r)}else this.updateTypeahead(o);this.updatePopoverPosition(i())},stripGhost:function(e){if(!e)return e;var t=s("<span>"+e+"</span>");return t.find("#ui_mention_util_ghost").remove(),t.html()},updateTypeahead:function(t){var i=this.currentMention;if(e("MentionSupport:updateTypeahead - typeahead = [%s]",t),this.lastTypeahead=t,!i||!this.inMention||!t)return void this.teardownGhost();var n="";i=i.string;var s=i.toUpperCase(),o=t.toUpperCase();t.length>i.length&&s===o.substr(0,s.length)&&(n=t.substr(i.length,t.length-i.length)),this.insertGhost(n)},updateForInteractive:function(e){var t=this.dropdown.getCurrentBlogChoice();e&&t&&this.updateTypeahead(t.name)},bindEditorCallbacks:function(){this.editor.config.onSelection=n.bind(this.onSelection,this);var e=this.editor.config.onClientEvent||n.noop;this.editor.config.onClientEvent=n.bind(function(t){e(t),this.onClientEvent(t)},this)},setupListeners:function(){this.dropdown.listenTo(this,"editor:cycleUp",this.dropdown.cycleUp),this.dropdown.listenTo(this,"editor:cycleDown",this.dropdown.cycleDown),this.listenTo(this,"editor:abortMention",this.abortMention),this.listenTo(this,"editor:softConfirm",this.softConfirm),this.listenTo(this,"editor:spaceConfirm",this.spaceConfirm),this.listenTo(this,"editor:confirm",this.confirmMention),this.listenTo(this.dropdown,"dropdown:confirm",this.confirmMention),this.dropdown.listenTo(this,"ghost:render",this.dropdown.setPinnedTarget),this.dropdown.listenTo(this,"mention:exit",this.dropdown.teardown),this.listenTo(this.dropdown,"dropdown:render",this.maintainTypeaheadGhost),this.listenTo(this.dropdown,"dropdown:empty",this.exitMention),this.listenTo(this.dropdown,"dropdown:menuInteraction",this.updateForInteractive)},queryServer:function(e){var t={query:e,success:n.bind(this.dropdown.updateMentionDropdown,this.dropdown)};this.mentionModel.fetch(t)},getMentionRect:function(e){if(!(e&&e.range&&"getClientRects"in e.range))return!1;var t=e.range.getClientRects();return n.isUndefined(t[0])?!1:t[0]}},c=function(t,i){n.extend(this,a.Events,l),this.editor=t,this.dropdown=i,this.mentionModel=i.model,this.inMention=!1,this.currentMention=!1,this.escapeMention=!1,this.lastInfo=!1,this.lastSelection=!1,this.$ghost=!1,this.lastTypeahead="",this.debugMode=!1,this.bindEditorCallbacks(),this.setupListeners(),e=n.bind(e,this)},u={keydown:{27:"editor:abortMention",38:"editor:cycleUp",40:"editor:cycleDown",39:"editor:softConfirm",32:"editor:spaceConfirm",9:"editor:confirm",13:"editor:confirm"}};return c.prototype.onClientEvent=function(e){o.trigger("richTextEditor:onClientEvent",e,this.editor);var t,n=["keyup","keydown","keypress"];if(this.inMention&&-1!==n.indexOf(e.type)){if(e=e||window.event,t=e.which||e.keyCode,"keydown"===e.type)t in u[e.type]?(this.trigger(u[e.type][t],e),39!==t&&32!==t&&(e.preventDefault(),e.stopImmediatePropagation())):8===t&&this.maintainTypeaheadGhost(e);else if("keyup"===e.type){if(t in u.keydown)return!1}else this.maintainTypeaheadGhost(e,String.fromCharCode(t));var s=i();s&&(this.lastInfo=s)}},c.prototype.onSelection=n.debounce(function(e){var t=i(e);t?(this.escapeMention&&(this.escapeMention.string===t.string?t.isMention=!1:this.escapeMention=!1),this.lastInfo=t,this.lastSelection=e):this.escapeMention=!1;var n=t&&this.isMentionLink(t.range);t&&t.isMention===!0&&!n?this.inMention&&this.isSameMention(t)?this.updateMention(t):this.enterMention(t):this.inMention?this.exitMention(t):t&&n&&this.linkToMention(t)},t.rangeDebounce),c}();e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(7),r=i(361),a=i(282),l=(i(103),i(101)),c=i(198),u="tmblr-embed",h="tmblr-embed-placeholder",d="embed_iframe",p=i(283),g=i(363),m=function(){var e={template:g,trayOpened:function(e){this.checkLimit(),this.inlineEmbedField.hide()},trayClosed:function(e){this.inlineEmbedField.hide()},disable:function(){var e=this.$inlineEmbedButton.attr("data-disabled-title");this.isDisabled=!0,this.$inlineEmbedButton.addClass("disabled").attr("title",e).attr("tabindex","-1")},enable:function(){var e=this.$inlineEmbedButton.attr("data-enabled-title");this.isDisabled=!1,this.$inlineEmbedButton.removeClass("disabled").attr("title",e).attr("tabindex","0")},checkLimit:function(){this.isAtLimit()?this.disable():this.enable()},isAtLimit:function(){var e=s(this.editor.element).find("figure."+u+", figure."+h);return e.length>=this.inlineEmbedsPerPost},calculateWidth:function(){var e=s(this.editor.element),t=e.width(),i=e.offset(),n=this.editor.inlineControls.tray,o=n.offset();return t-(o.left-i.left)},returnFocus:function(){if(this.editorView.inlineControlNode){var e=document.createRange(),t=window.getSelection();e.setStart(this.editorView.inlineControlNode,0),e.collapse(!0),t.removeAllRanges(),t.addRange(e)}this.getButton().focus()},insertEmbed:function(e){if(this.editor.inlineControls.isTrayOpen||this.editorView.get("hasGifSearchVariation")){var t={"class":h,"data-provider":encodeURIComponent(e.service),"data-orig-width":encodeURIComponent(e.widthOrig),"data-orig-height":encodeURIComponent(e.heightOrig),"data-embed-code":encodeURIComponent(e.embedCode)};n.isEmpty(e.url)||(t["data-url"]=encodeURIComponent(e.url));var i=this._buildEmbedThumbnailPreview(t,e.thumbnail,e.previewIframe),s=i.get(0);this.editor.insertMedia(s,!1,this.editorView.inlineControlNode,0),this.editor.inlineControls.close(),this.checkLimit()}},submitEmbedCode:function(){var e=n.trim(this.inlineEmbedField.getCurrentValue()||"");if(""===e)return void this.inlineEmbedField._set_field_state_default();var t=this.embedCodeParser(e,this.inlineMediaWidthFull);return t?void t.then(n.bind(function(t){return this.inlineEmbedField.set("embedCode",e),t&&t.embed_render_context&&"inline"===t.embed_render_context?(this.inlineEmbedField._set_field_state_default(),t=c(t),void this.insertEmbed(t)):void this.inlineEmbedField._set_field_state_invalid()},this),function(t){this.inlineEmbedField.set("embedCode",e),this.inlineEmbedField._set_field_state_invalid()}):(this.inlineEmbedField._set_field_state_invalid(),void this.inlineEmbedField.set("embedCode",e))},embedCodeParser:function(e,t){if(this._embedCodeParsing&&this._embedCodeParsing.abortEmbedCodeParse(),n.isEmpty(n.trim(e)))return null;var i=this._parseEmbedCode=a.parseEmbedData(e,t).then(n.bind(function(e){return e},this),function(e){return!1});return i.abortEmbedCodeParse=function(){},i},removeEmbedPlaceholders:function(e){var t=p.nodeFromString(e),i=function(e){return n.isEmpty(e)?!1:decodeURIComponent(e)};return s(t).find("figure."+h).each(n.bind(function(e,t){var n=s(t),o=i(n.attr("data-embed-code")),r=n.attr("data-url"),a={"class":u,"data-provider":n.attr("data-provider"),"data-orig-width":n.attr("data-orig-width"),"data-orig-height":n.attr("data-orig-height")};if(r&&(a["data-url"]=r),i(a["data-provider"])&&i(a["data-orig-width"])&&i(a["data-orig-height"])&&o){var l=this._buildEmbedFigure(a,o);n.replaceWith(l)}else n.remove()},this)),t.innerHTML},addEmbedPlaceholders:function(e){var t=this.editorView.hosts.safe_host+"/svc/embed/inline/",i=p.nodeFromString(e),o=function(e){return n.isEmpty(e)?!1:decodeURIComponent(e)};return s(i).find("figure."+u).each(n.bind(function(e,i){var r=s(i),a=r.parents(),l=a&&s(a).filter("blockquote").length>0;if(e<this.inlineEmbedsPerPost){var u={code:r.html(),provider:o(r.attr("data-provider")),url:o(r.attr("data-url")),width:o(r.attr("data-orig-width")),height:o(r.attr("data-orig-height"))},g=l?this.inlineMediaWidthReblog:this.inlineMediaWidthFull,m=Math.ceil(u.height*g/u.width),f=t+encodeURIComponent(u.url?u.url:u.code);f+="?w="+g+"&h="+m;var v={"class":d,src:f,scrolling:"no",frameBorder:"0",allowfullscreen:!0,mozallowfullscreen:!0,webkitallowfullscreen:!0},_=s("<iframe/>",v);_.attr("width",g),_.attr("height",m);var b=p.outerHTML(_.get(0)),w={"class":h,"data-provider":r.attr("data-provider"),"data-orig-width":r.attr("data-orig-width"),"data-orig-height":r.attr("data-orig-height"),"data-embed-code":encodeURIComponent(u.code),"data-url":r.attr("data-url")||f},y=this._buildEmbedFigure(w,b);y.find("iframe").attr("src",""),r.replaceWith(y),this.embedCodeParser(decodeURIComponent(w["data-url"]),this.inlineMediaWidthFull).then(n.bind(function(e){if("inline"===n.get(e,"embed_render_context")){e=c(e);var t=this._buildEmbedThumbnailPreview(w,e.thumbnail,b);s(this.editor.element).find('figure[data-url="'+w["data-url"]+'"]').replaceWith(t)}},this),function(e){})}else r.remove()},this)),this.checkLimit(),i.innerHTML},_buildEmbedThumbnailPreview:function(e,t,i){var n=s(i);n.addClass("hidden").attr("data-src",n.attr("src")).attr("src","");var o=s(this.template({width:n.attr("width")?n.attr("width")+"px":n.css("width"),height:n.attr("height")?n.attr("height")+"px":n.css("height"),imageUrl:t.url,message:l("Load video")}));return this._buildEmbedFigure(e,o).append(n).addClass("embed-thumbnail-preview")},_buildEmbedFigure:function(e,t){var i=s("<figure/>",e);return t&&i.html(t),this.fullWidthInlineMedia&&i.addClass(this.fullWidthClass),i},getButton:function(){return this.$inlineEmbedButton},prompt:function(){this.checkLimit(),this.isDisabled||(this.inlineEmbedField.show(),this.trigger("prompt"))}},t=function(t){var i;t=t||{},n.extend(this,o.Events,e),this.editorView=t.editorView,this.editor=t.editor,this.inlineEmbedsPerPost=t.inlineEmbedsPerPost,this.inlineMediaWidthReblog=t.inlineMediaWidthReblog,this.inlineMediaWidthFull=t.inlineMediaWidthFull,this.fullWidthInlineMedia=t.fullWidthInlineMedia,this.fullWidthClass=t.fullWidthClass,this.editorView&&this.editor&&(this.$inlineEmbedButton=s("<div />",{"class":"control add-inline-embed","data-control-name":"inline-embed",tabindex:"0",title:t.title,"data-enabled-title":t.title,"data-disabled-title":t.disabledTitle}),this.inlineEmbedField=this.editorView.subViews.inlineEmbedField=new r({placeholder:l("Paste a URL or embed code"),submitEmbedCode:n.bind(this.submitEmbedCode,this),calculateWidth:n.bind(this.calculateWidth,this),returnFocus:n.bind(this.returnFocus,this)}),this.inlineEmbedsPerPost>0&&(i=s("<div/>",{"data-subview":"inlineEmbedField"}),this.editor.inlineControls.addToTray(this.$inlineEmbedButton,t.trayOptions),this.editor.inlineControls.addToTray(i.get(0))),this.$inlineEmbedButton.on("click",this.prompt.bind(this)),s(this.editor.element).on("click",".embed-thumbnail-preview",n.bind(function(e){var t=s(e.currentTarget),i=t.find("iframe"),n=t.find(".thumbnail-preview");n.addClass("loading"),n.find(".Knight-Rider-loader").addClass("animate"),t.addClass("loading"),i.on("load",function(){n.removeClass("loading"),n.addClass("hidden"),t.removeClass("loading")}),i.removeClass("hidden"),i.attr("src",i.attr("data-src"))},this)),this.isDisabled=this.isAtLimit())};return t}();e.exports=m},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(160),a=i(204),l=i(205),c=i(220),u=i(362),h=o.extend({className:"post-form--inline-embed-field",template:u,mixins:[r,a,l],initialize:function(e){this.options=n.extend({},this.defaults,e)},show:function(){this.inlineEmbedInput.setEditorValue(""),n.defer(n.bind(function(){this.inlineEmbedInput.focus()},this));var e=this.options.calculateWidth();e="100%",this.$el.add(this.inlineEmbedInput.element).width(e),this.$el.addClass("open"),this.$el.closest(".tray").addClass("inline-embed-open")},hide:function(){this.$el.removeClass("open"),this.$el.closest(".tray").removeClass("inline-embed-open")},getCurrentValue:function(){return this.inlineEmbedInput?this.inlineEmbedInput.getEditorValue():""},createSubViews:function(){var e=n.extend({placeholder:this.options.placeholder,ariaLabel:this.options.placeholder,name:"inlineEmbedInput",forceSingleLine:!0,syncWithModel:!1,pasteHook:n.bind(this._onInputPaste,this),onChange:n.bind(this._onInputChange,this),onClientEvent:n.bind(this._onInputClientEvent,this)});this.inlineEmbedInput=this.subViews.inlineEmbedInput=new c(e)},_set_field_state_default:function(){s(this.inlineEmbedInput.editor.element).removeClass("invalid")},_set_field_state_invalid:function(){s(this.inlineEmbedInput.editor.element).addClass("invalid")},_onInputChange:function(e){this.getCurrentValue()!==this.get("embedCode")&&this._set_field_state_default()},_onInputPaste:function(){n.defer(n.bind(this.options.submitEmbedCode,this))},_onInputClientEvent:function(e){if("keydown"===e.type)switch(e.which||e.keyCode){case 27:e.preventDefault(),e.stopImmediatePropagation(),this.options.returnFocus(),this.hide();break;case 13:e.preventDefault(),e.stopImmediatePropagation(),this.options.submitEmbedCode()}},beforeRender:function(){this.$el.html(this.template()),this.createSubViews()},render:function(){return this.attachSubViews(),this}});e.exports=h},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="inline-embed-field" data-name="inlineEmbedField"><div data-subview="inlineEmbedInput"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="thumbnail-preview" style="background-image: url('+(null==(__t=imageUrl)?"":_.escape(__t))+"); width: "+(null==(__t=width)?"":_.escape(__t))+"; height: "+(null==(__t=height)?"":_.escape(__t))+'"><i class="icon_play"></i><div class="thumbnail-preview-message">'+(null==(__t=message)?"":_.escape(__t))+'</div><span class="Knight-Rider-loader"><span class="Knight-Rider-bar"></span><span class="Knight-Rider-bar"></span><span class="Knight-Rider-bar"></span></span></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(145),r=i(160),a=i(365),l=i(400),c=i(396),u=o.extend({constructor:function(e){this.initialize.apply(this,arguments)},defaults:{query:"",resultLimit:200,resultImageWidth:250,loggingContext:"inline-gif"},initialize:function(e){this.options=e=n.extend({},e),n.extend(this,n.pick(e,"editorView","editor")),s.browser.mozilla&&parseInt(s.browser.version,10)<=37&&(this.set("resultLimit",20),this.set("resultImageWidth",100)),this.searchImageQueries=new c,this.listenTo(this.searchImageQueries,"search",function(e,t){this.set("query",e),this.trigger("gifSearch:query",e,t),this.set("currentQuery",e)}),this.listenTo(this,"insertImage",function(e){this.trigger("gifSearch:accept",e.query,e.src,e.attribution)}),this._addToolbarButton(),n.isString(this.get("query"))&&this.searchImageQueries.fetchGifs(this.get("query"),this.get("resultLimit"),this.get("loggingContext")),this.editorView.$el.on("click.image-search-support","[data-tumblr-attribution]",n.bind(this._onImageClick,this))},teardown:function(){this.gifSearch&&this.gifSearch.teardown(),this.editorView.$el.off(".image-search-support")},_addToolbarButton:function(){this.$imageSearchButton=s("<div />",{"class":"control add-gif","data-control-name":"gif",tabindex:"0",title:this.options.title,"data-enabled-title":this.options.title}),this.editor.inlineControls.addToTray(this.$imageSearchButton,this.options.trayOptions),this.$imageSearchButton.on("click",n.bind(function(e){this.prompt(this.get("query"))},this))},addTumblrAttribution:function(e,t,i,s){if(i.is("figure")){var o=i.filter("[data-tumblr-attribution]"),r=o.children("img").first();if(!n.isEmpty(o)&&!n.isEmpty(r)){var a=(o.attr("data-tumblr-attribution")||"").split(":");if(3!==a.length)return;a.push(o.attr("data-tumblr-query"),o.attr("data-tumblr-search")),a.unshift(o),this.updateTumblrAttribution.apply(this,a)}}},cleanupMarkup:function(e,t){t.find("figure[data-tumblr-query]").removeAttr("data-tumblr-query"),t.find("figure[data-tumblr-search]").removeAttr("data-tumblr-search"),t.find("figure[data-tumblr-attribution]").children(":not(img)").remove()},insertImage:function(e,t,i,o){!n.isUndefined(o)||(o=!0);var r=n.values(n.pick(e,"rootBlog","rootBlogKey","rootPostUrlHash")),a=this.editor.lastSelection?this.editor.lastSelection.anchorNode:null,l=function(a){var l=s(this.editor.getAsyncImage(a)),c=l.parent("figure");l.attr("src",e.mediaUrl),r.unshift(c),n.isString(t)||(t=c.attr("data-tumblr-query")),n.isString(i)||(i=t),r.push(t,i),this.updateTumblrAttribution.apply(this,r),o&&c.addClass("tmblr-full"),this.editorView.updateModelFromEditor(),this.trigger("insertImage",{query:i,src:e.mediaUrl,attribution:c.attr("data-tumblr-attribution")})};this.get("replaceKey")?(l.call(this,this.get("replaceKey")),this.unset("replaceKey"),this.editorView.focus()):this.editorView.insertImageFromUrl(e.mediaUrl,"",{targetNode:a}).then(n.bind(l,this))},_onImageClick:function(e){var t,i,n,o,r,a,l,c=s(e.target);this.gifSearch&&this.gifSearch.isOrWasRecentlyRendered(250)||c.is(".tmblr-attribution")||c.parents(".tmblr-attribution").length>0||(t=s(e.currentTarget),i=t.find("[data-img-key]"),i.is("[data-img-key]")&&t.is("[data-tumblr-query]")&&(n=i.attr("data-img-key"),o=t.attr("data-tumblr-query"),a=e.pageY-t.offset().top,l=t.height(),r=a>l-200?-97:-l+a,this.prompt(o,{pinnedTarget:t,shift:{x:0,y:r},selectedImageUrl:i.attr("src")}),this.set("replaceKey",n)))},updateTumblrAttribution:function(e,t,i,s,o,r){var a=e.children("img").first();e.attr("data-tumblr-attribution",t+":"+i+":"+s),n.isString(o)?e.attr("data-tumblr-query",o):e.removeAttr("data-tumblr-query"),n.isString(r)?e.attr("data-tumblr-search",r):e.removeAttr("data-tumblr-search"),e.closest(".media-holder").toggleClass("media-holder--gif-search",n.isString(o)),e.children().not(a).remove(),e.append(l({attributionUrl:"http://tmblr.co/"+s,attributionName:t}))},getButton:function(){return this.$imageSearchButton},prompt:function(e,t){t=n.extend({collection:this.searchImageQueries,query:e,resultLimit:this.get("resultLimit"),imageWidth:this.get("resultImageWidth"),loadFullImageBeforeSelect:!0,autoTeardown:!0,teardownOnEscape:!1,pinnedTarget:this.getButton(),loggingContext:this.get("loggingContext")},t);var i=function(){this.unset("replaceKey"),this.stopListening(this.gifSearch),this.gifSearch.teardown(),this.gifSearch=null};this.gifSearch&&i.call(this),this.gifSearch=new a(t),this.gifSearch.render(),this.listenToOnce(this.gifSearch,"selectImage",function(e){this.insertImage(e,this.get("query"),e.popularSearchTag),n.delay(n.bind(i,this),250)}),this.listenToOnce(this.gifSearch,"dismiss",n.bind(i,this)),this.listenToOnce(this.gifSearch,"close",function(){this.gifSearch=null}),this.trigger("prompt")},calculateWidth:function(){var e=s(this.editor.element),t=e.width(),i=e.offset(),n=this.editor.inlineControls.tray,o=n.offset();return t-(o.left-i.left)},returnFocus:function(){if(this.editorView.inlineControlNode){var e=document.createRange(),t=window.getSelection();e.setStart(this.editorView.inlineControlNode,0),e.collapse(!0),t.removeAllRanges(),t.addRange(e)}this.getButton().focus()},isOpen:function(){return!n.isEmpty(this.gifSearch)}});r.applyTo(u.prototype),e.exports=u},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(211),r=i(366),a=s.extend({className:"popover--gif-search",mixins:[o],defaults:{query:null},initialize:function(e){this.gifSearch=new r(n.pick(e,"collection","query","imageWidth","loadFullImageBeforeSelect","selectedImageUrl","resultLimit","loggingContext")),this.listenTo(this,"change:query",function(e,t){this.gifSearch.setQuery(t)}),this.listenTo(this.gifSearch,"all",this.trigger)},render:function(){this.gifSearch.render().$el.appendTo(this.$el)},teardown:function(){return n.result(this.gifSearch,"remove"),this.$el.remove(),this}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(7),o=i(110),r=i(144),a=i(367),l=i(396),c=function(){};c.extend=s.Model.extend,n.extend(c.prototype,s.Events);var u=new c,h=r.extend({name:"ImageSearch",selector:"body",defaults:{resultLimit:200,imageWidth:250,loadFullImageBeforeSelect:!1,query:null,selectedImageUrl:null,loggingContext:null},initialize:function(e){e=e||{},n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"collection")),n.isEmpty(this.collection)&&(this.collection=new l),this.view=new a(n.extend({eventBus:u,collection:this.collection,query:this.get("query"),imageWidth:this.get("imageWidth"),loadFullImageBeforeSelect:this.get("loadFullImageBeforeSelect"),
resultLimit:this.get("resultLimit"),selectedImageUrl:this.get("selectedImageUrl"),loggingContext:this.get("loggingContext")},this.viewOptions)),this.listenTo(u,"image:select",function(e,t){this.logGifSearchEvent("select",t),this.trigger("selectImage",e.toJSON(),this.getQuery())}),this.listenTo(u,"image:impression",function(e){this.logGifSearchEvent("impression",e)}),this.listenTo(u,"gifsearch:resultChange",function(e){this.logGifSearchResultChange("search",e)}),this.listenTo(this.view,"dismiss",function(){this.trigger("dismiss")})},render:function(){return this.view.render(),this.trigger("append"),this.view},setQuery:function(e){this.view.setQuery(e)},getQuery:function(){return this.view.getQuery()},getCurrentResults:function(){return this.view.get("currentResults")},logGifSearchEvent:function(e,t){var i={popularSearch:t.model.get("popularSearchTag")?t.model.get("popularSearchTag"):null,query:this.getQuery()?this.getQuery():null,resultsIndex:this.getCurrentResults().indexOf(t.model),top:Math.round(t.$el.position().top),left:Math.round(t.$el.position().left),postBlog:t.model.get("postBlog"),postId:t.model.get("postId"),context:this.get("loggingContext")};o.trigger("gifsearch:"+e,{loggingData:i})},logGifSearchResultChange:function(e,t){var i=this.getQuery();if(i){var n={query:i,context:this.get("loggingContext")};o.trigger("gifsearch:"+e,{loggingData:n})}}});e.exports=h},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(101),r=i(156),a=i(368),l=i(370),c=i(387),u=i(390),h=i(395),d=r.extend({className:"gif-search-container",template:h,subviews:{searchInput:{constructor:a,options:function(e){return{eventBus:e.eventBus}}},searchResults:{constructor:l,options:function(e){return{imageWidth:e.get("imageWidth"),selectedImageUrl:e.get("selectedImageUrl"),loadFullImageBeforeSelect:e.get("loadFullImageBeforeSelect"),eventBus:e.eventBus}}},searchMessage:{constructor:c,options:function(e){return{eventBus:e.eventBus}}}},defaults:{imageWidth:null,loadFullImageBeforeSelect:!0,resultLimit:200,selectedImageUrl:"",query:null,loggingContext:null},initialize:function(e){e=s.extend({},e),s.extend(this.attributes,s.pick(e,s.keys(this.defaults))),s.extend(this,s.pick(e,"eventBus","collection")),this.noResults=[o("Nothing turned up. Bummer."),o("Looked around but didn't see anything about that."),o("Sadly, nothing."),o("Tragically, nothing."),o("Welcome to the void. There is nothing here."),o("We found nothing. Here it isn't."),o("Couldn't find that. Please, don't be upset. Please."),o("Sincerely, we found nothing."),o("Maybe try a similar search but use different words? Dunno.")],this.listenTo(this,"change:query",this._onChangeQuery),this.listenTo(this.eventBus,"image:tag",function(e,t){this.set("query",e),this.searchInput.setValue(this.get("query"))}),this.listenTo(this.eventBus,"showHiddenResults",function(){this.searchResults.setCollection(this.get("currentResults")),this.hasResults()&&this.searchMessage.hide()})},hasResults:function(){return!(s.isEmpty(this.get("currentResults"))||s.isEmpty(this.get("currentResults").models))},dismiss:function(){this.trigger("dismiss")},_onKeyDown:function(e){27===e.keyCode&&(e.stopPropagation(),this.dismiss())},_onChangeQuery:function(e,t){s.isString(t)&&(this.rendered&&this.loader.set("loading",!0),this.currentQuery&&this.currentQuery.reject(),this.searchResults.cancelPreloads(),this.searchResults.cancelFullImageLoads(),this.currentQuery=this.collection.fetchGifs(t,this.get("resultLimit"),this.get("loggingContext")),this.currentQuery.promise.then(s.bind(function(e){if(this.set("currentResults",e.media),this.rendered){this.loader.set("loading",!1);var t=e.get("message");t&&(t.header||t.body)?this.searchMessage.setMessage(t.header,t.body,this.hasResults()):(this.searchResults.setCollection(this.get("currentResults")),this.hasResults()?this.searchMessage.hide():this.searchMessage.setMessage("",s.sample(this.noResults),!1))}this.currentQuery=null},this)))},afterRenderSubviews:function(){s.defer(s.bind(function(){this.searchInput.focus()},this)),this.listenTo(this.searchInput,"userQueryChanged",function(e){this.setQuery(e)}),this.loader=new u({$container:this.$el,type:"bar",classModifiers:"top",loading:!1}),s.isString(this.get("query"))&&(this._onChangeQuery(this,this.get("query")),this.searchInput.setValue(this.get("query"))),n("body").on("keydown.image-search-container",s.bind(this._onKeyDown,this))},setQuery:function(e){this.set("query",e)},getQuery:function(){return this.get("query")},beforeRemove:function(){n("body").off(".image-search-container"),this.currentQuery&&this.currentQuery.reject()}});e.exports=d},function(e,t,i){"use strict";var n=i(156),s=i(369),o=i(101),r=i(3),a=i(220),l=n.extend({className:"gif-search-input",template:s,subviews:{textEditor:{constructor:a,options:function(e){return{forceSingleLine:!0,placeholder:o("Find a GIF"),syncWithModel:!1,onChange:r.debounce(r.bind(e._onUserChangeInput,e),250)}}}},_onUserChangeInput:function(){this.trigger("userQueryChanged",this.textEditor.getEditorValue())},focus:function(){this.textEditor.focus()},setValue:function(e){this.textEditor.setEditorValue(e)}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="textEditor"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=s.prototype,r=i(371),a=i(372),l=i(374),c=i(165),u=c.animate,h=c.hook,d=i(121),p=i(385),g=function(e){var t=Math.round(e.position().top),i=Math.round(t+e.height());return{top:t,bottom:i}},m=function(e,t){return!(t.bottom<e.top||t.top>e.bottom)},f=function(e,t){return t.bottom>=e.bottom&&t.top<=e.top},v=function(e){return{top:Math.round(e.scrollTop()),bottom:Math.round(e.scrollTop()+e.height())}},_=function(e,t){return Math.floor(t.position().top/e.height())},b=function(e){return Math.floor(e.scrollTop()/e.outerHeight(!0))},w=function(e){return Math.ceil(e.get(0).scrollHeight/e.height())},y=s.extend({className:"gif-search-results",template:r,subviews:{searchResults:{constructor:a,options:function(e){return{eventBus:e.eventBus,imageWidth:e.get("imageWidth"),loadFullImageBeforeSelect:e.get("loadFullImageBeforeSelect")}},collection:function(e){return e.collection}}},defaults:{renderBatchSize:50,renderBatchDelay:5,selectedImageUrl:"",imageWidth:null,loadFullImageBeforeSelect:!0,enablePreloading:!0,isPreloading:!1,preloadPollInterval:1e3},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","collection"))},setCollection:function(e){this.collection&&this.stopListening(this.collection),this.collection=e,this.eventBus.trigger("gifsearch:resultChange",this.collection),this.rendered&&this.render()},populatePreloadQueue:function(){this._preloadQueue=n.range(w(this.$el)),this.sortPreloadQueue()},sortPreloadQueue:function(){var e;n.isEmpty(this._preloadQueue)||(e=b(this.$el),this._preloadQueue=n.sortBy(this._preloadQueue,function(t){return Math.abs(e-t)+(e>t?.1:0)}))},clearPreloadQueue:function(){this._preloadQueue&&(this._preloadQueue.length=0)},processPreloadQueue:function(){var e,t;if(!this.get("isPreloading")){if(!this.rendered||n.isEmpty(this._preloadQueue))return void this.stopPreloadPoller();e=this._preloadQueue.shift(),t=this.getViewsAtPageIndex(e),this.set("isPreloading",!0),this.preloadSubviews(t)["finally"](n.bind(function(){this.set("isPreloading",!1)},this))["catch"](n.noop)}},startPreloadPoller:function(){this.stopPreloadPoller(),this._preloadTimer=setInterval(n.bind(this.processPreloadQueue,this),this.get("preloadPollInterval"))},stopPreloadPoller:function(){this._preloadTimer&&(clearInterval(this._preloadTimer),this._preloadTimer=null)},renderCollectionSubviews:function(e){if("searchResults"!==e)return o.renderCollectionSubviews.apply(this,arguments);var t=this.subviews[e],i=t.container||n.bind(function(){return this.$('[data-subview="'+e+'[]"]')},this),s=t.prepareView||function(i,n){var s=new t.constructor(n);return s.$el.attr("data-subview",e),i.append(s.$el),s},r=t.options||{},a=t.collection;if(n.isFunction(a)&&(a=a(this)),!a)return null;var l=this.get("renderBatchSize"),c=this.get("renderBatchDelay");this._deferredRenders=n(a.models).groupBy(function(e,t){return Math.floor(t/l)}).toArray().map(function(t,o){return n.delay(this.createCollectionSubviewRenderer(t,i,s,r,e,!!o),o*c)},this).value()},hideViews:function(e){n.each(e,function(e){e.rendered&&(e.set("isSelectable",!1),e.$el.css("opacity",0))})},animateShowViews:function(e){var t=0;n.each(e,function(e){this.animateShowView(e,100*t++)},this)},animateShowView:function(e,t,i,s){var o,r=!1;s=n.isNumber(s)?s:250,t=n.isNumber(t)?t:0,i=n.isNumber(i)?i:1e3,h(e.$el,"translateY","40px");var a=function(){r=!0,u(e.$el,"stop"),u(e.$el,{translateY:0,opacity:1},{duration:s,delay:t,complete:n.bind(function(){e.rendered&&(e.set("isSelectable",!0),e.$el.css({transform:"",opacity:""}))},this)})};i>0&&(o=setTimeout(a,i)),e.getLoadPromise().then(function(){o&&clearTimeout(o),r||a()})},beforeRender:function(){this.$el.css("visibility","hidden"),this.removeSubviews()},afterRender:function(){this.collection&&0!==this.collection.length&&(this.listenTo(this.eventBus,"image:full:loading",this.cancelPreloads),n.defer(n.bind(function(){if(this.rendered){this._deferredRenders||(this._deferredRenders=[]);var e=n.delay(n.bind(this.resetMasonry,this),this.get("renderBatchDelay")*this._deferredRenders.length);this._deferredRenders.push(e),this.scrollbar?this.scrollbar.update():this.scrollbar=new p(this.$el)}},this)))},removeSubviews:function(){return n.forEach(this._deferredRenders,clearTimeout),this._deferredRenders=[],delete this.masonry,o.removeSubviews.apply(this,arguments)},resetMasonry:function(){this.setupMasonary(),this.setupElementCaches(),this.get("enablePreloading")&&(this.populatePreloadQueue(),this.startPreloadPoller()),this.setSelectedImage(),this.setupVirtualization();var e=this.getSubviewsInBounds();this.hideViews(e),this.$el.css("visibility",""),this.animateShowViews(e)},getViewBounds:function(e){return n.result(this._elementPositionCache,e.cid)?this._elementPositionCache[e.cid]:g(e.$el)},getSubviewsInBounds:function(e){return e=e||v(this.$el),n.filter(this.searchResults,function(t){return m(this.getViewBounds(t),e)},this)},setupMasonary:function(){this.masonry?this.masonry.reload():this.masonry=new l(this.$(".results-scroller").get(0),{transitionDuration:0,isFitWidth:!0,gutter:10},this)},setupElementCaches:function(){var e=this.$el;this._pageIndexCache={},this._elementPositionCache={},n.each(this.searchResults,function(t){var i=_(e,t.$el);n.isArray(this._pageIndexCache[i])||(this._pageIndexCache[i]=[]),this._pageIndexCache[i].push(t),this._elementPositionCache[t.cid]=g(t.$el)},this)},getViewsAtPageIndex:function(e){return this._pageIndexCache[e]||[]},setupVirtualization:function(){var e=n.bind(function(){this.rendered&&(this.sortPreloadQueue(),this.virtualizeSubviews())},this),t=n.debounce(e,250);this.$el.off(".image-search-virtualization").on("scroll.image-search-virtualization",t),this.virtualizeSubviews()},setSelectedImage:function(){var e,t;if(this.get("selectedImageUrl")&&(t=n.find(this.searchResults,function(e,t){return e.model.get("mediaUrl")===this.get("selectedImageUrl")},this))){if(t.set("isPreselected",!0),e=t.$el.offset().top-this.$el.offset().top,0===e)return;e-=(this.$el.height()-t.$el.height())/2,this.$el.scrollTop(e)}},cancelPreloads:function(){this.stopPreloadPoller(),this.clearPreloadQueue()},cancelFullImageLoads:function(){this.eventBus.trigger("image:full:cancelLoad")},preloadSubviews:function(e,t){return d.all(n.map(e,function(e){return e.loadImage()}))},_virtualizeSubviews:function(e,t,i){n.forEach(this.searchResults,function(s,o){if(s&&s.$el){var r=this.getViewBounds(s);m(r,e)?n.isFunction(t)&&t.call(this,s,f(r,e)):n.isFunction(i)&&i.call(this,s)}},this)},virtualizeSubviews:function(){var e=this.$el,t={top:e.scrollTop(),bottom:e.scrollTop()+e.height()};this._virtualizeSubviews(t,function(e,t){e.set({isVirtualized:!1}),t&&e.get("isImpressionLogged")===!1&&(this.eventBus.trigger("image:impression",e),e.set("isImpressionLogged",!0))},function(e){e.set({isVirtualized:!0})})},beforeRemove:function(){this.$el.off(),this.cancelPreloads(),this.cancelFullImageLoads(),this.scrollbar&&this.scrollbar.destroy()}});e.exports=y},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="results-scroller" data-subview="searchResults[]"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(156),r=i(373),a=i(186),l=i(205),c=i(258),u=i(121),h=o.extend({className:"gif-search-result",template:r,events:{"click [data-js-select]":"_onClickSelect","click [data-js-tag]":"_onClickTag"},mixins:[l],defaults:{skipTags:["gif","gifs"],imageWidth:null,isVirtualized:!0,hasStillImage:!0,isPreselected:!1,unloadImageOnVirtualize:!1,isLoaded:!1,isSelectable:!0,loadFullImageBeforeSelect:!0,loadingFullImage:!1,containerWidth:150,isImpressionLogged:!1},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus")),this._loadDefer=u.defer()},afterRender:function(){this.listenTo(this,"change:isPreselected",this._onChangeIsPreselected),this.listenTo(this,"change:isVirtualized",this._onChangeIsVirtualized),this.listenTo(this,"change:hasStillImage",this._onChangeHasStillImage),this.listenTo(this,"change:isSelectable",this._onChangeIsSelectable),this.listenTo(this,"change:isLoaded",this._onChangeIsLoaded),this.listenTo(this.eventBus,"image:full:cancelLoad",this._onCancelAllFullImageLoads),this._onChangeIsVirtualized(this,this.get("isVirtualized")),this._onChangeHasStillImage(this,this.get("hasStillImage")),this._onChangeIsPreselected(this,this.get("isPreselected")),this._onChangeIsSelectable(this,this.get("isSelectable")),this._onChangeIsLoaded(this,this.get("isLoaded"))},getTemplateData:function(){var e=this.model.toJSON(),t=e.popularSearchTag?[e.popularSearchTag]:e.postTags,i=this.get("skipTags"),s=this.get("containerWidth"),o=Math.round(this.model.get("height")*(s/this.model.get("width")));return t=n.reject(t,function(e){return n.contains(i,e.toLowerCase())}),n.extend(e,{tags:t.slice(0,3),width:s,height:o}),this.get("imageWidth")&&n.extend(e,{mediaUrl:e.mediaUrl.replace(/_\d+\./,"_"+this.get("imageWidth")+".")}),e},loadImage:function(){var e=this.js$("img"),t=e.attr("data-img-src");return this.get("isLoaded")||(e.attr("src",t),a.load(t,100).then(n.bind(function(){this.rendered&&this.set("isLoaded",!0),this._loadDefer.resolve()},this))),this._loadDefer.promise},unloadImage:function(){this.js$("img").removeAttr("src")},refreshStillImage:function(){this._onChangeHasStillImage(this,this.get("hasStillImage"))},getLoadPromise:function(){return this._loadDefer.promise},_onCancelAllFullImageLoads:function(){this._cancelLoadFullImage()},_onClickSelect:function(){var e=this.model.get("mediaUrl"),t=this.js$("img").attr("src"),i=function(){this.$el.addClass("gif-search-result--selected"),this.eventBus.trigger("image:select",this.model,this)};this.get("loadFullImageBeforeSelect")&&e!==t?this._loadFullImage(e,i):i.call(this)},_loadFullImage:function(e,t){this.eventBus.trigger("image:full:cancelLoad"),this.set("loadingFullImage",!0),this.eventBus.trigger("image:full:loading"),this.loader=new c({variation:"centered small",loading:!0}),this.$el.addClass("loading-full").append(this.loader.render().$el),a.load(e).then(n.bind(function(){this.get("loadingFullImage")&&n.isFunction(t)&&t.call(this)},this))["finally"](n.bind(this._cancelLoadFullImage,this))},_cancelLoadFullImage:function(){this.rendered&&this.get("loadingFullImage")&&(this.loader&&(this.loader.remove(),this.loader=null),this.$el.removeClass("loading-full"),this.set("loadingFullImage",!1))},_onClickTag:function(e){var t=s(e.target).attr("data-js-tag");this.eventBus.trigger("image:tag",t,this.model),e.preventDefault(),e.stopPropagation()},_onChangeIsPreselected:function(e,t){this.$el.toggleClass("gif-search-result--preselected",t)},_onChangeIsVirtualized:function(e,t){this.$el.toggleClass("off",t),t&&this.get("unloadImageOnVirtualize")?this.unloadImage():t||this.loadImage()},_onChangeHasStillImage:function(e,t){this._removeStillCanvas(),t&&this._prepareCreateStillCanvas()},_onChangeIsSelectable:function(e,t){this.$el.toggleClass("gif-search-result--selectable",t)},_onChangeIsLoaded:function(e,t){this.$el.toggleClass("loaded",t)},_createStillCanvas:function(){if(this.rendered){var e,t=this.js$("img"),i=t.parent(),n=parseInt(t.width(),10),o=parseInt(t.height(),10),r=s("<canvas />").attr({width:n,height:o});this.$("canvas").remove(),i.append(r),e=r.get(0).getContext("2d"),e.drawImage(t.get(0),0,0,n,o),this.$el.addClass("show-still")}},_prepareCreateStillCanvas:function(){this.getLoadPromise().then(n.bind(this._createStillCanvas,this))["catch"](n.noop)},_removeStillCanvas:function(){this.$("canvas").remove(),this.$el.removeClass("show-still")}});e.exports=h},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<figure data-js-select style="width: '+(null==(__t=width)?"":_.escape(__t))+"px; height: "+(null==(__t=height)?"":_.escape(__t))+'px"><img data-js-img data-img-src="'+(null==(__t=mediaUrl)?"":_.escape(__t))+'" width="'+(null==(__t=width)?"":_.escape(__t))+'" height="'+(null==(__t=height)?"":_.escape(__t))+'"></figure><footer><nav class="tags"> ',_.each(tags,function(e){__p+=" ",_.isEmpty(e)||(__p+=' <a href="#" data-js-tag="'+(null==(__t=e)?"":_.escape(__t))+'">#'+(null==(__t=e)?"":_.escape(__t))+"</a> "),__p+=" "}),__p+=' </nav><a class="attribution" href="http://tmblr.co/'+(null==(__t=rootPostUrlHash)?"":_.escape(__t))+'" target="_blank">'+(null==(__t=__("Originally posted by %1$s",rootBlog))?"":_.escape(__t))+"</a></footer>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},,,,,,,,,,,,function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(386),r=i(110),a=i(149),l=i(160),c=i(205),u=a.extend({mixins:[c,l],tplScrollbarWrapper:'<div class="tx-scroll"></div>',tplScrollbarTrackVertical:'<div data-js-track-vertical class="tx-scrollbar-track tx-scrollbar-track--vertical"><div data-js-thumb-vertical class="tx-scrollbar-thumb"></div></div>',tplScrollbarTrackHorizontal:'<div data-js-track-horizontal class="tx-scrollbar-track tx-scrollbar-track--horizontal"><div data-js-thumb-horizontal class="tx-scrollbar-thumb"></div></div>',defaults:{trackActiveClass:"tx-scrollbar-track--active",scrollingClass:"tx-scroll--scrolling",containerClass:"tx-scroll-container",containerClassVertical:"tx-scroll-container--vertical",containerClassHorizontal:"tx-scroll-container--horizontal",infiniteScrollPercent:.9,isScrollable:!1,isScrollableHorizontal:!1,isScrollableVertical:!1,isScrolling:!1,nativeScrollbarSize:20},events:{"mousedown [data-js-thumb-vertical]":"_onVerticalThumbMousedown","mousedown [data-js-thumb-horizontal]":"_onHorizontalThumbMousedown"},destroyed:!1,constructor:function(e){var t=this._getElementFromOptions(e);if(null!==t)return this.container=t,this.$container=s(t),n.extend(e,{el:this._getWrappedElement(t)}),a.prototype.constructor.call(this,e)},initialize:function(e){this.$window=s(window),this._onScrollStopDebounced=n.debounce(n.bind(this._onScrollStop,this),150),this._onResizeDebounced=n.debounce(n.bind(this._onResize,this),150),this.render()},render:function(){return this.rendered&&!this.destroyed?this:(this.listenTo(r,"DOMEventor:flatresize",this._onResizeDebounced),this.listenTo(this,"change:isScrollableVertical",this._onChangeIsScrollableVertical),this.listenTo(this,"change:isScrollableHorizontal",this._onChangeIsScrollableHorizontal),this.listenTo(this,"change:isScrollable",this._onChangeIsScrollable),this.update(),this.destroyed=!1,a.prototype.render.apply(this,arguments))},getVerticalTrack:function(e){var t=this.js$("track-vertical",e);return t.length>0?t:null},getHorizontalTrack:function(e){var t=this.js$("track-horizontal",e);return t.length>0?t:null},getVerticalThumb:function(e){var t=this.js$("thumb-vertical",e);return t.length>0?t:null},getHorizontalThumb:function(e){var t=this.js$("thumb-horizontal",e);return t.length>0?t:null},getScrollContainer:function(){return this.container},isScrollable:function(){return this.get("isScrollable")},isScrollableVertical:function(){return this.get("isScrollableVertical")},isScrollableHorizontal:function(){return this.get("isScrollableHorizontal")},update:function(){var e,t,i;this.destroyed||(e=this._isScrollableVertical(),t=this._isScrollableHorizontal(),i=e||t,this.set({isScrollableVertical:e,isScrollableHorizontal:t,isScrollable:i}),this._updateScrollConstants(),e&&(this._updateVerticalThumbHeight(),this._positionVerticalThumb()),t&&(this._updateHorizontalThumbWidth(),this._positionHorizontalThumb()))},remove:function(){return this.destroy()},destroy:function(){this.$container.off(".txScroll"),this.$window.off(".txScroll"),this.set({isScrollable:!1,isScrollableHorizontal:!1,isScrollableVertical:!1}),this.undelegateEvents(),this.stopListening(),this._unwrapContainer(),this.destroyed=!0},_getElementFromOptions:function(e){var t;return t=e instanceof s?e.get(0):e instanceof window.Element?e:n.get(e,"el",null)},_getWrappedElement:function(e){var t=e instanceof s?e:s(e),i=s(this.tplScrollbarWrapper);return t.wrap(i),i=t.parent(),i.get(0)},_unwrapContainer:function(){this.$container.unwrap()},_appendVerticalTrack:function(){this.$el.append(s(this.tplScrollbarTrackVertical))},_removeVerticalTrack:function(){var e=this.getVerticalTrack(!0);e&&e.remove()},_appendHorizontalTrack:function(){this.$el.append(s(this.tplScrollbarTrackHorizontal))},_removeHorizontalTrack:function(){var e=this.getHorizontalTrack(!0);e&&e.remove()},_onChangeIsScrollable:function(e,t){var i;this.destroyed||(i="ontouchstart"in document.documentElement,i||this.$container.off("wheel.txScroll"),this.$container.off("scroll.txScroll"),this.$container.toggleClass(this.get("containerClass"),t),t&&(this.$container.on("scroll",n.bind(this._onScroll,this)),i||this.$container.on("wheel.txScroll",n.bind(this._stealScroll,this))))},_onChangeIsScrollableVertical:function(e,t){this.destroyed||(this.$container.toggleClass(this.get("containerClassVertical"),t),t?this._appendVerticalTrack():this._removeVerticalTrack(),this.js$.update("track-vertical"),this.js$.update("thumb-vertical"))},_onChangeIsScrollableHorizontal:function(e,t){this.destroyed||(this.$container.toggleClass(this.get("containerClassHorizontal"),t),t?this._appendHorizontalTrack():this._removeHorizontalTrack(),this.js$.update("track-horizontal"),this.js$.update("thumb-horizontal"))},_updateScrollConstants:function(){var e=this.getVerticalTrack(),t=this.getHorizontalTrack(),i=this.getVerticalThumb(),n=this.getHorizontalThumb();this.currentScrollTop=this.$container.scrollTop(),this.currentScrollLeft=this.$container.scrollLeft(),this.get("isScrollableVertical")&&e&&i&&(this.percentageDifferenceVertical=(this.container.scrollHeight-this.$container.height())/(e.height()-i.height())),this.get("isScrollableHorizontal")&&t&&n&&(this.percentageDifferenceHorizontal=(this.container.scrollWidth-this.$container.width())/(t.width()-n.width()))},_onResize:function(){this.update()},_getAddedScrollbarHeight:function(){return this.get("isScrollableHorizontal")?this.get("nativeScrollbarSize"):0},_getAddedScrollbarWidth:function(){return this.get("isScrollableVertical")?this.get("nativeScrollbarSize"):0},_isScrollableVertical:function(){return this.container&&this.container.scrollHeight>this.$container.height()+this._getAddedScrollbarHeight()},_isScrollableHorizontal:function(){return this.container&&this.container.scrollWidth>this.$container.width()+this._getAddedScrollbarWidth()},_getScrollTop:function(e,t){return e.pageY-t.offset().top},_getScrollLeft:function(e,t){return e.pageX-t.offset().left},_onVerticalThumbMousedown:function(e){var t=this.getVerticalTrack();e.preventDefault(),t&&(t.addClass(this.get("trackActiveClass")),this.$window.on("mousemove.txScroll",n.bind(this._onVerticalThumbMousemove,this)),this.$window.on("mouseup.txScroll",n.bind(this._onVerticalThumbMouseup,this)),this.mouseDownOriginalOffsetY=this._getScrollTop(e,t),this._updateScrollConstants())},_onHorizontalThumbMousedown:function(e){var t=this.getHorizontalTrack();e.preventDefault(),t&&(t.addClass(this.get("trackActiveClass")),this.$window.on("mousemove.txScroll",n.bind(this._onHorizontalThumbMousemove,this)),this.$window.on("mouseup.txScroll",n.bind(this._onHorizontalThumbMouseup,this)),this.mouseDownOriginalOffsetX=this._getScrollLeft(e,t),this._updateScrollConstants())},_onVerticalThumbMousemove:function(e){var t,i=this.getVerticalTrack();i&&o.read(function(){this.destroyed||(t=this._getScrollTop(e,i)-this.mouseDownOriginalOffsetY,o.write(function(){this.destroyed||this.$container.scrollTop(this.currentScrollTop+t*this.percentageDifferenceVertical)},this))},this)},_onVerticalThumbMouseup:function(e){var t=this.getVerticalTrack();e.preventDefault(),t&&t.removeClass(this.get("trackActiveClass")),this.$window.off(".txScroll")},_onHorizontalThumbMousemove:function(e){var t,i=this.getHorizontalTrack();i&&o.read(function(){this.destroyed||(t=this._getScrollLeft(e,i)-this.mouseDownOriginalOffsetX,o.write(function(){this.destroyed||this.$container.scrollLeft(this.currentScrollLeft+t*this.percentageDifferenceHorizontal)},this))},this)},_onHorizontalThumbMouseup:function(e){var t=this.getHorizontalTrack();e.preventDefault(),t&&t.removeClass(this.get("trackActiveClass")),this.$window.off(".txScroll")},_updateVerticalThumbHeight:function(){var e,t=this.getVerticalThumb(),i=this.getVerticalTrack();i&&t&&(e=this.$container.height()/this.container.scrollHeight,t.height(i.height()*e))},_updateHorizontalThumbWidth:function(){var e,t=this.getHorizontalThumb(),i=this.getHorizontalTrack();i&&t&&(e=this.$container.width()/this.container.scrollWidth,t.width(i.width()*e))},_positionVerticalThumb:function(){var e,t,i,n=this.getVerticalTrack(),s=this.getVerticalThumb();!this.destroyed&&n&&s&&(i=this.container.scrollTop,e=i/(this.container.scrollHeight-this.$container.height()),t=n.height()-s.height(),o.write(function(){this.destroyed||(s.css("transform","translate3d(0, "+t*e+"px, 0)"),this.trigger("scroll:vertical",i,e),this.trigger("scroll",i,e),e>this.get("infiniteScrollPercent")&&this.trigger("infinitescroll",i,e))},this))},_positionHorizontalThumb:function(){var e,t,i,n=this.getHorizontalTrack(),s=this.getHorizontalThumb();!this.destroyed&&n&&s&&(i=this.container.scrollLeft,e=i/(this.container.scrollWidth-this.$container.width()),t=n.width()-s.width(),o.write(function(){this.destroyed||(s.css("transform","translate3d("+t*e+"px, 0, 0)"),this.trigger("scroll:horizontal",i,e))},this))},_onScroll:function(){this.get("isScrolling")||(this.trigger("scrollstart"),this.$el.addClass(this.get("scrollingClass"))),this.set("isScrolling",!0),this._onScrollStopDebounced(),this.get("isScrollableVertical")&&o.read(n.bind(this._positionVerticalThumb,this)),this.get("isScrollableHorizontal")&&o.read(n.bind(this._positionHorizontalThumb,this))},_onScrollStop:function(){this.destroyed||(this.trigger("scrollstop"),this.set("isScrolling",!1),this.$el.removeClass(this.get("scrollingClass")))},_stealScroll:function(e){var t=e.currentTarget,i=e.originalEvent.deltaX,n=e.originalEvent.deltaY,o=Math.abs(i)>0,r=Math.abs(n)>0;this.get("isScrollableHorizontal")&&o&&(0>i&&t.scrollLeft<=0&&e.preventDefault(),i>0&&t.scrollLeft>=t.scrollWidth-s(t).width()-this._getAddedScrollbarWidth()&&e.preventDefault()),this.get("isScrollableVertical")&&r&&(0>n&&t.scrollTop<=0&&e.preventDefault(),n>0&&t.scrollTop>=t.scrollHeight-s(t).height()-this._getAddedScrollbarHeight()&&e.preventDefault())}});e.exports=u},function(e,t,i){var n;!function(s){"use strict";function o(){this.frames=[],this.lastId=0,this.raf=r,this.batch={hash:{},read:[],write:[],mode:null}}var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)};window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||function(e){window.clearTimeout(e)};o.prototype.read=function(e,t){var i=this.add("read",e,t),n=i.id;this.batch.read.push(i.id);var s="reading"===this.batch.mode||this.batch.scheduled;return s?n:(this.scheduleBatch(),n)},o.prototype.write=function(e,t){var i=this.add("write",e,t),n=this.batch.mode,s=i.id;this.batch.write.push(i.id);var o="writing"===n||"reading"===n||this.batch.scheduled;return o?s:(this.scheduleBatch(),s)},o.prototype.defer=function(e,t,i){"function"==typeof e&&(i=t,t=e,e=1);var n=this,s=e-1;return this.schedule(s,function(){n.run({fn:t,ctx:i})})},o.prototype.clear=function(e){if("function"==typeof e)return this.clearFrame(e);var t=this.batch.hash[e];if(t){var i=this.batch[t.type],n=i.indexOf(e);delete this.batch.hash[e],~n&&i.splice(n,1)}},o.prototype.clearFrame=function(e){var t=this.frames.indexOf(e);~t&&this.frames.splice(t,1)},o.prototype.scheduleBatch=function(){var e=this;this.schedule(0,function(){e.batch.scheduled=!1,e.runBatch()}),this.batch.scheduled=!0},o.prototype.uniqueId=function(){return++this.lastId},o.prototype.flush=function(e){for(var t;t=e.shift();)this.run(this.batch.hash[t])},o.prototype.runBatch=function(){try{this.batch.mode="reading",this.flush(this.batch.read),this.batch.mode="writing",this.flush(this.batch.write),this.batch.mode=null}catch(e){throw this.runBatch(),e}},o.prototype.add=function(e,t,i){var n=this.uniqueId();return this.batch.hash[n]={id:n,fn:t,ctx:i,type:e}},o.prototype.run=function(e){var t=e.ctx||this,i=e.fn;if(delete this.batch.hash[e.id],!this.onError)return i.call(t);try{i.call(t)}catch(n){this.onError(n)}},o.prototype.loop=function(){var e=this,t=this.raf;this.looping||(t(function i(){var n=e.frames.shift();e.frames.length?t(i):e.looping=!1,n&&n()}),this.looping=!0)},o.prototype.schedule=function(e,t){return this.frames[e]?this.schedule(e+1,t):(this.loop(),this.frames[e]=t)},s=s||new o,"undefined"!=typeof e&&e.exports?e.exports=s:(n=function(){return s}.call(t,i,t,e),!(void 0!==n&&(e.exports=n)))}(window.fastdom)},function(e,t,i){"use strict";var n=i(3),s=i(388),o=i(156),r=i(389),a=o.extend({className:"gif-search-message",template:r,defaults:{header:"",body:"",hasResults:!1},events:{"click [data-js-showResults]":"_onClickShowResults"},initialize:function(e){n.extend(this,n.pick(e,"eventBus"))},_onClickShowResults:function(){this.eventBus.trigger("showHiddenResults")},_filterMessageHtml:function(e,t){t.find("script, link").remove(),t.find("a[onerror]").removeAttr("onerror")},getTemplateData:function(){var e=o.prototype.getTemplateData.apply(this,arguments);return e.body=s(e.body||"",this._filterMessageHtml),e},afterRender:function(){this.rendered||this.listenTo(this,"change",this.render),this.$el.toggleClass("gif-search-message--hidden",!(this.get("header")||this.get("message")))},setMessage:function(e,t,i){n.isString(t)||(t=e,e=""),n.isBoolean(i)||(i=this.get("hasResults")),this.set({header:e,body:t,hasResults:i}),t||e?this.show():this.hide()},show:function(){this.$el.removeClass("gif-search-message--hidden")},hide:function(){this.$el.addClass("gif-search-message--hidden")}});e.exports=a},function(e,t,i){"use strict";function n(e,t){
var i=r.nodeFromString(e),n=o(i);return s.isFunction(t)&&(t=s.rest(arguments)),s.each(t,function(e){e(i,n)}),n.html()}var s=i(3),o=i(9),r=i(283);e.exports=n},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="gif-search-message-container"> ',header&&(__p+=' <h2 class="gif-search-message-header">'+(null==(__t=header)?"":__t)+"</h2> "),__p+=' <div class="gif-search-message-body">'+(null==(__t=body)?"":__t)+"</div> ",hasResults&&(__p+=' <p><span class="gif-search-show-results" data-js-showresults>'+(null==(__t=__("View results anyway"))?"":_.escape(__t))+"</span></p> "),__p+=" </div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(391);e.exports=n},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(392),r=i(394),a=s.extend({className:"loader-container",template:r,defaults:{type:"",classModifiers:"",loading:!1},initialize:function(e){this.options=n.extend({},this.defaults,e),this.$container=e.$container,"bar"===this.get("type")&&this.createBarLoader(),this.listenTo(this,"change:loading",this._onChangeLoading),this.attach()},createBarLoader:function(){this.subviews.loaderType=new o(this.options)},_onChangeLoading:function(e,t){this.subviews.loaderType.toggleLoading(t)},attach:function(){this.render(),this.$el.attr("data-subview=loader"),this.$container.find("[data-subview=loader]").replaceWith(this.$el)}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(393),r=s.extend({className:"loader-bar",template:o,defaults:{classModifiers:"",loading:!1},initialize:function(e){this.options=n.extend({},this.defaults,e),this.$el.addClass(this.get("classModifiers")),this.interval=null,this.timeout=null},afterRender:function(){this.$bars=this.$el.find(".bar"),this.get("loading")===!0&&this.toggleLoading(this.get("loading"))},toggleLoading:function(e){this.currentBar=0,this.counter=0,e===!0?(clearTimeout(this.timeout),this.$el.addClass("loading"),this.$bars.addClass("animating"),this.startAnimating()):(this.$el.removeClass("loading"),this.stopAnimating(),setTimeout(n.bind(function(){this.$bars.removeClass("animating")},this),300))},showBar:function(e){this.$bars.eq(e).addClass("active")},hideBar:function(e){this.$bars.eq(e).removeClass("active")},loop:function(){var e=this.$bars.eq(this.currentBar);e.remove(),this.$el.append(e),this.currentBar+=1,this.currentBar>=this.$bars.length&&(this.currentBar=0),this.counter++},startAnimating:function(){this.stopAnimating(),this.loop(),this.interval=setInterval(n.bind(function(){this.loop()},this),300)},stopAnimating:function(){clearInterval(this.interval)}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="bar white"></div><div class="bar red"></div><div class="bar orange"></div><div class="bar green"></div><div class="bar purple"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+=""+(null==(__t=_subview("loaderType"))?"":__t);return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="searchInput"></div><div data-subview="loader"></div><div data-subview="searchResults"></div><div data-subview="searchMessage"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(121),o=i(119),r=i(397),a=3e5,l=o.extend({model:r,resultCountForQuery:function(e){e=(e||"").toLowerCase().trim();var t=this.get(e);return t?t.media.length:0},fetchGifs:function(e,t,i,o){var l,c=s.defer();e=(e||"").toLowerCase().trim();var u=this.get(e);return u||(u=new r({query:e,limit:t,loggingContext:i}),this.add(u)),!o&&n.now()-u.get("ts")<a?(this.trigger("search",e,!0),c.resolve(u)):(this.trigger("search",e,!1),l=u.fetch({success:function(){l=null,c.resolve(u)},error:function(e){l=null,c.reject(e)}})),c.promise["catch"](function(){l&&l.abort()}),c},clearCache:function(e){this.remove(e)}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(114),o=s.prototype,r=i(398),a=function(e,t,i){this.name="EmbedError",this.message=e,this.input=t,this.data=i,this.stack=(new Error).stack},l=s.extend({idAttribute:"query",url:"/svc/search/inline_gif",defaults:{query:"",limit:200,loggingContext:null},initialize:function(e,t){this.media=new r},fetch:function(e){var t=this.get("loggingContext"),i={q:this.get("query"),limit:this.get("limit")};return n.isEmpty(t)||n.extend(i,{context:t}),e=n.extend({type:"POST",with_form_key:!0,data:i},e),o.fetch.call(this,e)},parse:function(e,t){if(t&&t.xhr&&(e=(e||{}).response),n.isEmpty(e))throw new a("Invalid GIF search response",this.get("query"),e);return this.media.reset(e.media),delete e.media,e.ts=n.now(),e},toJSON:function(){var e=o.toJSON.apply(this,arguments);return e.media=this.media?this.media.toJSON():[],e}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(119),o=i(399),r=s.extend({model:o,previousFrom:function(e){return this.rotateFrom(e,-1)},nextFrom:function(e){return this.rotateFrom(e,1)},rotateFrom:function(e,t){for(var i=(n.isNumber(e)?this.at(e):this.findWhere({mediaUrl:e}))||this.sample(),s=this.indexOf(i)+t;0>s;)s+=this.length;return this.at(s%this.length)}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(114),o=i(198),r=s.extend({defaults:{mediaUrl:"",postUrl:"",rootPostUrl:"",rootPostUrlHash:"",rootBlog:"",rootBlogUrl:"",rootBlogKey:"",postTags:[],popularSearchTag:"",width:0,height:0},initialize:function(e,t){this.attributes={},this.set(n.defaults(o(e||{}),this.defaults))}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<p class="tmblr-attribution"><a href="'+(null==(__t=attributionUrl)?"":_.escape(__t))+'" target="_blank">'+(null==(__t=__("Originally posted by %1$s",attributionName))?"":_.escape(__t))+"</a></p>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(110),a=i(402),l=i(160),c=i(204),u=i(211),h=i(205),d=i(403),p=function(){},g=o.extend({className:"popover--mention-dropdown",defaults:{currentKeyedChoice:-1,currentMousedChoice:-1,interactive:!1,lastResults:{},debugMode:!1},mixins:[l,h,c,u],template:d,initialize:function(){this.model=new a,this.listenTo(this,"change:lastResults",this.preRender),p=n.bind(p,this)},preRender:function(e,t){var i=(t.blogs||[]).length;p("MentionDropdown - PreRender with %d results.",i),this.set({currentKeyedChoice:-1,currentMousedChoice:-1,interactive:!1}),i?(this._rendered&&this.teardown(!0),this.set("numSuggestions",i),this.render(t)):this.trigger("dropdown:empty")},render:function(e){return p("MentionDropdown - Render"),this.$el.html(this.template(e)),this.trigger("dropdown:render"),r.trigger("postForms:dismissListener:suspend"),this},afterRender:function(){s(".item-option",this.$el).on("mousedown",n.bind(this.handleMouseClick,this)),s(".item-option",this.$el).on("mouseover",n.bind(this.handleMouseOver,this)),this.$el.on("mouseout",n.bind(this.handleMouseOut,this))},teardown:function(e){return this.$el.remove(),e||this.set({interactive:!1,lastResults:{}}),r.trigger("postForms:dismissListener:resume"),this},updateMentionDropdown:function(e,t,i){p("MentionDropdown - fetch callback",t),this.set("lastResults",t)},cycleUp:function(){this._cycle(-1)},cycleDown:function(){this._cycle(1)},_cycle:function(e){var t=this.get("currentKeyedChoice"),i=this.get("currentMousedChoice"),s=n.isNumber(i)&&-1!==i,o=s?i:t,r=this.get("numSuggestions"),a=(o+e)%r;r&&(this.set({currentKeyedChoice:0>a?r-1:a,currentMousedChoice:-1}),this.styleMenuItems(),this.set("interactive",this.get("currentKeyedChoice")>=0),this.trigger("dropdown:menuInteraction",!0))},styleMenuItems:function(e){var t=e&&"mouseout"!==e.type,i=this.get("currentKeyedChoice");n.each(s(".item-option",this.$el),function(n,o){t?s(n).toggleClass("cycled",e.currentTarget===n):s(n).toggleClass("cycled",o===i)},this)},handleMouseOver:function(e){var t=s(e.currentTarget).index(".item-option");this.styleMenuItems(e),this.set({interactive:!0,currentMousedChoice:t}),this.trigger("dropdown:menuInteraction",!0)},handleMouseOut:function(e){var t=-1!==this.get("currentKeyedChoice");this.styleMenuItems(e),this.set({interactive:t,currentMousedChoice:-1}),this.trigger("dropdown:menuInteraction",t)},handleMouseClick:function(e){this.set("interactive",!0),s(e.currentTarget).addClass("cycled"),this.trigger("dropdown:confirm")},getCurrentBlogChoice:function(){var e=this.get("lastResults");if(!this._rendered||n.isEmpty(e)||!("blogs"in e))return!1;var t=this.get("currentMousedChoice"),i=this.get("currentKeyedChoice"),s=0;return t>=0?s=t:i>=0&&(s=i),e.blogs[s]},getBlogChoice:function(e){var t=this.get("lastResults");return!1===n.isEmpty(t)&&"blogs"in t&&t.blogs[e]?t.blogs[e]:!1}});e.exports=g},function(e,t,i){"use strict";var n=i(3),s=i(114),o=s.extend({defaults:{fetchOptions:{url:"/svc/mention",with_form_key:!0},suggestCache:{},queryHistory:[],maxCacheSize:20,maxSuggests:5,blogSuggestions:{}},fetch:function(e){"query"in e&&"success"in e&&n.isFunction(e.success)||console.error("Mention must be provided a query and a success callback.");var t=e.query;if(n.extend(e,this.get("fetchOptions")),t in this.get("suggestCache")){var i=this.get("suggestCache")[t];return this.set("blogSuggestions",i),e.success.call(this,this,i,e)}return e.data={q:t},s.prototype.fetch.call(this,e)},parse:function(e,t){var i=this._processQueryResults(e,t);return this._cacheQueryResults(i,t),i},_processQueryResults:function(e,t){var i=t.query;return n.extend(e,{queryRegex:this._escapeRegex(i)})},_cacheQueryResults:function(e,t){var i=n.clone(this.get("suggestCache")),s=n.clone(this.get("queryHistory"));i[t.query]=e,s.push(t.query),n.size(i)>this.get("maxCacheSize")&&(delete i[s[0]],s.shift()),this.set("suggestCache",i),this.set("queryHistory",s)},_escapeRegex:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|\~\`\!\@\#]/g,"\\$&")}});e.exports=o},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="pop-menu"><div class="inner"> ',_.each(blogs,function(e,t){__p+=" ";var i=e.name.replace(queryRegex,"<u>$&</u>");__p+=' <div id="mention_'+(null==(__t=t)?"":_.escape(__t))+'" class="item-option" data-tumblelog="'+(null==(__t=e.name)?"":_.escape(__t))+'"><div class="blog-info"><span class="blog-name">'+(null==(__t=i)?"":__t)+'</span><span class="blog-title">'+(null==(__t=e.title)?"":_.escape(__t))+'</span></div><span class="blog-thumb" style="background-image:url(\''+(null==(__t=e.avatar_url)?"":_.escape(__t))+"')\"></span></div> "}),__p+=" </div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(149),r=i(101),a=i(405),l=i(406),c=i(204),u=i(205),h=i(160),d=i(408),p=i(409),g=p.require("ace/mode/html").Mode,m=p.require("ace/mode/markdown").Mode,f=i(422),v=o.extend({mixins:[h,c,u],className:"html-field",events:{"click [data-js-editorHelp]":"_onClickEditorHelp","click [data-js-srcButton]":"_onClickSrcButton","click [data-js-previewButton]":"_onClickPreviewButton"},template:d,defaults:{name:"",editedSincePreview:!1,currentValue:"",htmlPreviewValue:null,markdownPreviewValue:null,isResizable:!1,isMarkdown:!1,wasFocused:!1,textareaClass:""},initialize:function(e){this.set(e),this.updateValueFromModel(),this.previewService=new a,this.tooltip=new l({className:"dropzone-tooltip-popover",text:r("Note that the dashboard doesn't display all HTML elements, but you're free to put them in your posts anyway.")}),this._renderPreview=s.bind(this.renderPreview,this)},_onClickEditorHelp:function(e){this.tooltip.isRendered()?this.tooltip.remove():this.tooltip.render()},_onClickSrcButton:function(e){this.showSource(!0)},_onClickPreviewButton:function(e){this.showPreview()},renderPreview:function(e,t){!s.isUndefined(e)||(e=this.get("currentValue")),!s.isUndefined(t)||(t=this.get("isMarkdown"));var i=this.get("htmlPreviewValue");this.get("editedSincePreview")||null==i?(this.js$("htmlPreview").html('<p style="text-align:center;"><b>'+r("Loading preview...")+"</b></p>"),this.previewService.filterForDash(e,t,s.bind(function(e){this.set(t?"markdownPreviewValue":"htmlPreviewValue",e),this.set("editedSincePreview",!1),this.js$("htmlPreview").html(e)},this),s.bind(function(){this.js$("htmlPreview").html('<p style="text-align:center;"><i>'+r("Failed to load preview :(")+"</i></p>")},this))):this.js$("htmlPreview").html(i)},teardown:function(){return this.stopListening(),this.$el.empty(),this.tooltip&&this.tooltip.remove(),this},serialize:function(){return{isMarkdown:this.get("isMarkdown"),srcLabel:r(this.get("isMarkdown")?"Markdown":"HTML"),previewLabel:r("Preview")}},beforeRender:function(){this.listenTo(this,"change:isMarkdown",function(e,t){this.js$("srcIcon").toggleClass("markdown",t).toggleClass("html",!t),this.js$("srcLabel").text(r(t?"Markdown":"HTML"));var i=t?m:g;this.editor.getSession().setMode(new i),this.setAriaLabel()})},setAriaLabel:function(){var e;this.editor&&this.editor.textInput&&(e=this.editor.textInput.getElement(),e&&n(e).attr("aria-label",r(this.get("isMarkdown")?"Markdown content":"HTML content")))},render:function(){return this.$el.html(this.template(this.serialize())),this.$el.attr("data-name",this.get("name")),this.tooltip.setPinnedTarget(this.js$("editorHelp")),this._initAce(this.js$("ace").get(0)),this.showSource(),this.updateEditor(),this.setAriaLabel(),this},hide:function(){this.$el.hide()},show:function(){this.$el.show(),this.updateEditor(),this.updatePreview()},focus:function(){this.editor&&n(this.editor.container).is(":visible")&&(this.get("wasFocused")||!function(e){s.defer(function(){e.blur(),s.defer(function(){e.focus()})}),e.blur()}(this.editor),this.editor.focus())},blur:function(){this.editor&&this.editor.blur()},updateValueFromModel:function(){this.set("currentValue",this.model.get(this.get("name"))||"")},showSource:function(e){this.js$("previewButton").removeClass("active"),this.js$("srcButton").addClass("active"),this.js$("previewView").hide(),this.js$("srcView").show(),e&&s.defer(s.bind(function(){this.focus()},this))},showPreview:function(){this.js$("srcButton").removeClass("active"),this.js$("previewButton").addClass("active"),this.updatePreview(),this.js$("srcView").hide(),this.js$("previewView").show()},updateEditor:function(){this.editor&&(this._ignoreAceChange=!0,this.editor.setValue(this.get("currentValue"),1),this._ignoreAceChange=!1)},updatePreview:function(){var e=this.get("currentValue");this._renderPreview(e)},_updateValueFromAce:function(e){var t=this.get("name"),i=this.model.get(t);this.set("editedSincePreview",!0),this.set("currentValue",e),this.model.set(t,e),this.model.set("htmlEdited",e&&i!==e)},_initAce:function(e){var t=this.editor=p.edit(e),i=t.getSession();i.setUseWorker(!1),i.setUseWrapMode(!0),i.setFoldStyle("manual"),i.on("change",s.bind(function(){this._ignoreAceChange||this._updateValueFromAce(i.getValue())},this)),i.setUseSoftTabs(!0),i.setTabSize(2);var n=this.get("isMarkdown")?m:g;i.setMode(new n),t.setTheme(f),t.setShowPrintMargin(!1),t.renderer.setShowGutter(!1),t.renderer.setPadding(20),t.renderer.setScrollMargin(20,20),t.setHighlightActiveLine(!1),t.setHighlightSelectedWord(!1),t.setBehavioursEnabled(!1),t.commands.removeCommands(["showSettingsMenu","goToNextError","goToPreviousError","centerselection","gotoline","fold","unfold","toggleFoldWidget","toggleParentFoldWidget","foldall","foldOther","unfoldall","findnext"," findprevious","selectOrFindNext","selectOrFindPrevious","find","overwrite","togglerecording","replaymacro","jumptomatching","selecttomatching","removeline","duplicateSelection","sortlines","togglecomment","toggleBlockComment","modifyNumberUp","modifyNumberDown","replace","copylinesup","movelinesup","copylinesdown","movelinesdown","cut_or_delete","blockoutdent","blockindent","splitline","transposeletters","touppercase","tolowercase","expandtoline","joinlines","inverSelection"]),t.commands.addCommand({name:"uncommand",bindKey:{win:"",mac:"Ctrl-A|Ctrl-B|Ctrl-D|Ctrl-E|Ctrl-F|Ctrl-H|Ctrl-K|Ctrl-N|Ctrl-P|Ctrl-V"},exec:function(e,t){return!0},readOnly:!0});var o=s.bind(function(){this.set("wasFocused",!0),t.off("focus",o)},this);t.on("focus",o),t.setOptions({autoScrollEditorIntoView:!0,maxLines:300})}});e.exports=v},function(e,t,i){"use strict";var n=i(3),s=i(9),o=function(){var e=function(e){if(!n.trim(e.html||""))return n.isFunction(e.done)&&e.done(""),void(n.isFunction(e.always)&&e.always(""));var t=s.ajax({url:"/svc/filter_html_for_dash_preview",type:"POST",with_form_key:!0,data:{html:e.html||"",markdown:e.isMarkdown?1:0}});return n.isFunction(e.done)&&t.done(e.done),n.isFunction(e.fail)&&t.fail(e.fail),n.isFunction(e.always)&&t.always(e.always),t};return{filterForDash:function(t,i,n,s,o){return e({html:t,isMarkdown:i,done:n,fail:s,always:o})},filterHtmlForDash:function(t,i,n,s){return e({html:t,isMarkdown:!1,done:i,fail:n,always:s})},filterMarkdownForDash:function(t,i,n,s){return e({html:t,isMarkdown:!0,done:i,fail:n,always:s})}}};e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(204),a=i(205),l=i(211),c=i(407),u=s.extend({className:"tooltip-popover",mixins:[o,r,a,l],template:c,defaults:{sanitize:!0,text:""},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults)))},serialize:function(){return this.toJSON()},render:function(){return this.$el.html(this.template(this.serialize())),this._popoverBase.pinnedSide="none",this._popoverBase.shift.x=4+this.$pinned.width(),this._popoverBase.shift.y=8,this},teardown:function(){return this.$el.remove(),this}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="tooltip-inner"> ',__p+=sanitize?" "+(null==(__t=text)?"":_.escape(__t))+" ":" "+(null==(__t=text)?"":__t)+" ",__p+=" </div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="html-mode"><div class="tabs clearfix"><div class="tab src-button" data-js-srcbutton><span class="icon '+(null==(__t=isMarkdown?"markdown":"html")?"":_.escape(__t))+'" data-js-srcicon></span><span class="tab-label" data-js-srclabel>'+(null==(__t=srcLabel)?"":_.escape(__t))+'</span></div><div class="tab preview-button" data-js-previewbutton><span class="icon"></span><span class="tab-label" data-js-previewlabel>'+(null==(__t=previewLabel)?"":_.escape(__t))+'</span></div><div class="tab tooltip-container"><span class="icon" data-js-editorhelp></span></div></div><div class="views"><div class="view src-view" data-js-srcview><div data-js-ace></div></div><div class="view preview-view" data-js-previewview><div class="html-preview editor" data-js-htmlpreview></div></div></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n="ace"in window,s=window.ace,o=i(410);i(412),i(415),i(416),i(417),i(418),i(420),i(421),o.require=o.acequire,n?window.ace=s:delete window.ace,e.exports=o},function(e,t,i){!function(){function e(e){var t=function(e,t){return s("",e,t)},o=i;e&&(i[e]||(i[e]={}),o=i[e]),o.define&&o.define.packaged||(n.original=o.define,o.define=n,o.define.packaged=!0),o.acequire&&o.acequire.packaged||(s.original=o.acequire,o.acequire=t,o.acequire.packaged=!0)}var t="ace",i=function(){return this}();if(t||"undefined"==typeof acequirejs){var n=function(e,t,i){return"string"!=typeof e?void(n.original?n.original.apply(window,arguments):(console.error("dropping module because define wasn't a string."),console.trace())):(2==arguments.length&&(i=t),n.modules||(n.modules={},n.payloads={}),n.payloads[e]=i,void(n.modules[e]=null))},s=function(e,t,i){if("[object Array]"===Object.prototype.toString.call(t)){for(var n=[],o=0,a=t.length;a>o;++o){var l=r(e,t[o]);if(!l&&s.original)return s.original.apply(window,arguments);n.push(l)}i&&i.apply(null,n)}else{if("string"==typeof t){var c=r(e,t);return!c&&s.original?s.original.apply(window,arguments):(i&&i(),c)}if(s.original)return s.original.apply(window,arguments)}},o=function(e,t){if(-1!==t.indexOf("!")){var i=t.split("!");return o(e,i[0])+"!"+o(e,i[1])}if("."==t.charAt(0)){var n=e.split("/").slice(0,-1).join("/");for(t=n+"/"+t;-1!==t.indexOf(".")&&s!=t;){var s=t;t=t.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}}return t},r=function(e,t){t=o(e,t);var i=n.modules[t];if(!i){if(i=n.payloads[t],"function"==typeof i){var r={},a={id:t,uri:"",exports:r,packaged:!0},l=function(e,i){return s(t,e,i)},c=i(l,r,a);r=c||a.exports,n.modules[t]=r,delete n.payloads[t]}i=n.modules[t]=r||i}return i};e(t)}}(),ace.define("ace/lib/regexp",["require","exports","module"],function(e,t,i){"use strict";function n(e){return(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":"")}function s(e,t,i){if(Array.prototype.indexOf)return e.indexOf(t,i);for(var n=i||0;n<e.length;n++)if(e[n]===t)return n;return-1}var o={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},r=void 0===o.exec.call(/()??/,"")[1],a=function(){var e=/^/g;return o.test.call(e,""),!e.lastIndex}();a&&r||(RegExp.prototype.exec=function(e){var t,i,l=o.exec.apply(this,arguments);if("string"==typeof e&&l){if(!r&&l.length>1&&s(l,"")>-1&&(i=RegExp(this.source,o.replace.call(n(this),"g","")),o.replace.call(e.slice(l.index),i,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(l[e]=void 0)})),this._xregexp&&this._xregexp.captureNames)for(var c=1;c<l.length;c++)t=this._xregexp.captureNames[c-1],t&&(l[t]=l[c]);!a&&this.global&&!l[0].length&&this.lastIndex>l.index&&this.lastIndex--}return l},a||(RegExp.prototype.test=function(e){var t=o.exec.call(this,e);return t&&this.global&&!t[0].length&&this.lastIndex>t.index&&this.lastIndex--,!!t}))}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(e,t,i){function n(){}function s(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(t){}}function o(e){return e=+e,e!==e?e=0:0!==e&&e!==1/0&&e!==-(1/0)&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError("Function.prototype.bind called on incompatible "+t);var i=g.call(arguments,1),s=function(){if(this instanceof s){var n=t.apply(this,i.concat(g.call(arguments)));return Object(n)===n?n:this}return t.apply(e,i.concat(g.call(arguments)))};return t.prototype&&(n.prototype=t.prototype,s.prototype=new n,n.prototype=null),s});var r,a,l,c,u,h=Function.prototype.call,d=Array.prototype,p=Object.prototype,g=d.slice,m=h.bind(p.toString),f=h.bind(p.hasOwnProperty);if((u=f(p,"__defineGetter__"))&&(r=h.bind(p.__defineGetter__),a=h.bind(p.__defineSetter__),l=h.bind(p.__lookupGetter__),c=h.bind(p.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function e(e){var t=new Array(e+2);return t[0]=t[1]=0,t}var t,i=[];return i.splice.apply(i,e(20)),i.splice.apply(i,e(26)),t=i.length,i.splice(5,0,"XXX"),t+1==i.length,t+1==i.length?!0:void 0}()){var v=Array.prototype.splice;Array.prototype.splice=function(e,t){return arguments.length?v.apply(this,[void 0===e?0:e,void 0===t?this.length-e:t].concat(g.call(arguments,2))):[]}}else Array.prototype.splice=function(e,t){var i=this.length;e>0?e>i&&(e=i):void 0==e?e=0:0>e&&(e=Math.max(i+e,0)),i>e+t||(t=i-e);var n=this.slice(e,e+t),s=g.call(arguments,2),o=s.length;if(e===i)o&&this.push.apply(this,s);else{var r=Math.min(t,i-e),a=e+r,l=a+o-r,c=i-a,u=i-r;if(a>l)for(var h=0;c>h;++h)this[l+h]=this[a+h];else if(l>a)for(h=c;h--;)this[l+h]=this[a+h];if(o&&e===u)this.length=u,this.push.apply(this,s);else for(this.length=u+o,h=0;o>h;++h)this[e+h]=s[h]}return n};Array.isArray||(Array.isArray=function(e){return"[object Array]"==m(e)});var _=Object("a"),b="a"!=_[0]||!(0 in _);if(Array.prototype.forEach||(Array.prototype.forEach=function(e){var t=M(this),i=b&&"[object String]"==m(this)?this.split(""):t,n=arguments[1],s=-1,o=i.length>>>0;if("[object Function]"!=m(e))throw new TypeError;for(;++s<o;)s in i&&e.call(n,i[s],s,t)}),Array.prototype.map||(Array.prototype.map=function(e){var t=M(this),i=b&&"[object String]"==m(this)?this.split(""):t,n=i.length>>>0,s=Array(n),o=arguments[1];if("[object Function]"!=m(e))throw new TypeError(e+" is not a function");for(var r=0;n>r;r++)r in i&&(s[r]=e.call(o,i[r],r,t));return s}),Array.prototype.filter||(Array.prototype.filter=function(e){var t,i=M(this),n=b&&"[object String]"==m(this)?this.split(""):i,s=n.length>>>0,o=[],r=arguments[1];if("[object Function]"!=m(e))throw new TypeError(e+" is not a function");for(var a=0;s>a;a++)a in n&&(t=n[a],e.call(r,t,a,i)&&o.push(t));return o}),Array.prototype.every||(Array.prototype.every=function(e){var t=M(this),i=b&&"[object String]"==m(this)?this.split(""):t,n=i.length>>>0,s=arguments[1];if("[object Function]"!=m(e))throw new TypeError(e+" is not a function");for(var o=0;n>o;o++)if(o in i&&!e.call(s,i[o],o,t))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e){var t=M(this),i=b&&"[object String]"==m(this)?this.split(""):t,n=i.length>>>0,s=arguments[1];if("[object Function]"!=m(e))throw new TypeError(e+" is not a function");for(var o=0;n>o;o++)if(o in i&&e.call(s,i[o],o,t))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e){var t=M(this),i=b&&"[object String]"==m(this)?this.split(""):t,n=i.length>>>0;if("[object Function]"!=m(e))throw new TypeError(e+" is not a function");if(!n&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var s,o=0;if(arguments.length>=2)s=arguments[1];else for(;;){if(o in i){s=i[o++];break}if(++o>=n)throw new TypeError("reduce of empty array with no initial value")}for(;n>o;o++)o in i&&(s=e.call(void 0,s,i[o],o,t));return s}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){var t=M(this),i=b&&"[object String]"==m(this)?this.split(""):t,n=i.length>>>0;if("[object Function]"!=m(e))throw new TypeError(e+" is not a function");if(!n&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var s,o=n-1;if(arguments.length>=2)s=arguments[1];else for(;;){if(o in i){s=i[o--];break}if(--o<0)throw new TypeError("reduceRight of empty array with no initial value")}do o in this&&(s=e.call(void 0,s,i[o],o,t));while(o--);return s}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(e){var t=b&&"[object String]"==m(this)?this.split(""):M(this),i=t.length>>>0;if(!i)return-1;var n=0;for(arguments.length>1&&(n=o(arguments[1])),n=n>=0?n:Math.max(0,i+n);i>n;n++)if(n in t&&t[n]===e)return n;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(e){var t=b&&"[object String]"==m(this)?this.split(""):M(this),i=t.length>>>0;if(!i)return-1;var n=i-1;for(arguments.length>1&&(n=Math.min(n,o(arguments[1]))),n=n>=0?n:i-Math.abs(n);n>=0;n--)if(n in t&&e===t[n])return n;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__||(e.constructor?e.constructor.prototype:p)}),!Object.getOwnPropertyDescriptor){var w="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(e,t){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError(w+e);if(f(e,t)){var i,n,s;if(i={enumerable:!0,configurable:!0},u){var o=e.__proto__;e.__proto__=p;var n=l(e,t),s=c(e,t);if(e.__proto__=o,n||s)return n&&(i.get=n),s&&(i.set=s),i}return i.value=e[t],i}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),!Object.create){var y;y=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var e={};for(var t in e)e[t]=null;return e.constructor=e.hasOwnProperty=e.propertyIsEnumerable=e.isPrototypeOf=e.toLocaleString=e.toString=e.valueOf=e.__proto__=null,e},Object.create=function(e,t){var i;if(null===e)i=y();else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");var n=function(){};n.prototype=e,i=new n,i.__proto__=e}return void 0!==t&&Object.defineProperties(i,t),i}}if(Object.defineProperty){var k=s({}),x="undefined"==typeof document||s(document.createElement("div"));if(!k||!x)var C=Object.defineProperty}if(!Object.defineProperty||C){var S="Property description must be an object: ",E="Object.defineProperty called on non-object: ",T="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(e,t,i){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError(E+e);if("object"!=typeof i&&"function"!=typeof i||null===i)throw new TypeError(S+i);if(C)try{return C.call(Object,e,t,i)}catch(n){}if(f(i,"value"))if(u&&(l(e,t)||c(e,t))){var s=e.__proto__;e.__proto__=p,delete e[t],e[t]=i.value,e.__proto__=s}else e[t]=i.value;else{if(!u)throw new TypeError(T);f(i,"get")&&r(e,t,i.get),f(i,"set")&&a(e,t,i.set)}return e}}Object.defineProperties||(Object.defineProperties=function(e,t){for(var i in t)f(t,i)&&Object.defineProperty(e,i,t[i]);return e}),Object.seal||(Object.seal=function(e){return e}),Object.freeze||(Object.freeze=function(e){return e});try{Object.freeze(function(){})}catch(A){Object.freeze=function(e){return function(t){return"function"==typeof t?t:e(t)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(e){return e}),Object.isSealed||(Object.isSealed=function(e){return!1}),Object.isFrozen||(Object.isFrozen=function(e){return!1}),Object.isExtensible||(Object.isExtensible=function(e){if(Object(e)===e)throw new TypeError;for(var t="";f(e,t);)t+="?";e[t]=!0;var i=f(e,t);return delete e[t],i}),!Object.keys){var F=!0,R=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],L=R.length;for(var $ in{toString:null})F=!1;Object.keys=function B(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var B=[];for(var t in e)f(e,t)&&B.push(t);if(F)for(var i=0,n=L;n>i;i++){var s=R[i];f(e,s)&&B.push(s)}return B}}Date.now||(Date.now=function(){return(new Date).getTime()});var D="	\n\x0B\f\r \u2028\u2029\ufeff";if(!String.prototype.trim||D.trim()){D="["+D+"]";var P=new RegExp("^"+D+D+"*"),I=new RegExp(D+D+"*$");String.prototype.trim=function(){return String(this).replace(P,"").replace(I,"")}}var M=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)}}),ace.define("ace/lib/fixoldbrowsers",["require","exports","module","ace/lib/regexp","ace/lib/es5-shim"],function(e,t,i){"use strict";e("./regexp"),e("./es5-shim")}),ace.define("ace/lib/dom",["require","exports","module"],function(e,t,i){
"use strict";if("undefined"!=typeof document){var n="http://www.w3.org/1999/xhtml";t.getDocumentHead=function(e){return e||(e=document),e.head||e.getElementsByTagName("head")[0]||e.documentElement},t.createElement=function(e,t){return document.createElementNS?document.createElementNS(t||n,e):document.createElement(e)},t.hasCssClass=function(e,t){var i=e.className.split(/\s+/g);return-1!==i.indexOf(t)},t.addCssClass=function(e,i){t.hasCssClass(e,i)||(e.className+=" "+i)},t.removeCssClass=function(e,t){for(var i=e.className.split(/\s+/g);;){var n=i.indexOf(t);if(-1==n)break;i.splice(n,1)}e.className=i.join(" ")},t.toggleCssClass=function(e,t){for(var i=e.className.split(/\s+/g),n=!0;;){var s=i.indexOf(t);if(-1==s)break;n=!1,i.splice(s,1)}return n&&i.push(t),e.className=i.join(" "),n},t.setCssClass=function(e,i,n){n?t.addCssClass(e,i):t.removeCssClass(e,i)},t.hasCssString=function(e,t){var i,n=0;if(t=t||document,t.createStyleSheet&&(i=t.styleSheets)){for(;n<i.length;)if(i[n++].owningElement.id===e)return!0}else if(i=t.getElementsByTagName("style"))for(;n<i.length;)if(i[n++].id===e)return!0;return!1},t.importCssString=function(e,i,s){if(s=s||document,i&&t.hasCssString(i,s))return null;var o;s.createStyleSheet?(o=s.createStyleSheet(),o.cssText=e,i&&(o.owningElement.id=i)):(o=s.createElementNS?s.createElementNS(n,"style"):s.createElement("style"),o.appendChild(s.createTextNode(e)),i&&(o.id=i),t.getDocumentHead(s).appendChild(o))},t.importCssStylsheet=function(e,i){if(i.createStyleSheet)i.createStyleSheet(e);else{var n=t.createElement("link");n.rel="stylesheet",n.href=e,t.getDocumentHead(i).appendChild(n)}},t.getInnerWidth=function(e){return parseInt(t.computedStyle(e,"paddingLeft"),10)+parseInt(t.computedStyle(e,"paddingRight"),10)+e.clientWidth},t.getInnerHeight=function(e){return parseInt(t.computedStyle(e,"paddingTop"),10)+parseInt(t.computedStyle(e,"paddingBottom"),10)+e.clientHeight},void 0!==window.pageYOffset?(t.getPageScrollTop=function(){return window.pageYOffset},t.getPageScrollLeft=function(){return window.pageXOffset}):(t.getPageScrollTop=function(){return document.body.scrollTop},t.getPageScrollLeft=function(){return document.body.scrollLeft}),window.getComputedStyle?t.computedStyle=function(e,t){return t?(window.getComputedStyle(e,"")||{})[t]||"":window.getComputedStyle(e,"")||{}}:t.computedStyle=function(e,t){return t?e.currentStyle[t]:e.currentStyle},t.scrollbarWidth=function(e){var i=t.createElement("ace_inner");i.style.width="100%",i.style.minWidth="0px",i.style.height="200px",i.style.display="block";var n=t.createElement("ace_outer"),s=n.style;s.position="absolute",s.left="-10000px",s.overflow="hidden",s.width="200px",s.minWidth="0px",s.height="150px",s.display="block",n.appendChild(i);var o=e.documentElement;o.appendChild(n);var r=i.offsetWidth;s.overflow="scroll";var a=i.offsetWidth;return r==a&&(a=n.clientWidth),o.removeChild(n),r-a},t.setInnerHtml=function(e,t){var i=e.cloneNode(!1);return i.innerHTML=t,e.parentNode.replaceChild(i,e),i},"textContent"in document.documentElement?(t.setInnerText=function(e,t){e.textContent=t},t.getInnerText=function(e){return e.textContent}):(t.setInnerText=function(e,t){e.innerText=t},t.getInnerText=function(e){return e.innerText}),t.getParentWindow=function(e){return e.defaultView||e.parentWindow}}}),ace.define("ace/lib/oop",["require","exports","module"],function(e,t,i){"use strict";t.inherits=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},t.mixin=function(e,t){for(var i in t)e[i]=t[i];return e},t.implement=function(e,i){t.mixin(e,i)}}),ace.define("ace/lib/keys",["require","exports","module","ace/lib/oop"],function(e,t,i){"use strict";var n=e("./oop"),s=function(){var e,t,i={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,"super":8,meta:8,command:8,cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}};for(t in i.FUNCTION_KEYS)e=i.FUNCTION_KEYS[t].toLowerCase(),i[e]=parseInt(t,10);for(t in i.PRINTABLE_KEYS)e=i.PRINTABLE_KEYS[t].toLowerCase(),i[e]=parseInt(t,10);return n.mixin(i,i.MODIFIER_KEYS),n.mixin(i,i.PRINTABLE_KEYS),n.mixin(i,i.FUNCTION_KEYS),i.enter=i["return"],i.escape=i.esc,i.del=i["delete"],i[173]="-",function(){for(var e=["cmd","ctrl","alt","shift"],t=Math.pow(2,e.length);t--;)i.KEY_MODS[t]=e.filter(function(e){return t&i.KEY_MODS[e]}).join("-")+"-"}(),i}();n.mixin(t,s),t.keyCodeToString=function(e){var t=s[e];return"string"!=typeof t&&(t=String.fromCharCode(e)),t.toLowerCase()}}),ace.define("ace/lib/useragent",["require","exports","module"],function(e,t,i){"use strict";if(t.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},t.getOS=function(){return t.isMac?t.OS.MAC:t.isLinux?t.OS.LINUX:t.OS.WINDOWS},"object"==typeof navigator){var n=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),s=navigator.userAgent;t.isWin="win"==n,t.isMac="mac"==n,t.isLinux="linux"==n,t.isIE="Microsoft Internet Explorer"==navigator.appName||navigator.appName.indexOf("MSAppHost")>=0?parseFloat((s.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((s.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),t.isOldIE=t.isIE&&t.isIE<9,t.isGecko=t.isMozilla=(window.Controllers||window.controllers)&&"Gecko"===window.navigator.product,t.isOldGecko=t.isGecko&&parseInt((s.match(/rv\:(\d+)/)||[])[1],10)<4,t.isOpera=window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),t.isWebKit=parseFloat(s.split("WebKit/")[1])||void 0,t.isChrome=parseFloat(s.split(" Chrome/")[1])||void 0,t.isAIR=s.indexOf("AdobeAIR")>=0,t.isIPad=s.indexOf("iPad")>=0,t.isTouchPad=s.indexOf("TouchPad")>=0,t.isChromeOS=s.indexOf(" CrOS ")>=0}}),ace.define("ace/lib/event",["require","exports","module","ace/lib/keys","ace/lib/useragent"],function(e,t,i){"use strict";function n(e,t,i){var n=r(t);if(!o.isMac&&a){if((a[91]||a[92])&&(n|=8),a.altGr){if(3==(3&n))return;a.altGr=0}if(18===i||17===i){var c=t.location||t.keyLocation;if(17===i&&1===c)l=t.timeStamp;else if(18===i&&3===n&&2===c){var u=-l;l=t.timeStamp,u+=l,3>u&&(a.altGr=!0)}}}if(i in s.MODIFIER_KEYS){switch(s.MODIFIER_KEYS[i]){case"Alt":n=2;break;case"Shift":n=4;break;case"Ctrl":n=1;break;default:n=8}i=-1}if(8&n&&(91===i||93===i)&&(i=-1),n||13!==i||!t.location&&3!==t.keyLocation||(e(t,n,-i),!t.defaultPrevented)){if(o.isChromeOS&&8&n){if(e(t,n,i),t.defaultPrevented)return;n&=-9}return n||i in s.FUNCTION_KEYS||i in s.PRINTABLE_KEYS?e(t,n,i):!1}}var s=e("./keys"),o=e("./useragent");t.addListener=function(e,t,i){if(e.addEventListener)return e.addEventListener(t,i,!1);if(e.attachEvent){var n=function(){i.call(e,window.event)};i._wrapper=n,e.attachEvent("on"+t,n)}},t.removeListener=function(e,t,i){return e.removeEventListener?e.removeEventListener(t,i,!1):void(e.detachEvent&&e.detachEvent("on"+t,i._wrapper||i))},t.stopEvent=function(e){return t.stopPropagation(e),t.preventDefault(e),!1},t.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},t.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},t.getButton=function(e){return"dblclick"==e.type?0:"contextmenu"==e.type||o.isMac&&e.ctrlKey&&!e.altKey&&!e.shiftKey?2:e.preventDefault?e.button:{1:0,2:2,4:1}[e.button]},t.capture=function(e,i,n){function s(e){i&&i(e),n&&n(e),t.removeListener(document,"mousemove",i,!0),t.removeListener(document,"mouseup",s,!0),t.removeListener(document,"dragstart",s,!0)}return t.addListener(document,"mousemove",i,!0),t.addListener(document,"mouseup",s,!0),t.addListener(document,"dragstart",s,!0),s},t.addMouseWheelListener=function(e,i){"onmousewheel"in e?t.addListener(e,"mousewheel",function(e){var t=8;void 0!==e.wheelDeltaX?(e.wheelX=-e.wheelDeltaX/t,e.wheelY=-e.wheelDeltaY/t):(e.wheelX=0,e.wheelY=-e.wheelDelta/t),i(e)}):"onwheel"in e?t.addListener(e,"wheel",function(e){var t=.35;switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=e.deltaX*t||0,e.wheelY=e.deltaY*t||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=5*(e.deltaX||0),e.wheelY=5*(e.deltaY||0)}i(e)}):t.addListener(e,"DOMMouseScroll",function(e){e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=5*(e.detail||0),e.wheelY=0):(e.wheelX=0,e.wheelY=5*(e.detail||0)),i(e)})},t.addMultiMouseDownListener=function(e,i,n,s){var r,a,l,c=0,u={2:"dblclick",3:"tripleclick",4:"quadclick"};t.addListener(e,"mousedown",function(e){if(0!==t.getButton(e)?c=0:e.detail>1?(c++,c>4&&(c=1)):c=1,o.isIE){var h=Math.abs(e.clientX-r)>5||Math.abs(e.clientY-a)>5;l&&!h||(c=1),l&&clearTimeout(l),l=setTimeout(function(){l=null},i[c-1]||600),1==c&&(r=e.clientX,a=e.clientY)}if(n[s]("mousedown",e),c>4)c=0;else if(c>1)return n[s](u[c],e)}),o.isOldIE&&t.addListener(e,"dblclick",function(e){c=2,l&&clearTimeout(l),l=setTimeout(function(){l=null},i[c-1]||600),n[s]("mousedown",e),n[s](u[c],e)})};var r=!o.isMac||!o.isOpera||"KeyboardEvent"in window?function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)}:function(e){return 0|(e.metaKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.ctrlKey?8:0)};t.getModifierString=function(e){return s.KEY_MODS[r(e)]};var a=null,l=0;if(t.addCommandKeyListener=function(e,i){var s=t.addListener;if(o.isOldGecko||o.isOpera&&!("KeyboardEvent"in window)){var r=null;s(e,"keydown",function(e){r=e.keyCode}),s(e,"keypress",function(e){return n(i,e,r)})}else{var l=null;s(e,"keydown",function(e){a[e.keyCode]=!0;var t=n(i,e,e.keyCode);return l=e.defaultPrevented,t}),s(e,"keypress",function(e){l&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(t.stopEvent(e),l=null)}),s(e,"keyup",function(e){a[e.keyCode]=null}),a||(a=Object.create(null),s(window,"focus",function(e){a=Object.create(null)}))}},window.postMessage&&!o.isOldIE){var c=1;t.nextTick=function(e,i){i=i||window;var n="zero-timeout-message-"+c;t.addListener(i,"message",function s(o){o.data==n&&(t.stopPropagation(o),t.removeListener(i,"message",s),e())}),i.postMessage(n,"*")}}t.nextFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,t.nextFrame?t.nextFrame=t.nextFrame.bind(window):t.nextFrame=function(e){setTimeout(e,17)}}),ace.define("ace/lib/lang",["require","exports","module"],function(e,t,i){"use strict";t.last=function(e){return e[e.length-1]},t.stringReverse=function(e){return e.split("").reverse().join("")},t.stringRepeat=function(e,t){for(var i="";t>0;)1&t&&(i+=e),(t>>=1)&&(e+=e);return i};var n=/^\s\s*/,s=/\s\s*$/;t.stringTrimLeft=function(e){return e.replace(n,"")},t.stringTrimRight=function(e){return e.replace(s,"")},t.copyObject=function(e){var t={};for(var i in e)t[i]=e[i];return t},t.copyArray=function(e){for(var t=[],i=0,n=e.length;n>i;i++)e[i]&&"object"==typeof e[i]?t[i]=this.copyObject(e[i]):t[i]=e[i];return t},t.deepCopy=function(e){if("object"!=typeof e||!e)return e;var i=e.constructor;if(i===RegExp)return e;var n=i();for(var s in e)"object"==typeof e[s]?n[s]=t.deepCopy(e[s]):n[s]=e[s];return n},t.arrayToMap=function(e){for(var t={},i=0;i<e.length;i++)t[e[i]]=1;return t},t.createMap=function(e){var t=Object.create(null);for(var i in e)t[i]=e[i];return t},t.arrayRemove=function(e,t){for(var i=0;i<=e.length;i++)t===e[i]&&e.splice(i,1)},t.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},t.escapeHTML=function(e){return e.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},t.getMatchOffsets=function(e,t){var i=[];return e.replace(t,function(e){i.push({offset:arguments[arguments.length-2],length:e.length})}),i},t.deferredCall=function(e){var t=null,i=function(){t=null,e()},n=function(e){return n.cancel(),t=setTimeout(i,e||0),n};return n.schedule=n,n.call=function(){return this.cancel(),e(),n},n.cancel=function(){return clearTimeout(t),t=null,n},n.isPending=function(){return t},n},t.delayedCall=function(e,t){var i=null,n=function(){i=null,e()},s=function(e){null==i&&(i=setTimeout(n,e||t))};return s.delay=function(e){i&&clearTimeout(i),i=setTimeout(n,e||t)},s.schedule=s,s.call=function(){this.cancel(),e()},s.cancel=function(){i&&clearTimeout(i),i=null},s.isPending=function(){return i},s}}),ace.define("ace/keyboard/textinput",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang"],function(e,t,i){"use strict";var n=e("../lib/event"),s=e("../lib/useragent"),o=e("../lib/dom"),r=e("../lib/lang"),a=s.isChrome<18,l=s.isIE,c=function(e,t){function i(e){if(!m){if(A)t=0,i=e?0:h.value.length-1;else var t=e?2:1,i=2;try{h.setSelectionRange(t,i)}catch(n){}}}function c(){m||(h.value=d,s.isWebKit&&y.schedule())}function u(){setTimeout(function(){f&&(h.style.cssText=f,f=""),null==t.renderer.$keepTextAreaAtCursor&&(t.renderer.$keepTextAreaAtCursor=!0,t.renderer.$moveTextAreaToCursor())},0)}var h=o.createElement("textarea");h.className="ace_text-input",s.isTouchPad&&h.setAttribute("x-palm-disable-auto-cap",!0),h.wrap="off",h.autocorrect="off",h.autocapitalize="off",h.spellcheck=!1,h.style.opacity="0",e.insertBefore(h,e.firstChild);var d="",p=!1,g=!1,m=!1,f="",v=!0;try{var _=document.activeElement===h}catch(b){}n.addListener(h,"blur",function(){t.onBlur(),_=!1}),n.addListener(h,"focus",function(){_=!0,t.onFocus(),i()}),this.focus=function(){h.focus()},this.blur=function(){h.blur()},this.isFocused=function(){return _};var w=r.delayedCall(function(){_&&i(v)}),y=r.delayedCall(function(){m||(h.value=d,_&&i())});s.isWebKit||t.addEventListener("changeSelection",function(){t.selection.isEmpty()!=v&&(v=!v,w.schedule())}),c(),_&&t.onFocus();var k=function(e){return 0===e.selectionStart&&e.selectionEnd===e.value.length};if(!h.setSelectionRange&&h.createTextRange&&(h.setSelectionRange=function(e,t){var i=this.createTextRange();i.collapse(!0),i.moveStart("character",e),i.moveEnd("character",t),i.select()},k=function(e){try{var t=e.ownerDocument.selection.createRange()}catch(i){}return t&&t.parentElement()==e?t.text==e.value:!1}),s.isOldIE){var x=!1,C=function(e){if(!x){var t=h.value;if(!m&&t&&t!=d){if(e&&t==d[0])return S.schedule();R(t),x=!0,c(),x=!1}}},S=r.delayedCall(C);n.addListener(h,"propertychange",C);var E={13:1,27:1};n.addListener(h,"keyup",function(e){return!m||h.value&&!E[e.keyCode]||setTimeout(j,0),(h.value.charCodeAt(0)||0)<129?S.call():void(m?O():B())}),n.addListener(h,"keydown",function(e){S.schedule(50)})}var T=function(e){p?p=!1:k(h)?(t.selectAll(),i()):A&&i(t.selection.isEmpty())},A=null;this.setInputHandler=function(e){A=e},this.getInputHandler=function(){return A};var F=!1,R=function(e){A&&(e=A(e),A=null),g?(i(),e&&t.onPaste(e),g=!1):e==d.charAt(0)?F?t.execCommand("del",{source:"ace"}):t.execCommand("backspace",{source:"ace"}):(e.substring(0,2)==d?e=e.substr(2):e.charAt(0)==d.charAt(0)?e=e.substr(1):e.charAt(e.length-1)==d.charAt(0)&&(e=e.slice(0,-1)),e.charAt(e.length-1)==d.charAt(0)&&(e=e.slice(0,-1)),e&&t.onTextInput(e)),F&&(F=!1)},L=function(e){if(!m){var t=h.value;R(t),c()}},$=function(e,t){var i=e.clipboardData||window.clipboardData;if(i&&!a){var n=l?"Text":"text/plain";return t?i.setData(n,t)!==!1:i.getData(n)}},D=function(e,s){var o=t.getCopyText();return o?void($(e,o)?(s?t.onCut():t.onCopy(),n.preventDefault(e)):(p=!0,h.value=o,h.select(),setTimeout(function(){p=!1,c(),i(),s?t.onCut():t.onCopy()}))):n.preventDefault(e)},P=function(e){D(e,!0)},I=function(e){D(e,!1)},M=function(e){var o=$(e);"string"==typeof o?(o&&t.onPaste(o),s.isIE&&setTimeout(i),n.preventDefault(e)):(h.value="",g=!0)};n.addCommandKeyListener(h,t.onCommandKey.bind(t)),n.addListener(h,"select",T),n.addListener(h,"input",L),n.addListener(h,"cut",P),n.addListener(h,"copy",I),n.addListener(h,"paste",M),"oncut"in h&&"oncopy"in h&&"onpaste"in h||n.addListener(e,"keydown",function(e){if((!s.isMac||e.metaKey)&&e.ctrlKey)switch(e.keyCode){case 67:I(e);break;case 86:M(e);break;case 88:P(e)}});var B=function(e){!m&&t.onCompositionStart&&(m={},t.onCompositionStart(),setTimeout(O,0),t.on("mousedown",j),t.selection.isEmpty()||(t.insert(""),t.session.markUndoGroup(),t.selection.clearSelection()),t.session.markUndoGroup())},O=function(){if(m&&t.onCompositionUpdate){var e=h.value.replace(/\x01/g,"");if(m.lastValue!==e&&(t.onCompositionUpdate(e),m.lastValue&&t.undo(),m.lastValue=e,m.lastValue)){var i=t.selection.getRange();t.insert(m.lastValue),t.session.markUndoGroup(),m.range=t.selection.getRange(),t.selection.setRange(i),t.selection.clearSelection()}}},j=function(e){if(t.onCompositionEnd){var i=m;m=!1;var n=setTimeout(function(){n=null;var e=h.value.replace(/\x01/g,"");m||(e==i.lastValue?c():!i.lastValue&&e&&(c(),R(e)))});A=function(e){return n&&clearTimeout(n),e=e.replace(/\x01/g,""),e==i.lastValue?"":(i.lastValue&&n&&t.undo(),e)},t.onCompositionEnd(),t.removeListener("mousedown",j),"compositionend"==e.type&&i.range&&t.selection.setRange(i.range)}},N=r.delayedCall(O,50);if(n.addListener(h,"compositionstart",B),s.isGecko?n.addListener(h,"text",function(){N.schedule()}):(n.addListener(h,"keyup",function(){N.schedule()}),n.addListener(h,"keydown",function(){N.schedule()})),n.addListener(h,"compositionend",j),this.getElement=function(){return h},this.setReadOnly=function(e){h.readOnly=e},this.onContextMenu=function(e){F=!0,f||(f=h.style.cssText),h.style.cssText="z-index:100000;"+(s.isIE?"opacity:0.1;":""),i(t.selection.isEmpty()),t._emit("nativecontextmenu",{target:t,domEvent:e});var r=t.container.getBoundingClientRect(),a=o.computedStyle(t.container),l=r.top+(parseInt(a.borderTopWidth)||0),c=r.left+(parseInt(r.borderLeftWidth)||0),d=r.bottom-l-h.clientHeight,p=function(e){h.style.left=e.clientX-c-2+"px",h.style.top=Math.min(e.clientY-l-2,d)+"px"};p(e),"mousedown"==e.type&&(t.renderer.$keepTextAreaAtCursor&&(t.renderer.$keepTextAreaAtCursor=null),s.isWin&&n.capture(t.container,p,u))},this.onContextMenuClose=u,!s.isGecko||s.isMac){var V=function(e){t.textInput.onContextMenu(e),u()};n.addListener(t.renderer.scroller,"contextmenu",V),n.addListener(h,"contextmenu",V)}};t.TextInput=c}),ace.define("ace/mouse/default_handlers",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],function(e,t,i){"use strict";function n(e){e.$clickSelection=null;var t=e.editor;t.setDefaultHandler("mousedown",this.onMouseDown.bind(e)),t.setDefaultHandler("dblclick",this.onDoubleClick.bind(e)),t.setDefaultHandler("tripleclick",this.onTripleClick.bind(e)),t.setDefaultHandler("quadclick",this.onQuadClick.bind(e)),t.setDefaultHandler("mousewheel",this.onMouseWheel.bind(e));var i=["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"];i.forEach(function(t){e[t]=this[t]},this),e.selectByLines=this.extendSelectionBy.bind(e,"getLineRange"),e.selectByWords=this.extendSelectionBy.bind(e,"getWordRange")}function s(e,t,i,n){return Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))}function o(e,t){if(e.start.row==e.end.row)var i=2*t.column-e.start.column-e.end.column;else if(e.start.row!=e.end.row-1||e.start.column||e.end.column)var i=2*t.row-e.start.row-e.end.row;else var i=t.column-4;return 0>i?{cursor:e.start,anchor:e.end}:{cursor:e.end,anchor:e.start}}var r=(e("../lib/dom"),e("../lib/event"),e("../lib/useragent"),0);(function(){this.onMouseDown=function(e){var t=e.inSelection(),i=e.getDocumentPosition();this.mousedownEvent=e;var n=this.editor,s=e.getButton();if(0!==s){var o=n.getSelectionRange(),r=o.isEmpty();return r&&n.selection.moveToPosition(i),void n.textInput.onContextMenu(e.domEvent)}return!t||n.isFocused()||(n.focus(),!this.$focusTimout||this.$clickSelection||n.inMultiSelectMode)?(this.captureMouse(e),!t||this.$clickSelection||e.getShiftKey()||n.inMultiSelectMode?this.startSelect(i):t&&(this.mousedownEvent.time=Date.now(),this.startSelect(i)),e.preventDefault()):(this.mousedownEvent.time=Date.now(),this.setState("focusWait"),void this.captureMouse(e))},this.startSelect=function(e){e=e||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var t=this.editor,i=this.mousedownEvent.getShiftKey();setTimeout(function(){i?t.selection.selectToPosition(e):this.$clickSelection||t.selection.moveToPosition(e),this.select()}.bind(this),0),t.renderer.scroller.setCapture&&t.renderer.scroller.setCapture(),t.setStyle("ace_selecting"),this.setState("select")},this.select=function(){var e,t=this.editor,i=t.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){var n=this.$clickSelection.comparePoint(i);if(-1==n)e=this.$clickSelection.end;else if(1==n)e=this.$clickSelection.start;else{var s=o(this.$clickSelection,i);i=s.cursor,e=s.anchor}t.selection.setSelectionAnchor(e.row,e.column)}t.selection.selectToPosition(i),t.renderer.scrollCursorIntoView()},this.extendSelectionBy=function(e){var t,i=this.editor,n=i.renderer.screenToTextCoordinates(this.x,this.y),s=i.selection[e](n.row,n.column);if(this.$clickSelection){var r=this.$clickSelection.comparePoint(s.start),a=this.$clickSelection.comparePoint(s.end);if(-1==r&&0>=a)t=this.$clickSelection.end,s.end.row==n.row&&s.end.column==n.column||(n=s.start);else if(1==a&&r>=0)t=this.$clickSelection.start,s.start.row==n.row&&s.start.column==n.column||(n=s.end);else if(-1==r&&1==a)n=s.end,t=s.start;else{var l=o(this.$clickSelection,n);n=l.cursor,t=l.anchor}i.selection.setSelectionAnchor(t.row,t.column)}i.selection.selectToPosition(n),i.renderer.scrollCursorIntoView()},this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting"),this.editor.renderer.scroller.releaseCapture&&this.editor.renderer.scroller.releaseCapture()},this.focusWait=function(){var e=s(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y),t=Date.now();(e>r||t-this.mousedownEvent.time>this.$focusTimout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},this.onDoubleClick=function(e){var t=e.getDocumentPosition(),i=this.editor,n=i.session,s=n.getBracketRange(t);s?(s.isEmpty()&&(s.start.column--,s.end.column++),this.setState("select")):(s=i.selection.getWordRange(t.row,t.column),this.setState("selectByWords")),this.$clickSelection=s},this.onTripleClick=function(e){var t=e.getDocumentPosition(),i=this.editor;this.setState("selectByLines");var n=i.getSelectionRange();n.isMultiLine()&&n.contains(t.row,t.column)?(this.$clickSelection=i.selection.getLineRange(n.start.row),this.$clickSelection.end=i.selection.getLineRange(n.end.row).end):this.$clickSelection=i.selection.getLineRange(t.row)},this.onQuadClick=function(e){var t=this.editor;t.selectAll(),this.$clickSelection=t.getSelectionRange(),this.setState("selectAll")},this.onMouseWheel=function(e){if(!e.getAccelKey()){e.getShiftKey()&&e.wheelY&&!e.wheelX&&(e.wheelX=e.wheelY,e.wheelY=0);var t=e.domEvent.timeStamp,i=t-(this.$lastScrollTime||0),n=this.editor,s=n.renderer.isScrollableBy(e.wheelX*e.speed,e.wheelY*e.speed);return s||200>i?(this.$lastScrollTime=t,n.renderer.scrollBy(e.wheelX*e.speed,e.wheelY*e.speed),e.stop()):void 0}}}).call(n.prototype),t.DefaultHandlers=n}),ace.define("ace/tooltip",["require","exports","module","ace/lib/oop","ace/lib/dom"],function(e,t,i){"use strict";function n(e){this.isOpen=!1,this.$element=null,this.$parentNode=e}var s=(e("./lib/oop"),e("./lib/dom"));(function(){this.$init=function(){return this.$element=s.createElement("div"),this.$element.className="ace_tooltip",this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},this.getElement=function(){return this.$element||this.$init()},this.setText=function(e){s.setInnerText(this.getElement(),e)},this.setHtml=function(e){this.getElement().innerHTML=e},this.setPosition=function(e,t){this.getElement().style.left=e+"px",this.getElement().style.top=t+"px"},this.setClassName=function(e){s.addCssClass(this.getElement(),e)},this.show=function(e,t,i){null!=e&&this.setText(e),null!=t&&null!=i&&this.setPosition(t,i),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},this.hide=function(){this.isOpen&&(this.getElement().style.display="none",this.isOpen=!1)},this.getHeight=function(){return this.getElement().offsetHeight},this.getWidth=function(){return this.getElement().offsetWidth}}).call(n.prototype),t.Tooltip=n}),ace.define("ace/mouse/default_gutter_handler",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event","ace/tooltip"],function(e,t,i){"use strict";function n(e){function t(){var t=h.getDocumentPosition().row,s=l.$annotations[t];if(!s)return i();var o=r.session.getLength();if(t==o){var a=r.renderer.pixelToScreenCoordinates(0,h.y).row,u=h.$pos;if(a>r.session.documentToScreenRow(u.row,u.column))return i()}if(d!=s)if(d=s.text.join("<br/>"),c.setHtml(d),c.show(),r.on("mousewheel",i),e.$tooltipFollowsMouse)n(h);else{var p=l.$cells[r.session.documentToScreenRow(t,0)].element,g=p.getBoundingClientRect(),m=c.getElement().style;m.left=g.right+"px",m.top=g.bottom+"px"}}function i(){u&&(u=clearTimeout(u)),d&&(c.hide(),d=null,r.removeEventListener("mousewheel",i))}function n(e){c.setPosition(e.x,e.y)}var r=e.editor,l=r.renderer.$gutterLayer,c=new s(r.container);e.editor.setDefaultHandler("guttermousedown",function(t){if(r.isFocused()&&0==t.getButton()){var i=l.getRegion(t);if("foldWidgets"!=i){var n=t.getDocumentPosition().row,s=r.session.selection;if(t.getShiftKey())s.selectTo(n,0);else{if(2==t.domEvent.detail)return r.selectAll(),t.preventDefault();e.$clickSelection=r.selection.getLineRange(n)}return e.setState("selectByLines"),e.captureMouse(t),t.preventDefault()}}});var u,h,d;e.editor.setDefaultHandler("guttermousemove",function(s){var r=s.domEvent.target||s.domEvent.srcElement;return o.hasCssClass(r,"ace_fold-widget")?i():(d&&e.$tooltipFollowsMouse&&n(s),h=s,void(u||(u=setTimeout(function(){u=null,h&&!e.isMousePressed?t():i()},50))))}),a.addListener(r.renderer.$gutter,"mouseout",function(e){h=null,d&&!u&&(u=setTimeout(function(){u=null,i()},50))}),r.on("changeSession",i)}function s(e){l.call(this,e)}var o=e("../lib/dom"),r=e("../lib/oop"),a=e("../lib/event"),l=e("../tooltip").Tooltip;r.inherits(s,l),function(){this.setPosition=function(e,t){var i=window.innerWidth||document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight,s=this.getWidth(),o=this.getHeight();e+=15,t+=15,e+s>i&&(e-=e+s-i),t+o>n&&(t-=20+o),l.prototype.setPosition.call(this,e,t)}}.call(s.prototype),t.GutterHandler=n}),ace.define("ace/mouse/mouse_event",["require","exports","module","ace/lib/event","ace/lib/useragent"],function(e,t,i){"use strict";var n=e("../lib/event"),s=e("../lib/useragent"),o=t.MouseEvent=function(e,t){this.domEvent=e,this.editor=t,this.x=this.clientX=e.clientX,this.y=this.clientY=e.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){n.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){n.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos?this.$pos:(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY),this.$pos)},this.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var e=this.editor,t=e.getSelectionRange();if(t.isEmpty())this.$inSelection=!1;else{var i=this.getDocumentPosition();this.$inSelection=t.contains(i.row,i.column)}return this.$inSelection},this.getButton=function(){return n.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=s.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(o.prototype)}),ace.define("ace/mouse/dragdrop_handler",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],function(e,t,i){"use strict";function n(e){function t(e,t){var i=Date.now(),n=!t||e.row!=t.row,o=!t||e.column!=t.column;if(!A||n||o)f.$blockScrolling+=1,f.moveCursorToPosition(e),f.$blockScrolling-=1,A=i,F={x:w,y:y};else{var r=s(F.x,F.y,w,y);r>u?A=null:i-A>=c&&(f.renderer.scrollCursorIntoView(),A=null)}}function i(e,t){var i=Date.now(),n=f.renderer.layerConfig.lineHeight,s=f.renderer.layerConfig.characterWidth,o=f.renderer.scroller.getBoundingClientRect(),r={x:{left:w-o.left,right:o.right-w},y:{top:y-o.top,bottom:o.bottom-y}},a=Math.min(r.x.left,r.x.right),c=Math.min(r.y.top,r.y.bottom),u={row:e.row,column:e.column};2>=a/s&&(u.column+=r.x.left<r.x.right?-3:2),1>=c/n&&(u.row+=r.y.top<r.y.bottom?-1:1);var h=e.row!=u.row,d=e.column!=u.column,p=!t||e.row!=t.row;h||d&&!p?T?i-T>=l&&f.renderer.scrollCursorIntoView(u):T=i:T=null}function n(){var e=C;C=f.renderer.screenToTextCoordinates(w,y),t(C,e),i(C,e)}function h(){x=f.selection.toOrientedRange(),b=f.session.addMarker(x,"ace_selection",f.getSelectionStyle()),f.clearSelection(),f.isFocused()&&f.renderer.$cursorLayer.setBlinking(!1),clearInterval(k),k=setInterval(n,20),L=0,r.addListener(document,"mousemove",p)}function d(){clearInterval(k),f.session.removeMarker(b),b=null,f.$blockScrolling+=1,f.selection.fromOrientedRange(x),f.$blockScrolling-=1,f.isFocused()&&!E&&f.renderer.$cursorLayer.setBlinking(!f.getReadOnly()),x=null,L=0,T=null,A=null,r.removeListener(document,"mousemove",p)}function p(){null==$&&($=setTimeout(function(){null!=$&&b&&d()},20))}function g(e){var t=e.types;return!t||Array.prototype.some.call(t,function(e){return"text/plain"==e||"Text"==e})}function m(e){var t=["copy","copymove","all","uninitialized"],i=["move","copymove","linkmove","all","uninitialized"],n=a.isMac?e.altKey:e.ctrlKey,s="uninitialized";try{s=e.dataTransfer.effectAllowed.toLowerCase()}catch(e){}var o="none";return n&&t.indexOf(s)>=0?o="copy":i.indexOf(s)>=0?o="move":t.indexOf(s)>=0&&(o="copy"),o}var f=e.editor,v=o.createElement("img");v.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",a.isOpera&&(v.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;");var _=["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"];_.forEach(function(t){e[t]=this[t]},this),f.addEventListener("mousedown",this.onMouseDown.bind(e));var b,w,y,k,x,C,S,E,T,A,F,R=f.container,L=0;this.onDragStart=function(e){if(this.cancelDrag||!R.draggable){var t=this;return setTimeout(function(){t.startSelect(),t.captureMouse(e)},0),e.preventDefault()}x=f.getSelectionRange();var i=e.dataTransfer;i.effectAllowed=f.getReadOnly()?"copy":"copyMove",a.isOpera&&(f.container.appendChild(v),v._top=v.offsetTop),i.setDragImage&&i.setDragImage(v,0,0),a.isOpera&&f.container.removeChild(v),i.clearData(),i.setData("Text",f.session.getTextRange()),E=!0,this.setState("drag")},this.onDragEnd=function(e){if(R.draggable=!1,E=!1,this.setState(null),!f.getReadOnly()){var t=e.dataTransfer.dropEffect;S||"move"!=t||f.session.remove(f.getSelectionRange()),f.renderer.$cursorLayer.setBlinking(!0)}this.editor.unsetStyle("ace_dragging")},this.onDragEnter=function(e){return!f.getReadOnly()&&g(e.dataTransfer)?(b||h(),L++,e.dataTransfer.dropEffect=S=m(e),r.preventDefault(e)):void 0},this.onDragOver=function(e){return!f.getReadOnly()&&g(e.dataTransfer)?(b||(h(),
L++),null!==$&&($=null),w=e.clientX,y=e.clientY,e.dataTransfer.dropEffect=S=m(e),r.preventDefault(e)):void 0},this.onDragLeave=function(e){return L--,0>=L&&b?(d(),S=null,r.preventDefault(e)):void 0},this.onDrop=function(e){if(b){var t=e.dataTransfer;if(E)switch(S){case"move":x=x.contains(C.row,C.column)?{start:C,end:C}:f.moveText(x,C);break;case"copy":x=f.moveText(x,C,!0)}else{var i=t.getData("Text");x={start:C,end:f.session.insert(C,i)},f.focus(),S=null}return d(),r.preventDefault(e)}},r.addListener(R,"dragstart",this.onDragStart.bind(e)),r.addListener(R,"dragend",this.onDragEnd.bind(e)),r.addListener(R,"dragenter",this.onDragEnter.bind(e)),r.addListener(R,"dragover",this.onDragOver.bind(e)),r.addListener(R,"dragleave",this.onDragLeave.bind(e)),r.addListener(R,"drop",this.onDrop.bind(e));var $=null}function s(e,t,i,n){return Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))}var o=e("../lib/dom"),r=e("../lib/event"),a=e("../lib/useragent"),l=200,c=200,u=5;(function(){this.dragWait=function(){var e=Date.now()-this.mousedownEvent.time;e>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){var e=this.editor.container;e.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(e){this.editor.renderer.$cursorLayer.setBlinking(!this.editor.getReadOnly()),this.editor.unsetStyle("ace_dragging"),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var e=this.editor.container;e.draggable=!0,this.editor.renderer.$cursorLayer.setBlinking(!1),this.editor.setStyle("ace_dragging"),this.setState("dragReady")},this.onMouseDrag=function(e){var t=this.editor.container;if(a.isIE&&"dragReady"==this.state){var i=s(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y);i>3&&t.dragDrop()}if("dragWait"===this.state){var i=s(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y);i>0&&(t.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()))}},this.onMouseDown=function(e){if(this.$dragEnabled){this.mousedownEvent=e;var t=this.editor,i=e.inSelection(),n=e.getButton(),s=e.domEvent.detail||1;if(1===s&&0===n&&i){if(e.editor.inMultiSelectMode&&(e.getAccelKey()||e.getShiftKey()))return;this.mousedownEvent.time=Date.now();var o=e.domEvent.target||e.domEvent.srcElement;if("unselectable"in o&&(o.unselectable="on"),t.getDragDelay()){if(a.isWebKit){this.cancelDrag=!0;var r=t.container;r.draggable=!0}this.setState("dragWait")}else this.startDrag();this.captureMouse(e,this.onMouseDrag.bind(this)),e.defaultPrevented=!0}}}}).call(n.prototype),t.DragdropHandler=n}),ace.define("ace/lib/net",["require","exports","module","ace/lib/dom"],function(e,t,i){"use strict";var n=e("./dom");t.get=function(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onreadystatechange=function(){4===i.readyState&&t(i.responseText)},i.send(null)},t.loadScript=function(e,t){var i=n.getDocumentHead(),s=document.createElement("script");s.src=e,i.appendChild(s),s.onload=s.onreadystatechange=function(e,i){!i&&s.readyState&&"loaded"!=s.readyState&&"complete"!=s.readyState||(s=s.onload=s.onreadystatechange=null,i||t())}},t.qualifyURL=function(e){var t=document.createElement("a");return t.href=e,t.href}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(e,t,i){"use strict";var n={},s=function(){this.propagationStopped=!0},o=function(){this.defaultPrevented=!0};n._emit=n._dispatchEvent=function(e,t){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var i=this._eventRegistry[e]||[],n=this._defaultHandlers[e];if(i.length||n){"object"==typeof t&&t||(t={}),t.type||(t.type=e),t.stopPropagation||(t.stopPropagation=s),t.preventDefault||(t.preventDefault=o),i=i.slice();for(var r=0;r<i.length&&(i[r](t,this),!t.propagationStopped);r++);return n&&!t.defaultPrevented?n(t,this):void 0}},n._signal=function(e,t){var i=(this._eventRegistry||{})[e];if(i){i=i.slice();for(var n=0;n<i.length;n++)i[n](t,this)}},n.once=function(e,t){var i=this;t&&this.addEventListener(e,function n(){i.removeEventListener(e,n),t.apply(null,arguments)})},n.setDefaultHandler=function(e,t){var i=this._defaultHandlers;if(i||(i=this._defaultHandlers={_disabled_:{}}),i[e]){var n=i[e],s=i._disabled_[e];s||(i._disabled_[e]=s=[]),s.push(n);var o=s.indexOf(t);-1!=o&&s.splice(o,1)}i[e]=t},n.removeDefaultHandler=function(e,t){var i=this._defaultHandlers;if(i){var n=i._disabled_[e];if(i[e]==t){i[e];n&&this.setDefaultHandler(e,n.pop())}else if(n){var s=n.indexOf(t);-1!=s&&n.splice(s,1)}}},n.on=n.addEventListener=function(e,t,i){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[e];return n||(n=this._eventRegistry[e]=[]),-1==n.indexOf(t)&&n[i?"unshift":"push"](t),t},n.off=n.removeListener=n.removeEventListener=function(e,t){this._eventRegistry=this._eventRegistry||{};var i=this._eventRegistry[e];if(i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}},n.removeAllListeners=function(e){this._eventRegistry&&(this._eventRegistry[e]=[])},t.EventEmitter=n}),ace.define("ace/config",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/lib/net","ace/lib/event_emitter"],function(e,t,n){"no use strict";function s(s){if(h.packaged=s||e.packaged||n.packaged||u.define&&i(126).packaged,!u.document)return"";for(var r={},a="",l=document.currentScript||document._currentScript,c=l&&l.ownerDocument||document,d=c.getElementsByTagName("script"),p=0;p<d.length;p++){var g=d[p],m=g.src||g.getAttribute("src");if(m){for(var f=g.attributes,v=0,_=f.length;_>v;v++){var b=f[v];0===b.name.indexOf("data-ace-")&&(r[o(b.name.replace(/^data-ace-/,""))]=b.value)}var w=m.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);w&&(a=w[1])}}a&&(r.base=r.base||a,r.packaged=!0),r.basePath=r.base,r.workerPath=r.workerPath||r.base,r.modePath=r.modePath||r.base,r.themePath=r.themePath||r.base,delete r.base;for(var y in r)"undefined"!=typeof r[y]&&t.set(y,r[y])}function o(e){return e.replace(/-(.)/g,function(e,t){return t.toUpperCase()})}var r=e("./lib/lang"),a=e("./lib/oop"),l=e("./lib/net"),c=e("./lib/event_emitter").EventEmitter,u=function(){return this}(),h={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{}};t.get=function(e){if(!h.hasOwnProperty(e))throw new Error("Unknown config key: "+e);return h[e]},t.set=function(e,t){if(!h.hasOwnProperty(e))throw new Error("Unknown config key: "+e);h[e]=t},t.all=function(){return r.copyObject(h)},a.implement(t,c),t.moduleUrl=function(e,t){if(h.$moduleUrls[e])return h.$moduleUrls[e];var i=e.split("/");t=t||i[i.length-2]||"";var n="snippets"==t?"/":"-",s=i[i.length-1];if("-"==n){var o=new RegExp("^"+t+"[\\-_]|[\\-_]"+t+"$","g");s=s.replace(o,"")}(!s||s==t)&&i.length>1&&(s=i[i.length-2]);var r=h[t+"Path"];return null==r?r=h.basePath:"/"==n&&(t=n=""),r&&"/"!=r.slice(-1)&&(r+="/"),r+t+n+s+this.get("suffix")},t.setModuleUrl=function(e,t){return h.$moduleUrls[e]=t},t.$loading={},t.loadModule=function(i,n){var s,o;Array.isArray(i)&&(o=i[0],i=i[1]);try{s=e(i)}catch(r){}if(s&&!t.$loading[i])return n&&n(s);if(t.$loading[i]||(t.$loading[i]=[]),t.$loading[i].push(n),!(t.$loading[i].length>1)){var a=function(){e([i],function(e){t._emit("load.module",{name:i,module:e});var n=t.$loading[i];t.$loading[i]=null,n.forEach(function(t){t&&t(e)})})};return t.get("packaged")?void l.loadScript(t.moduleUrl(i,o),a):a()}},s(!0),t.init=s;var d={setOptions:function(e){Object.keys(e).forEach(function(t){this.setOption(t,e[t])},this)},getOptions:function(e){var t={};return e?Array.isArray(e)||(t=e,e=Object.keys(t)):e=Object.keys(this.$options),e.forEach(function(e){t[e]=this.getOption(e)},this),t},setOption:function(e,t){if(this["$"+e]!==t){var i=this.$options[e];if(!i)return void("undefined"!=typeof console&&console.warn&&console.warn('misspelled option "'+e+'"'));if(i.forwardTo)return this[i.forwardTo]&&this[i.forwardTo].setOption(e,t);i.handlesSet||(this["$"+e]=t),i&&i.set&&i.set.call(this,t)}},getOption:function(e){var t=this.$options[e];return t?t.forwardTo?this[t.forwardTo]&&this[t.forwardTo].getOption(e):t&&t.get?t.get.call(this):this["$"+e]:void("undefined"!=typeof console&&console.warn&&console.warn('misspelled option "'+e+'"'))}},p={};t.defineOptions=function(e,t,i){return e.$options||(p[t]=e.$options={}),Object.keys(i).forEach(function(t){var n=i[t];"string"==typeof n&&(n={forwardTo:n}),n.name||(n.name=t),e.$options[n.name]=n,"initialValue"in n&&(e["$"+n.name]=n.initialValue)}),a.implement(e,d),this},t.resetOptions=function(e){Object.keys(e.$options).forEach(function(t){var i=e.$options[t];"value"in i&&e.setOption(t,i.value)})},t.setDefaultValue=function(e,i,n){var s=p[e]||(p[e]={});s[i]&&(s.forwardTo?t.setDefaultValue(s.forwardTo,i,n):s[i].value=n)},t.setDefaultValues=function(e,i){Object.keys(i).forEach(function(n){t.setDefaultValue(e,n,i[n])})}}),ace.define("ace/mouse/mouse_handler",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/mouse/default_handlers","ace/mouse/default_gutter_handler","ace/mouse/mouse_event","ace/mouse/dragdrop_handler","ace/config"],function(e,t,i){"use strict";var n=e("../lib/event"),s=e("../lib/useragent"),o=e("./default_handlers").DefaultHandlers,r=e("./default_gutter_handler").GutterHandler,a=e("./mouse_event").MouseEvent,l=e("./dragdrop_handler").DragdropHandler,c=e("../config"),u=function(e){var t=this;this.editor=e,new o(this),new r(this),new l(this);var i=function(t){!e.isFocused()&&e.textInput&&e.textInput.onContextMenu(t),e.focus()},a=e.renderer.getMouseEventTarget();n.addListener(a,"click",this.onMouseEvent.bind(this,"click")),n.addListener(a,"mousemove",this.onMouseMove.bind(this,"mousemove")),n.addMultiMouseDownListener(a,[400,300,250],this,"onMouseEvent"),e.renderer.scrollBarV&&(n.addMultiMouseDownListener(e.renderer.scrollBarV.inner,[400,300,250],this,"onMouseEvent"),n.addMultiMouseDownListener(e.renderer.scrollBarH.inner,[400,300,250],this,"onMouseEvent"),s.isIE&&(n.addListener(e.renderer.scrollBarV.element,"mousedown",i),n.addListener(e.renderer.scrollBarH.element,"mousemove",i))),n.addMouseWheelListener(e.container,this.onMouseWheel.bind(this,"mousewheel"));var c=e.renderer.$gutter;n.addListener(c,"mousedown",this.onMouseEvent.bind(this,"guttermousedown")),n.addListener(c,"click",this.onMouseEvent.bind(this,"gutterclick")),n.addListener(c,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick")),n.addListener(c,"mousemove",this.onMouseEvent.bind(this,"guttermousemove")),n.addListener(a,"mousedown",i),n.addListener(c,"mousedown",function(t){return e.focus(),n.preventDefault(t)}),e.on("mousemove",function(i){if(!t.state&&!t.$dragDelay&&t.$dragEnabled){var n=e.renderer.screenToTextCoordinates(i.x,i.y),s=e.session.selection.getRange(),o=e.renderer;!s.isEmpty()&&s.insideStart(n.row,n.column)?o.setCursorStyle("default"):o.setCursorStyle("")}})};(function(){this.onMouseEvent=function(e,t){this.editor._emit(e,new a(t,this.editor))},this.onMouseMove=function(e,t){var i=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;i&&i.length&&this.editor._emit(e,new a(t,this.editor))},this.onMouseWheel=function(e,t){var i=new a(t,this.editor);i.speed=2*this.$scrollSpeed,i.wheelX=t.wheelX,i.wheelY=t.wheelY,this.editor._emit(e,i)},this.setState=function(e){this.state=e},this.captureMouse=function(e,t){this.x=e.x,this.y=e.y,this.isMousePressed=!0;var i=this.editor.renderer;i.$keepTextAreaAtCursor&&(i.$keepTextAreaAtCursor=null);var o=this,r=function(e){if(e){if(s.isWebKit&&!e.which&&o.releaseMouse)return o.releaseMouse();o.x=e.clientX,o.y=e.clientY,t&&t(e),o.mouseEvent=new a(e,o.editor),o.$mouseMoved=!0}},l=function(e){clearInterval(u),c(),o[o.state+"End"]&&o[o.state+"End"](e),o.state="",null==i.$keepTextAreaAtCursor&&(i.$keepTextAreaAtCursor=!0,i.$moveTextAreaToCursor()),o.isMousePressed=!1,o.$onCaptureMouseMove=o.releaseMouse=null,e&&o.onMouseEvent("mouseup",e)},c=function(){o[o.state]&&o[o.state](),o.$mouseMoved=!1};if(s.isOldIE&&"dblclick"==e.domEvent.type)return setTimeout(function(){l(e)});o.$onCaptureMouseMove=r,o.releaseMouse=n.capture(this.editor.container,r,l);var u=setInterval(c,20)},this.releaseMouse=null,this.cancelContextMenu=function(){var e=function(t){t&&t.domEvent&&"contextmenu"!=t.domEvent.type||(this.editor.off("nativecontextmenu",e),t&&t.domEvent&&n.stopEvent(t.domEvent))}.bind(this);setTimeout(e,10),this.editor.on("nativecontextmenu",e)}}).call(u.prototype),c.defineOptions(u.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:s.isMac?150:0},dragEnabled:{initialValue:!0},focusTimout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),t.MouseHandler=u}),ace.define("ace/mouse/fold_handler",["require","exports","module"],function(e,t,i){"use strict";function n(e){e.on("click",function(t){var i=t.getDocumentPosition(),n=e.session,s=n.getFoldAt(i.row,i.column,1);s&&(t.getAccelKey()?n.removeFold(s):n.expandFold(s),t.stop())}),e.on("gutterclick",function(t){var i=e.renderer.$gutterLayer.getRegion(t);if("foldWidgets"==i){var n=t.getDocumentPosition().row,s=e.session;s.foldWidgets&&s.foldWidgets[n]&&e.session.onFoldWidgetClick(n,t),e.isFocused()||e.focus(),t.stop()}}),e.on("gutterdblclick",function(t){var i=e.renderer.$gutterLayer.getRegion(t);if("foldWidgets"==i){var n=t.getDocumentPosition().row,s=e.session,o=s.getParentFoldRangeData(n,!0),r=o.range||o.firstRange;if(r){n=r.start.row;var a=s.getFoldAt(n,s.getLine(n).length,1);a?s.removeFold(a):(s.addFold("...",r),e.renderer.scrollCursorIntoView({row:r.start.row,column:0}))}t.stop()}})}t.FoldHandler=n}),ace.define("ace/keyboard/keybinding",["require","exports","module","ace/lib/keys","ace/lib/event"],function(e,t,i){"use strict";var n=e("../lib/keys"),s=e("../lib/event"),o=function(e){this.$editor=e,this.$data={editor:e},this.$handlers=[],this.setDefaultHandler(e.commands)};(function(){this.setDefaultHandler=function(e){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=e,this.addKeyboardHandler(e,0)},this.setKeyboardHandler=function(e){var t=this.$handlers;if(t[t.length-1]!=e){for(;t[t.length-1]&&t[t.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(t[t.length-1]);this.addKeyboardHandler(e,1)}},this.addKeyboardHandler=function(e,t){if(e){"function"!=typeof e||e.handleKeyboard||(e.handleKeyboard=e);var i=this.$handlers.indexOf(e);-1!=i&&this.$handlers.splice(i,1),void 0==t?this.$handlers.push(e):this.$handlers.splice(t,0,e),-1==i&&e.attach&&e.attach(this.$editor)}},this.removeKeyboardHandler=function(e){var t=this.$handlers.indexOf(e);return-1==t?!1:(this.$handlers.splice(t,1),e.detach&&e.detach(this.$editor),!0)},this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},this.$callKeyboardHandlers=function(e,t,i,n){for(var o,r=!1,a=this.$editor.commands,l=this.$handlers.length;l--&&(o=this.$handlers[l].handleKeyboard(this.$data,e,t,i,n),!(o&&o.command&&(r="null"==o.command?!0:a.exec(o.command,this.$editor,o.args,n),r&&n&&-1!=e&&1!=o.passEvent&&1!=o.command.passEvent&&s.stopEvent(n),r))););return r},this.onCommandKey=function(e,t,i){var s=n.keyCodeToString(i);this.$callKeyboardHandlers(t,s,i,e)},this.onTextInput=function(e){var t=this.$callKeyboardHandlers(-1,e);t||this.$editor.commands.exec("insertstring",this.$editor,e)}}).call(o.prototype),t.KeyBinding=o}),ace.define("ace/range",["require","exports","module"],function(e,t,i){"use strict";var n=function(e,t){return e.row-t.row||e.column-t.column},s=function(e,t,i,n){this.start={row:e,column:t},this.end={row:i,column:n}};(function(){this.isEqual=function(e){return this.start.row===e.start.row&&this.end.row===e.end.row&&this.start.column===e.start.column&&this.end.column===e.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(e,t){return 0==this.compare(e,t)},this.compareRange=function(e){var t,i=e.end,n=e.start;return t=this.compare(i.row,i.column),1==t?(t=this.compare(n.row,n.column),1==t?2:0==t?1:0):-1==t?-2:(t=this.compare(n.row,n.column),-1==t?-1:1==t?42:0)},this.comparePoint=function(e){return this.compare(e.row,e.column)},this.containsRange=function(e){return 0==this.comparePoint(e.start)&&0==this.comparePoint(e.end)},this.intersects=function(e){var t=this.compareRange(e);return-1==t||0==t||1==t},this.isEnd=function(e,t){return this.end.row==e&&this.end.column==t},this.isStart=function(e,t){return this.start.row==e&&this.start.column==t},this.setStart=function(e,t){"object"==typeof e?(this.start.column=e.column,this.start.row=e.row):(this.start.row=e,this.start.column=t)},this.setEnd=function(e,t){"object"==typeof e?(this.end.column=e.column,this.end.row=e.row):(this.end.row=e,this.end.column=t)},this.inside=function(e,t){return 0==this.compare(e,t)?!this.isEnd(e,t)&&!this.isStart(e,t):!1},this.insideStart=function(e,t){return 0==this.compare(e,t)?!this.isEnd(e,t):!1},this.insideEnd=function(e,t){return 0==this.compare(e,t)?!this.isStart(e,t):!1},this.compare=function(e,t){return this.isMultiLine()||e!==this.start.row?e<this.start.row?-1:e>this.end.row?1:this.start.row===e?t>=this.start.column?0:-1:this.end.row===e?t<=this.end.column?0:1:0:t<this.start.column?-1:t>this.end.column?1:0},this.compareStart=function(e,t){return this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.compareEnd=function(e,t){return this.end.row==e&&this.end.column==t?1:this.compare(e,t)},this.compareInside=function(e,t){return this.end.row==e&&this.end.column==t?1:this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.clipRows=function(e,t){if(this.end.row>t)var i={row:t+1,column:0};else if(this.end.row<e)var i={row:e,column:0};if(this.start.row>t)var n={row:t+1,column:0};else if(this.start.row<e)var n={row:e,column:0};return s.fromPoints(n||this.start,i||this.end)},this.extend=function(e,t){var i=this.compare(e,t);if(0==i)return this;if(-1==i)var n={row:e,column:t};else var o={row:e,column:t};return s.fromPoints(n||this.start,o||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return s.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new s(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new s(this.start.row,0,this.end.row,0)},this.toScreenRange=function(e){var t=e.documentToScreenPosition(this.start),i=e.documentToScreenPosition(this.end);return new s(t.row,t.column,i.row,i.column)},this.moveBy=function(e,t){this.start.row+=e,this.start.column+=t,this.end.row+=e,this.end.column+=t}}).call(s.prototype),s.fromPoints=function(e,t){return new s(e.row,e.column,t.row,t.column)},s.comparePoints=n,s.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},t.Range=s}),ace.define("ace/selection",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/range"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/lang"),o=e("./lib/event_emitter").EventEmitter,r=e("./range").Range,a=function(e){this.session=e,this.doc=e.getDocument(),this.clearSelection(),this.lead=this.selectionLead=this.doc.createAnchor(0,0),this.anchor=this.selectionAnchor=this.doc.createAnchor(0,0);var t=this;this.lead.on("change",function(e){t._emit("changeCursor"),t.$isEmpty||t._emit("changeSelection"),t.$keepDesiredColumnOnChange||e.old.column==e.value.column||(t.$desiredColumn=null)}),this.selectionAnchor.on("change",function(){t.$isEmpty||t._emit("changeSelection")})};(function(){n.implement(this,o),this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},this.isMultiLine=function(){return this.isEmpty()?!1:this.getRange().isMultiLine()},this.getCursor=function(){return this.lead.getPosition()},this.setSelectionAnchor=function(e,t){this.anchor.setPosition(e,t),this.$isEmpty&&(this.$isEmpty=!1,this._emit("changeSelection"))},this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},this.getSelectionLead=function(){return this.lead.getPosition()},this.shiftSelection=function(e){if(this.$isEmpty)return void this.moveCursorTo(this.lead.row,this.lead.column+e);var t=this.getSelectionAnchor(),i=this.getSelectionLead(),n=this.isBackwards();n&&0===t.column||this.setSelectionAnchor(t.row,t.column+e),(n||0!==i.column)&&this.$moveSelection(function(){this.moveCursorTo(i.row,i.column+e)})},this.isBackwards=function(){var e=this.anchor,t=this.lead;return e.row>t.row||e.row==t.row&&e.column>t.column},this.getRange=function(){var e=this.anchor,t=this.lead;return this.isEmpty()?r.fromPoints(t,t):this.isBackwards()?r.fromPoints(t,e):r.fromPoints(e,t)},this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},this.selectAll=function(){var e=this.doc.getLength()-1;this.setSelectionAnchor(0,0),this.moveCursorTo(e,this.doc.getLine(e).length)},this.setRange=this.setSelectionRange=function(e,t){t?(this.setSelectionAnchor(e.end.row,e.end.column),this.selectTo(e.start.row,e.start.column)):(this.setSelectionAnchor(e.start.row,e.start.column),this.selectTo(e.end.row,e.end.column)),this.getRange().isEmpty()&&(this.$isEmpty=!0),this.$desiredColumn=null},this.$moveSelection=function(e){var t=this.lead;this.$isEmpty&&this.setSelectionAnchor(t.row,t.column),e.call(this)},this.selectTo=function(e,t){this.$moveSelection(function(){this.moveCursorTo(e,t)})},this.selectToPosition=function(e){this.$moveSelection(function(){this.moveCursorToPosition(e)})},this.moveTo=function(e,t){this.clearSelection(),this.moveCursorTo(e,t)},this.moveToPosition=function(e){this.clearSelection(),this.moveCursorToPosition(e)},this.selectUp=function(){this.$moveSelection(this.moveCursorUp)},this.selectDown=function(){this.$moveSelection(this.moveCursorDown)},this.selectRight=function(){this.$moveSelection(this.moveCursorRight)},this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},this.getWordRange=function(e,t){if("undefined"==typeof t){var i=e||this.lead;e=i.row,t=i.column}return this.session.getWordRange(e,t)},this.selectWord=function(){this.setSelectionRange(this.getWordRange())},this.selectAWord=function(){var e=this.getCursor(),t=this.session.getAWordRange(e.row,e.column);this.setSelectionRange(t)},this.getLineRange=function(e,t){var i,n="number"==typeof e?e:this.lead.row,s=this.session.getFoldLine(n);return s?(n=s.start.row,i=s.end.row):i=n,t===!0?new r(n,0,i,this.session.getLine(i).length):new r(n,0,i+1,0)},this.selectLine=function(){this.setSelectionRange(this.getLineRange())},this.moveCursorUp=function(){this.moveCursorBy(-1,0)},this.moveCursorDown=function(){this.moveCursorBy(1,0)},this.moveCursorLeft=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,-1))this.moveCursorTo(e.start.row,e.start.column);else if(0==t.column)t.row>0&&this.moveCursorTo(t.row-1,this.doc.getLine(t.row-1).length);else{var i=this.session.getTabSize();this.session.isTabStop(t)&&this.doc.getLine(t.row).slice(t.column-i,t.column).split(" ").length-1==i?this.moveCursorBy(0,-i):this.moveCursorBy(0,-1)}},this.moveCursorRight=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,1))this.moveCursorTo(e.end.row,e.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var i=this.session.getTabSize(),t=this.lead;this.session.isTabStop(t)&&this.doc.getLine(t.row).slice(t.column,t.column+i).split(" ").length-1==i?this.moveCursorBy(0,i):this.moveCursorBy(0,1)}},this.moveCursorLineStart=function(){var e=this.lead.row,t=this.lead.column,i=this.session.documentToScreenRow(e,t),n=this.session.screenToDocumentPosition(i,0),s=this.session.getDisplayLine(e,null,n.row,n.column),o=s.match(/^\s*/);o[0].length==t||this.session.$useEmacsStyleLineStart||(n.column+=o[0].length),this.moveCursorToPosition(n)},this.moveCursorLineEnd=function(){var e=this.lead,t=this.session.getDocumentLastRowColumnPosition(e.row,e.column);if(this.lead.column==t.column){var i=this.session.getLine(t.row);if(t.column==i.length){var n=i.search(/\s+$/);n>0&&(t.column=n)}}this.moveCursorTo(t.row,t.column)},this.moveCursorFileEnd=function(){var e=this.doc.getLength()-1,t=this.doc.getLine(e).length;this.moveCursorTo(e,t)},this.moveCursorFileStart=function(){this.moveCursorTo(0,0)},this.moveCursorLongWordRight=function(){var e,t=this.lead.row,i=this.lead.column,n=this.doc.getLine(t),s=n.substring(i);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var o=this.session.getFoldAt(t,i,1);return o?void this.moveCursorTo(o.end.row,o.end.column):((e=this.session.nonTokenRe.exec(s))&&(i+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,s=n.substring(i)),i>=n.length?(this.moveCursorTo(t,n.length),this.moveCursorRight(),void(t<this.doc.getLength()-1&&this.moveCursorWordRight())):((e=this.session.tokenRe.exec(s))&&(i+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),void this.moveCursorTo(t,i)))},this.moveCursorLongWordLeft=function(){var e,t=this.lead.row,i=this.lead.column;if(e=this.session.getFoldAt(t,i,-1))return void this.moveCursorTo(e.start.row,e.start.column);var n=this.session.getFoldStringAt(t,i,-1);null==n&&(n=this.doc.getLine(t).substring(0,i));var o,r=s.stringReverse(n);return this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,(o=this.session.nonTokenRe.exec(r))&&(i-=this.session.nonTokenRe.lastIndex,r=r.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),0>=i?(this.moveCursorTo(t,0),this.moveCursorLeft(),void(t>0&&this.moveCursorWordLeft())):((o=this.session.tokenRe.exec(r))&&(i-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),void this.moveCursorTo(t,i))},this.$shortWordEndIndex=function(e){var t,i,n=0,s=/\s/,o=this.session.tokenRe;if(o.lastIndex=0,t=this.session.tokenRe.exec(e))n=this.session.tokenRe.lastIndex;else{for(;(i=e[n])&&s.test(i);)n++;if(1>n)for(o.lastIndex=0;(i=e[n])&&!o.test(i);)if(o.lastIndex=0,n++,s.test(i)){if(n>2){n--;break}for(;(i=e[n])&&s.test(i);)n++;if(n>2)break}}return o.lastIndex=0,n},this.moveCursorShortWordRight=function(){var e=this.lead.row,t=this.lead.column,i=this.doc.getLine(e),n=i.substring(t),s=this.session.getFoldAt(e,t,1);if(s)return this.moveCursorTo(s.end.row,s.end.column);if(t==i.length){var o=this.doc.getLength();do e++,n=this.doc.getLine(e);while(o>e&&/^\s*$/.test(n));/^\s+/.test(n)||(n=""),t=0}var r=this.$shortWordEndIndex(n);this.moveCursorTo(e,t+r)},this.moveCursorShortWordLeft=function(){var e,t=this.lead.row,i=this.lead.column;if(e=this.session.getFoldAt(t,i,-1))return this.moveCursorTo(e.start.row,e.start.column);var n=this.session.getLine(t).substring(0,i);if(0==i){do t--,n=this.doc.getLine(t);while(t>0&&/^\s*$/.test(n));i=n.length,/\s+$/.test(n)||(n="")}var o=s.stringReverse(n),r=this.$shortWordEndIndex(o);return this.moveCursorTo(t,i-r)},this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},this.moveCursorBy=function(e,t){var i=this.session.documentToScreenPosition(this.lead.row,this.lead.column);0===t&&(this.$desiredColumn?i.column=this.$desiredColumn:this.$desiredColumn=i.column);var n=this.session.screenToDocumentPosition(i.row+e,i.column);0!==e&&0===t&&n.row===this.lead.row&&n.column===this.lead.column&&this.session.lineWidgets&&this.session.lineWidgets[n.row]&&n.row++,this.moveCursorTo(n.row,n.column+t,0===t)},this.moveCursorToPosition=function(e){this.moveCursorTo(e.row,e.column)},this.moveCursorTo=function(e,t,i){var n=this.session.getFoldAt(e,t,1);n&&(e=n.start.row,t=n.start.column),this.$keepDesiredColumnOnChange=!0,this.lead.setPosition(e,t),this.$keepDesiredColumnOnChange=!1,i||(this.$desiredColumn=null)},this.moveCursorToScreen=function(e,t,i){var n=this.session.screenToDocumentPosition(e,t);this.moveCursorTo(n.row,n.column,i)},this.detach=function(){this.lead.detach(),this.anchor.detach(),this.session=this.doc=null},this.fromOrientedRange=function(e){this.setSelectionRange(e,e.cursor==e.start),this.$desiredColumn=e.desiredColumn||this.$desiredColumn},this.toOrientedRange=function(e){var t=this.getRange();return e?(e.start.column=t.start.column,e.start.row=t.start.row,e.end.column=t.end.column,e.end.row=t.end.row):e=t,e.cursor=this.isBackwards()?e.start:e.end,e.desiredColumn=this.$desiredColumn,e},this.getRangeOfMovements=function(e){var t=this.getCursor();try{e.call(null,this);var i=this.getCursor();return r.fromPoints(t,i)}catch(n){return r.fromPoints(t,t)}finally{this.moveCursorToPosition(t)}},this.toJSON=function(){if(this.rangeCount)var e=this.ranges.map(function(e){var t=e.clone();return t.isBackwards=e.cursor==e.start,t});else{var e=this.getRange();e.isBackwards=this.isBackwards()}return e},this.fromJSON=function(e){if(void 0==e.start){if(this.rangeList){this.toSingleRange(e[0]);for(var t=e.length;t--;){var i=r.fromPoints(e[t].start,e[t].end);e.isBackwards&&(i.cursor=i.start),this.addRange(i,!0)}return}e=e[0]}this.rangeList&&this.toSingleRange(e),this.setSelectionRange(e,e.isBackwards)},this.isEqual=function(e){if((e.length||this.rangeCount)&&e.length!=this.rangeCount)return!1;if(!e.length||!this.ranges)return this.getRange().isEqual(e);for(var t=this.ranges.length;t--;)if(!this.ranges[t].isEqual(e[t]))return!1;return!0}}).call(a.prototype),t.Selection=a}),ace.define("ace/tokenizer",["require","exports","module"],function(e,t,i){"use strict";var n=1e3,s=function(e){this.states=e,this.regExps={},this.matchMappings={};for(var t in this.states){for(var i=this.states[t],n=[],s=0,o=this.matchMappings[t]={defaultToken:"text"},r="g",a=[],l=0;l<i.length;l++){var c=i[l];if(c.defaultToken&&(o.defaultToken=c.defaultToken),c.caseInsensitive&&(r="gi"),null!=c.regex){c.regex instanceof RegExp&&(c.regex=c.regex.toString().slice(1,-1));var u=c.regex,h=new RegExp("(?:("+u+")|(.))").exec("a").length-2;if(Array.isArray(c.token))if(1==c.token.length||1==h)c.token=c.token[0];else{if(h-1!=c.token.length)throw new Error("number of classes and regexp groups in '"+c.token+"'\n'"+c.regex+"' doesn't match\n"+(h-1)+"!="+c.token.length);c.tokenArray=c.token,c.token=null,c.onMatch=this.$arrayTokens}else"function"!=typeof c.token||c.onMatch||(h>1?c.onMatch=this.$applyToken:c.onMatch=c.token);h>1&&(/\\\d/.test(c.regex)?u=c.regex.replace(/\\([0-9]+)/g,function(e,t){return"\\"+(parseInt(t,10)+s+1)}):(h=1,u=this.removeCapturingGroups(c.regex)),c.splitRegex||"string"==typeof c.token||a.push(c)),o[s]=l,s+=h,n.push(u),c.onMatch||(c.onMatch=null)}}n.length||(o[0]=0,n.push("$")),a.forEach(function(e){e.splitRegex=this.createSplitterRegexp(e.regex,r)},this),this.regExps[t]=new RegExp("("+n.join(")|(")+")|($)",r)}};(function(){this.$setMaxTokenCount=function(e){n=0|e},this.$applyToken=function(e){var t=this.splitRegex.exec(e).slice(1),i=this.token.apply(this,t);if("string"==typeof i)return[{type:i,value:e}];for(var n=[],s=0,o=i.length;o>s;s++)t[s]&&(n[n.length]={type:i[s],value:t[s]});return n},this.$arrayTokens=function(e){if(!e)return[];var t=this.splitRegex.exec(e);if(!t)return"text";for(var i=[],n=this.tokenArray,s=0,o=n.length;o>s;s++)t[s+1]&&(i[i.length]={type:n[s],value:t[s+1]});return i},this.removeCapturingGroups=function(e){var t=e.replace(/\[(?:\\.|[^\]])*?\]|\\.|\(\?[:=!]|(\()/g,function(e,t){return t?"(?:":e});return t},
this.createSplitterRegexp=function(e,t){if(-1!=e.indexOf("(?=")){var i=0,n=!1,s={};e.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,function(e,t,o,r,a,l){return n?n="]"!=a:a?n=!0:r?(i==s.stack&&(s.end=l+1,s.stack=-1),i--):o&&(i++,1!=o.length&&(s.stack=i,s.start=l)),e}),null!=s.end&&/^\)*$/.test(e.substr(s.end))&&(e=e.substring(0,s.start)+e.substr(s.end))}return new RegExp(e,(t||"").replace("g",""))},this.getLineTokens=function(e,t){if(t&&"string"!=typeof t){var i=t.slice(0);t=i[0]}else var i=[];var s=t||"start",o=this.states[s];o||(s="start",o=this.states[s]);var r=this.matchMappings[s],a=this.regExps[s];a.lastIndex=0;for(var l,c=[],u=0,h={type:null,value:""};l=a.exec(e);){var d=r.defaultToken,p=null,g=l[0],m=a.lastIndex;if(m-g.length>u){var f=e.substring(u,m-g.length);h.type==d?h.value+=f:(h.type&&c.push(h),h={type:d,value:f})}for(var v=0;v<l.length-2;v++)if(void 0!==l[v+1]){p=o[r[v]],d=p.onMatch?p.onMatch(g,s,i):p.token,p.next&&(s="string"==typeof p.next?p.next:p.next(s,i),o=this.states[s],o||(window.console&&console.error&&console.error(s,"doesn't exist"),s="start",o=this.states[s]),r=this.matchMappings[s],u=m,a=this.regExps[s],a.lastIndex=m);break}if(g)if("string"==typeof d)p&&p.merge===!1||h.type!==d?(h.type&&c.push(h),h={type:d,value:g}):h.value+=g;else if(d){h.type&&c.push(h),h={type:null,value:""};for(var v=0;v<d.length;v++)c.push(d[v])}if(u==e.length)break;if(u=m,c.length>n){for(;u<e.length;)h.type&&c.push(h),h={value:e.substring(u,u+=2e3),type:"overflow"};s="start",i=[];break}}return h.type&&c.push(h),i.length>1&&i[0]!==s&&i.unshift(s),{tokens:c,state:i.length?i:s}}}).call(s.prototype),t.Tokenizer=s}),ace.define("ace/mode/text_highlight_rules",["require","exports","module","ace/lib/lang"],function(e,t,i){"use strict";var n=e("../lib/lang"),s=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(e,t){if(t)for(var i in e){for(var n=e[i],s=0;s<n.length;s++){var o=n[s];o.next&&("string"!=typeof o.next?o.nextState&&0!==o.nextState.indexOf(t)&&(o.nextState=t+o.nextState):0!==o.next.indexOf(t)&&(o.next=t+o.next))}this.$rules[t+i]=n}else for(var i in e)this.$rules[i]=e[i]},this.getRules=function(){return this.$rules},this.embedRules=function(e,t,i,s,o){var r="function"==typeof e?(new e).getRules():e;if(s)for(var a=0;a<s.length;a++)s[a]=t+s[a];else{s=[];for(var l in r)s.push(t+l)}if(this.addRules(r,t),i)for(var c=Array.prototype[o?"push":"unshift"],a=0;a<s.length;a++)c.apply(this.$rules[s[a]],n.deepCopy(i));this.$embeds||(this.$embeds=[]),this.$embeds.push(t)},this.getEmbeds=function(){return this.$embeds};var e=function(e,t){return("start"!=e||t.length)&&t.unshift(this.nextState,e),this.nextState},t=function(e,t){return t.shift(),t.shift()||"start"};this.normalizeRules=function(){function i(o){var r=s[o];r.processed=!0;for(var a=0;a<r.length;a++){var l=r[a];!l.regex&&l.start&&(l.regex=l.start,l.next||(l.next=[]),l.next.push({defaultToken:l.token},{token:l.token+".end",regex:l.end||l.start,next:"pop"}),l.token=l.token+".start",l.push=!0);var c=l.next||l.push;if(c&&Array.isArray(c)){var u=l.stateName;u||(u=l.token,"string"!=typeof u&&(u=u[0]||""),s[u]&&(u+=n++)),s[u]=c,l.next=u,i(u)}else"pop"==c&&(l.next=t);if(l.push&&(l.nextState=l.next||l.push,l.next=e,delete l.push),l.rules)for(var h in l.rules)s[h]?s[h].push&&s[h].push.apply(s[h],l.rules[h]):s[h]=l.rules[h];if(l.include||"string"==typeof l)var d=l.include||l,p=s[d];else Array.isArray(l)&&(p=l);if(p){var g=[a,1].concat(p);l.noEscape&&(g=g.filter(function(e){return!e.next})),r.splice.apply(r,g),a--,p=null}l.keywordMap&&(l.token=this.createKeywordMapper(l.keywordMap,l.defaultToken||"text",l.caseInsensitive),delete l.defaultToken)}}var n=0,s=this.$rules;Object.keys(s).forEach(i,this)},this.createKeywordMapper=function(e,t,i,n){var s=Object.create(null);return Object.keys(e).forEach(function(t){var o=e[t];i&&(o=o.toLowerCase());for(var r=o.split(n||"|"),a=r.length;a--;)s[r[a]]=t}),Object.getPrototypeOf(s)&&(s.__proto__=null),this.$keywordList=Object.keys(s),e=null,i?function(e){return s[e.toLowerCase()]||t}:function(e){return s[e]||t}},this.getKeywords=function(){return this.$keywords}}).call(s.prototype),t.TextHighlightRules=s}),ace.define("ace/mode/behaviour",["require","exports","module"],function(e,t,i){"use strict";var n=function(){this.$behaviours={}};(function(){this.add=function(e,t,i){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[e]:this.$behaviours[e]={}}this.$behaviours[e][t]=i},this.addBehaviours=function(e){for(var t in e)for(var i in e[t])this.add(t,i,e[t][i])},this.remove=function(e){this.$behaviours&&this.$behaviours[e]&&delete this.$behaviours[e]},this.inherit=function(e,t){if("function"==typeof e)var i=(new e).getBehaviours(t);else var i=e.getBehaviours(t);this.addBehaviours(i)},this.getBehaviours=function(e){if(e){for(var t={},i=0;i<e.length;i++)this.$behaviours[e[i]]&&(t[e[i]]=this.$behaviours[e[i]]);return t}return this.$behaviours}}).call(n.prototype),t.Behaviour=n}),ace.define("ace/unicode",["require","exports","module"],function(e,t,i){"use strict";function n(e){var i=/\w{4}/g;for(var n in e)t.packages[n]=e[n].replace(i,"\\u$&")}t.packages={},n({L:"0041-005A0061-007A00AA00B500BA00C0-00D600D8-00F600F8-02C102C6-02D102E0-02E402EC02EE0370-037403760377037A-037D03860388-038A038C038E-03A103A3-03F503F7-0481048A-05250531-055605590561-058705D0-05EA05F0-05F20621-064A066E066F0671-06D306D506E506E606EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA07F407F507FA0800-0815081A082408280904-0939093D09500958-0961097109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E460E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EC60EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10A0-10C510D0-10FA10FC1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317D717DC1820-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541AA71B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C7D1CE9-1CEC1CEE-1CF11D00-1DBF1E00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FBC1FBE1FC2-1FC41FC6-1FCC1FD0-1FD31FD6-1FDB1FE0-1FEC1FF2-1FF41FF6-1FFC2071207F2090-209421022107210A-211321152119-211D212421262128212A-212D212F-2139213C-213F2145-2149214E218321842C00-2C2E2C30-2C5E2C60-2CE42CEB-2CEE2D00-2D252D30-2D652D6F2D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2E2F300530063031-3035303B303C3041-3096309D-309F30A1-30FA30FC-30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A48CA4D0-A4FDA500-A60CA610-A61FA62AA62BA640-A65FA662-A66EA67F-A697A6A0-A6E5A717-A71FA722-A788A78BA78CA7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2A9CFAA00-AA28AA40-AA42AA44-AA4BAA60-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADB-AADDABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF21-FF3AFF41-FF5AFF66-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",Ll:"0061-007A00AA00B500BA00DF-00F600F8-00FF01010103010501070109010B010D010F01110113011501170119011B011D011F01210123012501270129012B012D012F01310133013501370138013A013C013E014001420144014601480149014B014D014F01510153015501570159015B015D015F01610163016501670169016B016D016F0171017301750177017A017C017E-0180018301850188018C018D019201950199-019B019E01A101A301A501A801AA01AB01AD01B001B401B601B901BA01BD-01BF01C601C901CC01CE01D001D201D401D601D801DA01DC01DD01DF01E101E301E501E701E901EB01ED01EF01F001F301F501F901FB01FD01FF02010203020502070209020B020D020F02110213021502170219021B021D021F02210223022502270229022B022D022F02310233-0239023C023F0240024202470249024B024D024F-02930295-02AF037103730377037B-037D039003AC-03CE03D003D103D5-03D703D903DB03DD03DF03E103E303E503E703E903EB03ED03EF-03F303F503F803FB03FC0430-045F04610463046504670469046B046D046F04710473047504770479047B047D047F0481048B048D048F04910493049504970499049B049D049F04A104A304A504A704A904AB04AD04AF04B104B304B504B704B904BB04BD04BF04C204C404C604C804CA04CC04CE04CF04D104D304D504D704D904DB04DD04DF04E104E304E504E704E904EB04ED04EF04F104F304F504F704F904FB04FD04FF05010503050505070509050B050D050F05110513051505170519051B051D051F0521052305250561-05871D00-1D2B1D62-1D771D79-1D9A1E011E031E051E071E091E0B1E0D1E0F1E111E131E151E171E191E1B1E1D1E1F1E211E231E251E271E291E2B1E2D1E2F1E311E331E351E371E391E3B1E3D1E3F1E411E431E451E471E491E4B1E4D1E4F1E511E531E551E571E591E5B1E5D1E5F1E611E631E651E671E691E6B1E6D1E6F1E711E731E751E771E791E7B1E7D1E7F1E811E831E851E871E891E8B1E8D1E8F1E911E931E95-1E9D1E9F1EA11EA31EA51EA71EA91EAB1EAD1EAF1EB11EB31EB51EB71EB91EBB1EBD1EBF1EC11EC31EC51EC71EC91ECB1ECD1ECF1ED11ED31ED51ED71ED91EDB1EDD1EDF1EE11EE31EE51EE71EE91EEB1EED1EEF1EF11EF31EF51EF71EF91EFB1EFD1EFF-1F071F10-1F151F20-1F271F30-1F371F40-1F451F50-1F571F60-1F671F70-1F7D1F80-1F871F90-1F971FA0-1FA71FB0-1FB41FB61FB71FBE1FC2-1FC41FC61FC71FD0-1FD31FD61FD71FE0-1FE71FF2-1FF41FF61FF7210A210E210F2113212F21342139213C213D2146-2149214E21842C30-2C5E2C612C652C662C682C6A2C6C2C712C732C742C76-2C7C2C812C832C852C872C892C8B2C8D2C8F2C912C932C952C972C992C9B2C9D2C9F2CA12CA32CA52CA72CA92CAB2CAD2CAF2CB12CB32CB52CB72CB92CBB2CBD2CBF2CC12CC32CC52CC72CC92CCB2CCD2CCF2CD12CD32CD52CD72CD92CDB2CDD2CDF2CE12CE32CE42CEC2CEE2D00-2D25A641A643A645A647A649A64BA64DA64FA651A653A655A657A659A65BA65DA65FA663A665A667A669A66BA66DA681A683A685A687A689A68BA68DA68FA691A693A695A697A723A725A727A729A72BA72DA72F-A731A733A735A737A739A73BA73DA73FA741A743A745A747A749A74BA74DA74FA751A753A755A757A759A75BA75DA75FA761A763A765A767A769A76BA76DA76FA771-A778A77AA77CA77FA781A783A785A787A78CFB00-FB06FB13-FB17FF41-FF5A",Lu:"0041-005A00C0-00D600D8-00DE01000102010401060108010A010C010E01100112011401160118011A011C011E01200122012401260128012A012C012E01300132013401360139013B013D013F0141014301450147014A014C014E01500152015401560158015A015C015E01600162016401660168016A016C016E017001720174017601780179017B017D018101820184018601870189-018B018E-0191019301940196-0198019C019D019F01A001A201A401A601A701A901AC01AE01AF01B1-01B301B501B701B801BC01C401C701CA01CD01CF01D101D301D501D701D901DB01DE01E001E201E401E601E801EA01EC01EE01F101F401F6-01F801FA01FC01FE02000202020402060208020A020C020E02100212021402160218021A021C021E02200222022402260228022A022C022E02300232023A023B023D023E02410243-02460248024A024C024E03700372037603860388-038A038C038E038F0391-03A103A3-03AB03CF03D2-03D403D803DA03DC03DE03E003E203E403E603E803EA03EC03EE03F403F703F903FA03FD-042F04600462046404660468046A046C046E04700472047404760478047A047C047E0480048A048C048E04900492049404960498049A049C049E04A004A204A404A604A804AA04AC04AE04B004B204B404B604B804BA04BC04BE04C004C104C304C504C704C904CB04CD04D004D204D404D604D804DA04DC04DE04E004E204E404E604E804EA04EC04EE04F004F204F404F604F804FA04FC04FE05000502050405060508050A050C050E05100512051405160518051A051C051E0520052205240531-055610A0-10C51E001E021E041E061E081E0A1E0C1E0E1E101E121E141E161E181E1A1E1C1E1E1E201E221E241E261E281E2A1E2C1E2E1E301E321E341E361E381E3A1E3C1E3E1E401E421E441E461E481E4A1E4C1E4E1E501E521E541E561E581E5A1E5C1E5E1E601E621E641E661E681E6A1E6C1E6E1E701E721E741E761E781E7A1E7C1E7E1E801E821E841E861E881E8A1E8C1E8E1E901E921E941E9E1EA01EA21EA41EA61EA81EAA1EAC1EAE1EB01EB21EB41EB61EB81EBA1EBC1EBE1EC01EC21EC41EC61EC81ECA1ECC1ECE1ED01ED21ED41ED61ED81EDA1EDC1EDE1EE01EE21EE41EE61EE81EEA1EEC1EEE1EF01EF21EF41EF61EF81EFA1EFC1EFE1F08-1F0F1F18-1F1D1F28-1F2F1F38-1F3F1F48-1F4D1F591F5B1F5D1F5F1F68-1F6F1FB8-1FBB1FC8-1FCB1FD8-1FDB1FE8-1FEC1FF8-1FFB21022107210B-210D2110-211221152119-211D212421262128212A-212D2130-2133213E213F214521832C00-2C2E2C602C62-2C642C672C692C6B2C6D-2C702C722C752C7E-2C802C822C842C862C882C8A2C8C2C8E2C902C922C942C962C982C9A2C9C2C9E2CA02CA22CA42CA62CA82CAA2CAC2CAE2CB02CB22CB42CB62CB82CBA2CBC2CBE2CC02CC22CC42CC62CC82CCA2CCC2CCE2CD02CD22CD42CD62CD82CDA2CDC2CDE2CE02CE22CEB2CEDA640A642A644A646A648A64AA64CA64EA650A652A654A656A658A65AA65CA65EA662A664A666A668A66AA66CA680A682A684A686A688A68AA68CA68EA690A692A694A696A722A724A726A728A72AA72CA72EA732A734A736A738A73AA73CA73EA740A742A744A746A748A74AA74CA74EA750A752A754A756A758A75AA75CA75EA760A762A764A766A768A76AA76CA76EA779A77BA77DA77EA780A782A784A786A78BFF21-FF3A",Lt:"01C501C801CB01F21F88-1F8F1F98-1F9F1FA8-1FAF1FBC1FCC1FFC",Lm:"02B0-02C102C6-02D102E0-02E402EC02EE0374037A0559064006E506E607F407F507FA081A0824082809710E460EC610FC17D718431AA71C78-1C7D1D2C-1D611D781D9B-1DBF2071207F2090-20942C7D2D6F2E2F30053031-3035303B309D309E30FC-30FEA015A4F8-A4FDA60CA67FA717-A71FA770A788A9CFAA70AADDFF70FF9EFF9F",Lo:"01BB01C0-01C3029405D0-05EA05F0-05F20621-063F0641-064A066E066F0671-06D306D506EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA0800-08150904-0939093D09500958-096109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E450E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10D0-10FA1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317DC1820-18421844-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C771CE9-1CEC1CEE-1CF12135-21382D30-2D652D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE3006303C3041-3096309F30A1-30FA30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A014A016-A48CA4D0-A4F7A500-A60BA610-A61FA62AA62BA66EA6A0-A6E5A7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2AA00-AA28AA40-AA42AA44-AA4BAA60-AA6FAA71-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADBAADCABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF66-FF6FFF71-FF9DFFA0-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",M:"0300-036F0483-04890591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DE-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0903093C093E-094E0951-0955096209630981-098309BC09BE-09C409C709C809CB-09CD09D709E209E30A01-0A030A3C0A3E-0A420A470A480A4B-0A4D0A510A700A710A750A81-0A830ABC0ABE-0AC50AC7-0AC90ACB-0ACD0AE20AE30B01-0B030B3C0B3E-0B440B470B480B4B-0B4D0B560B570B620B630B820BBE-0BC20BC6-0BC80BCA-0BCD0BD70C01-0C030C3E-0C440C46-0C480C4A-0C4D0C550C560C620C630C820C830CBC0CBE-0CC40CC6-0CC80CCA-0CCD0CD50CD60CE20CE30D020D030D3E-0D440D46-0D480D4A-0D4D0D570D620D630D820D830DCA0DCF-0DD40DD60DD8-0DDF0DF20DF30E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F3E0F3F0F71-0F840F860F870F90-0F970F99-0FBC0FC6102B-103E1056-1059105E-10601062-10641067-106D1071-10741082-108D108F109A-109D135F1712-17141732-1734175217531772177317B6-17D317DD180B-180D18A91920-192B1930-193B19B0-19C019C819C91A17-1A1B1A55-1A5E1A60-1A7C1A7F1B00-1B041B34-1B441B6B-1B731B80-1B821BA1-1BAA1C24-1C371CD0-1CD21CD4-1CE81CED1CF21DC0-1DE61DFD-1DFF20D0-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66F-A672A67CA67DA6F0A6F1A802A806A80BA823-A827A880A881A8B4-A8C4A8E0-A8F1A926-A92DA947-A953A980-A983A9B3-A9C0AA29-AA36AA43AA4CAA4DAA7BAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE3-ABEAABECABEDFB1EFE00-FE0FFE20-FE26",Mn:"0300-036F0483-04870591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0902093C0941-0948094D0951-095509620963098109BC09C1-09C409CD09E209E30A010A020A3C0A410A420A470A480A4B-0A4D0A510A700A710A750A810A820ABC0AC1-0AC50AC70AC80ACD0AE20AE30B010B3C0B3F0B41-0B440B4D0B560B620B630B820BC00BCD0C3E-0C400C46-0C480C4A-0C4D0C550C560C620C630CBC0CBF0CC60CCC0CCD0CE20CE30D41-0D440D4D0D620D630DCA0DD2-0DD40DD60E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F71-0F7E0F80-0F840F860F870F90-0F970F99-0FBC0FC6102D-10301032-10371039103A103D103E10581059105E-10601071-1074108210851086108D109D135F1712-17141732-1734175217531772177317B7-17BD17C617C9-17D317DD180B-180D18A91920-19221927192819321939-193B1A171A181A561A58-1A5E1A601A621A65-1A6C1A73-1A7C1A7F1B00-1B031B341B36-1B3A1B3C1B421B6B-1B731B801B811BA2-1BA51BA81BA91C2C-1C331C361C371CD0-1CD21CD4-1CE01CE2-1CE81CED1DC0-1DE61DFD-1DFF20D0-20DC20E120E5-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66FA67CA67DA6F0A6F1A802A806A80BA825A826A8C4A8E0-A8F1A926-A92DA947-A951A980-A982A9B3A9B6-A9B9A9BCAA29-AA2EAA31AA32AA35AA36AA43AA4CAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE5ABE8ABEDFB1EFE00-FE0FFE20-FE26",Mc:"0903093E-09400949-094C094E0982098309BE-09C009C709C809CB09CC09D70A030A3E-0A400A830ABE-0AC00AC90ACB0ACC0B020B030B3E0B400B470B480B4B0B4C0B570BBE0BBF0BC10BC20BC6-0BC80BCA-0BCC0BD70C01-0C030C41-0C440C820C830CBE0CC0-0CC40CC70CC80CCA0CCB0CD50CD60D020D030D3E-0D400D46-0D480D4A-0D4C0D570D820D830DCF-0DD10DD8-0DDF0DF20DF30F3E0F3F0F7F102B102C10311038103B103C105610571062-10641067-106D108310841087-108C108F109A-109C17B617BE-17C517C717C81923-19261929-192B193019311933-193819B0-19C019C819C91A19-1A1B1A551A571A611A631A641A6D-1A721B041B351B3B1B3D-1B411B431B441B821BA11BA61BA71BAA1C24-1C2B1C341C351CE11CF2A823A824A827A880A881A8B4-A8C3A952A953A983A9B4A9B5A9BAA9BBA9BD-A9C0AA2FAA30AA33AA34AA4DAA7BABE3ABE4ABE6ABE7ABE9ABEAABEC",Me:"0488048906DE20DD-20E020E2-20E4A670-A672",N:"0030-003900B200B300B900BC-00BE0660-066906F0-06F907C0-07C90966-096F09E6-09EF09F4-09F90A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BF20C66-0C6F0C78-0C7E0CE6-0CEF0D66-0D750E50-0E590ED0-0ED90F20-0F331040-10491090-10991369-137C16EE-16F017E0-17E917F0-17F91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C5920702074-20792080-20892150-21822185-21892460-249B24EA-24FF2776-27932CFD30073021-30293038-303A3192-31953220-32293251-325F3280-328932B1-32BFA620-A629A6E6-A6EFA830-A835A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nd:"0030-00390660-066906F0-06F907C0-07C90966-096F09E6-09EF0A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BEF0C66-0C6F0CE6-0CEF0D66-0D6F0E50-0E590ED0-0ED90F20-0F291040-10491090-109917E0-17E91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C59A620-A629A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nl:"16EE-16F02160-21822185-218830073021-30293038-303AA6E6-A6EF",No:"00B200B300B900BC-00BE09F4-09F90BF0-0BF20C78-0C7E0D70-0D750F2A-0F331369-137C17F0-17F920702074-20792080-20892150-215F21892460-249B24EA-24FF2776-27932CFD3192-31953220-32293251-325F3280-328932B1-32BFA830-A835",P:"0021-00230025-002A002C-002F003A003B003F0040005B-005D005F007B007D00A100AB00B700BB00BF037E0387055A-055F0589058A05BE05C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F3A-0F3D0F850FD0-0FD4104A-104F10FB1361-13681400166D166E169B169C16EB-16ED1735173617D4-17D617D8-17DA1800-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD32010-20272030-20432045-20512053-205E207D207E208D208E2329232A2768-277527C527C627E6-27EF2983-299829D8-29DB29FC29FD2CF9-2CFC2CFE2CFF2E00-2E2E2E302E313001-30033008-30113014-301F3030303D30A030FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFD3EFD3FFE10-FE19FE30-FE52FE54-FE61FE63FE68FE6AFE6BFF01-FF03FF05-FF0AFF0C-FF0FFF1AFF1BFF1FFF20FF3B-FF3DFF3FFF5BFF5DFF5F-FF65",Pd:"002D058A05BE140018062010-20152E172E1A301C303030A0FE31FE32FE58FE63FF0D",Ps:"0028005B007B0F3A0F3C169B201A201E2045207D208D23292768276A276C276E27702772277427C527E627E827EA27EC27EE2983298529872989298B298D298F299129932995299729D829DA29FC2E222E242E262E283008300A300C300E3010301430163018301A301DFD3EFE17FE35FE37FE39FE3BFE3DFE3FFE41FE43FE47FE59FE5BFE5DFF08FF3BFF5BFF5FFF62",Pe:"0029005D007D0F3B0F3D169C2046207E208E232A2769276B276D276F27712773277527C627E727E927EB27ED27EF298429862988298A298C298E2990299229942996299829D929DB29FD2E232E252E272E293009300B300D300F3011301530173019301B301E301FFD3FFE18FE36FE38FE3AFE3CFE3EFE40FE42FE44FE48FE5AFE5CFE5EFF09FF3DFF5DFF60FF63",Pi:"00AB2018201B201C201F20392E022E042E092E0C2E1C2E20",Pf:"00BB2019201D203A2E032E052E0A2E0D2E1D2E21",Pc:"005F203F20402054FE33FE34FE4D-FE4FFF3F",Po:"0021-00230025-0027002A002C002E002F003A003B003F0040005C00A100B700BF037E0387055A-055F058905C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F850FD0-0FD4104A-104F10FB1361-1368166D166E16EB-16ED1735173617D4-17D617D8-17DA1800-18051807-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD3201620172020-20272030-2038203B-203E2041-20432047-205120532055-205E2CF9-2CFC2CFE2CFF2E002E012E06-2E082E0B2E0E-2E162E182E192E1B2E1E2E1F2E2A-2E2E2E302E313001-3003303D30FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFE10-FE16FE19FE30FE45FE46FE49-FE4CFE50-FE52FE54-FE57FE5F-FE61FE68FE6AFE6BFF01-FF03FF05-FF07FF0AFF0CFF0EFF0FFF1AFF1BFF1FFF20FF3CFF61FF64FF65",S:"0024002B003C-003E005E0060007C007E00A2-00A900AC00AE-00B100B400B600B800D700F702C2-02C502D2-02DF02E5-02EB02ED02EF-02FF03750384038503F604820606-0608060B060E060F06E906FD06FE07F609F209F309FA09FB0AF10B700BF3-0BFA0C7F0CF10CF20D790E3F0F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-139917DB194019E0-19FF1B61-1B6A1B74-1B7C1FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE20442052207A-207C208A-208C20A0-20B8210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B2140-2144214A-214D214F2190-2328232B-23E82400-24262440-244A249C-24E92500-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE27C0-27C427C7-27CA27CC27D0-27E527F0-29822999-29D729DC-29FB29FE-2B4C2B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F309B309C319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A700-A716A720A721A789A78AA828-A82BA836-A839AA77-AA79FB29FDFCFDFDFE62FE64-FE66FE69FF04FF0BFF1C-FF1EFF3EFF40FF5CFF5EFFE0-FFE6FFE8-FFEEFFFCFFFD",Sm:"002B003C-003E007C007E00AC00B100D700F703F60606-060820442052207A-207C208A-208C2140-2144214B2190-2194219A219B21A021A321A621AE21CE21CF21D221D421F4-22FF2308-230B23202321237C239B-23B323DC-23E125B725C125F8-25FF266F27C0-27C427C7-27CA27CC27D0-27E527F0-27FF2900-29822999-29D729DC-29FB29FE-2AFF2B30-2B442B47-2B4CFB29FE62FE64-FE66FF0BFF1C-FF1EFF5CFF5EFFE2FFE9-FFEC",Sc:"002400A2-00A5060B09F209F309FB0AF10BF90E3F17DB20A0-20B8A838FDFCFE69FF04FFE0FFE1FFE5FFE6",Sk:"005E006000A800AF00B400B802C2-02C502D2-02DF02E5-02EB02ED02EF-02FF0375038403851FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE309B309CA700-A716A720A721A789A78AFF3EFF40FFE3",So:"00A600A700A900AE00B000B60482060E060F06E906FD06FE07F609FA0B700BF3-0BF80BFA0C7F0CF10CF20D790F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-1399194019E0-19FF1B61-1B6A1B74-1B7C210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B214A214C214D214F2195-2199219C-219F21A121A221A421A521A7-21AD21AF-21CD21D021D121D321D5-21F32300-2307230C-231F2322-2328232B-237B237D-239A23B4-23DB23E2-23E82400-24262440-244A249C-24E92500-25B625B8-25C025C2-25F72600-266E2670-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE2800-28FF2B00-2B2F2B452B462B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A828-A82BA836A837A839AA77-AA79FDFDFFE4FFE8FFEDFFEEFFFCFFFD",Z:"002000A01680180E2000-200A20282029202F205F3000",Zs:"002000A01680180E2000-200A202F205F3000",Zl:"2028",Zp:"2029",C:"0000-001F007F-009F00AD03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-0605061C061D0620065F06DD070E070F074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17B417B517DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF200B-200F202A-202E2060-206F20722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-F8FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFD-FF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFFBFFFEFFFF",Cc:"0000-001F007F-009F",Cf:"00AD0600-060306DD070F17B417B5200B-200F202A-202E2060-2064206A-206FFEFFFFF9-FFFB",Co:"E000-F8FF",Cs:"D800-DFFF",Cn:"03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-05FF06040605061C061D0620065F070E074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF2065-206920722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-D7FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFDFEFEFF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFF8FFFEFFFF"})}),ace.define("ace/token_iterator",["require","exports","module"],function(e,t,i){"use strict";var n=function(e,t,i){this.$session=e,this.$row=t,this.$rowTokens=e.getTokens(t);var n=e.getTokenAt(t,i);this.$tokenIndex=n?n.index:-1};(function(){this.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},this.stepForward=function(){this.$tokenIndex+=1;for(var e;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,e||(e=this.$session.getLength()),this.$row>=e)return this.$row=e-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},this.getCurrentTokenRow=function(){return this.$row},this.getCurrentTokenColumn=function(){var e=this.$rowTokens,t=this.$tokenIndex,i=e[t].start;if(void 0!==i)return i;for(i=0;t>0;)t-=1,i+=e[t].value.length;return i}}).call(n.prototype),t.TokenIterator=n}),ace.define("ace/mode/text",["require","exports","module","ace/tokenizer","ace/mode/text_highlight_rules","ace/mode/behaviour","ace/unicode","ace/lib/lang","ace/token_iterator","ace/range"],function(e,t,i){"use strict";
var n=e("../tokenizer").Tokenizer,s=e("./text_highlight_rules").TextHighlightRules,o=e("./behaviour").Behaviour,r=e("../unicode"),a=e("../lib/lang"),l=e("../token_iterator").TokenIterator,c=e("../range").Range,u=function(){this.HighlightRules=s,this.$behaviour=new o};(function(){this.tokenRe=new RegExp("^["+r.packages.L+r.packages.Mn+r.packages.Mc+r.packages.Nd+r.packages.Pc+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+r.packages.L+r.packages.Mn+r.packages.Mc+r.packages.Nd+r.packages.Pc+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules,this.$tokenizer=new n(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(e,t,i,n){function s(e){for(var t=i;n>=t;t++)e(o.getLine(t),t)}var o=t.doc,r=!0,l=!0,c=1/0,u=t.getTabSize(),h=!1;if(this.lineCommentStart){if(Array.isArray(this.lineCommentStart))var d=this.lineCommentStart.map(a.escapeRegExp).join("|"),p=this.lineCommentStart[0];else var d=a.escapeRegExp(this.lineCommentStart),p=this.lineCommentStart;d=new RegExp("^(\\s*)(?:"+d+") ?"),h=t.getUseSoftTabs();var g=function(e,t){var i=e.match(d);if(i){var n=i[1].length,s=i[0].length;_(e,n,s)||" "!=i[0][s-1]||s--,o.removeInLine(t,n,s)}},m=p+" ",f=function(e,t){r&&!/\S/.test(e)||(_(e,c,c)?o.insertInLine({row:t,column:c},m):o.insertInLine({row:t,column:c},p))},v=function(e,t){return d.test(e)},_=function(e,t,i){for(var n=0;t--&&" "==e.charAt(t);)n++;if(n%u!=0)return!1;for(var n=0;" "==e.charAt(i++);)n++;return u>2?n%u!=u-1:n%u==0}}else{if(!this.blockComment)return!1;var p=this.blockComment.start,b=this.blockComment.end,d=new RegExp("^(\\s*)(?:"+a.escapeRegExp(p)+")"),w=new RegExp("(?:"+a.escapeRegExp(b)+")\\s*$"),f=function(e,t){v(e,t)||r&&!/\S/.test(e)||(o.insertInLine({row:t,column:e.length},b),o.insertInLine({row:t,column:c},p))},g=function(e,t){var i;(i=e.match(w))&&o.removeInLine(t,e.length-i[0].length,e.length),(i=e.match(d))&&o.removeInLine(t,i[1].length,i[0].length)},v=function(e,i){if(d.test(e))return!0;for(var n=t.getTokens(i),s=0;s<n.length;s++)if("comment"===n[s].type)return!0}}var y=1/0;s(function(e,t){var i=e.search(/\S/);-1!==i?(c>i&&(c=i),l&&!v(e,t)&&(l=!1)):y>e.length&&(y=e.length)}),c==1/0&&(c=y,r=!1,l=!1),h&&c%u!=0&&(c=Math.floor(c/u)*u),s(l?g:f)},this.toggleBlockComment=function(e,t,i,n){var s=this.blockComment;if(s){!s.start&&s[0]&&(s=s[0]);var o,r,a=new l(t,n.row,n.column),u=a.getCurrentToken(),h=(t.selection,t.selection.toOrientedRange());if(u&&/comment/.test(u.type)){for(var d,p;u&&/comment/.test(u.type);){var g=u.value.indexOf(s.start);if(-1!=g){var m=a.getCurrentTokenRow(),f=a.getCurrentTokenColumn()+g;d=new c(m,f,m,f+s.start.length);break}u=a.stepBackward()}for(var a=new l(t,n.row,n.column),u=a.getCurrentToken();u&&/comment/.test(u.type);){var g=u.value.indexOf(s.end);if(-1!=g){var m=a.getCurrentTokenRow(),f=a.getCurrentTokenColumn()+g;p=new c(m,f,m,f+s.end.length);break}u=a.stepForward()}p&&t.remove(p),d&&(t.remove(d),o=d.start.row,r=-s.start.length)}else r=s.start.length,o=i.start.row,t.insert(i.end,s.end),t.insert(i.start,s.start);h.start.row==o&&(h.start.column+=r),h.end.row==o&&(h.end.column+=r),t.selection.fromOrientedRange(h)}},this.getNextLineIndent=function(e,t,i){return this.$getIndent(t)},this.checkOutdent=function(e,t,i){return!1},this.autoOutdent=function(e,t,i){},this.$getIndent=function(e){return e.match(/^\s*/)[0]},this.createWorker=function(e){return null},this.createModeDelegates=function(e){this.$embeds=[],this.$modes={};for(var t in e)e[t]&&(this.$embeds.push(t),this.$modes[t]=new e[t]);for(var i=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"],t=0;t<i.length;t++)!function(e){var n=i[t],s=e[n];e[i[t]]=function(){return this.$delegator(n,arguments,s)}}(this)},this.$delegator=function(e,t,i){var n=t[0];"string"!=typeof n&&(n=n[0]);for(var s=0;s<this.$embeds.length;s++)if(this.$modes[this.$embeds[s]]){var o=n.split(this.$embeds[s]);if(!o[0]&&o[1]){t[0]=o[1];var r=this.$modes[this.$embeds[s]];return r[e].apply(r,t)}}var a=i.apply(this,t);return i?a:void 0},this.transformAction=function(e,t,i,n,s){if(this.$behaviour){var o=this.$behaviour.getBehaviours();for(var r in o)if(o[r][t]){var a=o[r][t].apply(this,arguments);if(a)return a}}},this.getKeywords=function(e){if(!this.completionKeywords){var t=this.$tokenizer.rules,i=[];for(var n in t)for(var s=t[n],o=0,r=s.length;r>o;o++)if("string"==typeof s[o].token)/keyword|support|storage/.test(s[o].token)&&i.push(s[o].regex);else if("object"==typeof s[o].token)for(var a=0,l=s[o].token.length;l>a;a++)if(/keyword|support|storage/.test(s[o].token[a])){var n=s[o].regex.match(/\(.+?\)/g)[a];i.push(n.substr(1,n.length-2))}this.completionKeywords=i}return e?i.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(e,t,i,n){var s=this.$keywordList||this.$createKeywordList();return s.map(function(e){return{name:e,value:e,score:0,meta:"keyword"}})},this.$id="ace/mode/text"}).call(u.prototype),t.Mode=u}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/event_emitter").EventEmitter,o=t.Anchor=function(e,t,i){this.$onChange=this.onChange.bind(this),this.attach(e),"undefined"==typeof i?this.setPosition(t.row,t.column):this.setPosition(t,i)};(function(){n.implement(this,s),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(e){var t=e.data,i=t.range;if((i.start.row!=i.end.row||i.start.row==this.row)&&!(i.start.row>this.row||i.start.row==this.row&&i.start.column>this.column)){var n=this.row,s=this.column,o=i.start,r=i.end;"insertText"===t.action?o.row===n&&o.column<=s?o.column===s&&this.$insertRight||(o.row===r.row?s+=r.column-o.column:(s-=o.column,n+=r.row-o.row)):o.row!==r.row&&o.row<n&&(n+=r.row-o.row):"insertLines"===t.action?o.row===n&&0===s&&this.$insertRight||o.row<=n&&(n+=r.row-o.row):"removeText"===t.action?o.row===n&&o.column<s?s=r.column>=s?o.column:Math.max(0,s-(r.column-o.column)):o.row!==r.row&&o.row<n?(r.row===n&&(s=Math.max(0,s-r.column)+o.column),n-=r.row-o.row):r.row===n&&(n-=r.row-o.row,s=Math.max(0,s-r.column)+o.column):"removeLines"==t.action&&o.row<=n&&(r.row<=n?n-=r.row-o.row:(n=o.row,s=0)),this.setPosition(n,s,!0)}},this.setPosition=function(e,t,i){var n;if(n=i?{row:e,column:t}:this.$clipPositionToDocument(e,t),this.row!=n.row||this.column!=n.column){var s={row:this.row,column:this.column};this.row=n.row,this.column=n.column,this._signal("change",{old:s,value:n})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(e){this.document=e||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(e,t){var i={};return e>=this.document.getLength()?(i.row=Math.max(0,this.document.getLength()-1),i.column=this.document.getLine(i.row).length):0>e?(i.row=0,i.column=0):(i.row=e,i.column=Math.min(this.document.getLine(i.row).length,Math.max(0,t))),0>t&&(i.column=0),i}}).call(o.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/lib/event_emitter","ace/range","ace/anchor"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/event_emitter").EventEmitter,o=e("./range").Range,r=e("./anchor").Anchor,a=function(e){this.$lines=[],0===e.length?this.$lines=[""]:Array.isArray(e)?this._insertLines(0,e):this.insert({row:0,column:0},e)};(function(){n.implement(this,s),this.setValue=function(e){var t=this.getLength();this.remove(new o(0,0,t,this.getLine(t-1).length)),this.insert({row:0,column:0},e)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(e,t){return new r(this,e,t)},0==="aaa".split(/a/).length?this.$split=function(e){return e.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(e){return e.split(/\r\n|\r|\n/)},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=t?t[1]:"\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(e){this.$newLineMode!==e&&(this.$newLineMode=e,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(e){return"\r\n"==e||"\r"==e||"\n"==e},this.getLine=function(e){return this.$lines[e]||""},this.getLines=function(e,t){return this.$lines.slice(e,t+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(e){if(e.start.row==e.end.row)return this.getLine(e.start.row).substring(e.start.column,e.end.column);var t=this.getLines(e.start.row,e.end.row);t[0]=(t[0]||"").substring(e.start.column);var i=t.length-1;return e.end.row-e.start.row==i&&(t[i]=t[i].substring(0,e.end.column)),t.join(this.getNewLineCharacter())},this.$clipPosition=function(e){var t=this.getLength();return e.row>=t?(e.row=Math.max(0,t-1),e.column=this.getLine(t-1).length):e.row<0&&(e.row=0),e},this.insert=function(e,t){if(!t||0===t.length)return e;e=this.$clipPosition(e),this.getLength()<=1&&this.$detectNewLine(t);var i=this.$split(t),n=i.splice(0,1)[0],s=0==i.length?null:i.splice(i.length-1,1)[0];return e=this.insertInLine(e,n),null!==s&&(e=this.insertNewLine(e),e=this._insertLines(e.row,i),e=this.insertInLine(e,s||"")),e},this.insertLines=function(e,t){return e>=this.getLength()?this.insert({row:e,column:0},"\n"+t.join("\n")):this._insertLines(Math.max(e,0),t)},this._insertLines=function(e,t){if(0==t.length)return{row:e,column:0};for(;t.length>61440;){var i=this._insertLines(e,t.slice(0,61440));t=t.slice(61440),e=i.row}var n=[e,0];n.push.apply(n,t),this.$lines.splice.apply(this.$lines,n);var s=new o(e,0,e+t.length,0),r={action:"insertLines",range:s,lines:t};return this._signal("change",{data:r}),s.end},this.insertNewLine=function(e){e=this.$clipPosition(e);var t=this.$lines[e.row]||"";this.$lines[e.row]=t.substring(0,e.column),this.$lines.splice(e.row+1,0,t.substring(e.column,t.length));var i={row:e.row+1,column:0},n={action:"insertText",range:o.fromPoints(e,i),text:this.getNewLineCharacter()};return this._signal("change",{data:n}),i},this.insertInLine=function(e,t){if(0==t.length)return e;var i=this.$lines[e.row]||"";this.$lines[e.row]=i.substring(0,e.column)+t+i.substring(e.column);var n={row:e.row,column:e.column+t.length},s={action:"insertText",range:o.fromPoints(e,n),text:t};return this._signal("change",{data:s}),n},this.remove=function(e){if(e instanceof o||(e=o.fromPoints(e.start,e.end)),e.start=this.$clipPosition(e.start),e.end=this.$clipPosition(e.end),e.isEmpty())return e.start;var t=e.start.row,i=e.end.row;if(e.isMultiLine()){var n=0==e.start.column?t:t+1,s=i-1;e.end.column>0&&this.removeInLine(i,0,e.end.column),s>=n&&this._removeLines(n,s),n!=t&&(this.removeInLine(t,e.start.column,this.getLine(t).length),this.removeNewLine(e.start.row))}else this.removeInLine(t,e.start.column,e.end.column);return e.start},this.removeInLine=function(e,t,i){if(t!=i){var n=new o(e,t,e,i),s=this.getLine(e),r=s.substring(t,i),a=s.substring(0,t)+s.substring(i,s.length);this.$lines.splice(e,1,a);var l={action:"removeText",range:n,text:r};return this._signal("change",{data:l}),n.start}},this.removeLines=function(e,t){return 0>e||t>=this.getLength()?this.remove(new o(e,0,t+1,0)):this._removeLines(e,t)},this._removeLines=function(e,t){var i=new o(e,0,t+1,0),n=this.$lines.splice(e,t-e+1),s={action:"removeLines",range:i,nl:this.getNewLineCharacter(),lines:n};return this._signal("change",{data:s}),n},this.removeNewLine=function(e){var t=this.getLine(e),i=this.getLine(e+1),n=new o(e,t.length,e+1,0),s=t+i;this.$lines.splice(e,2,s);var r={action:"removeText",range:n,text:this.getNewLineCharacter()};this._signal("change",{data:r})},this.replace=function(e,t){if(e instanceof o||(e=o.fromPoints(e.start,e.end)),0==t.length&&e.isEmpty())return e.start;if(t==this.getTextRange(e))return e.end;if(this.remove(e),t)var i=this.insert(e.start,t);else i=e.start;return i},this.applyDeltas=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=o.fromPoints(i.range.start,i.range.end);"insertLines"==i.action?this.insertLines(n.start.row,i.lines):"insertText"==i.action?this.insert(n.start,i.text):"removeLines"==i.action?this._removeLines(n.start.row,n.end.row-1):"removeText"==i.action&&this.remove(n)}},this.revertDeltas=function(e){for(var t=e.length-1;t>=0;t--){var i=e[t],n=o.fromPoints(i.range.start,i.range.end);"insertLines"==i.action?this._removeLines(n.start.row,n.end.row-1):"insertText"==i.action?this.remove(n):"removeLines"==i.action?this._insertLines(n.start.row,i.lines):"removeText"==i.action&&this.insert(n.start,i.text)}},this.indexToPosition=function(e,t){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,s=t||0,o=i.length;o>s;s++)if(e-=i[s].length+n,0>e)return{row:s,column:e+i[s].length+n};return{row:o-1,column:i[o-1].length}},this.positionToIndex=function(e,t){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,s=0,o=Math.min(e.row,i.length),r=t||0;o>r;++r)s+=i[r].length+n;return s+e.column}}).call(a.prototype),t.Document=a}),ace.define("ace/background_tokenizer",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/event_emitter").EventEmitter,o=function(e,t){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=e;var i=this;this.$worker=function(){if(i.running){for(var e=new Date,t=i.currentLine,n=-1,s=i.doc;i.lines[t];)t++;var o=t,r=s.getLength(),a=0;for(i.running=!1;r>t;){i.$tokenizeRow(t),n=t;do t++;while(i.lines[t]);if(a++,a%5==0&&new Date-e>20)return i.running=setTimeout(i.$worker,20),void(i.currentLine=t)}i.currentLine=t,n>=o&&i.fireUpdateEvent(o,n)}}};(function(){n.implement(this,s),this.setTokenizer=function(e){this.tokenizer=e,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(e){this.doc=e,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(e,t){var i={first:e,last:t};this._signal("update",{data:i})},this.start=function(e){this.currentLine=Math.min(e||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},this.$updateOnChange=function(e){var t=e.range,i=t.start.row,n=t.end.row-i;if(0===n)this.lines[i]=null;else if("removeText"==e.action||"removeLines"==e.action)this.lines.splice(i,n+1,null),this.states.splice(i,n+1,null);else{var s=Array(n+1);s.unshift(i,1),this.lines.splice.apply(this.lines,s),this.states.splice.apply(this.states,s)}this.currentLine=Math.min(i,this.currentLine,this.doc.getLength()),this.stop()},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(e){return this.lines[e]||this.$tokenizeRow(e)},this.getState=function(e){return this.currentLine==e&&this.$tokenizeRow(e),this.states[e]||"start"},this.$tokenizeRow=function(e){var t=this.doc.getLine(e),i=this.states[e-1],n=this.tokenizer.getLineTokens(t,i,e);return this.states[e]+""!=n.state+""?(this.states[e]=n.state,this.lines[e+1]=null,this.currentLine>e+1&&(this.currentLine=e+1)):this.currentLine==e&&(this.currentLine=e+1),this.lines[e]=n.tokens}}).call(o.prototype),t.BackgroundTokenizer=o}),ace.define("ace/search_highlight",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],function(e,t,i){"use strict";var n=e("./lib/lang"),s=(e("./lib/oop"),e("./range").Range),o=function(e,t,i){this.setRegexp(e),this.clazz=t,this.type=i||"text"};(function(){this.MAX_RANGES=500,this.setRegexp=function(e){this.regExp+""!=e+""&&(this.regExp=e,this.cache=[])},this.update=function(e,t,i,o){if(this.regExp)for(var r=o.firstRow,a=o.lastRow,l=r;a>=l;l++){var c=this.cache[l];null==c&&(c=n.getMatchOffsets(i.getLine(l),this.regExp),c.length>this.MAX_RANGES&&(c=c.slice(0,this.MAX_RANGES)),c=c.map(function(e){return new s(l,e.offset,l,e.offset+e.length)}),this.cache[l]=c.length?c:"");for(var u=c.length;u--;)t.drawSingleLineMarker(e,c[u].toScreenRange(i),this.clazz,o)}}}).call(o.prototype),t.SearchHighlight=o}),ace.define("ace/edit_session/fold_line",["require","exports","module","ace/range"],function(e,t,i){"use strict";function n(e,t){this.foldData=e,Array.isArray(t)?this.folds=t:t=this.folds=[t];var i=t[t.length-1];this.range=new s(t[0].start.row,t[0].start.column,i.end.row,i.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach(function(e){e.setFoldLine(this)},this)}var s=e("../range").Range;(function(){this.shiftRow=function(e){this.start.row+=e,this.end.row+=e,this.folds.forEach(function(t){t.start.row+=e,t.end.row+=e})},this.addFold=function(e){if(e.sameRow){if(e.start.row<this.startRow||e.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(e),this.folds.sort(function(e,t){return-e.range.compareEnd(t.start.row,t.start.column)}),this.range.compareEnd(e.start.row,e.start.column)>0?(this.end.row=e.end.row,this.end.column=e.end.column):this.range.compareStart(e.end.row,e.end.column)<0&&(this.start.row=e.start.row,this.start.column=e.start.column)}else if(e.start.row==this.end.row)this.folds.push(e),this.end.row=e.end.row,this.end.column=e.end.column;else{if(e.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(e),this.start.row=e.start.row,this.start.column=e.start.column}e.foldLine=this},this.containsRow=function(e){return e>=this.start.row&&e<=this.end.row},this.walk=function(e,t,i){var n,s,o,r=0,a=this.folds,l=!0;null==t&&(t=this.end.row,i=this.end.column);for(var c=0;c<a.length;c++){if(n=a[c],s=n.range.compareStart(t,i),-1==s)return void e(null,t,i,r,l);if(o=e(null,n.start.row,n.start.column,r,l),o=!o&&e(n.placeholder,n.start.row,n.start.column,r),o||0==s)return;l=!n.sameRow,r=n.end.column}e(null,t,i,r,l)},this.getNextFoldTo=function(e,t){for(var i,n,s=0;s<this.folds.length;s++){if(i=this.folds[s],n=i.range.compareEnd(e,t),-1==n)return{fold:i,kind:"after"};if(0==n)return{fold:i,kind:"inside"}}return null},this.addRemoveChars=function(e,t,i){var n,s,o=this.getNextFoldTo(e,t);if(o)if(n=o.fold,"inside"==o.kind&&n.start.column!=t&&n.start.row!=e)window.console&&window.console.log(e,t,n);else if(n.start.row==e){s=this.folds;var r=s.indexOf(n);for(0==r&&(this.start.column+=i),r;r<s.length;r++){if(n=s[r],n.start.column+=i,!n.sameRow)return;n.end.column+=i}this.end.column+=i}},this.split=function(e,t){var i=this.getNextFoldTo(e,t).fold,s=this.folds,o=this.foldData;if(!i)return null;var r=s.indexOf(i),a=s[r-1];this.end.row=a.end.row,this.end.column=a.end.column,s=s.splice(r,s.length-r);var l=new n(o,s);return o.splice(o.indexOf(this)+1,0,l),l},this.merge=function(e){for(var t=e.folds,i=0;i<t.length;i++)this.addFold(t[i]);var n=this.foldData;n.splice(n.indexOf(e),1)},this.toString=function(){var e=[this.range.toString()+": ["];return this.folds.forEach(function(t){e.push("  "+t.toString())}),e.push("]"),e.join("\n")},this.idxToPosition=function(e){for(var t,i=0,n=0;n<this.folds.length;n++){var t=this.folds[n];if(e-=t.start.column-i,0>e)return{row:t.start.row,column:t.start.column+e};if(e-=t.placeholder.length,0>e)return t.start;i=t.end.column}return{row:this.end.row,column:this.end.column+e}}}).call(n.prototype),t.FoldLine=n}),ace.define("ace/range_list",["require","exports","module","ace/range"],function(e,t,i){"use strict";var n=e("./range").Range,s=n.comparePoints,o=function(){this.ranges=[]};(function(){this.comparePoints=s,this.pointIndex=function(e,t,i){for(var n=this.ranges,o=i||0;o<n.length;o++){var r=n[o],a=s(e,r.end);if(!(a>0)){var l=s(e,r.start);return 0===a?t&&0!==l?-o-2:o:l>0||0===l&&!t?o:-o-1}}return-o-1},this.add=function(e){var t=!e.isEmpty(),i=this.pointIndex(e.start,t);0>i&&(i=-i-1);var n=this.pointIndex(e.end,t,i);return 0>n?n=-n-1:n++,this.ranges.splice(i,n-i,e)},this.addList=function(e){for(var t=[],i=e.length;i--;)t.push.call(t,this.add(e[i]));return t},this.substractPoint=function(e){var t=this.pointIndex(e);return t>=0?this.ranges.splice(t,1):void 0},this.merge=function(){var e=[],t=this.ranges;t=t.sort(function(e,t){return s(e.start,t.start)});for(var i,n=t[0],o=1;o<t.length;o++){i=n,n=t[o];var r=s(i.end,n.start);0>r||(0!=r||i.isEmpty()||n.isEmpty())&&(s(i.end,n.end)<0&&(i.end.row=n.end.row,i.end.column=n.end.column),t.splice(o,1),e.push(n),n=i,o--)}return this.ranges=t,e},this.contains=function(e,t){return this.pointIndex({row:e,column:t})>=0},this.containsPoint=function(e){return this.pointIndex(e)>=0},this.rangeAtPoint=function(e){var t=this.pointIndex(e);return t>=0?this.ranges[t]:void 0},this.clipRows=function(e,t){var i=this.ranges;if(i[0].start.row>t||i[i.length-1].start.row<e)return[];var n=this.pointIndex({row:e,column:0});0>n&&(n=-n-1);var s=this.pointIndex({row:t,column:0},n);0>s&&(s=-s-1);for(var o=[],r=n;s>r;r++)o.push(i[r]);return o},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(e){this.session&&this.detach(),this.session=e,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},this.$onChange=function(e){var t=e.data.range;if("i"==e.data.action[0])var i=t.start,n=t.end;else var n=t.start,i=t.end;for(var s=i.row,o=n.row,r=o-s,a=-i.column+n.column,l=this.ranges,c=0,u=l.length;u>c;c++){var h=l[c];if(!(h.end.row<s)){if(h.start.row>s)break;if(h.start.row==s&&h.start.column>=i.column&&(h.start.column==i.column&&this.$insertRight||(h.start.column+=a,h.start.row+=r)),h.end.row==s&&h.end.column>=i.column){if(h.end.column==i.column&&this.$insertRight)continue;h.end.column==i.column&&a>0&&u-1>c&&h.end.column>h.start.column&&h.end.column==l[c+1].start.column&&(h.end.column-=a),h.end.column+=a,h.end.row+=r}}}if(0!=r&&u>c)for(;u>c;c++){var h=l[c];h.start.row+=r,h.end.row+=r}}}).call(o.prototype),t.RangeList=o}),ace.define("ace/edit_session/fold",["require","exports","module","ace/range","ace/range_list","ace/lib/oop"],function(e,t,i){"use strict";function n(e,t){e.row-=t.row,0==e.row&&(e.column-=t.column)}function s(e,t){n(e.start,t),n(e.end,t)}function o(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row}function r(e,t){o(e.start,t),o(e.end,t)}var a=(e("../range").Range,e("../range_list").RangeList),l=e("../lib/oop"),c=t.Fold=function(e,t){this.foldLine=null,this.placeholder=t,this.range=e,this.start=e.start,this.end=e.end,this.sameRow=e.start.row==e.end.row,this.subFolds=this.ranges=[]};l.inherits(c,a),function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},this.setFoldLine=function(e){this.foldLine=e,this.subFolds.forEach(function(t){t.setFoldLine(e)})},this.clone=function(){var e=this.range.clone(),t=new c(e,this.placeholder);return this.subFolds.forEach(function(e){t.subFolds.push(e.clone())}),t.collapseChildren=this.collapseChildren,t},this.addSubFold=function(e){if(!this.range.isEqual(e)){if(!this.range.containsRange(e))throw new Error("A fold can't intersect already existing fold"+e.range+this.range);s(e,this.start);for(var t=e.start.row,i=e.start.column,n=0,o=-1;n<this.subFolds.length&&(o=this.subFolds[n].range.compare(t,i),1==o);n++);var r=this.subFolds[n];if(0==o)return r.addSubFold(e);for(var t=e.range.end.row,i=e.range.end.column,a=n,o=-1;a<this.subFolds.length&&(o=this.subFolds[a].range.compare(t,i),1==o);a++);this.subFolds[a];if(0==o)throw new Error("A fold can't intersect already existing fold"+e.range+this.range);this.subFolds.splice(n,a-n,e);return e.setFoldLine(this.foldLine),e}},this.restoreRange=function(e){return r(e,this.start)}}.call(c.prototype)}),ace.define("ace/edit_session/folding",["require","exports","module","ace/range","ace/edit_session/fold_line","ace/edit_session/fold","ace/token_iterator"],function(e,t,i){"use strict";function n(){this.getFoldAt=function(e,t,i){var n=this.getFoldLine(e);if(!n)return null;for(var s=n.folds,o=0;o<s.length;o++){var r=s[o];if(r.range.contains(e,t)){if(1==i&&r.range.isEnd(e,t))continue;if(-1==i&&r.range.isStart(e,t))continue;return r}}},this.getFoldsInRange=function(e){var t=e.start,i=e.end,n=this.$foldData,s=[];t.column+=1,i.column-=1;for(var o=0;o<n.length;o++){var r=n[o].range.compareRange(e);if(2!=r){if(-2==r)break;for(var a=n[o].folds,l=0;l<a.length;l++){var c=a[l];if(r=c.range.compareRange(e),-2==r)break;if(2!=r){if(42==r)break;s.push(c)}}}}return t.column-=1,i.column+=1,s},this.getFoldsInRangeList=function(e){if(Array.isArray(e)){var t=[];e.forEach(function(e){t=t.concat(this.getFoldsInRange(e))},this)}else var t=this.getFoldsInRange(e);return t},this.getAllFolds=function(){for(var e=[],t=this.$foldData,i=0;i<t.length;i++)for(var n=0;n<t[i].folds.length;n++)e.push(t[i].folds[n]);return e},this.getFoldStringAt=function(e,t,i,n){if(n=n||this.getFoldLine(e),!n)return null;for(var s,o,r={end:{column:0}},a=0;a<n.folds.length;a++){o=n.folds[a];var l=o.range.compareEnd(e,t);if(-1==l){s=this.getLine(o.start.row).substring(r.end.column,o.start.column);break}if(0===l)return null;r=o}return s||(s=this.getLine(o.start.row).substring(r.end.column)),-1==i?s.substring(0,t-r.end.column):1==i?s.substring(t-r.end.column):s},this.getFoldLine=function(e,t){var i=this.$foldData,n=0;for(t&&(n=i.indexOf(t)),-1==n&&(n=0),n;n<i.length;n++){var s=i[n];if(s.start.row<=e&&s.end.row>=e)return s;if(s.end.row>e)return null}return null},this.getNextFoldLine=function(e,t){var i=this.$foldData,n=0;for(t&&(n=i.indexOf(t)),-1==n&&(n=0),n;n<i.length;n++){var s=i[n];if(s.end.row>=e)return s}return null},this.getFoldedRowCount=function(e,t){for(var i=this.$foldData,n=t-e+1,s=0;s<i.length;s++){var o=i[s],r=o.end.row,a=o.start.row;if(r>=t){t>a&&(a>=e?n-=t-a:n=0);break}r>=e&&(n-=a>=e?r-a:r-e+1)}return n},this.$addFoldLine=function(e){return this.$foldData.push(e),this.$foldData.sort(function(e,t){return e.start.row-t.start.row}),e},this.addFold=function(e,t){var i,n=this.$foldData,s=!1;e instanceof r?i=e:(i=new r(t,e),i.collapseChildren=t.collapseChildren),this.$clipRangeToDocument(i.range);var a=i.start.row,l=i.start.column,c=i.end.row,u=i.end.column;if(!(c>a||a==c&&u-2>=l))throw new Error("The range has to be at least 2 characters width");var h=this.getFoldAt(a,l,1),d=this.getFoldAt(c,u,-1);if(h&&d==h)return h.addSubFold(i);if(h&&!h.range.isStart(a,l)||d&&!d.range.isEnd(c,u))throw new Error("A fold can't intersect already existing fold"+i.range+h.range);var p=this.getFoldsInRange(i.range);p.length>0&&(this.removeFolds(p),p.forEach(function(e){i.addSubFold(e)}));for(var g=0;g<n.length;g++){var m=n[g];if(c==m.start.row){m.addFold(i),s=!0;break}if(a==m.end.row){if(m.addFold(i),s=!0,!i.sameRow){var f=n[g+1];if(f&&f.start.row==c){m.merge(f);break}}break}if(c<=m.start.row)break}return s||(m=this.$addFoldLine(new o(this.$foldData,i))),this.$useWrapMode?this.$updateWrapData(m.start.row,m.start.row):this.$updateRowLengthCache(m.start.row,m.start.row),this.$modified=!0,this._emit("changeFold",{data:i,action:"add"}),i},this.addFolds=function(e){e.forEach(function(e){this.addFold(e)},this)},this.removeFold=function(e){var t=e.foldLine,i=t.start.row,n=t.end.row,s=this.$foldData,o=t.folds;if(1==o.length)s.splice(s.indexOf(t),1);else if(t.range.isEnd(e.end.row,e.end.column))o.pop(),t.end.row=o[o.length-1].end.row,t.end.column=o[o.length-1].end.column;else if(t.range.isStart(e.start.row,e.start.column))o.shift(),t.start.row=o[0].start.row,t.start.column=o[0].start.column;else if(e.sameRow)o.splice(o.indexOf(e),1);else{var r=t.split(e.start.row,e.start.column);o=r.folds,o.shift(),r.start.row=o[0].start.row,r.start.column=o[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(i,n):this.$updateRowLengthCache(i,n)),this.$modified=!0,this._emit("changeFold",{data:e,action:"remove"})},this.removeFolds=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i]);t.forEach(function(e){this.removeFold(e)},this),this.$modified=!0},this.expandFold=function(e){this.removeFold(e),e.subFolds.forEach(function(t){e.restoreRange(t),this.addFold(t)},this),e.collapseChildren>0&&this.foldAll(e.start.row+1,e.end.row,e.collapseChildren-1),e.subFolds=[]},this.expandFolds=function(e){e.forEach(function(e){this.expandFold(e)},this)},this.unfold=function(e,t){var i,n;if(null==e?(i=new s(0,0,this.getLength(),0),t=!0):i="number"==typeof e?new s(e,0,e,this.getLine(e).length):"row"in e?s.fromPoints(e,e):e,n=this.getFoldsInRangeList(i),t)this.removeFolds(n);else for(var o=n;o.length;)this.expandFolds(o),o=this.getFoldsInRangeList(i);return n.length?n:void 0},this.isRowFolded=function(e,t){return!!this.getFoldLine(e,t)},this.getRowFoldEnd=function(e,t){var i=this.getFoldLine(e,t);return i?i.end.row:e},this.getRowFoldStart=function(e,t){var i=this.getFoldLine(e,t);return i?i.start.row:e},this.getFoldDisplayLine=function(e,t,i,n,s){null==n&&(n=e.start.row),null==s&&(s=0),null==t&&(t=e.end.row),null==i&&(i=this.getLine(t).length);var o=this.doc,r="";return e.walk(function(e,t,i,a){if(!(n>t)){if(t==n){if(s>i)return;a=Math.max(s,a)}r+=null!=e?e:o.getLine(t).substring(a,i)}},t,i),r},this.getDisplayLine=function(e,t,i,n){var s=this.getFoldLine(e);if(s)return this.getFoldDisplayLine(s,e,t,i,n);var o;return o=this.doc.getLine(e),o.substring(n||0,t||o.length)},this.$cloneFoldData=function(){var e=[];return e=this.$foldData.map(function(t){var i=t.folds.map(function(e){return e.clone()});return new o(e,i)})},this.toggleFold=function(e){var t,i,n=this.selection,s=n.getRange();if(s.isEmpty()){var o=s.start;if(t=this.getFoldAt(o.row,o.column))return void this.expandFold(t);(i=this.findMatchingBracket(o))?1==s.comparePoint(i)?s.end=i:(s.start=i,s.start.column++,s.end.column--):(i=this.findMatchingBracket({row:o.row,column:o.column+1}))?(1==s.comparePoint(i)?s.end=i:s.start=i,s.start.column++):s=this.getCommentFoldRange(o.row,o.column)||s}else{var r=this.getFoldsInRange(s);if(e&&r.length)return void this.expandFolds(r);1==r.length&&(t=r[0])}if(t||(t=this.getFoldAt(s.start.row,s.start.column)),t&&t.range.toString()==s.toString())return void this.expandFold(t);var a="...";if(!s.isMultiLine()){if(a=this.getTextRange(s),a.length<4)return;a=a.trim().substring(0,2)+".."}this.addFold(a,s)},this.getCommentFoldRange=function(e,t,i){var n=new a(this,e,t),o=n.getCurrentToken();if(o&&/^comment|string/.test(o.type)){var r=new s,l=new RegExp(o.type.replace(/\..*/,"\\."));if(1!=i){do o=n.stepBackward();while(o&&l.test(o.type));n.stepForward()}if(r.start.row=n.getCurrentTokenRow(),r.start.column=n.getCurrentTokenColumn()+2,n=new a(this,e,t),-1!=i){do o=n.stepForward();while(o&&l.test(o.type));o=n.stepBackward()}else o=n.getCurrentToken();return r.end.row=n.getCurrentTokenRow(),r.end.column=n.getCurrentTokenColumn()+o.value.length-2,r}},this.foldAll=function(e,t,i){void 0==i&&(i=1e5);var n=this.foldWidgets;if(n){t=t||this.getLength(),e=e||0;for(var s=e;t>s;s++)if(null==n[s]&&(n[s]=this.getFoldWidget(s)),"start"==n[s]){var o=this.getFoldWidgetRange(s);if(o&&o.isMultiLine()&&o.end.row<=t&&o.start.row>=e){s=o.end.row;try{var r=this.addFold("...",o);r&&(r.collapseChildren=i)}catch(a){}}}}},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(e){if(!this.$foldStyles[e])throw new Error("invalid fold style: "+e+"["+Object.keys(this.$foldStyles).join(", ")+"]");
if(this.$foldStyle!=e){this.$foldStyle=e,"manual"==e&&this.unfold();var t=this.$foldMode;this.$setFolding(null),this.$setFolding(t)}},this.$setFolding=function(e){if(this.$foldMode!=e){if(this.$foldMode=e,this.removeListener("change",this.$updateFoldWidgets),this._emit("changeAnnotation"),!e||"manual"==this.$foldStyle)return void(this.foldWidgets=null);this.foldWidgets=[],this.getFoldWidget=e.getFoldWidget.bind(e,this,this.$foldStyle),this.getFoldWidgetRange=e.getFoldWidgetRange.bind(e,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets)}},this.getParentFoldRangeData=function(e,t){var i=this.foldWidgets;if(!i||t&&i[e])return{};for(var n,s=e-1;s>=0;){var o=i[s];if(null==o&&(o=i[s]=this.getFoldWidget(s)),"start"==o){var r=this.getFoldWidgetRange(s);if(n||(n=r),r&&r.end.row>=e)break}s--}return{range:-1!==s&&r,firstRange:n}},this.onFoldWidgetClick=function(e,t){t=t.domEvent;var i={children:t.shiftKey,all:t.ctrlKey||t.metaKey,siblings:t.altKey},n=this.$toggleFoldWidget(e,i);if(!n){var s=t.target||t.srcElement;s&&/ace_fold-widget/.test(s.className)&&(s.className+=" ace_invalid")}},this.$toggleFoldWidget=function(e,t){if(this.getFoldWidget){var i=this.getFoldWidget(e),n=this.getLine(e),s="end"===i?-1:1,o=this.getFoldAt(e,-1===s?0:n.length,s);if(o)return void(t.children||t.all?this.removeFold(o):this.expandFold(o));var r=this.getFoldWidgetRange(e,!0);if(r&&!r.isMultiLine()&&(o=this.getFoldAt(r.start.row,r.start.column,1),o&&r.isEqual(o.range)))return void this.removeFold(o);if(t.siblings){var a=this.getParentFoldRangeData(e);if(a.range)var l=a.range.start.row+1,c=a.range.end.row;this.foldAll(l,c,t.all?1e4:0)}else t.children?(c=r?r.end.row:this.getLength(),this.foldAll(e+1,r.end.row,t.all?1e4:0)):r&&(t.all&&(r.collapseChildren=1e4),this.addFold("...",r));return r}},this.toggleFoldWidget=function(e){var t=this.selection.getCursor().row;t=this.getRowFoldStart(t);var i=this.$toggleFoldWidget(t,{});if(!i){var n=this.getParentFoldRangeData(t,!0);if(i=n.range||n.firstRange){t=i.start.row;var s=this.getFoldAt(t,this.getLine(t).length,1);s?this.removeFold(s):this.addFold("...",i)}}},this.updateFoldWidgets=function(e){var t=e.data,i=t.range,n=i.start.row,s=i.end.row-n;if(0===s)this.foldWidgets[n]=null;else if("removeText"==t.action||"removeLines"==t.action)this.foldWidgets.splice(n,s+1,null);else{var o=Array(s+1);o.unshift(n,1),this.foldWidgets.splice.apply(this.foldWidgets,o)}}}var s=e("../range").Range,o=e("./fold_line").FoldLine,r=e("./fold").Fold,a=e("../token_iterator").TokenIterator;t.Folding=n}),ace.define("ace/edit_session/bracket_match",["require","exports","module","ace/token_iterator","ace/range"],function(e,t,i){"use strict";function n(){this.findMatchingBracket=function(e,t){if(0==e.column)return null;var i=t||this.getLine(e.row).charAt(e.column-1);if(""==i)return null;var n=i.match(/([\(\[\{])|([\)\]\}])/);return n?n[1]?this.$findClosingBracket(n[1],e):this.$findOpeningBracket(n[2],e):null},this.getBracketRange=function(e){var t,i=this.getLine(e.row),n=!0,s=i.charAt(e.column-1),r=s&&s.match(/([\(\[\{])|([\)\]\}])/);if(r||(s=i.charAt(e.column),e={row:e.row,column:e.column+1},r=s&&s.match(/([\(\[\{])|([\)\]\}])/),n=!1),!r)return null;if(r[1]){var a=this.$findClosingBracket(r[1],e);if(!a)return null;t=o.fromPoints(e,a),n||(t.end.column++,t.start.column--),t.cursor=t.end}else{var a=this.$findOpeningBracket(r[2],e);if(!a)return null;t=o.fromPoints(a,e),n||(t.start.column++,t.end.column--),t.cursor=t.start}return t},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{"},this.$findOpeningBracket=function(e,t,i){var n=this.$brackets[e],o=1,r=new s(this,t.row,t.column),a=r.getCurrentToken();if(a||(a=r.stepForward()),a){i||(i=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("rparen",".paren")+")+"));for(var l=t.column-r.getCurrentTokenColumn()-2,c=a.value;;){for(;l>=0;){var u=c.charAt(l);if(u==n){if(o-=1,0==o)return{row:r.getCurrentTokenRow(),column:l+r.getCurrentTokenColumn()}}else u==e&&(o+=1);l-=1}do a=r.stepBackward();while(a&&!i.test(a.type));if(null==a)break;c=a.value,l=c.length-1}return null}},this.$findClosingBracket=function(e,t,i){var n=this.$brackets[e],o=1,r=new s(this,t.row,t.column),a=r.getCurrentToken();if(a||(a=r.stepForward()),a){i||(i=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("lparen",".paren")+")+"));for(var l=t.column-r.getCurrentTokenColumn();;){for(var c=a.value,u=c.length;u>l;){var h=c.charAt(l);if(h==n){if(o-=1,0==o)return{row:r.getCurrentTokenRow(),column:l+r.getCurrentTokenColumn()}}else h==e&&(o+=1);l+=1}do a=r.stepForward();while(a&&!i.test(a.type));if(null==a)break;l=0}return null}}}var s=e("../token_iterator").TokenIterator,o=e("../range").Range;t.BracketMatch=n}),ace.define("ace/edit_session",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/config","ace/lib/event_emitter","ace/selection","ace/mode/text","ace/range","ace/document","ace/background_tokenizer","ace/search_highlight","ace/edit_session/folding","ace/edit_session/bracket_match"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/lang"),o=e("./config"),r=e("./lib/event_emitter").EventEmitter,a=e("./selection").Selection,l=e("./mode/text").Mode,c=e("./range").Range,u=e("./document").Document,h=e("./background_tokenizer").BackgroundTokenizer,d=e("./search_highlight").SearchHighlight,p=function(e,t){this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.$foldData.toString=function(){return this.join("\n")},this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==typeof e&&e.getLine||(e=new u(e)),this.setDocument(e),this.selection=new a(this),o.resetOptions(this),this.setMode(t),o._signal("session",this)};(function(){function t(e){return 4352>e?!1:e>=4352&&4447>=e||e>=4515&&4519>=e||e>=4602&&4607>=e||e>=9001&&9002>=e||e>=11904&&11929>=e||e>=11931&&12019>=e||e>=12032&&12245>=e||e>=12272&&12283>=e||e>=12288&&12350>=e||e>=12353&&12438>=e||e>=12441&&12543>=e||e>=12549&&12589>=e||e>=12593&&12686>=e||e>=12688&&12730>=e||e>=12736&&12771>=e||e>=12784&&12830>=e||e>=12832&&12871>=e||e>=12880&&13054>=e||e>=13056&&19903>=e||e>=19968&&42124>=e||e>=42128&&42182>=e||e>=43360&&43388>=e||e>=44032&&55203>=e||e>=55216&&55238>=e||e>=55243&&55291>=e||e>=63744&&64255>=e||e>=65040&&65049>=e||e>=65072&&65106>=e||e>=65108&&65126>=e||e>=65128&&65131>=e||e>=65281&&65376>=e||e>=65504&&65510>=e}n.implement(this,r),this.setDocument=function(e){this.doc&&this.doc.removeListener("change",this.$onChange),this.doc=e,e.on("change",this.$onChange),this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},this.getDocument=function(){return this.doc},this.$resetRowCache=function(e){if(!e)return this.$docRowCache=[],void(this.$screenRowCache=[]);var t=this.$docRowCache.length,i=this.$getRowCacheIndex(this.$docRowCache,e)+1;t>i&&(this.$docRowCache.splice(i,t),this.$screenRowCache.splice(i,t))},this.$getRowCacheIndex=function(e,t){for(var i=0,n=e.length-1;n>=i;){var s=i+n>>1,o=e[s];if(t>o)i=s+1;else{if(!(o>t))return s;n=s-1}}return i-1},this.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.bgTokenizer&&this.bgTokenizer.start(0)},this.onChangeFold=function(e){var t=e.data;this.$resetRowCache(t.start.row)},this.onChange=function(e){var t=e.data;this.$modified=!0,this.$resetRowCache(t.range.start.row);var i=this.$updateInternalDataOnChange(e);this.$fromUndo||!this.$undoManager||t.ignore||(this.$deltasDoc.push(t),i&&0!=i.length&&this.$deltasFold.push({action:"removeFolds",folds:i}),this.$informUndoManager.schedule()),this.bgTokenizer.$updateOnChange(t),this._signal("change",e)},this.setValue=function(e){this.doc.setValue(e),this.selection.moveTo(0,0),this.$resetRowCache(0),this.$deltas=[],this.$deltasDoc=[],this.$deltasFold=[],this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},this.getValue=this.toString=function(){return this.doc.getValue()},this.getSelection=function(){return this.selection},this.getState=function(e){return this.bgTokenizer.getState(e)},this.getTokens=function(e){return this.bgTokenizer.getTokens(e)},this.getTokenAt=function(e,t){var i,n=this.bgTokenizer.getTokens(e),s=0;if(null==t)o=n.length-1,s=this.getLine(e).length;else for(var o=0;o<n.length&&(s+=n[o].value.length,!(s>=t));o++);return(i=n[o])?(i.index=o,i.start=s-i.value.length,i):null},this.setUndoManager=function(e){if(this.$undoManager=e,this.$deltas=[],this.$deltasDoc=[],this.$deltasFold=[],this.$informUndoManager&&this.$informUndoManager.cancel(),e){var t=this;this.$syncInformUndoManager=function(){t.$informUndoManager.cancel(),t.$deltasFold.length&&(t.$deltas.push({group:"fold",deltas:t.$deltasFold}),t.$deltasFold=[]),t.$deltasDoc.length&&(t.$deltas.push({group:"doc",deltas:t.$deltasDoc}),t.$deltasDoc=[]),t.$deltas.length>0&&e.execute({action:"aceupdate",args:[t.$deltas,t],merge:t.mergeUndoDeltas}),t.mergeUndoDeltas=!1,t.$deltas=[]},this.$informUndoManager=s.delayedCall(this.$syncInformUndoManager)}},this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},this.$defaultUndoManager={undo:function(){},redo:function(){},reset:function(){}},this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},this.getTabString=function(){return this.getUseSoftTabs()?s.stringRepeat(" ",this.getTabSize()):"	"},this.setUseSoftTabs=function(e){this.setOption("useSoftTabs",e)},this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},this.setTabSize=function(e){this.setOption("tabSize",e)},this.getTabSize=function(){return this.$tabSize},this.isTabStop=function(e){return this.$useSoftTabs&&e.column%this.$tabSize===0},this.$overwrite=!1,this.setOverwrite=function(e){this.setOption("overwrite",e)},this.getOverwrite=function(){return this.$overwrite},this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},this.addGutterDecoration=function(e,t){this.$decorations[e]||(this.$decorations[e]=""),this.$decorations[e]+=" "+t,this._signal("changeBreakpoint",{})},this.removeGutterDecoration=function(e,t){this.$decorations[e]=(this.$decorations[e]||"").replace(" "+t,""),this._signal("changeBreakpoint",{})},this.getBreakpoints=function(){return this.$breakpoints},this.setBreakpoints=function(e){this.$breakpoints=[];for(var t=0;t<e.length;t++)this.$breakpoints[e[t]]="ace_breakpoint";this._signal("changeBreakpoint",{})},this.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},this.setBreakpoint=function(e,t){void 0===t&&(t="ace_breakpoint"),t?this.$breakpoints[e]=t:delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.clearBreakpoint=function(e){delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.addMarker=function(e,t,i,n){var s=this.$markerId++,o={range:e,type:i||"line",renderer:"function"==typeof i?i:null,clazz:t,inFront:!!n,id:s};return n?(this.$frontMarkers[s]=o,this._signal("changeFrontMarker")):(this.$backMarkers[s]=o,this._signal("changeBackMarker")),s},this.addDynamicMarker=function(e,t){if(e.update){var i=this.$markerId++;return e.id=i,e.inFront=!!t,t?(this.$frontMarkers[i]=e,this._signal("changeFrontMarker")):(this.$backMarkers[i]=e,this._signal("changeBackMarker")),e}},this.removeMarker=function(e){var t=this.$frontMarkers[e]||this.$backMarkers[e];if(t){var i=t.inFront?this.$frontMarkers:this.$backMarkers;t&&(delete i[e],this._signal(t.inFront?"changeFrontMarker":"changeBackMarker"))}},this.getMarkers=function(e){return e?this.$frontMarkers:this.$backMarkers},this.highlight=function(e){if(!this.$searchHighlight){var t=new d(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(t)}this.$searchHighlight.setRegexp(e)},this.highlightLines=function(e,t,i,n){"number"!=typeof t&&(i=t,t=e),i||(i="ace_step");var s=new c(e,0,t,1/0);return s.id=this.addMarker(s,i,"fullLine",n),s},this.setAnnotations=function(e){this.$annotations=e,this._signal("changeAnnotation",{})},this.getAnnotations=function(){return this.$annotations||[]},this.clearAnnotations=function(){this.setAnnotations([])},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r?\n)/m);t?this.$autoNewLine=t[1]:this.$autoNewLine="\n"},this.getWordRange=function(e,t){var i=this.getLine(e),n=!1;if(t>0&&(n=!!i.charAt(t-1).match(this.tokenRe)),n||(n=!!i.charAt(t).match(this.tokenRe)),n)var s=this.tokenRe;else if(/^\s+$/.test(i.slice(t-1,t+1)))var s=/\s/;else var s=this.nonTokenRe;var o=t;if(o>0){do o--;while(o>=0&&i.charAt(o).match(s));o++}for(var r=t;r<i.length&&i.charAt(r).match(s);)r++;return new c(e,o,e,r)},this.getAWordRange=function(e,t){for(var i=this.getWordRange(e,t),n=this.getLine(i.end.row);n.charAt(i.end.column).match(/[ \t]/);)i.end.column+=1;return i},this.setNewLineMode=function(e){this.doc.setNewLineMode(e)},this.getNewLineMode=function(){return this.doc.getNewLineMode()},this.setUseWorker=function(e){this.setOption("useWorker",e)},this.getUseWorker=function(){return this.$useWorker},this.onReloadTokenizer=function(e){var t=e.data;this.bgTokenizer.start(t.first),this._signal("tokenizerUpdate",e)},this.$modes={},this.$mode=null,this.$modeId=null,this.setMode=function(e,t){if(e&&"object"==typeof e){if(e.getTokenizer)return this.$onChangeMode(e);var i=e,n=i.path}else n=e||"ace/mode/text";return this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new l),this.$modes[n]&&!i?(this.$onChangeMode(this.$modes[n]),void(t&&t())):(this.$modeId=n,o.loadModule(["mode",n],function(e){return this.$modeId!==n?t&&t():this.$modes[n]&&!i?this.$onChangeMode(this.$modes[n]):void(e&&e.Mode&&(e=new e.Mode(i),i||(this.$modes[n]=e,e.$id=n),this.$onChangeMode(e),t&&t()))}.bind(this)),void(this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)))},this.$onChangeMode=function(e,t){if(t||(this.$modeId=e.$id),this.$mode!==e){this.$mode=e,this.$stopWorker(),this.$useWorker&&this.$startWorker();var i=e.getTokenizer();if(void 0!==i.addEventListener){var n=this.onReloadTokenizer.bind(this);i.addEventListener("update",n)}if(this.bgTokenizer)this.bgTokenizer.setTokenizer(i);else{this.bgTokenizer=new h(i);var s=this;this.bgTokenizer.addEventListener("update",function(e){s._signal("tokenizerUpdate",e)})}this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=e.tokenRe,this.nonTokenRe=e.nonTokenRe,t||(this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(e.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode"))}},this.$stopWorker=function(){this.$worker&&this.$worker.terminate(),this.$worker=null},this.$startWorker=function(){if("undefined"==typeof Worker||e.noWorker)this.$worker=null;else try{this.$worker=this.$mode.createWorker(this)}catch(t){console.log("Could not load worker"),console.log(t),this.$worker=null}},this.getMode=function(){return this.$mode},this.$scrollTop=0,this.setScrollTop=function(e){this.$scrollTop===e||isNaN(e)||(this.$scrollTop=e,this._signal("changeScrollTop",e))},this.getScrollTop=function(){return this.$scrollTop},this.$scrollLeft=0,this.setScrollLeft=function(e){this.$scrollLeft===e||isNaN(e)||(this.$scrollLeft=e,this._signal("changeScrollLeft",e))},this.getScrollLeft=function(){return this.$scrollLeft},this.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},this.getLineWidgetMaxWidth=function(){if(null!=this.lineWidgetsWidth)return this.lineWidgetsWidth;var e=0;return this.lineWidgets.forEach(function(t){t&&t.screenWidth>e&&(e=t.screenWidth)}),this.lineWidgetWidth=e},this.$computeWidth=function(e){if(this.$modified||e){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var t=this.doc.getAllLines(),i=this.$rowLengthCache,n=0,s=0,o=this.$foldData[s],r=o?o.start.row:1/0,a=t.length,l=0;a>l;l++){if(l>r){if(l=o.end.row+1,l>=a)break;o=this.$foldData[s++],r=o?o.start.row:1/0}null==i[l]&&(i[l]=this.$getStringScreenWidth(t[l])[0]),i[l]>n&&(n=i[l])}this.screenWidth=n}},this.getLine=function(e){return this.doc.getLine(e)},this.getLines=function(e,t){return this.doc.getLines(e,t)},this.getLength=function(){return this.doc.getLength()},this.getTextRange=function(e){return this.doc.getTextRange(e||this.selection.getRange())},this.insert=function(e,t){return this.doc.insert(e,t)},this.remove=function(e){return this.doc.remove(e)},this.undoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var i=null,n=e.length-1;-1!=n;n--){var s=e[n];"doc"==s.group?(this.doc.revertDeltas(s.deltas),i=this.$getUndoSelection(s.deltas,!0,i)):s.deltas.forEach(function(e){this.addFolds(e.folds)},this)}return this.$fromUndo=!1,i&&this.$undoSelect&&!t&&this.selection.setSelectionRange(i),i}},this.redoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var i=null,n=0;n<e.length;n++){var s=e[n];"doc"==s.group&&(this.doc.applyDeltas(s.deltas),i=this.$getUndoSelection(s.deltas,!1,i))}return this.$fromUndo=!1,i&&this.$undoSelect&&!t&&this.selection.setSelectionRange(i),i}},this.setUndoSelect=function(e){this.$undoSelect=e},this.$getUndoSelection=function(e,t,i){function n(e){var i="insertText"===e.action||"insertLines"===e.action;return t?!i:i}var s,o,r=e[0],a=!1;n(r)?(s=c.fromPoints(r.range.start,r.range.end),a=!0):(s=c.fromPoints(r.range.start,r.range.start),a=!1);for(var l=1;l<e.length;l++)r=e[l],n(r)?(o=r.range.start,-1==s.compare(o.row,o.column)&&s.setStart(r.range.start),o=r.range.end,1==s.compare(o.row,o.column)&&s.setEnd(r.range.end),a=!0):(o=r.range.start,-1==s.compare(o.row,o.column)&&(s=c.fromPoints(r.range.start,r.range.start)),a=!1);if(null!=i){0===c.comparePoints(i.start,s.start)&&(i.start.column+=s.end.column-s.start.column,i.end.column+=s.end.column-s.start.column);var u=i.compareRange(s);1==u?s.setStart(i.start):-1==u&&s.setEnd(i.end)}return s},this.replace=function(e,t){return this.doc.replace(e,t)},this.moveText=function(e,t,i){var n=this.getTextRange(e),s=this.getFoldsInRange(e),o=c.fromPoints(t,t);if(!i){this.remove(e);var r=e.start.row-e.end.row,a=r?-e.end.column:e.start.column-e.end.column;a&&(o.start.row==e.end.row&&o.start.column>e.end.column&&(o.start.column+=a),o.end.row==e.end.row&&o.end.column>e.end.column&&(o.end.column+=a)),r&&o.start.row>=e.end.row&&(o.start.row+=r,o.end.row+=r)}if(o.end=this.insert(o.start,n),s.length){var l=e.start,u=o.start,r=u.row-l.row,a=u.column-l.column;this.addFolds(s.map(function(e){return e=e.clone(),e.start.row==l.row&&(e.start.column+=a),e.end.row==l.row&&(e.end.column+=a),e.start.row+=r,e.end.row+=r,e}))}return o},this.indentRows=function(e,t,i){i=i.replace(/\t/g,this.getTabString());for(var n=e;t>=n;n++)this.insert({row:n,column:0},i)},this.outdentRows=function(e){for(var t=e.collapseRows(),i=new c(0,0,0,0),n=this.getTabSize(),s=t.start.row;s<=t.end.row;++s){var o=this.getLine(s);i.start.row=s,i.end.row=s;for(var r=0;n>r&&" "==o.charAt(r);++r);n>r&&"	"==o.charAt(r)?(i.start.column=r,i.end.column=r+1):(i.start.column=0,i.end.column=r),this.remove(i)}},this.$moveLines=function(e,t,i){if(e=this.getRowFoldStart(e),t=this.getRowFoldEnd(t),0>i){var n=this.getRowFoldStart(e+i);if(0>n)return 0;var s=n-e}else if(i>0){var n=this.getRowFoldEnd(t+i);if(n>this.doc.getLength()-1)return 0;var s=n-t}else{e=this.$clipRowToDocument(e),t=this.$clipRowToDocument(t);var s=t-e+1}var o=new c(e,0,t,Number.MAX_VALUE),r=this.getFoldsInRange(o).map(function(e){return e=e.clone(),e.start.row+=s,e.end.row+=s,e}),a=0==i?this.doc.getLines(e,t):this.doc.removeLines(e,t);return this.doc.insertLines(e+s,a),r.length&&this.addFolds(r),s},this.moveLinesUp=function(e,t){return this.$moveLines(e,t,-1)},this.moveLinesDown=function(e,t){return this.$moveLines(e,t,1)},this.duplicateLines=function(e,t){return this.$moveLines(e,t,0)},this.$clipRowToDocument=function(e){return Math.max(0,Math.min(e,this.doc.getLength()-1))},this.$clipColumnToRow=function(e,t){return 0>t?0:Math.min(this.doc.getLine(e).length,t)},this.$clipPositionToDocument=function(e,t){if(t=Math.max(0,t),0>e)e=0,t=0;else{var i=this.doc.getLength();e>=i?(e=i-1,t=this.doc.getLine(i-1).length):t=Math.min(this.doc.getLine(e).length,t)}return{row:e,column:t}},this.$clipRangeToDocument=function(e){e.start.row<0?(e.start.row=0,e.start.column=0):e.start.column=this.$clipColumnToRow(e.start.row,e.start.column);var t=this.doc.getLength()-1;return e.end.row>t?(e.end.row=t,e.end.column=this.doc.getLine(t).length):e.end.column=this.$clipColumnToRow(e.end.row,e.end.column),e},this.$wrapLimit=80,this.$useWrapMode=!1,this.$wrapLimitRange={min:null,max:null},this.setUseWrapMode=function(e){if(e!=this.$useWrapMode){if(this.$useWrapMode=e,this.$modified=!0,this.$resetRowCache(0),e){var t=this.getLength();this.$wrapData=Array(t),this.$updateWrapData(0,t-1)}this._signal("changeWrapMode")}},this.getUseWrapMode=function(){return this.$useWrapMode},this.setWrapLimitRange=function(e,t){this.$wrapLimitRange.min===e&&this.$wrapLimitRange.max===t||(this.$wrapLimitRange={min:e,max:t},this.$modified=!0,this._signal("changeWrapMode"))},this.adjustWrapLimit=function(e,t){var i=this.$wrapLimitRange;i.max<0&&(i={min:t,max:t});var n=this.$constrainWrapLimit(e,i.min,i.max);return n!=this.$wrapLimit&&n>1?(this.$wrapLimit=n,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0):!1},this.$constrainWrapLimit=function(e,t,i){return t&&(e=Math.max(t,e)),i&&(e=Math.min(i,e)),e},this.getWrapLimit=function(){return this.$wrapLimit},this.setWrapLimit=function(e){this.setWrapLimitRange(e,e)},this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},this.$updateInternalDataOnChange=function(e){var t,i=this.$useWrapMode,n=e.data.action,s=e.data.range.start.row,o=e.data.range.end.row,r=e.data.range.start,a=e.data.range.end,l=null;if(-1!=n.indexOf("Lines")?(o="insertLines"==n?s+e.data.lines.length:s,t=e.data.lines?e.data.lines.length:o-s):t=o-s,this.$updating=!0,0!=t)if(-1!=n.indexOf("remove")){this[i?"$wrapData":"$rowLengthCache"].splice(s,t);var c=this.$foldData;l=this.getFoldsInRange(e.data.range),this.removeFolds(l);var u=this.getFoldLine(a.row),h=0;if(u){u.addRemoveChars(a.row,a.column,r.column-a.column),u.shiftRow(-t);var d=this.getFoldLine(s);d&&d!==u&&(d.merge(u),u=d),h=c.indexOf(u)+1}for(h;h<c.length;h++){var u=c[h];u.start.row>=a.row&&u.shiftRow(-t)}o=s}else{var p=Array(t);p.unshift(s,0);var g=i?this.$wrapData:this.$rowLengthCache;g.splice.apply(g,p);var c=this.$foldData,u=this.getFoldLine(s),h=0;if(u){var m=u.range.compareInside(r.row,r.column);0==m?(u=u.split(r.row,r.column),u.shiftRow(t),u.addRemoveChars(o,0,a.column-r.column)):-1==m&&(u.addRemoveChars(s,0,a.column-r.column),u.shiftRow(t)),h=c.indexOf(u)+1}for(h;h<c.length;h++){var u=c[h];u.start.row>=s&&u.shiftRow(t)}}else{t=Math.abs(e.data.range.start.column-e.data.range.end.column),-1!=n.indexOf("remove")&&(l=this.getFoldsInRange(e.data.range),this.removeFolds(l),t=-t);var u=this.getFoldLine(s);u&&u.addRemoveChars(s,r.column,t)}return i&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,i?this.$updateWrapData(s,o):this.$updateRowLengthCache(s,o),l},this.$updateRowLengthCache=function(e,t,i){this.$rowLengthCache[e]=null,this.$rowLengthCache[t]=null},this.$updateWrapData=function(e,t){var i,n,s=this.doc.getAllLines(),o=this.getTabSize(),r=this.$wrapData,a=this.$wrapLimit,l=e;for(t=Math.min(t,s.length-1);t>=l;)n=this.getFoldLine(l,n),n?(i=[],n.walk(function(e,t,n,o){var r;if(null!=e){r=this.$getDisplayTokens(e,i.length),r[0]=u;for(var a=1;a<r.length;a++)r[a]=p}else r=this.$getDisplayTokens(s[t].substring(o,n),i.length);i=i.concat(r)}.bind(this),n.end.row,s[n.end.row].length+1),r[n.start.row]=this.$computeWrapSplits(i,a,o),l=n.end.row+1):(i=this.$getDisplayTokens(s[l]),r[l]=this.$computeWrapSplits(i,a,o),l++)};var i=1,a=2,u=3,p=4,g=9,m=10,f=11,v=12;this.$computeWrapSplits=function(e,t){function i(t){var i=e.slice(o,t),s=i.length;i.join("").replace(/12/g,function(){s-=1}).replace(/2/g,function(){s-=1}),r+=s,n.push(r),o=t}if(0==e.length)return[];for(var n=[],s=e.length,o=0,r=0,a=this.$wrapAsCode;s-o>t;){var l=o+t;if(e[l-1]>=m&&e[l]>=m)i(l);else if(e[l]!=u&&e[l]!=p){for(var c=Math.max(l-(a?10:t-(t>>2)),o-1);l>c&&e[l]<u;)l--;if(a){for(;l>c&&e[l]<u;)l--;for(;l>c&&e[l]==g;)l--}else for(;l>c&&e[l]<m;)l--;l>c?i(++l):(l=o+t,i(l))}else{for(l;l!=o-1&&e[l]!=u;l--);if(l>o){i(l);continue}for(l=o+t;l<e.length&&e[l]==p;l++);if(l==e.length)break;i(l)}}return n},this.$getDisplayTokens=function(e,n){var s,o=[];n=n||0;for(var r=0;r<e.length;r++){var l=e.charCodeAt(r);if(9==l){s=this.getScreenTabSize(o.length+n),o.push(f);for(var c=1;s>c;c++)o.push(v)}else 32==l?o.push(m):l>39&&48>l||l>57&&64>l?o.push(g):l>=4352&&t(l)?o.push(i,a):o.push(i)}return o},this.$getStringScreenWidth=function(e,i,n){if(0==i)return[0,0];null==i&&(i=1/0),n=n||0;var s,o;for(o=0;o<e.length&&(s=e.charCodeAt(o),n+=9==s?this.getScreenTabSize(n):s>=4352&&t(s)?2:1,!(n>i));o++);return[n,o]},this.lineWidgets=null,this.getRowLength=function(e){if(this.lineWidgets)var t=this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0;else t=0;return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1+t:1+t},this.getRowLineCount=function(e){return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1:1},this.getScreenLastRowColumn=function(e){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE);return this.documentToScreenColumn(t.row,t.column)},this.getDocumentLastRowColumn=function(e,t){var i=this.documentToScreenRow(e,t);return this.getScreenLastRowColumn(i)},this.getDocumentLastRowColumnPosition=function(e,t){var i=this.documentToScreenRow(e,t);return this.screenToDocumentPosition(i,Number.MAX_VALUE/10)},this.getRowSplitData=function(e){return this.$useWrapMode?this.$wrapData[e]:void 0},this.getScreenTabSize=function(e){return this.$tabSize-e%this.$tabSize},this.screenToDocumentRow=function(e,t){return this.screenToDocumentPosition(e,t).row},this.screenToDocumentColumn=function(e,t){return this.screenToDocumentPosition(e,t).column},this.screenToDocumentPosition=function(e,t){if(0>e)return{row:0,column:0};var i,n,s=0,o=0,r=0,a=0,l=this.$screenRowCache,c=this.$getRowCacheIndex(l,e),u=l.length;if(u&&c>=0)var r=l[c],s=this.$docRowCache[c],h=e>l[u-1];else var h=!u;for(var d=this.getLength()-1,p=this.getNextFoldLine(s),g=p?p.start.row:1/0;e>=r&&(a=this.getRowLength(s),!(r+a>e||s>=d));)r+=a,s++,s>g&&(s=p.end.row+1,p=this.getNextFoldLine(s,p),g=p?p.start.row:1/0),h&&(this.$docRowCache.push(s),this.$screenRowCache.push(r));if(p&&p.start.row<=s)i=this.getFoldDisplayLine(p),s=p.start.row;else{if(e>=r+a||s>d)return{row:d,column:this.getLine(d).length};i=this.getLine(s),p=null}if(this.$useWrapMode){var m=this.$wrapData[s];if(m){var f=Math.floor(e-r);n=m[f],f>0&&m.length&&(o=m[f-1]||m[m.length-1],i=i.substring(o))}}return o+=this.$getStringScreenWidth(i,t)[1],this.$useWrapMode&&o>=n&&(o=n-1),p?p.idxToPosition(o):{row:s,column:o}},this.documentToScreenPosition=function(e,t){if("undefined"==typeof t)var i=this.$clipPositionToDocument(e.row,e.column);else i=this.$clipPositionToDocument(e,t);e=i.row,t=i.column;var n=0,s=null,o=null;o=this.getFoldAt(e,t,1),o&&(e=o.start.row,t=o.start.column);var r,a=0,l=this.$docRowCache,c=this.$getRowCacheIndex(l,e),u=l.length;if(u&&c>=0)var a=l[c],n=this.$screenRowCache[c],h=e>l[u-1];else var h=!u;for(var d=this.getNextFoldLine(a),p=d?d.start.row:1/0;e>a;){if(a>=p){if(r=d.end.row+1,r>e)break;d=this.getNextFoldLine(r,d),p=d?d.start.row:1/0}else r=a+1;n+=this.getRowLength(a),a=r,h&&(this.$docRowCache.push(a),this.$screenRowCache.push(n))}var g="";if(d&&a>=p?(g=this.getFoldDisplayLine(d,e,t),s=d.start.row):(g=this.getLine(e).substring(0,t),s=e),this.$useWrapMode){var m=this.$wrapData[s];if(m){for(var f=0;g.length>=m[f];)n++,f++;g=g.substring(m[f-1]||0,g.length)}}return{row:n,column:this.$getStringScreenWidth(g)[0]}},this.documentToScreenColumn=function(e,t){return this.documentToScreenPosition(e,t).column},this.documentToScreenRow=function(e,t){return this.documentToScreenPosition(e,t).row},this.getScreenLength=function(){var e=0,t=null;if(this.$useWrapMode)for(var i=this.$wrapData.length,n=0,s=0,t=this.$foldData[s++],o=t?t.start.row:1/0;i>n;){var r=this.$wrapData[n];e+=r?r.length+1:1,n++,n>o&&(n=t.end.row+1,t=this.$foldData[s++],o=t?t.start.row:1/0)}else{e=this.getLength();for(var a=this.$foldData,s=0;s<a.length;s++)t=a[s],e-=t.end.row-t.start.row}return this.lineWidgets&&(e+=this.$getWidgetScreenLength()),e},this.$setFontMetrics=function(e){}}).call(p.prototype),e("./edit_session/folding").Folding.call(p.prototype),e("./edit_session/bracket_match").BracketMatch.call(p.prototype),o.defineOptions(p.prototype,"session",{wrap:{set:function(e){if(e&&"off"!=e?"free"==e?e=!0:"printMargin"==e?e=-1:"string"==typeof e&&(e=parseInt(e,10)||!1):e=!1,this.$wrap!=e){if(e){var t="number"==typeof e?e:null;this.setWrapLimitRange(t,t),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1);this.$wrap=e}},get:function(){return this.getUseWrapMode()?-1==this.$wrap?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(e){e="auto"==e?"text"!=this.$mode.type:"text"!=e,e!=this.$wrapAsCode&&(this.$wrapAsCode=e,this.$useWrapMode&&(this.$modified=!0,this.$resetRowCache(0),this.$updateWrapData(0,this.getLength()-1)))},initialValue:"auto"},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(e){this.$useWorker=e,this.$stopWorker(),e&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(e){isNaN(e)||this.$tabSize===e||(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=e,this._signal("changeTabSize"))},initialValue:4,handlesSet:!0},overwrite:{set:function(e){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(e){this.doc.setNewLineMode(e)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(e){this.setMode(e)},get:function(){return this.$modeId}}}),t.EditSession=p}),ace.define("ace/search",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],function(e,t,i){"use strict";var n=e("./lib/lang"),s=e("./lib/oop"),o=e("./range").Range,r=function(){this.$options={}};(function(){this.set=function(e){return s.mixin(this.$options,e),this},this.getOptions=function(){return n.copyObject(this.$options)},this.setOptions=function(e){this.$options=e},this.find=function(e){var t=this.$matchIterator(e,this.$options);if(!t)return!1;var i=null;return t.forEach(function(e,t,n){if(e.start)i=e;else{var s=e.offset+(n||0);i=new o(t,s,t,s+e.length)}return!0}),i},this.findAll=function(e){var t=this.$options;if(!t.needle)return[];this.$assembleRegExp(t);var i=t.range,s=i?e.getLines(i.start.row,i.end.row):e.doc.getAllLines(),r=[],a=t.re;if(t.$isMultiLine){var l,c=a.length,u=s.length-c;e:for(var h=a.offset||0;u>=h;h++){for(var d=0;c>d;d++)if(-1==s[h+d].search(a[d]))continue e;var p=s[h],g=s[h+c-1],m=p.length-p.match(a[0])[0].length,f=g.match(a[c-1])[0].length;l&&l.end.row===h&&l.end.column>m||(r.push(l=new o(h,m,h+c-1,f)),c>2&&(h=h+c-2))}}else for(var v=0;v<s.length;v++)for(var _=n.getMatchOffsets(s[v],a),d=0;d<_.length;d++){var b=_[d];r.push(new o(v,b.offset,v,b.offset+b.length))}if(i){for(var w=i.start.column,y=i.start.column,v=0,d=r.length-1;d>v&&r[v].start.column<w&&r[v].start.row==i.start.row;)v++;for(;d>v&&r[d].end.column>y&&r[d].end.row==i.end.row;)d--;for(r=r.slice(v,d+1),v=0,d=r.length;d>v;v++)r[v].start.row+=i.start.row,r[v].end.row+=i.start.row}return r},this.replace=function(e,t){var i=this.$options,n=this.$assembleRegExp(i);if(i.$isMultiLine)return t;if(n){var s=n.exec(e);if(!s||s[0].length!=e.length)return null;if(t=e.replace(n,t),i.preserveCase){t=t.split("");for(var o=Math.min(e.length,e.length);o--;){var r=e[o];
r&&r.toLowerCase()!=r?t[o]=t[o].toUpperCase():t[o]=t[o].toLowerCase()}t=t.join("")}return t}},this.$matchIterator=function(e,t){var i=this.$assembleRegExp(t);if(!i)return!1;var s,r=this,a=t.backwards;if(t.$isMultiLine)var l=i.length,c=function(t,n,r){var a=t.search(i[0]);if(-1!=a){for(var c=1;l>c;c++)if(t=e.getLine(n+c),-1==t.search(i[c]))return;var u=t.match(i[l-1])[0].length,h=new o(n,a,n+l-1,u);return 1==i.offset?(h.start.row--,h.start.column=Number.MAX_VALUE):r&&(h.start.column+=r),s(h)?!0:void 0}};else if(a)var c=function(e,t,o){for(var r=n.getMatchOffsets(e,i),a=r.length-1;a>=0;a--)if(s(r[a],t,o))return!0};else var c=function(e,t,o){for(var r=n.getMatchOffsets(e,i),a=0;a<r.length;a++)if(s(r[a],t,o))return!0};return{forEach:function(i){s=i,r.$lineIterator(e,t).forEach(c)}}},this.$assembleRegExp=function(e,t){if(e.needle instanceof RegExp)return e.re=e.needle;var i=e.needle;if(!e.needle)return e.re=!1;e.regExp||(i=n.escapeRegExp(i)),e.wholeWord&&(i="\\b"+i+"\\b");var s=e.caseSensitive?"g":"gi";if(e.$isMultiLine=!t&&/[\n\r]/.test(i),e.$isMultiLine)return e.re=this.$assembleMultilineRegExp(i,s);try{var o=new RegExp(i,s)}catch(r){o=!1}return e.re=o},this.$assembleMultilineRegExp=function(e,t){for(var i=e.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),n=[],s=0;s<i.length;s++)try{n.push(new RegExp(i[s],t))}catch(o){return!1}return""==i[0]?(n.shift(),n.offset=1):n.offset=0,n},this.$lineIterator=function(e,t){var i=1==t.backwards,n=0!=t.skipCurrent,s=t.range,o=t.start;o||(o=s?s[i?"end":"start"]:e.selection.getRange()),o.start&&(o=o[n!=i?"end":"start"]);var r=s?s.start.row:0,a=s?s.end.row:e.getLength()-1,l=i?function(i){var n=o.row,s=e.getLine(n).substring(0,o.column);if(!i(s,n)){for(n--;n>=r;n--)if(i(e.getLine(n),n))return;if(0!=t.wrap)for(n=a,r=o.row;n>=r;n--)if(i(e.getLine(n),n))return}}:function(i){var n=o.row,s=e.getLine(n).substr(o.column);if(!i(s,n,o.column)){for(n+=1;a>=n;n++)if(i(e.getLine(n),n))return;if(0!=t.wrap)for(n=r,a=o.row;a>=n;n++)if(i(e.getLine(n),n))return}};return{forEach:l}}}).call(r.prototype),t.Search=r}),ace.define("ace/keyboard/hash_handler",["require","exports","module","ace/lib/keys","ace/lib/useragent"],function(e,t,i){"use strict";function n(e,t){if(this.platform=t||(o.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.__defineGetter__&&this.__defineSetter__&&"undefined"!=typeof console&&console.error){var i=!1,n=function(){i||(i=!0,console.error("commmandKeyBinding has too many m's. use commandKeyBinding"))};this.__defineGetter__("commmandKeyBinding",function(){return n(),this.commandKeyBinding}),this.__defineSetter__("commmandKeyBinding",function(e){return n(),this.commandKeyBinding=e})}else this.commmandKeyBinding=this.commandKeyBinding;this.addCommands(e)}var s=e("../lib/keys"),o=e("../lib/useragent");(function(){this.addCommand=function(e){this.commands[e.name]&&this.removeCommand(e),this.commands[e.name]=e,e.bindKey&&this._buildKeyHash(e)},this.removeCommand=function(e){var t="string"==typeof e?e:e.name;e=this.commands[t],delete this.commands[t];var i=this.commandKeyBinding;for(var n in i)for(var s in i[n])i[n][s]==e&&delete i[n][s]},this.bindKey=function(e,t){if(e){if("function"==typeof t)return void this.addCommand({exec:t,bindKey:e,name:t.name||e});var i=this.commandKeyBinding;e.split("|").forEach(function(e){var n=this.parseKeys(e,t),s=n.hashId;(i[s]||(i[s]={}))[n.key]=t},this)}},this.addCommands=function(e){e&&Object.keys(e).forEach(function(t){var i=e[t];if(i){if("string"==typeof i)return this.bindKey(i,t);"function"==typeof i&&(i={exec:i}),"object"==typeof i&&(i.name||(i.name=t),this.addCommand(i))}},this)},this.removeCommands=function(e){Object.keys(e).forEach(function(t){this.removeCommand(e[t])},this)},this.bindKeys=function(e){Object.keys(e).forEach(function(t){this.bindKey(t,e[t])},this)},this._buildKeyHash=function(e){var t=e.bindKey;if(t){var i="string"==typeof t?t:t[this.platform];this.bindKey(i,e)}},this.parseKeys=function(e){-1!=e.indexOf(" ")&&(e=e.split(/\s+/).pop());var t=e.toLowerCase().split(/[\-\+]([\-\+])?/).filter(function(e){return e}),i=t.pop(),n=s[i];if(s.FUNCTION_KEYS[n])i=s.FUNCTION_KEYS[n].toLowerCase();else{if(!t.length)return{key:i,hashId:-1};if(1==t.length&&"shift"==t[0])return{key:i.toUpperCase(),hashId:-1}}for(var o=0,r=t.length;r--;){var a=s.KEY_MODS[t[r]];if(null==a)return"undefined"!=typeof console&&console.error("invalid modifier "+t[r]+" in "+e),!1;o|=a}return{key:i,hashId:o}},this.findKeyCommand=function(e,t){var i=this.commandKeyBinding;return i[e]&&i[e][t]},this.handleKeyboard=function(e,t,i,n){return{command:this.findKeyCommand(t,i)}}}).call(n.prototype),t.HashHandler=n}),ace.define("ace/commands/command_manager",["require","exports","module","ace/lib/oop","ace/keyboard/hash_handler","ace/lib/event_emitter"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("../keyboard/hash_handler").HashHandler,o=e("../lib/event_emitter").EventEmitter,r=function(e,t){s.call(this,t,e),this.byName=this.commands,this.setDefaultHandler("exec",function(e){return e.command.exec(e.editor,e.args||{})})};n.inherits(r,s),function(){n.implement(this,o),this.exec=function(e,t,i){if("string"==typeof e&&(e=this.commands[e]),!e)return!1;if(t&&t.$readOnly&&!e.readOnly)return!1;var n={editor:t,command:e,args:i},s=this._emit("exec",n);return this._signal("afterExec",n),s!==!1},this.toggleRecording=function(e){return this.$inReplay?void 0:(e&&e._emit("changeStatus"),this.recording?(this.macro.pop(),this.removeEventListener("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(e){this.macro.push([e.command,e.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0))},this.replay=function(e){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(e);try{this.$inReplay=!0,this.macro.forEach(function(t){"string"==typeof t?this.exec(t,e):this.exec(t[0],e,t[1])},this)}finally{this.$inReplay=!1}}},this.trimMacro=function(e){return e.map(function(e){return"string"!=typeof e[0]&&(e[0]=e[0].name),e[1]||(e=e[0]),e})}}.call(r.prototype),t.CommandManager=r}),ace.define("ace/commands/default_commands",["require","exports","module","ace/lib/lang","ace/config","ace/range"],function(e,t,i){"use strict";function n(e,t){return{win:e,mac:t}}var s=e("../lib/lang"),o=e("../config"),r=e("../range").Range;t.commands=[{name:"showSettingsMenu",bindKey:n("Ctrl-,","Command-,"),exec:function(e){o.loadModule("ace/ext/settings_menu",function(t){t.init(e),e.showSettingsMenu()})},readOnly:!0},{name:"goToNextError",bindKey:n("Alt-E","Ctrl-E"),exec:function(e){o.loadModule("ace/ext/error_marker",function(t){t.showErrorMarker(e,1)})},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",bindKey:n("Alt-Shift-E","Ctrl-Shift-E"),exec:function(e){o.loadModule("ace/ext/error_marker",function(t){t.showErrorMarker(e,-1)})},scrollIntoView:"animate",readOnly:!0},{name:"selectall",bindKey:n("Ctrl-A","Command-A"),exec:function(e){e.selectAll()},readOnly:!0},{name:"centerselection",bindKey:n(null,"Ctrl-L"),exec:function(e){e.centerSelection()},readOnly:!0},{name:"gotoline",bindKey:n("Ctrl-L","Command-L"),exec:function(e){var t=parseInt(prompt("Enter line number:"),10);isNaN(t)||e.gotoLine(t)},readOnly:!0},{name:"fold",bindKey:n("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(e){e.session.toggleFold(!1)},scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:n("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(e){e.session.toggleFold(!0)},scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",bindKey:n("F2","F2"),exec:function(e){e.session.toggleFoldWidget()},scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",bindKey:n("Alt-F2","Alt-F2"),exec:function(e){e.session.toggleFoldWidget(!0)},scrollIntoView:"center",readOnly:!0},{name:"foldall",bindKey:n("Ctrl-Alt-0","Ctrl-Command-Option-0"),exec:function(e){e.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",bindKey:n("Alt-0","Command-Option-0"),exec:function(e){e.session.foldAll(),e.session.unfold(e.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",bindKey:n("Alt-Shift-0","Command-Option-Shift-0"),exec:function(e){e.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",bindKey:n("Ctrl-K","Command-G"),exec:function(e){e.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",bindKey:n("Ctrl-Shift-K","Command-Shift-G"),exec:function(e){e.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",bindKey:n("Alt-K","Ctrl-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findNext()},readOnly:!0},{name:"selectOrFindPrevious",bindKey:n("Alt-Shift-K","Ctrl-Shift-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findPrevious()},readOnly:!0},{name:"find",bindKey:n("Ctrl-F","Command-F"),exec:function(e){o.loadModule("ace/ext/searchbox",function(t){t.Search(e)})},readOnly:!0},{name:"overwrite",bindKey:"Insert",exec:function(e){e.toggleOverwrite()},readOnly:!0},{name:"selecttostart",bindKey:n("Ctrl-Shift-Home","Command-Shift-Up"),exec:function(e){e.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",bindKey:n("Ctrl-Home","Command-Home|Command-Up"),exec:function(e){e.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",bindKey:n("Shift-Up","Shift-Up"),exec:function(e){e.getSelection().selectUp()},multiSelectAction:"forEach",readOnly:!0},{name:"golineup",bindKey:n("Up","Up|Ctrl-P"),exec:function(e,t){e.navigateUp(t.times)},multiSelectAction:"forEach",readOnly:!0},{name:"selecttoend",bindKey:n("Ctrl-Shift-End","Command-Shift-Down"),exec:function(e){e.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",bindKey:n("Ctrl-End","Command-End|Command-Down"),exec:function(e){e.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",bindKey:n("Shift-Down","Shift-Down"),exec:function(e){e.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",bindKey:n("Down","Down|Ctrl-N"),exec:function(e,t){e.navigateDown(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",bindKey:n("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(e){e.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",bindKey:n("Ctrl-Left","Option-Left"),exec:function(e){e.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",bindKey:n("Alt-Shift-Left","Command-Shift-Left"),exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",bindKey:n("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(e){e.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",bindKey:n("Shift-Left","Shift-Left"),exec:function(e){e.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",bindKey:n("Left","Left|Ctrl-B"),exec:function(e,t){e.navigateLeft(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",bindKey:n("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(e){e.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",bindKey:n("Ctrl-Right","Option-Right"),exec:function(e){e.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",bindKey:n("Alt-Shift-Right","Command-Shift-Right"),exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",bindKey:n("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(e){e.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",bindKey:n("Shift-Right","Shift-Right"),exec:function(e){e.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",bindKey:n("Right","Right|Ctrl-F"),exec:function(e,t){e.navigateRight(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",bindKey:"Shift-PageDown",exec:function(e){e.selectPageDown()},readOnly:!0},{name:"pagedown",bindKey:n(null,"Option-PageDown"),exec:function(e){e.scrollPageDown()},readOnly:!0},{name:"gotopagedown",bindKey:n("PageDown","PageDown|Ctrl-V"),exec:function(e){e.gotoPageDown()},readOnly:!0},{name:"selectpageup",bindKey:"Shift-PageUp",exec:function(e){e.selectPageUp()},readOnly:!0},{name:"pageup",bindKey:n(null,"Option-PageUp"),exec:function(e){e.scrollPageUp()},readOnly:!0},{name:"gotopageup",bindKey:"PageUp",exec:function(e){e.gotoPageUp()},readOnly:!0},{name:"scrollup",bindKey:n("Ctrl-Up",null),exec:function(e){e.renderer.scrollBy(0,-2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",bindKey:n("Ctrl-Down",null),exec:function(e){e.renderer.scrollBy(0,2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",bindKey:"Shift-Home",exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",bindKey:"Shift-End",exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",bindKey:n("Ctrl-Alt-E","Command-Option-E"),exec:function(e){e.commands.toggleRecording(e)},readOnly:!0},{name:"replaymacro",bindKey:n("Ctrl-Shift-E","Command-Shift-E"),exec:function(e){e.commands.replay(e)},readOnly:!0},{name:"jumptomatching",bindKey:n("Ctrl-P","Ctrl-P"),exec:function(e){e.jumpToMatching()},multiSelectAction:"forEach",readOnly:!0},{name:"selecttomatching",bindKey:n("Ctrl-Shift-P","Ctrl-Shift-P"),exec:function(e){e.jumpToMatching(!0)},multiSelectAction:"forEach",readOnly:!0},{name:"passKeysToBrowser",bindKey:n("null","null"),exec:function(){},passEvent:!0,readOnly:!0},{name:"cut",exec:function(e){var t=e.getSelectionRange();e._emit("cut",t),e.selection.isEmpty()||(e.session.remove(t),e.clearSelection())},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"removeline",bindKey:n("Ctrl-D","Command-D"),exec:function(e){e.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",bindKey:n("Ctrl-Shift-D","Command-Shift-D"),exec:function(e){e.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",bindKey:n("Ctrl-Alt-S","Command-Alt-S"),exec:function(e){e.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",bindKey:n("Ctrl-/","Command-/"),exec:function(e){e.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",bindKey:n("Ctrl-Shift-/","Command-Shift-/"),exec:function(e){e.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",bindKey:n("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(e){e.modifyNumber(1)},multiSelectAction:"forEach"},{name:"modifyNumberDown",bindKey:n("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(e){e.modifyNumber(-1)},multiSelectAction:"forEach"},{name:"replace",bindKey:n("Ctrl-H","Command-Option-F"),exec:function(e){o.loadModule("ace/ext/searchbox",function(t){t.Search(e,!0)})}},{name:"undo",bindKey:n("Ctrl-Z","Command-Z"),exec:function(e){e.undo()}},{name:"redo",bindKey:n("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(e){e.redo()}},{name:"copylinesup",bindKey:n("Alt-Shift-Up","Command-Option-Up"),exec:function(e){e.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",bindKey:n("Alt-Up","Option-Up"),exec:function(e){e.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",bindKey:n("Alt-Shift-Down","Command-Option-Down"),exec:function(e){e.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",bindKey:n("Alt-Down","Option-Down"),exec:function(e){e.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",bindKey:n("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(e){e.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",bindKey:n("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(e){e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",bindKey:n("Shift-Delete",null),exec:function(e){return e.selection.isEmpty()?void e.remove("left"):!1},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",bindKey:n("Alt-Backspace","Command-Backspace"),exec:function(e){e.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",bindKey:n("Alt-Delete","Ctrl-K"),exec:function(e){e.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",bindKey:n("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(e){e.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",bindKey:n("Ctrl-Delete","Alt-Delete"),exec:function(e){e.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",bindKey:n("Shift-Tab","Shift-Tab"),exec:function(e){e.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",bindKey:n("Tab","Tab"),exec:function(e){e.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",bindKey:n("Ctrl-[","Ctrl-["),exec:function(e){e.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",bindKey:n("Ctrl-]","Ctrl-]"),exec:function(e){e.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",exec:function(e,t){e.insert(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",exec:function(e,t){e.insert(s.stringRepeat(t.text||"",t.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",bindKey:n(null,"Ctrl-O"),exec:function(e){e.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",bindKey:n("Ctrl-T","Ctrl-T"),exec:function(e){e.transposeLetters()},multiSelectAction:function(e){e.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",bindKey:n("Ctrl-U","Ctrl-U"),exec:function(e){e.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",bindKey:n("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(e){e.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"expandtoline",bindKey:n("Ctrl-Shift-L","Command-Shift-L"),exec:function(e){var t=e.selection.getRange();t.start.column=t.end.column=0,t.end.row++,e.selection.setRange(t,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"joinlines",bindKey:n(null,null),exec:function(e){for(var t=e.selection.isBackwards(),i=t?e.selection.getSelectionLead():e.selection.getSelectionAnchor(),n=t?e.selection.getSelectionAnchor():e.selection.getSelectionLead(),o=e.session.doc.getLine(i.row).length,a=e.session.doc.getTextRange(e.selection.getRange()),l=a.replace(/\n\s*/," ").length,c=e.session.doc.getLine(i.row),u=i.row+1;u<=n.row+1;u++){var h=s.stringTrimLeft(s.stringTrimRight(e.session.doc.getLine(u)));0!==h.length&&(h=" "+h),c+=h}n.row+1<e.session.doc.getLength()-1&&(c+=e.session.doc.getNewLineCharacter()),e.clearSelection(),e.session.doc.replace(new r(i.row,0,n.row+2,0),c),l>0?(e.selection.moveCursorTo(i.row,i.column),e.selection.selectTo(i.row,i.column+l)):(o=e.session.doc.getLine(i.row).length>o?o+1:o,e.selection.moveCursorTo(i.row,o))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",bindKey:n(null,null),exec:function(e){var t=e.session.doc.getLength()-1,i=e.session.doc.getLine(t).length,n=e.selection.rangeList.ranges,s=[];n.length<1&&(n=[e.selection.getRange()]);for(var o=0;o<n.length;o++)o==n.length-1&&(n[o].end.row===t&&n[o].end.column===i||s.push(new r(n[o].end.row,n[o].end.column,t,i))),0===o?0===n[o].start.row&&0===n[o].start.column||s.push(new r(0,0,n[o].start.row,n[o].start.column)):s.push(new r(n[o-1].end.row,n[o-1].end.column,n[o].start.row,n[o].start.column));e.exitMultiSelectMode(),e.clearSelection();for(var o=0;o<s.length;o++)e.selection.addRange(s[o],!1)},readOnly:!0,scrollIntoView:"none"}]}),ace.define("ace/editor",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/keyboard/textinput","ace/mouse/mouse_handler","ace/mouse/fold_handler","ace/keyboard/keybinding","ace/edit_session","ace/search","ace/range","ace/lib/event_emitter","ace/commands/command_manager","ace/commands/default_commands","ace/config","ace/token_iterator"],function(e,t,i){"use strict";e("./lib/fixoldbrowsers");var n=e("./lib/oop"),s=e("./lib/dom"),o=e("./lib/lang"),r=e("./lib/useragent"),a=e("./keyboard/textinput").TextInput,l=e("./mouse/mouse_handler").MouseHandler,c=e("./mouse/fold_handler").FoldHandler,u=e("./keyboard/keybinding").KeyBinding,h=e("./edit_session").EditSession,d=e("./search").Search,p=e("./range").Range,g=e("./lib/event_emitter").EventEmitter,m=e("./commands/command_manager").CommandManager,f=e("./commands/default_commands").commands,v=e("./config"),_=e("./token_iterator").TokenIterator,b=function(e,t){var i=e.getContainerElement();this.container=i,this.renderer=e,this.commands=new m(r.isMac?"mac":"win",f),this.textInput=new a(e.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.keyBinding=new u(this),this.$mouseHandler=new l(this),new c(this),this.$blockScrolling=0,this.$search=(new d).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=o.delayedCall(function(){this._signal("input",{}),this.session.bgTokenizer&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",function(e,t){t._$emitInputEvent.schedule(31)}),this.setSession(t||new h("")),v.resetOptions(this),v._signal("editor",this)};(function(){n.implement(this,g),this.$initOperationListeners=function(){function e(e){return e[e.length-1]}this.selections=[],this.commands.on("exec",function(t){this.startOperation(t);var i=t.command;if("fileJump"==i.aceCommandGroup){var n=this.prevOp;n&&"fileJump"==n.command.aceCommandGroup||(this.lastFileJumpPos=e(this.selections))}else this.lastFileJumpPos=null}.bind(this),!0),this.commands.on("afterExec",function(e){var t=e.command;"fileJump"==t.aceCommandGroup&&this.lastFileJumpPos&&!this.curOp.selectionChanged&&this.selection.fromJSON(this.lastFileJumpPos),this.endOperation(e)}.bind(this),!0),this.$opResetTimer=o.delayedCall(this.endOperation.bind(this)),this.on("change",function(){this.curOp||this.startOperation(),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||this.startOperation(),this.curOp.selectionChanged=!0}.bind(this),!0)},this.curOp=null,this.prevOp={},this.startOperation=function(e){if(this.curOp){if(!e||this.curOp.command)return;this.prevOp=this.curOp}e||(this.previousCommand=null,e={}),this.$opResetTimer.schedule(),this.curOp={command:e.command||{},args:e.args,scrollTop:this.renderer.scrollTop};var t=this.curOp.command;t&&t.scrollIntoView&&this.$blockScrolling++,this.selections.push(this.selection.toJSON())},this.endOperation=function(){if(this.curOp){var e=this.curOp.command;if(e&&e.scrollIntoView){switch(this.$blockScrolling--,e.scrollIntoView){case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var t=this.selection.getRange(),i=this.renderer.layerConfig;(t.start.row>=i.lastRow||t.end.row<=i.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}"animate"==e.scrollIntoView&&this.renderer.animateScrolling(this.curOp.scrollTop)}this.prevOp=this.curOp,this.curOp=null}},this.$mergeableCommands=["backspace","del","insertstring"],this.$historyTracker=function(e){if(this.$mergeUndoDeltas){var t=this.prevOp,i=this.$mergeableCommands,n=t.command&&e.command.name==t.command.name;if("insertstring"==e.command.name){var s=e.args;void 0===this.mergeNextCommand&&(this.mergeNextCommand=!0),n=n&&this.mergeNextCommand&&(!/\s/.test(s)||/\s/.test(t.args)),this.mergeNextCommand=!0}else n=n&&-1!==i.indexOf(e.command.name);"always"!=this.$mergeUndoDeltas&&Date.now()-this.sequenceStartTime>2e3&&(n=!1),n?this.session.mergeUndoDeltas=!0:-1!==i.indexOf(e.command.name)&&(this.sequenceStartTime=Date.now())}},this.setKeyboardHandler=function(e){if(e)if("string"==typeof e){this.$keybindingId=e;var t=this;v.loadModule(["keybinding",e],function(i){t.$keybindingId==e&&t.keyBinding.setKeyboardHandler(i&&i.handler)})}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(e);else this.keyBinding.setKeyboardHandler(null)},this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},this.setSession=function(e){if(this.session!=e){var t=this.session;if(t){this.session.removeEventListener("change",this.$onDocumentChange),this.session.removeEventListener("changeMode",this.$onChangeMode),this.session.removeEventListener("tokenizerUpdate",this.$onTokenizerUpdate),this.session.removeEventListener("changeTabSize",this.$onChangeTabSize),this.session.removeEventListener("changeWrapLimit",this.$onChangeWrapLimit),this.session.removeEventListener("changeWrapMode",this.$onChangeWrapMode),this.session.removeEventListener("onChangeFold",this.$onChangeFold),this.session.removeEventListener("changeFrontMarker",this.$onChangeFrontMarker),this.session.removeEventListener("changeBackMarker",this.$onChangeBackMarker),this.session.removeEventListener("changeBreakpoint",this.$onChangeBreakpoint),this.session.removeEventListener("changeAnnotation",this.$onChangeAnnotation),this.session.removeEventListener("changeOverwrite",this.$onCursorChange),this.session.removeEventListener("changeScrollTop",this.$onScrollTopChange),this.session.removeEventListener("changeScrollLeft",this.$onScrollLeftChange);var i=this.session.getSelection();i.removeEventListener("changeCursor",this.$onCursorChange),i.removeEventListener("changeSelection",this.$onSelectionChange)}this.session=e,e&&(this.$onDocumentChange=this.onDocumentChange.bind(this),e.addEventListener("change",this.$onDocumentChange),this.renderer.setSession(e),this.$onChangeMode=this.onChangeMode.bind(this),e.addEventListener("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),e.addEventListener("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),e.addEventListener("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),e.addEventListener("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),e.addEventListener("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),e.addEventListener("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.addEventListener("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.addEventListener("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.addEventListener("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.addEventListener("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.addEventListener("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.addEventListener("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.addEventListener("changeScrollLeft",this.$onScrollLeftChange),this.selection=e.getSelection(),this.selection.addEventListener("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.addEventListener("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.$blockScrolling+=1,this.onCursorChange(),this.$blockScrolling-=1,this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()),this._signal("changeSession",{session:e,oldSession:t}),t&&t._signal("changeEditor",{oldEditor:this}),e&&e._signal("changeEditor",{editor:this})}},this.getSession=function(){return this.session},this.setValue=function(e,t){return this.session.doc.setValue(e),t?1==t?this.navigateFileEnd():-1==t&&this.navigateFileStart():this.selectAll(),e},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(e){this.renderer.onResize(e)},this.setTheme=function(e,t){this.renderer.setTheme(e,t)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(e){this.renderer.setStyle(e)},this.unsetStyle=function(e){this.renderer.unsetStyle(e)},this.getFontSize=function(){return this.getOption("fontSize")||s.computedStyle(this.container,"fontSize")},this.setFontSize=function(e){this.setOption("fontSize",e)},this.$highlightBrackets=function(){if(this.session.$bracketHighlight&&(this.session.removeMarker(this.session.$bracketHighlight),this.session.$bracketHighlight=null),!this.$highlightPending){var e=this;this.$highlightPending=!0,setTimeout(function(){e.$highlightPending=!1;var t=e.session.findMatchingBracket(e.getCursorPosition());if(t)var i=new p(t.row,t.column,t.row,t.column+1);else if(e.session.$mode.getMatching)var i=e.session.$mode.getMatching(e.session);i&&(e.session.$bracketHighlight=e.session.addMarker(i,"ace_bracket","text"))},50)}},this.$highlightTags=function(){var e=this.session;if(!this.$highlightTagPending){var t=this;this.$highlightTagPending=!0,setTimeout(function(){t.$highlightTagPending=!1;var i=t.getCursorPosition(),n=new _(t.session,i.row,i.column),s=n.getCurrentToken();if(!s||-1===s.type.indexOf("tag-name"))return e.removeMarker(e.$tagHighlight),void(e.$tagHighlight=null);var o=s.value,r=0,a=n.stepBackward();if("<"==a.value){do a=s,s=n.stepForward(),s&&s.value===o&&-1!==s.type.indexOf("tag-name")&&("<"===a.value?r++:"</"===a.value&&r--);while(s&&r>=0)}else{do s=a,a=n.stepBackward(),s&&s.value===o&&-1!==s.type.indexOf("tag-name")&&("<"===a.value?r++:"</"===a.value&&r--);while(a&&0>=r);n.stepForward()}if(!s)return e.removeMarker(e.$tagHighlight),void(e.$tagHighlight=null);var l=n.getCurrentTokenRow(),c=n.getCurrentTokenColumn(),u=new p(l,c,l,c+s.value.length);e.$tagHighlight&&0!==u.compareRange(e.$backMarkers[e.$tagHighlight].range)&&(e.removeMarker(e.$tagHighlight),e.$tagHighlight=null),u&&!e.$tagHighlight&&(e.$tagHighlight=e.addMarker(u,"ace_bracket","text"))},50)}},this.focus=function(){var e=this;setTimeout(function(){e.textInput.focus()}),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(){this.$isFocused||(this.$isFocused=!0,
this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus"))},this.onBlur=function(){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur"))},this.$cursorChange=function(){this.renderer.updateCursor()},this.onDocumentChange=function(e){var t,i=e.data,n=i.range;t=n.start.row==n.end.row&&"insertLines"!=i.action&&"removeLines"!=i.action?n.end.row:1/0,this.renderer.updateLines(n.start.row,t),this._signal("change",e),this.$cursorChange()},this.onTokenizerUpdate=function(e){var t=e.data;this.renderer.updateLines(t.first,t.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},this.onCursorChange=function(){this.$cursorChange(),this.$blockScrolling||this.renderer.scrollCursorIntoView(),this.$highlightBrackets(),this.$highlightTags(),this.$updateHighlightActiveLine(),this._signal("changeSelection")},this.$updateHighlightActiveLine=function(){var e,t=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(e=this.getCursorPosition()),!this.renderer.$maxLines||1!==this.session.getLength()||this.renderer.$minLines>1||(e=!1)),t.$highlightLineMarker&&!e)t.removeMarker(t.$highlightLineMarker.id),t.$highlightLineMarker=null;else if(!t.$highlightLineMarker&&e){var i=new p(e.row,e.column,e.row,1/0);i.id=t.addMarker(i,"ace_active-line","screenLine"),t.$highlightLineMarker=i}else e&&(t.$highlightLineMarker.start.row=e.row,t.$highlightLineMarker.end.row=e.row,t.$highlightLineMarker.start.column=e.column,t._signal("changeBackMarker"))},this.onSelectionChange=function(e){var t=this.session;if(t.$selectionMarker&&t.removeMarker(t.$selectionMarker),t.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var i=this.selection.getRange(),n=this.getSelectionStyle();t.$selectionMarker=t.addMarker(i,"ace_selection",n)}var s=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(s),this._signal("changeSelection")},this.$getSelectionHighLightRegexp=function(){var e=this.session,t=this.getSelectionRange();if(!t.isEmpty()&&!t.isMultiLine()){var i=t.start.column-1,n=t.end.column+1,s=e.getLine(t.start.row),o=s.length,r=s.substring(Math.max(i,0),Math.min(n,o));if(!(i>=0&&/^[\w\d]/.test(r)||o>=n&&/[\w\d]$/.test(r))&&(r=s.substring(t.start.column,t.end.column),/^[\w\d]+$/.test(r))){var a=this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:r});return a}}},this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},this.onChangeMode=function(e){this.renderer.updateText(),this._emit("changeMode",e)},this.onChangeWrapLimit=function(){this.renderer.updateFull()},this.onChangeWrapMode=function(){this.renderer.onResize(!0)},this.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},this.getCopyText=function(){var e=this.getSelectedText();return this._signal("copy",e),e},this.onCopy=function(){this.commands.exec("copy",this)},this.onCut=function(){this.commands.exec("cut",this)},this.onPaste=function(e){if(!this.$readOnly){var t={text:e};this._signal("paste",t),this.insert(t.text,!0)}},this.execCommand=function(e,t){this.commands.exec(e,this,t)},this.insert=function(e,t){var i=this.session,n=i.getMode(),s=this.getCursorPosition();if(this.getBehavioursEnabled()&&!t){var o=n.transformAction(i.getState(s.row),"insertion",this,i,e);o&&(e!==o.text&&(this.session.mergeUndoDeltas=!1,this.$mergeNextCommand=!1),e=o.text)}if("	"==e&&(e=this.session.getTabString()),this.selection.isEmpty()){if(this.session.getOverwrite()){var r=new p.fromPoints(s,s);r.end.column+=e.length,this.session.remove(r)}}else{var r=this.getSelectionRange();s=this.session.remove(r),this.clearSelection()}if("\n"==e||"\r\n"==e){var a=i.getLine(s.row);if(s.column>a.search(/\S|$/)){var l=a.substr(s.column).search(/\S|$/);i.doc.removeInLine(s.row,s.column,s.column+l)}}this.clearSelection();var c=s.column,u=i.getState(s.row),a=i.getLine(s.row),h=n.checkOutdent(u,a,e);i.insert(s,e);if(o&&o.selection&&(2==o.selection.length?this.selection.setSelectionRange(new p(s.row,c+o.selection[0],s.row,c+o.selection[1])):this.selection.setSelectionRange(new p(s.row+o.selection[0],o.selection[1],s.row+o.selection[2],o.selection[3]))),i.getDocument().isNewLine(e)){var d=n.getNextLineIndent(u,a.slice(0,s.column),i.getTabString());i.insert({row:s.row+1,column:0},d)}h&&n.autoOutdent(u,i,s.row)},this.onTextInput=function(e){this.keyBinding.onTextInput(e)},this.onCommandKey=function(e,t,i){this.keyBinding.onCommandKey(e,t,i)},this.setOverwrite=function(e){this.session.setOverwrite(e)},this.getOverwrite=function(){return this.session.getOverwrite()},this.toggleOverwrite=function(){this.session.toggleOverwrite()},this.setScrollSpeed=function(e){this.setOption("scrollSpeed",e)},this.getScrollSpeed=function(){return this.getOption("scrollSpeed")},this.setDragDelay=function(e){this.setOption("dragDelay",e)},this.getDragDelay=function(){return this.getOption("dragDelay")},this.setSelectionStyle=function(e){this.setOption("selectionStyle",e)},this.getSelectionStyle=function(){return this.getOption("selectionStyle")},this.setHighlightActiveLine=function(e){this.setOption("highlightActiveLine",e)},this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.setHighlightSelectedWord=function(e){this.setOption("highlightSelectedWord",e)},this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},this.setAnimatedScroll=function(e){this.renderer.setAnimatedScroll(e)},this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},this.setShowInvisibles=function(e){this.renderer.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},this.setDisplayIndentGuides=function(e){this.renderer.setDisplayIndentGuides(e)},this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},this.setShowPrintMargin=function(e){this.renderer.setShowPrintMargin(e)},this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},this.setPrintMarginColumn=function(e){this.renderer.setPrintMarginColumn(e)},this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},this.setReadOnly=function(e){this.setOption("readOnly",e)},this.getReadOnly=function(){return this.getOption("readOnly")},this.setBehavioursEnabled=function(e){this.setOption("behavioursEnabled",e)},this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},this.setWrapBehavioursEnabled=function(e){this.setOption("wrapBehavioursEnabled",e)},this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},this.setShowFoldWidgets=function(e){this.setOption("showFoldWidgets",e)},this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.remove=function(e){this.selection.isEmpty()&&("left"==e?this.selection.selectLeft():this.selection.selectRight());var t=this.getSelectionRange();if(this.getBehavioursEnabled()){var i=this.session,n=i.getState(t.start.row),s=i.getMode().transformAction(n,"deletion",this,i,t);if(0===t.end.column){var o=i.getTextRange(t);if("\n"==o[o.length-1]){var r=i.getLine(t.end.row);/^\s+$/.test(r)&&(t.end.column=r.length)}}s&&(t=s)}this.session.remove(t),this.clearSelection()},this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var e=this.getSelectionRange();e.start.column==e.end.column&&e.start.row==e.end.row&&(e.end.column=0,e.end.row++),this.session.remove(e),this.clearSelection()},this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var e=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(e)},this.transposeLetters=function(){if(this.selection.isEmpty()){var e=this.getCursorPosition(),t=e.column;if(0!==t){var i,n,s=this.session.getLine(e.row);t<s.length?(i=s.charAt(t)+s.charAt(t-1),n=new p(e.row,t-1,e.row,t+1)):(i=s.charAt(t-1)+s.charAt(t-2),n=new p(e.row,t-2,e.row,t)),this.session.replace(n,i)}}},this.toLowerCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),i=this.session.getTextRange(t);this.session.replace(t,i.toLowerCase()),this.selection.setSelectionRange(e)},this.toUpperCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),i=this.session.getTextRange(t);this.session.replace(t,i.toUpperCase()),this.selection.setSelectionRange(e)},this.indent=function(){var e=this.session,t=this.getSelectionRange();if(t.start.row<t.end.row){var i=this.$getSelectedRows();return void e.indentRows(i.first,i.last,"	")}if(t.start.column<t.end.column){var n=e.getTextRange(t);if(!/^\s+$/.test(n)){var i=this.$getSelectedRows();return void e.indentRows(i.first,i.last,"	")}}var s=e.getLine(t.start.row),r=t.start,a=e.getTabSize(),l=e.documentToScreenColumn(r.row,r.column);if(this.session.getUseSoftTabs())var c=a-l%a,u=o.stringRepeat(" ",c);else{for(var c=l%a;" "==s[t.start.column]&&c;)t.start.column--,c--;this.selection.setSelectionRange(t),u="	"}return this.insert(u)},this.blockIndent=function(){var e=this.$getSelectedRows();this.session.indentRows(e.first,e.last,"	")},this.blockOutdent=function(){var e=this.session.getSelection();this.session.outdentRows(e.getRange())},this.sortLines=function(){var e=this.$getSelectedRows(),t=this.session,i=[];for(s=e.first;s<=e.last;s++)i.push(t.getLine(s));i.sort(function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0});for(var n=new p(0,0,0,0),s=e.first;s<=e.last;s++){var o=t.getLine(s);n.start.row=s,n.end.row=s,n.end.column=o.length,t.replace(n,i[s-e.first])}},this.toggleCommentLines=function(){var e=this.session.getState(this.getCursorPosition().row),t=this.$getSelectedRows();this.session.getMode().toggleCommentLines(e,this.session,t.first,t.last)},this.toggleBlockComment=function(){var e=this.getCursorPosition(),t=this.session.getState(e.row),i=this.getSelectionRange();this.session.getMode().toggleBlockComment(t,this.session,i,e)},this.getNumberAt=function(e,t){var i=/[\-]?[0-9]+(?:\.[0-9]+)?/g;i.lastIndex=0;for(var n=this.session.getLine(e);i.lastIndex<t;){var s=i.exec(n);if(s.index<=t&&s.index+s[0].length>=t){var o={value:s[0],start:s.index,end:s.index+s[0].length};return o}}return null},this.modifyNumber=function(e){var t=this.selection.getCursor().row,i=this.selection.getCursor().column,n=new p(t,i-1,t,i),s=this.session.getTextRange(n);if(!isNaN(parseFloat(s))&&isFinite(s)){var o=this.getNumberAt(t,i);if(o){var r=o.value.indexOf(".")>=0?o.start+o.value.indexOf(".")+1:o.end,a=o.start+o.value.length-r,l=parseFloat(o.value);l*=Math.pow(10,a),e*=r!==o.end&&r>i?Math.pow(10,o.end-i-1):Math.pow(10,o.end-i),l+=e,l/=Math.pow(10,a);var c=l.toFixed(a),u=new p(t,o.start,t,o.end);this.session.replace(u,c),this.moveCursorTo(t,Math.max(o.start+1,i+c.length-o.value.length))}}},this.removeLines=function(){var e,t=this.$getSelectedRows();e=0===t.first||t.last+1<this.session.getLength()?new p(t.first,0,t.last+1,0):new p(t.first-1,this.session.getLine(t.first-1).length,t.last,this.session.getLine(t.last).length),this.session.remove(e),this.clearSelection()},this.duplicateSelection=function(){var e=this.selection,t=this.session,i=e.getRange(),n=e.isBackwards();if(i.isEmpty()){var s=i.start.row;t.duplicateLines(s,s)}else{var o=n?i.start:i.end,r=t.insert(o,t.getTextRange(i),!1);i.start=o,i.end=r,e.setSelectionRange(i,n)}},this.moveLinesDown=function(){this.$moveLines(function(e,t){return this.session.moveLinesDown(e,t)})},this.moveLinesUp=function(){this.$moveLines(function(e,t){return this.session.moveLinesUp(e,t)})},this.moveText=function(e,t,i){return this.session.moveText(e,t,i)},this.copyLinesUp=function(){this.$moveLines(function(e,t){return this.session.duplicateLines(e,t),0})},this.copyLinesDown=function(){this.$moveLines(function(e,t){return this.session.duplicateLines(e,t)})},this.$moveLines=function(e){var t=this.selection;if(!t.inMultiSelectMode||this.inVirtualSelectionMode){var i=t.toOrientedRange(),n=this.$getSelectedRows(i),s=e.call(this,n.first,n.last);i.moveBy(s,0),t.fromOrientedRange(i)}else{var o=t.rangeList.ranges;t.rangeList.detach(this.session);for(var r=o.length;r--;){for(var a=r,n=o[r].collapseRows(),l=n.end.row,c=n.start.row;r--&&(n=o[r].collapseRows(),c-n.end.row<=1);)c=n.end.row;r++;for(var s=e.call(this,c,l);a>=r;)o[a].moveBy(s,0),a--}t.fromOrientedRange(t.ranges[0]),t.rangeList.attach(this.session)}},this.$getSelectedRows=function(){var e=this.getSelectionRange().collapseRows();return{first:this.session.getRowFoldStart(e.start.row),last:this.session.getRowFoldEnd(e.end.row)}},this.onCompositionStart=function(e){this.renderer.showComposition(this.getCursorPosition())},this.onCompositionUpdate=function(e){this.renderer.setCompositionText(e)},this.onCompositionEnd=function(){this.renderer.hideComposition()},this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},this.isRowVisible=function(e){return e>=this.getFirstVisibleRow()&&e<=this.getLastVisibleRow()},this.isRowFullyVisible=function(e){return e>=this.renderer.getFirstFullyVisibleRow()&&e<=this.renderer.getLastFullyVisibleRow()},this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},this.$moveByPage=function(e,t){var i=this.renderer,n=this.renderer.layerConfig,s=e*Math.floor(n.height/n.lineHeight);this.$blockScrolling++,t===!0?this.selection.$moveSelection(function(){this.moveCursorBy(s,0)}):t===!1&&(this.selection.moveCursorBy(s,0),this.selection.clearSelection()),this.$blockScrolling--;var o=i.scrollTop;i.scrollBy(0,s*n.lineHeight),null!=t&&i.scrollCursorIntoView(null,.5),i.animateScrolling(o)},this.selectPageDown=function(){this.$moveByPage(1,!0)},this.selectPageUp=function(){this.$moveByPage(-1,!0)},this.gotoPageDown=function(){this.$moveByPage(1,!1)},this.gotoPageUp=function(){this.$moveByPage(-1,!1)},this.scrollPageDown=function(){this.$moveByPage(1)},this.scrollPageUp=function(){this.$moveByPage(-1)},this.scrollToRow=function(e){this.renderer.scrollToRow(e)},this.scrollToLine=function(e,t,i,n){this.renderer.scrollToLine(e,t,i,n)},this.centerSelection=function(){var e=this.getSelectionRange(),t={row:Math.floor(e.start.row+(e.end.row-e.start.row)/2),column:Math.floor(e.start.column+(e.end.column-e.start.column)/2)};this.renderer.alignCursor(t,.5)},this.getCursorPosition=function(){return this.selection.getCursor()},this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},this.getSelectionRange=function(){return this.selection.getRange()},this.selectAll=function(){this.$blockScrolling+=1,this.selection.selectAll(),this.$blockScrolling-=1},this.clearSelection=function(){this.selection.clearSelection()},this.moveCursorTo=function(e,t){this.selection.moveCursorTo(e,t)},this.moveCursorToPosition=function(e){this.selection.moveCursorToPosition(e)},this.jumpToMatching=function(e){var t=this.getCursorPosition(),i=new _(this.session,t.row,t.column),n=i.getCurrentToken(),s=n;if(s||(s=i.stepForward()),s){var o,r,a=!1,l={},c=t.column-s.start,u={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(s.value.match(/[{}()\[\]]/g)){for(;c<s.value.length&&!a;c++)if(u[s.value[c]])switch(r=u[s.value[c]]+"."+s.type.replace("rparen","lparen"),isNaN(l[r])&&(l[r]=0),s.value[c]){case"(":case"[":case"{":l[r]++;break;case")":case"]":case"}":l[r]--,-1===l[r]&&(o="bracket",a=!0)}}else s&&-1!==s.type.indexOf("tag-name")&&(isNaN(l[s.value])&&(l[s.value]=0),"<"===n.value?l[s.value]++:"</"===n.value&&l[s.value]--,-1===l[s.value]&&(o="tag",a=!0));a||(n=s,s=i.stepForward(),c=0)}while(s&&!a);if(o){var h;if("bracket"===o){if(h=this.session.getBracketRange(t),!h){if(h=new p(i.getCurrentTokenRow(),i.getCurrentTokenColumn()+c-1,i.getCurrentTokenRow(),i.getCurrentTokenColumn()+c-1),!h)return;var d=h.start;d.row===t.row&&Math.abs(d.column-t.column)<2&&(h=this.session.getBracketRange(d))}}else if("tag"===o){if(!s||-1===s.type.indexOf("tag-name"))return;var g=s.value,h=new p(i.getCurrentTokenRow(),i.getCurrentTokenColumn()-2,i.getCurrentTokenRow(),i.getCurrentTokenColumn()-2);if(0===h.compare(t.row,t.column)){a=!1;do s=n,n=i.stepBackward(),n&&(-1!==n.type.indexOf("tag-close")&&h.setEnd(i.getCurrentTokenRow(),i.getCurrentTokenColumn()+1),s.value===g&&-1!==s.type.indexOf("tag-name")&&("<"===n.value?l[g]++:"</"===n.value&&l[g]--,0===l[g]&&(a=!0)));while(n&&!a)}if(s&&s.type.indexOf("tag-name")){var d=h.start;d.row==t.row&&Math.abs(d.column-t.column)<2&&(d=h.end)}}d=h&&h.cursor||d,d&&(e?h&&h.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(d.row,d.column):this.selection.moveTo(d.row,d.column))}}},this.gotoLine=function(e,t,i){this.selection.clearSelection(),this.session.unfold({row:e-1,column:t||0}),this.$blockScrolling+=1,this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(e-1,t||0),this.$blockScrolling-=1,this.isRowFullyVisible(e-1)||this.scrollToLine(e-1,!0,i)},this.navigateTo=function(e,t){this.selection.moveTo(e,t)},this.navigateUp=function(e){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(-e||-1,0)},this.navigateDown=function(e){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(e||1,0)},this.navigateLeft=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorLeft();else{var t=this.getSelectionRange().start;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateRight=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorRight();else{var t=this.getSelectionRange().end;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},this.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},this.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},this.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},this.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},this.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},this.replace=function(e,t){t&&this.$search.set(t);var i=this.$search.find(this.session),n=0;return i?(this.$tryReplace(i,e)&&(n=1),null!==i&&(this.selection.setSelectionRange(i),this.renderer.scrollSelectionIntoView(i.start,i.end)),n):n},this.replaceAll=function(e,t){t&&this.$search.set(t);var i=this.$search.findAll(this.session),n=0;if(!i.length)return n;this.$blockScrolling+=1;var s=this.getSelectionRange();this.selection.moveTo(0,0);for(var o=i.length-1;o>=0;--o)this.$tryReplace(i[o],e)&&n++;return this.selection.setSelectionRange(s),this.$blockScrolling-=1,n},this.$tryReplace=function(e,t){var i=this.session.getTextRange(e);return t=this.$search.replace(i,t),null!==t?(e.end=this.session.replace(e,t),e):null},this.getLastSearchOptions=function(){return this.$search.getOptions()},this.find=function(e,t,i){t||(t={}),"string"==typeof e||e instanceof RegExp?t.needle=e:"object"==typeof e&&n.mixin(t,e);var s=this.selection.getRange();null==t.needle&&(e=this.session.getTextRange(s)||this.$search.$options.needle,e||(s=this.session.getWordRange(s.start.row,s.start.column),e=this.session.getTextRange(s)),this.$search.set({needle:e})),this.$search.set(t),t.start||this.$search.set({start:s});var o=this.$search.find(this.session);return t.preventScroll?o:o?(this.revealRange(o,i),o):(t.backwards?s.start=s.end:s.end=s.start,void this.selection.setRange(s))},this.findNext=function(e,t){this.find({skipCurrent:!0,backwards:!1},e,t)},this.findPrevious=function(e,t){this.find(e,{skipCurrent:!0,backwards:!0},t)},this.revealRange=function(e,t){this.$blockScrolling+=1,this.session.unfold(e),this.selection.setSelectionRange(e),this.$blockScrolling-=1;var i=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(e.start,e.end,.5),t!==!1&&this.renderer.animateScrolling(i)},this.undo=function(){this.$blockScrolling++,this.session.getUndoManager().undo(),this.$blockScrolling--,this.renderer.scrollCursorIntoView(null,.5)},this.redo=function(){this.$blockScrolling++,this.session.getUndoManager().redo(),this.$blockScrolling--,this.renderer.scrollCursorIntoView(null,.5)},this.destroy=function(){this.renderer.destroy(),this._signal("destroy",this)},this.setAutoScrollEditorIntoView=function(e){if(e){var t,i=this,n=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var s=this.$scrollAnchor;s.style.cssText="position:absolute",this.container.insertBefore(s,this.container.firstChild);var o=this.on("changeSelection",function(){n=!0}),r=this.renderer.on("beforeRender",function(){n&&(t=i.renderer.container.getBoundingClientRect())}),a=this.renderer.on("afterRender",function(){if(n&&t&&i.isFocused()){var e=i.renderer,o=e.$cursorLayer.$pixelPos,r=e.layerConfig,a=o.top-r.offset;n=o.top>=0&&a+t.top<0?!0:o.top<r.height&&o.top+t.top+r.lineHeight>window.innerHeight?!1:null,null!=n&&(s.style.top=a+"px",s.style.left=o.left+"px",s.style.height=r.lineHeight+"px",s.scrollIntoView(n)),n=t=null}});this.setAutoScrollEditorIntoView=function(e){e||(delete this.setAutoScrollEditorIntoView,this.removeEventListener("changeSelection",o),this.renderer.removeEventListener("afterRender",a),this.renderer.removeEventListener("beforeRender",r))}}},this.$resetCursorStyle=function(){var e=this.$cursorStyle||"ace",t=this.renderer.$cursorLayer;t&&(t.setSmoothBlinking(/smooth/.test(e)),t.isBlinking=!this.$readOnly&&"wide"!=e,s.setCssClass(t.element,"ace_slim-cursors",/slim/.test(e)))}}).call(b.prototype),v.defineOptions(b.prototype,"editor",{selectionStyle:{set:function(e){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:e})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(e){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(e){this.$resetCursorStyle()},initialValue:!1},cursorStyle:{set:function(e){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},autoScrollEditorIntoView:{set:function(e){this.setAutoScrollEditorIntoView(e)}},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",showLineNumbers:"renderer",showGutter:"renderer",displayIndentGuides:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",tabSize:"session",wrap:"session",foldStyle:"session",mode:"session"}),t.Editor=b}),ace.define("ace/undomanager",["require","exports","module"],function(e,t,i){"use strict";var n=function(){this.reset()};(function(){this.execute=function(e){var t=e.args[0];this.$doc=e.args[1],e.merge&&this.hasUndo()&&(this.dirtyCounter--,t=this.$undoStack.pop().concat(t)),this.$undoStack.push(t),this.$redoStack=[],this.dirtyCounter<0&&(this.dirtyCounter=NaN),this.dirtyCounter++},this.undo=function(e){var t=this.$undoStack.pop(),i=null;return t&&(i=this.$doc.undoChanges(t,e),this.$redoStack.push(t),this.dirtyCounter--),i},this.redo=function(e){var t=this.$redoStack.pop(),i=null;return t&&(i=this.$doc.redoChanges(t,e),this.$undoStack.push(t),this.dirtyCounter++),i},this.reset=function(){this.$undoStack=[],this.$redoStack=[],this.dirtyCounter=0},this.hasUndo=function(){return this.$undoStack.length>0},this.hasRedo=function(){return this.$redoStack.length>0},this.markClean=function(){this.dirtyCounter=0},this.isClean=function(){return 0===this.dirtyCounter}}).call(n.prototype),t.UndoManager=n}),ace.define("ace/layer/gutter",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter"],function(e,t,i){"use strict";var n=e("../lib/dom"),s=e("../lib/oop"),o=e("../lib/lang"),r=e("../lib/event_emitter").EventEmitter,a=function(e){this.element=n.createElement("div"),this.element.className="ace_layer ace_gutter-layer",e.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$cells=[]};(function(){s.implement(this,r),this.setSession=function(e){this.session&&this.session.removeEventListener("change",this.$updateAnnotations),this.session=e,e.on("change",this.$updateAnnotations)},this.addGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(e,t)},this.setAnnotations=function(e){this.$annotations=[];for(var t=0;t<e.length;t++){var i=e[t],n=i.row,s=this.$annotations[n];s||(s=this.$annotations[n]={text:[]});var r=i.text;r=r?o.escapeHTML(r):i.html||"",-1===s.text.indexOf(r)&&s.text.push(r);var a=i.type;"error"==a?s.className=" ace_error":"warning"==a&&" ace_error"!=s.className?s.className=" ace_warning":"info"!=a||s.className||(s.className=" ace_info")}},this.$updateAnnotations=function(e){if(this.$annotations.length){var t=e.data,i=t.range,n=i.start.row,s=i.end.row-n;if(0===s);else if("removeText"==t.action||"removeLines"==t.action)this.$annotations.splice(n,s+1,null);else{var o=new Array(s+1);o.unshift(n,1),this.$annotations.splice.apply(this.$annotations,o)}}},this.update=function(e){for(var t=this.session,i=e.firstRow,s=Math.min(e.lastRow+e.gutterOffset,t.getLength()-1),o=t.getNextFoldLine(i),r=o?o.start.row:1/0,a=this.$showFoldWidgets&&t.foldWidgets,l=t.$breakpoints,c=t.$decorations,u=t.$firstLineNumber,h=0,d=t.gutterRenderer||this.$renderer,p=null,g=-1,m=i;;){if(m>r&&(m=o.end.row+1,o=t.getNextFoldLine(m,o),r=o?o.start.row:1/0),m>s){for(;this.$cells.length>g+1;)p=this.$cells.pop(),this.element.removeChild(p.element);break}p=this.$cells[++g],p||(p={element:null,textNode:null,foldWidget:null},p.element=n.createElement("div"),p.textNode=document.createTextNode(""),p.element.appendChild(p.textNode),this.element.appendChild(p.element),this.$cells[g]=p);var f="ace_gutter-cell ";l[m]&&(f+=l[m]),c[m]&&(f+=c[m]),this.$annotations[m]&&(f+=this.$annotations[m].className),p.element.className!=f&&(p.element.className=f);var v=t.getRowLength(m)*e.lineHeight+"px";if(v!=p.element.style.height&&(p.element.style.height=v),a){var _=a[m];null==_&&(_=a[m]=t.getFoldWidget(m))}if(_){p.foldWidget||(p.foldWidget=n.createElement("span"),p.element.appendChild(p.foldWidget));var f="ace_fold-widget ace_"+_;f+="start"==_&&m==r&&m<o.end.row?" ace_closed":" ace_open",p.foldWidget.className!=f&&(p.foldWidget.className=f);var v=e.lineHeight+"px";p.foldWidget.style.height!=v&&(p.foldWidget.style.height=v)}else p.foldWidget&&(p.element.removeChild(p.foldWidget),p.foldWidget=null);var b=h=d?d.getText(t,m):m+u;b!=p.textNode.data&&(p.textNode.data=b),m++}this.element.style.height=e.minHeight+"px",(this.$fixedWidth||t.$useWrapMode)&&(h=t.getLength()+u);var w=d?d.getWidth(t,h,e):h.toString().length*e.characterWidth,y=this.$padding||this.$computePadding();w+=y.left+y.right,w===this.gutterWidth||isNaN(w)||(this.gutterWidth=w,this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._emit("changeGutterWidth",w))},this.$fixedWidth=!1,this.$showLineNumbers=!0,this.$renderer="",this.setShowLineNumbers=function(e){this.$renderer=!e&&{getWidth:function(){return""},getText:function(){return""}}},this.getShowLineNumbers=function(){return this.$showLineNumbers},this.$showFoldWidgets=!0,this.setShowFoldWidgets=function(e){e?n.addCssClass(this.element,"ace_folding-enabled"):n.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=e,this.$padding=null},this.getShowFoldWidgets=function(){return this.$showFoldWidgets},this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var e=n.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=parseInt(e.paddingLeft)+1||0,this.$padding.right=parseInt(e.paddingRight)||0,this.$padding},this.getRegion=function(e){var t=this.$padding||this.$computePadding(),i=this.element.getBoundingClientRect();return e.x<t.left+i.left?"markers":this.$showFoldWidgets&&e.x>i.right-t.right?"foldWidgets":void 0}}).call(a.prototype),t.Gutter=a}),ace.define("ace/layer/marker",["require","exports","module","ace/range","ace/lib/dom"],function(e,t,i){"use strict";var n=e("../range").Range,s=e("../lib/dom"),o=function(e){this.element=s.createElement("div"),this.element.className="ace_layer ace_marker-layer",e.appendChild(this.element)};(function(){this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setMarkers=function(e){this.markers=e},this.update=function(e){var e=e||this.config;if(e){this.config=e;var t=[];for(var i in this.markers){var n=this.markers[i];if(n.range){var o=n.range.clipRows(e.firstRow,e.lastRow);if(!o.isEmpty())if(o=o.toScreenRange(this.session),n.renderer){var r=this.$getTop(o.start.row,e),a=this.$padding+o.start.column*e.characterWidth;n.renderer(t,o,a,r,e)}else"fullLine"==n.type?this.drawFullLineMarker(t,o,n.clazz,e):"screenLine"==n.type?this.drawScreenLineMarker(t,o,n.clazz,e):o.isMultiLine()?"text"==n.type?this.drawTextMarker(t,o,n.clazz,e):this.drawMultiLineMarker(t,o,n.clazz,e):this.drawSingleLineMarker(t,o,n.clazz+" ace_start",e)}else n.update(t,this,this.session,e)}this.element=s.setInnerHtml(this.element,t.join(""))}},this.$getTop=function(e,t){return(e-t.firstRowScreen)*t.lineHeight},this.drawTextMarker=function(e,t,i,s,o){var r=t.start.row,a=new n(r,t.start.column,r,this.session.getScreenLastRowColumn(r));
for(this.drawSingleLineMarker(e,a,i+" ace_start",s,1,o),r=t.end.row,a=new n(r,0,r,t.end.column),this.drawSingleLineMarker(e,a,i,s,0,o),r=t.start.row+1;r<t.end.row;r++)a.start.row=r,a.end.row=r,a.end.column=this.session.getScreenLastRowColumn(r),this.drawSingleLineMarker(e,a,i,s,1,o)},this.drawMultiLineMarker=function(e,t,i,n,s){var o=this.$padding,r=n.lineHeight,a=this.$getTop(t.start.row,n),l=o+t.start.column*n.characterWidth;s=s||"",e.push("<div class='",i," ace_start' style='","height:",r,"px;","right:0;","top:",a,"px;","left:",l,"px;",s,"'></div>"),a=this.$getTop(t.end.row,n);var c=t.end.column*n.characterWidth;e.push("<div class='",i,"' style='","height:",r,"px;","width:",c,"px;","top:",a,"px;","left:",o,"px;",s,"'></div>"),r=(t.end.row-t.start.row-1)*n.lineHeight,0>r||(a=this.$getTop(t.start.row+1,n),e.push("<div class='",i,"' style='","height:",r,"px;","right:0;","top:",a,"px;","left:",o,"px;",s,"'></div>"))},this.drawSingleLineMarker=function(e,t,i,n,s,o){var r=n.lineHeight,a=(t.end.column+(s||0)-t.start.column)*n.characterWidth,l=this.$getTop(t.start.row,n),c=this.$padding+t.start.column*n.characterWidth;e.push("<div class='",i,"' style='","height:",r,"px;","width:",a,"px;","top:",l,"px;","left:",c,"px;",o||"","'></div>")},this.drawFullLineMarker=function(e,t,i,n,s){var o=this.$getTop(t.start.row,n),r=n.lineHeight;t.start.row!=t.end.row&&(r+=this.$getTop(t.end.row,n)-o),e.push("<div class='",i,"' style='","height:",r,"px;","top:",o,"px;","left:0;right:0;",s||"","'></div>")},this.drawScreenLineMarker=function(e,t,i,n,s){var o=this.$getTop(t.start.row,n),r=n.lineHeight;e.push("<div class='",i,"' style='","height:",r,"px;","top:",o,"px;","left:0;right:0;",s||"","'></div>")}}).call(o.prototype),t.Marker=o}),ace.define("ace/layer/text",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/lib/event_emitter"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("../lib/dom"),o=e("../lib/lang"),r=(e("../lib/useragent"),e("../lib/event_emitter").EventEmitter),a=function(e){this.element=s.createElement("div"),this.element.className="ace_layer ace_text-layer",e.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this)};(function(){n.implement(this,r),this.EOF_CHAR="",this.EOL_CHAR_LF="",this.EOL_CHAR_CRLF="",this.EOL_CHAR=this.EOL_CHAR_LF,this.TAB_CHAR="",this.SPACE_CHAR="",this.$padding=0,this.$updateEolChar=function(){var e="\n"==this.session.doc.getNewLineCharacter()?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;return this.EOL_CHAR!=e?(this.EOL_CHAR=e,!0):void 0},this.setPadding=function(e){this.$padding=e,this.element.style.padding="0 "+e+"px"},this.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},this.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},this.$setFontMetrics=function(e){this.$fontMetrics=e,this.$fontMetrics.on("changeCharacterSize",function(e){this._signal("changeCharacterSize",e)}.bind(this)),this.$pollSizeChanges()},this.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},this.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},this.setSession=function(e){this.session=e,this.$computeTabString()},this.showInvisibles=!1,this.setShowInvisibles=function(e){return this.showInvisibles==e?!1:(this.showInvisibles=e,this.$computeTabString(),!0)},this.displayIndentGuides=!0,this.setDisplayIndentGuides=function(e){return this.displayIndentGuides==e?!1:(this.displayIndentGuides=e,this.$computeTabString(),!0)},this.$tabStrings=[],this.onChangeTabSize=this.$computeTabString=function(){var e=this.session.getTabSize();this.tabSize=e;for(var t=this.$tabStrings=[0],i=1;e+1>i;i++)this.showInvisibles?t.push("<span class='ace_invisible ace_invisible_tab'>"+this.TAB_CHAR+o.stringRepeat("",i-1)+"</span>"):t.push(o.stringRepeat("",i));if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var n="ace_indent-guide",s="",r="";if(this.showInvisibles){n+=" ace_invisible",s=" ace_invisible_space",r=" ace_invisible_tab";var a=o.stringRepeat(this.SPACE_CHAR,this.tabSize),l=this.TAB_CHAR+o.stringRepeat("",this.tabSize-1)}else var a=o.stringRepeat("",this.tabSize),l=a;this.$tabStrings[" "]="<span class='"+n+s+"'>"+a+"</span>",this.$tabStrings["	"]="<span class='"+n+r+"'>"+l+"</span>"}},this.updateLines=function(e,t,i){this.config.lastRow==e.lastRow&&this.config.firstRow==e.firstRow||this.scrollLines(e),this.config=e;for(var n=Math.max(t,e.firstRow),o=Math.min(i,e.lastRow),r=this.element.childNodes,a=0,l=e.firstRow;n>l;l++){var c=this.session.getFoldLine(l);if(c){if(c.containsRow(n)){n=c.start.row;break}l=c.end.row}a++}for(var l=n,c=this.session.getNextFoldLine(l),u=c?c.start.row:1/0;;){if(l>u&&(l=c.end.row+1,c=this.session.getNextFoldLine(l,c),u=c?c.start.row:1/0),l>o)break;var h=r[a++];if(h){var d=[];this.$renderLine(d,l,!this.$useLineGroups(),l==u?c:!1),h.style.height=e.lineHeight*this.session.getRowLength(l)+"px",s.setInnerHtml(h,d.join(""))}l++}},this.scrollLines=function(e){var t=this.config;if(this.config=e,!t||t.lastRow<e.firstRow)return this.update(e);if(e.lastRow<t.firstRow)return this.update(e);var i=this.element;if(t.firstRow<e.firstRow)for(var n=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);n>0;n--)i.removeChild(i.firstChild);if(t.lastRow>e.lastRow)for(var n=this.session.getFoldedRowCount(e.lastRow+1,t.lastRow);n>0;n--)i.removeChild(i.lastChild);if(e.firstRow<t.firstRow){var s=this.$renderLinesFragment(e,e.firstRow,t.firstRow-1);i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s)}if(e.lastRow>t.lastRow){var s=this.$renderLinesFragment(e,t.lastRow+1,e.lastRow);i.appendChild(s)}},this.$renderLinesFragment=function(e,t,i){for(var n=this.element.ownerDocument.createDocumentFragment(),o=t,r=this.session.getNextFoldLine(o),a=r?r.start.row:1/0;;){if(o>a&&(o=r.end.row+1,r=this.session.getNextFoldLine(o,r),a=r?r.start.row:1/0),o>i)break;var l=s.createElement("div"),c=[];if(this.$renderLine(c,o,!1,o==a?r:!1),l.innerHTML=c.join(""),this.$useLineGroups())l.className="ace_line_group",n.appendChild(l),l.style.height=e.lineHeight*this.session.getRowLength(o)+"px";else for(;l.firstChild;)n.appendChild(l.firstChild);o++}return n},this.update=function(e){this.config=e;for(var t=[],i=e.firstRow,n=e.lastRow,o=i,r=this.session.getNextFoldLine(o),a=r?r.start.row:1/0;;){if(o>a&&(o=r.end.row+1,r=this.session.getNextFoldLine(o,r),a=r?r.start.row:1/0),o>n)break;this.$useLineGroups()&&t.push("<div class='ace_line_group' style='height:",e.lineHeight*this.session.getRowLength(o),"px'>"),this.$renderLine(t,o,!1,o==a?r:!1),this.$useLineGroups()&&t.push("</div>"),o++}this.element=s.setInnerHtml(this.element,t.join(""))},this.$textToken={text:!0,rparen:!0,lparen:!0},this.$renderToken=function(e,t,i,n){var s=this,r=/\t|&|<|( +)|([\x00-\x1f\x80-\xa0\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\u3000\uFEFF])|[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]/g,a=function(e,i,n,r,a){if(i)return s.showInvisibles?"<span class='ace_invisible ace_invisible_space'>"+o.stringRepeat(s.SPACE_CHAR,e.length)+"</span>":o.stringRepeat("",e.length);if("&"==e)return"&#38;";if("<"==e)return"&#60;";if("	"==e){var l=s.session.getScreenTabSize(t+r);return t+=l-1,s.$tabStrings[l]}if(""==e){var c=s.showInvisibles?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk",u=s.showInvisibles?s.SPACE_CHAR:"";return t+=1,"<span class='"+c+"' style='width:"+2*s.config.characterWidth+"px'>"+u+"</span>"}return n?"<span class='ace_invisible ace_invisible_space ace_invalid'>"+s.SPACE_CHAR+"</span>":(t+=1,"<span class='ace_cjk' style='width:"+2*s.config.characterWidth+"px'>"+e+"</span>")},l=n.replace(r,a);if(this.$textToken[i.type])e.push(l);else{var c="ace_"+i.type.replace(/\./g," ace_"),u="";"fold"==i.type&&(u=" style='width:"+i.value.length*this.config.characterWidth+"px;' "),e.push("<span class='",c,"'",u,">",l,"</span>")}return t+n.length},this.renderIndentGuide=function(e,t,i){var n=t.search(this.$indentGuideRe);return 0>=n||n>=i?t:" "==t[0]?(n-=n%this.tabSize,e.push(o.stringRepeat(this.$tabStrings[" "],n/this.tabSize)),t.substr(n)):"	"==t[0]?(e.push(o.stringRepeat(this.$tabStrings["	"],n)),t.substr(n)):t},this.$renderWrappedLine=function(e,t,i,n){for(var s=0,o=0,r=i[0],a=0,l=0;l<t.length;l++){var c=t[l],u=c.value;if(0==l&&this.displayIndentGuides){if(s=u.length,u=this.renderIndentGuide(e,u,r),!u)continue;s-=u.length}if(s+u.length<r)a=this.$renderToken(e,a,c,u),s+=u.length;else{for(;s+u.length>=r;)a=this.$renderToken(e,a,c,u.substring(0,r-s)),u=u.substring(r-s),s=r,n||e.push("</div>","<div class='ace_line' style='height:",this.config.lineHeight,"px'>"),o++,a=0,r=i[o]||Number.MAX_VALUE;0!=u.length&&(s+=u.length,a=this.$renderToken(e,a,c,u))}}},this.$renderSimpleLine=function(e,t){var i=0,n=t[0],s=n.value;this.displayIndentGuides&&(s=this.renderIndentGuide(e,s)),s&&(i=this.$renderToken(e,i,n,s));for(var o=1;o<t.length;o++)n=t[o],s=n.value,i=this.$renderToken(e,i,n,s)},this.$renderLine=function(e,t,i,n){if(n||0==n||(n=this.session.getFoldLine(t)),n)var s=this.$getFoldLineTokens(t,n);else var s=this.session.getTokens(t);if(i||e.push("<div class='ace_line' style='height:",this.config.lineHeight*(this.$useLineGroups()?1:this.session.getRowLength(t)),"px'>"),s.length){var o=this.session.getRowSplitData(t);o&&o.length?this.$renderWrappedLine(e,s,o,i):this.$renderSimpleLine(e,s)}this.showInvisibles&&(n&&(t=n.end.row),e.push("<span class='ace_invisible ace_invisible_eol'>",t==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,"</span>")),i||e.push("</div>")},this.$getFoldLineTokens=function(e,t){function i(e,t,i){for(var n=0,o=0;o+e[n].value.length<t;)if(o+=e[n].value.length,n++,n==e.length)return;if(o!=t){var r=e[n].value.substring(t-o);r.length>i-t&&(r=r.substring(0,i-t)),s.push({type:e[n].type,value:r}),o=t+r.length,n+=1}for(;i>o&&n<e.length;){var r=e[n].value;r.length+o>i?s.push({type:e[n].type,value:r.substring(0,i-o)}):s.push(e[n]),o+=r.length,n+=1}}var n=this.session,s=[],o=n.getTokens(e);return t.walk(function(e,t,r,a,l){null!=e?s.push({type:"fold",value:e}):(l&&(o=n.getTokens(t)),o.length&&i(o,a,r))},t.end.row,this.session.getLine(t.end.row).length),s},this.$useLineGroups=function(){return this.session.getUseWrapMode()},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$measureNode&&this.$measureNode.parentNode.removeChild(this.$measureNode),delete this.$measureNode}}).call(a.prototype),t.Text=a}),ace.define("ace/layer/cursor",["require","exports","module","ace/lib/dom"],function(e,t,i){"use strict";var n,s=e("../lib/dom"),o=function(e){this.element=s.createElement("div"),this.element.className="ace_layer ace_cursor-layer",e.appendChild(this.element),void 0===n&&(n="opacity"in this.element),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),s.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=this.$updateVisibility.bind(this)};(function(){this.$updateVisibility=function(e){for(var t=this.cursors,i=t.length;i--;)t[i].style.visibility=e?"":"hidden"},this.$updateOpacity=function(e){for(var t=this.cursors,i=t.length;i--;)t[i].style.opacity=e?"":"0"},this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setBlinking=function(e){e!=this.isBlinking&&(this.isBlinking=e,this.restartTimer())},this.setBlinkInterval=function(e){e!=this.blinkInterval&&(this.blinkInterval=e,this.restartTimer())},this.setSmoothBlinking=function(e){e==this.smoothBlinking||n||(this.smoothBlinking=e,s.setCssClass(this.element,"ace_smooth-blinking",e),this.$updateCursors(!0),this.$updateCursors=(e?this.$updateOpacity:this.$updateVisibility).bind(this),this.restartTimer())},this.addCursor=function(){var e=s.createElement("div");return e.className="ace_cursor",this.element.appendChild(e),this.cursors.push(e),e},this.removeCursor=function(){if(this.cursors.length>1){var e=this.cursors.pop();return e.parentNode.removeChild(e),e}},this.hideCursor=function(){this.isVisible=!1,s.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.showCursor=function(){this.isVisible=!0,s.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.restartTimer=function(){var e=this.$updateCursors;if(clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.smoothBlinking&&s.removeCssClass(this.element,"ace_smooth-blinking"),e(!0),this.isBlinking&&this.blinkInterval&&this.isVisible){this.smoothBlinking&&setTimeout(function(){s.addCssClass(this.element,"ace_smooth-blinking")}.bind(this));var t=function(){this.timeoutId=setTimeout(function(){e(!1)},.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval(function(){e(!0),t()},this.blinkInterval),t()}},this.getPixelPosition=function(e,t){if(!this.config||!this.session)return{left:0,top:0};e||(e=this.session.selection.getCursor());var i=this.session.documentToScreenPosition(e),n=this.$padding+i.column*this.config.characterWidth,s=(i.row-(t?this.config.firstRowScreen:0))*this.config.lineHeight;return{left:n,top:s}},this.update=function(e){this.config=e;var t=this.session.$selectionMarkers,i=0,n=0;void 0!==t&&0!==t.length||(t=[{cursor:null}]);for(var i=0,s=t.length;s>i;i++){var o=this.getPixelPosition(t[i].cursor,!0);if(!((o.top>e.height+e.offset||o.top<0)&&i>1)){var r=(this.cursors[n++]||this.addCursor()).style;r.left=o.left+"px",r.top=o.top+"px",r.width=e.characterWidth+"px",r.height=e.lineHeight+"px"}}for(;this.cursors.length>n;)this.removeCursor();var a=this.session.getOverwrite();this.$setOverwrite(a),this.$pixelPos=o,this.restartTimer()},this.$setOverwrite=function(e){e!=this.overwrite&&(this.overwrite=e,e?s.addCssClass(this.element,"ace_overwrite-cursors"):s.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(o.prototype),t.Cursor=o}),ace.define("ace/scrollbar",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/event","ace/lib/event_emitter"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/dom"),o=e("./lib/event"),r=e("./lib/event_emitter").EventEmitter,a=function(e){this.element=s.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix,this.inner=s.createElement("div"),this.inner.className="ace_scrollbar-inner",this.element.appendChild(this.inner),e.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,o.addListener(this.element,"scroll",this.onScroll.bind(this)),o.addListener(this.element,"mousedown",o.preventDefault)};(function(){n.implement(this,r),this.setVisible=function(e){this.element.style.display=e?"":"none",this.isVisible=e}}).call(a.prototype);var l=function(e,t){a.call(this,e),this.scrollTop=0,t.$scrollbarWidth=this.width=s.scrollbarWidth(e.ownerDocument),this.inner.style.width=this.element.style.width=(this.width||15)+5+"px"};n.inherits(l,a),function(){this.classSuffix="-v",this.onScroll=function(){this.skipEvent||(this.scrollTop=this.element.scrollTop,this._emit("scroll",{data:this.scrollTop})),this.skipEvent=!1},this.getWidth=function(){return this.isVisible?this.width:0},this.setHeight=function(e){this.element.style.height=e+"px"},this.setInnerHeight=function(e){this.inner.style.height=e+"px"},this.setScrollHeight=function(e){this.inner.style.height=e+"px"},this.setScrollTop=function(e){this.scrollTop!=e&&(this.skipEvent=!0,this.scrollTop=this.element.scrollTop=e)}}.call(l.prototype);var c=function(e,t){a.call(this,e),this.scrollLeft=0,this.height=t.$scrollbarWidth,this.inner.style.height=this.element.style.height=(this.height||15)+5+"px"};n.inherits(c,a),function(){this.classSuffix="-h",this.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},this.getHeight=function(){return this.isVisible?this.height:0},this.setWidth=function(e){this.element.style.width=e+"px"},this.setInnerWidth=function(e){this.inner.style.width=e+"px"},this.setScrollWidth=function(e){this.inner.style.width=e+"px"},this.setScrollLeft=function(e){this.scrollLeft!=e&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=e)}}.call(c.prototype),t.ScrollBar=l,t.ScrollBarV=l,t.ScrollBarH=c,t.VScrollBar=l,t.HScrollBar=c}),ace.define("ace/renderloop",["require","exports","module","ace/lib/event"],function(e,t,i){"use strict";var n=e("./lib/event"),s=function(e,t){this.onRender=e,this.pending=!1,this.changes=0,this.window=t||window};(function(){this.schedule=function(e){if(this.changes=this.changes|e,!this.pending&&this.changes){this.pending=!0;var t=this;n.nextFrame(function(){t.pending=!1;for(var e;e=t.changes;)t.changes=0,t.onRender(e)},this.window)}}}).call(s.prototype),t.RenderLoop=s}),ace.define("ace/layer/font_metrics",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/lib/event_emitter"],function(e,t,i){var n=e("../lib/oop"),s=e("../lib/dom"),o=e("../lib/lang"),r=e("../lib/useragent"),a=e("../lib/event_emitter").EventEmitter,l=0,c=t.FontMetrics=function(e,t){this.el=s.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=s.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=s.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),e.appendChild(this.el),l||this.$testFractionalRect(),this.$measureNode.innerHTML=o.stringRepeat("X",l),this.$characterSize={width:0,height:0},this.checkForSizeChanges()};(function(){n.implement(this,a),this.$characterSize={width:0,height:0},this.$testFractionalRect=function(){var e=s.createElement("div");this.$setMeasureNodeStyles(e.style),e.style.width="0.2px",document.documentElement.appendChild(e);var t=e.getBoundingClientRect().width;l=t>0&&1>t?1:100,e.parentNode.removeChild(e)},this.$setMeasureNodeStyles=function(e,t){e.width=e.height="auto",e.left=e.top="-100px",e.visibility="hidden",e.position="fixed",e.whiteSpace="pre",r.isIE<8?e["font-family"]="inherit":e.font="inherit",e.overflow=t?"hidden":"visible"},this.checkForSizeChanges=function(){var e=this.$measureSizes();if(e&&(this.$characterSize.width!==e.width||this.$characterSize.height!==e.height)){this.$measureNode.style.fontWeight="bold";var t=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=e,this.charSizes=Object.create(null),this.allowBoldFonts=t&&t.width===e.width&&t.height===e.height,this._emit("changeCharacterSize",{data:e})}},this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer)return this.$pollSizeChangesTimer;var e=this;return this.$pollSizeChangesTimer=setInterval(function(){e.checkForSizeChanges()},500)},this.setPolling=function(e){e?this.$pollSizeChanges():this.$pollSizeChangesTimer&&this.$pollSizeChangesTimer},this.$measureSizes=function(){if(1===l)var e=this.$measureNode.getBoundingClientRect(),t={height:e.height,width:e.width};else var t={height:this.$measureNode.clientHeight,width:this.$measureNode.clientWidth/l};return 0===t.width||0===t.height?null:t},this.$measureCharWidth=function(e){this.$main.innerHTML=o.stringRepeat(e,l);var t=this.$main.getBoundingClientRect();return t.width/l},this.getCharacterWidth=function(e){var t=this.charSizes[e];return void 0===t&&(this.charSizes[e]=this.$measureCharWidth(e)/this.$characterSize.width),t},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)}}).call(c.prototype)}),ace.define("ace/virtual_renderer",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/config","ace/lib/useragent","ace/layer/gutter","ace/layer/marker","ace/layer/text","ace/layer/cursor","ace/scrollbar","ace/scrollbar","ace/renderloop","ace/layer/font_metrics","ace/lib/event_emitter"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/dom"),o=e("./config"),r=e("./lib/useragent"),a=e("./layer/gutter").Gutter,l=e("./layer/marker").Marker,c=e("./layer/text").Text,u=e("./layer/cursor").Cursor,h=e("./scrollbar").HScrollBar,d=e("./scrollbar").VScrollBar,p=e("./renderloop").RenderLoop,g=e("./layer/font_metrics").FontMetrics,m=e("./lib/event_emitter").EventEmitter,f='.ace_editor {	position: relative;	overflow: hidden;	font-family: \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'source-code-pro\', monospace;	font-size: 12px;	line-height: normal;	direction: ltr;	}	.ace_scroller {	position: absolute;	overflow: hidden;	top: 0;	bottom: 0;	background-color: inherit;	-ms-user-select: none;	-moz-user-select: none;	-webkit-user-select: none;	user-select: none;	}	.ace_content {	position: absolute;	-moz-box-sizing: border-box;	-webkit-box-sizing: border-box;	box-sizing: border-box;	cursor: text;	min-width: 100%;	}	.ace_dragging, .ace_dragging * {	cursor: move !important;	}	.ace_dragging .ace_scroller:before{	position: absolute;	top: 0;	left: 0;	right: 0;	bottom: 0;	content: \'\';	background: rgba(250, 250, 250, 0.01);	z-index: 1000;	}	.ace_dragging.ace_dark .ace_scroller:before{	background: rgba(0, 0, 0, 0.01);	}	.ace_selecting, .ace_selecting * {	cursor: text !important;	}	.ace_gutter {	position: absolute;	overflow : hidden;	width: auto;	top: 0;	bottom: 0;	left: 0;	cursor: default;	z-index: 4;	-ms-user-select: none;	-moz-user-select: none;	-webkit-user-select: none;	user-select: none;	}	.ace_gutter-active-line {	position: absolute;	left: 0;	right: 0;	}	.ace_scroller.ace_scroll-left {	box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;	}	.ace_gutter-cell {	padding-left: 19px;	padding-right: 6px;	background-repeat: no-repeat;	}	.ace_gutter-cell.ace_error {	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");	background-repeat: no-repeat;	background-position: 2px center;	}	.ace_gutter-cell.ace_warning {	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");	background-position: 2px center;	}	.ace_gutter-cell.ace_info {	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");	background-position: 2px center;	}	.ace_dark .ace_gutter-cell.ace_info {	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");	}	.ace_scrollbar {	position: absolute;	right: 0;	bottom: 0;	z-index: 6;	}	.ace_scrollbar-inner {	position: absolute;	cursor: text;	left: 0;	top: 0;	}	.ace_scrollbar-v{	overflow-x: hidden;	overflow-y: scroll;	top: 0;	}	.ace_scrollbar-h {	overflow-x: scroll;	overflow-y: hidden;	left: 0;	}	.ace_print-margin {	position: absolute;	height: 100%;	}	.ace_text-input {	position: absolute;	z-index: 0;	width: 0.5em;	height: 1em;	opacity: 0;	background: transparent;	-moz-appearance: none;	appearance: none;	border: none;	resize: none;	outline: none;	overflow: hidden;	font: inherit;	padding: 0 1px;	margin: 0 -1px;	text-indent: -1em;	-ms-user-select: text;	-moz-user-select: text;	-webkit-user-select: text;	user-select: text;	}	.ace_text-input.ace_composition {	background: #f8f8f8;	color: #111;	z-index: 1000;	opacity: 1;	text-indent: 0;	}	.ace_layer {	z-index: 1;	position: absolute;	overflow: hidden;	white-space: pre;	height: 100%;	width: 100%;	-moz-box-sizing: border-box;	-webkit-box-sizing: border-box;	box-sizing: border-box;	pointer-events: none;	}	.ace_gutter-layer {	position: relative;	width: auto;	text-align: right;	pointer-events: auto;	}	.ace_text-layer {	font: inherit !important;	}	.ace_cjk {	display: inline-block;	text-align: center;	}	.ace_cursor-layer {	z-index: 4;	}	.ace_cursor {	z-index: 4;	position: absolute;	-moz-box-sizing: border-box;	-webkit-box-sizing: border-box;	box-sizing: border-box;	border-left: 2px solid	}	.ace_slim-cursors .ace_cursor {	border-left-width: 1px;	}	.ace_overwrite-cursors .ace_cursor {	border-left-width: 0px;	border-bottom: 1px solid;	}	.ace_hidden-cursors .ace_cursor {	opacity: 0.2;	}	.ace_smooth-blinking .ace_cursor {	-moz-transition: opacity 0.18s;	-webkit-transition: opacity 0.18s;	-o-transition: opacity 0.18s;	-ms-transition: opacity 0.18s;	transition: opacity 0.18s;	}	.ace_editor.ace_multiselect .ace_cursor {	border-left-width: 1px;	}	.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {	position: absolute;	z-index: 3;	}	.ace_marker-layer .ace_selection {	position: absolute;	z-index: 5;	}	.ace_marker-layer .ace_bracket {	position: absolute;	z-index: 6;	}	.ace_marker-layer .ace_active-line {	position: absolute;	z-index: 2;	}	.ace_marker-layer .ace_selected-word {	position: absolute;	z-index: 4;	-moz-box-sizing: border-box;	-webkit-box-sizing: border-box;	box-sizing: border-box;	}	.ace_line .ace_fold {	-moz-box-sizing: border-box;	-webkit-box-sizing: border-box;	box-sizing: border-box;	display: inline-block;	height: 11px;	margin-top: -2px;	vertical-align: middle;	background-image:	url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),	url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");	background-repeat: no-repeat, repeat-x;	background-position: center center, top left;	color: transparent;	border: 1px solid black;	-moz-border-radius: 2px;	-webkit-border-radius: 2px;	border-radius: 2px;	cursor: pointer;	pointer-events: auto;	}	.ace_dark .ace_fold {	}	.ace_fold:hover{	background-image:	url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),	url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");	}	.ace_tooltip {	background-color: #FFF;	background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));	background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));	border: 1px solid gray;	border-radius: 1px;	box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);	color: black;	display: block;	max-width: 100%;	padding: 3px 4px;	position: fixed;	z-index: 999999;	-moz-box-sizing: border-box;	-webkit-box-sizing: border-box;	box-sizing: border-box;	cursor: default;	white-space: pre;	word-wrap: break-word;	line-height: normal;	font-style: normal;	font-weight: normal;	letter-spacing: normal;	pointer-events: none;	}	.ace_folding-enabled > .ace_gutter-cell {	padding-right: 13px;	}	.ace_fold-widget {	-moz-box-sizing: border-box;	-webkit-box-sizing: border-box;	box-sizing: border-box;	margin: 0 -12px 0 1px;	display: none;	width: 11px;	vertical-align: top;	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");	background-repeat: no-repeat;	background-position: center;	border-radius: 3px;	border: 1px solid transparent;	cursor: pointer;	}	.ace_folding-enabled .ace_fold-widget {	display: inline-block;   	}	.ace_fold-widget.ace_end {	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");	}	.ace_fold-widget.ace_closed {	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");	}	.ace_fold-widget:hover {	border: 1px solid rgba(0, 0, 0, 0.3);	background-color: rgba(255, 255, 255, 0.2);	-moz-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);	-webkit-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);	box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);	}	.ace_fold-widget:active {	border: 1px solid rgba(0, 0, 0, 0.4);	background-color: rgba(0, 0, 0, 0.05);	-moz-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);	-webkit-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);	box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);	}	.ace_dark .ace_fold-widget {	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");	}	.ace_dark .ace_fold-widget.ace_end {	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");	}	.ace_dark .ace_fold-widget.ace_closed {	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");	}	.ace_dark .ace_fold-widget:hover {	box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);	background-color: rgba(255, 255, 255, 0.1);	}	.ace_dark .ace_fold-widget:active {	-moz-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);	-webkit-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);	box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);	}	.ace_fold-widget.ace_invalid {	background-color: #FFB4B4;	border-color: #DE5555;	}	.ace_fade-fold-widgets .ace_fold-widget {	-moz-transition: opacity 0.4s ease 0.05s;	-webkit-transition: opacity 0.4s ease 0.05s;	-o-transition: opacity 0.4s ease 0.05s;	-ms-transition: opacity 0.4s ease 0.05s;	transition: opacity 0.4s ease 0.05s;	opacity: 0;	}	.ace_fade-fold-widgets:hover .ace_fold-widget {	-moz-transition: opacity 0.05s ease 0.05s;	-webkit-transition: opacity 0.05s ease 0.05s;	-o-transition: opacity 0.05s ease 0.05s;	-ms-transition: opacity 0.05s ease 0.05s;	transition: opacity 0.05s ease 0.05s;	opacity:1;	}	.ace_underline {	text-decoration: underline;	}	.ace_bold {	font-weight: bold;	}	.ace_nobold .ace_bold {	font-weight: normal;	}	.ace_italic {	font-style: italic;	}	.ace_error-marker {	background-color: rgba(255, 0, 0,0.2);	position: absolute;	z-index: 9;	}	.ace_highlight-marker {	background-color: rgba(255, 255, 0,0.2);	position: absolute;	z-index: 8;	}	';
s.importCssString(f,"ace_editor");var v=function(e,t){var i=this;this.container=e||s.createElement("div"),this.$keepTextAreaAtCursor=!r.isOldIE,s.addCssClass(this.container,"ace_editor"),this.setTheme(t),this.$gutter=s.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.scroller=s.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=s.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new a(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new l(this.content);var n=this.$textLayer=new c(this.content);this.canvas=n.element,this.$markerFront=new l(this.content),this.$cursorLayer=new u(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new d(this.container,this),this.scrollBarH=new h(this.container,this),this.scrollBarV.addEventListener("scroll",function(e){i.$scrollAnimation||i.session.setScrollTop(e.data-i.scrollMargin.top)}),this.scrollBarH.addEventListener("scroll",function(e){i.$scrollAnimation||i.session.setScrollLeft(e.data-i.scrollMargin.left)}),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new g(this.container,500),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.addEventListener("changeCharacterSize",function(e){i.updateCharacterSize(),i.onResize(!0,i.gutterWidth,i.$size.width,i.$size.height),i._signal("changeCharacterSize",e)}),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$loop=new p(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),o.resetOptions(this),o._emit("renderer",this)};(function(){this.CHANGE_CURSOR=1,this.CHANGE_MARKER=2,this.CHANGE_GUTTER=4,this.CHANGE_SCROLL=8,this.CHANGE_LINES=16,this.CHANGE_TEXT=32,this.CHANGE_SIZE=64,this.CHANGE_MARKER_BACK=128,this.CHANGE_MARKER_FRONT=256,this.CHANGE_FULL=512,this.CHANGE_H_SCROLL=1024,n.implement(this,m),this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin()},this.setSession=function(e){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),this.session=e,e&&(this.scrollMargin.top&&e.getScrollTop()<=0&&e.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(e),this.$markerBack.setSession(e),this.$markerFront.setSession(e),this.$gutterLayer.setSession(e),this.$textLayer.setSession(e),this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode))},this.updateLines=function(e,t){void 0===t&&(t=1/0),this.$changedLines?(this.$changedLines.firstRow>e&&(this.$changedLines.firstRow=e),this.$changedLines.lastRow<t&&(this.$changedLines.lastRow=t)):this.$changedLines={firstRow:e,lastRow:t},this.$changedLines.firstRow>this.layerConfig.lastRow||this.$changedLines.lastRow<this.layerConfig.firstRow||this.$loop.schedule(this.CHANGE_LINES)},this.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar()},this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},this.updateFull=function(e){e?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},this.$changes=0,this.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},this.onResize=function(e,t,i,n){if(!(this.resizing>2)){this.resizing>0?this.resizing++:this.resizing=e?1:0;var s=this.container;n||(n=s.clientHeight||s.scrollHeight),i||(i=s.clientWidth||s.scrollWidth);var o=this.$updateCachedSize(e,t,i,n);if(!this.$size.scrollerHeight||!i&&!n)return this.resizing=0;e&&(this.$gutterLayer.$padding=null),e?this.$renderChanges(o|this.$changes,!0):this.$loop.schedule(o|this.$changes),this.resizing&&(this.resizing=0)}},this.$updateCachedSize=function(e,t,i,n){n-=this.$extraHeight||0;var s=0,o=this.$size,r={width:o.width,height:o.height,scrollerHeight:o.scrollerHeight,scrollerWidth:o.scrollerWidth};return n&&(e||o.height!=n)&&(o.height=n,s|=this.CHANGE_SIZE,o.scrollerHeight=o.height,this.$horizScroll&&(o.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",s|=this.CHANGE_SCROLL),i&&(e||o.width!=i)&&(s|=this.CHANGE_SIZE,o.width=i,null==t&&(t=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=t,this.scrollBarH.element.style.left=this.scroller.style.left=t+"px",o.scrollerWidth=Math.max(0,i-t-this.scrollBarV.getWidth()),this.scrollBarH.element.style.right=this.scroller.style.right=this.scrollBarV.getWidth()+"px",this.scroller.style.bottom=this.scrollBarH.getHeight()+"px",(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||e)&&(s|=this.CHANGE_FULL)),o.$dirty=!i||!n,s&&this._signal("resize",r),s},this.onGutterResize=function(){var e=this.$showGutter?this.$gutter.offsetWidth:0;e!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,e,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()?this.$loop.schedule(this.CHANGE_FULL):this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):(this.$computeLayerConfig(),this.$loop.schedule(this.CHANGE_MARKER))},this.adjustWrapLimit=function(){var e=this.$size.scrollerWidth-2*this.$padding,t=Math.floor(e/this.characterWidth);return this.session.adjustWrapLimit(t,this.$showPrintMargin&&this.$printMarginColumn)},this.setAnimatedScroll=function(e){this.setOption("animatedScroll",e)},this.getAnimatedScroll=function(){return this.$animatedScroll},this.setShowInvisibles=function(e){this.setOption("showInvisibles",e)},this.getShowInvisibles=function(){return this.getOption("showInvisibles")},this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},this.setDisplayIndentGuides=function(e){this.setOption("displayIndentGuides",e)},this.setShowPrintMargin=function(e){this.setOption("showPrintMargin",e)},this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},this.setPrintMarginColumn=function(e){this.setOption("printMarginColumn",e)},this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},this.getShowGutter=function(){return this.getOption("showGutter")},this.setShowGutter=function(e){return this.setOption("showGutter",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.$updateGutterLineHighlight=function(){var e=this.$cursorLayer.$pixelPos,t=this.layerConfig.lineHeight;if(this.session.getUseWrapMode()){var i=this.session.selection.getCursor();i.column=0,e=this.$cursorLayer.getPixelPosition(i,!0),t*=this.session.getRowLength(i.row)}this.$gutterLineHighlight.style.top=e.top-this.layerConfig.offset+"px",this.$gutterLineHighlight.style.height=t+"px"},this.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var e=s.createElement("div");e.className="ace_layer ace_print-margin-layer",this.$printMarginEl=s.createElement("div"),this.$printMarginEl.className="ace_print-margin",e.appendChild(this.$printMarginEl),this.content.insertBefore(e,this.content.firstChild)}var t=this.$printMarginEl.style;t.left=this.characterWidth*this.$printMarginColumn+this.$padding+"px",t.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},this.getContainerElement=function(){return this.container},this.getMouseEventTarget=function(){return this.content},this.getTextAreaContainer=function(){return this.container},this.$moveTextAreaToCursor=function(){if(this.$keepTextAreaAtCursor){var e=this.layerConfig,t=this.$cursorLayer.$pixelPos.top,i=this.$cursorLayer.$pixelPos.left;t-=e.offset;var n=this.lineHeight;if(!(0>t||t>e.height-n)){var s=this.characterWidth;if(this.$composition){var o=this.textarea.value.replace(/^\x01+/,"");s*=this.session.$getStringScreenWidth(o)[0]+2,n+=2,t-=1}i-=this.scrollLeft,i>this.$size.scrollerWidth-s&&(i=this.$size.scrollerWidth-s),i-=this.scrollBar.width,this.textarea.style.height=n+"px",this.textarea.style.width=s+"px",this.textarea.style.right=Math.max(0,this.$size.scrollerWidth-i-s)+"px",this.textarea.style.bottom=Math.max(0,this.$size.height-t-n)+"px"}}},this.getFirstVisibleRow=function(){return this.layerConfig.firstRow},this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},this.getLastFullyVisibleRow=function(){var e=Math.floor((this.layerConfig.height+this.layerConfig.offset)/this.layerConfig.lineHeight);return this.layerConfig.firstRow-1+e},this.getLastVisibleRow=function(){return this.layerConfig.lastRow},this.$padding=null,this.setPadding=function(e){this.$padding=e,this.$textLayer.setPadding(e),this.$cursorLayer.setPadding(e),this.$markerFront.setPadding(e),this.$markerBack.setPadding(e),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},this.setScrollMargin=function(e,t,i,n){var s=this.scrollMargin;s.top=0|e,s.bottom=0|t,s.right=0|n,s.left=0|i,s.v=s.top+s.bottom,s.h=s.left+s.right,s.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-s.top),this.updateFull()},this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setHScrollBarAlwaysVisible=function(e){this.setOption("hScrollBarAlwaysVisible",e)},this.getVScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setVScrollBarAlwaysVisible=function(e){this.setOption("vScrollBarAlwaysVisible",e)},this.$updateScrollBarV=function(){var e=this.layerConfig.maxHeight,t=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&(e-=(t-this.lineHeight)*this.$scrollPastEnd,this.scrollTop>e-t&&(e=this.scrollTop+t,this.scrollBarV.scrollTop=null)),this.scrollBarV.setScrollHeight(e+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},this.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},this.$frozen=!1,this.freeze=function(){this.$frozen=!0},this.unfreeze=function(){this.$frozen=!1},this.$renderChanges=function(e,t){if(this.$changes&&(e|=this.$changes,this.$changes=0),!this.session||!this.container.offsetWidth||this.$frozen||!e&&!t)return void(this.$changes|=e);if(this.$size.$dirty)return this.$changes|=e,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender");var i=this.layerConfig;return(e&this.CHANGE_FULL||e&this.CHANGE_SIZE||e&this.CHANGE_TEXT||e&this.CHANGE_LINES||e&this.CHANGE_SCROLL||e&this.CHANGE_H_SCROLL)&&(e|=this.$computeLayerConfig(),i=this.layerConfig,this.$updateScrollBarV(),e&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),this.$gutterLayer.element.style.marginTop=-i.offset+"px",this.content.style.marginTop=-i.offset+"px",this.content.style.width=i.width+2*this.$padding+"px",this.content.style.height=i.minHeight+"px"),e&this.CHANGE_H_SCROLL&&(this.content.style.marginLeft=-this.scrollLeft+"px",this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left"),e&this.CHANGE_FULL?(this.$textLayer.update(i),this.$showGutter&&this.$gutterLayer.update(i),this.$markerBack.update(i),this.$markerFront.update(i),this.$cursorLayer.update(i),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),void this._signal("afterRender")):e&this.CHANGE_SCROLL?(e&this.CHANGE_TEXT||e&this.CHANGE_LINES?this.$textLayer.update(i):this.$textLayer.scrollLines(i),this.$showGutter&&this.$gutterLayer.update(i),this.$markerBack.update(i),this.$markerFront.update(i),this.$cursorLayer.update(i),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),this.$moveTextAreaToCursor(),void this._signal("afterRender")):(e&this.CHANGE_TEXT?(this.$textLayer.update(i),this.$showGutter&&this.$gutterLayer.update(i)):e&this.CHANGE_LINES?(this.$updateLines()||e&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(i):(e&this.CHANGE_TEXT||e&this.CHANGE_GUTTER)&&this.$showGutter&&this.$gutterLayer.update(i),e&this.CHANGE_CURSOR&&(this.$cursorLayer.update(i),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight()),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(i),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(i),void this._signal("afterRender"))},this.$autosize=function(){var e=this.session.getScreenLength()*this.lineHeight,t=this.$maxLines*this.lineHeight,i=Math.max((this.$minLines||1)*this.lineHeight,Math.min(t,e))+this.scrollMargin.v+(this.$extraHeight||0),n=e>t;if(i!=this.desiredHeight||this.$size.height!=this.desiredHeight||n!=this.$vScroll){n!=this.$vScroll&&(this.$vScroll=n,this.scrollBarV.setVisible(n));var s=this.container.clientWidth;this.container.style.height=i+"px",this.$updateCachedSize(!0,this.$gutterWidth,s,i),this.desiredHeight=i}},this.$computeLayerConfig=function(){this.$maxLines&&this.lineHeight>1&&this.$autosize();var e=this.session,t=this.$size,i=t.height<=2*this.lineHeight,n=this.session.getScreenLength(),s=n*this.lineHeight,o=this.scrollTop%this.lineHeight,r=t.scrollerHeight+this.lineHeight,a=this.$getLongestLine(),l=!i&&(this.$hScrollBarAlwaysVisible||t.scrollerWidth-a-2*this.$padding<0),c=this.$horizScroll!==l;c&&(this.$horizScroll=l,this.scrollBarH.setVisible(l)),!this.$maxLines&&this.$scrollPastEnd&&(s+=(t.scrollerHeight-this.lineHeight)*this.$scrollPastEnd);var u=!i&&(this.$vScrollBarAlwaysVisible||t.scrollerHeight-s<0),h=this.$vScroll!==u;h&&(this.$vScroll=u,this.scrollBarV.setVisible(u)),this.session.setScrollTop(Math.max(-this.scrollMargin.top,Math.min(this.scrollTop,s-t.scrollerHeight+this.scrollMargin.bottom))),this.session.setScrollLeft(Math.max(-this.scrollMargin.left,Math.min(this.scrollLeft,a+2*this.$padding-t.scrollerWidth+this.scrollMargin.right)));var d,p,g=Math.ceil(r/this.lineHeight)-1,m=Math.max(0,Math.round((this.scrollTop-o)/this.lineHeight)),f=m+g,v=this.lineHeight;m=e.screenToDocumentRow(m,0);var _=e.getFoldLine(m);_&&(m=_.start.row),d=e.documentToScreenRow(m,0),p=e.getRowLength(m)*v,f=Math.min(e.screenToDocumentRow(f,0),e.getLength()-1),r=t.scrollerHeight+e.getRowLength(f)*v+p,o=this.scrollTop-d*v;var b=0;return this.layerConfig.width!=a&&(b=this.CHANGE_H_SCROLL),(c||h)&&(b=this.$updateCachedSize(!0,this.gutterWidth,t.width,t.height),this._signal("scrollbarVisibilityChanged"),h&&(a=this.$getLongestLine())),this.layerConfig={width:a,padding:this.$padding,firstRow:m,firstRowScreen:d,lastRow:f,lineHeight:v,characterWidth:this.characterWidth,minHeight:r,maxHeight:s,offset:o,gutterOffset:Math.max(0,Math.ceil((o+t.height-t.scrollerHeight)/v)),height:this.$size.scrollerHeight},b},this.$updateLines=function(){var e=this.$changedLines.firstRow,t=this.$changedLines.lastRow;this.$changedLines=null;var i=this.layerConfig;return e>i.lastRow+1||t<i.firstRow?void 0:t===1/0?(this.$showGutter&&this.$gutterLayer.update(i),void this.$textLayer.update(i)):(this.$textLayer.updateLines(i,e,t),!0)},this.$getLongestLine=function(){var e=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(e+=1),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(e*this.characterWidth))},this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},this.addGutterDecoration=function(e,t){this.$gutterLayer.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){this.$gutterLayer.removeGutterDecoration(e,t)},this.updateBreakpoints=function(e){this.$loop.schedule(this.CHANGE_GUTTER)},this.setAnnotations=function(e){this.$gutterLayer.setAnnotations(e),this.$loop.schedule(this.CHANGE_GUTTER)},this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},this.hideCursor=function(){this.$cursorLayer.hideCursor()},this.showCursor=function(){this.$cursorLayer.showCursor()},this.scrollSelectionIntoView=function(e,t,i){this.scrollCursorIntoView(e,i),this.scrollCursorIntoView(t,i)},this.scrollCursorIntoView=function(e,t,i){if(0!==this.$size.scrollerHeight){var n=this.$cursorLayer.getPixelPosition(e),s=n.left,o=n.top,r=i&&i.top||0,a=i&&i.bottom||0,l=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;l+r>o?(t&&(o-=t*this.$size.scrollerHeight),0===o&&(o=-this.scrollMargin.top),this.session.setScrollTop(o)):l+this.$size.scrollerHeight-a<o+this.lineHeight&&(t&&(o+=t*this.$size.scrollerHeight),this.session.setScrollTop(o+this.lineHeight-this.$size.scrollerHeight));var c=this.scrollLeft;c>s?(s<this.$padding+2*this.layerConfig.characterWidth&&(s=-this.scrollMargin.left),this.session.setScrollLeft(s)):c+this.$size.scrollerWidth<s+this.characterWidth?this.session.setScrollLeft(Math.round(s+this.characterWidth-this.$size.scrollerWidth)):c<=this.$padding&&s-c<this.characterWidth&&this.session.setScrollLeft(0)}},this.getScrollTop=function(){return this.session.getScrollTop()},this.getScrollLeft=function(){return this.session.getScrollLeft()},this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},this.scrollToRow=function(e){this.session.setScrollTop(e*this.lineHeight)},this.alignCursor=function(e,t){"number"==typeof e&&(e={row:e,column:0});var i=this.$cursorLayer.getPixelPosition(e),n=this.$size.scrollerHeight-this.lineHeight,s=i.top-n*(t||0);return this.session.setScrollTop(s),s},this.STEPS=8,this.$calcSteps=function(e,t){var i=0,n=this.STEPS,s=[],o=function(e,t,i){return i*(Math.pow(e-1,3)+1)+t};for(i=0;n>i;++i)s.push(o(i/this.STEPS,e,t-e));return s},this.scrollToLine=function(e,t,i,n){var s=this.$cursorLayer.getPixelPosition({row:e,column:0}),o=s.top;t&&(o-=this.$size.scrollerHeight/2);var r=this.scrollTop;this.session.setScrollTop(o),i!==!1&&this.animateScrolling(r,n)},this.animateScrolling=function(e,t){var i=this.scrollTop;if(this.$animatedScroll){var n=this;if(e!=i){if(this.$scrollAnimation){var s=this.$scrollAnimation.steps;if(s.length&&(e=s[0],e==i))return}var o=n.$calcSteps(e,i);this.$scrollAnimation={from:e,to:i,steps:o},clearInterval(this.$timer),n.session.setScrollTop(o.shift()),n.session.$scrollTop=i,this.$timer=setInterval(function(){o.length?(n.session.setScrollTop(o.shift()),n.session.$scrollTop=i):null!=i?(n.session.$scrollTop=-1,n.session.setScrollTop(i),i=null):(n.$timer=clearInterval(n.$timer),n.$scrollAnimation=null,t&&t())},10)}}},this.scrollToY=function(e){this.scrollTop!==e&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=e)},this.scrollToX=function(e){this.scrollLeft!==e&&(this.scrollLeft=e),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollTo=function(e,t){this.session.setScrollTop(t),this.session.setScrollLeft(t)},this.scrollBy=function(e,t){t&&this.session.setScrollTop(this.session.getScrollTop()+t),e&&this.session.setScrollLeft(this.session.getScrollLeft()+e)},this.isScrollableBy=function(e,t){return 0>t&&this.session.getScrollTop()>=1-this.scrollMargin.top?!0:t>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom?!0:0>e&&this.session.getScrollLeft()>=1-this.scrollMargin.left?!0:e>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right?!0:void 0},this.pixelToScreenCoordinates=function(e,t){var i=this.scroller.getBoundingClientRect(),n=(e+this.scrollLeft-i.left-this.$padding)/this.characterWidth,s=Math.floor((t+this.scrollTop-i.top)/this.lineHeight),o=Math.round(n);return{row:s,column:o,side:n-o>0?1:-1}},this.screenToTextCoordinates=function(e,t){var i=this.scroller.getBoundingClientRect(),n=Math.round((e+this.scrollLeft-i.left-this.$padding)/this.characterWidth),s=(t+this.scrollTop-i.top)/this.lineHeight;return this.session.screenToDocumentPosition(s,Math.max(n,0))},this.textToScreenCoordinates=function(e,t){var i=this.scroller.getBoundingClientRect(),n=this.session.documentToScreenPosition(e,t),s=this.$padding+Math.round(n.column*this.characterWidth),o=n.row*this.lineHeight;return{pageX:i.left+s-this.scrollLeft,pageY:i.top+o-this.scrollTop}},this.visualizeFocus=function(){s.addCssClass(this.container,"ace_focus")},this.visualizeBlur=function(){s.removeCssClass(this.container,"ace_focus")},this.showComposition=function(e){this.$composition||(this.$composition={keepTextAreaAtCursor:this.$keepTextAreaAtCursor,cssText:this.textarea.style.cssText}),this.$keepTextAreaAtCursor=!0,s.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor()},this.setCompositionText=function(e){this.$moveTextAreaToCursor()},this.hideComposition=function(){this.$composition&&(s.removeCssClass(this.textarea,"ace_composition"),this.$keepTextAreaAtCursor=this.$composition.keepTextAreaAtCursor,this.textarea.style.cssText=this.$composition.cssText,this.$composition=null)},this.setTheme=function(e,t){function i(i){if(n.$themeId!=e)return t&&t();if(i.cssClass){s.importCssString(i.cssText,i.cssClass,n.container.ownerDocument),n.theme&&s.removeCssClass(n.container,n.theme.cssClass);var o="padding"in i?i.padding:"padding"in(n.theme||{})?4:n.$padding;n.$padding&&o!=n.$padding&&n.setPadding(o),n.$theme=i.cssClass,n.theme=i,s.addCssClass(n.container,i.cssClass),s.setCssClass(n.container,"ace_dark",i.isDark),n.$size&&(n.$size.width=0,n.$updateSizeAsync()),n._dispatchEvent("themeLoaded",{theme:i}),t&&t()}}var n=this;if(this.$themeId=e,n._dispatchEvent("themeChange",{theme:e}),e&&"string"!=typeof e)i(e);else{var r=e||this.$options.theme.initialValue;o.loadModule(["theme",r],i)}},this.getTheme=function(){return this.$themeId},this.setStyle=function(e,t){s.setCssClass(this.container,e,t!==!1)},this.unsetStyle=function(e){s.removeCssClass(this.container,e)},this.setCursorStyle=function(e){this.content.style.cursor!=e&&(this.content.style.cursor=e)},this.setMouseCursor=function(e){this.content.style.cursor=e},this.destroy=function(){this.$textLayer.destroy(),this.$cursorLayer.destroy()}}).call(v.prototype),o.defineOptions(v.prototype,"renderer",{animatedScroll:{initialValue:!1},showInvisibles:{set:function(e){this.$textLayer.setShowInvisibles(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(e){"number"==typeof e&&(this.$printMarginColumn=e),this.$showPrintMargin=!!e,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(e){this.$gutter.style.display=e?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},fadeFoldWidgets:{set:function(e){s.setCssClass(this.$gutter,"ace_fade-fold-widgets",e)},initialValue:!1},showFoldWidgets:{set:function(e){this.$gutterLayer.setShowFoldWidgets(e)},initialValue:!0},showLineNumbers:{set:function(e){this.$gutterLayer.setShowLineNumbers(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(e){this.$textLayer.setDisplayIndentGuides(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightGutterLine:{set:function(e){return this.$gutterLineHighlight?(this.$gutterLineHighlight.style.display=e?"":"none",void(this.$cursorLayer.$pixelPos&&this.$updateGutterLineHighlight())):(this.$gutterLineHighlight=s.createElement("div"),this.$gutterLineHighlight.className="ace_gutter-active-line",void this.$gutter.appendChild(this.$gutterLineHighlight))},initialValue:!1,value:!0},hScrollBarAlwaysVisible:{set:function(e){this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(e){this.$vScrollBarAlwaysVisible&&this.$vScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(e){"number"==typeof e&&(e+="px"),this.container.style.fontSize=e,this.updateFontSize()},initialValue:12},fontFamily:{set:function(e){this.container.style.fontFamily=e,this.updateFontSize()}},maxLines:{set:function(e){this.updateFull()}},minLines:{set:function(e){this.updateFull()}},scrollPastEnd:{set:function(e){e=+e||0,this.$scrollPastEnd!=e&&(this.$scrollPastEnd=e,this.$loop.schedule(this.CHANGE_SCROLL))},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(e){this.$gutterLayer.$fixedWidth=!!e,this.$loop.schedule(this.CHANGE_GUTTER)}},theme:{set:function(e){this.setTheme(e)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0}}),t.VirtualRenderer=v}),ace.define("ace/worker/worker_client",["require","exports","module","ace/lib/oop","ace/lib/net","ace/lib/event_emitter","ace/config"],function(e,t,n){"use strict";var s=e("../lib/oop"),o=e("../lib/net"),r=e("../lib/event_emitter").EventEmitter,a=e("../config"),l=function(t,n,s,o){if(this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),e.nameToUrl&&!e.toUrl&&(e.toUrl=e.nameToUrl),a.get("packaged")||!e.toUrl)o=o||a.moduleUrl(n.id,"worker");else{var r=this.$normalizePath;o=o||r(e.toUrl("ace/worker/worker.js",null,"_"));var l={};t.forEach(function(t){l[t]=r(e.toUrl(t,null,"_").replace(/(\.js)?(\?.*)?$/,""))})}try{var c=n.src,u=i(411),h=new u([c],{type:"application/javascript"}),d=(window.URL||window.webkitURL).createObjectURL(h);this.$worker=new Worker(d)}catch(p){if(!(p instanceof window.DOMException))throw p;var h=this.$workerBlob(o),g=window.URL||window.webkitURL,m=g.createObjectURL(h);this.$worker=new Worker(m),g.revokeObjectURL(m)}this.$worker.postMessage({init:!0,tlns:l,module:n.id,classname:s}),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){s.implement(this,r),this.onMessage=function(e){var t=e.data;switch(t.type){case"log":window.console&&console.log&&console.log.apply(console,t.data);break;case"event":this._signal(t.name,{data:t.data});break;case"call":var i=this.callbacks[t.id];i&&(i(t.data),delete this.callbacks[t.id])}},this.$normalizePath=function(e){return o.qualifyURL(e)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker=null,this.$doc.removeEventListener("change",this.changeListener),this.$doc=null},this.send=function(e,t){this.$worker.postMessage({command:e,args:t})},this.call=function(e,t,i){if(i){var n=this.callbackId++;this.callbacks[n]=i,t.push(n)}this.send(e,t)},this.emit=function(e,t){try{this.$worker.postMessage({event:e,data:{data:t.data}})}catch(i){console.error(i.stack)}},this.attachToDocument=function(e){this.$doc&&this.terminate(),this.$doc=e,this.call("setValue",[e.getValue()]),e.on("change",this.changeListener)},this.changeListener=function(e){this.deltaQueue?this.deltaQueue.push(e.data):(this.deltaQueue=[e.data],setTimeout(this.$sendDeltaQueue,0))},this.$sendDeltaQueue=function(){var e=this.deltaQueue;e&&(this.deltaQueue=null,e.length>20&&e.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:e}))},this.$workerBlob=function(e){var t="importScripts('"+o.qualifyURL(e)+"');";try{return new Blob([t],{type:"application/javascript"})}catch(i){var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,s=new n;return s.append(t),s.getBlob("application/javascript")}}}).call(l.prototype);var c=function(e,t,i){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.callbackId=1,this.callbacks={},this.messageBuffer=[];var n=null,s=!1,o=Object.create(r),l=this;this.$worker={},this.$worker.terminate=function(){},this.$worker.postMessage=function(e){l.messageBuffer.push(e),n&&(s?setTimeout(c):c())},this.setEmitSync=function(e){s=e};var c=function(){var e=l.messageBuffer.shift();e.command?n[e.command].apply(n,e.args):e.event&&o._signal(e.event,e.data)};o.postMessage=function(e){l.onMessage({data:e})},o.callback=function(e,t){this.postMessage({type:"call",id:t,data:e})},o.emit=function(e,t){this.postMessage({type:"event",name:e,data:t})},a.loadModule(["worker",t],function(e){for(n=new e[i](o);l.messageBuffer.length;)c()})};c.prototype=l.prototype,t.UIWorkerClient=c,t.WorkerClient=l}),ace.define("ace/placeholder",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/oop"],function(e,t,i){"use strict";var n=e("./range").Range,s=e("./lib/event_emitter").EventEmitter,o=e("./lib/oop"),r=function(e,t,i,n,s,o){var r=this;this.length=t,this.session=e,this.doc=e.getDocument(),this.mainClass=s,this.othersClass=o,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=n,this.$onCursorChange=function(){setTimeout(function(){r.onCursorChange()})},this.$pos=i;var a=e.getUndoManager().$undoStack||e.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=a.length,this.setup(),e.selection.on("changeCursor",this.$onCursorChange)};(function(){o.implement(this,s),this.setup=function(){var e=this,t=this.doc,i=this.session,s=this.$pos;this.pos=t.createAnchor(s.row,s.column),this.markerId=i.addMarker(new n(s.row,s.column,s.row,s.column+this.length),this.mainClass,null,!1),this.pos.on("change",function(t){i.removeMarker(e.markerId),e.markerId=i.addMarker(new n(t.value.row,t.value.column,t.value.row,t.value.column+e.length),e.mainClass,null,!1)}),this.others=[],this.$others.forEach(function(i){var n=t.createAnchor(i.row,i.column);e.others.push(n)}),i.setUndoSelect(!1)},this.showOtherMarkers=function(){if(!this.othersActive){var e=this.session,t=this;this.othersActive=!0,this.others.forEach(function(i){i.markerId=e.addMarker(new n(i.row,i.column,i.row,i.column+t.length),t.othersClass,null,!1),i.on("change",function(s){e.removeMarker(i.markerId),i.markerId=e.addMarker(new n(s.value.row,s.value.column,s.value.row,s.value.column+t.length),t.othersClass,null,!1)})})}},this.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var e=0;e<this.others.length;e++)this.session.removeMarker(this.others[e].markerId)}},this.onUpdate=function(e){var t=e.data,i=t.range;if(i.start.row===i.end.row&&i.start.row===this.pos.row&&!this.$updating){this.$updating=!0;var s="insertText"===t.action?i.end.column-i.start.column:i.start.column-i.end.column;if(i.start.column>=this.pos.column&&i.start.column<=this.pos.column+this.length+1){var o=i.start.column-this.pos.column;if(this.length+=s,!this.session.$fromUndo){if("insertText"===t.action)for(var r=this.others.length-1;r>=0;r--){var a=this.others[r],l={row:a.row,column:a.column+o};a.row===i.start.row&&i.start.column<a.column&&(l.column+=s),
this.doc.insert(l,t.text)}else if("removeText"===t.action)for(var r=this.others.length-1;r>=0;r--){var a=this.others[r],l={row:a.row,column:a.column+o};a.row===i.start.row&&i.start.column<a.column&&(l.column+=s),this.doc.remove(new n(l.row,l.column,l.row,l.column-s))}i.start.column===this.pos.column&&"insertText"===t.action?setTimeout(function(){this.pos.setPosition(this.pos.row,this.pos.column-s);for(var e=0;e<this.others.length;e++){var t=this.others[e],n={row:t.row,column:t.column-s};t.row===i.start.row&&i.start.column<t.column&&(n.column+=s),t.setPosition(n.row,n.column)}}.bind(this),0):i.start.column===this.pos.column&&"removeText"===t.action&&setTimeout(function(){for(var e=0;e<this.others.length;e++){var t=this.others[e];t.row===i.start.row&&i.start.column<t.column&&t.setPosition(t.row,t.column-s)}}.bind(this),0)}this.pos._emit("change",{value:this.pos});for(var r=0;r<this.others.length;r++)this.others[r]._emit("change",{value:this.others[r]})}this.$updating=!1}},this.onCursorChange=function(e){if(!this.$updating){var t=this.session.selection.getCursor();t.row===this.pos.row&&t.column>=this.pos.column&&t.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",e)):(this.hideOtherMarkers(),this._emit("cursorLeave",e))}},this.detach=function(){this.session.removeMarker(this.markerId),this.hideOtherMarkers(),this.doc.removeEventListener("change",this.$onUpdate),this.session.selection.removeEventListener("changeCursor",this.$onCursorChange),this.pos.detach();for(var e=0;e<this.others.length;e++)this.others[e].detach();this.session.setUndoSelect(!0)},this.cancel=function(){if(-1===this.$undoStackDepth)throw Error("Canceling placeholders only supported with undo manager attached to session.");for(var e=this.session.getUndoManager(),t=(e.$undoStack||e.$undostack).length-this.$undoStackDepth,i=0;t>i;i++)e.undo(!0)}}).call(r.prototype),t.PlaceHolder=r}),ace.define("ace/mouse/multi_select_handler",["require","exports","module","ace/lib/event","ace/lib/useragent"],function(e,t,i){function n(e,t){return e.row==t.row&&e.column==t.column}function s(e){var t=e.domEvent,i=t.altKey,s=t.shiftKey,a=t.ctrlKey,l=e.getAccelKey(),c=e.getButton();if(a&&r.isMac&&(c=t.button),e.editor.inMultiSelectMode&&2==c)return void e.editor.textInput.onContextMenu(e.domEvent);if(!a&&!i&&!l)return void(0===c&&e.editor.inMultiSelectMode&&e.editor.exitMultiSelectMode());if(0===c){var u,h=e.editor,d=h.selection,p=h.inMultiSelectMode,g=e.getDocumentPosition(),m=d.getCursor(),f=e.inSelection()||d.isEmpty()&&n(g,m),v=e.x,_=e.y,b=function(e){v=e.clientX,_=e.clientY},w=h.session,y=h.renderer.pixelToScreenCoordinates(v,_),k=y;if(h.$mouseHandler.$enableJumpToDef)a&&i||l&&i?u="add":i&&(u="block");else if(l&&!i){if(u="add",!p&&s)return}else i&&(u="block");if(u&&r.isMac&&t.ctrlKey&&h.$mouseHandler.cancelContextMenu(),"add"==u){if(!p&&f)return;if(!p){var x=d.toOrientedRange();h.addSelectionMarker(x)}var C=d.rangeList.rangeAtPoint(g);h.$blockScrolling++,h.inVirtualSelectionMode=!0,s&&(C=null,x=d.ranges[0],h.removeSelectionMarker(x)),h.once("mouseup",function(){var e=d.toOrientedRange();C&&e.isEmpty()&&n(C.cursor,e.cursor)?d.substractPoint(e.cursor):(s?d.substractPoint(x.cursor):x&&(h.removeSelectionMarker(x),d.addRange(x)),d.addRange(e)),h.$blockScrolling--,h.inVirtualSelectionMode=!1})}else if("block"==u){e.stop(),h.inVirtualSelectionMode=!0;var S,E=[],T=function(){var e=h.renderer.pixelToScreenCoordinates(v,_),t=w.screenToDocumentPosition(e.row,e.column);n(k,e)&&n(t,d.lead)||(k=e,h.selection.moveToPosition(t),h.renderer.scrollCursorIntoView(),h.removeSelectionMarkers(E),E=d.rectangularRangeBlock(k,y),h.$mouseHandler.$clickSelection&&1==E.length&&E[0].isEmpty()&&(E[0]=h.$mouseHandler.$clickSelection.clone()),E.forEach(h.addSelectionMarker,h),h.updateSelectionMarkers())};p&&!l?d.toSingleRange():!p&&l&&(S=d.toOrientedRange(),h.addSelectionMarker(S)),s?y=w.documentToScreenPosition(d.lead):d.moveToPosition(g),k={row:-1,column:-1};var A=function(e){clearInterval(R),h.removeSelectionMarkers(E),E.length||(E=[d.toOrientedRange()]),h.$blockScrolling++,S&&(h.removeSelectionMarker(S),d.toSingleRange(S));for(var t=0;t<E.length;t++)d.addRange(E[t]);h.inVirtualSelectionMode=!1,h.$mouseHandler.$clickSelection=null,h.$blockScrolling--},F=T;o.capture(h.container,b,A);var R=setInterval(function(){F()},20);return e.preventDefault()}}}var o=e("../lib/event"),r=e("../lib/useragent");t.onMouseDown=s}),ace.define("ace/commands/multi_select_commands",["require","exports","module","ace/keyboard/hash_handler"],function(e,t,i){t.defaultCommands=[{name:"addCursorAbove",exec:function(e){e.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},readonly:!0},{name:"addCursorBelow",exec:function(e){e.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},readonly:!0},{name:"addCursorAboveSkipCurrent",exec:function(e){e.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},readonly:!0},{name:"addCursorBelowSkipCurrent",exec:function(e){e.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},readonly:!0},{name:"selectMoreBefore",exec:function(e){e.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},readonly:!0},{name:"selectMoreAfter",exec:function(e){e.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},readonly:!0},{name:"selectNextBefore",exec:function(e){e.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},readonly:!0},{name:"selectNextAfter",exec:function(e){e.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},readonly:!0},{name:"splitIntoLines",exec:function(e){e.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readonly:!0},{name:"alignCursors",exec:function(e){e.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"}},{name:"findAll",exec:function(e){e.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},readonly:!0}],t.multiSelectCommands=[{name:"singleSelection",bindKey:"esc",exec:function(e){e.exitMultiSelectMode()},readonly:!0,isAvailable:function(e){return e&&e.inMultiSelectMode}}];var n=e("../keyboard/hash_handler").HashHandler;t.keyboardHandler=new n(t.multiSelectCommands)}),ace.define("ace/multi_select",["require","exports","module","ace/range_list","ace/range","ace/selection","ace/mouse/multi_select_handler","ace/lib/event","ace/lib/lang","ace/commands/multi_select_commands","ace/search","ace/edit_session","ace/editor","ace/config"],function(e,t,i){function n(e,t,i){return m.$options.wrap=!0,m.$options.needle=t,m.$options.backwards=-1==i,m.find(e)}function s(e,t){return e.row==t.row&&e.column==t.column}function o(e){e.$multiselectOnSessionChange||(e.$onAddRange=e.$onAddRange.bind(e),e.$onRemoveRange=e.$onRemoveRange.bind(e),e.$onMultiSelect=e.$onMultiSelect.bind(e),e.$onSingleSelect=e.$onSingleSelect.bind(e),e.$multiselectOnSessionChange=t.onSessionChange.bind(e),e.$checkMultiselectChange=e.$checkMultiselectChange.bind(e),e.$multiselectOnSessionChange(e),e.on("changeSession",e.$multiselectOnSessionChange),e.on("mousedown",u),e.commands.addCommands(p.defaultCommands),r(e))}function r(e){function t(t){n&&(e.renderer.setMouseCursor(""),n=!1)}var i=e.textInput.getElement(),n=!1;h.addListener(i,"keydown",function(i){18!=i.keyCode||i.ctrlKey||i.shiftKey||i.metaKey?n&&t():n||(e.renderer.setMouseCursor("crosshair"),n=!0)}),h.addListener(i,"keyup",t),h.addListener(i,"blur",t)}var a=e("./range_list").RangeList,l=e("./range").Range,c=e("./selection").Selection,u=e("./mouse/multi_select_handler").onMouseDown,h=e("./lib/event"),d=e("./lib/lang"),p=e("./commands/multi_select_commands");t.commands=p.defaultCommands.concat(p.multiSelectCommands);var g=e("./search").Search,m=new g,f=e("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(f.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(e,t){if(e){if(!this.inMultiSelectMode&&0===this.rangeCount){var i=this.toOrientedRange();if(this.rangeList.add(i),this.rangeList.add(e),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),t||this.fromOrientedRange(e);this.rangeList.removeAll(),this.rangeList.add(i),this.$onAddRange(i)}e.cursor||(e.cursor=e.end);var n=this.rangeList.add(e);return this.$onAddRange(e),n.length&&this.$onRemoveRange(n),this.rangeCount>1&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),t||this.fromOrientedRange(e)}},this.toSingleRange=function(e){e=e||this.ranges[0];var t=this.rangeList.removeAll();t.length&&this.$onRemoveRange(t),e&&this.fromOrientedRange(e)},this.substractPoint=function(e){var t=this.rangeList.substractPoint(e);return t?(this.$onRemoveRange(t),t[0]):void 0},this.mergeOverlappingRanges=function(){var e=this.rangeList.merge();e.length?this.$onRemoveRange(e):this.ranges[0]&&this.fromOrientedRange(this.ranges[0])},this.$onAddRange=function(e){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(e),this._signal("addRange",{range:e})},this.$onRemoveRange=function(e){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var t=this.rangeList.ranges.pop();e.push(t),this.rangeCount=0}for(var i=e.length;i--;){var n=this.ranges.indexOf(e[i]);this.ranges.splice(n,1)}this._signal("removeRange",{ranges:e}),0===this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),t=t||this.ranges[0],t&&!t.isEqual(this.getRange())&&this.fromOrientedRange(t)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new a,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,t=e[e.length-1],i=l.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(i,t.cursor==t.start)}else{var i=this.getRange(),n=this.isBackwards(),s=i.start.row,o=i.end.row;if(s==o){if(n)var r=i.end,a=i.start;else var r=i.start,a=i.end;return this.addRange(l.fromPoints(a,a)),void this.addRange(l.fromPoints(r,r))}var c=[],u=this.getLineRange(s,!0);u.start.column=i.start.column,c.push(u);for(var h=s+1;o>h;h++)c.push(this.getLineRange(h,!0));u=this.getLineRange(o,!0),u.end.column=i.end.column,c.push(u),c.forEach(this.addRange,this)}},this.toggleBlockSelection=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,t=e[e.length-1],i=l.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(i,t.cursor==t.start)}else{var n=this.session.documentToScreenPosition(this.selectionLead),s=this.session.documentToScreenPosition(this.selectionAnchor),o=this.rectangularRangeBlock(n,s);o.forEach(this.addRange,this)}},this.rectangularRangeBlock=function(e,t,i){var n=[],o=e.column<t.column;if(o)var r=e.column,a=t.column;else var r=t.column,a=e.column;var c=e.row<t.row;if(c)var u=e.row,h=t.row;else var u=t.row,h=e.row;0>r&&(r=0),0>u&&(u=0),u==h&&(i=!0);for(var d=u;h>=d;d++){var p=l.fromPoints(this.session.screenToDocumentPosition(d,r),this.session.screenToDocumentPosition(d,a));if(p.isEmpty()){if(g&&s(p.end,g))break;var g=p.end}p.cursor=o?p.start:p.end,n.push(p)}if(c&&n.reverse(),!i){for(var m=n.length-1;n[m].isEmpty()&&m>0;)m--;if(m>0)for(var f=0;n[f].isEmpty();)f++;for(var v=m;v>=f;v--)n[v].isEmpty()&&n.splice(v,1)}return n}}.call(c.prototype);var v=e("./editor").Editor;(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(e){e.cursor||(e.cursor=e.end);var t=this.getSelectionStyle();return e.marker=this.session.addMarker(e,"ace_selection",t),this.session.$selectionMarkers.push(e),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,e},this.removeSelectionMarker=function(e){if(e.marker){this.session.removeMarker(e.marker);var t=this.session.$selectionMarkers.indexOf(e);-1!=t&&this.session.$selectionMarkers.splice(t,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(e){for(var t=this.session.$selectionMarkers,i=e.length;i--;){var n=e[i];if(n.marker){this.session.removeMarker(n.marker);var s=t.indexOf(n);-1!=s&&t.splice(s,1)}}this.session.selectionMarkerCount=t.length},this.$onAddRange=function(e){this.addSelectionMarker(e.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(e){this.removeSelectionMarkers(e.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(e){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(p.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(e){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(p.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection"))},this.$onMultiSelectExec=function(e){var t=e.command,i=e.editor;if(i.multiSelect){if(t.multiSelectAction)"forEach"==t.multiSelectAction?n=i.forEachSelection(t,e.args):"forEachLine"==t.multiSelectAction?n=i.forEachSelection(t,e.args,!0):"single"==t.multiSelectAction?(i.exitMultiSelectMode(),n=t.exec(i,e.args||{})):n=t.multiSelectAction(i,e.args||{});else{var n=t.exec(i,e.args||{});i.multiSelect.addRange(i.multiSelect.toOrientedRange()),i.multiSelect.mergeOverlappingRanges()}return n}},this.forEachSelection=function(e,t,i){if(!this.inVirtualSelectionMode){var n,s=i&&i.keepOrder,o=1==i||i&&i.$byLines,r=this.session,a=this.selection,l=a.rangeList,u=(s?a:l).ranges;if(!u.length)return e.exec?e.exec(this,t||{}):e(this,t||{});var h=a._eventRegistry;a._eventRegistry={};var d=new c(r);this.inVirtualSelectionMode=!0;for(var p=u.length;p--;){if(o)for(;p>0&&u[p].start.row==u[p-1].end.row;)p--;d.fromOrientedRange(u[p]),d.index=p,this.selection=r.selection=d;var g=e.exec?e.exec(this,t||{}):e(this,t||{});n||void 0===g||(n=g),d.toOrientedRange(u[p])}d.detach(),this.selection=r.selection=a,this.inVirtualSelectionMode=!1,a._eventRegistry=h,a.mergeOverlappingRanges();var m=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),m&&m.from==m.to&&this.renderer.animateScrolling(m.from),n}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getSelectedText=function(){var e="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var t=this.multiSelect.rangeList.ranges,i=[],n=0;n<t.length;n++)i.push(this.session.getTextRange(t[n]));var s=this.session.getDocument().getNewLineCharacter();e=i.join(s),e.length==(i.length-1)*s.length&&(e="")}else this.selection.isEmpty()||(e=this.session.getTextRange(this.getSelectionRange()));return e},this.$checkMultiselectChange=function(e,t){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var i=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&t==this.multiSelect.anchor)return;var n=t==this.multiSelect.anchor?i.cursor==i.start?i.end:i.start:i.cursor;s(n,t)||this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange())}},this.onPaste=function(e){if(!this.$readOnly){var t={text:e};if(this._signal("paste",t),e=t.text,!this.inMultiSelectMode||this.inVirtualSelectionMode)return this.insert(e);var i=e.split(/\r\n|\r|\n/),n=this.selection.rangeList.ranges;if(i.length>n.length||i.length<2||!i[1])return this.commands.exec("insertstring",this,e);for(var s=n.length;s--;){var o=n[s];o.isEmpty()||this.session.remove(o),this.session.insert(o.start,i[s])}}},this.findAll=function(e,t,i){if(t=t||{},t.needle=e||t.needle,void 0==t.needle){var n=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();t.needle=this.session.getTextRange(n)}this.$search.set(t);var s=this.$search.findAll(this.session);if(!s.length)return 0;this.$blockScrolling+=1;var o=this.multiSelect;i||o.toSingleRange(s[0]);for(var r=s.length;r--;)o.addRange(s[r],!0);return n&&o.rangeList.rangeAtPoint(n.start)&&o.addRange(n,!0),this.$blockScrolling-=1,s.length},this.selectMoreLines=function(e,t){var i=this.selection.toOrientedRange(),n=i.cursor==i.end,s=this.session.documentToScreenPosition(i.cursor);this.selection.$desiredColumn&&(s.column=this.selection.$desiredColumn);var o=this.session.screenToDocumentPosition(s.row+e,s.column);if(i.isEmpty())var r=o;else var a=this.session.documentToScreenPosition(n?i.end:i.start),r=this.session.screenToDocumentPosition(a.row+e,a.column);if(n){var c=l.fromPoints(o,r);c.cursor=c.start}else{var c=l.fromPoints(r,o);c.cursor=c.end}if(c.desiredColumn=s.column,this.selection.inMultiSelectMode){if(t)var u=i.cursor}else this.selection.addRange(i);this.selection.addRange(c),u&&this.selection.substractPoint(u)},this.transposeSelections=function(e){for(var t=this.session,i=t.multiSelect,n=i.ranges,s=n.length;s--;){var o=n[s];if(o.isEmpty()){var r=t.getWordRange(o.start.row,o.start.column);o.start.row=r.start.row,o.start.column=r.start.column,o.end.row=r.end.row,o.end.column=r.end.column}}i.mergeOverlappingRanges();for(var a=[],s=n.length;s--;){var o=n[s];a.unshift(t.getTextRange(o))}0>e?a.unshift(a.pop()):a.push(a.shift());for(var s=n.length;s--;){var o=n[s],r=o.clone();t.replace(o,a[s]),o.start.row=r.start.row,o.start.column=r.start.column}},this.selectMore=function(e,t){var i=this.session,s=i.multiSelect,o=s.toOrientedRange();o.isEmpty()&&(o=i.getWordRange(o.start.row,o.start.column),o.cursor=-1==e?o.start:o.end,this.multiSelect.addRange(o));var r=i.getTextRange(o),a=n(i,r,e);a&&(a.cursor=-1==e?a.start:a.end,this.$blockScrolling+=1,this.session.unfold(a),this.multiSelect.addRange(a),this.$blockScrolling-=1,this.renderer.scrollCursorIntoView(null,.5)),t&&this.multiSelect.substractPoint(o.cursor)},this.alignCursors=function(){var e=this.session,t=e.multiSelect,i=t.ranges,n=-1,s=i.filter(function(e){return e.cursor.row==n?!0:void(n=e.cursor.row)});if(i.length&&s.length!=i.length-1){s.forEach(function(e){t.substractPoint(e.cursor)});var o=0,r=1/0,a=i.map(function(t){var i=t.cursor,n=e.getLine(i.row),s=n.substr(i.column).search(/\S/g);return-1==s&&(s=0),i.column>o&&(o=i.column),r>s&&(r=s),s});i.forEach(function(t,i){var n=t.cursor,s=o-n.column,c=a[i]-r;s>c?e.insert(n,d.stringRepeat(" ",s-c)):e.remove(new l(n.row,n.column,n.row,n.column-s+c)),t.start.column=t.end.column=o,t.start.row=t.end.row=n.row,t.cursor=t.end}),t.fromOrientedRange(i[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var c=this.selection.getRange(),u=c.start.row,h=c.end.row,p=u==h;if(p){var g,m=this.session.getLength();do g=this.session.getLine(h);while(/[=:]/.test(g)&&++h<m);do g=this.session.getLine(u);while(/[=:]/.test(g)&&--u>0);0>u&&(u=0),h>=m&&(h=m-1)}var f=this.session.doc.removeLines(u,h);f=this.$reAlignText(f,p),this.session.doc.insert({row:u,column:0},f.join("\n")+"\n"),p||(c.start.column=0,c.end.column=f[f.length-1].length),this.selection.setRange(c)}},this.$reAlignText=function(e,t){function i(e){return d.stringRepeat(" ",e)}function n(e){return e[2]?i(r)+e[2]+i(a-e[2].length+l)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}function s(e){return e[2]?i(r+a-e[2].length)+e[2]+i(l," ")+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}function o(e){return e[2]?i(r)+e[2]+i(l)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}var r,a,l,c=!0,u=!0;return e.map(function(e){var t=e.match(/(\s*)(.*?)(\s*)([=:].*)/);return t?null==r?(r=t[1].length,a=t[2].length,l=t[3].length,t):(r+a+l!=t[1].length+t[2].length+t[3].length&&(u=!1),r!=t[1].length&&(c=!1),r>t[1].length&&(r=t[1].length),a<t[2].length&&(a=t[2].length),l>t[3].length&&(l=t[3].length),t):[e]}).map(t?n:c?u?s:n:o)}}).call(v.prototype),t.onSessionChange=function(e){var t=e.session;t.multiSelect||(t.$selectionMarkers=[],t.selection.$initRangeList(),t.multiSelect=t.selection),this.multiSelect=t.multiSelect;var i=e.oldSession;i&&(i.multiSelect.off("addRange",this.$onAddRange),i.multiSelect.off("removeRange",this.$onRemoveRange),i.multiSelect.off("multiSelect",this.$onMultiSelect),i.multiSelect.off("singleSelect",this.$onSingleSelect),i.multiSelect.lead.off("change",this.$checkMultiselectChange),i.multiSelect.anchor.off("change",this.$checkMultiselectChange)),t.multiSelect.on("addRange",this.$onAddRange),t.multiSelect.on("removeRange",this.$onRemoveRange),t.multiSelect.on("multiSelect",this.$onMultiSelect),t.multiSelect.on("singleSelect",this.$onSingleSelect),t.multiSelect.lead.on("change",this.$checkMultiselectChange),t.multiSelect.anchor.on("change",this.$checkMultiselectChange),this.inMultiSelectMode!=t.selection.inMultiSelectMode&&(t.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},t.MultiSelect=o,e("./config").defineOptions(v.prototype,"editor",{enableMultiselect:{set:function(e){o(this),e?(this.on("changeSession",this.$multiselectOnSessionChange),this.on("mousedown",u)):(this.off("changeSession",this.$multiselectOnSessionChange),this.off("mousedown",u))},value:!0}})}),ace.define("ace/mode/folding/fold_mode",["require","exports","module","ace/range"],function(e,t,i){"use strict";var n=e("../../range").Range,s=t.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(e,t,i){var n=e.getLine(i);return this.foldingStartMarker.test(n)?"start":"markbeginend"==t&&this.foldingStopMarker&&this.foldingStopMarker.test(n)?"end":""},this.getFoldWidgetRange=function(e,t,i){return null},this.indentationBlock=function(e,t,i){var s=/\S/,o=e.getLine(t),r=o.search(s);if(-1!=r){for(var a=i||o.length,l=e.getLength(),c=t,u=t;++t<l;){var h=e.getLine(t).search(s);if(-1!=h){if(r>=h)break;u=t}}if(u>c){var d=e.getLine(u).length;return new n(c,a,u,d)}}},this.openingBracketBlock=function(e,t,i,s,o){var r={row:i,column:s+1},a=e.$findClosingBracket(t,r,o);if(a){var l=e.foldWidgets[a.row];return null==l&&(l=e.getFoldWidget(a.row)),"start"==l&&a.row>r.row&&(a.row--,a.column=e.getLine(a.row).length),n.fromPoints(r,a)}},this.closingBracketBlock=function(e,t,i,s,o){var r={row:i,column:s},a=e.$findOpeningBracket(t,r);return a?(a.column++,r.column--,n.fromPoints(a,r)):void 0}}).call(s.prototype)}),ace.define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],function(e,t,i){"use strict";t.isDark=!1,t.cssClass="ace-tm",t.cssText='.ace-tm .ace_gutter {	background: #f0f0f0;	color: #333;	}	.ace-tm .ace_print-margin {	width: 1px;	background: #e8e8e8;	}	.ace-tm .ace_fold {	background-color: #6B72E6;	}	.ace-tm {	background-color: #FFFFFF;	color: black;	}	.ace-tm .ace_cursor {	color: black;	}	.ace-tm .ace_invisible {	color: rgb(191, 191, 191);	}	.ace-tm .ace_storage,	.ace-tm .ace_keyword {	color: blue;	}	.ace-tm .ace_constant {	color: rgb(197, 6, 11);	}	.ace-tm .ace_constant.ace_buildin {	color: rgb(88, 72, 246);	}	.ace-tm .ace_constant.ace_language {	color: rgb(88, 92, 246);	}	.ace-tm .ace_constant.ace_library {	color: rgb(6, 150, 14);	}	.ace-tm .ace_invalid {	background-color: rgba(255, 0, 0, 0.1);	color: red;	}	.ace-tm .ace_support.ace_function {	color: rgb(60, 76, 114);	}	.ace-tm .ace_support.ace_constant {	color: rgb(6, 150, 14);	}	.ace-tm .ace_support.ace_type,	.ace-tm .ace_support.ace_class {	color: rgb(109, 121, 222);	}	.ace-tm .ace_keyword.ace_operator {	color: rgb(104, 118, 135);	}	.ace-tm .ace_string {	color: rgb(3, 106, 7);	}	.ace-tm .ace_comment {	color: rgb(76, 136, 107);	}	.ace-tm .ace_comment.ace_doc {	color: rgb(0, 102, 255);	}	.ace-tm .ace_comment.ace_doc.ace_tag {	color: rgb(128, 159, 191);	}	.ace-tm .ace_constant.ace_numeric {	color: rgb(0, 0, 205);	}	.ace-tm .ace_variable {	color: rgb(49, 132, 149);	}	.ace-tm .ace_xml-pe {	color: rgb(104, 104, 91);	}	.ace-tm .ace_entity.ace_name.ace_function {	color: #0000A2;	}	.ace-tm .ace_heading {	color: rgb(12, 7, 255);	}	.ace-tm .ace_list {	color:rgb(185, 6, 144);	}	.ace-tm .ace_meta.ace_tag {	color:rgb(0, 22, 142);	}	.ace-tm .ace_string.ace_regex {	color: rgb(255, 0, 0)	}	.ace-tm .ace_marker-layer .ace_selection {	background: rgb(181, 213, 255);	}	.ace-tm.ace_multiselect .ace_selection.ace_start {	box-shadow: 0 0 3px 0px white;	border-radius: 2px;	}	.ace-tm .ace_marker-layer .ace_step {	background: rgb(252, 255, 0);	}	.ace-tm .ace_marker-layer .ace_stack {	background: rgb(164, 229, 101);	}	.ace-tm .ace_marker-layer .ace_bracket {	margin: -1px 0 0 -1px;	border: 1px solid rgb(192, 192, 192);	}	.ace-tm .ace_marker-layer .ace_active-line {	background: rgba(0, 0, 0, 0.07);	}	.ace-tm .ace_gutter-active-line {	background-color : #dcdcdc;	}	.ace-tm .ace_marker-layer .ace_selected-word {	background: rgb(250, 250, 255);	border: 1px solid rgb(200, 200, 250);	}	.ace-tm .ace_indent-guide {	background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;	}	';var n=e("../lib/dom");n.importCssString(t.cssText,t.cssClass)}),ace.define("ace/line_widgets",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/range"],function(e,t,i){"use strict";function n(e){this.session=e,this.session.widgetManager=this,this.session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.detach=this.detach.bind(this),this.session.on("change",this.updateOnChange)}var s=(e("./lib/oop"),e("./lib/dom"));e("./range").Range;(function(){this.getRowLength=function(e){var t;return t=this.lineWidgets?this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0:0,this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1+t:1+t},this.$getWidgetScreenLength=function(){var e=0;return this.lineWidgets.forEach(function(t){t&&t.rowCount&&(e+=t.rowCount)}),e},this.attach=function(e){e.widgetManager&&e.widgetManager!=this&&e.widgetManager.detach(),this.editor!=e&&(this.detach(),this.editor=e,this.editor.on("changeSession",this.detach),e.widgetManager=this,e.renderer.on("beforeRender",this.measureWidgets),e.renderer.on("afterRender",this.renderWidgets))},this.detach=function(e){if(!e||e.session!=this.session){var t=this.editor;if(t){t.off("changeSession",this.detach),this.editor=null,t.widgetManager=null,t.renderer.off("beforeRender",this.measureWidgets),t.renderer.off("afterRender",this.renderWidgets);var i=this.session.lineWidgets;i&&i.forEach(function(e){e&&e.el&&e.el.parentNode&&(e._inDocument=!1,e.el.parentNode.removeChild(e.el))})}}},this.updateOnChange=function(e){var t=this.session.lineWidgets;if(t){var i=e.data,n=i.range,s=n.start.row,o=n.end.row-s;if(0===o);else if("removeText"==i.action||"removeLines"==i.action){var r=t.splice(s+1,o);r.forEach(function(e){e&&this.removeLineWidget(e)},this),this.$updateRows()}else{var a=new Array(o);a.unshift(s,0),t.splice.apply(t,a),this.$updateRows()}}},this.$updateRows=function(){var e=this.session.lineWidgets;if(e){var t=!0;e.forEach(function(e,i){e&&(t=!1,e.row=i)}),t&&(this.session.lineWidgets=null)}},this.addLineWidget=function(e){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength())),this.session.lineWidgets[e.row]=e;var t=this.editor.renderer;return e.html&&!e.el&&(e.el=s.createElement("div"),e.el.innerHTML=e.html),e.el&&(s.addCssClass(e.el,"ace_lineWidgetContainer"),e.el.style.position="absolute",e.el.style.zIndex=5,t.container.appendChild(e.el),e._inDocument=!0),e.coverGutter||(e.el.style.zIndex=3),e.pixelHeight||(e.pixelHeight=e.el.offsetHeight),null==e.rowCount&&(e.rowCount=e.pixelHeight/t.layerConfig.lineHeight),this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows(),this.renderWidgets(null,t),e},this.removeLineWidget=function(e){if(e._inDocument=!1,e.el&&e.el.parentNode&&e.el.parentNode.removeChild(e.el),e.editor&&e.editor.destroy)try{e.editor.destroy()}catch(t){}this.session.lineWidgets&&(this.session.lineWidgets[e.row]=void 0),this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows()},this.onWidgetChanged=function(e){this.session._changedWidgets.push(e),this.editor&&this.editor.renderer.updateFull()},this.measureWidgets=function(e,t){var i=this.session._changedWidgets,n=t.layerConfig;if(i&&i.length){for(var s=1/0,o=0;o<i.length;o++){var r=i[o];r._inDocument||(r._inDocument=!0,t.container.appendChild(r.el)),r.h=r.el.offsetHeight,r.fixedWidth||(r.w=r.el.offsetWidth,r.screenWidth=Math.ceil(r.w/n.characterWidth));var a=r.h/n.lineHeight;r.coverLine&&(a-=this.session.getRowLineCount(r.row),0>a&&(a=0)),r.rowCount!=a&&(r.rowCount=a,r.row<s&&(s=r.row))}s!=1/0&&(this.session._emit("changeFold",{data:{start:{row:s}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]}},this.renderWidgets=function(e,t){var i=t.layerConfig,n=this.session.lineWidgets;if(n){for(var s=Math.min(this.firstRow,i.firstRow),o=Math.max(this.lastRow,i.lastRow,n.length);s>0&&!n[s];)s--;this.firstRow=i.firstRow,this.lastRow=i.lastRow,t.$cursorLayer.config=i;for(var r=s;o>=r;r++){var a=n[r];if(a&&a.el){a._inDocument||(a._inDocument=!0,t.container.appendChild(a.el));var l=t.$cursorLayer.getPixelPosition({row:r,column:0},!0).top;a.coverLine||(l+=i.lineHeight*this.session.getRowLineCount(a.row)),a.el.style.top=l-i.offset+"px";var c=a.coverGutter?0:t.gutterWidth;a.fixedWidth||(c-=t.scrollLeft),a.el.style.left=c+"px",a.fixedWidth?a.el.style.right=t.scrollBar.getWidth()+"px":a.el.style.right=""}}}}}).call(n.prototype),t.LineWidgets=n}),ace.define("ace/ext/error_marker",["require","exports","module","ace/line_widgets","ace/lib/dom","ace/range"],function(e,t,i){"use strict";function n(e,t,i){for(var n=0,s=e.length-1;s>=n;){var o=n+s>>1,r=i(t,e[o]);if(r>0)n=o+1;else{if(!(0>r))return o;s=o-1}}return-(n+1)}function s(e,t,i){var s=e.getAnnotations().sort(a.comparePoints);if(s.length){var o=n(s,{row:t,column:-1},a.comparePoints);0>o&&(o=-o-1),o>=s.length-1?o=i>0?0:s.length-1:0===o&&0>i&&(o=s.length-1);var r=s[o];if(r&&i){if(r.row===t){do r=s[o+=i];while(r&&r.row===t);if(!r)return s.slice()}var l=[];t=r.row;do l[0>i?"unshift":"push"](r),r=s[o+=i];while(r&&r.row==t);return l.length&&l}}}var o=e("ace/line_widgets").LineWidgets,r=e("ace/lib/dom"),a=e("ace/range").Range;t.showErrorMarker=function(e,t){var i=e.session;i.widgetManager||(i.widgetManager=new o(i),i.widgetManager.attach(e));var n=e.getCursorPosition(),a=n.row,l=i.lineWidgets&&i.lineWidgets[a];l?l.destroy():a-=t;var c,u=s(i,a,t);if(u){var h=u[0];n.column=(h.pos&&"number"!=typeof h.column?h.pos.sc:h.column)||0,n.row=h.row,c=e.renderer.$gutterLayer.$annotations[n.row]}else{if(l)return;c={text:["Looks good!"],className:"ace_ok"}}e.session.unfold(n.row),e.selection.moveToPosition(n);var d={row:n.row,fixedWidth:!0,coverGutter:!0,el:r.createElement("div")},p=d.el.appendChild(r.createElement("div")),g=d.el.appendChild(r.createElement("div"));g.className="error_widget_arrow "+c.className;var m=e.renderer.$cursorLayer.getPixelPosition(n).left;g.style.left=m+e.renderer.gutterWidth-5+"px",d.el.className="error_widget_wrapper",p.className="error_widget "+c.className,p.innerHTML=c.text.join("<br>"),p.appendChild(r.createElement("div"));var f=function(e,t,i){return 0!==t||"esc"!==i&&"return"!==i?void 0:(d.destroy(),{command:"null"})};d.destroy=function(){e.$mouseHandler.isMousePressed||(e.keyBinding.removeKeyboardHandler(f),i.widgetManager.removeLineWidget(d),e.off("changeSelection",d.destroy),e.off("changeSession",d.destroy),e.off("mouseup",d.destroy),e.off("change",d.destroy))},e.keyBinding.addKeyboardHandler(f),e.on("changeSelection",d.destroy),e.on("changeSession",d.destroy),
e.on("mouseup",d.destroy),e.on("change",d.destroy),e.session.widgetManager.addLineWidget(d),d.el.onmousedown=e.focus.bind(e),e.renderer.scrollCursorIntoView(null,.5,{bottom:d.el.offsetHeight})},r.importCssString("	    .error_widget_wrapper {	        background: inherit;	        color: inherit;	        border:none	    }	    .error_widget {	        border-top: solid 2px;	        border-bottom: solid 2px;	        margin: 5px 0;	        padding: 10px 40px;	        white-space: pre-wrap;	    }	    .error_widget.ace_error, .error_widget_arrow.ace_error{	        border-color: #ff5a5a	    }	    .error_widget.ace_warning, .error_widget_arrow.ace_warning{	        border-color: #F1D817	    }	    .error_widget.ace_info, .error_widget_arrow.ace_info{	        border-color: #5a5a5a	    }	    .error_widget.ace_ok, .error_widget_arrow.ace_ok{	        border-color: #5aaa5a	    }	    .error_widget_arrow {	        position: absolute;	        border: solid 5px;	        border-top-color: transparent!important;	        border-right-color: transparent!important;	        border-left-color: transparent!important;	        top: -5px;	    }	","")}),ace.define("ace/ace",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/dom","ace/lib/event","ace/editor","ace/edit_session","ace/undomanager","ace/virtual_renderer","ace/worker/worker_client","ace/keyboard/hash_handler","ace/placeholder","ace/multi_select","ace/mode/folding/fold_mode","ace/theme/textmate","ace/ext/error_marker","ace/config"],function(e,t,i){"use strict";e("./lib/fixoldbrowsers");var n=e("./lib/dom"),s=e("./lib/event"),o=e("./editor").Editor,r=e("./edit_session").EditSession,a=e("./undomanager").UndoManager,l=e("./virtual_renderer").VirtualRenderer;e("./worker/worker_client"),e("./keyboard/hash_handler"),e("./placeholder"),e("./multi_select"),e("./mode/folding/fold_mode"),e("./theme/textmate"),e("./ext/error_marker"),t.config=e("./config"),t.acequire=e,t.edit=function(e){if("string"==typeof e){var i=e;if(e=document.getElementById(i),!e)throw new Error("ace.edit can't find div #"+i)}if(e.env&&e.env.editor instanceof o)return e.env.editor;var r=t.createEditSession(n.getInnerText(e));e.innerHTML="";var a=new o(new l(e));a.setSession(r);var c={document:r,editor:a,onResize:a.resize.bind(a,null)};return s.addListener(window,"resize",c.onResize),a.on("destroy",function(){s.removeListener(window,"resize",c.onResize)}),e.env=a.env=c,a},t.createEditSession=function(e,t){var i=new r(e,t);return i.setUndoManager(new a),i},t.EditSession=r,t.UndoManager=a}),function(){ace.acequire(["ace/ace"],function(e){e&&e.config.init(!0),window.ace||(window.ace=e);for(var t in e)e.hasOwnProperty(t)&&(window.ace[t]=e[t])})}(),e.exports=window.ace.acequire("ace/ace")},function(e,t){(function(t){function i(){if(t.Blob)try{return new Blob(["asdf"],{type:"text/plain"}),Blob}catch(e){}var i=t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder;return function(e,t){var n=new i,s=t.endings,o=t.type;if(s)for(var r=0,a=e.length;a>r;++r)n.append(e[r],s);else for(var r=0,a=e.length;a>r;++r)n.append(e[r]);return o?n.getBlob(o):n.getBlob()}}e.exports=i()}).call(t,function(){return this}())},function(e,t,i){ace.define("ace/mode/doc_comment_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("./text_highlight_rules").TextHighlightRules,o=function(){this.$rules={start:[{token:"comment.doc.tag",regex:"@[\\w\\d_]+"},{token:"comment.doc.tag",regex:"\\bTODO\\b"},{defaultToken:"comment.doc"}]}};n.inherits(o,s),o.getStartRule=function(e){return{token:"comment.doc",regex:"\\/\\*(?=\\*)",next:e}},o.getEndRule=function(e){return{token:"comment.doc",regex:"\\*\\/",next:e}},t.DocCommentHighlightRules=o}),ace.define("ace/mode/javascript_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/doc_comment_highlight_rules","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("./doc_comment_highlight_rules").DocCommentHighlightRules,o=e("./text_highlight_rules").TextHighlightRules,r=function(){var e=this.createKeywordMapper({"variable.language":"Array|Boolean|Date|Function|Iterator|Number|Object|RegExp|String|Proxy|Namespace|QName|XML|XMLList|ArrayBuffer|Float32Array|Float64Array|Int16Array|Int32Array|Int8Array|Uint16Array|Uint32Array|Uint8Array|Uint8ClampedArray|Error|EvalError|InternalError|RangeError|ReferenceError|StopIteration|SyntaxError|TypeError|URIError|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|eval|isFinite|isNaN|parseFloat|parseInt|JSON|Math|this|arguments|prototype|window|document",keyword:"const|yield|import|get|set|break|case|catch|continue|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|let|var|while|with|debugger|__parent__|__count__|escape|unescape|with|__proto__|class|enum|extends|super|export|implements|private|public|interface|package|protected|static","storage.type":"const|let|var|function","constant.language":"null|Infinity|NaN|undefined","support.function":"alert","constant.language.boolean":"true|false"},"identifier"),t="case|do|else|finally|in|instanceof|return|throw|try|typeof|yield|void",i="[a-zA-Z\\$_-][a-zA-Z\\d\\$_-]*\\b",n="\\\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|[0-2][0-7]{0,2}|3[0-6][0-7]?|37[0-7]?|[4-7][0-7]?|.)";this.$rules={no_regex:[{token:"comment",regex:"\\/\\/",next:"line_comment"},s.getStartRule("doc-start"),{token:"comment",regex:/\/\*/,next:"comment"},{token:"string",regex:"'(?=.)",next:"qstring"},{token:"string",regex:'"(?=.)',next:"qqstring"},{token:"constant.numeric",regex:/0[xX][0-9a-fA-F]+\b/},{token:"constant.numeric",regex:/[+-]?\d+(?:(?:\.\d*)?(?:[eE][+-]?\d+)?)?\b/},{token:["storage.type","punctuation.operator","support.function","punctuation.operator","entity.name.function","text","keyword.operator"],regex:"("+i+")(\\.)(prototype)(\\.)("+i+")(\\s*)(=)",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+i+")(\\.)("+i+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+i+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+i+")(\\.)("+i+")(\\s*)(=)(\\s*)(function)(\\s+)(\\w+)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","text","entity.name.function","text","paren.lparen"],regex:"(function)(\\s+)("+i+")(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","punctuation.operator","text","storage.type","text","paren.lparen"],regex:"("+i+")(\\s*)(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["text","text","storage.type","text","paren.lparen"],regex:"(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:"keyword",regex:"(?:"+t+")\\b",next:"start"},{token:["punctuation.operator","support.function"],regex:/(\.)(s(?:h(?:ift|ow(?:Mod(?:elessDialog|alDialog)|Help))|croll(?:X|By(?:Pages|Lines)?|Y|To)?|t(?:op|rike)|i(?:n|zeToContent|debar|gnText)|ort|u(?:p|b(?:str(?:ing)?)?)|pli(?:ce|t)|e(?:nd|t(?:Re(?:sizable|questHeader)|M(?:i(?:nutes|lliseconds)|onth)|Seconds|Ho(?:tKeys|urs)|Year|Cursor|Time(?:out)?|Interval|ZOptions|Date|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Date|FullYear)|FullYear|Active)|arch)|qrt|lice|avePreferences|mall)|h(?:ome|andleEvent)|navigate|c(?:har(?:CodeAt|At)|o(?:s|n(?:cat|textual|firm)|mpile)|eil|lear(?:Timeout|Interval)?|a(?:ptureEvents|ll)|reate(?:StyleSheet|Popup|EventObject))|t(?:o(?:GMTString|S(?:tring|ource)|U(?:TCString|pperCase)|Lo(?:caleString|werCase))|est|a(?:n|int(?:Enabled)?))|i(?:s(?:NaN|Finite)|ndexOf|talics)|d(?:isableExternalCapture|ump|etachEvent)|u(?:n(?:shift|taint|escape|watch)|pdateCommands)|j(?:oin|avaEnabled)|p(?:o(?:p|w)|ush|lugins.refresh|a(?:ddings|rse(?:Int|Float)?)|r(?:int|ompt|eference))|e(?:scape|nableExternalCapture|val|lementFromPoint|x(?:p|ec(?:Script|Command)?))|valueOf|UTC|queryCommand(?:State|Indeterm|Enabled|Value)|f(?:i(?:nd|le(?:ModifiedDate|Size|CreatedDate|UpdatedDate)|xed)|o(?:nt(?:size|color)|rward)|loor|romCharCode)|watch|l(?:ink|o(?:ad|g)|astIndexOf)|a(?:sin|nchor|cos|t(?:tachEvent|ob|an(?:2)?)|pply|lert|b(?:s|ort))|r(?:ou(?:nd|teEvents)|e(?:size(?:By|To)|calc|turnValue|place|verse|l(?:oad|ease(?:Capture|Events)))|andom)|g(?:o|et(?:ResponseHeader|M(?:i(?:nutes|lliseconds)|onth)|Se(?:conds|lection)|Hours|Year|Time(?:zoneOffset)?|Da(?:y|te)|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Da(?:y|te)|FullYear)|FullYear|A(?:ttention|llResponseHeaders)))|m(?:in|ove(?:B(?:y|elow)|To(?:Absolute)?|Above)|ergeAttributes|a(?:tch|rgins|x))|b(?:toa|ig|o(?:ld|rderWidths)|link|ack))\b(?=\()/},{token:["punctuation.operator","support.function.dom"],regex:/(\.)(s(?:ub(?:stringData|mit)|plitText|e(?:t(?:NamedItem|Attribute(?:Node)?)|lect))|has(?:ChildNodes|Feature)|namedItem|c(?:l(?:ick|o(?:se|neNode))|reate(?:C(?:omment|DATASection|aption)|T(?:Head|extNode|Foot)|DocumentFragment|ProcessingInstruction|E(?:ntityReference|lement)|Attribute))|tabIndex|i(?:nsert(?:Row|Before|Cell|Data)|tem)|open|delete(?:Row|C(?:ell|aption)|T(?:Head|Foot)|Data)|focus|write(?:ln)?|a(?:dd|ppend(?:Child|Data))|re(?:set|place(?:Child|Data)|move(?:NamedItem|Child|Attribute(?:Node)?)?)|get(?:NamedItem|Element(?:sBy(?:Name|TagName)|ById)|Attribute(?:Node)?)|blur)\b(?=\()/},{token:["punctuation.operator","support.constant"],regex:/(\.)(s(?:ystemLanguage|cr(?:ipts|ollbars|een(?:X|Y|Top|Left))|t(?:yle(?:Sheets)?|atus(?:Text|bar)?)|ibling(?:Below|Above)|ource|uffixes|e(?:curity(?:Policy)?|l(?:ection|f)))|h(?:istory|ost(?:name)?|as(?:h|Focus))|y|X(?:MLDocument|SLDocument)|n(?:ext|ame(?:space(?:s|URI)|Prop))|M(?:IN_VALUE|AX_VALUE)|c(?:haracterSet|o(?:n(?:structor|trollers)|okieEnabled|lorDepth|mp(?:onents|lete))|urrent|puClass|l(?:i(?:p(?:boardData)?|entInformation)|osed|asses)|alle(?:e|r)|rypto)|t(?:o(?:olbar|p)|ext(?:Transform|Indent|Decoration|Align)|ags)|SQRT(?:1_2|2)|i(?:n(?:ner(?:Height|Width)|put)|ds|gnoreCase)|zIndex|o(?:scpu|n(?:readystatechange|Line)|uter(?:Height|Width)|p(?:sProfile|ener)|ffscreenBuffering)|NEGATIVE_INFINITY|d(?:i(?:splay|alog(?:Height|Top|Width|Left|Arguments)|rectories)|e(?:scription|fault(?:Status|Ch(?:ecked|arset)|View)))|u(?:ser(?:Profile|Language|Agent)|n(?:iqueID|defined)|pdateInterval)|_content|p(?:ixelDepth|ort|ersonalbar|kcs11|l(?:ugins|atform)|a(?:thname|dding(?:Right|Bottom|Top|Left)|rent(?:Window|Layer)?|ge(?:X(?:Offset)?|Y(?:Offset)?))|r(?:o(?:to(?:col|type)|duct(?:Sub)?|mpter)|e(?:vious|fix)))|e(?:n(?:coding|abledPlugin)|x(?:ternal|pando)|mbeds)|v(?:isibility|endor(?:Sub)?|Linkcolor)|URLUnencoded|P(?:I|OSITIVE_INFINITY)|f(?:ilename|o(?:nt(?:Size|Family|Weight)|rmName)|rame(?:s|Element)|gColor)|E|whiteSpace|l(?:i(?:stStyleType|n(?:eHeight|kColor))|o(?:ca(?:tion(?:bar)?|lName)|wsrc)|e(?:ngth|ft(?:Context)?)|a(?:st(?:M(?:odified|atch)|Index|Paren)|yer(?:s|X)|nguage))|a(?:pp(?:MinorVersion|Name|Co(?:deName|re)|Version)|vail(?:Height|Top|Width|Left)|ll|r(?:ity|guments)|Linkcolor|bove)|r(?:ight(?:Context)?|e(?:sponse(?:XML|Text)|adyState))|global|x|m(?:imeTypes|ultiline|enubar|argin(?:Right|Bottom|Top|Left))|L(?:N(?:10|2)|OG(?:10E|2E))|b(?:o(?:ttom|rder(?:Width|RightWidth|BottomWidth|Style|Color|TopWidth|LeftWidth))|ufferDepth|elow|ackground(?:Color|Image)))\b/},{token:["support.constant"],regex:/that\b/},{token:["storage.type","punctuation.operator","support.function.firebug"],regex:/(console)(\.)(warn|info|log|error|time|trace|timeEnd|assert)\b/},{token:e,regex:i},{token:"keyword.operator",regex:/--|\+\+|[!$%&*+\-~]|===|==|=|!=|!==|<=|>=|<<=|>>=|>>>=|<>|<|>|!|&&|\|\||\?\:|\*=|%=|\+=|\-=|&=|\^=/,next:"start"},{token:"punctuation.operator",regex:/\?|\:|\,|\;|\./,next:"start"},{token:"paren.lparen",regex:/[\[({]/,next:"start"},{token:"paren.rparen",regex:/[\])}]/},{token:"keyword.operator",regex:/\/=?/,next:"start"},{token:"comment",regex:/^#!.*$/}],start:[s.getStartRule("doc-start"),{token:"comment",regex:"\\/\\*",next:"comment_regex_allowed"},{token:"comment",regex:"\\/\\/",next:"line_comment_regex_allowed"},{token:"string.regexp",regex:"\\/",next:"regex"},{token:"text",regex:"\\s+|^$",next:"start"},{token:"empty",regex:"",next:"no_regex"}],regex:[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"string.regexp",regex:"/[sxngimy]*",next:"no_regex"},{token:"invalid",regex:/\{\d+\b,?\d*\}[+*]|[+*$^?][+*]|[$^][?]|\?{3,}/},{token:"constant.language.escape",regex:/\(\?[:=!]|\)|\{\d+\b,?\d*\}|[+*]\?|[()$^+*?.]/},{token:"constant.language.delimiter",regex:/\|/},{token:"constant.language.escape",regex:/\[\^?/,next:"regex_character_class"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp"}],regex_character_class:[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"constant.language.escape",regex:"]",next:"regex"},{token:"constant.language.escape",regex:"-"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp.charachterclass"}],function_arguments:[{token:"variable.parameter",regex:i},{token:"punctuation.operator",regex:"[, ]+"},{token:"punctuation.operator",regex:"$"},{token:"empty",regex:"",next:"no_regex"}],comment_regex_allowed:[{token:"comment",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}],comment:[{token:"comment",regex:"\\*\\/",next:"no_regex"},{defaultToken:"comment"}],line_comment_regex_allowed:[{token:"comment",regex:"$|^",next:"start"},{defaultToken:"comment"}],line_comment:[{token:"comment",regex:"$|^",next:"no_regex"},{defaultToken:"comment"}],qqstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",next:"qqstring"},{token:"string",regex:'"|$',next:"no_regex"},{defaultToken:"string"}],qstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",next:"qstring"},{token:"string",regex:"'|$",next:"no_regex"},{defaultToken:"string"}]},this.embedRules(s,"doc-",[s.getEndRule("no_regex")])};n.inherits(r,o),t.JavaScriptHighlightRules=r}),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],function(e,t,i){"use strict";var n=e("../range").Range,s=function(){};(function(){this.checkOutdent=function(e,t){return/^\s+$/.test(e)?/^\s*\}/.test(t):!1},this.autoOutdent=function(e,t){var i=e.getLine(t),s=i.match(/^(\s*\})/);if(!s)return 0;var o=s[1].length,r=e.findMatchingBracket({row:t,column:o});if(!r||r.row==t)return 0;var a=this.$getIndent(e.getLine(r.row));e.replace(new n(t,0,t,o-1),a)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(s.prototype),t.MatchingBraceOutdent=s}),ace.define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],function(e,t,i){"use strict";var n,s=e("../../lib/oop"),o=e("../behaviour").Behaviour,r=e("../../token_iterator").TokenIterator,a=e("../../lib/lang"),l=["text","paren.rparen","punctuation.operator"],c=["text","paren.rparen","punctuation.operator","comment"],u={},h=function(e){var t=-1;return e.multiSelect&&(t=e.selection.id,u.rangeCount!=e.multiSelect.rangeCount&&(u={rangeCount:e.multiSelect.rangeCount})),u[t]?n=u[t]:void(n=u[t]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""})},d=function(){this.add("braces","insertion",function(e,t,i,s,o){var r=i.getCursorPosition(),l=s.doc.getLine(r.row);if("{"==o){h(i);var c=i.getSelectionRange(),u=s.doc.getTextRange(c);if(""!==u&&"{"!==u&&i.getWrapBehavioursEnabled())return{text:"{"+u+"}",selection:!1};if(d.isSaneInsertion(i,s))return/[\]\}\)]/.test(l[r.column])||i.inMultiSelectMode?(d.recordAutoInsert(i,s,"}"),{text:"{}",selection:[1,1]}):(d.recordMaybeInsert(i,s,"{"),{text:"{",selection:[1,1]})}else if("}"==o){h(i);var p=l.substring(r.column,r.column+1);if("}"==p){var g=s.$findOpeningBracket("}",{column:r.column+1,row:r.row});if(null!==g&&d.isAutoInsertedClosing(r,l,o))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}else{if("\n"==o||"\r\n"==o){h(i);var m="";d.isMaybeInsertedClosing(r,l)&&(m=a.stringRepeat("}",n.maybeInsertedBrackets),d.clearMaybeInsertedClosing());var p=l.substring(r.column,r.column+1);if("}"===p){var f=s.findMatchingBracket({row:r.row,column:r.column+1},"}");if(!f)return null;var v=this.$getIndent(s.getLine(f.row))}else{if(!m)return void d.clearMaybeInsertedClosing();var v=this.$getIndent(l)}var _=v+s.getTabString();return{text:"\n"+_+"\n"+v+m,selection:[1,_.length,1,_.length]}}d.clearMaybeInsertedClosing()}}),this.add("braces","deletion",function(e,t,i,s,o){var r=s.doc.getTextRange(o);if(!o.isMultiLine()&&"{"==r){h(i);var a=s.doc.getLine(o.start.row),l=a.substring(o.end.column,o.end.column+1);if("}"==l)return o.end.column++,o;n.maybeInsertedBrackets--}}),this.add("parens","insertion",function(e,t,i,n,s){if("("==s){h(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return{text:"("+r+")",selection:!1};if(d.isSaneInsertion(i,n))return d.recordAutoInsert(i,n,")"),{text:"()",selection:[1,1]}}else if(")"==s){h(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),c=l.substring(a.column,a.column+1);if(")"==c){var u=n.$findOpeningBracket(")",{column:a.column+1,row:a.row});if(null!==u&&d.isAutoInsertedClosing(a,l,s))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("parens","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"("==o){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(")"==a)return s.end.column++,s}}),this.add("brackets","insertion",function(e,t,i,n,s){if("["==s){h(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return{text:"["+r+"]",selection:!1};if(d.isSaneInsertion(i,n))return d.recordAutoInsert(i,n,"]"),{text:"[]",selection:[1,1]}}else if("]"==s){h(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),c=l.substring(a.column,a.column+1);if("]"==c){var u=n.$findOpeningBracket("]",{column:a.column+1,row:a.row});if(null!==u&&d.isAutoInsertedClosing(a,l,s))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("brackets","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"["==o){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if("]"==a)return s.end.column++,s}}),this.add("string_dquotes","insertion",function(e,t,i,n,s){if('"'==s||"'"==s){h(i);var o=s,r=i.getSelectionRange(),a=n.doc.getTextRange(r);if(""!==a&&"'"!==a&&'"'!=a&&i.getWrapBehavioursEnabled())return{text:o+a+o,selection:!1};var l=i.getCursorPosition(),c=n.doc.getLine(l.row),u=c.substring(l.column-1,l.column);if("\\"==u)return null;for(var p,g=n.getTokens(r.start.row),m=0,f=-1,v=0;v<g.length&&(p=g[v],"string"==p.type?f=-1:0>f&&(f=p.value.indexOf(o)),!(p.value.length+m>r.start.column));v++)m+=g[v].value.length;if(!p||0>f&&"comment"!==p.type&&("string"!==p.type||r.start.column!==p.value.length+m-1&&p.value.lastIndexOf(o)===p.value.length-1)){if(!d.isSaneInsertion(i,n))return;return{text:o+o,selection:[1,1]}}if(p&&"string"===p.type){var _=c.substring(l.column,l.column+1);if(_==o)return{text:"",selection:[1,1]}}}}),this.add("string_dquotes","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&('"'==o||"'"==o)){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(a==o)return s.end.column++,s}})};d.isSaneInsertion=function(e,t){var i=e.getCursorPosition(),n=new r(t,i.row,i.column);if(!this.$matchTokenType(n.getCurrentToken()||"text",l)){var s=new r(t,i.row,i.column+1);if(!this.$matchTokenType(s.getCurrentToken()||"text",l))return!1}return n.stepForward(),n.getCurrentTokenRow()!==i.row||this.$matchTokenType(n.getCurrentToken()||"text",c)},d.$matchTokenType=function(e,t){return t.indexOf(e.type||e)>-1},d.recordAutoInsert=function(e,t,i){var s=e.getCursorPosition(),o=t.doc.getLine(s.row);this.isAutoInsertedClosing(s,o,n.autoInsertedLineEnd[0])||(n.autoInsertedBrackets=0),n.autoInsertedRow=s.row,n.autoInsertedLineEnd=i+o.substr(s.column),n.autoInsertedBrackets++},d.recordMaybeInsert=function(e,t,i){var s=e.getCursorPosition(),o=t.doc.getLine(s.row);this.isMaybeInsertedClosing(s,o)||(n.maybeInsertedBrackets=0),n.maybeInsertedRow=s.row,n.maybeInsertedLineStart=o.substr(0,s.column)+i,n.maybeInsertedLineEnd=o.substr(s.column),n.maybeInsertedBrackets++},d.isAutoInsertedClosing=function(e,t,i){return n.autoInsertedBrackets>0&&e.row===n.autoInsertedRow&&i===n.autoInsertedLineEnd[0]&&t.substr(e.column)===n.autoInsertedLineEnd},d.isMaybeInsertedClosing=function(e,t){return n.maybeInsertedBrackets>0&&e.row===n.maybeInsertedRow&&t.substr(e.column)===n.maybeInsertedLineEnd&&t.substr(0,e.column)==n.maybeInsertedLineStart},d.popAutoInsertedClosing=function(){n.autoInsertedLineEnd=n.autoInsertedLineEnd.substr(1),n.autoInsertedBrackets--},d.clearMaybeInsertedClosing=function(){n&&(n.maybeInsertedBrackets=0,n.maybeInsertedRow=-1)},s.inherits(d,o),t.CstyleBehaviour=d}),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=e("../../range").Range,o=e("./fold_mode").FoldMode,r=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};n.inherits(r,o),function(){this.foldingStartMarker=/(\{|\[)[^\}\]]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{]*(\}|\])|^[\s\*]*(\*\/)/,this.getFoldWidgetRange=function(e,t,i,n){var s=e.getLine(i),o=s.match(this.foldingStartMarker);if(o){var r=o.index;if(o[1])return this.openingBracketBlock(e,o[1],i,r);var a=e.getCommentFoldRange(i,r+o[0].length,1);return a&&!a.isMultiLine()&&(n?a=this.getSectionRange(e,i):"all"!=t&&(a=null)),a}if("markbegin"!==t){var o=s.match(this.foldingStopMarker);if(o){var r=o.index+o[0].length;return o[1]?this.closingBracketBlock(e,o[1],i,r):e.getCommentFoldRange(i,r,-1)}}},this.getSectionRange=function(e,t){var i=e.getLine(t),n=i.search(/\S/),o=t,r=i.length;t+=1;for(var a=t,l=e.getLength();++t<l;){i=e.getLine(t);var c=i.search(/\S/);if(-1!==c){if(n>c)break;var u=this.getFoldWidgetRange(e,"all",t);if(u){if(u.start.row<=o)break;if(u.isMultiLine())t=u.end.row;else if(n==c)break}a=t}}return new s(o,r,a,e.getLine(a).length)}}.call(r.prototype)}),ace.define("ace/mode/javascript",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/javascript_highlight_rules","ace/mode/matching_brace_outdent","ace/range","ace/worker/worker_client","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle"],function(e,t,n){"use strict";var s=e("../lib/oop"),o=e("./text").Mode,r=e("./javascript_highlight_rules").JavaScriptHighlightRules,a=e("./matching_brace_outdent").MatchingBraceOutdent,l=(e("../range").Range,e("../worker/worker_client").WorkerClient),c=e("./behaviour/cstyle").CstyleBehaviour,u=e("./folding/cstyle").FoldMode,h=function(){this.HighlightRules=r,this.$outdent=new a,this.$behaviour=new c,this.foldingRules=new u};s.inherits(h,o),function(){this.lineCommentStart="//",this.blockComment={start:"/*",end:"*/"},this.getNextLineIndent=function(e,t,i){var n=this.$getIndent(t),s=this.getTokenizer().getLineTokens(t,e),o=s.tokens,r=s.state;if(o.length&&"comment"==o[o.length-1].type)return n;if("start"==e||"no_regex"==e){var a=t.match(/^.*(?:\bcase\b.*\:|[\{\(\[])\s*$/);a&&(n+=i)}else if("doc-start"==e){if("start"==r||"no_regex"==r)return"";var a=t.match(/^\s*(\/?)\*/);a&&(a[1]&&(n+=" "),n+="* ")}return n},this.checkOutdent=function(e,t,i){return this.$outdent.checkOutdent(t,i)},this.autoOutdent=function(e,t,i){this.$outdent.autoOutdent(t,i)},this.createWorker=function(e){var t=new l(["ace"],i(413),"JavaScriptWorker");return t.attachToDocument(e.getDocument()),t.on("jslint",function(t){e.setAnnotations(t.data)}),t.on("terminate",function(){e.clearAnnotations()}),t},this.$id="ace/mode/javascript"}.call(h.prototype),t.Mode=h}),ace.define("ace/mode/css_highlight_rules",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=(e("../lib/lang"),e("./text_highlight_rules").TextHighlightRules),o=t.supportType="animation-fill-mode|alignment-adjust|alignment-baseline|animation-delay|animation-direction|animation-duration|animation-iteration-count|animation-name|animation-play-state|animation-timing-function|animation|appearance|azimuth|backface-visibility|background-attachment|background-break|background-clip|background-color|background-image|background-origin|background-position|background-repeat|background-size|background|baseline-shift|binding|bleed|bookmark-label|bookmark-level|bookmark-state|bookmark-target|border-bottom|border-bottom-color|border-bottom-left-radius|border-bottom-right-radius|border-bottom-style|border-bottom-width|border-collapse|border-color|border-image|border-image-outset|border-image-repeat|border-image-slice|border-image-source|border-image-width|border-left|border-left-color|border-left-style|border-left-width|border-radius|border-right|border-right-color|border-right-style|border-right-width|border-spacing|border-style|border-top|border-top-color|border-top-left-radius|border-top-right-radius|border-top-style|border-top-width|border-width|border|bottom|box-align|box-decoration-break|box-direction|box-flex-group|box-flex|box-lines|box-ordinal-group|box-orient|box-pack|box-shadow|box-sizing|break-after|break-before|break-inside|caption-side|clear|clip|color-profile|color|column-count|column-fill|column-gap|column-rule|column-rule-color|column-rule-style|column-rule-width|column-span|column-width|columns|content|counter-increment|counter-reset|crop|cue-after|cue-before|cue|cursor|direction|display|dominant-baseline|drop-initial-after-adjust|drop-initial-after-align|drop-initial-before-adjust|drop-initial-before-align|drop-initial-size|drop-initial-value|elevation|empty-cells|fit|fit-position|float-offset|float|font-family|font-size|font-size-adjust|font-stretch|font-style|font-variant|font-weight|font|grid-columns|grid-rows|hanging-punctuation|height|hyphenate-after|hyphenate-before|hyphenate-character|hyphenate-lines|hyphenate-resource|hyphens|icon|image-orientation|image-rendering|image-resolution|inline-box-align|left|letter-spacing|line-height|line-stacking-ruby|line-stacking-shift|line-stacking-strategy|line-stacking|list-style-image|list-style-position|list-style-type|list-style|margin-bottom|margin-left|margin-right|margin-top|margin|mark-after|mark-before|mark|marks|marquee-direction|marquee-play-count|marquee-speed|marquee-style|max-height|max-width|min-height|min-width|move-to|nav-down|nav-index|nav-left|nav-right|nav-up|opacity|orphans|outline-color|outline-offset|outline-style|outline-width|outline|overflow-style|overflow-x|overflow-y|overflow|padding-bottom|padding-left|padding-right|padding-top|padding|page-break-after|page-break-before|page-break-inside|page-policy|page|pause-after|pause-before|pause|perspective-origin|perspective|phonemes|pitch-range|pitch|play-during|pointer-events|position|presentation-level|punctuation-trim|quotes|rendering-intent|resize|rest-after|rest-before|rest|richness|right|rotation-point|rotation|ruby-align|ruby-overhang|ruby-position|ruby-span|size|speak-header|speak-numeral|speak-punctuation|speak|speech-rate|stress|string-set|table-layout|target-name|target-new|target-position|target|text-align-last|text-align|text-decoration|text-emphasis|text-height|text-indent|text-justify|text-outline|text-shadow|text-transform|text-wrap|top|transform-origin|transform-style|transform|transition-delay|transition-duration|transition-property|transition-timing-function|transition|unicode-bidi|vertical-align|visibility|voice-balance|voice-duration|voice-family|voice-pitch-range|voice-pitch|voice-rate|voice-stress|voice-volume|volume|white-space-collapse|white-space|widows|width|word-break|word-spacing|word-wrap|z-index",r=t.supportFunction="rgb|rgba|url|attr|counter|counters",a=t.supportConstant="absolute|after-edge|after|all-scroll|all|alphabetic|always|antialiased|armenian|auto|avoid-column|avoid-page|avoid|balance|baseline|before-edge|before|below|bidi-override|block-line-height|block|bold|bolder|border-box|both|bottom|box|break-all|break-word|capitalize|caps-height|caption|center|central|char|circle|cjk-ideographic|clone|close-quote|col-resize|collapse|column|consider-shifts|contain|content-box|cover|crosshair|cubic-bezier|dashed|decimal-leading-zero|decimal|default|disabled|disc|disregard-shifts|distribute-all-lines|distribute-letter|distribute-space|distribute|dotted|double|e-resize|ease-in|ease-in-out|ease-out|ease|ellipsis|end|exclude-ruby|fill|fixed|georgian|glyphs|grid-height|groove|hand|hanging|hebrew|help|hidden|hiragana-iroha|hiragana|horizontal|icon|ideograph-alpha|ideograph-numeric|ideograph-parenthesis|ideograph-space|ideographic|inactive|include-ruby|inherit|initial|inline-block|inline-box|inline-line-height|inline-table|inline|inset|inside|inter-ideograph|inter-word|invert|italic|justify|katakana-iroha|katakana|keep-all|last|left|lighter|line-edge|line-through|line|linear|list-item|local|loose|lower-alpha|lower-greek|lower-latin|lower-roman|lowercase|lr-tb|ltr|mathematical|max-height|max-size|medium|menu|message-box|middle|move|n-resize|ne-resize|newspaper|no-change|no-close-quote|no-drop|no-open-quote|no-repeat|none|normal|not-allowed|nowrap|nw-resize|oblique|open-quote|outset|outside|overline|padding-box|page|pointer|pre-line|pre-wrap|pre|preserve-3d|progress|relative|repeat-x|repeat-y|repeat|replaced|reset-size|ridge|right|round|row-resize|rtl|s-resize|scroll|se-resize|separate|slice|small-caps|small-caption|solid|space|square|start|static|status-bar|step-end|step-start|steps|stretch|strict|sub|super|sw-resize|table-caption|table-cell|table-column-group|table-column|table-footer-group|table-header-group|table-row-group|table-row|table|tb-rl|text-after-edge|text-before-edge|text-bottom|text-size|text-top|text|thick|thin|transparent|underline|upper-alpha|upper-latin|upper-roman|uppercase|use-script|vertical-ideographic|vertical-text|visible|w-resize|wait|whitespace|z-index|zero",l=t.supportConstantColor="aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow",c=t.supportConstantFonts="arial|century|comic|courier|garamond|georgia|helvetica|impact|lucida|symbol|system|tahoma|times|trebuchet|utopia|verdana|webdings|sans-serif|serif|monospace",u=t.numRe="\\-?(?:(?:[0-9]+)|(?:[0-9]*\\.[0-9]+))",h=t.pseudoElements="(\\:+)\\b(after|before|first-letter|first-line|moz-selection|selection)\\b",d=t.pseudoClasses="(:)\\b(active|checked|disabled|empty|enabled|first-child|first-of-type|focus|hover|indeterminate|invalid|last-child|last-of-type|link|not|nth-child|nth-last-child|nth-last-of-type|nth-of-type|only-child|only-of-type|acequired|root|target|valid|visited)\\b",p=function(){var e=this.createKeywordMapper({"support.function":r,"support.constant":a,"support.type":o,"support.constant.color":l,"support.constant.fonts":c},"text",!0);this.$rules={start:[{token:"comment",regex:"\\/\\*",push:"comment"},{token:"paren.lparen",regex:"\\{",push:"ruleset"},{token:"string",regex:"@.*?{",push:"media"},{token:"keyword",regex:"#[a-z0-9-_]+"},{token:"variable",regex:"\\.[a-z0-9-_]+"},{token:"string",regex:":[a-z0-9-_]+"},{token:"constant",regex:"[a-z0-9-_]+"},{caseInsensitive:!0}],media:[{token:"comment",regex:"\\/\\*",push:"comment"},{token:"paren.lparen",regex:"\\{",push:"ruleset"},{token:"string",regex:"\\}",
next:"pop"},{token:"keyword",regex:"#[a-z0-9-_]+"},{token:"variable",regex:"\\.[a-z0-9-_]+"},{token:"string",regex:":[a-z0-9-_]+"},{token:"constant",regex:"[a-z0-9-_]+"},{caseInsensitive:!0}],comment:[{token:"comment",regex:"\\*\\/",next:"pop"},{defaultToken:"comment"}],ruleset:[{token:"paren.rparen",regex:"\\}",next:"pop"},{token:"comment",regex:"\\/\\*",push:"comment"},{token:"string",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]'},{token:"string",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:["constant.numeric","keyword"],regex:"("+u+")(ch|cm|deg|em|ex|fr|gd|grad|Hz|in|kHz|mm|ms|pc|pt|px|rad|rem|s|turn|vh|vm|vw|%)"},{token:"constant.numeric",regex:u},{token:"constant.numeric",regex:"#[a-f0-9]{6}"},{token:"constant.numeric",regex:"#[a-f0-9]{3}"},{token:["punctuation","entity.other.attribute-name.pseudo-element.css"],regex:h},{token:["punctuation","entity.other.attribute-name.pseudo-class.css"],regex:d},{token:["support.function","string","support.function"],regex:"(url\\()(.*)(\\))"},{token:e,regex:"\\-?[a-zA-Z_][a-zA-Z0-9_\\-]*"},{caseInsensitive:!0}]},this.normalizeRules()};n.inherits(p,s),t.CssHighlightRules=p}),ace.define("ace/mode/behaviour/css",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/mode/behaviour/cstyle","ace/token_iterator"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=(e("../behaviour").Behaviour,e("./cstyle").CstyleBehaviour),o=e("../../token_iterator").TokenIterator,r=function(){this.inherit(s),this.add("colon","insertion",function(e,t,i,n,s){if(":"===s){var r=i.getCursorPosition(),a=new o(n,r.row,r.column),l=a.getCurrentToken();if(l&&l.value.match(/\s+/)&&(l=a.stepBackward()),l&&"support.type"===l.type){var c=n.doc.getLine(r.row),u=c.substring(r.column,r.column+1);if(":"===u)return{text:"",selection:[1,1]};if(!c.substring(r.column).match(/^\s*;/))return{text:":;",selection:[1,1]}}}}),this.add("colon","deletion",function(e,t,i,n,s){var r=n.doc.getTextRange(s);if(!s.isMultiLine()&&":"===r){var a=i.getCursorPosition(),l=new o(n,a.row,a.column),c=l.getCurrentToken();if(c&&c.value.match(/\s+/)&&(c=l.stepBackward()),c&&"support.type"===c.type){var u=n.doc.getLine(s.start.row),h=u.substring(s.end.column,s.end.column+1);if(";"===h)return s.end.column++,s}}}),this.add("semicolon","insertion",function(e,t,i,n,s){if(";"===s){var o=i.getCursorPosition(),r=n.doc.getLine(o.row),a=r.substring(o.column,o.column+1);if(";"===a)return{text:"",selection:[1,1]}}})};n.inherits(r,s),t.CssBehaviour=r}),ace.define("ace/mode/css",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/css_highlight_rules","ace/mode/matching_brace_outdent","ace/worker/worker_client","ace/mode/behaviour/css","ace/mode/folding/cstyle"],function(e,t,n){"use strict";var s=e("../lib/oop"),o=e("./text").Mode,r=e("./css_highlight_rules").CssHighlightRules,a=e("./matching_brace_outdent").MatchingBraceOutdent,l=e("../worker/worker_client").WorkerClient,c=e("./behaviour/css").CssBehaviour,u=e("./folding/cstyle").FoldMode,h=function(){this.HighlightRules=r,this.$outdent=new a,this.$behaviour=new c,this.foldingRules=new u};s.inherits(h,o),function(){this.foldingRules="cStyle",this.blockComment={start:"/*",end:"*/"},this.getNextLineIndent=function(e,t,i){var n=this.$getIndent(t),s=this.getTokenizer().getLineTokens(t,e).tokens;if(s.length&&"comment"==s[s.length-1].type)return n;var o=t.match(/^.*\{\s*$/);return o&&(n+=i),n},this.checkOutdent=function(e,t,i){return this.$outdent.checkOutdent(t,i)},this.autoOutdent=function(e,t,i){this.$outdent.autoOutdent(t,i)},this.createWorker=function(e){var t=new l(["ace"],i(414),"Worker");return t.attachToDocument(e.getDocument()),t.on("csslint",function(t){e.setAnnotations(t.data)}),t.on("terminate",function(){e.clearAnnotations()}),t},this.$id="ace/mode/css"}.call(h.prototype),t.Mode=h}),ace.define("ace/mode/xml_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("./text_highlight_rules").TextHighlightRules,o=function(e){this.$rules={start:[{token:"string.cdata.xml",regex:"<\\!\\[CDATA\\[",next:"cdata"},{token:["punctuation.xml-decl.xml","keyword.xml-decl.xml"],regex:"(<\\?)(xml)(?=[\\s])",next:"xml_decl",caseInsensitive:!0},{token:["punctuation.instruction.xml","keyword.instruction.xml"],regex:"(<\\?)([-_a-zA-Z0-9]+)",next:"processing_instruction"},{token:"comment.xml",regex:"<\\!--",next:"comment"},{token:["xml-pe.doctype.xml","xml-pe.doctype.xml"],regex:"(<\\!)(DOCTYPE)(?=[\\s])",next:"doctype",caseInsensitive:!0},{include:"tag"},{token:"text.end-tag-open.xml",regex:"</"},{token:"text.tag-open.xml",regex:"<"},{include:"reference"},{defaultToken:"text.xml"}],xml_decl:[{token:"entity.other.attribute-name.decl-attribute-name.xml",regex:"(?:[-_a-zA-Z0-9]+:)?[-_a-zA-Z0-9]+"},{token:"keyword.operator.decl-attribute-equals.xml",regex:"="},{include:"whitespace"},{include:"string"},{token:"punctuation.xml-decl.xml",regex:"\\?>",next:"start"}],processing_instruction:[{token:"punctuation.instruction.xml",regex:"\\?>",next:"start"},{defaultToken:"instruction.xml"}],doctype:[{include:"whitespace"},{include:"string"},{token:"xml-pe.doctype.xml",regex:">",next:"start"},{token:"xml-pe.xml",regex:"[-_a-zA-Z0-9:]+"},{token:"punctuation.int-subset",regex:"\\[",push:"int_subset"}],int_subset:[{token:"text.xml",regex:"\\s+"},{token:"punctuation.int-subset.xml",regex:"]",next:"pop"},{token:["punctuation.markup-decl.xml","keyword.markup-decl.xml"],regex:"(<\\!)([-_a-zA-Z0-9]+)",push:[{token:"text",regex:"\\s+"},{token:"punctuation.markup-decl.xml",regex:">",next:"pop"},{include:"string"}]}],cdata:[{token:"string.cdata.xml",regex:"\\]\\]>",next:"start"},{token:"text.xml",regex:"\\s+"},{token:"text.xml",regex:"(?:[^\\]]|\\](?!\\]>))+"}],comment:[{token:"comment.xml",regex:"-->",next:"start"},{defaultToken:"comment.xml"}],reference:[{token:"constant.language.escape.reference.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}],attr_reference:[{token:"constant.language.escape.reference.attribute-value.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}],tag:[{token:["meta.tag.punctuation.tag-open.xml","meta.tag.punctuation.end-tag-open.xml","meta.tag.tag-name.xml"],regex:"(?:(<)|(</))((?:[-_a-zA-Z0-9]+:)?[-_a-zA-Z0-9]+)",next:[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:"start"}]}],tag_whitespace:[{token:"text.tag-whitespace.xml",regex:"\\s+"}],whitespace:[{token:"text.whitespace.xml",regex:"\\s+"}],string:[{token:"string.xml",regex:"'",push:[{token:"string.xml",regex:"'",next:"pop"},{defaultToken:"string.xml"}]},{token:"string.xml",regex:'"',push:[{token:"string.xml",regex:'"',next:"pop"},{defaultToken:"string.xml"}]}],attributes:[{token:"entity.other.attribute-name.xml",regex:"(?:[-_a-zA-Z0-9]+:)?[-_a-zA-Z0-9]+"},{token:"keyword.operator.attribute-equals.xml",regex:"="},{include:"tag_whitespace"},{include:"attribute_value"}],attribute_value:[{token:"string.attribute-value.xml",regex:"'",push:[{token:"string.attribute-value.xml",regex:"'",next:"pop"},{include:"attr_reference"},{defaultToken:"string.attribute-value.xml"}]},{token:"string.attribute-value.xml",regex:'"',push:[{token:"string.attribute-value.xml",regex:'"',next:"pop"},{include:"attr_reference"},{defaultToken:"string.attribute-value.xml"}]}]},this.constructor===o&&this.normalizeRules()};(function(){this.embedTagRules=function(e,t,i){this.$rules.tag.unshift({token:["meta.tag.punctuation.tag-open.xml","meta.tag."+i+".tag-name.xml"],regex:"(<)("+i+"(?=\\s|>|$))",next:[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:t+"start"}]}),this.$rules[i+"-end"]=[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:"start",onMatch:function(e,t,i){return i.splice(0),this.token}}],this.embedRules(e,t,[{token:["meta.tag.punctuation.end-tag-open.xml","meta.tag."+i+".tag-name.xml"],regex:"(</)("+i+"(?=\\s|>|$))",next:i+"-end"},{token:"string.cdata.xml",regex:"<\\!\\[CDATA\\["},{token:"string.cdata.xml",regex:"\\]\\]>"}])}}).call(s.prototype),n.inherits(o,s),t.XmlHighlightRules=o}),ace.define("ace/mode/html_highlight_rules",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/css_highlight_rules","ace/mode/javascript_highlight_rules","ace/mode/xml_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("../lib/lang"),o=e("./css_highlight_rules").CssHighlightRules,r=e("./javascript_highlight_rules").JavaScriptHighlightRules,a=e("./xml_highlight_rules").XmlHighlightRules,l=s.createMap({a:"anchor",button:"form",form:"form",img:"image",input:"form",label:"form",option:"form",script:"script",select:"form",textarea:"form",style:"style",table:"table",tbody:"table",td:"table",tfoot:"table",th:"table",tr:"table"}),c=function(){a.call(this),this.addRules({attributes:[{include:"tag_whitespace"},{token:"entity.other.attribute-name.xml",regex:"[-_a-zA-Z0-9:]+"},{token:"keyword.operator.attribute-equals.xml",regex:"=",push:[{include:"tag_whitespace"},{token:"string.unquoted.attribute-value.html",regex:"[^<>='\"`\\s]+",next:"pop"},{token:"empty",regex:"",next:"pop"}]},{include:"attribute_value"}],tag:[{token:function(e,t){var i=l[t];return["meta.tag.punctuation."+("<"==e?"":"end-")+"tag-open.xml","meta.tag"+(i?"."+i:"")+".tag-name.xml"]},regex:"(</?)([-_a-zA-Z0-9:]+)",next:"tag_stuff"}],tag_stuff:[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:"start"}]}),this.embedTagRules(o,"css-","style"),this.embedTagRules(r,"js-","script"),this.constructor===c&&this.normalizeRules()};n.inherits(c,a),t.HtmlHighlightRules=c}),ace.define("ace/mode/behaviour/xml",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator"],function(e,t,i){"use strict";function n(e,t){return e.type.lastIndexOf(t+".xml")>-1}var s=e("../../lib/oop"),o=e("../behaviour").Behaviour,r=e("../../token_iterator").TokenIterator,a=function(){this.add("string_dquotes","insertion",function(e,t,i,s,o){if('"'==o||"'"==o){var a=o,l=s.doc.getTextRange(i.getSelectionRange());if(""!==l&&"'"!==l&&'"'!=l&&i.getWrapBehavioursEnabled())return{text:a+l+a,selection:!1};var c=i.getCursorPosition(),u=s.doc.getLine(c.row),h=u.substring(c.column,c.column+1),d=new r(s,c.row,c.column),p=d.getCurrentToken();if(h==a&&(n(p,"attribute-value")||n(p,"string")))return{text:"",selection:[1,1]};if(p||(p=d.stepBackward()),!p)return;for(;n(p,"tag-whitespace")||n(p,"whitespace");)p=d.stepBackward();var g=!h||h.match(/\s/);if(n(p,"attribute-equals")&&(g||">"==h)||n(p,"decl-attribute-equals")&&(g||"?"==h))return{text:a+a,selection:[1,1]}}}),this.add("string_dquotes","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&('"'==o||"'"==o)){var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(a==o)return s.end.column++,s}}),this.add("autoclosing","insertion",function(e,t,i,s,o){if(">"==o){var a=i.getCursorPosition(),l=new r(s,a.row,a.column),c=l.getCurrentToken()||l.stepBackward();if(!c||!(n(c,"tag-name")||n(c,"tag-whitespace")||n(c,"attribute-name")||n(c,"attribute-equals")||n(c,"attribute-value")))return;if(n(c,"reference.attribute-value"))return;if(n(c,"attribute-value")){var u=c.value.charAt(0);if('"'==u||"'"==u){var h=c.value.charAt(c.value.length-1),d=l.getCurrentTokenColumn()+c.value.length;if(d>a.column||d==a.column&&u!=h)return}}for(;!n(c,"tag-name");)c=l.stepBackward();var p=l.getCurrentTokenRow(),g=l.getCurrentTokenColumn();if(n(l.stepBackward(),"end-tag-open"))return;var m=c.value;if(p==a.row&&(m=m.substring(0,a.column-g)),this.voidElements.hasOwnProperty(m.toLowerCase()))return;return{text:"></"+m+">",selection:[1,1]}}}),this.add("autoindent","insertion",function(e,t,i,n,s){if("\n"==s){var o=i.getCursorPosition(),r=n.getLine(o.row),a=r.substring(o.column,o.column+2);if("</"==a){var l=this.$getIndent(r),c=l+n.getTabString();return{text:"\n"+c+"\n"+l,selection:[1,c.length,1,c.length]}}}})};s.inherits(a,o),t.XmlBehaviour=a}),ace.define("ace/mode/folding/mixed",["require","exports","module","ace/lib/oop","ace/mode/folding/fold_mode"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=e("./fold_mode").FoldMode,o=t.FoldMode=function(e,t){this.defaultMode=e,this.subModes=t};n.inherits(o,s),function(){this.$getMode=function(e){"string"!=typeof e&&(e=e[0]);for(var t in this.subModes)if(0===e.indexOf(t))return this.subModes[t];return null},this.$tryMode=function(e,t,i,n){var s=this.$getMode(e);return s?s.getFoldWidget(t,i,n):""},this.getFoldWidget=function(e,t,i){return this.$tryMode(e.getState(i-1),e,t,i)||this.$tryMode(e.getState(i),e,t,i)||this.defaultMode.getFoldWidget(e,t,i)},this.getFoldWidgetRange=function(e,t,i){var n=this.$getMode(e.getState(i-1));return n&&n.getFoldWidget(e,t,i)||(n=this.$getMode(e.getState(i))),n&&n.getFoldWidget(e,t,i)||(n=this.defaultMode),n.getFoldWidgetRange(e,t,i)}}.call(o.prototype)}),ace.define("ace/mode/folding/xml",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/range","ace/mode/folding/fold_mode","ace/token_iterator"],function(e,t,i){"use strict";function n(e,t){return e.type.lastIndexOf(t+".xml")>-1}var s=e("../../lib/oop"),o=(e("../../lib/lang"),e("../../range").Range),r=e("./fold_mode").FoldMode,a=e("../../token_iterator").TokenIterator,l=t.FoldMode=function(e,t){r.call(this),this.voidElements=s.mixin(e||{},t||{})};s.inherits(l,r);var c=function(){this.tagName="",this.closing=!1,this.selfClosing=!1,this.start={row:0,column:0},this.end={row:0,column:0}};(function(){this.getFoldWidget=function(e,t,i){var n=this._getFirstTagInLine(e,i);return n?n.closing||!n.tagName&&n.selfClosing?"markbeginend"==t?"end":"":!n.tagName||n.selfClosing||this.voidElements.hasOwnProperty(n.tagName.toLowerCase())?"":this._findEndTagInLine(e,i,n.tagName,n.end.column)?"":"start":""},this._getFirstTagInLine=function(e,t){for(var i=e.getTokens(t),s=new c,o=0;o<i.length;o++){var r=i[o];if(n(r,"tag-open")){if(s.end.column=s.start.column+r.value.length,s.closing=n(r,"end-tag-open"),r=i[++o],!r)return null;for(s.tagName=r.value,s.end.column+=r.value.length,o++;o<i.length;o++)if(r=i[o],s.end.column+=r.value.length,n(r,"tag-close")){s.selfClosing="/>"==r.value;break}return s}if(n(r,"tag-close"))return s.selfClosing="/>"==r.value,s;s.start.column+=r.value.length}return null},this._findEndTagInLine=function(e,t,i,s){for(var o=e.getTokens(t),r=0,a=0;a<o.length;a++){var l=o[a];if(r+=l.value.length,!(s>r)&&n(l,"end-tag-open")&&(l=o[a+1],l&&l.value==i))return!0}return!1},this._readTagForward=function(e){var t=e.getCurrentToken();if(!t)return null;var i=new c;do if(n(t,"tag-open"))i.closing=n(t,"end-tag-open"),i.start.row=e.getCurrentTokenRow(),i.start.column=e.getCurrentTokenColumn();else if(n(t,"tag-name"))i.tagName=t.value;else if(n(t,"tag-close"))return i.selfClosing="/>"==t.value,i.end.row=e.getCurrentTokenRow(),i.end.column=e.getCurrentTokenColumn()+t.value.length,e.stepForward(),i;while(t=e.stepForward());return null},this._readTagBackward=function(e){var t=e.getCurrentToken();if(!t)return null;var i=new c;do{if(n(t,"tag-open"))return i.closing=n(t,"end-tag-open"),i.start.row=e.getCurrentTokenRow(),i.start.column=e.getCurrentTokenColumn(),e.stepBackward(),i;n(t,"tag-name")?i.tagName=t.value:n(t,"tag-close")&&(i.selfClosing="/>"==t.value,i.end.row=e.getCurrentTokenRow(),i.end.column=e.getCurrentTokenColumn()+t.value.length)}while(t=e.stepBackward());return null},this._pop=function(e,t){for(;e.length;){var i=e[e.length-1];if(t&&i.tagName!=t.tagName){if(this.voidElements.hasOwnProperty(t.tagName))return;if(this.voidElements.hasOwnProperty(i.tagName)){e.pop();continue}return null}return e.pop()}},this.getFoldWidgetRange=function(e,t,i){var n=this._getFirstTagInLine(e,i);if(!n)return null;var s,r=n.closing||n.selfClosing,l=[];if(r)for(var c=new a(e,i,n.end.column),u={row:i,column:n.start.column};s=this._readTagBackward(c);){if(s.selfClosing){if(l.length)continue;return s.start.column+=s.tagName.length+2,s.end.column-=2,o.fromPoints(s.start,s.end)}if(s.closing)l.push(s);else if(this._pop(l,s),0==l.length)return s.start.column+=s.tagName.length+2,o.fromPoints(s.start,u)}else for(var c=new a(e,i,n.start.column),h={row:i,column:n.start.column+n.tagName.length+2};s=this._readTagForward(c);){if(s.selfClosing){if(l.length)continue;return s.start.column+=s.tagName.length+2,s.end.column-=2,o.fromPoints(s.start,s.end)}if(s.closing){if(this._pop(l,s),0==l.length)return o.fromPoints(h,s.start)}else l.push(s)}}}).call(l.prototype)}),ace.define("ace/mode/folding/html",["require","exports","module","ace/lib/oop","ace/mode/folding/mixed","ace/mode/folding/xml","ace/mode/folding/cstyle"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=e("./mixed").FoldMode,o=e("./xml").FoldMode,r=e("./cstyle").FoldMode,a=t.FoldMode=function(e,t){s.call(this,new o(e,t),{"js-":new r,"css-":new r})};n.inherits(a,s)}),ace.define("ace/mode/html_completions",["require","exports","module","ace/token_iterator"],function(e,t,i){"use strict";function n(e,t){return e.type.lastIndexOf(t+".xml")>-1}function s(e,t){for(var i=new o(e,t.row,t.column),s=i.getCurrentToken();s&&!n(s,"tag-name");)s=i.stepBackward();return s?s.value:void 0}var o=e("../token_iterator").TokenIterator,r=["accesskey","class","contenteditable","contextmenu","dir","draggable","dropzone","hidden","id","inert","itemid","itemprop","itemref","itemscope","itemtype","lang","spellcheck","style","tabindex","title","translate"],a=["onabort","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextmenu","oncuechange","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onpause","onplay","onplaying","onprogress","onratechange","onreset","onscroll","onseeked","onseeking","onselect","onshow","onstalled","onsubmit","onsuspend","ontimeupdate","onvolumechange","onwaiting"],l=r.concat(a),c={html:["manifest"],head:[],title:[],base:["href","target"],link:["href","hreflang","rel","media","type","sizes"],meta:["http-equiv","name","content","charset"],style:["type","media","scoped"],script:["charset","type","src","defer","async"],noscript:["href"],body:["onafterprint","onbeforeprint","onbeforeunload","onhashchange","onmessage","onoffline","onpopstate","onredo","onresize","onstorage","onundo","onunload"],section:[],nav:[],article:["pubdate"],aside:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],footer:[],address:[],main:[],p:[],hr:[],pre:[],blockquote:["cite"],ol:["start","reversed"],ul:[],li:["value"],dl:[],dt:[],dd:[],figure:[],figcaption:[],div:[],a:["href","target","ping","rel","media","hreflang","type"],em:[],strong:[],small:[],s:[],cite:[],q:["cite"],dfn:[],abbr:[],data:[],time:["datetime"],code:[],"var":[],samp:[],kbd:[],sub:[],sup:[],i:[],b:[],u:[],mark:[],ruby:[],rt:[],rp:[],bdi:[],bdo:[],span:[],br:[],wbr:[],ins:["cite","datetime"],del:["cite","datetime"],img:["alt","src","height","width","usemap","ismap"],iframe:["name","src","height","width","sandbox","seamless"],embed:["src","height","width","type"],object:["param","data","type","height","width","usemap","name","form","classid"],param:["name","value"],video:["src","autobuffer","autoplay","loop","controls","width","height","poster"],audio:["src","autobuffer","autoplay","loop","controls"],source:["src","type","media"],track:["kind","src","srclang","label","default"],canvas:["width","height"],map:["name"],area:["shape","coords","href","hreflang","alt","target","media","rel","ping","type"],svg:[],math:[],table:["summary"],caption:[],colgroup:["span"],col:["span"],tbody:[],thead:[],tfoot:[],tr:[],td:["headers","rowspan","colspan"],th:["headers","rowspan","colspan","scope"],form:["accept-charset","action","autocomplete","enctype","method","name","novalidate","target"],fieldset:["disabled","form","name"],legend:[],label:["form","for"],input:["type","accept","alt","autocomplete","checked","disabled","form","formaction","formenctype","formmethod","formnovalidate","formtarget","height","list","max","maxlength","min","multiple","pattern","placeholder","readonly","acequired","size","src","step","width","files","value"],button:["autofocus","disabled","form","formaction","formenctype","formmethod","formnovalidate","formtarget","name","value","type"],select:["autofocus","disabled","form","multiple","name","size"],datalist:[],optgroup:["disabled","label"],option:["disabled","selected","label","value"],textarea:["autofocus","disabled","form","maxlength","name","placeholder","readonly","acequired","rows","cols","wrap"],keygen:["autofocus","challenge","disabled","form","keytype","name"],output:["for","form","name"],progress:["value","max"],meter:["value","min","max","low","high","optimum"],details:["open"],summary:[],command:["type","label","icon","disabled","checked","radiogroup","command"],menu:["type","label"],dialog:["open"]},u=Object.keys(c),h=function(){};(function(){this.getCompletions=function(e,t,i,s){var o=t.getTokenAt(i.row,i.column);return o?n(o,"tag-name")||n(o,"tag-open")||n(o,"end-tag-open")?this.getTagCompletions(e,t,i,s):n(o,"tag-whitespace")||n(o,"attribute-name")?this.getAttributeCompetions(e,t,i,s):[]:[]},this.getTagCompletions=function(e,t,i,n){return u.map(function(e){return{value:e,meta:"tag",score:Number.MAX_VALUE}})},this.getAttributeCompetions=function(e,t,i,n){var o=s(t,i);if(!o)return[];var r=l;return o in c&&(r=r.concat(c[o])),r.map(function(e){return{caption:e,snippet:e+'="$0"',meta:"attribute",score:Number.MAX_VALUE}})}}).call(h.prototype),t.HtmlCompletions=h}),ace.define("ace/mode/html",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/text","ace/mode/javascript","ace/mode/css","ace/mode/html_highlight_rules","ace/mode/behaviour/xml","ace/mode/folding/html","ace/mode/html_completions","ace/worker/worker_client"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("../lib/lang"),o=e("./text").Mode,r=e("./javascript").Mode,a=e("./css").Mode,l=e("./html_highlight_rules").HtmlHighlightRules,c=e("./behaviour/xml").XmlBehaviour,u=e("./folding/html").FoldMode,h=e("./html_completions").HtmlCompletions,d=e("../worker/worker_client").WorkerClient,p=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],g=["li","dt","dd","p","rt","rp","optgroup","option","colgroup","td","th"],m=function(e){this.fragmentContext=e&&e.fragmentContext,this.HighlightRules=l,this.$behaviour=new c,this.$completer=new h,this.createModeDelegates({"js-":r,"css-":a}),this.foldingRules=new u(this.voidElements,s.arrayToMap(g))};n.inherits(m,o),function(){this.blockComment={start:"<!--",end:"-->"},this.voidElements=s.arrayToMap(p),this.getNextLineIndent=function(e,t,i){return this.$getIndent(t)},this.checkOutdent=function(e,t,i){return!1},this.getCompletions=function(e,t,i,n){return this.$completer.getCompletions(e,t,i,n)},this.createWorker=function(e){if(this.constructor==m){var t=new d(["ace"],"ace/mode/html_worker","Worker");return t.attachToDocument(e.getDocument()),this.fragmentContext&&t.call("setOptions",[{context:this.fragmentContext}]),t.on("error",function(t){e.setAnnotations(t.data)}),t.on("terminate",function(){e.clearAnnotations()}),t}},this.$id="ace/mode/html"}.call(m.prototype),t.Mode=m})},function(e,t){e.exports.id="ace/mode/javascript_worker",e.exports.src='"no use strict";(function(window){if(void 0===window.window||!window.document){window.console=function(){var msgs=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:msgs})},window.console.error=window.console.warn=window.console.log=window.console.trace=window.console,window.window=window,window.ace=window,window.onerror=function(message,file,line,col,err){console.error("Worker "+(err?err.stack:message))},window.normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return window.normalizeModule(parentId,chunks[0])+"!"+window.normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0)){var base=parentId.split("/").slice(0,-1).join("/");for(moduleName=(base?base+"/":"")+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/^\\.\\//,"").replace(/\\/\\.\\//,"/").replace(/[^\\/]+\\/\\.\\.\\//,"")}}return moduleName},window.acequire=function(parentId,id){if(id||(id=parentId,parentId=null),!id.charAt)throw Error("worker.js acequire() accepts only (parentId, id) as arguments");id=window.normalizeModule(parentId,id);var module=window.acequire.modules[id];if(module)return module.initialized||(module.initialized=!0,module.exports=module.factory().exports),module.exports;var chunks=id.split("/");if(!window.acequire.tlns)return console.log("unable to load "+id);chunks[0]=window.acequire.tlns[chunks[0]]||chunks[0];var path=chunks.join("/")+".js";return window.acequire.id=id,importScripts(path),window.acequire(parentId,id)},window.acequire.modules={},window.acequire.tlns={},window.define=function(id,deps,factory){if(2==arguments.length?(factory=deps,"string"!=typeof id&&(deps=id,id=window.acequire.id)):1==arguments.length&&(factory=id,deps=[],id=window.acequire.id),deps.length||(deps=["require","exports","module"]),0!==id.indexOf("text!")){var req=function(childId){return window.acequire(id,childId)};window.acequire.modules[id]={exports:{},factory:function(){var module=this,returnExports=factory.apply(this,deps.map(function(dep){switch(dep){case"require":return req;case"exports":return module.exports;case"module":return module;default:return req(dep)}}));return returnExports&&(module.exports=returnExports),module}}}},window.define.amd={},window.initBaseUrls=function initBaseUrls(topLevelNamespaces){acequire.tlns=topLevelNamespaces},window.initSender=function initSender(){var EventEmitter=window.acequire("ace/lib/event_emitter").EventEmitter,oop=window.acequire("ace/lib/oop"),Sender=function(){};return function(){oop.implement(this,EventEmitter),this.callback=function(data,callbackId){postMessage({type:"call",id:callbackId,data:data})},this.emit=function(name,data){postMessage({type:"event",name:name,data:data})}}.call(Sender.prototype),new Sender};var main=window.main=null,sender=window.sender=null;window.onmessage=function(e){var msg=e.data;if(msg.command){if(!main[msg.command])throw Error("Unknown command:"+msg.command);main[msg.command].apply(main,msg.args)}else if(msg.init){initBaseUrls(msg.tlns),acequire("ace/lib/es5-shim"),sender=window.sender=initSender();var clazz=acequire(msg.module)[msg.classname];main=window.main=new clazz(sender)}else msg.event&&sender&&sender._signal(msg.event,msg.data)}}})(this),ace.define("ace/lib/oop",["require","exports","module"],function(acequire,exports){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(acequire,exports){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;listeners.length>i&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;listeners.length>i;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback)handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop());else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter}),ace.define("ace/range",["require","exports","module"],function(acequire,exports){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return cmp=this.compare(end.row,end.column),1==cmp?(cmp=this.compare(start.row,start.column),1==cmp?2:0==cmp?1:0):-1==cmp?-2:(cmp=this.compare(start.row,start.column),-1==cmp?-1:1==cmp?42:0)},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)||this.isStart(row,column)?!1:!0:!1},this.insideStart=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)?!1:!0:!1},this.insideEnd=function(row,column){return 0==this.compare(row,column)?this.isStart(row,column)?!1:!0:!1},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?this.start.row>row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?this.end.column>=column?0:1:0:this.start.column>column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(firstRow>this.end.row)var end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(firstRow>this.start.row)var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=comparePoints,Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),column===void 0?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(e){var delta=e.data,range=delta.range;if(!(range.start.row==range.end.row&&range.start.row!=this.row||range.start.row>this.row||range.start.row==this.row&&range.start.column>this.column)){var row=this.row,column=this.column,start=range.start,end=range.end;"insertText"===delta.action?start.row===row&&column>=start.column?start.column===column&&this.$insertRight||(start.row===end.row?column+=end.column-start.column:(column-=start.column,row+=end.row-start.row)):start.row!==end.row&&row>start.row&&(row+=end.row-start.row):"insertLines"===delta.action?start.row===row&&0===column&&this.$insertRight||row>=start.row&&(row+=end.row-start.row):"removeText"===delta.action?start.row===row&&column>start.column?column=end.column>=column?start.column:Math.max(0,column-(end.column-start.column)):start.row!==end.row&&row>start.row?(end.row===row&&(column=Math.max(0,column-end.column)+start.column),row-=end.row-start.row):end.row===row&&(row-=end.row-start.row,column=Math.max(0,column-end.column)+start.column):"removeLines"==delta.action&&row>=start.row&&(row>=end.row?row-=end.row-start.row:(row=start.row,column=0)),this.setPosition(row,column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):0>row?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),0>column&&(pos.column=0),pos}}).call(Anchor.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/lib/event_emitter","ace/range","ace/anchor"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(text){this.$lines=[],0===text.length?this.$lines=[""]:Array.isArray(text)?this._insertLines(0,text):this.insert({row:0,column:0},text)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength();this.remove(new Range(0,0,len,this.getLine(len-1).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},this.$split=0==="aaa".split(/a/).length?function(text){return text.replace(/\\r\\n|\\r/g,"\\n").split("\\n")}:function(text){return text.split(/\\r\\n|\\r|\\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\\r\\n|\\r|\\n)/m);this.$autoNewLine=match?match[1]:"\\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\\r\\n";case"unix":return"\\n";default:return this.$autoNewLine||"\\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\\r\\n"==text||"\\r"==text||"\\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){if(range.start.row==range.end.row)return this.getLine(range.start.row).substring(range.start.column,range.end.column);var lines=this.getLines(range.start.row,range.end.row);lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;return range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column)),lines.join(this.getNewLineCharacter())},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):0>position.row&&(position.row=0),position},this.insert=function(position,text){if(!text||0===text.length)return position;position=this.$clipPosition(position),1>=this.getLength()&&this.$detectNewLine(text);var lines=this.$split(text),firstLine=lines.splice(0,1)[0],lastLine=0==lines.length?null:lines.splice(lines.length-1,1)[0];return position=this.insertInLine(position,firstLine),null!==lastLine&&(position=this.insertNewLine(position),position=this._insertLines(position.row,lines),position=this.insertInLine(position,lastLine||"")),position},this.insertLines=function(row,lines){return row>=this.getLength()?this.insert({row:row,column:0},"\\n"+lines.join("\\n")):this._insertLines(Math.max(row,0),lines)},this._insertLines=function(row,lines){if(0==lines.length)return{row:row,column:0};for(;lines.length>61440;){var end=this._insertLines(row,lines.slice(0,61440));lines=lines.slice(61440),row=end.row}var args=[row,0];args.push.apply(args,lines),this.$lines.splice.apply(this.$lines,args);var range=new Range(row,0,row+lines.length,0),delta={action:"insertLines",range:range,lines:lines};return this._signal("change",{data:delta}),range.end},this.insertNewLine=function(position){position=this.$clipPosition(position);var line=this.$lines[position.row]||"";this.$lines[position.row]=line.substring(0,position.column),this.$lines.splice(position.row+1,0,line.substring(position.column,line.length));var end={row:position.row+1,column:0},delta={action:"insertText",range:Range.fromPoints(position,end),text:this.getNewLineCharacter()};return this._signal("change",{data:delta}),end},this.insertInLine=function(position,text){if(0==text.length)return position;var line=this.$lines[position.row]||"";this.$lines[position.row]=line.substring(0,position.column)+text+line.substring(position.column);var end={row:position.row,column:position.column+text.length},delta={action:"insertText",range:Range.fromPoints(position,end),text:text};return this._signal("change",{data:delta}),end},this.remove=function(range){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),range.start=this.$clipPosition(range.start),range.end=this.$clipPosition(range.end),range.isEmpty())return range.start;var firstRow=range.start.row,lastRow=range.end.row;if(range.isMultiLine()){var firstFullRow=0==range.start.column?firstRow:firstRow+1,lastFullRow=lastRow-1;range.end.column>0&&this.removeInLine(lastRow,0,range.end.column),lastFullRow>=firstFullRow&&this._removeLines(firstFullRow,lastFullRow),firstFullRow!=firstRow&&(this.removeInLine(firstRow,range.start.column,this.getLine(firstRow).length),this.removeNewLine(range.start.row))}else this.removeInLine(firstRow,range.start.column,range.end.column);return range.start},this.removeInLine=function(row,startColumn,endColumn){if(startColumn!=endColumn){var range=new Range(row,startColumn,row,endColumn),line=this.getLine(row),removed=line.substring(startColumn,endColumn),newLine=line.substring(0,startColumn)+line.substring(endColumn,line.length);this.$lines.splice(row,1,newLine);var delta={action:"removeText",range:range,text:removed};return this._signal("change",{data:delta}),range.start}},this.removeLines=function(firstRow,lastRow){return 0>firstRow||lastRow>=this.getLength()?this.remove(new Range(firstRow,0,lastRow+1,0)):this._removeLines(firstRow,lastRow)},this._removeLines=function(firstRow,lastRow){var range=new Range(firstRow,0,lastRow+1,0),removed=this.$lines.splice(firstRow,lastRow-firstRow+1),delta={action:"removeLines",range:range,nl:this.getNewLineCharacter(),lines:removed};return this._signal("change",{data:delta}),removed},this.removeNewLine=function(row){var firstLine=this.getLine(row),secondLine=this.getLine(row+1),range=new Range(row,firstLine.length,row+1,0),line=firstLine+secondLine;this.$lines.splice(row,2,line);var delta={action:"removeText",range:range,text:this.getNewLineCharacter()};this._signal("change",{data:delta})},this.replace=function(range,text){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0==text.length&&range.isEmpty())return range.start;if(text==this.getTextRange(range))return range.end;if(this.remove(range),text)var end=this.insert(range.start,text);else end=range.start;return end},this.applyDeltas=function(deltas){for(var i=0;deltas.length>i;i++){var delta=deltas[i],range=Range.fromPoints(delta.range.start,delta.range.end);"insertLines"==delta.action?this.insertLines(range.start.row,delta.lines):"insertText"==delta.action?this.insert(range.start,delta.text):"removeLines"==delta.action?this._removeLines(range.start.row,range.end.row-1):"removeText"==delta.action&&this.remove(range)}},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--){var delta=deltas[i],range=Range.fromPoints(delta.range.start,delta.range.end);"insertLines"==delta.action?this._removeLines(range.start.row,range.end.row-1):"insertText"==delta.action?this.remove(range):"removeLines"==delta.action?this._insertLines(range.start.row,delta.lines):"removeText"==delta.action&&this.insert(range.start,delta.text)}},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;l>i;i++)if(index-=lines[i].length+newlineLength,0>index)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;row>i;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document}),ace.define("ace/lib/lang",["require","exports","module"],function(acequire,exports){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\\s\\s*/,trimEndRegexp=/\\s\\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;l>i;i++)copy[i]=array[i]&&"object"==typeof array[i]?this.copyObject(array[i]):array[i];return copy},exports.deepCopy=function(obj){if("object"!=typeof obj||!obj)return obj;var cons=obj.constructor;if(cons===RegExp)return obj;var copy=cons();for(var key in obj)copy[key]="object"==typeof obj[key]?exports.deepCopy(obj[key]):obj[key];return copy},exports.arrayToMap=function(arr){for(var map={},i=0;arr.length>i;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;array.length>=i;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,"\\\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})}),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}}),ace.define("ace/worker/mirror",["require","exports","module","ace/document","ace/lib/lang"],function(acequire,exports){"use strict";var Document=acequire("../document").Document,lang=acequire("../lib/lang"),Mirror=exports.Mirror=function(sender){this.sender=sender;var doc=this.doc=new Document(""),deferredUpdate=this.deferredUpdate=lang.delayedCall(this.onUpdate.bind(this)),_self=this;sender.on("change",function(e){return doc.applyDeltas(e.data),_self.$timeout?deferredUpdate.schedule(_self.$timeout):(_self.onUpdate(),void 0)})};(function(){this.$timeout=500,this.setTimeout=function(timeout){this.$timeout=timeout},this.setValue=function(value){this.doc.setValue(value),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(callbackId){this.sender.callback(this.doc.getValue(),callbackId)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(Mirror.prototype)}),ace.define("ace/mode/javascript/jshint",["require","exports","module"],function(acequire,exports,module){module.exports=function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof acequire&&acequire;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw Error("Cannot find module \'"+o+"\'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof acequire&&acequire,o=0;r.length>o;o++)s(r[o]);return s}({1:[function(_dereq_,module){for(var identifierStartTable=[],i=0;128>i;i++)identifierStartTable[i]=36===i||i>=65&&90>=i||95===i||i>=97&&122>=i;for(var identifierPartTable=[],i=0;128>i;i++)identifierPartTable[i]=identifierStartTable[i]||i>=48&&57>=i;module.exports={asciiIdentifierStartTable:identifierStartTable,asciiIdentifierPartTable:identifierPartTable}},{}],2:[function(_dereq_,module,exports){(function(){var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?(this._wrapped=obj,void 0):new _(obj)};exports!==void 0?(module!==void 0&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.6.0";var each=_.each=_.forEach=function(obj,iterator,context){if(null==obj)return obj;if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===+obj.length){for(var i=0,length=obj.length;length>i;i++)if(iterator.call(context,obj[i],i,obj)===breaker)return}else for(var keys=_.keys(obj),i=0,length=keys.length;length>i;i++)if(iterator.call(context,obj[keys[i]],keys[i],obj)===breaker)return;return obj};_.map=_.collect=function(obj,iterator,context){var results=[];return null==obj?results:nativeMap&&obj.map===nativeMap?obj.map(iterator,context):(each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results)};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduce&&obj.reduce===nativeReduce)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduce(iterator,memo):obj.reduce(iterator);if(each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduceRight&&obj.reduceRight===nativeReduceRight)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}if(each(obj,function(value,index,list){index=keys?keys[--length]:--length,initial?memo=iterator.call(context,memo,obj[index],index,list):(memo=obj[index],initial=!0)}),!initial)throw new TypeError(reduceError);return memo},_.find=_.detect=function(obj,predicate,context){var result;return any(obj,function(value,index,list){return predicate.call(context,value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,predicate,context){var results=[];return null==obj?results:nativeFilter&&obj.filter===nativeFilter?obj.filter(predicate,context):(each(obj,function(value,index,list){predicate.call(context,value,index,list)&&results.push(value)}),results)},_.reject=function(obj,predicate,context){return _.filter(obj,function(value,index,list){return!predicate.call(context,value,index,list)},context)},_.every=_.all=function(obj,predicate,context){predicate||(predicate=_.identity);var result=!0;return null==obj?result:nativeEvery&&obj.every===nativeEvery?obj.every(predicate,context):(each(obj,function(value,index,list){return(result=result&&predicate.call(context,value,index,list))?void 0:breaker}),!!result)};var any=_.some=_.any=function(obj,predicate,context){predicate||(predicate=_.identity);var result=!1;return null==obj?result:nativeSome&&obj.some===nativeSome?obj.some(predicate,context):(each(obj,function(value,index,list){return result||(result=predicate.call(context,value,index,list))?breaker:void 0}),!!result)};_.contains=_.include=function(obj,target){return null==obj?!1:nativeIndexOf&&obj.indexOf===nativeIndexOf?-1!=obj.indexOf(target):any(obj,function(value){return value===target})},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))},_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&65535>obj.length)return Math.max.apply(Math,obj);var result=-1/0,lastComputed=-1/0;return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>lastComputed&&(result=value,lastComputed=computed)}),result},_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&65535>obj.length)return Math.min.apply(Math,obj);var result=1/0,lastComputed=1/0;return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;lastComputed>computed&&(result=value,lastComputed=computed)}),result},_.shuffle=function(obj){var rand,index=0,shuffled=[];return each(obj,function(value){rand=_.random(index++),shuffled[index-1]=shuffled[rand],shuffled[rand]=value}),shuffled},_.sample=function(obj,n,guard){return null==n||guard?(obj.length!==+obj.length&&(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))};var lookupIterator=function(value){return null==value?_.identity:_.isFunction(value)?value:_.property(value)};_.sortBy=function(obj,iterator,context){return iterator=lookupIterator(iterator),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}\n}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iterator,context){var result={};return iterator=lookupIterator(iterator),each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)}),result}};_.groupBy=group(function(result,key,value){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,key,value){result[key]=value}),_.countBy=group(function(result,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iterator,context){iterator=lookupIterator(iterator);for(var value=iterator.call(context,obj),low=0,high=array.length;high>low;){var mid=low+high>>>1;value>iterator.call(context,array[mid])?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:0>n?[]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(null==n||guard?1:n))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,output){return shallow&&_.every(input,_.isArray)?concat.apply(output,input):(each(input,function(value){_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,output):output.push(value)}),output)};_.flatten=function(array,shallow){return flatten(array,shallow,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.partition=function(array,predicate){var pass=[],fail=[];return each(array,function(elem){(predicate(elem)?pass:fail).push(elem)}),[pass,fail]},_.uniq=_.unique=function(array,isSorted,iterator,context){_.isFunction(isSorted)&&(context=iterator,iterator=isSorted,isSorted=!1);var initial=iterator?_.map(array,iterator,context):array,results=[],seen=[];return each(initial,function(value,index){(isSorted?index&&seen[seen.length-1]===value:_.contains(seen,value))||(seen.push(value),results.push(array[index]))}),results},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.contains(other,item)})})},_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){for(var length=_.max(_.pluck(arguments,"length").concat(0)),results=Array(length),i=0;length>i;i++)results[i]=_.pluck(arguments,""+i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,length+isSorted):isSorted}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;length>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var hasIndex=null!=from;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item);for(var i=hasIndex?from:array.length;i--;)if(array[i]===item)return i;return-1},_.range=function(start,stop,step){1>=arguments.length&&(stop=start||0,start=0),step=arguments[2]||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=Array(length);length>idx;)range[idx++]=start,start+=step;return range};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}},_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){for(var position=0,args=boundArgs.slice(),i=0,length=args.length;length>i;i++)args[i]===_&&(args[i]=arguments[position++]);for(;arguments.length>position;)args.push(arguments[position++]);return func.apply(this,args)}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(0===funcs.length)throw Error("bindAll must be passed function names");return each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher||(hasher=_.identity),function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),context=args=null};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),context=args=null):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;wait>last?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),context=args=null))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.once=function(func){var memo,ran=!1;return function(){return ran?memo:(ran=!0,memo=func.apply(this,arguments),func=null,memo)}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.compose=function(){var funcs=arguments;return function(){for(var args=arguments,i=funcs.length-1;i>=0;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return function(){return 1>--times?func.apply(this,arguments):void 0}},_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)obj[prop]=source[prop]}),obj},_.pick=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));return each(keys,function(key){key in obj&&(copy[key]=obj[key])}),copy},_.omit=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj)_.contains(keys,key)||(copy[key]=obj[key]);return copy},_.defaults=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return a==b+"";case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]==a)return bStack[length]==b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1;aStack.push(a),bStack.push(b);var size=0,result=!0;if("[object Array]"==className){if(size=a.length,result=size==b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{for(var key in a)if(_.has(a,key)&&(size++,!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack))))break;if(result){for(key in b)if(_.has(b,key)&&!size--)break;result=!size}}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"==toString.call(obj)},_.isObject=function(obj){return obj===Object(obj)},each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return!(!obj||!_.has(obj,"callee"))}),_.isFunction=function(obj){return"function"==typeof obj},_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"==toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.property=function(key){return function(obj){return obj[key]}},_.matches=function(attrs){return function(obj){if(obj===attrs)return!0;for(var key in attrs)if(attrs[key]!==obj[key])return!1;return!0}},_.times=function(n,iterator,context){for(var accum=Array(Math.max(0,n)),i=0;n>i;i++)accum[i]=iterator.call(context,i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",\'"\':"&quot;","\'":"&#x27;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){return null==string?"":(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}}),_.result=function(object,property){if(null==object)return void 0;var value=object[property];return _.isFunction(value)?value.call(object):value},_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};var noMatch=/(.)^/,escapes={"\'":"\'","\\\\":"\\\\","\\r":"r","\\n":"n","	":"t","\\u2028":"u2028","\\u2029":"u2029"},escaper=/\\\\|\'|\\r|\\n|\\t|\\u2028|\\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+=\'";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,function(match){return"\\\\"+escapes[match]}),escape&&(source+="\'+\\n((__t=("+escape+"))==null?\'\':_.escape(__t))+\\n\'"),interpolate&&(source+="\'+\\n((__t=("+interpolate+"))==null?\'\':__t)+\\n\'"),evaluate&&(source+="\';\\n"+evaluate+"\\n__p+=\'"),index=offset+match.length,match}),source+="\';\\n",settings.variable||(source="with(obj||{}){\\n"+source+"}\\n"),source="var __t,__p=\'\',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,\'\');};\\n"+source+"return __p;\\n";try{render=Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};return template.source="function("+(settings.variable||"obj")+"){\\n"+source+"}",template},_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_),each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!=name&&"splice"!=name||0!==obj.length||delete obj[0],result.call(this,obj)}}),each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&ace.define("underscore",[],function(){return _})}).call(this)},{}],3:[function(_dereq_,module,exports){var _=_dereq_("underscore"),events=_dereq_("events"),vars=_dereq_("./vars.js"),messages=_dereq_("./messages.js"),Lexer=_dereq_("./lex.js").Lexer,reg=_dereq_("./reg.js"),state=_dereq_("./state.js").state,style=_dereq_("./style.js"),JSHINT=function(){"use strict";function checkOption(name,t){return name=name.trim(),/^[+-]W\\d{3}$/g.test(name)?!0:void 0!==valOptions[name]||void 0!==boolOptions[name]||"jslint"===t.type||removedOptions[name]?!0:(error("E001",t,name),!1)}function isString(obj){return"[object String]"===Object.prototype.toString.call(obj)}function isIdentifier(tkn,value){return tkn?tkn.identifier&&tkn.value===value?!0:!1:!1}function isReserved(token){if(!token.reserved)return!1;var meta=token.meta;if(meta&&meta.isFutureReservedWord&&state.option.inES5()){if(!meta.es5)return!1;if(meta.strictOnly&&!state.option.strict&&!state.directive["use strict"])return!1;if(token.isProperty)return!1}return!0}function supplant(str,data){return str.replace(/\\{([^{}]*)\\}/g,function(a,b){var r=data[b];return"string"==typeof r||"number"==typeof r?r:a})}function combine(dest,src){Object.keys(src).forEach(function(name){_.has(JSHINT.blacklist,name)||(dest[name]=src[name])})}function assume(){state.option.esnext&&combine(predefined,vars.newEcmaIdentifiers),state.option.couch&&combine(predefined,vars.couch),state.option.qunit&&combine(predefined,vars.qunit),state.option.rhino&&combine(predefined,vars.rhino),state.option.shelljs&&(combine(predefined,vars.shelljs),combine(predefined,vars.node)),state.option.typed&&combine(predefined,vars.typed),state.option.phantom&&combine(predefined,vars.phantom),state.option.prototypejs&&combine(predefined,vars.prototypejs),state.option.node&&(combine(predefined,vars.node),combine(predefined,vars.typed)),state.option.devel&&combine(predefined,vars.devel),state.option.dojo&&combine(predefined,vars.dojo),state.option.browser&&(combine(predefined,vars.browser),combine(predefined,vars.typed)),state.option.nonstandard&&combine(predefined,vars.nonstandard),state.option.jasmine&&combine(predefined,vars.jasmine),state.option.jquery&&combine(predefined,vars.jquery),state.option.mootools&&combine(predefined,vars.mootools),state.option.worker&&combine(predefined,vars.worker),state.option.wsh&&combine(predefined,vars.wsh),state.option.globalstrict&&state.option.strict!==!1&&(state.option.strict=!0),state.option.yui&&combine(predefined,vars.yui),state.option.mocha&&combine(predefined,vars.mocha),state.option.inMoz=function(){return state.option.moz},state.option.inESNext=function(){return state.option.moz||state.option.esnext},state.option.inES5=function(){return!state.option.es3},state.option.inES3=function(strict){return strict?!state.option.moz&&!state.option.esnext&&state.option.es3:state.option.es3}}function quit(code,line,chr){var percentage=Math.floor(100*(line/state.lines.length)),message=messages.errors[code].desc;throw{name:"JSHintError",line:line,character:chr,message:message+" ("+percentage+"% scanned).",raw:message,code:code}}function isundef(scope,code,token,a){return JSHINT.undefs.push([scope,code,token,a])}function removeIgnoredMessages(){var ignored=state.ignoredLines;_.isEmpty(ignored)||(JSHINT.errors=_.reject(JSHINT.errors,function(err){return ignored[err.line]}))}function warning(code,t,a,b,c,d){var ch,l,w,msg;if(/^W\\d{3}$/.test(code)){if(state.ignored[code])return;msg=messages.warnings[code]}else/E\\d{3}/.test(code)?msg=messages.errors[code]:/I\\d{3}/.test(code)&&(msg=messages.info[code]);return t=t||state.tokens.next,"(end)"===t.id&&(t=state.tokens.curr),l=t.line||0,ch=t.from||0,w={id:"(error)",raw:msg.desc,code:msg.code,evidence:state.lines[l-1]||"",line:l,character:ch,scope:JSHINT.scope,a:a,b:b,c:c,d:d},w.reason=supplant(msg.desc,w),JSHINT.errors.push(w),removeIgnoredMessages(),JSHINT.errors.length>=state.option.maxerr&&quit("E043",l,ch),w}function warningAt(m,l,ch,a,b,c,d){return warning(m,{line:l,from:ch},a,b,c,d)}function error(m,t,a,b,c,d){warning(m,t,a,b,c,d)}function errorAt(m,l,ch,a,b,c,d){return error(m,{line:l,from:ch},a,b,c,d)}function addInternalSrc(elem,src){var i;return i={id:"(internal)",elem:elem,value:src},JSHINT.internals.push(i),i}function addlabel(name,opts){opts=opts||{};var type=opts.type,token=opts.token,islet=opts.islet;"exception"===type&&_.has(funct["(context)"],name)&&(funct[name]===!0||state.option.node||warning("W002",state.tokens.next,name)),_.has(funct,name)&&!funct["(global)"]&&(funct[name]===!0?state.option.latedef&&(state.option.latedef===!0&&_.contains([funct[name],type],"unction")||!_.contains([funct[name],type],"unction"))&&warning("W003",state.tokens.next,name):((!state.option.shadow||_.contains(["inner","outer"],state.option.shadow))&&"exception"!==type||funct["(blockscope)"].getlabel(name))&&warning("W004",state.tokens.next,name)),funct["(context)"]&&_.has(funct["(context)"],name)&&"function"!==type&&"outer"===state.option.shadow&&warning("W123",state.tokens.next,name),islet?funct["(blockscope)"].current.add(name,type,state.tokens.curr):(funct["(blockscope)"].shadow(name),funct[name]=type,token&&(funct["(tokens)"][name]=token),setprop(funct,name,{unused:opts.unused||!1}),funct["(global)"]?(global[name]=funct,_.has(implied,name)&&(state.option.latedef&&(state.option.latedef===!0&&_.contains([funct[name],type],"unction")||!_.contains([funct[name],type],"unction"))&&warning("W003",state.tokens.next,name),delete implied[name])):scope[name]=funct)}function doOption(){var nt=state.tokens.next,body=nt.body.match(/(-\\s+)?[^\\s,:]+(?:\\s*:\\s*(-\\s+)?[^\\s,]+)?/g),predef={};if("globals"===nt.type){body.forEach(function(g){g=g.split(":");var key=(g[0]||"").trim(),val=(g[1]||"").trim();"-"===key.charAt(0)?(key=key.slice(1),val=!1,JSHINT.blacklist[key]=key,delete predefined[key]):predef[key]="true"===val}),combine(predefined,predef);for(var key in predef)_.has(predef,key)&&(declared[key]=nt)}"exported"===nt.type&&body.forEach(function(e){exported[e]=!0}),"members"===nt.type&&(membersOnly=membersOnly||{},body.forEach(function(m){var ch1=m.charAt(0),ch2=m.charAt(m.length-1);ch1!==ch2||\'"\'!==ch1&&"\'"!==ch1||(m=m.substr(1,m.length-2).replace(\'\\\\"\',\'"\')),membersOnly[m]=!1}));var numvals=["maxstatements","maxparams","maxdepth","maxcomplexity","maxerr","maxlen","indent"];("jshint"===nt.type||"jslint"===nt.type)&&(body.forEach(function(g){g=g.split(":");var key=(g[0]||"").trim(),val=(g[1]||"").trim();if(checkOption(key,nt))if(numvals.indexOf(key)>=0)if("false"!==val){if(val=+val,"number"!=typeof val||!isFinite(val)||0>=val||Math.floor(val)!==val)return error("E032",nt,g[1].trim()),void 0;state.option[key]=val}else state.option[key]="indent"===key?4:!1;else{if("validthis"===key)return funct["(global)"]?void error("E009"):"true"!==val&&"false"!==val?void error("E002",nt):(state.option.validthis="true"===val,void 0);if("quotmark"!==key)if("shadow"!==key)if("unused"!==key)if("latedef"!==key){if("ignore"!==key){var match=/^([+-])(W\\d{3})$/g.exec(key);if(match)return state.ignored[match[2]]="-"===match[1],void 0;var tn;return"true"===val||"false"===val?("jslint"===nt.type?(tn=renamedOptions[key]||key,state.option[tn]="true"===val,void 0!==invertedOptions[tn]&&(state.option[tn]=!state.option[tn])):state.option[key]="true"===val,"newcap"===key&&(state.option["(explicitNewcap)"]=!0),void 0):(error("E002",nt),void 0)}switch(val){case"start":state.ignoreLinterErrors=!0;break;case"end":state.ignoreLinterErrors=!1;break;case"line":state.ignoredLines[nt.line]=!0,removeIgnoredMessages();break;default:error("E002",nt)}}else switch(val){case"true":state.option.latedef=!0;break;case"false":state.option.latedef=!1;break;case"nofunc":state.option.latedef="nofunc";break;default:error("E002",nt)}else switch(val){case"true":state.option.unused=!0;break;case"false":state.option.unused=!1;break;case"vars":case"strict":state.option.unused=val;break;default:error("E002",nt)}else switch(val){case"true":state.option.shadow=!0;break;case"outer":state.option.shadow="outer";break;case"false":case"inner":state.option.shadow="inner";break;default:error("E002",nt)}else switch(val){case"true":case"false":state.option.quotmark="true"===val;break;case"double":case"single":state.option.quotmark=val;break;default:error("E002",nt)}}}),assume())}function peek(p){for(var t,i=p||0,j=0;i>=j;)t=lookahead[j],t||(t=lookahead[j]=lex.token()),j+=1;return t}function advance(id,t){switch(state.tokens.curr.id){case"(number)":"."===state.tokens.next.id&&warning("W005",state.tokens.curr);break;case"-":("-"===state.tokens.next.id||"--"===state.tokens.next.id)&&warning("W006");break;case"+":("+"===state.tokens.next.id||"++"===state.tokens.next.id)&&warning("W007")}for(("(string)"===state.tokens.curr.type||state.tokens.curr.identifier)&&(anonname=state.tokens.curr.value),id&&state.tokens.next.id!==id&&(t?"(end)"===state.tokens.next.id?error("E019",t,t.id):error("E020",state.tokens.next,id,t.id,t.line,state.tokens.next.value):("(identifier)"!==state.tokens.next.type||state.tokens.next.value!==id)&&warning("W116",state.tokens.next,id,state.tokens.next.value)),state.tokens.prev=state.tokens.curr,state.tokens.curr=state.tokens.next;;){if(state.tokens.next=lookahead.shift()||lex.token(),state.tokens.next||quit("E041",state.tokens.curr.line),"(end)"===state.tokens.next.id||"(error)"===state.tokens.next.id)return;if(state.tokens.next.check&&state.tokens.next.check(),state.tokens.next.isSpecial)doOption();else if("(endline)"!==state.tokens.next.id)break}}function isInfix(token){return token.infix||!token.identifier&&!!token.led}function isEndOfExpr(){var curr=state.tokens.curr,next=state.tokens.next;return";"===next.id||"}"===next.id||":"===next.id?!0:isInfix(next)===isInfix(curr)||"yield"===curr.id&&state.option.inMoz(!0)?curr.line!==next.line:!1}function expression(rbp,initial){var left,isArray=!1,isObject=!1,isLetExpr=!1;initial||"let"!==state.tokens.next.value||"("!==peek(0).value||(state.option.inMoz(!0)||warning("W118",state.tokens.next,"let expressions"),isLetExpr=!0,funct["(blockscope)"].stack(),advance("let"),advance("("),state.syntax.let.fud.call(state.syntax.let.fud,!1),advance(")")),"(end)"===state.tokens.next.id&&error("E006",state.tokens.curr);var isDangerous=state.option.asi&&state.tokens.prev.line<state.tokens.curr.line&&_.contains(["]",")"],state.tokens.prev.id)&&_.contains(["[","("],state.tokens.curr.id);if(isDangerous&&warning("W014",state.tokens.curr,state.tokens.curr.id),advance(),initial&&(anonname="anonymous",funct["(verb)"]=state.tokens.curr.value),initial===!0&&state.tokens.curr.fud)left=state.tokens.curr.fud();else for(state.tokens.curr.nud?left=state.tokens.curr.nud():error("E030",state.tokens.curr,state.tokens.curr.id);state.tokens.next.lbp>rbp&&!isEndOfExpr();)isArray="Array"===state.tokens.curr.value,isObject="Object"===state.tokens.curr.value,left&&(left.value||left.first&&left.first.value)&&("new"!==left.value||left.first&&left.first.value&&"."===left.first.value)&&(isArray=!1,left.value!==state.tokens.curr.value&&(isObject=!1)),advance(),isArray&&"("===state.tokens.curr.id&&")"===state.tokens.next.id&&warning("W009",state.tokens.curr),isObject&&"("===state.tokens.curr.id&&")"===state.tokens.next.id&&warning("W010",state.tokens.curr),left&&state.tokens.curr.led?left=state.tokens.curr.led(left):error("E033",state.tokens.curr,state.tokens.curr.id);return isLetExpr&&funct["(blockscope)"].unstack(),left}function nobreaknonadjacent(left,right){left=left||state.tokens.curr,right=right||state.tokens.next,state.option.laxbreak||left.line===right.line||warning("W014",right,right.value)}function nolinebreak(t){t=t||state.tokens.curr,t.line!==state.tokens.next.line&&warning("E022",t,t.value)}function nobreakcomma(left,right){left.line!==right.line&&(state.option.laxcomma||(comma.first&&(warning("I001"),comma.first=!1),warning("W014",left,right.value)))}function comma(opts){if(opts=opts||{},opts.peek?nobreakcomma(state.tokens.prev,state.tokens.curr):(nobreakcomma(state.tokens.curr,state.tokens.next),advance(",")),state.tokens.next.identifier&&(!opts.property||!state.option.inES5()))switch(state.tokens.next.value){case"break":case"case":case"catch":case"continue":case"default":case"do":case"else":case"finally":case"for":case"if":case"in":case"instanceof":case"return":case"switch":case"throw":case"try":case"var":case"let":case"while":case"with":return error("E024",state.tokens.next,state.tokens.next.value),!1}if("(punctuator)"===state.tokens.next.type)switch(state.tokens.next.value){case"}":case"]":case",":if(opts.allowTrailing)return!0;case")":return error("E024",state.tokens.next,state.tokens.next.value),!1}return!0}function symbol(s,p){var x=state.syntax[s];return x&&"object"==typeof x||(state.syntax[s]=x={id:s,lbp:p,value:s}),x}function delim(s){return symbol(s,0)}function stmt(s,f){var x=delim(s);return x.identifier=x.reserved=!0,x.fud=f,x}function blockstmt(s,f){var x=stmt(s,f);return x.block=!0,x}function reserveName(x){var c=x.id.charAt(0);return(c>="a"&&"z">=c||c>="A"&&"Z">=c)&&(x.identifier=x.reserved=!0),x}function prefix(s,f){var x=symbol(s,150);return reserveName(x),x.nud="function"==typeof f?f:function(){return this.right=expression(150),this.arity="unary",("++"===this.id||"--"===this.id)&&(state.option.plusplus?warning("W016",this,this.id):!this.right||this.right.identifier&&!isReserved(this.right)||"."===this.right.id||"["===this.right.id||warning("W017",this)),this},x}function type(s,f){var x=delim(s);return x.type=s,x.nud=f,x}function reserve(name,func){var x=type(name,func);return x.identifier=!0,x.reserved=!0,x}function FutureReservedWord(name,meta){var x=type(name,meta&&meta.nud||function(){return this});return meta=meta||{},meta.isFutureReservedWord=!0,x.value=name,x.identifier=!0,x.reserved=!0,x.meta=meta,x}function reservevar(s,v){return reserve(s,function(){return"function"==typeof v&&v(this),this})}function infix(s,f,p,w){var x=symbol(s,p);return reserveName(x),x.infix=!0,x.led=function(left){return w||nobreaknonadjacent(state.tokens.prev,state.tokens.curr),"in"===s&&"!"===left.id&&warning("W018",left,"!"),"function"==typeof f?f(left,this):(this.left=left,this.right=expression(p),this)},x}function application(s){var x=symbol(s,42);return x.led=function(left){return state.option.inESNext()||warning("W104",state.tokens.curr,"arrow function syntax (=>)"),nobreaknonadjacent(state.tokens.prev,state.tokens.curr),this.left=left,this.right=doFunction(void 0,void 0,!1,left),this},x}function relation(s,f){var x=symbol(s,100);return x.led=function(left){nobreaknonadjacent(state.tokens.prev,state.tokens.curr);var right=expression(100);return isIdentifier(left,"NaN")||isIdentifier(right,"NaN")?warning("W019",this):f&&f.apply(this,[left,right]),left&&right||quit("E041",state.tokens.curr.line),"!"===left.id&&warning("W018",left,"!"),"!"===right.id&&warning("W018",right,"!"),this.left=left,this.right=right,this},x}function isPoorRelation(node){return node&&("(number)"===node.type&&0===+node.value||"(string)"===node.type&&""===node.value||"null"===node.type&&!state.option.eqnull||"true"===node.type||"false"===node.type||"undefined"===node.type)}function isTypoTypeof(left,right){if(state.option.notypeof)return!1;if(!left||!right)return!1;var values=["undefined","object","boolean","number","string","function","xml","object","unknown"];return"(identifier)"===right.type&&"typeof"===right.value&&"(string)"===left.type?!_.contains(values,left.value):!1}function findNativePrototype(left){function walkPrototype(obj){return"object"==typeof obj?"prototype"===obj.right?obj:walkPrototype(obj.left):void 0}function walkNative(obj){for(;!obj.identifier&&"object"==typeof obj.left;)obj=obj.left;return obj.identifier&&natives.indexOf(obj.value)>=0?obj.value:void 0}var natives=["Array","ArrayBuffer","Boolean","Collator","DataView","Date","DateTimeFormat","Error","EvalError","Float32Array","Float64Array","Function","Infinity","Intl","Int16Array","Int32Array","Int8Array","Iterator","Number","NumberFormat","Object","RangeError","ReferenceError","RegExp","StopIteration","String","SyntaxError","TypeError","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray","URIError"],prototype=walkPrototype(left);return prototype?walkNative(prototype):void 0}function assignop(s,f,p){var x=infix(s,"function"==typeof f?f:function(left,that){if(that.left=left,left){if(state.option.freeze){var nativeObject=findNativePrototype(left);nativeObject&&warning("W121",left,nativeObject)}if(predefined[left.value]===!1&&scope[left.value]["(global)"]===!0?warning("W020",left):left["function"]&&warning("W021",left,left.value),"const"===funct[left.value]&&error("E013",left,left.value),"."===left.id)return left.left?"arguments"!==left.left.value||state.directive["use strict"]||warning("E031",that):warning("E031",that),that.right=expression(10),that;if("["===left.id)return state.tokens.curr.left.first?state.tokens.curr.left.first.forEach(function(t){t&&"const"===funct[t.value]&&error("E013",t,t.value)}):left.left?"arguments"!==left.left.value||state.directive["use strict"]||warning("E031",that):warning("E031",that),that.right=expression(10),that;if(left.identifier&&!isReserved(left))return"exception"===funct[left.value]&&warning("W022",left),that.right=expression(10),that;left===state.syntax["function"]&&warning("W023",state.tokens.curr)\n}error("E031",that)},p);return x.exps=!0,x.assign=!0,x}function bitwise(s,f,p){var x=symbol(s,p);return reserveName(x),x.led="function"==typeof f?f:function(left){return state.option.bitwise&&warning("W016",this,this.id),this.left=left,this.right=expression(p),this},x}function bitwiseassignop(s){return assignop(s,function(left,that){return state.option.bitwise&&warning("W016",that,that.id),left?"."===left.id||"["===left.id||left.identifier&&!isReserved(left)?(expression(10),that):(left===state.syntax["function"]&&warning("W023",state.tokens.curr),that):(error("E031",that),void 0)},20)}function suffix(s){var x=symbol(s,150);return x.led=function(left){return state.option.plusplus?warning("W016",this,this.id):left.identifier&&!isReserved(left)||"."===left.id||"["===left.id||warning("W017",this),this.left=left,this},x}function optionalidentifier(fnparam,prop){if(state.tokens.next.identifier){advance();var curr=state.tokens.curr,val=state.tokens.curr.value;return isReserved(curr)?prop&&state.option.inES5()?val:fnparam&&"undefined"===val?val:(warning("W024",state.tokens.curr,state.tokens.curr.id),val):val}}function identifier(fnparam,prop){var i=optionalidentifier(fnparam,prop);return i?i:("function"===state.tokens.curr.id&&"("===state.tokens.next.id?warning("W025"):error("E030",state.tokens.next,state.tokens.next.value),void 0)}function reachable(s){var t,i=0;if(";"===state.tokens.next.id&&!noreach)for(;;){do t=peek(i),i+=1;while("(end)"!=t.id&&"(comment)"===t.id);if(t.reach)return;if("(endline)"!==t.id){if("function"===t.id){state.option.latedef===!0&&warning("W026",t);break}warning("W027",t,t.value,s);break}}}function parseFinalSemicolon(){";"!==state.tokens.next.id?state.option.asi||state.option.lastsemic&&"}"===state.tokens.next.id&&state.tokens.next.line===state.tokens.curr.line||warningAt("W033",state.tokens.curr.line,state.tokens.curr.character):advance(";")}function statement(){var values,r,i=indent,s=scope,t=state.tokens.next;if(";"===t.id)return advance(";"),void 0;var res=isReserved(t);if(res&&t.meta&&t.meta.isFutureReservedWord&&":"===peek().id&&(warning("W024",t,t.id),res=!1),"module"===t.value&&"(identifier)"===t.type&&"(identifier)"===peek().type){state.option.inESNext()||warning("W119",state.tokens.curr,"module"),advance("module");var name=identifier();return addlabel(name,{type:"unused",token:state.tokens.curr}),advance("from"),advance("(string)"),parseFinalSemicolon(),void 0}if(_.has(["[","{"],t.value)&&lookupBlockType().isDestAssign)return state.option.inESNext()||warning("W104",state.tokens.curr,"destructuring expression"),values=destructuringExpression(),values.forEach(function(tok){isundef(funct,"W117",tok.token,tok.id)}),advance("="),destructuringExpressionMatch(values,expression(10,!0)),advance(";"),void 0;if(t.identifier&&!res&&":"===peek().id&&(advance(),advance(":"),scope=Object.create(s),addlabel(t.value,{type:"label"}),state.tokens.next.labelled||"{"===state.tokens.next.value||warning("W028",state.tokens.next,t.value,state.tokens.next.value),state.tokens.next.label=t.value,t=state.tokens.next),"{"===t.id){var iscase="case"===funct["(verb)"]&&":"===state.tokens.curr.value;return block(!0,!0,!1,!1,iscase),void 0}return r=expression(0,!0),!r||r.identifier&&"function"===r.value||"(punctuator)"===r.type||!state.directive["use strict"]&&state.option.globalstrict&&state.option.strict&&warning("E007"),t.block||(state.option.expr||r&&r.exps?state.option.nonew&&r&&r.left&&"("===r.id&&"new"===r.left.id&&warning("W031",t):warning("W030",state.tokens.curr),parseFinalSemicolon()),indent=i,scope=s,r}function statements(startLine){for(var p,a=[];!state.tokens.next.reach&&"(end)"!==state.tokens.next.id;)";"===state.tokens.next.id?(p=peek(),(!p||"("!==p.id&&"["!==p.id)&&warning("W032"),advance(";")):a.push(statement(startLine===state.tokens.next.line));return a}function directives(){for(var i,p,pn;"(string)"===state.tokens.next.id;){if(p=peek(0),"(endline)"===p.id){i=1;do pn=peek(i),i+=1;while("(endline)"===pn.id);if(";"!==pn.id){if("(string)"!==pn.id&&"(number)"!==pn.id&&"(regexp)"!==pn.id&&pn.identifier!==!0&&"}"!==pn.id)break;warning("W033",state.tokens.next)}else p=pn}else if("}"===p.id)warning("W033",p);else if(";"!==p.id)break;advance(),state.directive[state.tokens.curr.value]&&warning("W034",state.tokens.curr,state.tokens.curr.value),"use strict"===state.tokens.curr.value&&(state.option["(explicitNewcap)"]||(state.option.newcap=!0),state.option.undef=!0),state.directive[state.tokens.curr.value]=!0,";"===p.id&&advance(";")}}function block(ordinary,stmt,isfunc,isfatarrow,iscase){var a,m,t,line,d,b=inblock,old_indent=indent,s=scope;inblock=ordinary,ordinary&&state.option.funcscope||(scope=Object.create(scope)),t=state.tokens.next;var metrics=funct["(metrics)"];if(metrics.nestedBlockDepth+=1,metrics.verifyMaxNestedBlockDepthPerFunction(),"{"===state.tokens.next.id){if(advance("{"),funct["(blockscope)"].stack(),line=state.tokens.curr.line,"}"!==state.tokens.next.id){for(indent+=state.option.indent;!ordinary&&state.tokens.next.from>indent;)indent+=state.option.indent;if(isfunc){m={};for(d in state.directive)_.has(state.directive,d)&&(m[d]=state.directive[d]);directives(),state.option.strict&&funct["(context)"]["(global)"]&&(m["use strict"]||state.directive["use strict"]||warning("E007"))}a=statements(line),metrics.statementCount+=a.length,isfunc&&(state.directive=m),indent-=state.option.indent}advance("}",t),funct["(blockscope)"].unstack(),indent=old_indent}else if(ordinary)funct["(nolet)"]=!0,(!stmt||state.option.curly)&&warning("W116",state.tokens.next,"{",state.tokens.next.value),noreach=!0,indent+=state.option.indent,a=[statement()],indent-=state.option.indent,noreach=!1,delete funct["(nolet)"];else if(isfunc){if(m={},!stmt||isfatarrow||state.option.inMoz(!0)||error("W118",state.tokens.curr,"function closure expressions"),!stmt)for(d in state.directive)_.has(state.directive,d)&&(m[d]=state.directive[d]);expression(10),state.option.strict&&funct["(context)"]["(global)"]&&(m["use strict"]||state.directive["use strict"]||warning("E007"))}else error("E021",state.tokens.next,"{",state.tokens.next.value);switch(funct["(verb)"]){case"break":case"continue":case"return":case"throw":if(iscase)break;default:funct["(verb)"]=null}return ordinary&&state.option.funcscope||(scope=s),inblock=b,!ordinary||!state.option.noempty||a&&0!==a.length||warning("W035"),metrics.nestedBlockDepth-=1,a}function countMember(m){membersOnly&&"boolean"!=typeof membersOnly[m]&&warning("W036",state.tokens.curr,m),"number"==typeof member[m]?member[m]+=1:member[m]=1}function note_implied(tkn){var name=tkn.value,desc=Object.getOwnPropertyDescriptor(implied,name);desc?desc.value.push(tkn.line):implied[name]=[tkn.line]}function comprehensiveArrayExpression(){var res={};res.exps=!0,funct["(comparray)"].stack();var reversed=!1;return"for"!==state.tokens.next.value&&(reversed=!0,state.option.inMoz(!0)||warning("W116",state.tokens.next,"for",state.tokens.next.value),funct["(comparray)"].setState("use"),res.right=expression(10)),advance("for"),"each"===state.tokens.next.value&&(advance("each"),state.option.inMoz(!0)||warning("W118",state.tokens.curr,"for each")),advance("("),funct["(comparray)"].setState("define"),res.left=expression(130),_.contains(["in","of"],state.tokens.next.value)?advance():error("E045",state.tokens.curr),funct["(comparray)"].setState("generate"),expression(10),advance(")"),"if"===state.tokens.next.value&&(advance("if"),advance("("),funct["(comparray)"].setState("filter"),res.filter=expression(10),advance(")")),reversed||(funct["(comparray)"].setState("use"),res.right=expression(10)),advance("]"),funct["(comparray)"].unstack(),res}function property_name(){var id=optionalidentifier(!1,!0);return id||("(string)"===state.tokens.next.id?(id=state.tokens.next.value,advance()):"(number)"===state.tokens.next.id&&(id=""+state.tokens.next.value,advance())),"hasOwnProperty"===id&&warning("W001"),id}function functionparams(parsed){var curr,next,ident,t,params=[],tokens=[],pastDefault=!1;if(parsed){if(Array.isArray(parsed)){for(var i in parsed)curr=parsed[i],"..."!==curr.value?","!==curr.value&&(params.push(curr.value),addlabel(curr.value,{type:"unused",token:curr})):state.option.inESNext()||warning("W104",curr,"spread/rest operator");return params}if(parsed.identifier===!0)return addlabel(parsed.value,{type:"unused",token:parsed}),[parsed]}if(next=state.tokens.next,advance("("),")"===state.tokens.next.id)return advance(")"),void 0;for(;;){if(_.contains(["{","["],state.tokens.next.id)){tokens=destructuringExpression();for(t in tokens)t=tokens[t],t.id&&(params.push(t.id),addlabel(t.id,{type:"unused",token:t.token}))}else"..."===state.tokens.next.value?(state.option.inESNext()||warning("W104",state.tokens.next,"spread/rest operator"),advance("..."),ident=identifier(!0),params.push(ident),addlabel(ident,{type:"unused",token:state.tokens.curr})):(ident=identifier(!0),params.push(ident),addlabel(ident,{type:"unused",token:state.tokens.curr}));if(pastDefault&&"="!==state.tokens.next.id&&error("E051",state.tokens.current),"="===state.tokens.next.id&&(state.option.inESNext()||warning("W119",state.tokens.next,"default parameters"),advance("="),pastDefault=!0,expression(10)),","!==state.tokens.next.id)return advance(")",next),params;comma()}}function setprop(funct,name,values){funct["(properties)"][name]||(funct["(properties)"][name]={unused:!1}),_.extend(funct["(properties)"][name],values)}function getprop(funct,name,prop){return funct["(properties)"][name]?funct["(properties)"][name][prop]||null:null}function functor(name,token,scope,overwrites){var funct={"(name)":name,"(breakage)":0,"(loopage)":0,"(scope)":scope,"(tokens)":{},"(properties)":{},"(catch)":!1,"(global)":!1,"(line)":null,"(character)":null,"(metrics)":null,"(statement)":null,"(context)":null,"(blockscope)":null,"(comparray)":null,"(generator)":null,"(params)":null};return token&&_.extend(funct,{"(line)":token.line,"(character)":token.character,"(metrics)":createMetrics(token)}),_.extend(funct,overwrites),funct["(context)"]&&(funct["(blockscope)"]=funct["(context)"]["(blockscope)"],funct["(comparray)"]=funct["(context)"]["(comparray)"]),funct}function doFunction(name,statement,generator,fatarrowparams){var f,oldOption=state.option,oldIgnored=state.ignored,oldScope=scope;return state.option=Object.create(state.option),state.ignored=Object.create(state.ignored),scope=Object.create(scope),funct=functor(name||\'"\'+anonname+\'"\',state.tokens.next,scope,{"(statement)":statement,"(context)":funct,"(generator)":generator?!0:null}),f=funct,state.tokens.curr.funct=funct,functions.push(funct),name&&addlabel(name,{type:"function"}),funct["(params)"]=functionparams(fatarrowparams),funct["(metrics)"].verifyMaxParametersPerFunction(funct["(params)"]),JSHINT.undefs=_.filter(JSHINT.undefs,function(item){return!_.contains(_.union(fatarrowparams),item[2])}),block(!1,!0,!0,fatarrowparams?!0:!1),!state.option.noyield&&generator&&"yielded"!==funct["(generator)"]&&warning("W124",state.tokens.curr),funct["(metrics)"].verifyMaxStatementsPerFunction(),funct["(metrics)"].verifyMaxComplexityPerFunction(),funct["(unusedOption)"]=state.option.unused,scope=oldScope,state.option=oldOption,state.ignored=oldIgnored,funct["(last)"]=state.tokens.curr.line,funct["(lastcharacter)"]=state.tokens.curr.character,_.map(Object.keys(funct),function(key){"("!==key[0]&&funct["(blockscope)"].unshadow(key)}),funct=funct["(context)"],f}function createMetrics(functionStartToken){return{statementCount:0,nestedBlockDepth:-1,ComplexityCount:1,verifyMaxStatementsPerFunction:function(){state.option.maxstatements&&this.statementCount>state.option.maxstatements&&warning("W071",functionStartToken,this.statementCount)},verifyMaxParametersPerFunction:function(params){params=params||[],state.option.maxparams&&params.length>state.option.maxparams&&warning("W072",functionStartToken,params.length)},verifyMaxNestedBlockDepthPerFunction:function(){state.option.maxdepth&&this.nestedBlockDepth>0&&this.nestedBlockDepth===state.option.maxdepth+1&&warning("W073",null,this.nestedBlockDepth)},verifyMaxComplexityPerFunction:function(){var max=state.option.maxcomplexity,cc=this.ComplexityCount;max&&cc>max&&warning("W074",functionStartToken,cc)}}}function increaseComplexityCount(){funct["(metrics)"].ComplexityCount+=1}function checkCondAssignment(expr){var id,paren;switch(expr&&(id=expr.id,paren=expr.paren,","===id&&(expr=expr.exprs[expr.exprs.length-1])&&(id=expr.id,paren=paren||expr.paren)),id){case"=":case"+=":case"-=":case"*=":case"%=":case"&=":case"|=":case"^=":case"/=":paren||state.option.boss||warning("W084")}}function destructuringExpression(){var id,ids,identifiers=[];state.option.inESNext()||warning("W104",state.tokens.curr,"destructuring expression");var nextInnerDE=function(){var ident;if(_.contains(["[","{"],state.tokens.next.value)){ids=destructuringExpression();for(var id in ids)id=ids[id],identifiers.push({id:id.id,token:id.token})}else","===state.tokens.next.value?identifiers.push({id:null,token:state.tokens.curr}):"("===state.tokens.next.value?(advance("("),nextInnerDE(),advance(")")):(ident=identifier(),ident&&identifiers.push({id:ident,token:state.tokens.curr}))};if("["===state.tokens.next.value){for(advance("["),nextInnerDE();"]"!==state.tokens.next.value;)advance(","),nextInnerDE();advance("]")}else if("{"===state.tokens.next.value){for(advance("{"),id=identifier(),":"===state.tokens.next.value?(advance(":"),nextInnerDE()):identifiers.push({id:id,token:state.tokens.curr});"}"!==state.tokens.next.value;)advance(","),id=identifier(),":"===state.tokens.next.value?(advance(":"),nextInnerDE()):identifiers.push({id:id,token:state.tokens.curr});advance("}")}return identifiers}function destructuringExpressionMatch(tokens,value){var first=value.first;first&&_.zip(tokens,Array.isArray(first)?first:[first]).forEach(function(val){var token=val[0],value=val[1];token&&value?token.first=value:token&&token.first&&!value&&warning("W080",token.first,token.first.value)})}function classdef(stmt){return state.option.inESNext()||warning("W104",state.tokens.curr,"class"),stmt?(this.name=identifier(),addlabel(this.name,{type:"unused",token:state.tokens.curr})):state.tokens.next.identifier&&"extends"!==state.tokens.next.value&&(this.name=identifier()),classtail(this),this}function classtail(c){var strictness=state.directive["use strict"];"extends"===state.tokens.next.value&&(advance("extends"),c.heritage=expression(10)),state.directive["use strict"]=!0,advance("{"),c.body=state.syntax["{"].nud(!0),state.directive["use strict"]=strictness}function destructuringAssignOrJsonValue(){var block=lookupBlockType();block.notJson?(!state.option.inESNext()&&block.isDestAssign&&warning("W104",state.tokens.curr,"destructuring assignment"),statements()):(state.option.laxbreak=!0,state.jsonMode=!0,jsonValue())}function jsonValue(){function jsonObject(){var o={},t=state.tokens.next;if(advance("{"),"}"!==state.tokens.next.id)for(;;){if("(end)"===state.tokens.next.id)error("E026",state.tokens.next,t.line);else{if("}"===state.tokens.next.id){warning("W094",state.tokens.curr);break}","===state.tokens.next.id?error("E028",state.tokens.next):"(string)"!==state.tokens.next.id&&warning("W095",state.tokens.next,state.tokens.next.value)}if(o[state.tokens.next.value]===!0?warning("W075",state.tokens.next,state.tokens.next.value):"__proto__"===state.tokens.next.value&&!state.option.proto||"__iterator__"===state.tokens.next.value&&!state.option.iterator?warning("W096",state.tokens.next,state.tokens.next.value):o[state.tokens.next.value]=!0,advance(),advance(":"),jsonValue(),","!==state.tokens.next.id)break;advance(",")}advance("}")}function jsonArray(){var t=state.tokens.next;if(advance("["),"]"!==state.tokens.next.id)for(;;){if("(end)"===state.tokens.next.id)error("E027",state.tokens.next,t.line);else{if("]"===state.tokens.next.id){warning("W094",state.tokens.curr);break}","===state.tokens.next.id&&error("E028",state.tokens.next)}if(jsonValue(),","!==state.tokens.next.id)break;advance(",")}advance("]")}switch(state.tokens.next.id){case"{":jsonObject();break;case"[":jsonArray();break;case"true":case"false":case"null":case"(number)":case"(string)":advance();break;case"-":advance("-"),advance("(number)");break;default:error("E003",state.tokens.next)}}var anonname,api,declared,exported,funct,functions,global,implied,inblock,indent,lookahead,lex,member,membersOnly,noreach,predefined,scope,stack,unuseds,urls,bang={"<":!0,"<=":!0,"==":!0,"===":!0,"!==":!0,"!=":!0,">":!0,">=":!0,"+":!0,"-":!0,"*":!0,"/":!0,"%":!0},boolOptions={asi:!0,bitwise:!0,boss:!0,browser:!0,camelcase:!0,couch:!0,curly:!0,debug:!0,devel:!0,dojo:!0,eqeqeq:!0,eqnull:!0,notypeof:!0,es3:!0,es5:!0,esnext:!0,moz:!0,evil:!0,expr:!0,forin:!0,funcscope:!0,globalstrict:!0,immed:!0,iterator:!0,jasmine:!0,jquery:!0,lastsemic:!0,laxbreak:!0,laxcomma:!0,loopfunc:!0,mootools:!0,multistr:!0,freeze:!0,newcap:!0,noarg:!0,node:!0,noempty:!0,nonbsp:!0,nonew:!0,nonstandard:!0,phantom:!0,plusplus:!0,proto:!0,prototypejs:!0,qunit:!0,rhino:!0,shelljs:!0,typed:!0,undef:!0,scripturl:!0,strict:!0,sub:!0,supernew:!0,validthis:!0,withstmt:!0,worker:!0,wsh:!0,yui:!0,mocha:!0,noyield:!0,onecase:!0,regexp:!0,regexdash:!0},valOptions={maxlen:!1,indent:!1,maxerr:!1,predef:!1,globals:!1,quotmark:!1,scope:!1,maxstatements:!1,maxdepth:!1,maxparams:!1,maxcomplexity:!1,shadow:!1,unused:!0,latedef:!1,ignore:!1},invertedOptions={bitwise:!0,forin:!0,newcap:!0,plusplus:!0,regexp:!0,undef:!0,eqeqeq:!0,strict:!0},renamedOptions={eqeq:"eqeqeq",windows:"wsh",sloppy:"strict"},removedOptions={nomen:!0,onevar:!0,passfail:!0,white:!0,gcl:!0,smarttabs:!0,trailing:!0},functionicity=["closure","exception","global","label","outer","unused","var"],extraModules=[],emitter=new events.EventEmitter;type("(number)",function(){return this}),type("(string)",function(){return this}),type("(template)",function(){return this}),state.syntax["(identifier)"]={type:"(identifier)",lbp:0,identifier:!0,nud:function(){var f,block,v=this.value,s=scope[v];if("function"==typeof s?s=void 0:funct["(blockscope)"].current.has(v)||"boolean"!=typeof s||(f=funct,funct=functions[0],addlabel(v,{type:"var"}),s=funct,funct=f),block=funct["(blockscope)"].getlabel(v),funct===s||block)switch(block?block[v]["(type)"]:funct[v]){case"unused":block?block[v]["(type)"]="var":funct[v]="var";break;case"unction":block?block[v]["(type)"]="function":funct[v]="function",this["function"]=!0;break;case"const":setprop(funct,v,{unused:!1});break;case"function":this["function"]=!0;break;case"label":warning("W037",state.tokens.curr,v)}else if(funct["(global)"])"boolean"!=typeof predefined[v]&&("typeof"!==anonname&&"delete"!==anonname||state.tokens.next&&("."===state.tokens.next.value||"["===state.tokens.next.value))&&(funct["(comparray)"].check(v)||isundef(funct,"W117",state.tokens.curr,v)),note_implied(state.tokens.curr);else switch(funct[v]){case"closure":case"function":case"var":case"unused":warning("W038",state.tokens.curr,v);break;case"label":warning("W037",state.tokens.curr,v);break;case"outer":case"global":break;default:if(s===!0)funct[v]=!0;else if(null===s)warning("W039",state.tokens.curr,v),note_implied(state.tokens.curr);else if("object"!=typeof s)("typeof"!==anonname&&"delete"!==anonname||state.tokens.next&&("."===state.tokens.next.value||"["===state.tokens.next.value))&&isundef(funct,"W117",state.tokens.curr,v),funct[v]=!0,note_implied(state.tokens.curr);else switch(s[v]){case"function":case"unction":this["function"]=!0,s[v]="closure",funct[v]=s["(global)"]?"global":"outer";break;case"var":case"unused":s[v]="closure",funct[v]=s["(global)"]?"global":"outer";break;case"const":setprop(s,v,{unused:!1});break;case"closure":funct[v]=s["(global)"]?"global":"outer";break;case"label":warning("W037",state.tokens.curr,v)}}return this},led:function(){error("E033",state.tokens.next,state.tokens.next.value)}},type("(regexp)",function(){return this}),delim("(endline)"),delim("(begin)"),delim("(end)").reach=!0,delim("(error)").reach=!0,delim("}").reach=!0,delim(")"),delim("]"),delim(\'"\').reach=!0,delim("\'").reach=!0,delim(";"),delim(":").reach=!0,delim("#"),reserve("else"),reserve("case").reach=!0,reserve("catch"),reserve("default").reach=!0,reserve("finally"),reservevar("arguments",function(x){state.directive["use strict"]&&funct["(global)"]&&warning("E008",x)}),reservevar("eval"),reservevar("false"),reservevar("Infinity"),reservevar("null"),reservevar("this",function(x){state.directive["use strict"]&&!state.option.validthis&&(funct["(statement)"]&&funct["(name)"].charAt(0)>"Z"||funct["(global)"])&&warning("W040",x)}),reservevar("true"),reservevar("undefined"),assignop("=","assign",20),assignop("+=","assignadd",20),assignop("-=","assignsub",20),assignop("*=","assignmult",20),assignop("/=","assigndiv",20).nud=function(){error("E014")},assignop("%=","assignmod",20),bitwiseassignop("&=","assignbitand",20),bitwiseassignop("|=","assignbitor",20),bitwiseassignop("^=","assignbitxor",20),bitwiseassignop("<<=","assignshiftleft",20),bitwiseassignop(">>=","assignshiftright",20),bitwiseassignop(">>>=","assignshiftrightunsigned",20),infix(",",function(left,that){var expr;if(that.exprs=[left],!comma({peek:!0}))return that;for(;;){if(!(expr=expression(10)))break;if(that.exprs.push(expr),","!==state.tokens.next.value||!comma())break}return that},10,!0),infix("?",function(left,that){return increaseComplexityCount(),that.left=left,that.right=expression(10),advance(":"),that["else"]=expression(10),that},30);var orPrecendence=40;infix("||",function(left,that){return increaseComplexityCount(),that.left=left,that.right=expression(orPrecendence),that},orPrecendence),infix("&&","and",50),bitwise("|","bitor",70),bitwise("^","bitxor",80),bitwise("&","bitand",90),relation("==",function(left,right){var eqnull=state.option.eqnull&&("null"===left.value||"null"===right.value);switch(!0){case!eqnull&&state.option.eqeqeq:this.from=this.character,warning("W116",this,"===","==");break;case isPoorRelation(left):warning("W041",this,"===",left.value);break;case isPoorRelation(right):warning("W041",this,"===",right.value);break;case isTypoTypeof(right,left):warning("W122",this,right.value);break;case isTypoTypeof(left,right):warning("W122",this,left.value)}return this}),relation("===",function(left,right){return isTypoTypeof(right,left)?warning("W122",this,right.value):isTypoTypeof(left,right)&&warning("W122",this,left.value),this}),relation("!=",function(left,right){var eqnull=state.option.eqnull&&("null"===left.value||"null"===right.value);return!eqnull&&state.option.eqeqeq?(this.from=this.character,warning("W116",this,"!==","!=")):isPoorRelation(left)?warning("W041",this,"!==",left.value):isPoorRelation(right)?warning("W041",this,"!==",right.value):isTypoTypeof(right,left)?warning("W122",this,right.value):isTypoTypeof(left,right)&&warning("W122",this,left.value),this}),relation("!==",function(left,right){return isTypoTypeof(right,left)?warning("W122",this,right.value):isTypoTypeof(left,right)&&warning("W122",this,left.value),this}),relation("<"),relation(">"),relation("<="),relation(">="),bitwise("<<","shiftleft",120),bitwise(">>","shiftright",120),bitwise(">>>","shiftrightunsigned",120),infix("in","in",120),infix("instanceof","instanceof",120),infix("+",function(left,that){var right=expression(130);return left&&right&&"(string)"===left.id&&"(string)"===right.id?(left.value+=right.value,left.character=right.character,!state.option.scripturl&&reg.javascriptURL.test(left.value)&&warning("W050",left),left):(that.left=left,that.right=right,that)},130),prefix("+","num"),prefix("+++",function(){return warning("W007"),this.right=expression(150),this.arity="unary",this}),infix("+++",function(left){return warning("W007"),this.left=left,this.right=expression(130),this},130),infix("-","sub",130),prefix("-","neg"),prefix("---",function(){return warning("W006"),this.right=expression(150),this.arity="unary",this}),infix("---",function(left){return warning("W006"),this.left=left,this.right=expression(130),this},130),infix("*","mult",140),infix("/","div",140),infix("%","mod",140),suffix("++","postinc"),prefix("++","preinc"),state.syntax["++"].exps=!0,suffix("--","postdec"),prefix("--","predec"),state.syntax["--"].exps=!0,prefix("delete",function(){var p=expression(10);return(!p||"."!==p.id&&"["!==p.id)&&warning("W051"),this.first=p,this}).exps=!0,prefix("~",function(){return state.option.bitwise&&warning("W052",this,"~"),expression(150),this}),prefix("...",function(){return state.option.inESNext()||warning("W104",this,"spread/rest operator"),state.tokens.next.identifier||error("E030",state.tokens.next,state.tokens.next.value),expression(150),this}),prefix("!",function(){return this.right=expression(150),this.arity="unary",this.right||quit("E041",this.line||0),bang[this.right.id]===!0&&warning("W018",this,"!"),this}),prefix("typeof","typeof"),prefix("new",function(){var i,c=expression(155);if(c&&"function"!==c.id)if(c.identifier)switch(c["new"]=!0,c.value){case"Number":case"String":case"Boolean":case"Math":case"JSON":warning("W053",state.tokens.prev,c.value);break;case"Function":state.option.evil||warning("W054");break;case"Date":case"RegExp":case"this":break;default:"function"!==c.id&&(i=c.value.substr(0,1),state.option.newcap&&("A">i||i>"Z")&&!_.has(global,c.value)&&warning("W055",state.tokens.curr))}else"."!==c.id&&"["!==c.id&&"("!==c.id&&warning("W056",state.tokens.curr);else state.option.supernew||warning("W057",this);return"("===state.tokens.next.id||state.option.supernew||warning("W058",state.tokens.curr,state.tokens.curr.value),this.first=c,this}),state.syntax["new"].exps=!0,prefix("void").exps=!0,infix(".",function(left,that){var m=identifier(!1,!0);return"string"==typeof m&&countMember(m),that.left=left,that.right=m,m&&"hasOwnProperty"===m&&"="===state.tokens.next.value&&warning("W001"),!left||"arguments"!==left.value||"callee"!==m&&"caller"!==m?state.option.evil||!left||"document"!==left.value||"write"!==m&&"writeln"!==m||warning("W060",left):state.option.noarg?warning("W059",left,m):state.directive["use strict"]&&error("E008"),state.option.evil||"eval"!==m&&"execScript"!==m||warning("W061"),that},160,!0),infix("(",function(left,that){state.option.immed&&left&&!left.immed&&"function"===left.id&&warning("W062");var n=0,p=[];if(left&&"(identifier)"===left.type&&left.value.match(/^[A-Z]([A-Z0-9_$]*[a-z][A-Za-z0-9_$]*)?$/)&&-1==="Number String Boolean Date Object Error".indexOf(left.value)&&("Math"===left.value?warning("W063",left):state.option.newcap&&warning("W064",left)),")"!==state.tokens.next.id)for(;p[p.length]=expression(10),n+=1,","===state.tokens.next.id;)comma();return advance(")"),"object"==typeof left&&(state.option.inES3()&&"parseInt"===left.value&&1===n&&warning("W065",state.tokens.curr),state.option.evil||("eval"===left.value||"Function"===left.value||"execScript"===left.value?(warning("W061",left),p[0]&&"(string)"===[0].id&&addInternalSrc(left,p[0].value)):!p[0]||"(string)"!==p[0].id||"setTimeout"!==left.value&&"setInterval"!==left.value?!p[0]||"(string)"!==p[0].id||"."!==left.value||"window"!==left.left.value||"setTimeout"!==left.right&&"setInterval"!==left.right||(warning("W066",left),addInternalSrc(left,p[0].value)):(warning("W066",left),addInternalSrc(left,p[0].value))),left.identifier||"."===left.id||"["===left.id||"("===left.id||"&&"===left.id||"||"===left.id||"?"===left.id||warning("W067",left)),that.left=left,that},155,!0).exps=!0,prefix("(",function(){var bracket,pn,pn1,ret,brackets=[],i=0,parens=1;do pn=peek(i),"("===pn.value?parens+=1:")"===pn.value&&(parens-=1),i+=1,pn1=peek(i);while((0!==parens||")"!==pn.value)&&"=>"!==pn1.value&&";"!==pn1.value&&"(end)"!==pn1.type);"function"===state.tokens.next.id&&(state.tokens.next.immed=!0);var exprs=[];if(")"!==state.tokens.next.id)for(;;){if("=>"===pn1.value&&_.contains(["{","["],state.tokens.next.value)){bracket=state.tokens.next,bracket.left=destructuringExpression(),brackets.push(bracket);for(var t in bracket.left)exprs.push(bracket.left[t].token)}else exprs.push(expression(10));if(","!==state.tokens.next.id)break;comma()}return advance(")",this),state.option.immed&&exprs[0]&&"function"===exprs[0].id&&"("!==state.tokens.next.id&&("."!==state.tokens.next.id||"call"!==peek().value&&"apply"!==peek().value)&&warning("W068",this),"=>"===state.tokens.next.value?exprs:exprs.length?(exprs.length>1?(ret=Object.create(state.syntax[","]),ret.exprs=exprs):ret=exprs[0],ret&&(ret.paren=!0),ret):void 0}),application("=>"),infix("[",function(left,that){var s,e=expression(10);return e&&"(string)"===e.type&&(state.option.evil||"eval"!==e.value&&"execScript"!==e.value||warning("W061",that),countMember(e.value),!state.option.sub&&reg.identifier.test(e.value)&&(s=state.syntax[e.value],s&&isReserved(s)||warning("W069",state.tokens.prev,e.value))),advance("]",that),e&&"hasOwnProperty"===e.value&&"="===state.tokens.next.value&&warning("W001"),that.left=left,that.right=e,that},160,!0),prefix("[",function(){var blocktype=lookupBlockType(!0);if(blocktype.isCompArray)return state.option.inESNext()||warning("W119",state.tokens.curr,"array comprehension"),comprehensiveArrayExpression();blocktype.isDestAssign&&!state.option.inESNext()&&warning("W104",state.tokens.curr,"destructuring assignment");var b=state.tokens.curr.line!==state.tokens.next.line;for(this.first=[],b&&(indent+=state.option.indent,state.tokens.next.from===indent+state.option.indent&&(indent+=state.option.indent));"(end)"!==state.tokens.next.id;){for(;","===state.tokens.next.id;)state.option.inES5()||warning("W070"),advance(",");if("]"===state.tokens.next.id)break;if(this.first.push(expression(10)),","!==state.tokens.next.id)break;if(comma({allowTrailing:!0}),"]"===state.tokens.next.id&&!state.option.inES5(!0)){warning("W070",state.tokens.curr);break}}return b&&(indent-=state.option.indent),advance("]",this),this},160),function(x){x.nud=function(isclassdef){function saveProperty(name,tkn){props[name]&&_.has(props,name)?warning("W075",state.tokens.next,i):props[name]={},props[name].basic=!0,props[name].basictkn=tkn}function saveSetter(name,tkn){props[name]&&_.has(props,name)?(props[name].basic||props[name].setter)&&warning("W075",state.tokens.next,i):props[name]={},props[name].setter=!0,props[name].setterToken=tkn}function saveGetter(name){props[name]&&_.has(props,name)?(props[name].basic||props[name].getter)&&warning("W075",state.tokens.next,i):props[name]={},props[name].getter=!0,props[name].getterToken=state.tokens.curr}var b,f,i,p,t,g,props={},tag="";for(b=state.tokens.curr.line!==state.tokens.next.line,b&&(indent+=state.option.indent,state.tokens.next.from===indent+state.option.indent&&(indent+=state.option.indent));"}"!==state.tokens.next.id;){if(isclassdef&&"static"===state.tokens.next.value&&(advance("static"),tag="static "),"get"===state.tokens.next.value&&":"!==peek().id)advance("get"),state.option.inES5(!isclassdef)||error("E034"),i=property_name(),i||state.option.inESNext()||error("E035"),isclassdef&&"constructor"===i&&error("E049",state.tokens.next,"class getter method",i),i&&saveGetter(tag+i),t=state.tokens.next,f=doFunction(),p=f["(params)"],i&&p&&warning("W076",t,p[0],i);else if("set"===state.tokens.next.value&&":"!==peek().id)advance("set"),state.option.inES5(!isclassdef)||error("E034"),i=property_name(),i||state.option.inESNext()||error("E035"),isclassdef&&"constructor"===i&&error("E049",state.tokens.next,"class setter method",i),i&&saveSetter(tag+i,state.tokens.next),t=state.tokens.next,f=doFunction(),p=f["(params)"],!i||p&&1===p.length||warning("W077",t,i);else{if(g=!1,"*"===state.tokens.next.value&&"(punctuator)"===state.tokens.next.type&&(state.option.inESNext()||warning("W104",state.tokens.next,"generator functions"),advance("*"),g=!0),i=property_name(),saveProperty(tag+i,state.tokens.next),"string"!=typeof i)break;"("===state.tokens.next.value?(state.option.inESNext()||warning("W104",state.tokens.curr,"concise methods"),doFunction(i,void 0,g)):isclassdef||(advance(":"),expression(10))}if(isclassdef&&"prototype"===i&&error("E049",state.tokens.next,"class method",i),countMember(i),isclassdef)tag="";\nelse{if(","!==state.tokens.next.id)break;comma({allowTrailing:!0,property:!0}),","===state.tokens.next.id?warning("W070",state.tokens.curr):"}"!==state.tokens.next.id||state.option.inES5(!0)||warning("W070",state.tokens.curr)}}if(b&&(indent-=state.option.indent),advance("}",this),state.option.inES5())for(var name in props)_.has(props,name)&&props[name].setter&&!props[name].getter&&warning("W078",props[name].setterToken);return this},x.fud=function(){error("E036",state.tokens.curr)}}(delim("{"));var conststatement=stmt("const",function(prefix){var tokens,value,lone;for(state.option.inESNext()||warning("W104",state.tokens.curr,"const"),this.first=[];;){var names=[];_.contains(["{","["],state.tokens.next.value)?(tokens=destructuringExpression(),lone=!1):(tokens=[{id:identifier(),token:state.tokens.curr}],lone=!0);for(var t in tokens)tokens.hasOwnProperty(t)&&(t=tokens[t],"const"===funct[t.id]&&warning("E011",null,t.id),funct["(global)"]&&predefined[t.id]===!1&&warning("W079",t.token,t.id),t.id&&(addlabel(t.id,{token:t.token,type:"const",unused:!0}),names.push(t.token)));if(prefix)break;if(this.first=this.first.concat(names),"="!==state.tokens.next.id&&warning("E012",state.tokens.curr,state.tokens.curr.value),"="===state.tokens.next.id&&(advance("="),"undefined"===state.tokens.next.id&&warning("W080",state.tokens.prev,state.tokens.prev.value),"="===peek(0).id&&state.tokens.next.identifier&&warning("W120",state.tokens.next,state.tokens.next.value),value=expression(10),lone?tokens[0].first=value:destructuringExpressionMatch(names,value)),","!==state.tokens.next.id)break;comma()}return this});conststatement.exps=!0;var varstatement=stmt("var",function(prefix){var tokens,lone,value;for(this.first=[];;){var names=[];_.contains(["{","["],state.tokens.next.value)?(tokens=destructuringExpression(),lone=!1):(tokens=[{id:identifier(),token:state.tokens.curr}],lone=!0);for(var t in tokens)tokens.hasOwnProperty(t)&&(t=tokens[t],state.option.inESNext()&&"const"===funct[t.id]&&warning("E011",null,t.id),funct["(global)"]&&predefined[t.id]===!1&&warning("W079",t.token,t.id),t.id&&(addlabel(t.id,{type:"unused",token:t.token}),names.push(t.token)));if(prefix)break;if(this.first=this.first.concat(names),"="===state.tokens.next.id&&(advance("="),"undefined"===state.tokens.next.id&&warning("W080",state.tokens.prev,state.tokens.prev.value),"="===peek(0).id&&state.tokens.next.identifier&&warning("W120",state.tokens.next,state.tokens.next.value),value=expression(10),lone?tokens[0].first=value:destructuringExpressionMatch(names,value)),","!==state.tokens.next.id)break;comma()}return this});varstatement.exps=!0;var letstatement=stmt("let",function(prefix){var tokens,lone,value,letblock;for(state.option.inESNext()||warning("W104",state.tokens.curr,"let"),"("===state.tokens.next.value?(state.option.inMoz(!0)||warning("W118",state.tokens.next,"let block"),advance("("),funct["(blockscope)"].stack(),letblock=!0):funct["(nolet)"]&&error("E048",state.tokens.curr),this.first=[];;){var names=[];_.contains(["{","["],state.tokens.next.value)?(tokens=destructuringExpression(),lone=!1):(tokens=[{id:identifier(),token:state.tokens.curr.value}],lone=!0);for(var t in tokens)tokens.hasOwnProperty(t)&&(t=tokens[t],state.option.inESNext()&&"const"===funct[t.id]&&warning("E011",null,t.id),funct["(global)"]&&predefined[t.id]===!1&&warning("W079",t.token,t.id),t.id&&!funct["(nolet)"]&&(addlabel(t.id,{type:"unused",token:t.token,islet:!0}),names.push(t.token)));if(prefix)break;if(this.first=this.first.concat(names),"="===state.tokens.next.id&&(advance("="),"undefined"===state.tokens.next.id&&warning("W080",state.tokens.prev,state.tokens.prev.value),"="===peek(0).id&&state.tokens.next.identifier&&warning("W120",state.tokens.next,state.tokens.next.value),value=expression(10),lone?tokens[0].first=value:destructuringExpressionMatch(names,value)),","!==state.tokens.next.id)break;comma()}return letblock&&(advance(")"),block(!0,!0),this.block=!0,funct["(blockscope)"].unstack()),this});letstatement.exps=!0,blockstmt("class",function(){return classdef.call(this,!0)}),blockstmt("function",function(){var generator=!1;"*"===state.tokens.next.value&&(advance("*"),state.option.inESNext(!0)?generator=!0:warning("W119",state.tokens.curr,"function*")),inblock&&warning("W082",state.tokens.curr);var i=identifier();return"const"===funct[i]&&warning("E011",null,i),addlabel(i,{type:"unction",token:state.tokens.curr}),doFunction(i,{statement:!0},generator),"("===state.tokens.next.id&&state.tokens.next.line===state.tokens.curr.line&&error("E039"),this}),prefix("function",function(){var generator=!1;"*"===state.tokens.next.value&&(state.option.inESNext()||warning("W119",state.tokens.curr,"function*"),advance("*"),generator=!0);var i=optionalidentifier();return doFunction(i,void 0,generator),!state.option.loopfunc&&funct["(loopage)"]&&warning("W083"),this}),blockstmt("if",function(){var t=state.tokens.next;return increaseComplexityCount(),state.condition=!0,advance("("),checkCondAssignment(expression(0)),advance(")",t),state.condition=!1,block(!0,!0),"else"===state.tokens.next.id&&(advance("else"),"if"===state.tokens.next.id||"switch"===state.tokens.next.id?statement(!0):block(!0,!0)),this}),blockstmt("try",function(){function doCatch(){var e,oldScope=scope;advance("catch"),advance("("),scope=Object.create(oldScope),e=state.tokens.next.value,"(identifier)"!==state.tokens.next.type&&(e=null,warning("E030",state.tokens.next,e)),advance(),funct=functor("(catch)",state.tokens.next,scope,{"(context)":funct,"(breakage)":funct["(breakage)"],"(loopage)":funct["(loopage)"],"(statement)":!1,"(catch)":!0}),e&&addlabel(e,{type:"exception"}),"if"===state.tokens.next.value&&(state.option.inMoz(!0)||warning("W118",state.tokens.curr,"catch filter"),advance("if"),expression(0)),advance(")"),state.tokens.curr.funct=funct,functions.push(funct),block(!1),scope=oldScope,funct["(last)"]=state.tokens.curr.line,funct["(lastcharacter)"]=state.tokens.curr.character,funct=funct["(context)"]}var b;for(block(!0);"catch"===state.tokens.next.id;)increaseComplexityCount(),b&&!state.option.inMoz(!0)&&warning("W118",state.tokens.next,"multiple catch blocks"),doCatch(),b=!0;return"finally"===state.tokens.next.id?(advance("finally"),block(!0),void 0):(b||error("E021",state.tokens.next,"catch",state.tokens.next.value),this)}),blockstmt("while",function(){var t=state.tokens.next;return funct["(breakage)"]+=1,funct["(loopage)"]+=1,increaseComplexityCount(),advance("("),checkCondAssignment(expression(0)),advance(")",t),block(!0,!0),funct["(breakage)"]-=1,funct["(loopage)"]-=1,this}).labelled=!0,blockstmt("with",function(){var t=state.tokens.next;return state.directive["use strict"]?error("E010",state.tokens.curr):state.option.withstmt||warning("W085",state.tokens.curr),advance("("),expression(0),advance(")",t),block(!0,!0),this}),blockstmt("switch",function(){var t=state.tokens.next,g=!1,noindent=!1;for(funct["(breakage)"]+=1,advance("("),checkCondAssignment(expression(0)),advance(")",t),t=state.tokens.next,advance("{"),state.tokens.next.from===indent&&(noindent=!0),noindent||(indent+=state.option.indent),this.cases=[];;)switch(state.tokens.next.id){case"case":switch(funct["(verb)"]){case"yield":case"break":case"case":case"continue":case"return":case"switch":case"throw":break;default:reg.fallsThrough.test(state.lines[state.tokens.next.line-2])||warning("W086",state.tokens.curr,"case")}advance("case"),this.cases.push(expression(0)),increaseComplexityCount(),g=!0,advance(":"),funct["(verb)"]="case";break;case"default":switch(funct["(verb)"]){case"yield":case"break":case"continue":case"return":case"throw":break;default:this.cases.length&&(reg.fallsThrough.test(state.lines[state.tokens.next.line-2])||warning("W086",state.tokens.curr,"default"))}advance("default"),g=!0,advance(":");break;case"}":return noindent||(indent-=state.option.indent),advance("}",t),funct["(breakage)"]-=1,funct["(verb)"]=void 0,void 0;case"(end)":return error("E023",state.tokens.next,"}"),void 0;default:if(indent+=state.option.indent,g)switch(state.tokens.curr.id){case",":return error("E040"),void 0;case":":g=!1,statements();break;default:return error("E025",state.tokens.curr),void 0}else{if(":"!==state.tokens.curr.id)return error("E021",state.tokens.next,"case",state.tokens.next.value),void 0;advance(":"),error("E024",state.tokens.curr,":"),statements()}indent-=state.option.indent}}).labelled=!0,stmt("debugger",function(){return state.option.debug||warning("W087",this),this}).exps=!0,function(){var x=stmt("do",function(){funct["(breakage)"]+=1,funct["(loopage)"]+=1,increaseComplexityCount(),this.first=block(!0,!0),advance("while");var t=state.tokens.next;return advance("("),checkCondAssignment(expression(0)),advance(")",t),funct["(breakage)"]-=1,funct["(loopage)"]-=1,this});x.labelled=!0,x.exps=!0}(),blockstmt("for",function(){var s,t=state.tokens.next,letscope=!1,foreachtok=null;"each"===t.value&&(foreachtok=t,advance("each"),state.option.inMoz(!0)||warning("W118",state.tokens.curr,"for each")),funct["(breakage)"]+=1,funct["(loopage)"]+=1,increaseComplexityCount(),advance("(");var nextop,i=0,inof=["in","of"];do nextop=peek(i),++i;while(!_.contains(inof,nextop.value)&&";"!==nextop.value&&"(end)"!==nextop.type);if(_.contains(inof,nextop.value)){if(state.option.inESNext()||"of"!==nextop.value||error("W104",nextop,"for of"),"var"===state.tokens.next.id)advance("var"),state.syntax["var"].fud.call(state.syntax["var"].fud,!0);else if("let"===state.tokens.next.id)advance("let"),letscope=!0,funct["(blockscope)"].stack(),state.syntax.let.fud.call(state.syntax.let.fud,!0);else if(state.tokens.next.identifier){switch(funct[state.tokens.next.value]){case"unused":funct[state.tokens.next.value]="var";break;case"var":break;default:funct["(blockscope)"].getlabel(state.tokens.next.value)||warning("W088",state.tokens.next,state.tokens.next.value)}advance()}else error("E030",state.tokens.next,state.tokens.next.type),advance();advance(nextop.value),expression(20),advance(")",t),s=block(!0,!0),state.option.forin&&s&&(s.length>1||"object"!=typeof s[0]||"if"!==s[0].value)&&warning("W089",this),funct["(breakage)"]-=1,funct["(loopage)"]-=1}else{if(foreachtok&&error("E045",foreachtok),";"!==state.tokens.next.id)if("var"===state.tokens.next.id)advance("var"),state.syntax["var"].fud.call(state.syntax["var"].fud);else if("let"===state.tokens.next.id)advance("let"),letscope=!0,funct["(blockscope)"].stack(),state.syntax.let.fud.call(state.syntax.let.fud);else for(;expression(0,"for"),","===state.tokens.next.id;)comma();if(nolinebreak(state.tokens.curr),advance(";"),";"!==state.tokens.next.id&&checkCondAssignment(expression(0)),nolinebreak(state.tokens.curr),advance(";"),";"===state.tokens.next.id&&error("E021",state.tokens.next,")",";"),")"!==state.tokens.next.id)for(;expression(0,"for"),","===state.tokens.next.id;)comma();advance(")",t),block(!0,!0),funct["(breakage)"]-=1,funct["(loopage)"]-=1}return letscope&&funct["(blockscope)"].unstack(),this}).labelled=!0,stmt("break",function(){var v=state.tokens.next.value;return 0===funct["(breakage)"]&&warning("W052",state.tokens.next,this.value),state.option.asi||nolinebreak(this),";"===state.tokens.next.id||state.tokens.next.reach||state.tokens.curr.line===state.tokens.next.line&&("label"!==funct[v]?warning("W090",state.tokens.next,v):scope[v]!==funct&&warning("W091",state.tokens.next,v),this.first=state.tokens.next,advance()),reachable("break"),this}).exps=!0,stmt("continue",function(){var v=state.tokens.next.value;return 0===funct["(breakage)"]&&warning("W052",state.tokens.next,this.value),state.option.asi||nolinebreak(this),";"===state.tokens.next.id||state.tokens.next.reach?funct["(loopage)"]||warning("W052",state.tokens.next,this.value):state.tokens.curr.line===state.tokens.next.line&&("label"!==funct[v]?warning("W090",state.tokens.next,v):scope[v]!==funct&&warning("W091",state.tokens.next,v),this.first=state.tokens.next,advance()),reachable("continue"),this}).exps=!0,stmt("return",function(){return this.line===state.tokens.next.line?";"===state.tokens.next.id||state.tokens.next.reach||(this.first=expression(0),!this.first||"(punctuator)"!==this.first.type||"="!==this.first.value||this.first.paren||state.option.boss||warningAt("W093",this.first.line,this.first.character)):"(punctuator)"===state.tokens.next.type&&["[","{","+","-"].indexOf(state.tokens.next.value)>-1&&nolinebreak(this),reachable("return"),this}).exps=!0,function(x){x.exps=!0,x.lbp=25}(prefix("yield",function(){var prev=state.tokens.prev;return state.option.inESNext(!0)&&!funct["(generator)"]?"(catch)"===funct["(name)"]&&funct["(context)"]["(generator)"]||error("E046",state.tokens.curr,"yield"):state.option.inESNext()||warning("W104",state.tokens.curr,"yield"),funct["(generator)"]="yielded",this.line!==state.tokens.next.line&&state.option.inMoz(!0)?state.option.asi||nolinebreak(this):(";"!==state.tokens.next.id&&!state.tokens.next.reach&&state.tokens.next.nud&&(nobreaknonadjacent(state.tokens.curr,state.tokens.next),this.first=expression(10),"(punctuator)"!==this.first.type||"="!==this.first.value||this.first.paren||state.option.boss||warningAt("W093",this.first.line,this.first.character)),state.option.inMoz(!0)&&")"!==state.tokens.next.id&&(prev.lbp>30||!prev.assign&&!isEndOfExpr()||"yield"===prev.id)&&error("E050",this)),this})),stmt("throw",function(){return nolinebreak(this),this.first=expression(20),reachable("throw"),this}).exps=!0,stmt("import",function(){if(state.option.inESNext()||warning("W119",state.tokens.curr,"import"),"(string)"===state.tokens.next.type)return advance("(string)"),this;if(state.tokens.next.identifier)this.name=identifier(),addlabel(this.name,{type:"unused",token:state.tokens.curr});else for(advance("{");;){if("}"===state.tokens.next.value){advance("}");break}var importName;if("default"===state.tokens.next.type?(importName="default",advance("default")):importName=identifier(),"as"===state.tokens.next.value&&(advance("as"),importName=identifier()),addlabel(importName,{type:"unused",token:state.tokens.curr}),","!==state.tokens.next.value){if("}"===state.tokens.next.value){advance("}");break}error("E024",state.tokens.next,state.tokens.next.value);break}advance(",")}return advance("from"),advance("(string)"),this}).exps=!0,stmt("export",function(){if(state.option.inESNext()||warning("W119",state.tokens.curr,"export"),"default"===state.tokens.next.type)return advance("default"),("function"===state.tokens.next.id||"class"===state.tokens.next.id)&&(this.block=!0),this.exportee=expression(10),this;if("{"===state.tokens.next.value){for(advance("{");;){if(exported[identifier()]=!0,","!==state.tokens.next.value){if("}"===state.tokens.next.value){advance("}");break}error("E024",state.tokens.next,state.tokens.next.value);break}advance(",")}return this}return"var"===state.tokens.next.id?(advance("var"),exported[state.tokens.next.value]=!0,state.syntax["var"].fud.call(state.syntax["var"].fud)):"let"===state.tokens.next.id?(advance("let"),exported[state.tokens.next.value]=!0,state.syntax.let.fud.call(state.syntax.let.fud)):"const"===state.tokens.next.id?(advance("const"),exported[state.tokens.next.value]=!0,state.syntax["const"].fud.call(state.syntax["const"].fud)):"function"===state.tokens.next.id?(this.block=!0,advance("function"),exported[state.tokens.next.value]=!0,state.syntax["function"].fud()):"class"===state.tokens.next.id?(this.block=!0,advance("class"),exported[state.tokens.next.value]=!0,state.syntax["class"].fud()):error("E024",state.tokens.next,state.tokens.next.value),this}).exps=!0,FutureReservedWord("abstract"),FutureReservedWord("boolean"),FutureReservedWord("byte"),FutureReservedWord("char"),FutureReservedWord("class",{es5:!0,nud:classdef}),FutureReservedWord("double"),FutureReservedWord("enum",{es5:!0}),FutureReservedWord("export",{es5:!0}),FutureReservedWord("extends",{es5:!0}),FutureReservedWord("final"),FutureReservedWord("float"),FutureReservedWord("goto"),FutureReservedWord("implements",{es5:!0,strictOnly:!0}),FutureReservedWord("import",{es5:!0}),FutureReservedWord("int"),FutureReservedWord("interface",{es5:!0,strictOnly:!0}),FutureReservedWord("long"),FutureReservedWord("native"),FutureReservedWord("package",{es5:!0,strictOnly:!0}),FutureReservedWord("private",{es5:!0,strictOnly:!0}),FutureReservedWord("protected",{es5:!0,strictOnly:!0}),FutureReservedWord("public",{es5:!0,strictOnly:!0}),FutureReservedWord("short"),FutureReservedWord("static",{es5:!0,strictOnly:!0}),FutureReservedWord("super",{es5:!0}),FutureReservedWord("synchronized"),FutureReservedWord("transient"),FutureReservedWord("volatile");var lookupBlockType=function(){var pn,pn1,i=-1,bracketStack=0,ret={};_.contains(["[","{"],state.tokens.curr.value)&&(bracketStack+=1);do{if(pn=-1===i?state.tokens.next:peek(i),pn1=peek(i+1),i+=1,_.contains(["[","{"],pn.value)?bracketStack+=1:_.contains(["]","}"],pn.value)&&(bracketStack-=1),pn.identifier&&"for"===pn.value&&1===bracketStack){ret.isCompArray=!0,ret.notJson=!0;break}if(_.contains(["}","]"],pn.value)&&"="===pn1.value&&0===bracketStack){ret.isDestAssign=!0,ret.notJson=!0;break}";"===pn.value&&(ret.isBlock=!0,ret.notJson=!0)}while(bracketStack>0&&"(end)"!==pn.id&&15>i);return ret},arrayComprehension=function(){function declare(v){var l=_current.variables.filter(function(elt){return elt.value===v?(elt.undef=!1,v):void 0}).length;return 0!==l}function use(v){var l=_current.variables.filter(function(elt){return elt.value!==v||elt.undef?void 0:(elt.unused===!0&&(elt.unused=!1),v)}).length;return 0===l}var _current,CompArray=function(){this.mode="use",this.variables=[]},_carrays=[];return{stack:function(){_current=new CompArray,_carrays.push(_current)},unstack:function(){_current.variables.filter(function(v){v.unused&&warning("W098",v.token,v.value),v.undef&&isundef(v.funct,"W117",v.token,v.value)}),_carrays.splice(-1,1),_current=_carrays[_carrays.length-1]},setState:function(s){_.contains(["use","define","generate","filter"],s)&&(_current.mode=s)},check:function(v){return _current?_current&&"use"===_current.mode?(use(v)&&_current.variables.push({funct:funct,token:state.tokens.curr,value:v,undef:!0,unused:!1}),!0):_current&&"define"===_current.mode?(declare(v)||_current.variables.push({funct:funct,token:state.tokens.curr,value:v,undef:!1,unused:!0}),!0):_current&&"generate"===_current.mode?(isundef(funct,"W117",state.tokens.curr,v),!0):_current&&"filter"===_current.mode?(use(v)&&isundef(funct,"W117",state.tokens.curr,v),!0):!1:void 0}}},blockScope=function(){function _checkBlockLabels(){for(var t in _current)if("unused"===_current[t]["(type)"]&&state.option.unused){var tkn=_current[t]["(token)"],line=tkn.line,chr=tkn.character;warningAt("W098",line,chr,t)}}var _current={},_variables=[_current];return{stack:function(){_current={},_variables.push(_current)},unstack:function(){_checkBlockLabels(),_variables.splice(_variables.length-1,1),_current=_.last(_variables)},getlabel:function(l){for(var i=_variables.length-1;i>=0;--i)if(_.has(_variables[i],l)&&!_variables[i][l]["(shadowed)"])return _variables[i]},shadow:function(name){for(var i=_variables.length-1;i>=0;i--)_.has(_variables[i],name)&&(_variables[i][name]["(shadowed)"]=!0)},unshadow:function(name){for(var i=_variables.length-1;i>=0;i--)_.has(_variables[i],name)&&(_variables[i][name]["(shadowed)"]=!1)},current:{has:function(t){return _.has(_current,t)},add:function(t,type,tok){_current[t]={"(type)":type,"(token)":tok,"(shadowed)":!1}}}}},itself=function(s,o,g){function each(obj,cb){obj&&(Array.isArray(obj)||"object"!=typeof obj||(obj=Object.keys(obj)),obj.forEach(cb))}var i,k,x,optionKeys,newOptionObj={},newIgnoredObj={};if(o=_.clone(o),state.reset(),o&&o.scope?JSHINT.scope=o.scope:(JSHINT.errors=[],JSHINT.undefs=[],JSHINT.internals=[],JSHINT.blacklist={},JSHINT.scope="(main)"),predefined=Object.create(null),combine(predefined,vars.ecmaIdentifiers),combine(predefined,vars.reservedVars),combine(predefined,g||{}),declared=Object.create(null),exported=Object.create(null),o)for(each(o.predef||null,function(item){var slice,prop;"-"===item[0]?(slice=item.slice(1),JSHINT.blacklist[slice]=slice):(prop=Object.getOwnPropertyDescriptor(o.predef,item),predefined[item]=prop?prop.value:!1)}),each(o.exported||null,function(item){exported[item]=!0}),delete o.predef,delete o.exported,optionKeys=Object.keys(o),x=0;optionKeys.length>x;x++)/^-W\\d{3}$/g.test(optionKeys[x])?newIgnoredObj[optionKeys[x].slice(1)]=!0:(newOptionObj[optionKeys[x]]=o[optionKeys[x]],"newcap"===optionKeys[x]&&o[optionKeys[x]]===!1&&(newOptionObj["(explicitNewcap)"]=!0));if(state.option=newOptionObj,state.ignored=newIgnoredObj,state.option.indent=state.option.indent||4,state.option.maxerr=state.option.maxerr||50,indent=1,global=Object.create(predefined),scope=global,funct=functor("(global)",null,scope,{"(global)":!0,"(blockscope)":blockScope(),"(comparray)":arrayComprehension(),"(metrics)":createMetrics(state.tokens.next)}),functions=[funct],urls=[],stack=null,member={},membersOnly=null,implied={},inblock=!1,lookahead=[],unuseds=[],!isString(s)&&!Array.isArray(s))return errorAt("E004",0),!1;api={get isJSON(){return state.jsonMode},getOption:function(name){return state.option[name]||null},getCache:function(name){return state.cache[name]},setCache:function(name,value){state.cache[name]=value},warn:function(code,data){warningAt.apply(null,[code,data.line,data.char].concat(data.data))},on:function(names,listener){names.split(" ").forEach(function(name){emitter.on(name,listener)}.bind(this))}},emitter.removeAllListeners(),(extraModules||[]).forEach(function(func){func(api)}),state.tokens.prev=state.tokens.curr=state.tokens.next=state.syntax["(begin)"],lex=new Lexer(s),lex.on("warning",function(ev){warningAt.apply(null,[ev.code,ev.line,ev.character].concat(ev.data))}),lex.on("error",function(ev){errorAt.apply(null,[ev.code,ev.line,ev.character].concat(ev.data))}),lex.on("fatal",function(ev){quit("E041",ev.line,ev.from)}),lex.on("Identifier",function(ev){emitter.emit("Identifier",ev)}),lex.on("String",function(ev){emitter.emit("String",ev)}),lex.on("Number",function(ev){emitter.emit("Number",ev)}),lex.start();for(var name in o)_.has(o,name)&&checkOption(name,state.tokens.curr);assume(),combine(predefined,g||{}),comma.first=!0;try{switch(advance(),state.tokens.next.id){case"{":case"[":destructuringAssignOrJsonValue();break;default:directives(),state.directive["use strict"]&&(state.option.globalstrict||state.option.node||state.option.phantom||warning("W097",state.tokens.prev)),statements()}advance(state.tokens.next&&"."!==state.tokens.next.value?"(end)":void 0),funct["(blockscope)"].unstack();var markDefined=function(name,context){do{if("string"==typeof context[name])return"unused"===context[name]?context[name]="var":"unction"===context[name]&&(context[name]="closure"),!0;context=context["(context)"]}while(context);return!1},clearImplied=function(name,line){if(implied[name]){for(var newImplied=[],i=0;implied[name].length>i;i+=1)implied[name][i]!==line&&newImplied.push(implied[name][i]);0===newImplied.length?delete implied[name]:implied[name]=newImplied}},warnUnused=function(name,tkn,type,unused_opt){var line=tkn.line,chr=tkn.character;void 0===unused_opt&&(unused_opt=state.option.unused),unused_opt===!0&&(unused_opt="last-param");var warnable_types={vars:["var"],"last-param":["var","param"],strict:["var","param","last-param"]};unused_opt&&warnable_types[unused_opt]&&-1!==warnable_types[unused_opt].indexOf(type)&&warningAt("W098",line,chr,name),unuseds.push({name:name,line:line,character:chr})},checkUnused=function(func,key){var type=func[key],tkn=func["(tokens)"][key];"("!==key.charAt(0)&&("unused"===type||"unction"===type||"const"===type)&&(func["(params)"]&&-1!==func["(params)"].indexOf(key)||func["(global)"]&&_.has(exported,key)||("const"!==type||getprop(func,key,"unused"))&&warnUnused(key,tkn,"var"))};for(i=0;JSHINT.undefs.length>i;i+=1)k=JSHINT.undefs[i].slice(0),markDefined(k[2].value,k[0])?clearImplied(k[2].value,k[2].line):state.option.undef&&warning.apply(warning,k.slice(1));functions.forEach(function(func){if(func["(unusedOption)"]!==!1){for(var key in func)_.has(func,key)&&checkUnused(func,key);if(func["(params)"])for(var type,unused_opt,params=func["(params)"].slice(),param=params.pop();param;){if(type=func[param],unused_opt=func["(unusedOption)"]||state.option.unused,unused_opt=unused_opt===!0?"last-param":unused_opt,"undefined"===param)return;if("unused"===type||"unction"===type)warnUnused(param,func["(tokens)"][param],"param",func["(unusedOption)"]);else if("last-param"===unused_opt)return;param=params.pop()}}});for(var key in declared)!_.has(declared,key)||_.has(global,key)||_.has(exported,key)||warnUnused(key,declared[key],"var")}catch(err){if(!err||"JSHintError"!==err.name)throw err;var nt=state.tokens.next||{};JSHINT.errors.push({scope:"(main)",raw:err.raw,code:err.code,reason:err.message,line:err.line||nt.line,character:err.character||nt.from},null)}if("(main)"===JSHINT.scope)for(o=o||{},i=0;JSHINT.internals.length>i;i+=1)k=JSHINT.internals[i],o.scope=k.elem,itself(k.value,o,g);return 0===JSHINT.errors.length};return itself.addModule=function(func){extraModules.push(func)},itself.addModule(style.register),itself.data=function(){var fu,f,i,j,n,globals,data={functions:[],options:state.option},implieds=[],members=[];itself.errors.length&&(data.errors=itself.errors),state.jsonMode&&(data.json=!0);for(n in implied)_.has(implied,n)&&implieds.push({name:n,line:implied[n]});for(implieds.length>0&&(data.implieds=implieds),urls.length>0&&(data.urls=urls),globals=Object.keys(scope),globals.length>0&&(data.globals=globals),i=1;functions.length>i;i+=1){for(f=functions[i],fu={},j=0;functionicity.length>j;j+=1)fu[functionicity[j]]=[];for(j=0;functionicity.length>j;j+=1)0===fu[functionicity[j]].length&&delete fu[functionicity[j]];fu.name=f["(name)"],fu.param=f["(params)"],fu.line=f["(line)"],fu.character=f["(character)"],fu.last=f["(last)"],fu.lastcharacter=f["(lastcharacter)"],fu.metrics={complexity:f["(metrics)"].ComplexityCount,parameters:(f["(params)"]||[]).length,statements:f["(metrics)"].statementCount},data.functions.push(fu)}unuseds.length>0&&(data.unused=unuseds),members=[];for(n in member)if("number"==typeof member[n]){data.member=member;break}return data},itself.jshint=itself,itself}();"object"==typeof exports&&exports&&(exports.JSHINT=JSHINT)},{"./lex.js":4,"./messages.js":5,"./reg.js":6,"./state.js":7,"./style.js":8,"./vars.js":9,events:10,underscore:2}],4:[function(_dereq_,module,exports){"use strict";function asyncTrigger(){var _checks=[];return{push:function(fn){_checks.push(fn)},check:function(){for(var check=0;_checks.length>check;++check)_checks[check]();_checks.splice(0,_checks.length)}}}function Lexer(source){var lines=source;"string"==typeof lines&&(lines=lines.replace(/\\r\\n/g,"\\n").replace(/\\r/g,"\\n").split("\\n")),lines[0]&&"#!"===lines[0].substr(0,2)&&(-1!==lines[0].indexOf("node")&&(state.option.node=!0),lines[0]=""),this.emitter=new events.EventEmitter,this.source=source,this.setLines(lines),this.prereg=!0,this.line=0,this.char=1,this.from=1,this.input="",this.inComment=!1;for(var i=0;state.option.indent>i;i+=1)state.tab+=" "}var _=_dereq_("underscore"),events=_dereq_("events"),reg=_dereq_("./reg.js"),state=_dereq_("./state.js").state,unicodeData=_dereq_("../data/ascii-identifier-data.js"),asciiIdentifierStartTable=unicodeData.asciiIdentifierStartTable,asciiIdentifierPartTable=unicodeData.asciiIdentifierPartTable,Token={Identifier:1,Punctuator:2,NumericLiteral:3,StringLiteral:4,Comment:5,Keyword:6,NullLiteral:7,BooleanLiteral:8,RegExp:9,TemplateLiteral:10};Lexer.prototype={_lines:[],getLines:function(){return this._lines=state.lines,this._lines},setLines:function(val){this._lines=val,state.lines=this._lines},peek:function(i){return this.input.charAt(i||0)},skip:function(i){i=i||1,this.char+=i,this.input=this.input.slice(i)},on:function(names,listener){names.split(" ").forEach(function(name){this.emitter.on(name,listener)}.bind(this))},trigger:function(){this.emitter.emit.apply(this.emitter,Array.prototype.slice.call(arguments))},triggerAsync:function(type,args,checks,fn){checks.push(function(){fn()&&this.trigger(type,args)}.bind(this))},scanPunctuator:function(){var ch2,ch3,ch4,ch1=this.peek();switch(ch1){case".":if(/^[0-9]$/.test(this.peek(1)))return null;if("."===this.peek(1)&&"."===this.peek(2))return{type:Token.Punctuator,value:"..."};case"(":case")":case";":case",":case"{":case"}":case"[":case"]":case":":case"~":case"?":return{type:Token.Punctuator,value:ch1};case"#":return{type:Token.Punctuator,value:ch1};case"":return null}return ch2=this.peek(1),ch3=this.peek(2),ch4=this.peek(3),">"===ch1&&">"===ch2&&">"===ch3&&"="===ch4?{type:Token.Punctuator,value:">>>="}:"="===ch1&&"="===ch2&&"="===ch3?{type:Token.Punctuator,value:"==="}:"!"===ch1&&"="===ch2&&"="===ch3?{type:Token.Punctuator,value:"!=="}:">"===ch1&&">"===ch2&&">"===ch3?{type:Token.Punctuator,value:">>>"}:"<"===ch1&&"<"===ch2&&"="===ch3?{type:Token.Punctuator,value:"<<="}:">"===ch1&&">"===ch2&&"="===ch3?{type:Token.Punctuator,value:">>="}:"="===ch1&&">"===ch2?{type:Token.Punctuator,value:ch1+ch2}:ch1===ch2&&"+-<>&|".indexOf(ch1)>=0?{type:Token.Punctuator,value:ch1+ch2}:"<>=!+-*%&|^".indexOf(ch1)>=0?"="===ch2?{type:Token.Punctuator,value:ch1+ch2}:{type:Token.Punctuator,value:ch1}:"/"===ch1?"="===ch2&&/\\/=(?!(\\S*\\/[gim]?))/.test(this.input)?{type:Token.Punctuator,value:"/="}:{type:Token.Punctuator,value:"/"}:null},scanComments:function(){function commentToken(label,body,opt){var special=["jshint","jslint","members","member","globals","global","exported"],isSpecial=!1,value=label+body,commentType="plain";return opt=opt||{},opt.isMultiline&&(value+="*/"),special.forEach(function(str){if(!isSpecial&&("//"!==label||"jshint"===str)&&(body.substr(0,str.length)===str&&(isSpecial=!0,label+=str,body=body.substr(str.length)),isSpecial||" "!==body.charAt(0)||body.substr(1,str.length)!==str||(isSpecial=!0,label=label+" "+str,body=body.substr(str.length+1)),isSpecial))switch(str){case"member":commentType="members";break;case"global":commentType="globals";break;default:commentType=str}}),{type:Token.Comment,commentType:commentType,value:value,body:body,isSpecial:isSpecial,isMultiline:opt.isMultiline||!1,isMalformed:opt.isMalformed||!1}}var ch1=this.peek(),ch2=this.peek(1),rest=this.input.substr(2),startLine=this.line,startChar=this.char;if("*"===ch1&&"/"===ch2)return this.trigger("error",{code:"E018",line:startLine,character:startChar}),this.skip(2),null;if("/"!==ch1||"*"!==ch2&&"/"!==ch2)return null;if("/"===ch2)return this.skip(this.input.length),commentToken("//",rest);var body="";if("*"===ch2){for(this.inComment=!0,this.skip(2);"*"!==this.peek()||"/"!==this.peek(1);)if(""===this.peek()){if(body+="\\n",!this.nextLine())return this.trigger("error",{code:"E017",line:startLine,character:startChar}),this.inComment=!1,commentToken("/*",body,{isMultiline:!0,isMalformed:!0})}else body+=this.peek(),this.skip();return this.skip(2),this.inComment=!1,commentToken("/*",body,{isMultiline:!0})}},scanKeyword:function(){var result=/^[a-zA-Z_$][a-zA-Z0-9_$]*/.exec(this.input),keywords=["if","in","do","var","for","new","try","let","this","else","case","void","with","enum","while","break","catch","throw","const","yield","class","super","return","typeof","delete","switch","export","import","default","finally","extends","function","continue","debugger","instanceof"];return result&&keywords.indexOf(result[0])>=0?{type:Token.Keyword,value:result[0]}:null},scanIdentifier:function(){function isNonAsciiIdentifierStart(code){return code>256}function isNonAsciiIdentifierPart(code){return code>256}function isHexDigit(str){return/^[0-9a-fA-F]$/.test(str)}var type,char,id="",index=0,readUnicodeEscapeSequence=function(){if(index+=1,"u"!==this.peek(index))return null;var code,ch1=this.peek(index+1),ch2=this.peek(index+2),ch3=this.peek(index+3),ch4=this.peek(index+4);return isHexDigit(ch1)&&isHexDigit(ch2)&&isHexDigit(ch3)&&isHexDigit(ch4)?(code=parseInt(ch1+ch2+ch3+ch4,16),asciiIdentifierPartTable[code]||isNonAsciiIdentifierPart(code)?(index+=5,"\\\\u"+ch1+ch2+ch3+ch4):null):null\n}.bind(this),getIdentifierStart=function(){var chr=this.peek(index),code=chr.charCodeAt(0);return 92===code?readUnicodeEscapeSequence():128>code?asciiIdentifierStartTable[code]?(index+=1,chr):null:isNonAsciiIdentifierStart(code)?(index+=1,chr):null}.bind(this),getIdentifierPart=function(){var chr=this.peek(index),code=chr.charCodeAt(0);return 92===code?readUnicodeEscapeSequence():128>code?asciiIdentifierPartTable[code]?(index+=1,chr):null:isNonAsciiIdentifierPart(code)?(index+=1,chr):null}.bind(this);if(char=getIdentifierStart(),null===char)return null;for(id=char;char=getIdentifierPart(),null!==char;)id+=char;switch(id){case"true":case"false":type=Token.BooleanLiteral;break;case"null":type=Token.NullLiteral;break;default:type=Token.Identifier}return{type:type,value:id}},scanNumericLiteral:function(){function isDecimalDigit(str){return/^[0-9]$/.test(str)}function isOctalDigit(str){return/^[0-7]$/.test(str)}function isHexDigit(str){return/^[0-9a-fA-F]$/.test(str)}function isIdentifierStart(ch){return"$"===ch||"_"===ch||"\\\\"===ch||ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch}var bad,index=0,value="",length=this.input.length,char=this.peek(index);if("."!==char&&!isDecimalDigit(char))return null;if("."!==char){if(value=this.peek(index),index+=1,char=this.peek(index),"0"===value){if("x"===char||"X"===char){for(index+=1,value+=char;length>index&&(char=this.peek(index),isHexDigit(char));)value+=char,index+=1;return 2>=value.length?{type:Token.NumericLiteral,value:value,isMalformed:!0}:length>index&&(char=this.peek(index),isIdentifierStart(char))?null:{type:Token.NumericLiteral,value:value,base:16,isMalformed:!1}}if(isOctalDigit(char)){for(index+=1,value+=char,bad=!1;length>index;){if(char=this.peek(index),isDecimalDigit(char))bad=!0;else if(!isOctalDigit(char))break;value+=char,index+=1}return length>index&&(char=this.peek(index),isIdentifierStart(char))?null:{type:Token.NumericLiteral,value:value,base:8,isMalformed:!1}}isDecimalDigit(char)&&(index+=1,value+=char)}for(;length>index&&(char=this.peek(index),isDecimalDigit(char));)value+=char,index+=1}if("."===char)for(value+=char,index+=1;length>index&&(char=this.peek(index),isDecimalDigit(char));)value+=char,index+=1;if("e"===char||"E"===char){if(value+=char,index+=1,char=this.peek(index),("+"===char||"-"===char)&&(value+=this.peek(index),index+=1),char=this.peek(index),!isDecimalDigit(char))return null;for(value+=char,index+=1;length>index&&(char=this.peek(index),isDecimalDigit(char));)value+=char,index+=1}return length>index&&(char=this.peek(index),isIdentifierStart(char))?null:{type:Token.NumericLiteral,value:value,base:10,isMalformed:!isFinite(value)}},scanTemplateLiteral:function(){if(!state.option.esnext||"`"!==this.peek())return null;var startLine=this.line,startChar=this.char,jump=1,value="";for(this.skip();"`"!==this.peek();){for(;""===this.peek();){if(!this.nextLine())return this.trigger("error",{code:"E052",line:startLine,character:startChar}),{type:Token.TemplateLiteral,value:value,isUnclosed:!0};value+="\\n"}var char=this.peek();this.skip(jump),value+=char}return this.skip(),{type:Token.TemplateLiteral,value:value,isUnclosed:!1}},scanStringLiteral:function(checks){var quote=this.peek();if(\'"\'!==quote&&"\'"!==quote)return null;this.triggerAsync("warning",{code:"W108",line:this.line,character:this.char},checks,function(){return state.jsonMode&&\'"\'!==quote});var value="",startLine=this.line,startChar=this.char,allowNewLine=!1;this.skip();outer:for(;this.peek()!==quote;){for(;""===this.peek();){if(allowNewLine?(allowNewLine=!1,this.triggerAsync("warning",{code:"W043",line:this.line,character:this.char},checks,function(){return!state.option.multistr}),this.triggerAsync("warning",{code:"W042",line:this.line,character:this.char},checks,function(){return state.jsonMode&&state.option.multistr})):this.trigger("warning",{code:"W112",line:this.line,character:this.char}),!this.nextLine())return this.trigger("error",{code:"E029",line:startLine,character:startChar}),{type:Token.StringLiteral,value:value,isUnclosed:!0,quote:quote};if(this.peek()==quote)break outer}allowNewLine=!1;var char=this.peek(),jump=1;if(" ">char&&this.trigger("warning",{code:"W113",line:this.line,character:this.char,data:["<non-printable>"]}),"\\\\"===char)switch(this.skip(),char=this.peek()){case"\'":this.triggerAsync("warning",{code:"W114",line:this.line,character:this.char,data:["\\\\\'"]},checks,function(){return state.jsonMode});break;case"b":char="\\\\b";break;case"f":char="\\\\f";break;case"n":char="\\\\n";break;case"r":char="\\\\r";break;case"t":char="\\\\t";break;case"0":char="\\\\0";var n=parseInt(this.peek(1),10);this.triggerAsync("warning",{code:"W115",line:this.line,character:this.char},checks,function(){return n>=0&&7>=n&&state.directive["use strict"]});break;case"u":char=String.fromCharCode(parseInt(this.input.substr(1,4),16)),jump=5;break;case"v":this.triggerAsync("warning",{code:"W114",line:this.line,character:this.char,data:["\\\\v"]},checks,function(){return state.jsonMode}),char="\x0B";break;case"x":var x=parseInt(this.input.substr(1,2),16);this.triggerAsync("warning",{code:"W114",line:this.line,character:this.char,data:["\\\\x-"]},checks,function(){return state.jsonMode}),char=String.fromCharCode(x),jump=3;break;case"\\\\":char="\\\\\\\\";break;case\'"\':char=\'\\\\"\';break;case"/":break;case"":allowNewLine=!0,char="";break;case"!":if("<"===value.slice(value.length-2))break;default:this.trigger("warning",{code:"W044",line:this.line,character:this.char})}value+=char,this.skip(jump)}return this.skip(),{type:Token.StringLiteral,value:value,isUnclosed:!1,quote:quote}},scanRegExp:function(){var terminated,index=0,length=this.input.length,char=this.peek(),value=char,body="",flags=[],malformed=!1,isCharSet=!1,scanUnexpectedChars=function(){" ">char&&(malformed=!0,this.trigger("warning",{code:"W048",line:this.line,character:this.char})),"<"===char&&(malformed=!0,this.trigger("warning",{code:"W049",line:this.line,character:this.char,data:[char]}))}.bind(this);if(!this.prereg||"/"!==char)return null;for(index+=1,terminated=!1;length>index;)if(char=this.peek(index),value+=char,body+=char,isCharSet)"]"===char&&("\\\\"!==this.peek(index-1)||"\\\\"===this.peek(index-2))&&(isCharSet=!1),"\\\\"===char&&(index+=1,char=this.peek(index),body+=char,value+=char,scanUnexpectedChars()),index+=1;else{if("\\\\"===char){if(index+=1,char=this.peek(index),body+=char,value+=char,scanUnexpectedChars(),"/"===char){index+=1;continue}if("["===char){index+=1;continue}}if("["!==char){if("/"===char){body=body.substr(0,body.length-1),terminated=!0,index+=1;break}index+=1}else isCharSet=!0,index+=1}if(!terminated)return this.trigger("error",{code:"E015",line:this.line,character:this.from}),void this.trigger("fatal",{line:this.line,from:this.from});for(;length>index&&(char=this.peek(index),/[gim]/.test(char));)flags.push(char),value+=char,index+=1;try{RegExp(body,flags.join(""))}catch(err){malformed=!0,this.trigger("error",{code:"E016",line:this.line,character:this.char,data:[err.message]})}return{type:Token.RegExp,value:value,flags:flags,isMalformed:malformed}},scanNonBreakingSpaces:function(){return state.option.nonbsp?this.input.search(/(\\u00A0)/):-1},scanUnsafeChars:function(){return this.input.search(reg.unsafeChars)},next:function(checks){this.from=this.char;var start;if(/\\s/.test(this.peek()))for(start=this.char;/\\s/.test(this.peek());)this.from+=1,this.skip();var match=this.scanComments()||this.scanStringLiteral(checks)||this.scanTemplateLiteral();return match?match:(match=this.scanRegExp()||this.scanPunctuator()||this.scanKeyword()||this.scanIdentifier()||this.scanNumericLiteral(),match?(this.skip(match.value.length),match):null)},nextLine:function(){var char;if(this.line>=this.getLines().length)return!1;this.input=this.getLines()[this.line],this.line+=1,this.char=1,this.from=1;var inputTrimmed=this.input.trim(),startsWith=function(){return _.some(arguments,function(prefix){return 0===inputTrimmed.indexOf(prefix)})},endsWith=function(){return _.some(arguments,function(suffix){return-1!==inputTrimmed.indexOf(suffix,inputTrimmed.length-suffix.length)})};if(state.ignoreLinterErrors===!0&&(startsWith("/*","//")||endsWith("*/")||(this.input="")),char=this.scanNonBreakingSpaces(),char>=0&&this.trigger("warning",{code:"W125",line:this.line,character:char+1}),this.input=this.input.replace(/\\t/g,state.tab),char=this.scanUnsafeChars(),char>=0&&this.trigger("warning",{code:"W100",line:this.line,character:char}),state.option.maxlen&&state.option.maxlen<this.input.length){var inComment=this.inComment||startsWith.call(inputTrimmed,"//")||startsWith.call(inputTrimmed,"/*"),shouldTriggerError=!inComment||!reg.maxlenException.test(inputTrimmed);shouldTriggerError&&this.trigger("warning",{code:"W101",line:this.line,character:this.input.length})}return!0},start:function(){this.nextLine()},token:function(){function isReserved(token,isProperty){if(!token.reserved)return!1;var meta=token.meta;if(meta&&meta.isFutureReservedWord&&state.option.inES5()){if(!meta.es5)return!1;if(meta.strictOnly&&!state.option.strict&&!state.directive["use strict"])return!1;if(isProperty)return!1}return!0}for(var token,checks=asyncTrigger(),create=function(type,value,isProperty){var obj;if("(endline)"!==type&&"(end)"!==type&&(this.prereg=!1),"(punctuator)"===type){switch(value){case".":case")":case"~":case"#":case"]":this.prereg=!1;break;default:this.prereg=!0}obj=Object.create(state.syntax[value]||state.syntax["(error)"])}return"(identifier)"===type&&(("return"===value||"case"===value||"typeof"===value)&&(this.prereg=!0),_.has(state.syntax,value)&&(obj=Object.create(state.syntax[value]||state.syntax["(error)"]),isReserved(obj,isProperty&&"(identifier)"===type)||(obj=null))),obj||(obj=Object.create(state.syntax[type])),obj.identifier="(identifier)"===type,obj.type=obj.type||type,obj.value=value,obj.line=this.line,obj.character=this.char,obj.from=this.from,isProperty&&obj.identifier&&(obj.isProperty=isProperty),obj.check=checks.check,obj}.bind(this);;){if(!this.input.length)return create(this.nextLine()?"(endline)":"(end)","");if(token=this.next(checks))switch(token.type){case Token.StringLiteral:return this.triggerAsync("String",{line:this.line,"char":this.char,from:this.from,value:token.value,quote:token.quote},checks,function(){return!0}),create("(string)",token.value);case Token.TemplateLiteral:return this.trigger("Template",{line:this.line,"char":this.char,from:this.from,value:token.value}),create("(template)",token.value);case Token.Identifier:this.trigger("Identifier",{line:this.line,"char":this.char,from:this.form,name:token.value,isProperty:"."===state.tokens.curr.id});case Token.Keyword:case Token.NullLiteral:case Token.BooleanLiteral:return create("(identifier)",token.value,"."===state.tokens.curr.id);case Token.NumericLiteral:return token.isMalformed&&this.trigger("warning",{code:"W045",line:this.line,character:this.char,data:[token.value]}),this.triggerAsync("warning",{code:"W114",line:this.line,character:this.char,data:["0x-"]},checks,function(){return 16===token.base&&state.jsonMode}),this.triggerAsync("warning",{code:"W115",line:this.line,character:this.char},checks,function(){return state.directive["use strict"]&&8===token.base}),this.trigger("Number",{line:this.line,"char":this.char,from:this.from,value:token.value,base:token.base,isMalformed:token.malformed}),create("(number)",token.value);case Token.RegExp:return create("(regexp)",token.value);case Token.Comment:if(state.tokens.curr.comment=!0,token.isSpecial)return{id:"(comment)",value:token.value,body:token.body,type:token.commentType,isSpecial:token.isSpecial,line:this.line,character:this.char,from:this.from};break;case"":break;default:return create("(punctuator)",token.value)}else this.input.length&&(this.trigger("error",{code:"E024",line:this.line,character:this.char,data:[this.peek()]}),this.input="")}}},exports.Lexer=Lexer},{"../data/ascii-identifier-data.js":1,"./reg.js":6,"./state.js":7,events:10,underscore:2}],5:[function(_dereq_,module,exports){"use strict";var _=_dereq_("underscore"),errors={E001:"Bad option: \'{a}\'.",E002:"Bad option value.",E003:"Expected a JSON value.",E004:"Input is neither a string nor an array of strings.",E005:"Input is empty.",E006:"Unexpected early end of program.",E007:\'Missing "use strict" statement.\',E008:"Strict violation.",E009:"Option \'validthis\' can\'t be used in a global scope.",E010:"\'with\' is not allowed in strict mode.",E011:"const \'{a}\' has already been declared.",E012:"const \'{a}\' is initialized to \'undefined\'.",E013:"Attempting to override \'{a}\' which is a constant.",E014:"A regular expression literal can be confused with \'/=\'.",E015:"Unclosed regular expression.",E016:"Invalid regular expression.",E017:"Unclosed comment.",E018:"Unbegun comment.",E019:"Unmatched \'{a}\'.",E020:"Expected \'{a}\' to match \'{b}\' from line {c} and instead saw \'{d}\'.",E021:"Expected \'{a}\' and instead saw \'{b}\'.",E022:"Line breaking error \'{a}\'.",E023:"Missing \'{a}\'.",E024:"Unexpected \'{a}\'.",E025:"Missing \':\' on a case clause.",E026:"Missing \'}\' to match \'{\' from line {a}.",E027:"Missing \']\' to match \'[\' from line {a}.",E028:"Illegal comma.",E029:"Unclosed string.",E030:"Expected an identifier and instead saw \'{a}\'.",E031:"Bad assignment.",E032:"Expected a small integer or \'false\' and instead saw \'{a}\'.",E033:"Expected an operator and instead saw \'{a}\'.",E034:"get/set are ES5 features.",E035:"Missing property name.",E036:"Expected to see a statement and instead saw a block.",E037:null,E038:null,E039:"Function declarations are not invocable. Wrap the whole function invocation in parens.",E040:"Each value should have its own case label.",E041:"Unrecoverable syntax error.",E042:"Stopping.",E043:"Too many errors.",E044:null,E045:"Invalid for each loop.",E046:"A yield statement shall be within a generator function (with syntax: `function*`)",E047:null,E048:"Let declaration not directly within block.",E049:"A {a} cannot be named \'{b}\'.",E050:"Mozilla acequires the yield expression to be parenthesized here.",E051:"Regular parameters cannot come after default parameters.",E052:"Unclosed template literal."},warnings={W001:"\'hasOwnProperty\' is a really bad name.",W002:"Value of \'{a}\' may be overwritten in IE 8 and earlier.",W003:"\'{a}\' was used before it was defined.",W004:"\'{a}\' is already defined.",W005:"A dot following a number can be confused with a decimal point.",W006:"Confusing minuses.",W007:"Confusing plusses.",W008:"A leading decimal point can be confused with a dot: \'{a}\'.",W009:"The array literal notation [] is preferable.",W010:"The object literal notation {} is preferable.",W011:null,W012:null,W013:null,W014:"Bad line breaking before \'{a}\'.",W015:null,W016:"Unexpected use of \'{a}\'.",W017:"Bad operand.",W018:"Confusing use of \'{a}\'.",W019:"Use the isNaN function to compare with NaN.",W020:"Read only.",W021:"\'{a}\' is a function.",W022:"Do not assign to the exception parameter.",W023:"Expected an identifier in an assignment and instead saw a function invocation.",W024:"Expected an identifier and instead saw \'{a}\' (a reserved word).",W025:"Missing name in function declaration.",W026:"Inner functions should be listed at the top of the outer function.",W027:"Unreachable \'{a}\' after \'{b}\'.",W028:"Label \'{a}\' on {b} statement.",W030:"Expected an assignment or function call and instead saw an expression.",W031:"Do not use \'new\' for side effects.",W032:"Unnecessary semicolon.",W033:"Missing semicolon.",W034:\'Unnecessary directive "{a}".\',W035:"Empty block.",W036:"Unexpected /*member \'{a}\'.",W037:"\'{a}\' is a statement label.",W038:"\'{a}\' used out of scope.",W039:"\'{a}\' is not allowed.",W040:"Possible strict violation.",W041:"Use \'{a}\' to compare with \'{b}\'.",W042:"Avoid EOL escaping.",W043:"Bad escaping of EOL. Use option multistr if needed.",W044:"Bad or unnecessary escaping.",W045:"Bad number \'{a}\'.",W046:"Don\'t use extra leading zeros \'{a}\'.",W047:"A trailing decimal point can be confused with a dot: \'{a}\'.",W048:"Unexpected control character in regular expression.",W049:"Unexpected escaped character \'{a}\' in regular expression.",W050:"JavaScript URL.",W051:"Variables should not be deleted.",W052:"Unexpected \'{a}\'.",W053:"Do not use {a} as a constructor.",W054:"The Function constructor is a form of eval.",W055:"A constructor name should start with an uppercase letter.",W056:"Bad constructor.",W057:"Weird construction. Is \'new\' necessary?",W058:"Missing \'()\' invoking a constructor.",W059:"Avoid arguments.{a}.",W060:"document.write can be a form of eval.",W061:"eval can be harmful.",W062:"Wrap an immediate function invocation in parens to assist the reader in understanding that the expression is the result of a function, and not the function itself.",W063:"Math is not a function.",W064:"Missing \'new\' prefix when invoking a constructor.",W065:"Missing radix parameter.",W066:"Implied eval. Consider passing a function instead of a string.",W067:"Bad invocation.",W068:"Wrapping non-IIFE function literals in parens is unnecessary.",W069:"[\'{a}\'] is better written in dot notation.",W070:"Extra comma. (it breaks older versions of IE)",W071:"This function has too many statements. ({a})",W072:"This function has too many parameters. ({a})",W073:"Blocks are nested too deeply. ({a})",W074:"This function\'s cyclomatic complexity is too high. ({a})",W075:"Duplicate key \'{a}\'.",W076:"Unexpected parameter \'{a}\' in get {b} function.",W077:"Expected a single parameter in set {a} function.",W078:"Setter is defined without getter.",W079:"Redefinition of \'{a}\'.",W080:"It\'s not necessary to initialize \'{a}\' to \'undefined\'.",W081:null,W082:"Function declarations should not be placed in blocks. Use a function expression or move the statement to the top of the outer function.",W083:"Don\'t make functions within a loop.",W084:"Assignment in conditional expression",W085:"Don\'t use \'with\'.",W086:"Expected a \'break\' statement before \'{a}\'.",W087:"Forgotten \'debugger\' statement?",W088:"Creating global \'for\' variable. Should be \'for (var {a} ...\'.",W089:"The body of a for in should be wrapped in an if statement to filter unwanted properties from the prototype.",W090:"\'{a}\' is not a statement label.",W091:"\'{a}\' is out of scope.",W093:"Did you mean to return a conditional instead of an assignment?",W094:"Unexpected comma.",W095:"Expected a string and instead saw {a}.",W096:"The \'{a}\' key may produce unexpected results.",W097:\'Use the function form of "use strict".\',W098:"\'{a}\' is defined but never used.",W099:null,W100:"This character may get silently deleted by one or more browsers.",W101:"Line is too long.",W102:null,W103:"The \'{a}\' property is deprecated.",W104:"\'{a}\' is available in ES6 (use esnext option) or Mozilla JS extensions (use moz).",W105:"Unexpected {a} in \'{b}\'.",W106:"Identifier \'{a}\' is not in camel case.",W107:"Script URL.",W108:"Strings must use doublequote.",W109:"Strings must use singlequote.",W110:"Mixed double and single quotes.",W112:"Unclosed string.",W113:"Control character in string: {a}.",W114:"Avoid {a}.",W115:"Octal literals are not allowed in strict mode.",W116:"Expected \'{a}\' and instead saw \'{b}\'.",W117:"\'{a}\' is not defined.",W118:"\'{a}\' is only available in Mozilla JavaScript extensions (use moz option).",W119:"\'{a}\' is only available in ES6 (use esnext option).",W120:"You might be leaking a variable ({a}) here.",W121:"Extending prototype of native object: \'{a}\'.",W122:"Invalid typeof value \'{a}\'",W123:"\'{a}\' is already defined in outer scope.",W124:"A generator function shall contain a yield statement.",W125:"This line contains non-breaking spaces: http://jshint.com/doc/options/#nonbsp"},info={I001:"Comma warnings can be turned off with \'laxcomma\'.",I002:null,I003:"ES5 option is now set per default"};exports.errors={},exports.warnings={},exports.info={},_.each(errors,function(desc,code){exports.errors[code]={code:code,desc:desc}}),_.each(warnings,function(desc,code){exports.warnings[code]={code:code,desc:desc}}),_.each(info,function(desc,code){exports.info[code]={code:code,desc:desc}})},{underscore:2}],6:[function(_dereq_,module,exports){"use string";exports.unsafeString=/@cc|<\\/?|script|\\]\\s*\\]|<\\s*!|&lt/i,exports.unsafeChars=/[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/,exports.needEsc=/[\\u0000-\\u001f&<"\\/\\\\\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/,exports.needEscGlobal=/[\\u0000-\\u001f&<"\\/\\\\\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,exports.starSlash=/\\*\\//,exports.identifier=/^([a-zA-Z_$][a-zA-Z0-9_$]*)$/,exports.javascriptURL=/^(?:javascript|jscript|ecmascript|vbscript|livescript)\\s*:/i,exports.fallsThrough=/^\\s*\\/\\*\\s*falls?\\sthrough\\s*\\*\\/\\s*$/,exports.maxlenException=/^(?:(?:\\/\\/|\\/\\*|\\*) ?)?[^ ]+$/},{}],7:[function(_dereq_,module,exports){"use strict";var state={syntax:{},reset:function(){this.tokens={prev:null,next:null,curr:null},this.option={},this.ignored={},this.directive={},this.jsonMode=!1,this.jsonWarnings=[],this.lines=[],this.tab="",this.cache={},this.ignoredLines={},this.ignoreLinterErrors=!1}};exports.state=state},{}],8:[function(_dereq_,module,exports){"use strict";exports.register=function(linter){linter.on("Identifier",function(data){linter.getOption("proto")||"__proto__"===data.name&&linter.warn("W103",{line:data.line,"char":data.char,data:[data.name]})}),linter.on("Identifier",function(data){linter.getOption("iterator")||"__iterator__"===data.name&&linter.warn("W104",{line:data.line,"char":data.char,data:[data.name]})}),linter.on("Identifier",function(data){linter.getOption("camelcase")&&data.name.replace(/^_+|_+$/g,"").indexOf("_")>-1&&!data.name.match(/^[A-Z0-9_]*$/)&&linter.warn("W106",{line:data.line,"char":data.from,data:[data.name]})}),linter.on("String",function(data){var code,quotmark=linter.getOption("quotmark");quotmark&&("single"===quotmark&&"\'"!==data.quote&&(code="W109"),"double"===quotmark&&\'"\'!==data.quote&&(code="W108"),quotmark===!0&&(linter.getCache("quotmark")||linter.setCache("quotmark",data.quote),linter.getCache("quotmark")!==data.quote&&(code="W110")),code&&linter.warn(code,{line:data.line,"char":data.char}))}),linter.on("Number",function(data){"."===data.value.charAt(0)&&linter.warn("W008",{line:data.line,"char":data.char,data:[data.value]}),"."===data.value.substr(data.value.length-1)&&linter.warn("W047",{line:data.line,"char":data.char,data:[data.value]}),/^00+/.test(data.value)&&linter.warn("W046",{line:data.line,"char":data.char,data:[data.value]})}),linter.on("String",function(data){var re=/^(?:javascript|jscript|ecmascript|vbscript|livescript)\\s*:/i;linter.getOption("scripturl")||re.test(data.value)&&linter.warn("W107",{line:data.line,"char":data.char})})}},{}],9:[function(_dereq_,module,exports){"use strict";exports.reservedVars={arguments:!1,NaN:!1},exports.ecmaIdentifiers={Array:!1,Boolean:!1,Date:!1,decodeURI:!1,decodeURIComponent:!1,encodeURI:!1,encodeURIComponent:!1,Error:!1,eval:!1,EvalError:!1,Function:!1,hasOwnProperty:!1,isFinite:!1,isNaN:!1,JSON:!1,Math:!1,Number:!1,Object:!1,parseInt:!1,parseFloat:!1,RangeError:!1,ReferenceError:!1,RegExp:!1,String:!1,SyntaxError:!1,TypeError:!1,URIError:!1},exports.newEcmaIdentifiers={Set:!1,Map:!1,WeakMap:!1,WeakSet:!1,Proxy:!1,Promise:!1},exports.browser={Audio:!1,Blob:!1,addEventListener:!1,applicationCache:!1,atob:!1,blur:!1,btoa:!1,CanvasGradient:!1,CanvasPattern:!1,CanvasRenderingContext2D:!1,clearInterval:!1,clearTimeout:!1,close:!1,closed:!1,CustomEvent:!1,DOMParser:!1,defaultStatus:!1,document:!1,Element:!1,ElementTimeControl:!1,event:!1,FileReader:!1,FormData:!1,focus:!1,frames:!1,getComputedStyle:!1,HTMLElement:!1,HTMLAnchorElement:!1,HTMLBaseElement:!1,HTMLBlockquoteElement:!1,HTMLBodyElement:!1,HTMLBRElement:!1,HTMLButtonElement:!1,HTMLCanvasElement:!1,HTMLDirectoryElement:!1,HTMLDivElement:!1,HTMLDListElement:!1,HTMLFieldSetElement:!1,HTMLFontElement:!1,HTMLFormElement:!1,HTMLFrameElement:!1,HTMLFrameSetElement:!1,HTMLHeadElement:!1,HTMLHeadingElement:!1,HTMLHRElement:!1,HTMLHtmlElement:!1,HTMLIFrameElement:!1,HTMLImageElement:!1,HTMLInputElement:!1,HTMLIsIndexElement:!1,HTMLLabelElement:!1,HTMLLayerElement:!1,HTMLLegendElement:!1,HTMLLIElement:!1,HTMLLinkElement:!1,HTMLMapElement:!1,HTMLMenuElement:!1,HTMLMetaElement:!1,HTMLModElement:!1,HTMLObjectElement:!1,HTMLOListElement:!1,HTMLOptGroupElement:!1,HTMLOptionElement:!1,HTMLParagraphElement:!1,HTMLParamElement:!1,HTMLPreElement:!1,HTMLQuoteElement:!1,HTMLScriptElement:!1,HTMLSelectElement:!1,HTMLStyleElement:!1,HTMLTableCaptionElement:!1,HTMLTableCellElement:!1,HTMLTableColElement:!1,HTMLTableElement:!1,HTMLTableRowElement:!1,HTMLTableSectionElement:!1,HTMLTextAreaElement:!1,HTMLTitleElement:!1,HTMLUListElement:!1,HTMLVideoElement:!1,history:!1,Image:!1,length:!1,localStorage:!1,location:!1,matchMedia:!1,MessageChannel:!1,MessageEvent:!1,MessagePort:!1,MouseEvent:!1,moveBy:!1,moveTo:!1,MutationObserver:!1,name:!1,Node:!1,NodeFilter:!1,NodeList:!1,navigator:!1,onbeforeunload:!0,onblur:!0,onerror:!0,onfocus:!0,onload:!0,onresize:!0,onunload:!0,open:!1,openDatabase:!1,opener:!1,Option:!1,parent:!1,print:!1,removeEventListener:!1,resizeBy:!1,resizeTo:!1,screen:!1,scroll:!1,scrollBy:!1,scrollTo:!1,sessionStorage:!1,setInterval:!1,setTimeout:!1,SharedWorker:!1,status:!1,SVGAElement:!1,SVGAltGlyphDefElement:!1,SVGAltGlyphElement:!1,SVGAltGlyphItemElement:!1,SVGAngle:!1,SVGAnimateColorElement:!1,SVGAnimateElement:!1,SVGAnimateMotionElement:!1,SVGAnimateTransformElement:!1,SVGAnimatedAngle:!1,SVGAnimatedBoolean:!1,SVGAnimatedEnumeration:!1,SVGAnimatedInteger:!1,SVGAnimatedLength:!1,SVGAnimatedLengthList:!1,SVGAnimatedNumber:!1,SVGAnimatedNumberList:!1,SVGAnimatedPathData:!1,SVGAnimatedPoints:!1,SVGAnimatedPreserveAspectRatio:!1,SVGAnimatedRect:!1,SVGAnimatedString:!1,SVGAnimatedTransformList:!1,SVGAnimationElement:!1,SVGCSSRule:!1,SVGCircleElement:!1,SVGClipPathElement:!1,SVGColor:!1,SVGColorProfileElement:!1,SVGColorProfileRule:!1,SVGComponentTransferFunctionElement:!1,SVGCursorElement:!1,SVGDefsElement:!1,SVGDescElement:!1,SVGDocument:!1,SVGElement:!1,SVGElementInstance:!1,SVGElementInstanceList:!1,SVGEllipseElement:!1,SVGExternalResourcesRequired:!1,SVGFEBlendElement:!1,SVGFEColorMatrixElement:!1,SVGFEComponentTransferElement:!1,SVGFECompositeElement:!1,SVGFEConvolveMatrixElement:!1,SVGFEDiffuseLightingElement:!1,SVGFEDisplacementMapElement:!1,SVGFEDistantLightElement:!1,SVGFEFloodElement:!1,SVGFEFuncAElement:!1,SVGFEFuncBElement:!1,SVGFEFuncGElement:!1,SVGFEFuncRElement:!1,SVGFEGaussianBlurElement:!1,SVGFEImageElement:!1,SVGFEMergeElement:!1,SVGFEMergeNodeElement:!1,SVGFEMorphologyElement:!1,SVGFEOffsetElement:!1,SVGFEPointLightElement:!1,SVGFESpecularLightingElement:!1,SVGFESpotLightElement:!1,SVGFETileElement:!1,SVGFETurbulenceElement:!1,SVGFilterElement:!1,SVGFilterPrimitiveStandardAttributes:!1,SVGFitToViewBox:!1,SVGFontElement:!1,SVGFontFaceElement:!1,SVGFontFaceFormatElement:!1,SVGFontFaceNameElement:!1,SVGFontFaceSrcElement:!1,SVGFontFaceUriElement:!1,SVGForeignObjectElement:!1,SVGGElement:!1,SVGGlyphElement:!1,SVGGlyphRefElement:!1,SVGGradientElement:!1,SVGHKernElement:!1,SVGICCColor:!1,SVGImageElement:!1,SVGLangSpace:!1,SVGLength:!1,SVGLengthList:!1,SVGLineElement:!1,SVGLinearGradientElement:!1,SVGLocatable:!1,SVGMPathElement:!1,SVGMarkerElement:!1,SVGMaskElement:!1,SVGMatrix:!1,SVGMetadataElement:!1,SVGMissingGlyphElement:!1,SVGNumber:!1,SVGNumberList:!1,SVGPaint:!1,SVGPathElement:!1,SVGPathSeg:!1,SVGPathSegArcAbs:!1,SVGPathSegArcRel:!1,SVGPathSegClosePath:!1,SVGPathSegCurvetoCubicAbs:!1,SVGPathSegCurvetoCubicRel:!1,SVGPathSegCurvetoCubicSmoothAbs:!1,SVGPathSegCurvetoCubicSmoothRel:!1,SVGPathSegCurvetoQuadraticAbs:!1,SVGPathSegCurvetoQuadraticRel:!1,SVGPathSegCurvetoQuadraticSmoothAbs:!1,SVGPathSegCurvetoQuadraticSmoothRel:!1,SVGPathSegLinetoAbs:!1,SVGPathSegLinetoHorizontalAbs:!1,SVGPathSegLinetoHorizontalRel:!1,SVGPathSegLinetoRel:!1,SVGPathSegLinetoVerticalAbs:!1,SVGPathSegLinetoVerticalRel:!1,SVGPathSegList:!1,SVGPathSegMovetoAbs:!1,SVGPathSegMovetoRel:!1,SVGPatternElement:!1,SVGPoint:!1,SVGPointList:!1,SVGPolygonElement:!1,SVGPolylineElement:!1,SVGPreserveAspectRatio:!1,SVGRadialGradientElement:!1,SVGRect:!1,SVGRectElement:!1,SVGRenderingIntent:!1,SVGSVGElement:!1,SVGScriptElement:!1,SVGSetElement:!1,SVGStopElement:!1,SVGStringList:!1,SVGStylable:!1,SVGStyleElement:!1,SVGSwitchElement:!1,SVGSymbolElement:!1,SVGTRefElement:!1,SVGTSpanElement:!1,SVGTests:!1,SVGTextContentElement:!1,SVGTextElement:!1,SVGTextPathElement:!1,SVGTextPositioningElement:!1,SVGTitleElement:!1,SVGTransform:!1,SVGTransformList:!1,SVGTransformable:!1,SVGURIReference:!1,SVGUnitTypes:!1,SVGUseElement:!1,SVGVKernElement:!1,SVGViewElement:!1,SVGViewSpec:!1,SVGZoomAndPan:!1,TimeEvent:!1,top:!1,URL:!1,WebSocket:!1,window:!1,Worker:!1,XMLHttpRequest:!1,XMLSerializer:!1,XPathEvaluator:!1,XPathException:!1,XPathExpression:!1,XPathNamespace:!1,XPathNSResolver:!1,XPathResult:!1},exports.devel={alert:!1,confirm:!1,console:!1,Debug:!1,opera:!1,prompt:!1},exports.worker={importScripts:!0,postMessage:!0,self:!0},exports.nonstandard={escape:!1,unescape:!1},exports.couch={require:!1,respond:!1,getRow:!1,emit:!1,send:!1,start:!1,sum:!1,log:!1,exports:!1,module:!1,provides:!1},exports.node={__filename:!1,__dirname:!1,GLOBAL:!1,global:!1,module:!1,acequire:!1,Buffer:!0,console:!0,exports:!0,process:!0,setTimeout:!0,clearTimeout:!0,setInterval:!0,clearInterval:!0,setImmediate:!0,clearImmediate:!0},exports.phantom={phantom:!0,acequire:!0,WebPage:!0,console:!0,exports:!0},exports.qunit={asyncTest:!1,deepEqual:!1,equal:!1,expect:!1,module:!1,notDeepEqual:!1,notEqual:!1,notPropEqual:!1,notStrictEqual:!1,ok:!1,propEqual:!1,QUnit:!1,raises:!1,start:!1,stop:!1,strictEqual:!1,test:!1,"throws":!1},exports.rhino={defineClass:!1,deserialize:!1,gc:!1,help:!1,importClass:!1,importPackage:!1,java:!1,load:!1,loadClass:!1,Packages:!1,print:!1,quit:!1,readFile:!1,readUrl:!1,runCommand:!1,seal:!1,serialize:!1,spawn:!1,sync:!1,toint32:!1,version:!1},exports.shelljs={target:!1,echo:!1,exit:!1,cd:!1,pwd:!1,ls:!1,find:!1,cp:!1,rm:!1,mv:!1,mkdir:!1,test:!1,cat:!1,sed:!1,grep:!1,which:!1,dirs:!1,pushd:!1,popd:!1,env:!1,exec:!1,chmod:!1,config:!1,error:!1,tempdir:!1},exports.typed={ArrayBuffer:!1,ArrayBufferView:!1,DataView:!1,Float32Array:!1,Float64Array:!1,Int16Array:!1,Int32Array:!1,Int8Array:!1,Uint16Array:!1,Uint32Array:!1,Uint8Array:!1,Uint8ClampedArray:!1},exports.wsh={ActiveXObject:!0,Enumerator:!0,GetObject:!0,ScriptEngine:!0,ScriptEngineBuildVersion:!0,ScriptEngineMajorVersion:!0,ScriptEngineMinorVersion:!0,VBArray:!0,WSH:!0,WScript:!0,XDomainRequest:!0},exports.dojo={dojo:!1,dijit:!1,dojox:!1,define:!1,require:!1},exports.jquery={$:!1,jQuery:!1},exports.mootools={$:!1,$$:!1,Asset:!1,Browser:!1,Chain:!1,Class:!1,Color:!1,Cookie:!1,Core:!1,Document:!1,DomReady:!1,DOMEvent:!1,DOMReady:!1,Drag:!1,Element:!1,Elements:!1,Event:!1,Events:!1,Fx:!1,Group:!1,Hash:!1,HtmlTable:!1,IFrame:!1,IframeShim:!1,InputValidator:!1,instanceOf:!1,Keyboard:!1,Locale:!1,Mask:!1,MooTools:!1,Native:!1,Options:!1,OverText:!1,Request:!1,Scroller:!1,Slick:!1,Slider:!1,Sortables:!1,Spinner:!1,Swiff:!1,Tips:!1,Type:!1,typeOf:!1,URI:!1,Window:!1},exports.prototypejs={$:!1,$$:!1,$A:!1,$F:!1,$H:!1,$R:!1,$break:!1,$continue:!1,$w:!1,Abstract:!1,Ajax:!1,Class:!1,Enumerable:!1,Element:!1,Event:!1,Field:!1,Form:!1,Hash:!1,Insertion:!1,ObjectRange:!1,PeriodicalExecuter:!1,Position:!1,Prototype:!1,Selector:!1,Template:!1,Toggle:!1,Try:!1,Autocompleter:!1,Builder:!1,Control:!1,Draggable:!1,Draggables:!1,Droppables:!1,Effect:!1,Sortable:!1,SortableObserver:!1,Sound:!1,Scriptaculous:!1},exports.yui={YUI:!1,Y:!1,YUI_config:!1},exports.mocha={describe:!1,it:!1,before:!1,after:!1,beforeEach:!1,afterEach:!1,suite:!1,test:!1,setup:!1,teardown:!1},exports.jasmine={jasmine:!1,describe:!1,it:!1,xit:!1,beforeEach:!1,afterEach:!1,setFixtures:!1,loadFixtures:!1,spyOn:!1,expect:!1,runs:!1,waitsFor:!1,waits:!1}},{}],10:[function(_dereq_,module){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0\n}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||0>n||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length))throw er=arguments[1],er instanceof Error?er:TypeError(\'Uncaught, unspecified "error" event.\');if(handler=this._events[type],isUndefined(handler))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:for(len=arguments.length,args=Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];handler.apply(this,args)}else if(isObject(handler)){for(len=arguments.length,args=Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];for(listeners=handler.slice(),len=listeners.length,i=0;len>i;i++)listeners[i].apply(this,args)}return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned){var m;m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,m&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(list=this._events[type],length=list.length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-->0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(0>position)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(listeners=this._events[type],isFunction(listeners))this.removeListener(type,listeners);else for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){var ret;return ret=this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.listenerCount=function(emitter,type){var ret;return ret=emitter._events&&emitter._events[type]?isFunction(emitter._events[type])?1:emitter._events[type].length:0}},{}]},{},[3])(3)}),ace.define("ace/mode/javascript_worker",["require","exports","module","ace/lib/oop","ace/worker/mirror","ace/mode/javascript/jshint"],function(acequire,exports,module){"use strict";function startRegex(arr){return RegExp("^("+arr.join("|")+")")}var oop=acequire("../lib/oop"),Mirror=acequire("../worker/mirror").Mirror,lint=acequire("./javascript/jshint").JSHINT,disabledWarningsRe=startRegex(["Bad for in variable \'(.+)\'.",\'Missing "use strict"\']),errorsRe=startRegex(["Unexpected","Expected ","Confusing (plus|minus)","\\\\{a\\\\} unterminated regular expression","Unclosed ","Unmatched ","Unbegun comment","Bad invocation","Missing space after","Missing operator at"]),infoRe=startRegex(["Expected an assignment","Bad escapement of EOL","Unexpected comma","Unexpected space","Missing radix parameter.","A leading decimal point can","\\\\[\'{a}\'\\\\] is better written in dot notation.","\'{a}\' used out of scope"]),JavaScriptWorker=exports.JavaScriptWorker=function(sender){Mirror.call(this,sender),this.setTimeout(500),this.setOptions()};oop.inherits(JavaScriptWorker,Mirror),function(){this.setOptions=function(options){this.options=options||{esnext:!0,moz:!0,devel:!0,browser:!0,node:!0,laxcomma:!0,laxbreak:!0,lastsemic:!0,onevar:!1,passfail:!1,maxerr:100,expr:!0,multistr:!0,globalstrict:!0},this.doc.getValue()&&this.deferredUpdate.schedule(100)},this.changeOptions=function(newOptions){oop.mixin(this.options,newOptions),this.doc.getValue()&&this.deferredUpdate.schedule(100)},this.isValidJS=function(str){try{eval("throw 0;"+str)}catch(e){if(0===e)return!0}return!1},this.onUpdate=function(){var value=this.doc.getValue();if(value=value.replace(/^#!.*\\n/,"\\n"),!value)return this.sender.emit("jslint",[]),void 0;var errors=[],maxErrorLevel=this.isValidJS(value)?"warning":"error";lint(value,this.options);for(var results=lint.errors,errorAdded=!1,i=0;results.length>i;i++){var error=results[i];if(error){var raw=error.raw,type="warning";if("Missing semicolon."==raw){var str=error.evidence.substr(error.character);str=str.charAt(str.search(/\\S/)),"error"==maxErrorLevel&&str&&/[\\w\\d{([\'"]/.test(str)?(error.reason=\'Missing ";" before statement\',type="error"):type="info"}else{if(disabledWarningsRe.test(raw))continue;infoRe.test(raw)?type="info":errorsRe.test(raw)?(errorAdded=!0,type=maxErrorLevel):"\'{a}\' is not defined."==raw?type="warning":"\'{a}\' is defined but never used."==raw&&(type="info")}errors.push({row:error.line-1,column:error.character-1,text:error.reason,type:type,raw:raw})}}this.sender.emit("jslint",errors)}}.call(JavaScriptWorker.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function Empty(){}function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}function toInteger(n){return n=+n,n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];return array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),lengthBefore+1==array.length,lengthBefore+1==array.length?!0:void 0}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):void 0==pos?pos=0:0>pos&&(pos=Math.max(length+pos,0)),length>pos+removeCount||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailOldPos>tailNewPos)for(var i=0;tailCount>i;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;add>i;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;length>++i;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT+object);if(owns(object,property)){var descriptor,getter,setter;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),!Object.create){var createEmpty;createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != \'object\'");var Type=function(){};Type.prototype=prototype,object=new Type,object.__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ",ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: ",ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT_TARGET+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=function(freezeObject){return function(object){return"function"==typeof object?object:freezeObject(object)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;ii>i;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="	\\n\x0B\\f\\r \\u2028\\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=RegExp("^"+ws+ws+"*"),trimEndRegexp=RegExp(ws+ws+"*$");String.prototype.trim=function(){return(this+"").replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}var toObject=function(o){if(null==o)throw new TypeError("can\'t convert "+o+" to object");return Object(o)}});';
},function(e,t){e.exports.id="ace/mode/css_worker",e.exports.src='"no use strict";(function(window){if(void 0===window.window||!window.document){window.console=function(){var msgs=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:msgs})},window.console.error=window.console.warn=window.console.log=window.console.trace=window.console,window.window=window,window.ace=window,window.onerror=function(message,file,line,col,err){console.error("Worker "+(err?err.stack:message))},window.normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return window.normalizeModule(parentId,chunks[0])+"!"+window.normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0)){var base=parentId.split("/").slice(0,-1).join("/");for(moduleName=(base?base+"/":"")+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/^\\.\\//,"").replace(/\\/\\.\\//,"/").replace(/[^\\/]+\\/\\.\\.\\//,"")}}return moduleName},window.acequire=function(parentId,id){if(id||(id=parentId,parentId=null),!id.charAt)throw Error("worker.js acequire() accepts only (parentId, id) as arguments");id=window.normalizeModule(parentId,id);var module=window.acequire.modules[id];if(module)return module.initialized||(module.initialized=!0,module.exports=module.factory().exports),module.exports;var chunks=id.split("/");if(!window.acequire.tlns)return console.log("unable to load "+id);chunks[0]=window.acequire.tlns[chunks[0]]||chunks[0];var path=chunks.join("/")+".js";return window.acequire.id=id,importScripts(path),window.acequire(parentId,id)},window.acequire.modules={},window.acequire.tlns={},window.define=function(id,deps,factory){if(2==arguments.length?(factory=deps,"string"!=typeof id&&(deps=id,id=window.acequire.id)):1==arguments.length&&(factory=id,deps=[],id=window.acequire.id),deps.length||(deps=["require","exports","module"]),0!==id.indexOf("text!")){var req=function(childId){return window.acequire(id,childId)};window.acequire.modules[id]={exports:{},factory:function(){var module=this,returnExports=factory.apply(this,deps.map(function(dep){switch(dep){case"require":return req;case"exports":return module.exports;case"module":return module;default:return req(dep)}}));return returnExports&&(module.exports=returnExports),module}}}},window.define.amd={},window.initBaseUrls=function initBaseUrls(topLevelNamespaces){acequire.tlns=topLevelNamespaces},window.initSender=function initSender(){var EventEmitter=window.acequire("ace/lib/event_emitter").EventEmitter,oop=window.acequire("ace/lib/oop"),Sender=function(){};return function(){oop.implement(this,EventEmitter),this.callback=function(data,callbackId){postMessage({type:"call",id:callbackId,data:data})},this.emit=function(name,data){postMessage({type:"event",name:name,data:data})}}.call(Sender.prototype),new Sender};var main=window.main=null,sender=window.sender=null;window.onmessage=function(e){var msg=e.data;if(msg.command){if(!main[msg.command])throw Error("Unknown command:"+msg.command);main[msg.command].apply(main,msg.args)}else if(msg.init){initBaseUrls(msg.tlns),acequire("ace/lib/es5-shim"),sender=window.sender=initSender();var clazz=acequire(msg.module)[msg.classname];main=window.main=new clazz(sender)}else msg.event&&sender&&sender._signal(msg.event,msg.data)}}})(this),ace.define("ace/lib/oop",["require","exports","module"],function(acequire,exports){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}),ace.define("ace/lib/lang",["require","exports","module"],function(acequire,exports){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\\s\\s*/,trimEndRegexp=/\\s\\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;l>i;i++)copy[i]=array[i]&&"object"==typeof array[i]?this.copyObject(array[i]):array[i];return copy},exports.deepCopy=function(obj){if("object"!=typeof obj||!obj)return obj;var cons=obj.constructor;if(cons===RegExp)return obj;var copy=cons();for(var key in obj)copy[key]="object"==typeof obj[key]?exports.deepCopy(obj[key]):obj[key];return copy},exports.arrayToMap=function(arr){for(var map={},i=0;arr.length>i;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;array.length>=i;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,"\\\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})}),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(acequire,exports){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;listeners.length>i&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;listeners.length>i;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback)handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop());else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter}),ace.define("ace/range",["require","exports","module"],function(acequire,exports){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return cmp=this.compare(end.row,end.column),1==cmp?(cmp=this.compare(start.row,start.column),1==cmp?2:0==cmp?1:0):-1==cmp?-2:(cmp=this.compare(start.row,start.column),-1==cmp?-1:1==cmp?42:0)},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)||this.isStart(row,column)?!1:!0:!1},this.insideStart=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)?!1:!0:!1},this.insideEnd=function(row,column){return 0==this.compare(row,column)?this.isStart(row,column)?!1:!0:!1},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?this.start.row>row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?this.end.column>=column?0:1:0:this.start.column>column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(firstRow>this.end.row)var end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(firstRow>this.start.row)var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=comparePoints,Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),column===void 0?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(e){var delta=e.data,range=delta.range;if(!(range.start.row==range.end.row&&range.start.row!=this.row||range.start.row>this.row||range.start.row==this.row&&range.start.column>this.column)){var row=this.row,column=this.column,start=range.start,end=range.end;"insertText"===delta.action?start.row===row&&column>=start.column?start.column===column&&this.$insertRight||(start.row===end.row?column+=end.column-start.column:(column-=start.column,row+=end.row-start.row)):start.row!==end.row&&row>start.row&&(row+=end.row-start.row):"insertLines"===delta.action?start.row===row&&0===column&&this.$insertRight||row>=start.row&&(row+=end.row-start.row):"removeText"===delta.action?start.row===row&&column>start.column?column=end.column>=column?start.column:Math.max(0,column-(end.column-start.column)):start.row!==end.row&&row>start.row?(end.row===row&&(column=Math.max(0,column-end.column)+start.column),row-=end.row-start.row):end.row===row&&(row-=end.row-start.row,column=Math.max(0,column-end.column)+start.column):"removeLines"==delta.action&&row>=start.row&&(row>=end.row?row-=end.row-start.row:(row=start.row,column=0)),this.setPosition(row,column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):0>row?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),0>column&&(pos.column=0),pos}}).call(Anchor.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/lib/event_emitter","ace/range","ace/anchor"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(text){this.$lines=[],0===text.length?this.$lines=[""]:Array.isArray(text)?this._insertLines(0,text):this.insert({row:0,column:0},text)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength();this.remove(new Range(0,0,len,this.getLine(len-1).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},this.$split=0==="aaa".split(/a/).length?function(text){return text.replace(/\\r\\n|\\r/g,"\\n").split("\\n")}:function(text){return text.split(/\\r\\n|\\r|\\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\\r\\n|\\r|\\n)/m);this.$autoNewLine=match?match[1]:"\\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\\r\\n";case"unix":return"\\n";default:return this.$autoNewLine||"\\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\\r\\n"==text||"\\r"==text||"\\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){if(range.start.row==range.end.row)return this.getLine(range.start.row).substring(range.start.column,range.end.column);var lines=this.getLines(range.start.row,range.end.row);lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;return range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column)),lines.join(this.getNewLineCharacter())},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):0>position.row&&(position.row=0),position},this.insert=function(position,text){if(!text||0===text.length)return position;position=this.$clipPosition(position),1>=this.getLength()&&this.$detectNewLine(text);var lines=this.$split(text),firstLine=lines.splice(0,1)[0],lastLine=0==lines.length?null:lines.splice(lines.length-1,1)[0];return position=this.insertInLine(position,firstLine),null!==lastLine&&(position=this.insertNewLine(position),position=this._insertLines(position.row,lines),position=this.insertInLine(position,lastLine||"")),position},this.insertLines=function(row,lines){return row>=this.getLength()?this.insert({row:row,column:0},"\\n"+lines.join("\\n")):this._insertLines(Math.max(row,0),lines)},this._insertLines=function(row,lines){if(0==lines.length)return{row:row,column:0};for(;lines.length>61440;){var end=this._insertLines(row,lines.slice(0,61440));lines=lines.slice(61440),row=end.row}var args=[row,0];args.push.apply(args,lines),this.$lines.splice.apply(this.$lines,args);var range=new Range(row,0,row+lines.length,0),delta={action:"insertLines",range:range,lines:lines};return this._signal("change",{data:delta}),range.end},this.insertNewLine=function(position){position=this.$clipPosition(position);var line=this.$lines[position.row]||"";this.$lines[position.row]=line.substring(0,position.column),this.$lines.splice(position.row+1,0,line.substring(position.column,line.length));var end={row:position.row+1,column:0},delta={action:"insertText",range:Range.fromPoints(position,end),text:this.getNewLineCharacter()};return this._signal("change",{data:delta}),end},this.insertInLine=function(position,text){if(0==text.length)return position;var line=this.$lines[position.row]||"";this.$lines[position.row]=line.substring(0,position.column)+text+line.substring(position.column);var end={row:position.row,column:position.column+text.length},delta={action:"insertText",range:Range.fromPoints(position,end),text:text};return this._signal("change",{data:delta}),end},this.remove=function(range){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),range.start=this.$clipPosition(range.start),range.end=this.$clipPosition(range.end),range.isEmpty())return range.start;var firstRow=range.start.row,lastRow=range.end.row;if(range.isMultiLine()){var firstFullRow=0==range.start.column?firstRow:firstRow+1,lastFullRow=lastRow-1;range.end.column>0&&this.removeInLine(lastRow,0,range.end.column),lastFullRow>=firstFullRow&&this._removeLines(firstFullRow,lastFullRow),firstFullRow!=firstRow&&(this.removeInLine(firstRow,range.start.column,this.getLine(firstRow).length),this.removeNewLine(range.start.row))}else this.removeInLine(firstRow,range.start.column,range.end.column);return range.start},this.removeInLine=function(row,startColumn,endColumn){if(startColumn!=endColumn){var range=new Range(row,startColumn,row,endColumn),line=this.getLine(row),removed=line.substring(startColumn,endColumn),newLine=line.substring(0,startColumn)+line.substring(endColumn,line.length);this.$lines.splice(row,1,newLine);var delta={action:"removeText",range:range,text:removed};return this._signal("change",{data:delta}),range.start}},this.removeLines=function(firstRow,lastRow){return 0>firstRow||lastRow>=this.getLength()?this.remove(new Range(firstRow,0,lastRow+1,0)):this._removeLines(firstRow,lastRow)},this._removeLines=function(firstRow,lastRow){var range=new Range(firstRow,0,lastRow+1,0),removed=this.$lines.splice(firstRow,lastRow-firstRow+1),delta={action:"removeLines",range:range,nl:this.getNewLineCharacter(),lines:removed};return this._signal("change",{data:delta}),removed},this.removeNewLine=function(row){var firstLine=this.getLine(row),secondLine=this.getLine(row+1),range=new Range(row,firstLine.length,row+1,0),line=firstLine+secondLine;this.$lines.splice(row,2,line);var delta={action:"removeText",range:range,text:this.getNewLineCharacter()};this._signal("change",{data:delta})},this.replace=function(range,text){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0==text.length&&range.isEmpty())return range.start;if(text==this.getTextRange(range))return range.end;if(this.remove(range),text)var end=this.insert(range.start,text);else end=range.start;return end},this.applyDeltas=function(deltas){for(var i=0;deltas.length>i;i++){var delta=deltas[i],range=Range.fromPoints(delta.range.start,delta.range.end);"insertLines"==delta.action?this.insertLines(range.start.row,delta.lines):"insertText"==delta.action?this.insert(range.start,delta.text):"removeLines"==delta.action?this._removeLines(range.start.row,range.end.row-1):"removeText"==delta.action&&this.remove(range)}},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--){var delta=deltas[i],range=Range.fromPoints(delta.range.start,delta.range.end);"insertLines"==delta.action?this._removeLines(range.start.row,range.end.row-1):"insertText"==delta.action?this.remove(range):"removeLines"==delta.action?this._insertLines(range.start.row,delta.lines):"removeText"==delta.action&&this.insert(range.start,delta.text)}},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;l>i;i++)if(index-=lines[i].length+newlineLength,0>index)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;row>i;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document}),ace.define("ace/worker/mirror",["require","exports","module","ace/document","ace/lib/lang"],function(acequire,exports){"use strict";var Document=acequire("../document").Document,lang=acequire("../lib/lang"),Mirror=exports.Mirror=function(sender){this.sender=sender;var doc=this.doc=new Document(""),deferredUpdate=this.deferredUpdate=lang.delayedCall(this.onUpdate.bind(this)),_self=this;sender.on("change",function(e){return doc.applyDeltas(e.data),_self.$timeout?deferredUpdate.schedule(_self.$timeout):(_self.onUpdate(),void 0)})};(function(){this.$timeout=500,this.setTimeout=function(timeout){this.$timeout=timeout},this.setValue=function(value){this.doc.setValue(value),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(callbackId){this.sender.callback(this.doc.getValue(),callbackId)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(Mirror.prototype)}),ace.define("ace/mode/css/csslint",["require","exports","module"],function(acequire,exports,module){function Reporter(lines,ruleset){this.messages=[],this.stats=[],this.lines=lines,this.ruleset=ruleset}var parserlib={};(function(){function EventTarget(){this._listeners={}}function StringReader(text){this._input=text.replace(/\\n\\r?/g,"\\n"),this._line=1,this._col=1,this._cursor=0}function SyntaxError(message,line,col){this.col=col,this.line=line,this.message=message}function SyntaxUnit(text,line,col,type){this.col=col,this.line=line,this.text=text,this.type=type}function TokenStreamBase(input,tokenData){this._reader=input?new StringReader(""+input):null,this._token=null,this._tokenData=tokenData,this._lt=[],this._ltIndex=0,this._ltIndexCache=[]}EventTarget.prototype={constructor:EventTarget,addListener:function(type,listener){this._listeners[type]||(this._listeners[type]=[]),this._listeners[type].push(listener)},fire:function(event){if("string"==typeof event&&(event={type:event}),event.target!==void 0&&(event.target=this),event.type===void 0)throw Error("Event object missing \'type\' property.");if(this._listeners[event.type])for(var listeners=this._listeners[event.type].concat(),i=0,len=listeners.length;len>i;i++)listeners[i].call(this,event)},removeListener:function(type,listener){if(this._listeners[type])for(var listeners=this._listeners[type],i=0,len=listeners.length;len>i;i++)if(listeners[i]===listener){listeners.splice(i,1);break}}},StringReader.prototype={constructor:StringReader,getCol:function(){return this._col},getLine:function(){return this._line},eof:function(){return this._cursor==this._input.length},peek:function(count){var c=null;return count=count===void 0?1:count,this._cursor<this._input.length&&(c=this._input.charAt(this._cursor+count-1)),c},read:function(){var c=null;return this._cursor<this._input.length&&("\\n"==this._input.charAt(this._cursor)?(this._line++,this._col=1):this._col++,c=this._input.charAt(this._cursor++)),c},mark:function(){this._bookmark={cursor:this._cursor,line:this._line,col:this._col}},reset:function(){this._bookmark&&(this._cursor=this._bookmark.cursor,this._line=this._bookmark.line,this._col=this._bookmark.col,delete this._bookmark)},readTo:function(pattern){for(var c,buffer="";buffer.length<pattern.length||buffer.lastIndexOf(pattern)!=buffer.length-pattern.length;){if(c=this.read(),!c)throw Error(\'Expected "\'+pattern+\'" at line \'+this._line+", col "+this._col+".");buffer+=c}return buffer},readWhile:function(filter){for(var buffer="",c=this.read();null!==c&&filter(c);)buffer+=c,c=this.read();return buffer},readMatch:function(matcher){var source=this._input.substring(this._cursor),value=null;return"string"==typeof matcher?0===source.indexOf(matcher)&&(value=this.readCount(matcher.length)):matcher instanceof RegExp&&matcher.test(source)&&(value=this.readCount(RegExp.lastMatch.length)),value},readCount:function(count){for(var buffer="";count--;)buffer+=this.read();return buffer}},SyntaxError.prototype=Error(),SyntaxUnit.fromToken=function(token){return new SyntaxUnit(token.value,token.startLine,token.startCol)},SyntaxUnit.prototype={constructor:SyntaxUnit,valueOf:function(){return""+this},toString:function(){return this.text}},TokenStreamBase.createTokenData=function(tokens){var nameMap=[],typeMap={},tokenData=tokens.concat([]),i=0,len=tokenData.length+1;for(tokenData.UNKNOWN=-1,tokenData.unshift({name:"EOF"});len>i;i++)nameMap.push(tokenData[i].name),tokenData[tokenData[i].name]=i,tokenData[i].text&&(typeMap[tokenData[i].text]=i);return tokenData.name=function(tt){return nameMap[tt]},tokenData.type=function(c){return typeMap[c]},tokenData},TokenStreamBase.prototype={constructor:TokenStreamBase,match:function(tokenTypes,channel){tokenTypes instanceof Array||(tokenTypes=[tokenTypes]);for(var tt=this.get(channel),i=0,len=tokenTypes.length;len>i;)if(tt==tokenTypes[i++])return!0;return this.unget(),!1},mustMatch:function(tokenTypes){var token;if(tokenTypes instanceof Array||(tokenTypes=[tokenTypes]),!this.match.apply(this,arguments))throw token=this.LT(1),new SyntaxError("Expected "+this._tokenData[tokenTypes[0]].name+" at line "+token.startLine+", col "+token.startCol+".",token.startLine,token.startCol)},advance:function(tokenTypes,channel){for(;0!==this.LA(0)&&!this.match(tokenTypes,channel);)this.get();return this.LA(0)},get:function(channel){var token,info,tokenInfo=this._tokenData,i=(this._reader,0);if(tokenInfo.length,this._lt.length&&this._ltIndex>=0&&this._ltIndex<this._lt.length){for(i++,this._token=this._lt[this._ltIndex++],info=tokenInfo[this._token.type];void 0!==info.channel&&channel!==info.channel&&this._ltIndex<this._lt.length;)this._token=this._lt[this._ltIndex++],info=tokenInfo[this._token.type],i++;if((void 0===info.channel||channel===info.channel)&&this._ltIndex<=this._lt.length)return this._ltIndexCache.push(i),this._token.type}return token=this._getToken(),token.type>-1&&!tokenInfo[token.type].hide&&(token.channel=tokenInfo[token.type].channel,this._token=token,this._lt.push(token),this._ltIndexCache.push(this._lt.length-this._ltIndex+i),this._lt.length>5&&this._lt.shift(),this._ltIndexCache.length>5&&this._ltIndexCache.shift(),this._ltIndex=this._lt.length),info=tokenInfo[token.type],info&&(info.hide||void 0!==info.channel&&channel!==info.channel)?this.get(channel):token.type},LA:function(index){var tt,total=index;if(index>0){if(index>5)throw Error("Too much lookahead.");for(;total;)tt=this.get(),total--;for(;index>total;)this.unget(),total++}else if(0>index){if(!this._lt[this._ltIndex+index])throw Error("Too much lookbehind.");tt=this._lt[this._ltIndex+index].type}else tt=this._token.type;return tt},LT:function(index){return this.LA(index),this._lt[this._ltIndex+index-1]},peek:function(){return this.LA(1)},token:function(){return this._token},tokenName:function(tokenType){return 0>tokenType||tokenType>this._tokenData.length?"UNKNOWN_TOKEN":this._tokenData[tokenType].name},tokenType:function(tokenName){return this._tokenData[tokenName]||-1},unget:function(){if(!this._ltIndexCache.length)throw Error("Too much lookahead.");this._ltIndex-=this._ltIndexCache.pop(),this._token=this._lt[this._ltIndex-1]}},parserlib.util={StringReader:StringReader,SyntaxError:SyntaxError,SyntaxUnit:SyntaxUnit,EventTarget:EventTarget,TokenStreamBase:TokenStreamBase}})(),function(){function Combinator(text,line,col){SyntaxUnit.call(this,text,line,col,Parser.COMBINATOR_TYPE),this.type="unknown",/^\\s+$/.test(text)?this.type="descendant":">"==text?this.type="child":"+"==text?this.type="adjacent-sibling":"~"==text&&(this.type="sibling")}function MediaFeature(name,value){SyntaxUnit.call(this,"("+name+(null!==value?":"+value:"")+")",name.startLine,name.startCol,Parser.MEDIA_FEATURE_TYPE),this.name=name,this.value=value\n}function MediaQuery(modifier,mediaType,features,line,col){SyntaxUnit.call(this,(modifier?modifier+" ":"")+(mediaType?mediaType:"")+(mediaType&&features.length>0?" and ":"")+features.join(" and "),line,col,Parser.MEDIA_QUERY_TYPE),this.modifier=modifier,this.mediaType=mediaType,this.features=features}function Parser(options){EventTarget.call(this),this.options=options||{},this._tokenStream=null}function PropertyName(text,hack,line,col){SyntaxUnit.call(this,text,line,col,Parser.PROPERTY_NAME_TYPE),this.hack=hack}function PropertyValue(parts,line,col){SyntaxUnit.call(this,parts.join(" "),line,col,Parser.PROPERTY_VALUE_TYPE),this.parts=parts}function PropertyValueIterator(value){this._i=0,this._parts=value.parts,this._marks=[],this.value=value}function PropertyValuePart(text,line,col){SyntaxUnit.call(this,text,line,col,Parser.PROPERTY_VALUE_PART_TYPE),this.type="unknown";var temp;if(/^([+\\-]?[\\d\\.]+)([a-z]+)$/i.test(text))switch(this.type="dimension",this.value=+RegExp.$1,this.units=RegExp.$2,this.units.toLowerCase()){case"em":case"rem":case"ex":case"px":case"cm":case"mm":case"in":case"pt":case"pc":case"ch":case"vh":case"vw":case"vm":this.type="length";break;case"deg":case"rad":case"grad":this.type="angle";break;case"ms":case"s":this.type="time";break;case"hz":case"khz":this.type="frequency";break;case"dpi":case"dpcm":this.type="resolution"}else/^([+\\-]?[\\d\\.]+)%$/i.test(text)?(this.type="percentage",this.value=+RegExp.$1):/^([+\\-]?\\d+)$/i.test(text)?(this.type="integer",this.value=+RegExp.$1):/^([+\\-]?[\\d\\.]+)$/i.test(text)?(this.type="number",this.value=+RegExp.$1):/^#([a-f0-9]{3,6})/i.test(text)?(this.type="color",temp=RegExp.$1,3==temp.length?(this.red=parseInt(temp.charAt(0)+temp.charAt(0),16),this.green=parseInt(temp.charAt(1)+temp.charAt(1),16),this.blue=parseInt(temp.charAt(2)+temp.charAt(2),16)):(this.red=parseInt(temp.substring(0,2),16),this.green=parseInt(temp.substring(2,4),16),this.blue=parseInt(temp.substring(4,6),16))):/^rgb\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/i.test(text)?(this.type="color",this.red=+RegExp.$1,this.green=+RegExp.$2,this.blue=+RegExp.$3):/^rgb\\(\\s*(\\d+)%\\s*,\\s*(\\d+)%\\s*,\\s*(\\d+)%\\s*\\)/i.test(text)?(this.type="color",this.red=255*+RegExp.$1/100,this.green=255*+RegExp.$2/100,this.blue=255*+RegExp.$3/100):/^rgba\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*([\\d\\.]+)\\s*\\)/i.test(text)?(this.type="color",this.red=+RegExp.$1,this.green=+RegExp.$2,this.blue=+RegExp.$3,this.alpha=+RegExp.$4):/^rgba\\(\\s*(\\d+)%\\s*,\\s*(\\d+)%\\s*,\\s*(\\d+)%\\s*,\\s*([\\d\\.]+)\\s*\\)/i.test(text)?(this.type="color",this.red=255*+RegExp.$1/100,this.green=255*+RegExp.$2/100,this.blue=255*+RegExp.$3/100,this.alpha=+RegExp.$4):/^hsl\\(\\s*(\\d+)\\s*,\\s*(\\d+)%\\s*,\\s*(\\d+)%\\s*\\)/i.test(text)?(this.type="color",this.hue=+RegExp.$1,this.saturation=+RegExp.$2/100,this.lightness=+RegExp.$3/100):/^hsla\\(\\s*(\\d+)\\s*,\\s*(\\d+)%\\s*,\\s*(\\d+)%\\s*,\\s*([\\d\\.]+)\\s*\\)/i.test(text)?(this.type="color",this.hue=+RegExp.$1,this.saturation=+RegExp.$2/100,this.lightness=+RegExp.$3/100,this.alpha=+RegExp.$4):/^url\\(["\']?([^\\)"\']+)["\']?\\)/i.test(text)?(this.type="uri",this.uri=RegExp.$1):/^([^\\(]+)\\(/i.test(text)?(this.type="function",this.name=RegExp.$1,this.value=text):/^["\'][^"\']*["\']/.test(text)?(this.type="string",this.value=eval(text)):Colors[text.toLowerCase()]?(this.type="color",temp=Colors[text.toLowerCase()].substring(1),this.red=parseInt(temp.substring(0,2),16),this.green=parseInt(temp.substring(2,4),16),this.blue=parseInt(temp.substring(4,6),16)):/^[\\,\\/]$/.test(text)?(this.type="operator",this.value=text):/^[a-z\\-\\u0080-\\uFFFF][a-z0-9\\-\\u0080-\\uFFFF]*$/i.test(text)&&(this.type="identifier",this.value=text)}function Selector(parts,line,col){SyntaxUnit.call(this,parts.join(" "),line,col,Parser.SELECTOR_TYPE),this.parts=parts,this.specificity=Specificity.calculate(this)}function SelectorPart(elementName,modifiers,text,line,col){SyntaxUnit.call(this,text,line,col,Parser.SELECTOR_PART_TYPE),this.elementName=elementName,this.modifiers=modifiers}function SelectorSubPart(text,type,line,col){SyntaxUnit.call(this,text,line,col,Parser.SELECTOR_SUB_PART_TYPE),this.type=type,this.args=[]}function Specificity(a,b,c,d){this.a=a,this.b=b,this.c=c,this.d=d}function isHexDigit(c){return null!==c&&h.test(c)}function isDigit(c){return null!==c&&/\\d/.test(c)}function isWhitespace(c){return null!==c&&/\\s/.test(c)}function isNewLine(c){return null!==c&&nl.test(c)}function isNameStart(c){return null!==c&&/[a-z_\\u0080-\\uFFFF\\\\]/i.test(c)}function isNameChar(c){return null!==c&&(isNameStart(c)||/[0-9\\-\\\\]/.test(c))}function isIdentStart(c){return null!==c&&(isNameStart(c)||/\\-\\\\/.test(c))}function mix(receiver,supplier){for(var prop in supplier)supplier.hasOwnProperty(prop)&&(receiver[prop]=supplier[prop]);return receiver}function TokenStream(input){TokenStreamBase.call(this,input,Tokens)}function ValidationError(message,line,col){this.col=col,this.line=line,this.message=message}var EventTarget=parserlib.util.EventTarget,TokenStreamBase=parserlib.util.TokenStreamBase,StringReader=parserlib.util.StringReader,SyntaxError=parserlib.util.SyntaxError,SyntaxUnit=parserlib.util.SyntaxUnit,Colors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",activeBorder:"Active window border.",activecaption:"Active window caption.",appworkspace:"Background color of multiple document interface.",background:"Desktop background.",buttonface:"The face background color for 3-D elements that appear 3-D due to one layer of surrounding border.",buttonhighlight:"The color of the border facing the light source for 3-D elements that appear 3-D due to one layer of surrounding border.",buttonshadow:"The color of the border away from the light source for 3-D elements that appear 3-D due to one layer of surrounding border.",buttontext:"Text on push buttons.",captiontext:"Text in caption, size box, and scrollbar arrow box.",graytext:"Grayed (disabled) text. This color is set to #000 if the current display driver does not support a solid gray color.",greytext:"Greyed (disabled) text. This color is set to #000 if the current display driver does not support a solid grey color.",highlight:"Item(s) selected in a control.",highlighttext:"Text of item(s) selected in a control.",inactiveborder:"Inactive window border.",inactivecaption:"Inactive window caption.",inactivecaptiontext:"Color of text in an inactive caption.",infobackground:"Background color for tooltip controls.",infotext:"Text color for tooltip controls.",menu:"Menu background.",menutext:"Text in menus.",scrollbar:"Scroll bar gray area.",threeddarkshadow:"The color of the darker (generally outer) of the two borders away from the light source for 3-D elements that appear 3-D due to two concentric layers of surrounding border.",threedface:"The face background color for 3-D elements that appear 3-D due to two concentric layers of surrounding border.",threedhighlight:"The color of the lighter (generally outer) of the two borders facing the light source for 3-D elements that appear 3-D due to two concentric layers of surrounding border.",threedlightshadow:"The color of the darker (generally inner) of the two borders facing the light source for 3-D elements that appear 3-D due to two concentric layers of surrounding border.",threedshadow:"The color of the lighter (generally inner) of the two borders away from the light source for 3-D elements that appear 3-D due to two concentric layers of surrounding border.",window:"Window background.",windowframe:"Window frame.",windowtext:"Text in windows."};Combinator.prototype=new SyntaxUnit,Combinator.prototype.constructor=Combinator,MediaFeature.prototype=new SyntaxUnit,MediaFeature.prototype.constructor=MediaFeature,MediaQuery.prototype=new SyntaxUnit,MediaQuery.prototype.constructor=MediaQuery,Parser.DEFAULT_TYPE=0,Parser.COMBINATOR_TYPE=1,Parser.MEDIA_FEATURE_TYPE=2,Parser.MEDIA_QUERY_TYPE=3,Parser.PROPERTY_NAME_TYPE=4,Parser.PROPERTY_VALUE_TYPE=5,Parser.PROPERTY_VALUE_PART_TYPE=6,Parser.SELECTOR_TYPE=7,Parser.SELECTOR_PART_TYPE=8,Parser.SELECTOR_SUB_PART_TYPE=9,Parser.prototype=function(){var prop,proto=new EventTarget,additions={constructor:Parser,DEFAULT_TYPE:0,COMBINATOR_TYPE:1,MEDIA_FEATURE_TYPE:2,MEDIA_QUERY_TYPE:3,PROPERTY_NAME_TYPE:4,PROPERTY_VALUE_TYPE:5,PROPERTY_VALUE_PART_TYPE:6,SELECTOR_TYPE:7,SELECTOR_PART_TYPE:8,SELECTOR_SUB_PART_TYPE:9,_stylesheet:function(){var count,token,tt,tokenStream=this._tokenStream;for(this.fire("startstylesheet"),this._charset(),this._skipCruft();tokenStream.peek()==Tokens.IMPORT_SYM;)this._import(),this._skipCruft();for(;tokenStream.peek()==Tokens.NAMESPACE_SYM;)this._namespace(),this._skipCruft();for(tt=tokenStream.peek();tt>Tokens.EOF;){try{switch(tt){case Tokens.MEDIA_SYM:this._media(),this._skipCruft();break;case Tokens.PAGE_SYM:this._page(),this._skipCruft();break;case Tokens.FONT_FACE_SYM:this._font_face(),this._skipCruft();break;case Tokens.KEYFRAMES_SYM:this._keyframes(),this._skipCruft();break;case Tokens.VIEWPORT_SYM:this._viewport(),this._skipCruft();break;case Tokens.UNKNOWN_SYM:if(tokenStream.get(),this.options.strict)throw new SyntaxError("Unknown @ rule.",tokenStream.LT(0).startLine,tokenStream.LT(0).startCol);for(this.fire({type:"error",error:null,message:"Unknown @ rule: "+tokenStream.LT(0).value+".",line:tokenStream.LT(0).startLine,col:tokenStream.LT(0).startCol}),count=0;tokenStream.advance([Tokens.LBRACE,Tokens.RBRACE])==Tokens.LBRACE;)count++;for(;count;)tokenStream.advance([Tokens.RBRACE]),count--;break;case Tokens.S:this._readWhitespace();break;default:if(!this._ruleset())switch(tt){case Tokens.CHARSET_SYM:throw token=tokenStream.LT(1),this._charset(!1),new SyntaxError("@charset not allowed here.",token.startLine,token.startCol);case Tokens.IMPORT_SYM:throw token=tokenStream.LT(1),this._import(!1),new SyntaxError("@import not allowed here.",token.startLine,token.startCol);case Tokens.NAMESPACE_SYM:throw token=tokenStream.LT(1),this._namespace(!1),new SyntaxError("@namespace not allowed here.",token.startLine,token.startCol);default:tokenStream.get(),this._unexpectedToken(tokenStream.token())}}}catch(ex){if(!(ex instanceof SyntaxError)||this.options.strict)throw ex;this.fire({type:"error",error:ex,message:ex.message,line:ex.line,col:ex.col})}tt=tokenStream.peek()}tt!=Tokens.EOF&&this._unexpectedToken(tokenStream.token()),this.fire("endstylesheet")},_charset:function(emit){var charset,token,line,col,tokenStream=this._tokenStream;tokenStream.match(Tokens.CHARSET_SYM)&&(line=tokenStream.token().startLine,col=tokenStream.token().startCol,this._readWhitespace(),tokenStream.mustMatch(Tokens.STRING),token=tokenStream.token(),charset=token.value,this._readWhitespace(),tokenStream.mustMatch(Tokens.SEMICOLON),emit!==!1&&this.fire({type:"charset",charset:charset,line:line,col:col}))},_import:function(emit){var uri,importToken,tokenStream=this._tokenStream,mediaList=[];tokenStream.mustMatch(Tokens.IMPORT_SYM),importToken=tokenStream.token(),this._readWhitespace(),tokenStream.mustMatch([Tokens.STRING,Tokens.URI]),uri=tokenStream.token().value.replace(/(?:url\\()?["\']([^"\']+)["\']\\)?/,"$1"),this._readWhitespace(),mediaList=this._media_query_list(),tokenStream.mustMatch(Tokens.SEMICOLON),this._readWhitespace(),emit!==!1&&this.fire({type:"import",uri:uri,media:mediaList,line:importToken.startLine,col:importToken.startCol})},_namespace:function(emit){var line,col,prefix,uri,tokenStream=this._tokenStream;tokenStream.mustMatch(Tokens.NAMESPACE_SYM),line=tokenStream.token().startLine,col=tokenStream.token().startCol,this._readWhitespace(),tokenStream.match(Tokens.IDENT)&&(prefix=tokenStream.token().value,this._readWhitespace()),tokenStream.mustMatch([Tokens.STRING,Tokens.URI]),uri=tokenStream.token().value.replace(/(?:url\\()?["\']([^"\']+)["\']\\)?/,"$1"),this._readWhitespace(),tokenStream.mustMatch(Tokens.SEMICOLON),this._readWhitespace(),emit!==!1&&this.fire({type:"namespace",prefix:prefix,uri:uri,line:line,col:col})},_media:function(){var line,col,mediaList,tokenStream=this._tokenStream;for(tokenStream.mustMatch(Tokens.MEDIA_SYM),line=tokenStream.token().startLine,col=tokenStream.token().startCol,this._readWhitespace(),mediaList=this._media_query_list(),tokenStream.mustMatch(Tokens.LBRACE),this._readWhitespace(),this.fire({type:"startmedia",media:mediaList,line:line,col:col});;)if(tokenStream.peek()==Tokens.PAGE_SYM)this._page();else if(tokenStream.peek()==Tokens.FONT_FACE_SYM)this._font_face();else if(!this._ruleset())break;tokenStream.mustMatch(Tokens.RBRACE),this._readWhitespace(),this.fire({type:"endmedia",media:mediaList,line:line,col:col})},_media_query_list:function(){var tokenStream=this._tokenStream,mediaList=[];for(this._readWhitespace(),(tokenStream.peek()==Tokens.IDENT||tokenStream.peek()==Tokens.LPAREN)&&mediaList.push(this._media_query());tokenStream.match(Tokens.COMMA);)this._readWhitespace(),mediaList.push(this._media_query());return mediaList},_media_query:function(){var tokenStream=this._tokenStream,type=null,ident=null,token=null,expressions=[];if(tokenStream.match(Tokens.IDENT)&&(ident=tokenStream.token().value.toLowerCase(),"only"!=ident&&"not"!=ident?(tokenStream.unget(),ident=null):token=tokenStream.token()),this._readWhitespace(),tokenStream.peek()==Tokens.IDENT?(type=this._media_type(),null===token&&(token=tokenStream.token())):tokenStream.peek()==Tokens.LPAREN&&(null===token&&(token=tokenStream.LT(1)),expressions.push(this._media_expression())),null===type&&0===expressions.length)return null;for(this._readWhitespace();tokenStream.match(Tokens.IDENT);)"and"!=tokenStream.token().value.toLowerCase()&&this._unexpectedToken(tokenStream.token()),this._readWhitespace(),expressions.push(this._media_expression());return new MediaQuery(ident,type,expressions,token.startLine,token.startCol)},_media_type:function(){return this._media_feature()},_media_expression:function(){var token,tokenStream=this._tokenStream,feature=null,expression=null;return tokenStream.mustMatch(Tokens.LPAREN),feature=this._media_feature(),this._readWhitespace(),tokenStream.match(Tokens.COLON)&&(this._readWhitespace(),token=tokenStream.LT(1),expression=this._expression()),tokenStream.mustMatch(Tokens.RPAREN),this._readWhitespace(),new MediaFeature(feature,expression?new SyntaxUnit(expression,token.startLine,token.startCol):null)},_media_feature:function(){var tokenStream=this._tokenStream;return tokenStream.mustMatch(Tokens.IDENT),SyntaxUnit.fromToken(tokenStream.token())},_page:function(){var line,col,tokenStream=this._tokenStream,identifier=null,pseudoPage=null;tokenStream.mustMatch(Tokens.PAGE_SYM),line=tokenStream.token().startLine,col=tokenStream.token().startCol,this._readWhitespace(),tokenStream.match(Tokens.IDENT)&&(identifier=tokenStream.token().value,"auto"===identifier.toLowerCase()&&this._unexpectedToken(tokenStream.token())),tokenStream.peek()==Tokens.COLON&&(pseudoPage=this._pseudo_page()),this._readWhitespace(),this.fire({type:"startpage",id:identifier,pseudo:pseudoPage,line:line,col:col}),this._readDeclarations(!0,!0),this.fire({type:"endpage",id:identifier,pseudo:pseudoPage,line:line,col:col})},_margin:function(){var line,col,tokenStream=this._tokenStream,marginSym=this._margin_sym();return marginSym?(line=tokenStream.token().startLine,col=tokenStream.token().startCol,this.fire({type:"startpagemargin",margin:marginSym,line:line,col:col}),this._readDeclarations(!0),this.fire({type:"endpagemargin",margin:marginSym,line:line,col:col}),!0):!1},_margin_sym:function(){var tokenStream=this._tokenStream;return tokenStream.match([Tokens.TOPLEFTCORNER_SYM,Tokens.TOPLEFT_SYM,Tokens.TOPCENTER_SYM,Tokens.TOPRIGHT_SYM,Tokens.TOPRIGHTCORNER_SYM,Tokens.BOTTOMLEFTCORNER_SYM,Tokens.BOTTOMLEFT_SYM,Tokens.BOTTOMCENTER_SYM,Tokens.BOTTOMRIGHT_SYM,Tokens.BOTTOMRIGHTCORNER_SYM,Tokens.LEFTTOP_SYM,Tokens.LEFTMIDDLE_SYM,Tokens.LEFTBOTTOM_SYM,Tokens.RIGHTTOP_SYM,Tokens.RIGHTMIDDLE_SYM,Tokens.RIGHTBOTTOM_SYM])?SyntaxUnit.fromToken(tokenStream.token()):null},_pseudo_page:function(){var tokenStream=this._tokenStream;return tokenStream.mustMatch(Tokens.COLON),tokenStream.mustMatch(Tokens.IDENT),tokenStream.token().value},_font_face:function(){var line,col,tokenStream=this._tokenStream;tokenStream.mustMatch(Tokens.FONT_FACE_SYM),line=tokenStream.token().startLine,col=tokenStream.token().startCol,this._readWhitespace(),this.fire({type:"startfontface",line:line,col:col}),this._readDeclarations(!0),this.fire({type:"endfontface",line:line,col:col})},_viewport:function(){var line,col,tokenStream=this._tokenStream;tokenStream.mustMatch(Tokens.VIEWPORT_SYM),line=tokenStream.token().startLine,col=tokenStream.token().startCol,this._readWhitespace(),this.fire({type:"startviewport",line:line,col:col}),this._readDeclarations(!0),this.fire({type:"endviewport",line:line,col:col})},_operator:function(inFunction){var tokenStream=this._tokenStream,token=null;return(tokenStream.match([Tokens.SLASH,Tokens.COMMA])||inFunction&&tokenStream.match([Tokens.PLUS,Tokens.STAR,Tokens.MINUS]))&&(token=tokenStream.token(),this._readWhitespace()),token?PropertyValuePart.fromToken(token):null},_combinator:function(){var token,tokenStream=this._tokenStream,value=null;return tokenStream.match([Tokens.PLUS,Tokens.GREATER,Tokens.TILDE])&&(token=tokenStream.token(),value=new Combinator(token.value,token.startLine,token.startCol),this._readWhitespace()),value},_unary_operator:function(){var tokenStream=this._tokenStream;return tokenStream.match([Tokens.MINUS,Tokens.PLUS])?tokenStream.token().value:null},_property:function(){var tokenValue,token,line,col,tokenStream=this._tokenStream,value=null,hack=null;return tokenStream.peek()==Tokens.STAR&&this.options.starHack&&(tokenStream.get(),token=tokenStream.token(),hack=token.value,line=token.startLine,col=token.startCol),tokenStream.match(Tokens.IDENT)&&(token=tokenStream.token(),tokenValue=token.value,"_"==tokenValue.charAt(0)&&this.options.underscoreHack&&(hack="_",tokenValue=tokenValue.substring(1)),value=new PropertyName(tokenValue,hack,line||token.startLine,col||token.startCol),this._readWhitespace()),value},_ruleset:function(){var tt,selectors,tokenStream=this._tokenStream;try{selectors=this._selectors_group()}catch(ex){if(!(ex instanceof SyntaxError)||this.options.strict)throw ex;if(this.fire({type:"error",error:ex,message:ex.message,line:ex.line,col:ex.col}),tt=tokenStream.advance([Tokens.RBRACE]),tt!=Tokens.RBRACE)throw ex;return!0}return selectors&&(this.fire({type:"startrule",selectors:selectors,line:selectors[0].line,col:selectors[0].col}),this._readDeclarations(!0),this.fire({type:"endrule",selectors:selectors,line:selectors[0].line,col:selectors[0].col})),selectors},_selectors_group:function(){var selector,tokenStream=this._tokenStream,selectors=[];if(selector=this._selector(),null!==selector)for(selectors.push(selector);tokenStream.match(Tokens.COMMA);)this._readWhitespace(),selector=this._selector(),null!==selector?selectors.push(selector):this._unexpectedToken(tokenStream.LT(1));return selectors.length?selectors:null},_selector:function(){var tokenStream=this._tokenStream,selector=[],nextSelector=null,combinator=null,ws=null;if(nextSelector=this._simple_selector_sequence(),null===nextSelector)return null;for(selector.push(nextSelector);;)if(combinator=this._combinator(),null!==combinator)selector.push(combinator),nextSelector=this._simple_selector_sequence(),null===nextSelector?this._unexpectedToken(tokenStream.LT(1)):selector.push(nextSelector);else{if(!this._readWhitespace())break;ws=new Combinator(tokenStream.token().value,tokenStream.token().startLine,tokenStream.token().startCol),combinator=this._combinator(),nextSelector=this._simple_selector_sequence(),null===nextSelector?null!==combinator&&this._unexpectedToken(tokenStream.LT(1)):(null!==combinator?selector.push(combinator):selector.push(ws),selector.push(nextSelector))}return new Selector(selector,selector[0].line,selector[0].col)},_simple_selector_sequence:function(){var line,col,tokenStream=this._tokenStream,elementName=null,modifiers=[],selectorText="",components=[function(){return tokenStream.match(Tokens.HASH)?new SelectorSubPart(tokenStream.token().value,"id",tokenStream.token().startLine,tokenStream.token().startCol):null},this._class,this._attrib,this._pseudo,this._negation],i=0,len=components.length,component=null;for(line=tokenStream.LT(1).startLine,col=tokenStream.LT(1).startCol,elementName=this._type_selector(),elementName||(elementName=this._universal()),null!==elementName&&(selectorText+=elementName);;){if(tokenStream.peek()===Tokens.S)break;for(;len>i&&null===component;)component=components[i++].call(this);if(null===component){if(""===selectorText)return null;break}i=0,modifiers.push(component),selectorText+=""+component,component=null}return""!==selectorText?new SelectorPart(elementName,modifiers,selectorText,line,col):null},_type_selector:function(){var tokenStream=this._tokenStream,ns=this._namespace_prefix(),elementName=this._element_name();return elementName?(ns&&(elementName.text=ns+elementName.text,elementName.col-=ns.length),elementName):(ns&&(tokenStream.unget(),ns.length>1&&tokenStream.unget()),null)},_class:function(){var token,tokenStream=this._tokenStream;return tokenStream.match(Tokens.DOT)?(tokenStream.mustMatch(Tokens.IDENT),token=tokenStream.token(),new SelectorSubPart("."+token.value,"class",token.startLine,token.startCol-1)):null},_element_name:function(){var token,tokenStream=this._tokenStream;return tokenStream.match(Tokens.IDENT)?(token=tokenStream.token(),new SelectorSubPart(token.value,"elementName",token.startLine,token.startCol)):null},_namespace_prefix:function(){var tokenStream=this._tokenStream,value="";return(tokenStream.LA(1)===Tokens.PIPE||tokenStream.LA(2)===Tokens.PIPE)&&(tokenStream.match([Tokens.IDENT,Tokens.STAR])&&(value+=tokenStream.token().value),tokenStream.mustMatch(Tokens.PIPE),value+="|"),value.length?value:null},_universal:function(){var ns,tokenStream=this._tokenStream,value="";return ns=this._namespace_prefix(),ns&&(value+=ns),tokenStream.match(Tokens.STAR)&&(value+="*"),value.length?value:null},_attrib:function(){var ns,token,tokenStream=this._tokenStream,value=null;return tokenStream.match(Tokens.LBRACKET)?(token=tokenStream.token(),value=token.value,value+=this._readWhitespace(),ns=this._namespace_prefix(),ns&&(value+=ns),tokenStream.mustMatch(Tokens.IDENT),value+=tokenStream.token().value,value+=this._readWhitespace(),tokenStream.match([Tokens.PREFIXMATCH,Tokens.SUFFIXMATCH,Tokens.SUBSTRINGMATCH,Tokens.EQUALS,Tokens.INCLUDES,Tokens.DASHMATCH])&&(value+=tokenStream.token().value,value+=this._readWhitespace(),tokenStream.mustMatch([Tokens.IDENT,Tokens.STRING]),value+=tokenStream.token().value,value+=this._readWhitespace()),tokenStream.mustMatch(Tokens.RBRACKET),new SelectorSubPart(value+"]","attribute",token.startLine,token.startCol)):null},_pseudo:function(){var line,col,tokenStream=this._tokenStream,pseudo=null,colons=":";return tokenStream.match(Tokens.COLON)&&(tokenStream.match(Tokens.COLON)&&(colons+=":"),tokenStream.match(Tokens.IDENT)?(pseudo=tokenStream.token().value,line=tokenStream.token().startLine,col=tokenStream.token().startCol-colons.length):tokenStream.peek()==Tokens.FUNCTION&&(line=tokenStream.LT(1).startLine,col=tokenStream.LT(1).startCol-colons.length,pseudo=this._functional_pseudo()),pseudo&&(pseudo=new SelectorSubPart(colons+pseudo,"pseudo",line,col))),pseudo},_functional_pseudo:function(){var tokenStream=this._tokenStream,value=null;return tokenStream.match(Tokens.FUNCTION)&&(value=tokenStream.token().value,value+=this._readWhitespace(),value+=this._expression(),tokenStream.mustMatch(Tokens.RPAREN),value+=")"),value},_expression:function(){for(var tokenStream=this._tokenStream,value="";tokenStream.match([Tokens.PLUS,Tokens.MINUS,Tokens.DIMENSION,Tokens.NUMBER,Tokens.STRING,Tokens.IDENT,Tokens.LENGTH,Tokens.FREQ,Tokens.ANGLE,Tokens.TIME,Tokens.RESOLUTION,Tokens.SLASH]);)value+=tokenStream.token().value,value+=this._readWhitespace();return value.length?value:null},_negation:function(){var line,col,arg,tokenStream=this._tokenStream,value="",subpart=null;return tokenStream.match(Tokens.NOT)&&(value=tokenStream.token().value,line=tokenStream.token().startLine,col=tokenStream.token().startCol,value+=this._readWhitespace(),arg=this._negation_arg(),value+=arg,value+=this._readWhitespace(),tokenStream.match(Tokens.RPAREN),value+=tokenStream.token().value,subpart=new SelectorSubPart(value,"not",line,col),subpart.args.push(arg)),subpart},_negation_arg:function(){var line,col,part,tokenStream=this._tokenStream,args=[this._type_selector,this._universal,function(){return tokenStream.match(Tokens.HASH)?new SelectorSubPart(tokenStream.token().value,"id",tokenStream.token().startLine,tokenStream.token().startCol):null},this._class,this._attrib,this._pseudo],arg=null,i=0,len=args.length;for(line=tokenStream.LT(1).startLine,col=tokenStream.LT(1).startCol;len>i&&null===arg;)arg=args[i].call(this),i++;return null===arg&&this._unexpectedToken(tokenStream.LT(1)),part="elementName"==arg.type?new SelectorPart(arg,[],""+arg,line,col):new SelectorPart(null,[arg],""+arg,line,col)},_declaration:function(){var tokenStream=this._tokenStream,property=null,expr=null,prio=null,invalid=null,propertyName="";if(property=this._property(),null!==property){tokenStream.mustMatch(Tokens.COLON),this._readWhitespace(),expr=this._expr(),expr&&0!==expr.length||this._unexpectedToken(tokenStream.LT(1)),prio=this._prio(),propertyName=""+property,(this.options.starHack&&"*"==property.hack||this.options.underscoreHack&&"_"==property.hack)&&(propertyName=property.text);try{this._validateProperty(propertyName,expr)}catch(ex){invalid=ex}return this.fire({type:"property",property:property,value:expr,important:prio,line:property.line,col:property.col,invalid:invalid}),!0}return!1},_prio:function(){var tokenStream=this._tokenStream,result=tokenStream.match(Tokens.IMPORTANT_SYM);return this._readWhitespace(),result},_expr:function(inFunction){var values=(this._tokenStream,[]),value=null,operator=null;if(value=this._term(),null!==value)for(values.push(value);;){if(operator=this._operator(inFunction),operator&&values.push(operator),value=this._term(),null===value)break;values.push(value)}return values.length>0?new PropertyValue(values,values[0].line,values[0].col):null},_term:function(){var token,line,col,tokenStream=this._tokenStream,unary=null,value=null;return unary=this._unary_operator(),null!==unary&&(line=tokenStream.token().startLine,col=tokenStream.token().startCol),tokenStream.peek()==Tokens.IE_FUNCTION&&this.options.ieFilters?(value=this._ie_function(),null===unary&&(line=tokenStream.token().startLine,col=tokenStream.token().startCol)):tokenStream.match([Tokens.NUMBER,Tokens.PERCENTAGE,Tokens.LENGTH,Tokens.ANGLE,Tokens.TIME,Tokens.FREQ,Tokens.STRING,Tokens.IDENT,Tokens.URI,Tokens.UNICODE_RANGE])?(value=tokenStream.token().value,null===unary&&(line=tokenStream.token().startLine,col=tokenStream.token().startCol),this._readWhitespace()):(token=this._hexcolor(),null===token?(null===unary&&(line=tokenStream.LT(1).startLine,col=tokenStream.LT(1).startCol),null===value&&(value=tokenStream.LA(3)==Tokens.EQUALS&&this.options.ieFilters?this._ie_function():this._function())):(value=token.value,null===unary&&(line=token.startLine,col=token.startCol))),null!==value?new PropertyValuePart(null!==unary?unary+value:value,line,col):null},_function:function(){var lt,tokenStream=this._tokenStream,functionText=null,expr=null;if(tokenStream.match(Tokens.FUNCTION)){if(functionText=tokenStream.token().value,this._readWhitespace(),expr=this._expr(!0),functionText+=expr,this.options.ieFilters&&tokenStream.peek()==Tokens.EQUALS)do for(this._readWhitespace()&&(functionText+=tokenStream.token().value),tokenStream.LA(0)==Tokens.COMMA&&(functionText+=tokenStream.token().value),tokenStream.match(Tokens.IDENT),functionText+=tokenStream.token().value,tokenStream.match(Tokens.EQUALS),functionText+=tokenStream.token().value,lt=tokenStream.peek();lt!=Tokens.COMMA&&lt!=Tokens.S&&lt!=Tokens.RPAREN;)tokenStream.get(),functionText+=tokenStream.token().value,lt=tokenStream.peek();while(tokenStream.match([Tokens.COMMA,Tokens.S]));tokenStream.match(Tokens.RPAREN),functionText+=")",this._readWhitespace()}return functionText},_ie_function:function(){var lt,tokenStream=this._tokenStream,functionText=null;if(tokenStream.match([Tokens.IE_FUNCTION,Tokens.FUNCTION])){functionText=tokenStream.token().value;do for(this._readWhitespace()&&(functionText+=tokenStream.token().value),tokenStream.LA(0)==Tokens.COMMA&&(functionText+=tokenStream.token().value),tokenStream.match(Tokens.IDENT),functionText+=tokenStream.token().value,tokenStream.match(Tokens.EQUALS),functionText+=tokenStream.token().value,lt=tokenStream.peek();lt!=Tokens.COMMA&&lt!=Tokens.S&&lt!=Tokens.RPAREN;)tokenStream.get(),functionText+=tokenStream.token().value,lt=tokenStream.peek();while(tokenStream.match([Tokens.COMMA,Tokens.S]));tokenStream.match(Tokens.RPAREN),functionText+=")",this._readWhitespace()}return functionText},_hexcolor:function(){var color,tokenStream=this._tokenStream,token=null;if(tokenStream.match(Tokens.HASH)){if(token=tokenStream.token(),color=token.value,!/#[a-f0-9]{3,6}/i.test(color))throw new SyntaxError("Expected a hex color but found \'"+color+"\' at line "+token.startLine+", col "+token.startCol+".",token.startLine,token.startCol);\nthis._readWhitespace()}return token},_keyframes:function(){var token,tt,name,tokenStream=this._tokenStream,prefix="";for(tokenStream.mustMatch(Tokens.KEYFRAMES_SYM),token=tokenStream.token(),/^@\\-([^\\-]+)\\-/.test(token.value)&&(prefix=RegExp.$1),this._readWhitespace(),name=this._keyframe_name(),this._readWhitespace(),tokenStream.mustMatch(Tokens.LBRACE),this.fire({type:"startkeyframes",name:name,prefix:prefix,line:token.startLine,col:token.startCol}),this._readWhitespace(),tt=tokenStream.peek();tt==Tokens.IDENT||tt==Tokens.PERCENTAGE;)this._keyframe_rule(),this._readWhitespace(),tt=tokenStream.peek();this.fire({type:"endkeyframes",name:name,prefix:prefix,line:token.startLine,col:token.startCol}),this._readWhitespace(),tokenStream.mustMatch(Tokens.RBRACE)},_keyframe_name:function(){var tokenStream=this._tokenStream;return tokenStream.mustMatch([Tokens.IDENT,Tokens.STRING]),SyntaxUnit.fromToken(tokenStream.token())},_keyframe_rule:function(){var keyList=(this._tokenStream,this._key_list());this.fire({type:"startkeyframerule",keys:keyList,line:keyList[0].line,col:keyList[0].col}),this._readDeclarations(!0),this.fire({type:"endkeyframerule",keys:keyList,line:keyList[0].line,col:keyList[0].col})},_key_list:function(){var tokenStream=this._tokenStream,keyList=[];for(keyList.push(this._key()),this._readWhitespace();tokenStream.match(Tokens.COMMA);)this._readWhitespace(),keyList.push(this._key()),this._readWhitespace();return keyList},_key:function(){var token,tokenStream=this._tokenStream;if(tokenStream.match(Tokens.PERCENTAGE))return SyntaxUnit.fromToken(tokenStream.token());if(tokenStream.match(Tokens.IDENT)){if(token=tokenStream.token(),/from|to/i.test(token.value))return SyntaxUnit.fromToken(token);tokenStream.unget()}this._unexpectedToken(tokenStream.LT(1))},_skipCruft:function(){for(;this._tokenStream.match([Tokens.S,Tokens.CDO,Tokens.CDC]););},_readDeclarations:function(checkStart,readMargins){var tt,tokenStream=this._tokenStream;this._readWhitespace(),checkStart&&tokenStream.mustMatch(Tokens.LBRACE),this._readWhitespace();try{for(;;){if(tokenStream.match(Tokens.SEMICOLON)||readMargins&&this._margin());else{if(!this._declaration())break;if(!tokenStream.match(Tokens.SEMICOLON))break}this._readWhitespace()}tokenStream.mustMatch(Tokens.RBRACE),this._readWhitespace()}catch(ex){if(!(ex instanceof SyntaxError)||this.options.strict)throw ex;if(this.fire({type:"error",error:ex,message:ex.message,line:ex.line,col:ex.col}),tt=tokenStream.advance([Tokens.SEMICOLON,Tokens.RBRACE]),tt==Tokens.SEMICOLON)this._readDeclarations(!1,readMargins);else if(tt!=Tokens.RBRACE)throw ex}},_readWhitespace:function(){for(var tokenStream=this._tokenStream,ws="";tokenStream.match(Tokens.S);)ws+=tokenStream.token().value;return ws},_unexpectedToken:function(token){throw new SyntaxError("Unexpected token \'"+token.value+"\' at line "+token.startLine+", col "+token.startCol+".",token.startLine,token.startCol)},_verifyEnd:function(){this._tokenStream.LA(1)!=Tokens.EOF&&this._unexpectedToken(this._tokenStream.LT(1))},_validateProperty:function(property,value){Validation.validate(property,value)},parse:function(input){this._tokenStream=new TokenStream(input,Tokens),this._stylesheet()},parseStyleSheet:function(input){return this.parse(input)},parseMediaQuery:function(input){this._tokenStream=new TokenStream(input,Tokens);var result=this._media_query();return this._verifyEnd(),result},parsePropertyValue:function(input){this._tokenStream=new TokenStream(input,Tokens),this._readWhitespace();var result=this._expr();return this._readWhitespace(),this._verifyEnd(),result},parseRule:function(input){this._tokenStream=new TokenStream(input,Tokens),this._readWhitespace();var result=this._ruleset();return this._readWhitespace(),this._verifyEnd(),result},parseSelector:function(input){this._tokenStream=new TokenStream(input,Tokens),this._readWhitespace();var result=this._selector();return this._readWhitespace(),this._verifyEnd(),result},parseStyleAttribute:function(input){input+="}",this._tokenStream=new TokenStream(input,Tokens),this._readDeclarations()}};for(prop in additions)additions.hasOwnProperty(prop)&&(proto[prop]=additions[prop]);return proto}();var Properties={"align-items":"flex-start | flex-end | center | baseline | stretch","align-content":"flex-start | flex-end | center | space-between | space-around | stretch","align-self":"auto | flex-start | flex-end | center | baseline | stretch","-webkit-align-items":"flex-start | flex-end | center | baseline | stretch","-webkit-align-content":"flex-start | flex-end | center | space-between | space-around | stretch","-webkit-align-self":"auto | flex-start | flex-end | center | baseline | stretch","alignment-adjust":"auto | baseline | before-edge | text-before-edge | middle | central | after-edge | text-after-edge | ideographic | alphabetic | hanging | mathematical | <percentage> | <length>","alignment-baseline":"baseline | use-script | before-edge | text-before-edge | after-edge | text-after-edge | central | middle | ideographic | alphabetic | hanging | mathematical",animation:1,"animation-delay":{multi:"<time>",comma:!0},"animation-direction":{multi:"normal | alternate",comma:!0},"animation-duration":{multi:"<time>",comma:!0},"animation-iteration-count":{multi:"<number> | infinite",comma:!0},"animation-name":{multi:"none | <ident>",comma:!0},"animation-play-state":{multi:"running | paused",comma:!0},"animation-timing-function":1,"-moz-animation-delay":{multi:"<time>",comma:!0},"-moz-animation-direction":{multi:"normal | alternate",comma:!0},"-moz-animation-duration":{multi:"<time>",comma:!0},"-moz-animation-iteration-count":{multi:"<number> | infinite",comma:!0},"-moz-animation-name":{multi:"none | <ident>",comma:!0},"-moz-animation-play-state":{multi:"running | paused",comma:!0},"-ms-animation-delay":{multi:"<time>",comma:!0},"-ms-animation-direction":{multi:"normal | alternate",comma:!0},"-ms-animation-duration":{multi:"<time>",comma:!0},"-ms-animation-iteration-count":{multi:"<number> | infinite",comma:!0},"-ms-animation-name":{multi:"none | <ident>",comma:!0},"-ms-animation-play-state":{multi:"running | paused",comma:!0},"-webkit-animation-delay":{multi:"<time>",comma:!0},"-webkit-animation-direction":{multi:"normal | alternate",comma:!0},"-webkit-animation-duration":{multi:"<time>",comma:!0},"-webkit-animation-iteration-count":{multi:"<number> | infinite",comma:!0},"-webkit-animation-name":{multi:"none | <ident>",comma:!0},"-webkit-animation-play-state":{multi:"running | paused",comma:!0},"-o-animation-delay":{multi:"<time>",comma:!0},"-o-animation-direction":{multi:"normal | alternate",comma:!0},"-o-animation-duration":{multi:"<time>",comma:!0},"-o-animation-iteration-count":{multi:"<number> | infinite",comma:!0},"-o-animation-name":{multi:"none | <ident>",comma:!0},"-o-animation-play-state":{multi:"running | paused",comma:!0},appearance:"icon | window | desktop | workspace | document | tooltip | dialog | button | push-button | hyperlink | radio-button | checkbox | menu-item | tab | menu | menubar | pull-down-menu | pop-up-menu | list-menu | radio-group | checkbox-group | outline-tree | range | field | combo-box | signature | password | normal | none | inherit",azimuth:function(expression){var part,simple="<angle> | leftwards | rightwards | inherit",direction="left-side | far-left | left | center-left | center | center-right | right | far-right | right-side",behind=!1,valid=!1;if(ValidationTypes.isAny(expression,simple)||(ValidationTypes.isAny(expression,"behind")&&(behind=!0,valid=!0),ValidationTypes.isAny(expression,direction)&&(valid=!0,behind||ValidationTypes.isAny(expression,"behind"))),expression.hasNext())throw part=expression.next(),valid?new ValidationError("Expected end of value but found \'"+part+"\'.",part.line,part.col):new ValidationError("Expected (<\'azimuth\'>) but found \'"+part+"\'.",part.line,part.col)},"backface-visibility":"visible | hidden",background:1,"background-attachment":{multi:"<attachment>",comma:!0},"background-clip":{multi:"<box>",comma:!0},"background-color":"<color> | inherit","background-image":{multi:"<bg-image>",comma:!0},"background-origin":{multi:"<box>",comma:!0},"background-position":{multi:"<bg-position>",comma:!0},"background-repeat":{multi:"<repeat-style>"},"background-size":{multi:"<bg-size>",comma:!0},"baseline-shift":"baseline | sub | super | <percentage> | <length>",behavior:1,binding:1,bleed:"<length>","bookmark-label":"<content> | <attr> | <string>","bookmark-level":"none | <integer>","bookmark-state":"open | closed","bookmark-target":"none | <uri> | <attr>",border:"<border-width> || <border-style> || <color>","border-bottom":"<border-width> || <border-style> || <color>","border-bottom-color":"<color> | inherit","border-bottom-left-radius":"<x-one-radius>","border-bottom-right-radius":"<x-one-radius>","border-bottom-style":"<border-style>","border-bottom-width":"<border-width>","border-collapse":"collapse | separate | inherit","border-color":{multi:"<color> | inherit",max:4},"border-image":1,"border-image-outset":{multi:"<length> | <number>",max:4},"border-image-repeat":{multi:"stretch | repeat | round",max:2},"border-image-slice":function(expression){var part,valid=!1,numeric="<number> | <percentage>",fill=!1,count=0,max=4;for(ValidationTypes.isAny(expression,"fill")&&(fill=!0,valid=!0);expression.hasNext()&&max>count&&(valid=ValidationTypes.isAny(expression,numeric));)count++;if(fill?valid=!0:ValidationTypes.isAny(expression,"fill"),expression.hasNext())throw part=expression.next(),valid?new ValidationError("Expected end of value but found \'"+part+"\'.",part.line,part.col):new ValidationError("Expected ([<number> | <percentage>]{1,4} && fill?) but found \'"+part+"\'.",part.line,part.col)},"border-image-source":"<image> | none","border-image-width":{multi:"<length> | <percentage> | <number> | auto",max:4},"border-left":"<border-width> || <border-style> || <color>","border-left-color":"<color> | inherit","border-left-style":"<border-style>","border-left-width":"<border-width>","border-radius":function(expression){for(var part,valid=!1,simple="<length> | <percentage> | inherit",slash=!1,count=0,max=8;expression.hasNext()&&max>count;){if(valid=ValidationTypes.isAny(expression,simple),!valid){if(!("/"==expression.peek()&&count>0)||slash)break;slash=!0,max=count+5,expression.next()}count++}if(expression.hasNext())throw part=expression.next(),valid?new ValidationError("Expected end of value but found \'"+part+"\'.",part.line,part.col):new ValidationError("Expected (<\'border-radius\'>) but found \'"+part+"\'.",part.line,part.col)},"border-right":"<border-width> || <border-style> || <color>","border-right-color":"<color> | inherit","border-right-style":"<border-style>","border-right-width":"<border-width>","border-spacing":{multi:"<length> | inherit",max:2},"border-style":{multi:"<border-style>",max:4},"border-top":"<border-width> || <border-style> || <color>","border-top-color":"<color> | inherit","border-top-left-radius":"<x-one-radius>","border-top-right-radius":"<x-one-radius>","border-top-style":"<border-style>","border-top-width":"<border-width>","border-width":{multi:"<border-width>",max:4},bottom:"<margin-width> | inherit","-moz-box-align":"start | end | center | baseline | stretch","-moz-box-decoration-break":"slice |clone","-moz-box-direction":"normal | reverse | inherit","-moz-box-flex":"<number>","-moz-box-flex-group":"<integer>","-moz-box-lines":"single | multiple","-moz-box-ordinal-group":"<integer>","-moz-box-orient":"horizontal | vertical | inline-axis | block-axis | inherit","-moz-box-pack":"start | end | center | justify","-webkit-box-align":"start | end | center | baseline | stretch","-webkit-box-decoration-break":"slice |clone","-webkit-box-direction":"normal | reverse | inherit","-webkit-box-flex":"<number>","-webkit-box-flex-group":"<integer>","-webkit-box-lines":"single | multiple","-webkit-box-ordinal-group":"<integer>","-webkit-box-orient":"horizontal | vertical | inline-axis | block-axis | inherit","-webkit-box-pack":"start | end | center | justify","box-shadow":function(expression){var part;if(ValidationTypes.isAny(expression,"none")){if(expression.hasNext())throw part=expression.next(),new ValidationError("Expected end of value but found \'"+part+"\'.",part.line,part.col)}else Validation.multiProperty("<shadow>",expression,!0,1/0)},"box-sizing":"content-box | border-box | inherit","break-after":"auto | always | avoid | left | right | page | column | avoid-page | avoid-column","break-before":"auto | always | avoid | left | right | page | column | avoid-page | avoid-column","break-inside":"auto | avoid | avoid-page | avoid-column","caption-side":"top | bottom | inherit",clear:"none | right | left | both | inherit",clip:1,color:"<color> | inherit","color-profile":1,"column-count":"<integer> | auto","column-fill":"auto | balance","column-gap":"<length> | normal","column-rule":"<border-width> || <border-style> || <color>","column-rule-color":"<color>","column-rule-style":"<border-style>","column-rule-width":"<border-width>","column-span":"none | all","column-width":"<length> | auto",columns:1,content:1,"counter-increment":1,"counter-reset":1,crop:"<shape> | auto",cue:"cue-after | cue-before | inherit","cue-after":1,"cue-before":1,cursor:1,direction:"ltr | rtl | inherit",display:"inline | block | list-item | inline-block | table | inline-table | table-row-group | table-header-group | table-footer-group | table-row | table-column-group | table-column | table-cell | table-caption | grid | inline-grid | none | inherit | -moz-box | -moz-inline-block | -moz-inline-box | -moz-inline-grid | -moz-inline-stack | -moz-inline-table | -moz-grid | -moz-grid-group | -moz-grid-line | -moz-groupbox | -moz-deck | -moz-popup | -moz-stack | -moz-marker | -webkit-box | -webkit-inline-box | -ms-flexbox | -ms-inline-flexbox | flex | -webkit-flex | inline-flex | -webkit-inline-flex","dominant-baseline":1,"drop-initial-after-adjust":"central | middle | after-edge | text-after-edge | ideographic | alphabetic | mathematical | <percentage> | <length>","drop-initial-after-align":"baseline | use-script | before-edge | text-before-edge | after-edge | text-after-edge | central | middle | ideographic | alphabetic | hanging | mathematical","drop-initial-before-adjust":"before-edge | text-before-edge | central | middle | hanging | mathematical | <percentage> | <length>","drop-initial-before-align":"caps-height | baseline | use-script | before-edge | text-before-edge | after-edge | text-after-edge | central | middle | ideographic | alphabetic | hanging | mathematical","drop-initial-size":"auto | line | <length> | <percentage>","drop-initial-value":"initial | <integer>",elevation:"<angle> | below | level | above | higher | lower | inherit","empty-cells":"show | hide | inherit",filter:1,fit:"fill | hidden | meet | slice","fit-position":1,flex:"none | [ <flex-grow> <flex-shrink>? || <flex-basis>","flex-basis":"<width>","flex-direction":"row | row-reverse | column | column-reverse","flex-flow":"<flex-direction> || <flex-wrap>","flex-grow":"<number>","flex-shrink":"<number>","flex-wrap":"nowrap | wrap | wrap-reverse","-webkit-flex":"none | [ <flex-grow> <flex-shrink>? || <flex-basis>","-webkit-flex-basis":"<width>","-webkit-flex-direction":"row | row-reverse | column | column-reverse","-webkit-flex-flow":"<flex-direction> || <flex-wrap>","-webkit-flex-grow":"<number>","-webkit-flex-shrink":"<number>","-webkit-flex-wrap":"nowrap | wrap | wrap-reverse","-ms-flex":"[[ <number> <number>? ] || [ <length> || <percentage> || auto ] ] | none","-ms-flex-align":"start | end | center | stretch | baseline","-ms-flex-direction":"row | column | row-reverse | column-reverse | inherit","-ms-flex-order":"<number>","-ms-flex-pack":"start | end | center | justify","-ms-flex-wrap":"nowrap | wrap | wrap-reverse","float":"left | right | none | inherit","float-offset":1,font:1,"font-family":1,"font-size":"<absolute-size> | <relative-size> | <length> | <percentage> | inherit","font-size-adjust":"<number> | none | inherit","font-stretch":"normal | ultra-condensed | extra-condensed | condensed | semi-condensed | semi-expanded | expanded | extra-expanded | ultra-expanded | inherit","font-style":"normal | italic | oblique | inherit","font-variant":"normal | small-caps | inherit","font-weight":"normal | bold | bolder | lighter | 100 | 200 | 300 | 400 | 500 | 600 | 700 | 800 | 900 | inherit","grid-cell-stacking":"columns | rows | layer","grid-column":1,"grid-columns":1,"grid-column-align":"start | end | center | stretch","grid-column-sizing":1,"grid-column-span":"<integer>","grid-flow":"none | rows | columns","grid-layer":"<integer>","grid-row":1,"grid-rows":1,"grid-row-align":"start | end | center | stretch","grid-row-span":"<integer>","grid-row-sizing":1,"hanging-punctuation":1,height:"<margin-width> | inherit","hyphenate-after":"<integer> | auto","hyphenate-before":"<integer> | auto","hyphenate-character":"<string> | auto","hyphenate-lines":"no-limit | <integer>","hyphenate-resource":1,hyphens:"none | manual | auto",icon:1,"image-orientation":"angle | auto","image-rendering":1,"image-resolution":1,"inline-box-align":"initial | last | <integer>","justify-content":"flex-start | flex-end | center | space-between | space-around","-webkit-justify-content":"flex-start | flex-end | center | space-between | space-around",left:"<margin-width> | inherit","letter-spacing":"<length> | normal | inherit","line-height":"<number> | <length> | <percentage> | normal | inherit","line-break":"auto | loose | normal | strict","line-stacking":1,"line-stacking-ruby":"exclude-ruby | include-ruby","line-stacking-shift":"consider-shifts | disregard-shifts","line-stacking-strategy":"inline-line-height | block-line-height | max-height | grid-height","list-style":1,"list-style-image":"<uri> | none | inherit","list-style-position":"inside | outside | inherit","list-style-type":"disc | circle | square | decimal | decimal-leading-zero | lower-roman | upper-roman | lower-greek | lower-latin | upper-latin | armenian | georgian | lower-alpha | upper-alpha | none | inherit",margin:{multi:"<margin-width> | inherit",max:4},"margin-bottom":"<margin-width> | inherit","margin-left":"<margin-width> | inherit","margin-right":"<margin-width> | inherit","margin-top":"<margin-width> | inherit",mark:1,"mark-after":1,"mark-before":1,marks:1,"marquee-direction":1,"marquee-play-count":1,"marquee-speed":1,"marquee-style":1,"max-height":"<length> | <percentage> | none | inherit","max-width":"<length> | <percentage> | none | inherit","min-height":"<length> | <percentage> | inherit","min-width":"<length> | <percentage> | inherit","move-to":1,"nav-down":1,"nav-index":1,"nav-left":1,"nav-right":1,"nav-up":1,opacity:"<number> | inherit",order:"<integer>","-webkit-order":"<integer>",orphans:"<integer> | inherit",outline:1,"outline-color":"<color> | invert | inherit","outline-offset":1,"outline-style":"<border-style> | inherit","outline-width":"<border-width> | inherit",overflow:"visible | hidden | scroll | auto | inherit","overflow-style":1,"overflow-wrap":"normal | break-word","overflow-x":1,"overflow-y":1,padding:{multi:"<padding-width> | inherit",max:4},"padding-bottom":"<padding-width> | inherit","padding-left":"<padding-width> | inherit","padding-right":"<padding-width> | inherit","padding-top":"<padding-width> | inherit",page:1,"page-break-after":"auto | always | avoid | left | right | inherit","page-break-before":"auto | always | avoid | left | right | inherit","page-break-inside":"auto | avoid | inherit","page-policy":1,pause:1,"pause-after":1,"pause-before":1,perspective:1,"perspective-origin":1,phonemes:1,pitch:1,"pitch-range":1,"play-during":1,"pointer-events":"auto | none | visiblePainted | visibleFill | visibleStroke | visible | painted | fill | stroke | all | inherit",position:"static | relative | absolute | fixed | inherit","presentation-level":1,"punctuation-trim":1,quotes:1,"rendering-intent":1,resize:1,rest:1,"rest-after":1,"rest-before":1,richness:1,right:"<margin-width> | inherit",rotation:1,"rotation-point":1,"ruby-align":1,"ruby-overhang":1,"ruby-position":1,"ruby-span":1,size:1,speak:"normal | none | spell-out | inherit","speak-header":"once | always | inherit","speak-numeral":"digits | continuous | inherit","speak-punctuation":"code | none | inherit","speech-rate":1,src:1,stress:1,"string-set":1,"table-layout":"auto | fixed | inherit","tab-size":"<integer> | <length>",target:1,"target-name":1,"target-new":1,"target-position":1,"text-align":"left | right | center | justify | inherit","text-align-last":1,"text-decoration":1,"text-emphasis":1,"text-height":1,"text-indent":"<length> | <percentage> | inherit","text-justify":"auto | none | inter-word | inter-ideograph | inter-cluster | distribute | kashida","text-outline":1,"text-overflow":1,"text-rendering":"auto | optimizeSpeed | optimizeLegibility | geometricPrecision | inherit","text-shadow":1,"text-transform":"capitalize | uppercase | lowercase | none | inherit","text-wrap":"normal | none | avoid",top:"<margin-width> | inherit","-ms-touch-action":"auto | none | pan-x | pan-y","touch-action":"auto | none | pan-x | pan-y",transform:1,"transform-origin":1,"transform-style":1,transition:1,"transition-delay":1,"transition-duration":1,"transition-property":1,"transition-timing-function":1,"unicode-bidi":"normal | embed | isolate | bidi-override | isolate-override | plaintext | inherit","user-modify":"read-only | read-write | write-only | inherit","user-select":"none | text | toggle | element | elements | all | inherit","vertical-align":"auto | use-script | baseline | sub | super | top | text-top | central | middle | bottom | text-bottom | <percentage> | <length>",visibility:"visible | hidden | collapse | inherit","voice-balance":1,"voice-duration":1,"voice-family":1,"voice-pitch":1,"voice-pitch-range":1,"voice-rate":1,"voice-stress":1,"voice-volume":1,volume:1,"white-space":"normal | pre | nowrap | pre-wrap | pre-line | inherit | -pre-wrap | -o-pre-wrap | -moz-pre-wrap | -hp-pre-wrap","white-space-collapse":1,widows:"<integer> | inherit",width:"<length> | <percentage> | auto | inherit","word-break":"normal | keep-all | break-all","word-spacing":"<length> | normal | inherit","word-wrap":"normal | break-word","writing-mode":"horizontal-tb | vertical-rl | vertical-lr | lr-tb | rl-tb | tb-rl | bt-rl | tb-lr | bt-lr | lr-bt | rl-bt | lr | rl | tb | inherit","z-index":"<integer> | auto | inherit",zoom:"<number> | <percentage> | normal"};PropertyName.prototype=new SyntaxUnit,PropertyName.prototype.constructor=PropertyName,PropertyName.prototype.toString=function(){return(this.hack?this.hack:"")+this.text},PropertyValue.prototype=new SyntaxUnit,PropertyValue.prototype.constructor=PropertyValue,PropertyValueIterator.prototype.count=function(){return this._parts.length},PropertyValueIterator.prototype.isFirst=function(){return 0===this._i},PropertyValueIterator.prototype.hasNext=function(){return this._i<this._parts.length},PropertyValueIterator.prototype.mark=function(){this._marks.push(this._i)},PropertyValueIterator.prototype.peek=function(count){return this.hasNext()?this._parts[this._i+(count||0)]:null},PropertyValueIterator.prototype.next=function(){return this.hasNext()?this._parts[this._i++]:null},PropertyValueIterator.prototype.previous=function(){return this._i>0?this._parts[--this._i]:null},PropertyValueIterator.prototype.restore=function(){this._marks.length&&(this._i=this._marks.pop())},PropertyValuePart.prototype=new SyntaxUnit,PropertyValuePart.prototype.constructor=PropertyValuePart,PropertyValuePart.fromToken=function(token){return new PropertyValuePart(token.value,token.startLine,token.startCol)};var Pseudos={":first-letter":1,":first-line":1,":before":1,":after":1};Pseudos.ELEMENT=1,Pseudos.CLASS=2,Pseudos.isElement=function(pseudo){return 0===pseudo.indexOf("::")||Pseudos[pseudo.toLowerCase()]==Pseudos.ELEMENT},Selector.prototype=new SyntaxUnit,Selector.prototype.constructor=Selector,SelectorPart.prototype=new SyntaxUnit,SelectorPart.prototype.constructor=SelectorPart,SelectorSubPart.prototype=new SyntaxUnit,SelectorSubPart.prototype.constructor=SelectorSubPart,Specificity.prototype={constructor:Specificity,compare:function(other){var i,len,comps=["a","b","c","d"];for(i=0,len=comps.length;len>i;i++){if(this[comps[i]]<other[comps[i]])return-1;if(this[comps[i]]>other[comps[i]])return 1}return 0},valueOf:function(){return 1e3*this.a+100*this.b+10*this.c+this.d},toString:function(){return this.a+","+this.b+","+this.c+","+this.d}},Specificity.calculate=function(selector){function updateValues(part){var i,j,len,num,modifier,elementName=part.elementName?part.elementName.text:"";for(elementName&&"*"!=elementName.charAt(elementName.length-1)&&d++,i=0,len=part.modifiers.length;len>i;i++)switch(modifier=part.modifiers[i],modifier.type){case"class":case"attribute":c++;break;case"id":b++;break;case"pseudo":Pseudos.isElement(modifier.text)?d++:c++;break;case"not":for(j=0,num=modifier.args.length;num>j;j++)updateValues(modifier.args[j])}}var i,len,part,b=0,c=0,d=0;for(i=0,len=selector.parts.length;len>i;i++)part=selector.parts[i],part instanceof SelectorPart&&updateValues(part);return new Specificity(0,b,c,d)};var h=/^[0-9a-fA-F]$/,nonascii=/^[\\u0080-\\uFFFF]$/,nl=/\\n|\\r\\n|\\r|\\f/;TokenStream.prototype=mix(new TokenStreamBase,{_getToken:function(){var c,reader=this._reader,token=null,startLine=reader.getLine(),startCol=reader.getCol();for(c=reader.read();c;){switch(c){case"/":token="*"==reader.peek()?this.commentToken(c,startLine,startCol):this.charToken(c,startLine,startCol);break;case"|":case"~":case"^":case"$":case"*":token="="==reader.peek()?this.comparisonToken(c,startLine,startCol):this.charToken(c,startLine,startCol);break;case\'"\':case"\'":token=this.stringToken(c,startLine,startCol);break;case"#":token=isNameChar(reader.peek())?this.hashToken(c,startLine,startCol):this.charToken(c,startLine,startCol);break;case".":token=isDigit(reader.peek())?this.numberToken(c,startLine,startCol):this.charToken(c,startLine,startCol);break;case"-":token="-"==reader.peek()?this.htmlCommentEndToken(c,startLine,startCol):isNameStart(reader.peek())?this.identOrFunctionToken(c,startLine,startCol):this.charToken(c,startLine,startCol);break;case"!":token=this.importantToken(c,startLine,startCol);break;case"@":token=this.atRuleToken(c,startLine,startCol);break;case":":token=this.notToken(c,startLine,startCol);break;case"<":token=this.htmlCommentStartToken(c,startLine,startCol);break;case"U":case"u":if("+"==reader.peek()){token=this.unicodeRangeToken(c,startLine,startCol);break}default:token=isDigit(c)?this.numberToken(c,startLine,startCol):isWhitespace(c)?this.whitespaceToken(c,startLine,startCol):isIdentStart(c)?this.identOrFunctionToken(c,startLine,startCol):this.charToken(c,startLine,startCol)}break}return token||null!==c||(token=this.createToken(Tokens.EOF,null,startLine,startCol)),token},createToken:function(tt,value,startLine,startCol,options){var reader=this._reader;return options=options||{},{value:value,type:tt,channel:options.channel,hide:options.hide||!1,startLine:startLine,startCol:startCol,endLine:reader.getLine(),endCol:reader.getCol()}},atRuleToken:function(first,startLine,startCol){var ident,rule=first,reader=this._reader,tt=Tokens.CHAR;return reader.mark(),ident=this.readName(),rule=first+ident,tt=Tokens.type(rule.toLowerCase()),(tt==Tokens.CHAR||tt==Tokens.UNKNOWN)&&(rule.length>1?tt=Tokens.UNKNOWN_SYM:(tt=Tokens.CHAR,rule=first,reader.reset())),this.createToken(tt,rule,startLine,startCol)},charToken:function(c,startLine,startCol){var tt=Tokens.type(c);return-1==tt&&(tt=Tokens.CHAR),this.createToken(tt,c,startLine,startCol)},commentToken:function(first,startLine,startCol){var comment=(this._reader,this.readComment(first));return this.createToken(Tokens.COMMENT,comment,startLine,startCol)},comparisonToken:function(c,startLine,startCol){var reader=this._reader,comparison=c+reader.read(),tt=Tokens.type(comparison)||Tokens.CHAR;return this.createToken(tt,comparison,startLine,startCol)},hashToken:function(first,startLine,startCol){var name=(this._reader,this.readName(first));return this.createToken(Tokens.HASH,name,startLine,startCol)},htmlCommentStartToken:function(first,startLine,startCol){var reader=this._reader,text=first;return reader.mark(),text+=reader.readCount(3),"<!--"==text?this.createToken(Tokens.CDO,text,startLine,startCol):(reader.reset(),this.charToken(first,startLine,startCol))},htmlCommentEndToken:function(first,startLine,startCol){var reader=this._reader,text=first;return reader.mark(),text+=reader.readCount(2),"-->"==text?this.createToken(Tokens.CDC,text,startLine,startCol):(reader.reset(),this.charToken(first,startLine,startCol))},identOrFunctionToken:function(first,startLine,startCol){var reader=this._reader,ident=this.readName(first),tt=Tokens.IDENT;return"("==reader.peek()?(ident+=reader.read(),"url("==ident.toLowerCase()?(tt=Tokens.URI,ident=this.readURI(ident),"url("==ident.toLowerCase()&&(tt=Tokens.FUNCTION)):tt=Tokens.FUNCTION):":"==reader.peek()&&"progid"==ident.toLowerCase()&&(ident+=reader.readTo("("),tt=Tokens.IE_FUNCTION),this.createToken(tt,ident,startLine,startCol)},importantToken:function(first,startLine,startCol){var temp,c,reader=this._reader,important=first,tt=Tokens.CHAR;for(reader.mark(),c=reader.read();c;){if("/"==c){if("*"!=reader.peek())break;if(temp=this.readComment(c),""===temp)break}else{if(!isWhitespace(c)){if(/i/i.test(c)){temp=reader.readCount(8),/mportant/i.test(temp)&&(important+=c+temp,tt=Tokens.IMPORTANT_SYM);break}break}important+=c+this.readWhitespace()}c=reader.read()}return tt==Tokens.CHAR?(reader.reset(),this.charToken(first,startLine,startCol)):this.createToken(tt,important,startLine,startCol)},notToken:function(first,startLine,startCol){var reader=this._reader,text=first;return reader.mark(),text+=reader.readCount(4),":not("==text.toLowerCase()?this.createToken(Tokens.NOT,text,startLine,startCol):(reader.reset(),this.charToken(first,startLine,startCol))},numberToken:function(first,startLine,startCol){var ident,reader=this._reader,value=this.readNumber(first),tt=Tokens.NUMBER,c=reader.peek();return isIdentStart(c)?(ident=this.readName(reader.read()),value+=ident,tt=/^em$|^ex$|^px$|^gd$|^rem$|^vw$|^vh$|^vm$|^ch$|^cm$|^mm$|^in$|^pt$|^pc$/i.test(ident)?Tokens.LENGTH:/^deg|^rad$|^grad$/i.test(ident)?Tokens.ANGLE:/^ms$|^s$/i.test(ident)?Tokens.TIME:/^hz$|^khz$/i.test(ident)?Tokens.FREQ:/^dpi$|^dpcm$/i.test(ident)?Tokens.RESOLUTION:Tokens.DIMENSION):"%"==c&&(value+=reader.read(),tt=Tokens.PERCENTAGE),this.createToken(tt,value,startLine,startCol)},stringToken:function(first,startLine,startCol){for(var delim=first,string=first,reader=this._reader,prev=first,tt=Tokens.STRING,c=reader.read();c&&(string+=c,c!=delim||"\\\\"==prev);){if(isNewLine(reader.peek())&&"\\\\"!=c){tt=Tokens.INVALID;break}prev=c,c=reader.read()}return null===c&&(tt=Tokens.INVALID),this.createToken(tt,string,startLine,startCol)},unicodeRangeToken:function(first,startLine,startCol){var temp,reader=this._reader,value=first,tt=Tokens.CHAR;return"+"==reader.peek()&&(reader.mark(),value+=reader.read(),value+=this.readUnicodeRangePart(!0),2==value.length?reader.reset():(tt=Tokens.UNICODE_RANGE,-1==value.indexOf("?")&&"-"==reader.peek()&&(reader.mark(),temp=reader.read(),temp+=this.readUnicodeRangePart(!1),1==temp.length?reader.reset():value+=temp))),this.createToken(tt,value,startLine,startCol)},whitespaceToken:function(first,startLine,startCol){var value=(this._reader,first+this.readWhitespace());return this.createToken(Tokens.S,value,startLine,startCol)},readUnicodeRangePart:function(allowQuestionMark){for(var reader=this._reader,part="",c=reader.peek();isHexDigit(c)&&6>part.length;)reader.read(),part+=c,c=reader.peek();if(allowQuestionMark)for(;"?"==c&&6>part.length;)reader.read(),part+=c,c=reader.peek();return part},readWhitespace:function(){for(var reader=this._reader,whitespace="",c=reader.peek();isWhitespace(c);)reader.read(),whitespace+=c,c=reader.peek();return whitespace},readNumber:function(first){for(var reader=this._reader,number=first,hasDot="."==first,c=reader.peek();c;){if(isDigit(c))number+=reader.read();\nelse{if("."!=c)break;if(hasDot)break;hasDot=!0,number+=reader.read()}c=reader.peek()}return number},readString:function(){for(var reader=this._reader,delim=reader.read(),string=delim,prev=delim,c=reader.peek();c&&(c=reader.read(),string+=c,c!=delim||"\\\\"==prev);){if(isNewLine(reader.peek())&&"\\\\"!=c){string="";break}prev=c,c=reader.peek()}return null===c&&(string=""),string},readURI:function(first){var reader=this._reader,uri=first,inner="",c=reader.peek();for(reader.mark();c&&isWhitespace(c);)reader.read(),c=reader.peek();for(inner="\'"==c||\'"\'==c?this.readString():this.readURL(),c=reader.peek();c&&isWhitespace(c);)reader.read(),c=reader.peek();return""===inner||")"!=c?(uri=first,reader.reset()):uri+=inner+reader.read(),uri},readURL:function(){for(var reader=this._reader,url="",c=reader.peek();/^[!#$%&\\\\*-~]$/.test(c);)url+=reader.read(),c=reader.peek();return url},readName:function(first){for(var reader=this._reader,ident=first||"",c=reader.peek();;)if("\\\\"==c)ident+=this.readEscape(reader.read()),c=reader.peek();else{if(!c||!isNameChar(c))break;ident+=reader.read(),c=reader.peek()}return ident},readEscape:function(first){var reader=this._reader,cssEscape=first||"",i=0,c=reader.peek();if(isHexDigit(c))do cssEscape+=reader.read(),c=reader.peek();while(c&&isHexDigit(c)&&6>++i);return 3==cssEscape.length&&/\\s/.test(c)||7==cssEscape.length||1==cssEscape.length?reader.read():c="",cssEscape+c},readComment:function(first){var reader=this._reader,comment=first||"",c=reader.read();if("*"==c){for(;c;){if(comment+=c,comment.length>2&&"*"==c&&"/"==reader.peek()){comment+=reader.read();break}c=reader.read()}return comment}return""}});var Tokens=[{name:"CDO"},{name:"CDC"},{name:"S",whitespace:!0},{name:"COMMENT",comment:!0,hide:!0,channel:"comment"},{name:"INCLUDES",text:"~="},{name:"DASHMATCH",text:"|="},{name:"PREFIXMATCH",text:"^="},{name:"SUFFIXMATCH",text:"$="},{name:"SUBSTRINGMATCH",text:"*="},{name:"STRING"},{name:"IDENT"},{name:"HASH"},{name:"IMPORT_SYM",text:"@import"},{name:"PAGE_SYM",text:"@page"},{name:"MEDIA_SYM",text:"@media"},{name:"FONT_FACE_SYM",text:"@font-face"},{name:"CHARSET_SYM",text:"@charset"},{name:"NAMESPACE_SYM",text:"@namespace"},{name:"VIEWPORT_SYM",text:["@viewport","@-ms-viewport"]},{name:"UNKNOWN_SYM"},{name:"KEYFRAMES_SYM",text:["@keyframes","@-webkit-keyframes","@-moz-keyframes","@-o-keyframes"]},{name:"IMPORTANT_SYM"},{name:"LENGTH"},{name:"ANGLE"},{name:"TIME"},{name:"FREQ"},{name:"DIMENSION"},{name:"PERCENTAGE"},{name:"NUMBER"},{name:"URI"},{name:"FUNCTION"},{name:"UNICODE_RANGE"},{name:"INVALID"},{name:"PLUS",text:"+"},{name:"GREATER",text:">"},{name:"COMMA",text:","},{name:"TILDE",text:"~"},{name:"NOT"},{name:"TOPLEFTCORNER_SYM",text:"@top-left-corner"},{name:"TOPLEFT_SYM",text:"@top-left"},{name:"TOPCENTER_SYM",text:"@top-center"},{name:"TOPRIGHT_SYM",text:"@top-right"},{name:"TOPRIGHTCORNER_SYM",text:"@top-right-corner"},{name:"BOTTOMLEFTCORNER_SYM",text:"@bottom-left-corner"},{name:"BOTTOMLEFT_SYM",text:"@bottom-left"},{name:"BOTTOMCENTER_SYM",text:"@bottom-center"},{name:"BOTTOMRIGHT_SYM",text:"@bottom-right"},{name:"BOTTOMRIGHTCORNER_SYM",text:"@bottom-right-corner"},{name:"LEFTTOP_SYM",text:"@left-top"},{name:"LEFTMIDDLE_SYM",text:"@left-middle"},{name:"LEFTBOTTOM_SYM",text:"@left-bottom"},{name:"RIGHTTOP_SYM",text:"@right-top"},{name:"RIGHTMIDDLE_SYM",text:"@right-middle"},{name:"RIGHTBOTTOM_SYM",text:"@right-bottom"},{name:"RESOLUTION",state:"media"},{name:"IE_FUNCTION"},{name:"CHAR"},{name:"PIPE",text:"|"},{name:"SLASH",text:"/"},{name:"MINUS",text:"-"},{name:"STAR",text:"*"},{name:"LBRACE",text:"{"},{name:"RBRACE",text:"}"},{name:"LBRACKET",text:"["},{name:"RBRACKET",text:"]"},{name:"EQUALS",text:"="},{name:"COLON",text:":"},{name:"SEMICOLON",text:";"},{name:"LPAREN",text:"("},{name:"RPAREN",text:")"},{name:"DOT",text:"."}];(function(){var nameMap=[],typeMap={};Tokens.UNKNOWN=-1,Tokens.unshift({name:"EOF"});for(var i=0,len=Tokens.length;len>i;i++)if(nameMap.push(Tokens[i].name),Tokens[Tokens[i].name]=i,Tokens[i].text)if(Tokens[i].text instanceof Array)for(var j=0;Tokens[i].text.length>j;j++)typeMap[Tokens[i].text[j]]=i;else typeMap[Tokens[i].text]=i;Tokens.name=function(tt){return nameMap[tt]},Tokens.type=function(c){return typeMap[c]||-1}})();var Validation={validate:function(property,value){var name=(""+property).toLowerCase(),expression=(value.parts,new PropertyValueIterator(value)),spec=Properties[name];if(spec)"number"!=typeof spec&&("string"==typeof spec?spec.indexOf("||")>-1?this.groupProperty(spec,expression):this.singleProperty(spec,expression,1):spec.multi?this.multiProperty(spec.multi,expression,spec.comma,spec.max||1/0):"function"==typeof spec&&spec(expression));else if(0!==name.indexOf("-"))throw new ValidationError("Unknown property \'"+property+"\'.",property.line,property.col)},singleProperty:function(types,expression,max){for(var part,result=!1,value=expression.value,count=0;expression.hasNext()&&max>count&&(result=ValidationTypes.isAny(expression,types));)count++;if(!result)throw expression.hasNext()&&!expression.isFirst()?(part=expression.peek(),new ValidationError("Expected end of value but found \'"+part+"\'.",part.line,part.col)):new ValidationError("Expected ("+types+") but found \'"+value+"\'.",value.line,value.col);if(expression.hasNext())throw part=expression.next(),new ValidationError("Expected end of value but found \'"+part+"\'.",part.line,part.col)},multiProperty:function(types,expression,comma,max){for(var part,result=!1,value=expression.value,count=0;expression.hasNext()&&!result&&max>count&&ValidationTypes.isAny(expression,types);)if(count++,expression.hasNext()){if(comma){if(","!=expression.peek())break;part=expression.next()}}else result=!0;if(!result)throw expression.hasNext()&&!expression.isFirst()?(part=expression.peek(),new ValidationError("Expected end of value but found \'"+part+"\'.",part.line,part.col)):(part=expression.previous(),comma&&","==part?new ValidationError("Expected end of value but found \'"+part+"\'.",part.line,part.col):new ValidationError("Expected ("+types+") but found \'"+value+"\'.",value.line,value.col));if(expression.hasNext())throw part=expression.next(),new ValidationError("Expected end of value but found \'"+part+"\'.",part.line,part.col)},groupProperty:function(types,expression){for(var name,part,result=!1,value=expression.value,typeCount=types.split("||").length,groups={count:0},partial=!1;expression.hasNext()&&!result&&(name=ValidationTypes.isAnyOfGroup(expression,types))&&!groups[name];)groups[name]=1,groups.count++,partial=!0,groups.count!=typeCount&&expression.hasNext()||(result=!0);if(!result)throw partial&&expression.hasNext()?(part=expression.peek(),new ValidationError("Expected end of value but found \'"+part+"\'.",part.line,part.col)):new ValidationError("Expected ("+types+") but found \'"+value+"\'.",value.line,value.col);if(expression.hasNext())throw part=expression.next(),new ValidationError("Expected end of value but found \'"+part+"\'.",part.line,part.col)}};ValidationError.prototype=Error();var ValidationTypes={isLiteral:function(part,literals){var i,len,text=(""+part.text).toLowerCase(),args=literals.split(" | "),found=!1;for(i=0,len=args.length;len>i&&!found;i++)text==args[i].toLowerCase()&&(found=!0);return found},isSimple:function(type){return!!this.simple[type]},isComplex:function(type){return!!this.complex[type]},isAny:function(expression,types){var i,len,args=types.split(" | "),found=!1;for(i=0,len=args.length;len>i&&!found&&expression.hasNext();i++)found=this.isType(expression,args[i]);return found},isAnyOfGroup:function(expression,types){var i,len,args=types.split(" || "),found=!1;for(i=0,len=args.length;len>i&&!found;i++)found=this.isType(expression,args[i]);return found?args[i-1]:!1},isType:function(expression,type){var part=expression.peek(),result=!1;return"<"!=type.charAt(0)?(result=this.isLiteral(part,type),result&&expression.next()):this.simple[type]?(result=this.simple[type](part),result&&expression.next()):result=this.complex[type](expression),result},simple:{"<absolute-size>":function(part){return ValidationTypes.isLiteral(part,"xx-small | x-small | small | medium | large | x-large | xx-large")},"<attachment>":function(part){return ValidationTypes.isLiteral(part,"scroll | fixed | local")},"<attr>":function(part){return"function"==part.type&&"attr"==part.name},"<bg-image>":function(part){return this["<image>"](part)||this["<gradient>"](part)||"none"==part},"<gradient>":function(part){return"function"==part.type&&/^(?:\\-(?:ms|moz|o|webkit)\\-)?(?:repeating\\-)?(?:radial\\-|linear\\-)?gradient/i.test(part)},"<box>":function(part){return ValidationTypes.isLiteral(part,"padding-box | border-box | content-box")},"<content>":function(part){return"function"==part.type&&"content"==part.name},"<relative-size>":function(part){return ValidationTypes.isLiteral(part,"smaller | larger")},"<ident>":function(part){return"identifier"==part.type},"<length>":function(part){return"function"==part.type&&/^(?:\\-(?:ms|moz|o|webkit)\\-)?calc/i.test(part)?!0:"length"==part.type||"number"==part.type||"integer"==part.type||"0"==part},"<color>":function(part){return"color"==part.type||"transparent"==part},"<number>":function(part){return"number"==part.type||this["<integer>"](part)},"<integer>":function(part){return"integer"==part.type},"<line>":function(part){return"integer"==part.type},"<angle>":function(part){return"angle"==part.type},"<uri>":function(part){return"uri"==part.type},"<image>":function(part){return this["<uri>"](part)},"<percentage>":function(part){return"percentage"==part.type||"0"==part},"<border-width>":function(part){return this["<length>"](part)||ValidationTypes.isLiteral(part,"thin | medium | thick")},"<border-style>":function(part){return ValidationTypes.isLiteral(part,"none | hidden | dotted | dashed | solid | double | groove | ridge | inset | outset")},"<margin-width>":function(part){return this["<length>"](part)||this["<percentage>"](part)||ValidationTypes.isLiteral(part,"auto")},"<padding-width>":function(part){return this["<length>"](part)||this["<percentage>"](part)},"<shape>":function(part){return"function"==part.type&&("rect"==part.name||"inset-rect"==part.name)},"<time>":function(part){return"time"==part.type}},complex:{"<bg-position>":function(expression){for(var result=!1,numeric="<percentage> | <length>",xDir="left | right",yDir="top | bottom",count=0;expression.peek(count)&&","!=expression.peek(count);)count++;return 3>count?ValidationTypes.isAny(expression,xDir+" | center | "+numeric)?(result=!0,ValidationTypes.isAny(expression,yDir+" | center | "+numeric)):ValidationTypes.isAny(expression,yDir)&&(result=!0,ValidationTypes.isAny(expression,xDir+" | center")):ValidationTypes.isAny(expression,xDir)?ValidationTypes.isAny(expression,yDir)?(result=!0,ValidationTypes.isAny(expression,numeric)):ValidationTypes.isAny(expression,numeric)&&(ValidationTypes.isAny(expression,yDir)?(result=!0,ValidationTypes.isAny(expression,numeric)):ValidationTypes.isAny(expression,"center")&&(result=!0)):ValidationTypes.isAny(expression,yDir)?ValidationTypes.isAny(expression,xDir)?(result=!0,ValidationTypes.isAny(expression,numeric)):ValidationTypes.isAny(expression,numeric)&&(ValidationTypes.isAny(expression,xDir)?(result=!0,ValidationTypes.isAny(expression,numeric)):ValidationTypes.isAny(expression,"center")&&(result=!0)):ValidationTypes.isAny(expression,"center")&&ValidationTypes.isAny(expression,xDir+" | "+yDir)&&(result=!0,ValidationTypes.isAny(expression,numeric)),result},"<bg-size>":function(expression){var result=!1,numeric="<percentage> | <length> | auto";return ValidationTypes.isAny(expression,"cover | contain")?result=!0:ValidationTypes.isAny(expression,numeric)&&(result=!0,ValidationTypes.isAny(expression,numeric)),result},"<repeat-style>":function(expression){var part,result=!1,values="repeat | space | round | no-repeat";return expression.hasNext()&&(part=expression.next(),ValidationTypes.isLiteral(part,"repeat-x | repeat-y")?result=!0:ValidationTypes.isLiteral(part,values)&&(result=!0,expression.hasNext()&&ValidationTypes.isLiteral(expression.peek(),values)&&expression.next())),result},"<shadow>":function(expression){var result=!1,count=0,inset=!1,color=!1;if(expression.hasNext()){for(ValidationTypes.isAny(expression,"inset")&&(inset=!0),ValidationTypes.isAny(expression,"<color>")&&(color=!0);ValidationTypes.isAny(expression,"<length>")&&4>count;)count++;expression.hasNext()&&(color||ValidationTypes.isAny(expression,"<color>"),inset||ValidationTypes.isAny(expression,"inset")),result=count>=2&&4>=count}return result},"<x-one-radius>":function(expression){var result=!1,simple="<length> | <percentage> | inherit";return ValidationTypes.isAny(expression,simple)&&(result=!0,ValidationTypes.isAny(expression,simple)),result}}};parserlib.css={Colors:Colors,Combinator:Combinator,Parser:Parser,PropertyName:PropertyName,PropertyValue:PropertyValue,PropertyValuePart:PropertyValuePart,MediaFeature:MediaFeature,MediaQuery:MediaQuery,Selector:Selector,SelectorPart:SelectorPart,SelectorSubPart:SelectorSubPart,Specificity:Specificity,TokenStream:TokenStream,Tokens:Tokens,ValidationError:ValidationError}}(),function(){for(var prop in parserlib)exports[prop]=parserlib[prop]}();var CSSLint=function(){function applyEmbeddedRuleset(text,ruleset){var valueMap,embedded=text&&text.match(embeddedRuleset),rules=embedded&&embedded[1];return rules&&(valueMap={"true":2,"":1,"false":0,2:2,1:1,0:0},rules.toLowerCase().split(",").forEach(function(rule){var pair=rule.split(":"),property=pair[0]||"",value=pair[1]||"";ruleset[property.trim()]=valueMap[value.trim()]})),ruleset}var rules=[],formatters=[],embeddedRuleset=/\\/\\*csslint([^\\*]*)\\*\\//,api=new parserlib.util.EventTarget;return api.version="@VERSION@",api.addRule=function(rule){rules.push(rule),rules[rule.id]=rule},api.clearRules=function(){rules=[]},api.getRules=function(){return[].concat(rules).sort(function(a,b){return a.id>b.id?1:0})},api.getRuleset=function(){for(var ruleset={},i=0,len=rules.length;len>i;)ruleset[rules[i++].id]=1;return ruleset},api.addFormatter=function(formatter){formatters[formatter.id]=formatter},api.getFormatter=function(formatId){return formatters[formatId]},api.format=function(results,filename,formatId,options){var formatter=this.getFormatter(formatId),result=null;return formatter&&(result=formatter.startFormat(),result+=formatter.formatResults(results,filename,options||{}),result+=formatter.endFormat()),result},api.hasFormat=function(formatId){return formatters.hasOwnProperty(formatId)},api.verify=function(text,ruleset){var reporter,lines,report,i=0,parser=(rules.length,new parserlib.css.Parser({starHack:!0,ieFilters:!0,underscoreHack:!0,strict:!1}));lines=text.replace(/\\n\\r?/g,"$split$").split("$split$"),ruleset||(ruleset=this.getRuleset()),embeddedRuleset.test(text)&&(ruleset=applyEmbeddedRuleset(text,ruleset)),reporter=new Reporter(lines,ruleset),ruleset.errors=2;for(i in ruleset)ruleset.hasOwnProperty(i)&&ruleset[i]&&rules[i]&&rules[i].init(parser,reporter);try{parser.parse(text)}catch(ex){reporter.error("Fatal error, cannot continue: "+ex.message,ex.line,ex.col,{})}return report={messages:reporter.messages,stats:reporter.stats,ruleset:reporter.ruleset},report.messages.sort(function(a,b){return a.rollup&&!b.rollup?1:!a.rollup&&b.rollup?-1:a.line-b.line}),report},api}();Reporter.prototype={constructor:Reporter,error:function(message,line,col,rule){this.messages.push({type:"error",line:line,col:col,message:message,evidence:this.lines[line-1],rule:rule||{}})},warn:function(message,line,col,rule){this.report(message,line,col,rule)},report:function(message,line,col,rule){this.messages.push({type:2==this.ruleset[rule.id]?"error":"warning",line:line,col:col,message:message,evidence:this.lines[line-1],rule:rule})},info:function(message,line,col,rule){this.messages.push({type:"info",line:line,col:col,message:message,evidence:this.lines[line-1],rule:rule})},rollupError:function(message,rule){this.messages.push({type:"error",rollup:!0,message:message,rule:rule})},rollupWarn:function(message,rule){this.messages.push({type:"warning",rollup:!0,message:message,rule:rule})},stat:function(name,value){this.stats[name]=value}},CSSLint._Reporter=Reporter,CSSLint.Util={mix:function(receiver,supplier){var prop;for(prop in supplier)supplier.hasOwnProperty(prop)&&(receiver[prop]=supplier[prop]);return prop},indexOf:function(values,value){if(values.indexOf)return values.indexOf(value);for(var i=0,len=values.length;len>i;i++)if(values[i]===value)return i;return-1},forEach:function(values,func){if(values.forEach)return values.forEach(func);for(var i=0,len=values.length;len>i;i++)func(values[i],i,values)}},CSSLint.addRule({id:"adjoining-classes",name:"Disallow adjoining classes",desc:"Don\'t use adjoining classes.",browsers:"IE6",init:function(parser,reporter){var rule=this;parser.addListener("startrule",function(event){var selector,part,modifier,classCount,i,j,k,selectors=event.selectors;for(i=0;selectors.length>i;i++)for(selector=selectors[i],j=0;selector.parts.length>j;j++)if(part=selector.parts[j],part.type==parser.SELECTOR_PART_TYPE)for(classCount=0,k=0;part.modifiers.length>k;k++)modifier=part.modifiers[k],"class"==modifier.type&&classCount++,classCount>1&&reporter.report("Don\'t use adjoining classes.",part.line,part.col,rule)})}}),CSSLint.addRule({id:"box-model",name:"Beware of broken box size",desc:"Don\'t use width or height when using padding or border.",browsers:"All",init:function(parser,reporter){function startRule(){properties={},boxSizing=!1}function endRule(){var prop,value;if(!boxSizing){if(properties.height)for(prop in heightProperties)heightProperties.hasOwnProperty(prop)&&properties[prop]&&(value=properties[prop].value,("padding"!=prop||2!==value.parts.length||0!==value.parts[0].value)&&reporter.report("Using height with "+prop+" can sometimes make elements larger than you expect.",properties[prop].line,properties[prop].col,rule));if(properties.width)for(prop in widthProperties)widthProperties.hasOwnProperty(prop)&&properties[prop]&&(value=properties[prop].value,("padding"!=prop||2!==value.parts.length||0!==value.parts[1].value)&&reporter.report("Using width with "+prop+" can sometimes make elements larger than you expect.",properties[prop].line,properties[prop].col,rule))}}var properties,rule=this,widthProperties={border:1,"border-left":1,"border-right":1,padding:1,"padding-left":1,"padding-right":1},heightProperties={border:1,"border-bottom":1,"border-top":1,padding:1,"padding-bottom":1,"padding-top":1},boxSizing=!1;parser.addListener("startrule",startRule),parser.addListener("startfontface",startRule),parser.addListener("startpage",startRule),parser.addListener("startpagemargin",startRule),parser.addListener("startkeyframerule",startRule),parser.addListener("property",function(event){var name=event.property.text.toLowerCase();heightProperties[name]||widthProperties[name]?/^0\\S*$/.test(event.value)||"border"==name&&"none"==event.value||(properties[name]={line:event.property.line,col:event.property.col,value:event.value}):/^(width|height)/i.test(name)&&/^(length|percentage)/.test(event.value.parts[0].type)?properties[name]=1:"box-sizing"==name&&(boxSizing=!0)}),parser.addListener("endrule",endRule),parser.addListener("endfontface",endRule),parser.addListener("endpage",endRule),parser.addListener("endpagemargin",endRule),parser.addListener("endkeyframerule",endRule)}}),CSSLint.addRule({id:"box-sizing",name:"Disallow use of box-sizing",desc:"The box-sizing properties isn\'t supported in IE6 and IE7.",browsers:"IE6, IE7",tags:["Compatibility"],init:function(parser,reporter){var rule=this;parser.addListener("property",function(event){var name=event.property.text.toLowerCase();"box-sizing"==name&&reporter.report("The box-sizing property isn\'t supported in IE6 and IE7.",event.line,event.col,rule)})}}),CSSLint.addRule({id:"bulletproof-font-face",name:"Use the bulletproof @font-face syntax",desc:"Use the bulletproof @font-face syntax to avoid 404\'s in old IE (http://www.fontspring.com/blog/the-new-bulletproof-font-face-syntax).",browsers:"All",init:function(parser,reporter){var line,col,rule=this,fontFaceRule=!1,firstSrc=!0,ruleFailed=!1;parser.addListener("startfontface",function(){fontFaceRule=!0}),parser.addListener("property",function(event){if(fontFaceRule){var propertyName=(""+event.property).toLowerCase(),value=""+event.value;if(line=event.line,col=event.col,"src"===propertyName){var regex=/^\\s?url\\([\'"].+\\.eot\\?.*[\'"]\\)\\s*format\\([\'"]embedded-opentype[\'"]\\).*$/i;!value.match(regex)&&firstSrc?(ruleFailed=!0,firstSrc=!1):value.match(regex)&&!firstSrc&&(ruleFailed=!1)}}}),parser.addListener("endfontface",function(){fontFaceRule=!1,ruleFailed&&reporter.report("@font-face declaration doesn\'t follow the fontspring bulletproof syntax.",line,col,rule)})}}),CSSLint.addRule({id:"compatible-vendor-prefixes",name:"Require compatible vendor prefixes",desc:"Include all compatible vendor prefixes to reach a wider range of users.",browsers:"All",init:function(parser,reporter){var compatiblePrefixes,properties,prop,variations,prefixed,i,len,rule=this,inKeyFrame=!1,arrayPush=Array.prototype.push,applyTo=[];compatiblePrefixes={animation:"webkit moz","animation-delay":"webkit moz","animation-direction":"webkit moz","animation-duration":"webkit moz","animation-fill-mode":"webkit moz","animation-iteration-count":"webkit moz","animation-name":"webkit moz","animation-play-state":"webkit moz","animation-timing-function":"webkit moz",appearance:"webkit moz","border-end":"webkit moz","border-end-color":"webkit moz","border-end-style":"webkit moz","border-end-width":"webkit moz","border-image":"webkit moz o","border-radius":"webkit","border-start":"webkit moz","border-start-color":"webkit moz","border-start-style":"webkit moz","border-start-width":"webkit moz","box-align":"webkit moz ms","box-direction":"webkit moz ms","box-flex":"webkit moz ms","box-lines":"webkit ms","box-ordinal-group":"webkit moz ms","box-orient":"webkit moz ms","box-pack":"webkit moz ms","box-sizing":"webkit moz","box-shadow":"webkit moz","column-count":"webkit moz ms","column-gap":"webkit moz ms","column-rule":"webkit moz ms","column-rule-color":"webkit moz ms","column-rule-style":"webkit moz ms","column-rule-width":"webkit moz ms","column-width":"webkit moz ms",hyphens:"epub moz","line-break":"webkit ms","margin-end":"webkit moz","margin-start":"webkit moz","marquee-speed":"webkit wap","marquee-style":"webkit wap","padding-end":"webkit moz","padding-start":"webkit moz","tab-size":"moz o","text-size-adjust":"webkit ms",transform:"webkit moz ms o","transform-origin":"webkit moz ms o",transition:"webkit moz o","transition-delay":"webkit moz o","transition-duration":"webkit moz o","transition-property":"webkit moz o","transition-timing-function":"webkit moz o","user-modify":"webkit moz","user-select":"webkit moz ms","word-break":"epub ms","writing-mode":"epub ms"};for(prop in compatiblePrefixes)if(compatiblePrefixes.hasOwnProperty(prop)){for(variations=[],prefixed=compatiblePrefixes[prop].split(" "),i=0,len=prefixed.length;len>i;i++)variations.push("-"+prefixed[i]+"-"+prop);compatiblePrefixes[prop]=variations,arrayPush.apply(applyTo,variations)}parser.addListener("startrule",function(){properties=[]}),parser.addListener("startkeyframes",function(event){inKeyFrame=event.prefix||!0}),parser.addListener("endkeyframes",function(){inKeyFrame=!1}),parser.addListener("property",function(event){var name=event.property;CSSLint.Util.indexOf(applyTo,name.text)>-1&&(inKeyFrame&&"string"==typeof inKeyFrame&&0===name.text.indexOf("-"+inKeyFrame+"-")||properties.push(name))}),parser.addListener("endrule",function(){if(properties.length){var i,len,name,prop,variations,value,full,actual,item,propertiesSpecified,propertyGroups={};for(i=0,len=properties.length;len>i;i++){name=properties[i];for(prop in compatiblePrefixes)compatiblePrefixes.hasOwnProperty(prop)&&(variations=compatiblePrefixes[prop],CSSLint.Util.indexOf(variations,name.text)>-1&&(propertyGroups[prop]||(propertyGroups[prop]={full:variations.slice(0),actual:[],actualNodes:[]}),-1===CSSLint.Util.indexOf(propertyGroups[prop].actual,name.text)&&(propertyGroups[prop].actual.push(name.text),propertyGroups[prop].actualNodes.push(name))))}for(prop in propertyGroups)if(propertyGroups.hasOwnProperty(prop)&&(value=propertyGroups[prop],full=value.full,actual=value.actual,full.length>actual.length))for(i=0,len=full.length;len>i;i++)item=full[i],-1===CSSLint.Util.indexOf(actual,item)&&(propertiesSpecified=1===actual.length?actual[0]:2==actual.length?actual.join(" and "):actual.join(", "),reporter.report("The property "+item+" is compatible with "+propertiesSpecified+" and should be included as well.",value.actualNodes[0].line,value.actualNodes[0].col,rule))}})}}),CSSLint.addRule({id:"display-property-grouping",name:"Require properties appropriate for display",desc:"Certain properties shouldn\'t be used with certain display property values.",browsers:"All",init:function(parser,reporter){function reportProperty(name,display,msg){properties[name]&&("string"!=typeof propertiesToCheck[name]||properties[name].value.toLowerCase()!=propertiesToCheck[name])&&reporter.report(msg||name+" can\'t be used with display: "+display+".",properties[name].line,properties[name].col,rule)}function startRule(){properties={}}function endRule(){var display=properties.display?properties.display.value:null;if(display)switch(display){case"inline":reportProperty("height",display),reportProperty("width",display),reportProperty("margin",display),reportProperty("margin-top",display),reportProperty("margin-bottom",display),reportProperty("float",display,"display:inline has no effect on floated elements (but may be used to fix the IE6 double-margin bug).");break;case"block":reportProperty("vertical-align",display);break;case"inline-block":reportProperty("float",display);break;default:0===display.indexOf("table-")&&(reportProperty("margin",display),reportProperty("margin-left",display),reportProperty("margin-right",display),reportProperty("margin-top",display),reportProperty("margin-bottom",display),reportProperty("float",display))}}var properties,rule=this,propertiesToCheck={display:1,"float":"none",height:1,width:1,margin:1,"margin-left":1,"margin-right":1,"margin-bottom":1,"margin-top":1,padding:1,"padding-left":1,"padding-right":1,"padding-bottom":1,"padding-top":1,"vertical-align":1};parser.addListener("startrule",startRule),parser.addListener("startfontface",startRule),parser.addListener("startkeyframerule",startRule),parser.addListener("startpagemargin",startRule),parser.addListener("startpage",startRule),parser.addListener("property",function(event){var name=event.property.text.toLowerCase();propertiesToCheck[name]&&(properties[name]={value:event.value.text,line:event.property.line,col:event.property.col})}),parser.addListener("endrule",endRule),parser.addListener("endfontface",endRule),parser.addListener("endkeyframerule",endRule),parser.addListener("endpagemargin",endRule),parser.addListener("endpage",endRule)}}),CSSLint.addRule({id:"duplicate-background-images",name:"Disallow duplicate background images",desc:"Every background-image should be unique. Use a common class for e.g. sprites.",browsers:"All",init:function(parser,reporter){var rule=this,stack={};parser.addListener("property",function(event){var i,len,name=event.property.text,value=event.value;if(name.match(/background/i))for(i=0,len=value.parts.length;len>i;i++)"uri"==value.parts[i].type&&(stack[value.parts[i].uri]===void 0?stack[value.parts[i].uri]=event:reporter.report("Background image \'"+value.parts[i].uri+"\' was used multiple times, first declared at line "+stack[value.parts[i].uri].line+", col "+stack[value.parts[i].uri].col+".",event.line,event.col,rule))})}}),CSSLint.addRule({id:"duplicate-properties",name:"Disallow duplicate properties",desc:"Duplicate properties must appear one after the other.",browsers:"All",init:function(parser,reporter){function startRule(){properties={}}var properties,lastProperty,rule=this;parser.addListener("startrule",startRule),parser.addListener("startfontface",startRule),parser.addListener("startpage",startRule),parser.addListener("startpagemargin",startRule),parser.addListener("startkeyframerule",startRule),parser.addListener("property",function(event){var property=event.property,name=property.text.toLowerCase();!properties[name]||lastProperty==name&&properties[name]!=event.value.text||reporter.report("Duplicate property \'"+event.property+"\' found.",event.line,event.col,rule),properties[name]=event.value.text,lastProperty=name})}}),CSSLint.addRule({id:"empty-rules",name:"Disallow empty rules",desc:"Rules without any properties specified should be removed.",browsers:"All",init:function(parser,reporter){var rule=this,count=0;parser.addListener("startrule",function(){count=0}),parser.addListener("property",function(){count++}),parser.addListener("endrule",function(event){var selectors=event.selectors;0===count&&reporter.report("Rule is empty.",selectors[0].line,selectors[0].col,rule)})}}),CSSLint.addRule({id:"errors",name:"Parsing Errors",desc:"This rule looks for recoverable syntax errors.",browsers:"All",init:function(parser,reporter){var rule=this;parser.addListener("error",function(event){reporter.error(event.message,event.line,event.col,rule)})}}),CSSLint.addRule({id:"fallback-colors",name:"Require fallback colors",desc:"For older browsers that don\'t support RGBA, HSL, or HSLA, provide a fallback color.",browsers:"IE6,IE7,IE8",init:function(parser,reporter){function startRule(){properties={},lastProperty=null}var lastProperty,properties,rule=this,propertiesToCheck={color:1,background:1,"border-color":1,"border-top-color":1,"border-right-color":1,"border-bottom-color":1,"border-left-color":1,border:1,"border-top":1,"border-right":1,"border-bottom":1,"border-left":1,"background-color":1};parser.addListener("startrule",startRule),parser.addListener("startfontface",startRule),parser.addListener("startpage",startRule),parser.addListener("startpagemargin",startRule),parser.addListener("startkeyframerule",startRule),parser.addListener("property",function(event){var property=event.property,name=property.text.toLowerCase(),parts=event.value.parts,i=0,colorType="",len=parts.length;if(propertiesToCheck[name])for(;len>i;)"color"==parts[i].type&&("alpha"in parts[i]||"hue"in parts[i]?(/([^\\)]+)\\(/.test(parts[i])&&(colorType=RegExp.$1.toUpperCase()),lastProperty&&lastProperty.property.text.toLowerCase()==name&&"compat"==lastProperty.colorType||reporter.report("Fallback "+name+" (hex or RGB) should precede "+colorType+" "+name+".",event.line,event.col,rule)):event.colorType="compat"),i++;lastProperty=event})}}),CSSLint.addRule({id:"floats",name:"Disallow too many floats",desc:"This rule tests if the float property is used too many times",browsers:"All",init:function(parser,reporter){var rule=this,count=0;parser.addListener("property",function(event){"float"==event.property.text.toLowerCase()&&"none"!=event.value.text.toLowerCase()&&count++}),parser.addListener("endstylesheet",function(){reporter.stat("floats",count),count>=10&&reporter.rollupWarn("Too many floats ("+count+"), you\'re probably using them for layout. Consider using a grid system instead.",rule)})}}),CSSLint.addRule({id:"font-faces",name:"Don\'t use too many web fonts",desc:"Too many different web fonts in the same stylesheet.",browsers:"All",init:function(parser,reporter){var rule=this,count=0;parser.addListener("startfontface",function(){count++}),parser.addListener("endstylesheet",function(){count>5&&reporter.rollupWarn("Too many @font-face declarations ("+count+").",rule)})}}),CSSLint.addRule({id:"font-sizes",name:"Disallow too many font sizes",desc:"Checks the number of font-size declarations.",browsers:"All",init:function(parser,reporter){var rule=this,count=0;parser.addListener("property",function(event){"font-size"==event.property&&count++}),parser.addListener("endstylesheet",function(){reporter.stat("font-sizes",count),count>=10&&reporter.rollupWarn("Too many font-size declarations ("+count+"), abstraction needed.",rule)\n})}}),CSSLint.addRule({id:"gradients",name:"Require all gradient definitions",desc:"When using a vendor-prefixed gradient, make sure to use them all.",browsers:"All",init:function(parser,reporter){var gradients,rule=this;parser.addListener("startrule",function(){gradients={moz:0,webkit:0,oldWebkit:0,o:0}}),parser.addListener("property",function(event){/\\-(moz|o|webkit)(?:\\-(?:linear|radial))\\-gradient/i.test(event.value)?gradients[RegExp.$1]=1:/\\-webkit\\-gradient/i.test(event.value)&&(gradients.oldWebkit=1)}),parser.addListener("endrule",function(event){var missing=[];gradients.moz||missing.push("Firefox 3.6+"),gradients.webkit||missing.push("Webkit (Safari 5+, Chrome)"),gradients.oldWebkit||missing.push("Old Webkit (Safari 4+, Chrome)"),gradients.o||missing.push("Opera 11.1+"),missing.length&&4>missing.length&&reporter.report("Missing vendor-prefixed CSS gradients for "+missing.join(", ")+".",event.selectors[0].line,event.selectors[0].col,rule)})}}),CSSLint.addRule({id:"ids",name:"Disallow IDs in selectors",desc:"Selectors should not contain IDs.",browsers:"All",init:function(parser,reporter){var rule=this;parser.addListener("startrule",function(event){var selector,part,modifier,idCount,i,j,k,selectors=event.selectors;for(i=0;selectors.length>i;i++){for(selector=selectors[i],idCount=0,j=0;selector.parts.length>j;j++)if(part=selector.parts[j],part.type==parser.SELECTOR_PART_TYPE)for(k=0;part.modifiers.length>k;k++)modifier=part.modifiers[k],"id"==modifier.type&&idCount++;1==idCount?reporter.report("Don\'t use IDs in selectors.",selector.line,selector.col,rule):idCount>1&&reporter.report(idCount+" IDs in the selector, really?",selector.line,selector.col,rule)}})}}),CSSLint.addRule({id:"import",name:"Disallow @import",desc:"Don\'t use @import, use <link> instead.",browsers:"All",init:function(parser,reporter){var rule=this;parser.addListener("import",function(event){reporter.report("@import prevents parallel downloads, use <link> instead.",event.line,event.col,rule)})}}),CSSLint.addRule({id:"important",name:"Disallow !important",desc:"Be careful when using !important declaration",browsers:"All",init:function(parser,reporter){var rule=this,count=0;parser.addListener("property",function(event){event.important===!0&&(count++,reporter.report("Use of !important",event.line,event.col,rule))}),parser.addListener("endstylesheet",function(){reporter.stat("important",count),count>=10&&reporter.rollupWarn("Too many !important declarations ("+count+"), try to use less than 10 to avoid specificity issues.",rule)})}}),CSSLint.addRule({id:"known-properties",name:"Require use of known properties",desc:"Properties should be known (listed in CSS3 specification) or be a vendor-prefixed property.",browsers:"All",init:function(parser,reporter){var rule=this;parser.addListener("property",function(event){event.property.text.toLowerCase(),event.invalid&&reporter.report(event.invalid.message,event.line,event.col,rule)})}}),CSSLint.addRule({id:"outline-none",name:"Disallow outline: none",desc:"Use of outline: none or outline: 0 should be limited to :focus rules.",browsers:"All",tags:["Accessibility"],init:function(parser,reporter){function startRule(event){lastRule=event.selectors?{line:event.line,col:event.col,selectors:event.selectors,propCount:0,outline:!1}:null}function endRule(){lastRule&&lastRule.outline&&(-1==(""+lastRule.selectors).toLowerCase().indexOf(":focus")?reporter.report("Outlines should only be modified using :focus.",lastRule.line,lastRule.col,rule):1==lastRule.propCount&&reporter.report("Outlines shouldn\'t be hidden unless other visual changes are made.",lastRule.line,lastRule.col,rule))}var lastRule,rule=this;parser.addListener("startrule",startRule),parser.addListener("startfontface",startRule),parser.addListener("startpage",startRule),parser.addListener("startpagemargin",startRule),parser.addListener("startkeyframerule",startRule),parser.addListener("property",function(event){var name=event.property.text.toLowerCase(),value=event.value;lastRule&&(lastRule.propCount++,"outline"!=name||"none"!=value&&"0"!=value||(lastRule.outline=!0))}),parser.addListener("endrule",endRule),parser.addListener("endfontface",endRule),parser.addListener("endpage",endRule),parser.addListener("endpagemargin",endRule),parser.addListener("endkeyframerule",endRule)}}),CSSLint.addRule({id:"overqualified-elements",name:"Disallow overqualified elements",desc:"Don\'t use classes or IDs with elements (a.foo or a#foo).",browsers:"All",init:function(parser,reporter){var rule=this,classes={};parser.addListener("startrule",function(event){var selector,part,modifier,i,j,k,selectors=event.selectors;for(i=0;selectors.length>i;i++)for(selector=selectors[i],j=0;selector.parts.length>j;j++)if(part=selector.parts[j],part.type==parser.SELECTOR_PART_TYPE)for(k=0;part.modifiers.length>k;k++)modifier=part.modifiers[k],part.elementName&&"id"==modifier.type?reporter.report("Element ("+part+") is overqualified, just use "+modifier+" without element name.",part.line,part.col,rule):"class"==modifier.type&&(classes[modifier]||(classes[modifier]=[]),classes[modifier].push({modifier:modifier,part:part}))}),parser.addListener("endstylesheet",function(){var prop;for(prop in classes)classes.hasOwnProperty(prop)&&1==classes[prop].length&&classes[prop][0].part.elementName&&reporter.report("Element ("+classes[prop][0].part+") is overqualified, just use "+classes[prop][0].modifier+" without element name.",classes[prop][0].part.line,classes[prop][0].part.col,rule)})}}),CSSLint.addRule({id:"qualified-headings",name:"Disallow qualified headings",desc:"Headings should not be qualified (namespaced).",browsers:"All",init:function(parser,reporter){var rule=this;parser.addListener("startrule",function(event){var selector,part,i,j,selectors=event.selectors;for(i=0;selectors.length>i;i++)for(selector=selectors[i],j=0;selector.parts.length>j;j++)part=selector.parts[j],part.type==parser.SELECTOR_PART_TYPE&&part.elementName&&/h[1-6]/.test(""+part.elementName)&&j>0&&reporter.report("Heading ("+part.elementName+") should not be qualified.",part.line,part.col,rule)})}}),CSSLint.addRule({id:"regex-selectors",name:"Disallow selectors that look like regexs",desc:"Selectors that look like regular expressions are slow and should be avoided.",browsers:"All",init:function(parser,reporter){var rule=this;parser.addListener("startrule",function(event){var selector,part,modifier,i,j,k,selectors=event.selectors;for(i=0;selectors.length>i;i++)for(selector=selectors[i],j=0;selector.parts.length>j;j++)if(part=selector.parts[j],part.type==parser.SELECTOR_PART_TYPE)for(k=0;part.modifiers.length>k;k++)modifier=part.modifiers[k],"attribute"==modifier.type&&/([\\~\\|\\^\\$\\*]=)/.test(modifier)&&reporter.report("Attribute selectors with "+RegExp.$1+" are slow!",modifier.line,modifier.col,rule)})}}),CSSLint.addRule({id:"rules-count",name:"Rules Count",desc:"Track how many rules there are.",browsers:"All",init:function(parser,reporter){var count=0;parser.addListener("startrule",function(){count++}),parser.addListener("endstylesheet",function(){reporter.stat("rule-count",count)})}}),CSSLint.addRule({id:"selector-max-approaching",name:"Warn when approaching the 4095 selector limit for IE",desc:"Will warn when selector count is >= 3800 selectors.",browsers:"IE",init:function(parser,reporter){var rule=this,count=0;parser.addListener("startrule",function(event){count+=event.selectors.length}),parser.addListener("endstylesheet",function(){count>=3800&&reporter.report("You have "+count+" selectors. Internet Explorer supports a maximum of 4095 selectors per stylesheet. Consider refactoring.",0,0,rule)})}}),CSSLint.addRule({id:"selector-max",name:"Error when past the 4095 selector limit for IE",desc:"Will error when selector count is > 4095.",browsers:"IE",init:function(parser,reporter){var rule=this,count=0;parser.addListener("startrule",function(event){count+=event.selectors.length}),parser.addListener("endstylesheet",function(){count>4095&&reporter.report("You have "+count+" selectors. Internet Explorer supports a maximum of 4095 selectors per stylesheet. Consider refactoring.",0,0,rule)})}}),CSSLint.addRule({id:"shorthand",name:"Require shorthand properties",desc:"Use shorthand properties where possible.",browsers:"All",init:function(parser,reporter){function startRule(){properties={}}function endRule(event){var prop,i,len,total;for(prop in mapping)if(mapping.hasOwnProperty(prop)){for(total=0,i=0,len=mapping[prop].length;len>i;i++)total+=properties[mapping[prop][i]]?1:0;total==mapping[prop].length&&reporter.report("The properties "+mapping[prop].join(", ")+" can be replaced by "+prop+".",event.line,event.col,rule)}}var prop,i,len,properties,rule=this,propertiesToCheck={},mapping={margin:["margin-top","margin-bottom","margin-left","margin-right"],padding:["padding-top","padding-bottom","padding-left","padding-right"]};for(prop in mapping)if(mapping.hasOwnProperty(prop))for(i=0,len=mapping[prop].length;len>i;i++)propertiesToCheck[mapping[prop][i]]=prop;parser.addListener("startrule",startRule),parser.addListener("startfontface",startRule),parser.addListener("property",function(event){var name=(""+event.property).toLowerCase();event.value.parts[0].value,propertiesToCheck[name]&&(properties[name]=1)}),parser.addListener("endrule",endRule),parser.addListener("endfontface",endRule)}}),CSSLint.addRule({id:"star-property-hack",name:"Disallow properties with a star prefix",desc:"Checks for the star property hack (targets IE6/7)",browsers:"All",init:function(parser,reporter){var rule=this;parser.addListener("property",function(event){var property=event.property;"*"==property.hack&&reporter.report("Property with star prefix found.",event.property.line,event.property.col,rule)})}}),CSSLint.addRule({id:"text-indent",name:"Disallow negative text-indent",desc:"Checks for text indent less than -99px",browsers:"All",init:function(parser,reporter){function startRule(){textIndent=!1,direction="inherit"}function endRule(){textIndent&&"ltr"!=direction&&reporter.report("Negative text-indent doesn\'t work well with RTL. If you use text-indent for image replacement explicitly set direction for that item to ltr.",textIndent.line,textIndent.col,rule)}var textIndent,direction,rule=this;parser.addListener("startrule",startRule),parser.addListener("startfontface",startRule),parser.addListener("property",function(event){var name=(""+event.property).toLowerCase(),value=event.value;"text-indent"==name&&-99>value.parts[0].value?textIndent=event.property:"direction"==name&&"ltr"==value&&(direction="ltr")}),parser.addListener("endrule",endRule),parser.addListener("endfontface",endRule)}}),CSSLint.addRule({id:"underscore-property-hack",name:"Disallow properties with an underscore prefix",desc:"Checks for the underscore property hack (targets IE6)",browsers:"All",init:function(parser,reporter){var rule=this;parser.addListener("property",function(event){var property=event.property;"_"==property.hack&&reporter.report("Property with underscore prefix found.",event.property.line,event.property.col,rule)})}}),CSSLint.addRule({id:"unique-headings",name:"Headings should only be defined once",desc:"Headings should be defined only once.",browsers:"All",init:function(parser,reporter){var rule=this,headings={h1:0,h2:0,h3:0,h4:0,h5:0,h6:0};parser.addListener("startrule",function(event){var selector,part,pseudo,i,j,selectors=event.selectors;for(i=0;selectors.length>i;i++)if(selector=selectors[i],part=selector.parts[selector.parts.length-1],part.elementName&&/(h[1-6])/i.test(""+part.elementName)){for(j=0;part.modifiers.length>j;j++)if("pseudo"==part.modifiers[j].type){pseudo=!0;break}pseudo||(headings[RegExp.$1]++,headings[RegExp.$1]>1&&reporter.report("Heading ("+part.elementName+") has already been defined.",part.line,part.col,rule))}}),parser.addListener("endstylesheet",function(){var prop,messages=[];for(prop in headings)headings.hasOwnProperty(prop)&&headings[prop]>1&&messages.push(headings[prop]+" "+prop+"s");messages.length&&reporter.rollupWarn("You have "+messages.join(", ")+" defined in this stylesheet.",rule)})}}),CSSLint.addRule({id:"universal-selector",name:"Disallow universal selector",desc:"The universal selector (*) is known to be slow.",browsers:"All",init:function(parser,reporter){var rule=this;parser.addListener("startrule",function(event){var selector,part,i,selectors=event.selectors;for(i=0;selectors.length>i;i++)selector=selectors[i],part=selector.parts[selector.parts.length-1],"*"==part.elementName&&reporter.report(rule.desc,part.line,part.col,rule)})}}),CSSLint.addRule({id:"unqualified-attributes",name:"Disallow unqualified attribute selectors",desc:"Unqualified attribute selectors are known to be slow.",browsers:"All",init:function(parser,reporter){var rule=this;parser.addListener("startrule",function(event){var selector,part,modifier,i,k,selectors=event.selectors;for(i=0;selectors.length>i;i++)if(selector=selectors[i],part=selector.parts[selector.parts.length-1],part.type==parser.SELECTOR_PART_TYPE)for(k=0;part.modifiers.length>k;k++)modifier=part.modifiers[k],"attribute"!=modifier.type||part.elementName&&"*"!=part.elementName||reporter.report(rule.desc,part.line,part.col,rule)})}}),CSSLint.addRule({id:"vendor-prefix",name:"Require standard property with vendor prefix",desc:"When using a vendor-prefixed property, make sure to include the standard one.",browsers:"All",init:function(parser,reporter){function startRule(){properties={},num=1}function endRule(){var prop,i,len,needed,actual,needsStandard=[];for(prop in properties)propertiesToCheck[prop]&&needsStandard.push({actual:prop,needed:propertiesToCheck[prop]});for(i=0,len=needsStandard.length;len>i;i++)needed=needsStandard[i].needed,actual=needsStandard[i].actual,properties[needed]?properties[needed][0].pos<properties[actual][0].pos&&reporter.report("Standard property \'"+needed+"\' should come after vendor-prefixed property \'"+actual+"\'.",properties[actual][0].name.line,properties[actual][0].name.col,rule):reporter.report("Missing standard property \'"+needed+"\' to go along with \'"+actual+"\'.",properties[actual][0].name.line,properties[actual][0].name.col,rule)}var properties,num,rule=this,propertiesToCheck={"-webkit-border-radius":"border-radius","-webkit-border-top-left-radius":"border-top-left-radius","-webkit-border-top-right-radius":"border-top-right-radius","-webkit-border-bottom-left-radius":"border-bottom-left-radius","-webkit-border-bottom-right-radius":"border-bottom-right-radius","-o-border-radius":"border-radius","-o-border-top-left-radius":"border-top-left-radius","-o-border-top-right-radius":"border-top-right-radius","-o-border-bottom-left-radius":"border-bottom-left-radius","-o-border-bottom-right-radius":"border-bottom-right-radius","-moz-border-radius":"border-radius","-moz-border-radius-topleft":"border-top-left-radius","-moz-border-radius-topright":"border-top-right-radius","-moz-border-radius-bottomleft":"border-bottom-left-radius","-moz-border-radius-bottomright":"border-bottom-right-radius","-moz-column-count":"column-count","-webkit-column-count":"column-count","-moz-column-gap":"column-gap","-webkit-column-gap":"column-gap","-moz-column-rule":"column-rule","-webkit-column-rule":"column-rule","-moz-column-rule-style":"column-rule-style","-webkit-column-rule-style":"column-rule-style","-moz-column-rule-color":"column-rule-color","-webkit-column-rule-color":"column-rule-color","-moz-column-rule-width":"column-rule-width","-webkit-column-rule-width":"column-rule-width","-moz-column-width":"column-width","-webkit-column-width":"column-width","-webkit-column-span":"column-span","-webkit-columns":"columns","-moz-box-shadow":"box-shadow","-webkit-box-shadow":"box-shadow","-moz-transform":"transform","-webkit-transform":"transform","-o-transform":"transform","-ms-transform":"transform","-moz-transform-origin":"transform-origin","-webkit-transform-origin":"transform-origin","-o-transform-origin":"transform-origin","-ms-transform-origin":"transform-origin","-moz-box-sizing":"box-sizing","-webkit-box-sizing":"box-sizing","-moz-user-select":"user-select","-khtml-user-select":"user-select","-webkit-user-select":"user-select"};parser.addListener("startrule",startRule),parser.addListener("startfontface",startRule),parser.addListener("startpage",startRule),parser.addListener("startpagemargin",startRule),parser.addListener("startkeyframerule",startRule),parser.addListener("property",function(event){var name=event.property.text.toLowerCase();properties[name]||(properties[name]=[]),properties[name].push({name:event.property,value:event.value,pos:num++})}),parser.addListener("endrule",endRule),parser.addListener("endfontface",endRule),parser.addListener("endpage",endRule),parser.addListener("endpagemargin",endRule),parser.addListener("endkeyframerule",endRule)}}),CSSLint.addRule({id:"zero-units",name:"Disallow units for 0 values",desc:"You don\'t need to specify units when a value is 0.",browsers:"All",init:function(parser,reporter){var rule=this;parser.addListener("property",function(event){for(var parts=event.value.parts,i=0,len=parts.length;len>i;)!parts[i].units&&"percentage"!=parts[i].type||0!==parts[i].value||"time"==parts[i].type||reporter.report("Values of 0 shouldn\'t have units specified.",parts[i].line,parts[i].col,rule),i++})}}),function(){var xmlEscape=function(str){return str&&str.constructor===String?str.replace(/[\\"&><]/g,function(match){switch(match){case\'"\':return"&quot;";case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;"}}):""};CSSLint.addFormatter({id:"checkstyle-xml",name:"Checkstyle XML format",startFormat:function(){return\'<?xml version="1.0" encoding="utf-8"?><checkstyle>\'},endFormat:function(){return"</checkstyle>"},readError:function(filename,message){return\'<file name="\'+xmlEscape(filename)+\'"><error line="0" column="0" severty="error" message="\'+xmlEscape(message)+\'"></error></file>\'},formatResults:function(results,filename){var messages=results.messages,output=[],generateSource=function(rule){return rule&&"name"in rule?"net.csslint."+rule.name.replace(/\\s/g,""):""};return messages.length>0&&(output.push(\'<file name="\'+filename+\'">\'),CSSLint.Util.forEach(messages,function(message){message.rollup||output.push(\'<error line="\'+message.line+\'" column="\'+message.col+\'" severity="\'+message.type+\'"\'+\' message="\'+xmlEscape(message.message)+\'" source="\'+generateSource(message.rule)+\'"/>\')}),output.push("</file>")),output.join("")}})}(),CSSLint.addFormatter({id:"compact",name:"Compact, \'porcelain\' format",startFormat:function(){return""},endFormat:function(){return""},formatResults:function(results,filename,options){var messages=results.messages,output="";options=options||{};var capitalize=function(str){return str.charAt(0).toUpperCase()+str.slice(1)};return 0===messages.length?options.quiet?"":filename+": Lint Free!":(CSSLint.Util.forEach(messages,function(message){output+=message.rollup?filename+": "+capitalize(message.type)+" - "+message.message+"\\n":filename+": "+"line "+message.line+", col "+message.col+", "+capitalize(message.type)+" - "+message.message+" ("+message.rule.id+")\\n"}),output)}}),CSSLint.addFormatter({id:"csslint-xml",name:"CSSLint XML format",startFormat:function(){return\'<?xml version="1.0" encoding="utf-8"?><csslint>\'},endFormat:function(){return"</csslint>"},formatResults:function(results,filename){var messages=results.messages,output=[],escapeSpecialCharacters=function(str){return str&&str.constructor===String?str.replace(/\\"/g,"\'").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""};return messages.length>0&&(output.push(\'<file name="\'+filename+\'">\'),CSSLint.Util.forEach(messages,function(message){message.rollup?output.push(\'<issue severity="\'+message.type+\'" reason="\'+escapeSpecialCharacters(message.message)+\'" evidence="\'+escapeSpecialCharacters(message.evidence)+\'"/>\'):output.push(\'<issue line="\'+message.line+\'" char="\'+message.col+\'" severity="\'+message.type+\'"\'+\' reason="\'+escapeSpecialCharacters(message.message)+\'" evidence="\'+escapeSpecialCharacters(message.evidence)+\'"/>\')}),output.push("</file>")),output.join("")}}),CSSLint.addFormatter({id:"junit-xml",name:"JUNIT XML format",startFormat:function(){return\'<?xml version="1.0" encoding="utf-8"?><testsuites>\'},endFormat:function(){return"</testsuites>"},formatResults:function(results,filename){var messages=results.messages,output=[],tests={error:0,failure:0},generateSource=function(rule){return rule&&"name"in rule?"net.csslint."+rule.name.replace(/\\s/g,""):""},escapeSpecialCharacters=function(str){return str&&str.constructor===String?str.replace(/\\"/g,"\'").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""};return messages.length>0&&(messages.forEach(function(message){var type="warning"===message.type?"error":message.type;message.rollup||(output.push(\'<testcase time="0" name="\'+generateSource(message.rule)+\'">\'),output.push("<"+type+\' message="\'+escapeSpecialCharacters(message.message)+\'"><![CDATA[\'+message.line+":"+message.col+":"+escapeSpecialCharacters(message.evidence)+"]]></"+type+">"),output.push("</testcase>"),tests[type]+=1)}),output.unshift(\'<testsuite time="0" tests="\'+messages.length+\'" skipped="0" errors="\'+tests.error+\'" failures="\'+tests.failure+\'" package="net.csslint" name="\'+filename+\'">\'),output.push("</testsuite>")),output.join("")}}),CSSLint.addFormatter({id:"lint-xml",name:"Lint XML format",startFormat:function(){return\'<?xml version="1.0" encoding="utf-8"?><lint>\'},endFormat:function(){return"</lint>"},formatResults:function(results,filename){var messages=results.messages,output=[],escapeSpecialCharacters=function(str){return str&&str.constructor===String?str.replace(/\\"/g,"\'").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""};return messages.length>0&&(output.push(\'<file name="\'+filename+\'">\'),CSSLint.Util.forEach(messages,function(message){message.rollup?output.push(\'<issue severity="\'+message.type+\'" reason="\'+escapeSpecialCharacters(message.message)+\'" evidence="\'+escapeSpecialCharacters(message.evidence)+\'"/>\'):output.push(\'<issue line="\'+message.line+\'" char="\'+message.col+\'" severity="\'+message.type+\'"\'+\' reason="\'+escapeSpecialCharacters(message.message)+\'" evidence="\'+escapeSpecialCharacters(message.evidence)+\'"/>\')}),output.push("</file>")),output.join("")}}),CSSLint.addFormatter({id:"text",name:"Plain Text",startFormat:function(){return""},endFormat:function(){return""},formatResults:function(results,filename,options){var messages=results.messages,output="";if(options=options||{},0===messages.length)return options.quiet?"":"\\n\\ncsslint: No errors in "+filename+".";output="\\n\\ncsslint: There are "+messages.length+" problems in "+filename+".";var pos=filename.lastIndexOf("/"),shortFilename=filename;return-1===pos&&(pos=filename.lastIndexOf("\\\\")),pos>-1&&(shortFilename=filename.substring(pos+1)),CSSLint.Util.forEach(messages,function(message,i){output=output+"\\n\\n"+shortFilename,message.rollup?(output+="\\n"+(i+1)+": "+message.type,output+="\\n"+message.message):(output+="\\n"+(i+1)+": "+message.type+" at line "+message.line+", col "+message.col,output+="\\n"+message.message,output+="\\n"+message.evidence)}),output}}),exports.CSSLint=CSSLint}),ace.define("ace/mode/css_worker",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/worker/mirror","ace/mode/css/csslint"],function(acequire,exports){"use strict";var oop=acequire("../lib/oop"),lang=acequire("../lib/lang"),Mirror=acequire("../worker/mirror").Mirror,CSSLint=acequire("./css/csslint").CSSLint,Worker=exports.Worker=function(sender){Mirror.call(this,sender),this.setTimeout(400),this.ruleset=null,this.setDisabledRules("ids"),this.setInfoRules("adjoining-classes|qualified-headings|zero-units|gradients|import|outline-none")};oop.inherits(Worker,Mirror),function(){this.setInfoRules=function(ruleNames){"string"==typeof ruleNames&&(ruleNames=ruleNames.split("|")),this.infoRules=lang.arrayToMap(ruleNames),this.doc.getValue()&&this.deferredUpdate.schedule(100)},this.setDisabledRules=function(ruleNames){if(ruleNames){"string"==typeof ruleNames&&(ruleNames=ruleNames.split("|"));var all={};CSSLint.getRules().forEach(function(x){all[x.id]=!0}),ruleNames.forEach(function(x){delete all[x]}),this.ruleset=all}else this.ruleset=null;this.doc.getValue()&&this.deferredUpdate.schedule(100)},this.onUpdate=function(){var value=this.doc.getValue();if(!value)return this.sender.emit("csslint",[]);var infoRules=this.infoRules,result=CSSLint.verify(value,this.ruleset);this.sender.emit("csslint",result.messages.map(function(msg){return{row:msg.line-1,column:msg.col-1,text:msg.message,type:infoRules[msg.rule.id]?"info":msg.type,rule:msg.rule.name}}))}}.call(Worker.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function Empty(){}function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}function toInteger(n){return n=+n,n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];return array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),lengthBefore+1==array.length,lengthBefore+1==array.length?!0:void 0}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):void 0==pos?pos=0:0>pos&&(pos=Math.max(length+pos,0)),length>pos+removeCount||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailOldPos>tailNewPos)for(var i=0;tailCount>i;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;add>i;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;length>++i;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a non-object: ";\nObject.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT+object);if(owns(object,property)){var descriptor,getter,setter;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),!Object.create){var createEmpty;createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != \'object\'");var Type=function(){};Type.prototype=prototype,object=new Type,object.__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ",ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: ",ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT_TARGET+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=function(freezeObject){return function(object){return"function"==typeof object?object:freezeObject(object)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;ii>i;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="	\\n\x0B\\f\\r \\u2028\\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=RegExp("^"+ws+ws+"*"),trimEndRegexp=RegExp(ws+ws+"*$");String.prototype.trim=function(){return(this+"").replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}var toObject=function(o){if(null==o)throw new TypeError("can\'t convert "+o+" to object");return Object(o)}});';
},function(e,t,i){ace.define("ace/mode/doc_comment_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("./text_highlight_rules").TextHighlightRules,o=function(){this.$rules={start:[{token:"comment.doc.tag",regex:"@[\\w\\d_]+"},{token:"comment.doc.tag",regex:"\\bTODO\\b"},{defaultToken:"comment.doc"}]}};n.inherits(o,s),o.getStartRule=function(e){return{token:"comment.doc",regex:"\\/\\*(?=\\*)",next:e}},o.getEndRule=function(e){return{token:"comment.doc",regex:"\\*\\/",next:e}},t.DocCommentHighlightRules=o}),ace.define("ace/mode/javascript_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/doc_comment_highlight_rules","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("./doc_comment_highlight_rules").DocCommentHighlightRules,o=e("./text_highlight_rules").TextHighlightRules,r=function(){var e=this.createKeywordMapper({"variable.language":"Array|Boolean|Date|Function|Iterator|Number|Object|RegExp|String|Proxy|Namespace|QName|XML|XMLList|ArrayBuffer|Float32Array|Float64Array|Int16Array|Int32Array|Int8Array|Uint16Array|Uint32Array|Uint8Array|Uint8ClampedArray|Error|EvalError|InternalError|RangeError|ReferenceError|StopIteration|SyntaxError|TypeError|URIError|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|eval|isFinite|isNaN|parseFloat|parseInt|JSON|Math|this|arguments|prototype|window|document",keyword:"const|yield|import|get|set|break|case|catch|continue|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|let|var|while|with|debugger|__parent__|__count__|escape|unescape|with|__proto__|class|enum|extends|super|export|implements|private|public|interface|package|protected|static","storage.type":"const|let|var|function","constant.language":"null|Infinity|NaN|undefined","support.function":"alert","constant.language.boolean":"true|false"},"identifier"),t="case|do|else|finally|in|instanceof|return|throw|try|typeof|yield|void",i="[a-zA-Z\\$_-][a-zA-Z\\d\\$_-]*\\b",n="\\\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|[0-2][0-7]{0,2}|3[0-6][0-7]?|37[0-7]?|[4-7][0-7]?|.)";this.$rules={no_regex:[{token:"comment",regex:"\\/\\/",next:"line_comment"},s.getStartRule("doc-start"),{token:"comment",regex:/\/\*/,next:"comment"},{token:"string",regex:"'(?=.)",next:"qstring"},{token:"string",regex:'"(?=.)',next:"qqstring"},{token:"constant.numeric",regex:/0[xX][0-9a-fA-F]+\b/},{token:"constant.numeric",regex:/[+-]?\d+(?:(?:\.\d*)?(?:[eE][+-]?\d+)?)?\b/},{token:["storage.type","punctuation.operator","support.function","punctuation.operator","entity.name.function","text","keyword.operator"],regex:"("+i+")(\\.)(prototype)(\\.)("+i+")(\\s*)(=)",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+i+")(\\.)("+i+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+i+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+i+")(\\.)("+i+")(\\s*)(=)(\\s*)(function)(\\s+)(\\w+)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","text","entity.name.function","text","paren.lparen"],regex:"(function)(\\s+)("+i+")(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","punctuation.operator","text","storage.type","text","paren.lparen"],regex:"("+i+")(\\s*)(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["text","text","storage.type","text","paren.lparen"],regex:"(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:"keyword",regex:"(?:"+t+")\\b",next:"start"},{token:["punctuation.operator","support.function"],regex:/(\.)(s(?:h(?:ift|ow(?:Mod(?:elessDialog|alDialog)|Help))|croll(?:X|By(?:Pages|Lines)?|Y|To)?|t(?:op|rike)|i(?:n|zeToContent|debar|gnText)|ort|u(?:p|b(?:str(?:ing)?)?)|pli(?:ce|t)|e(?:nd|t(?:Re(?:sizable|questHeader)|M(?:i(?:nutes|lliseconds)|onth)|Seconds|Ho(?:tKeys|urs)|Year|Cursor|Time(?:out)?|Interval|ZOptions|Date|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Date|FullYear)|FullYear|Active)|arch)|qrt|lice|avePreferences|mall)|h(?:ome|andleEvent)|navigate|c(?:har(?:CodeAt|At)|o(?:s|n(?:cat|textual|firm)|mpile)|eil|lear(?:Timeout|Interval)?|a(?:ptureEvents|ll)|reate(?:StyleSheet|Popup|EventObject))|t(?:o(?:GMTString|S(?:tring|ource)|U(?:TCString|pperCase)|Lo(?:caleString|werCase))|est|a(?:n|int(?:Enabled)?))|i(?:s(?:NaN|Finite)|ndexOf|talics)|d(?:isableExternalCapture|ump|etachEvent)|u(?:n(?:shift|taint|escape|watch)|pdateCommands)|j(?:oin|avaEnabled)|p(?:o(?:p|w)|ush|lugins.refresh|a(?:ddings|rse(?:Int|Float)?)|r(?:int|ompt|eference))|e(?:scape|nableExternalCapture|val|lementFromPoint|x(?:p|ec(?:Script|Command)?))|valueOf|UTC|queryCommand(?:State|Indeterm|Enabled|Value)|f(?:i(?:nd|le(?:ModifiedDate|Size|CreatedDate|UpdatedDate)|xed)|o(?:nt(?:size|color)|rward)|loor|romCharCode)|watch|l(?:ink|o(?:ad|g)|astIndexOf)|a(?:sin|nchor|cos|t(?:tachEvent|ob|an(?:2)?)|pply|lert|b(?:s|ort))|r(?:ou(?:nd|teEvents)|e(?:size(?:By|To)|calc|turnValue|place|verse|l(?:oad|ease(?:Capture|Events)))|andom)|g(?:o|et(?:ResponseHeader|M(?:i(?:nutes|lliseconds)|onth)|Se(?:conds|lection)|Hours|Year|Time(?:zoneOffset)?|Da(?:y|te)|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Da(?:y|te)|FullYear)|FullYear|A(?:ttention|llResponseHeaders)))|m(?:in|ove(?:B(?:y|elow)|To(?:Absolute)?|Above)|ergeAttributes|a(?:tch|rgins|x))|b(?:toa|ig|o(?:ld|rderWidths)|link|ack))\b(?=\()/},{token:["punctuation.operator","support.function.dom"],regex:/(\.)(s(?:ub(?:stringData|mit)|plitText|e(?:t(?:NamedItem|Attribute(?:Node)?)|lect))|has(?:ChildNodes|Feature)|namedItem|c(?:l(?:ick|o(?:se|neNode))|reate(?:C(?:omment|DATASection|aption)|T(?:Head|extNode|Foot)|DocumentFragment|ProcessingInstruction|E(?:ntityReference|lement)|Attribute))|tabIndex|i(?:nsert(?:Row|Before|Cell|Data)|tem)|open|delete(?:Row|C(?:ell|aption)|T(?:Head|Foot)|Data)|focus|write(?:ln)?|a(?:dd|ppend(?:Child|Data))|re(?:set|place(?:Child|Data)|move(?:NamedItem|Child|Attribute(?:Node)?)?)|get(?:NamedItem|Element(?:sBy(?:Name|TagName)|ById)|Attribute(?:Node)?)|blur)\b(?=\()/},{token:["punctuation.operator","support.constant"],regex:/(\.)(s(?:ystemLanguage|cr(?:ipts|ollbars|een(?:X|Y|Top|Left))|t(?:yle(?:Sheets)?|atus(?:Text|bar)?)|ibling(?:Below|Above)|ource|uffixes|e(?:curity(?:Policy)?|l(?:ection|f)))|h(?:istory|ost(?:name)?|as(?:h|Focus))|y|X(?:MLDocument|SLDocument)|n(?:ext|ame(?:space(?:s|URI)|Prop))|M(?:IN_VALUE|AX_VALUE)|c(?:haracterSet|o(?:n(?:structor|trollers)|okieEnabled|lorDepth|mp(?:onents|lete))|urrent|puClass|l(?:i(?:p(?:boardData)?|entInformation)|osed|asses)|alle(?:e|r)|rypto)|t(?:o(?:olbar|p)|ext(?:Transform|Indent|Decoration|Align)|ags)|SQRT(?:1_2|2)|i(?:n(?:ner(?:Height|Width)|put)|ds|gnoreCase)|zIndex|o(?:scpu|n(?:readystatechange|Line)|uter(?:Height|Width)|p(?:sProfile|ener)|ffscreenBuffering)|NEGATIVE_INFINITY|d(?:i(?:splay|alog(?:Height|Top|Width|Left|Arguments)|rectories)|e(?:scription|fault(?:Status|Ch(?:ecked|arset)|View)))|u(?:ser(?:Profile|Language|Agent)|n(?:iqueID|defined)|pdateInterval)|_content|p(?:ixelDepth|ort|ersonalbar|kcs11|l(?:ugins|atform)|a(?:thname|dding(?:Right|Bottom|Top|Left)|rent(?:Window|Layer)?|ge(?:X(?:Offset)?|Y(?:Offset)?))|r(?:o(?:to(?:col|type)|duct(?:Sub)?|mpter)|e(?:vious|fix)))|e(?:n(?:coding|abledPlugin)|x(?:ternal|pando)|mbeds)|v(?:isibility|endor(?:Sub)?|Linkcolor)|URLUnencoded|P(?:I|OSITIVE_INFINITY)|f(?:ilename|o(?:nt(?:Size|Family|Weight)|rmName)|rame(?:s|Element)|gColor)|E|whiteSpace|l(?:i(?:stStyleType|n(?:eHeight|kColor))|o(?:ca(?:tion(?:bar)?|lName)|wsrc)|e(?:ngth|ft(?:Context)?)|a(?:st(?:M(?:odified|atch)|Index|Paren)|yer(?:s|X)|nguage))|a(?:pp(?:MinorVersion|Name|Co(?:deName|re)|Version)|vail(?:Height|Top|Width|Left)|ll|r(?:ity|guments)|Linkcolor|bove)|r(?:ight(?:Context)?|e(?:sponse(?:XML|Text)|adyState))|global|x|m(?:imeTypes|ultiline|enubar|argin(?:Right|Bottom|Top|Left))|L(?:N(?:10|2)|OG(?:10E|2E))|b(?:o(?:ttom|rder(?:Width|RightWidth|BottomWidth|Style|Color|TopWidth|LeftWidth))|ufferDepth|elow|ackground(?:Color|Image)))\b/},{token:["support.constant"],regex:/that\b/},{token:["storage.type","punctuation.operator","support.function.firebug"],regex:/(console)(\.)(warn|info|log|error|time|trace|timeEnd|assert)\b/},{token:e,regex:i},{token:"keyword.operator",regex:/--|\+\+|[!$%&*+\-~]|===|==|=|!=|!==|<=|>=|<<=|>>=|>>>=|<>|<|>|!|&&|\|\||\?\:|\*=|%=|\+=|\-=|&=|\^=/,next:"start"},{token:"punctuation.operator",regex:/\?|\:|\,|\;|\./,next:"start"},{token:"paren.lparen",regex:/[\[({]/,next:"start"},{token:"paren.rparen",regex:/[\])}]/},{token:"keyword.operator",regex:/\/=?/,next:"start"},{token:"comment",regex:/^#!.*$/}],start:[s.getStartRule("doc-start"),{token:"comment",regex:"\\/\\*",next:"comment_regex_allowed"},{token:"comment",regex:"\\/\\/",next:"line_comment_regex_allowed"},{token:"string.regexp",regex:"\\/",next:"regex"},{token:"text",regex:"\\s+|^$",next:"start"},{token:"empty",regex:"",next:"no_regex"}],regex:[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"string.regexp",regex:"/[sxngimy]*",next:"no_regex"},{token:"invalid",regex:/\{\d+\b,?\d*\}[+*]|[+*$^?][+*]|[$^][?]|\?{3,}/},{token:"constant.language.escape",regex:/\(\?[:=!]|\)|\{\d+\b,?\d*\}|[+*]\?|[()$^+*?.]/},{token:"constant.language.delimiter",regex:/\|/},{token:"constant.language.escape",regex:/\[\^?/,next:"regex_character_class"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp"}],regex_character_class:[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"constant.language.escape",regex:"]",next:"regex"},{token:"constant.language.escape",regex:"-"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp.charachterclass"}],function_arguments:[{token:"variable.parameter",regex:i},{token:"punctuation.operator",regex:"[, ]+"},{token:"punctuation.operator",regex:"$"},{token:"empty",regex:"",next:"no_regex"}],comment_regex_allowed:[{token:"comment",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}],comment:[{token:"comment",regex:"\\*\\/",next:"no_regex"},{defaultToken:"comment"}],line_comment_regex_allowed:[{token:"comment",regex:"$|^",next:"start"},{defaultToken:"comment"}],line_comment:[{token:"comment",regex:"$|^",next:"no_regex"},{defaultToken:"comment"}],qqstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",next:"qqstring"},{token:"string",regex:'"|$',next:"no_regex"},{defaultToken:"string"}],qstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",next:"qstring"},{token:"string",regex:"'|$",next:"no_regex"},{defaultToken:"string"}]},this.embedRules(s,"doc-",[s.getEndRule("no_regex")])};n.inherits(r,o),t.JavaScriptHighlightRules=r}),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],function(e,t,i){"use strict";var n=e("../range").Range,s=function(){};(function(){this.checkOutdent=function(e,t){return/^\s+$/.test(e)?/^\s*\}/.test(t):!1},this.autoOutdent=function(e,t){var i=e.getLine(t),s=i.match(/^(\s*\})/);if(!s)return 0;var o=s[1].length,r=e.findMatchingBracket({row:t,column:o});if(!r||r.row==t)return 0;var a=this.$getIndent(e.getLine(r.row));e.replace(new n(t,0,t,o-1),a)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(s.prototype),t.MatchingBraceOutdent=s}),ace.define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],function(e,t,i){"use strict";var n,s=e("../../lib/oop"),o=e("../behaviour").Behaviour,r=e("../../token_iterator").TokenIterator,a=e("../../lib/lang"),l=["text","paren.rparen","punctuation.operator"],c=["text","paren.rparen","punctuation.operator","comment"],u={},h=function(e){var t=-1;return e.multiSelect&&(t=e.selection.id,u.rangeCount!=e.multiSelect.rangeCount&&(u={rangeCount:e.multiSelect.rangeCount})),u[t]?n=u[t]:void(n=u[t]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""})},d=function(){this.add("braces","insertion",function(e,t,i,s,o){var r=i.getCursorPosition(),l=s.doc.getLine(r.row);if("{"==o){h(i);var c=i.getSelectionRange(),u=s.doc.getTextRange(c);if(""!==u&&"{"!==u&&i.getWrapBehavioursEnabled())return{text:"{"+u+"}",selection:!1};if(d.isSaneInsertion(i,s))return/[\]\}\)]/.test(l[r.column])||i.inMultiSelectMode?(d.recordAutoInsert(i,s,"}"),{text:"{}",selection:[1,1]}):(d.recordMaybeInsert(i,s,"{"),{text:"{",selection:[1,1]})}else if("}"==o){h(i);var p=l.substring(r.column,r.column+1);if("}"==p){var g=s.$findOpeningBracket("}",{column:r.column+1,row:r.row});if(null!==g&&d.isAutoInsertedClosing(r,l,o))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}else{if("\n"==o||"\r\n"==o){h(i);var m="";d.isMaybeInsertedClosing(r,l)&&(m=a.stringRepeat("}",n.maybeInsertedBrackets),d.clearMaybeInsertedClosing());var p=l.substring(r.column,r.column+1);if("}"===p){var f=s.findMatchingBracket({row:r.row,column:r.column+1},"}");if(!f)return null;var v=this.$getIndent(s.getLine(f.row))}else{if(!m)return void d.clearMaybeInsertedClosing();var v=this.$getIndent(l)}var _=v+s.getTabString();return{text:"\n"+_+"\n"+v+m,selection:[1,_.length,1,_.length]}}d.clearMaybeInsertedClosing()}}),this.add("braces","deletion",function(e,t,i,s,o){var r=s.doc.getTextRange(o);if(!o.isMultiLine()&&"{"==r){h(i);var a=s.doc.getLine(o.start.row),l=a.substring(o.end.column,o.end.column+1);if("}"==l)return o.end.column++,o;n.maybeInsertedBrackets--}}),this.add("parens","insertion",function(e,t,i,n,s){if("("==s){h(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return{text:"("+r+")",selection:!1};if(d.isSaneInsertion(i,n))return d.recordAutoInsert(i,n,")"),{text:"()",selection:[1,1]}}else if(")"==s){h(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),c=l.substring(a.column,a.column+1);if(")"==c){var u=n.$findOpeningBracket(")",{column:a.column+1,row:a.row});if(null!==u&&d.isAutoInsertedClosing(a,l,s))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("parens","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"("==o){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(")"==a)return s.end.column++,s}}),this.add("brackets","insertion",function(e,t,i,n,s){if("["==s){h(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return{text:"["+r+"]",selection:!1};if(d.isSaneInsertion(i,n))return d.recordAutoInsert(i,n,"]"),{text:"[]",selection:[1,1]}}else if("]"==s){h(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),c=l.substring(a.column,a.column+1);if("]"==c){var u=n.$findOpeningBracket("]",{column:a.column+1,row:a.row});if(null!==u&&d.isAutoInsertedClosing(a,l,s))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("brackets","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"["==o){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if("]"==a)return s.end.column++,s}}),this.add("string_dquotes","insertion",function(e,t,i,n,s){if('"'==s||"'"==s){h(i);var o=s,r=i.getSelectionRange(),a=n.doc.getTextRange(r);if(""!==a&&"'"!==a&&'"'!=a&&i.getWrapBehavioursEnabled())return{text:o+a+o,selection:!1};var l=i.getCursorPosition(),c=n.doc.getLine(l.row),u=c.substring(l.column-1,l.column);if("\\"==u)return null;for(var p,g=n.getTokens(r.start.row),m=0,f=-1,v=0;v<g.length&&(p=g[v],"string"==p.type?f=-1:0>f&&(f=p.value.indexOf(o)),!(p.value.length+m>r.start.column));v++)m+=g[v].value.length;if(!p||0>f&&"comment"!==p.type&&("string"!==p.type||r.start.column!==p.value.length+m-1&&p.value.lastIndexOf(o)===p.value.length-1)){if(!d.isSaneInsertion(i,n))return;return{text:o+o,selection:[1,1]}}if(p&&"string"===p.type){var _=c.substring(l.column,l.column+1);if(_==o)return{text:"",selection:[1,1]}}}}),this.add("string_dquotes","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&('"'==o||"'"==o)){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(a==o)return s.end.column++,s}})};d.isSaneInsertion=function(e,t){var i=e.getCursorPosition(),n=new r(t,i.row,i.column);if(!this.$matchTokenType(n.getCurrentToken()||"text",l)){var s=new r(t,i.row,i.column+1);if(!this.$matchTokenType(s.getCurrentToken()||"text",l))return!1}return n.stepForward(),n.getCurrentTokenRow()!==i.row||this.$matchTokenType(n.getCurrentToken()||"text",c)},d.$matchTokenType=function(e,t){return t.indexOf(e.type||e)>-1},d.recordAutoInsert=function(e,t,i){var s=e.getCursorPosition(),o=t.doc.getLine(s.row);this.isAutoInsertedClosing(s,o,n.autoInsertedLineEnd[0])||(n.autoInsertedBrackets=0),n.autoInsertedRow=s.row,n.autoInsertedLineEnd=i+o.substr(s.column),n.autoInsertedBrackets++},d.recordMaybeInsert=function(e,t,i){var s=e.getCursorPosition(),o=t.doc.getLine(s.row);this.isMaybeInsertedClosing(s,o)||(n.maybeInsertedBrackets=0),n.maybeInsertedRow=s.row,n.maybeInsertedLineStart=o.substr(0,s.column)+i,n.maybeInsertedLineEnd=o.substr(s.column),n.maybeInsertedBrackets++},d.isAutoInsertedClosing=function(e,t,i){return n.autoInsertedBrackets>0&&e.row===n.autoInsertedRow&&i===n.autoInsertedLineEnd[0]&&t.substr(e.column)===n.autoInsertedLineEnd},d.isMaybeInsertedClosing=function(e,t){return n.maybeInsertedBrackets>0&&e.row===n.maybeInsertedRow&&t.substr(e.column)===n.maybeInsertedLineEnd&&t.substr(0,e.column)==n.maybeInsertedLineStart},d.popAutoInsertedClosing=function(){n.autoInsertedLineEnd=n.autoInsertedLineEnd.substr(1),n.autoInsertedBrackets--},d.clearMaybeInsertedClosing=function(){n&&(n.maybeInsertedBrackets=0,n.maybeInsertedRow=-1)},s.inherits(d,o),t.CstyleBehaviour=d}),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=e("../../range").Range,o=e("./fold_mode").FoldMode,r=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};n.inherits(r,o),function(){this.foldingStartMarker=/(\{|\[)[^\}\]]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{]*(\}|\])|^[\s\*]*(\*\/)/,this.getFoldWidgetRange=function(e,t,i,n){var s=e.getLine(i),o=s.match(this.foldingStartMarker);if(o){var r=o.index;if(o[1])return this.openingBracketBlock(e,o[1],i,r);var a=e.getCommentFoldRange(i,r+o[0].length,1);return a&&!a.isMultiLine()&&(n?a=this.getSectionRange(e,i):"all"!=t&&(a=null)),a}if("markbegin"!==t){var o=s.match(this.foldingStopMarker);if(o){var r=o.index+o[0].length;return o[1]?this.closingBracketBlock(e,o[1],i,r):e.getCommentFoldRange(i,r,-1)}}},this.getSectionRange=function(e,t){var i=e.getLine(t),n=i.search(/\S/),o=t,r=i.length;t+=1;for(var a=t,l=e.getLength();++t<l;){i=e.getLine(t);var c=i.search(/\S/);if(-1!==c){if(n>c)break;var u=this.getFoldWidgetRange(e,"all",t);if(u){if(u.start.row<=o)break;if(u.isMultiLine())t=u.end.row;else if(n==c)break}a=t}}return new s(o,r,a,e.getLine(a).length)}}.call(r.prototype)}),ace.define("ace/mode/javascript",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/javascript_highlight_rules","ace/mode/matching_brace_outdent","ace/range","ace/worker/worker_client","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle"],function(e,t,n){"use strict";var s=e("../lib/oop"),o=e("./text").Mode,r=e("./javascript_highlight_rules").JavaScriptHighlightRules,a=e("./matching_brace_outdent").MatchingBraceOutdent,l=(e("../range").Range,e("../worker/worker_client").WorkerClient),c=e("./behaviour/cstyle").CstyleBehaviour,u=e("./folding/cstyle").FoldMode,h=function(){this.HighlightRules=r,this.$outdent=new a,this.$behaviour=new c,this.foldingRules=new u};s.inherits(h,o),function(){this.lineCommentStart="//",this.blockComment={start:"/*",end:"*/"},this.getNextLineIndent=function(e,t,i){var n=this.$getIndent(t),s=this.getTokenizer().getLineTokens(t,e),o=s.tokens,r=s.state;if(o.length&&"comment"==o[o.length-1].type)return n;if("start"==e||"no_regex"==e){var a=t.match(/^.*(?:\bcase\b.*\:|[\{\(\[])\s*$/);a&&(n+=i)}else if("doc-start"==e){if("start"==r||"no_regex"==r)return"";var a=t.match(/^\s*(\/?)\*/);a&&(a[1]&&(n+=" "),n+="* ")}return n},this.checkOutdent=function(e,t,i){return this.$outdent.checkOutdent(t,i)},this.autoOutdent=function(e,t,i){this.$outdent.autoOutdent(t,i)},this.createWorker=function(e){var t=new l(["ace"],i(413),"JavaScriptWorker");return t.attachToDocument(e.getDocument()),t.on("jslint",function(t){e.setAnnotations(t.data)}),t.on("terminate",function(){e.clearAnnotations()}),t},this.$id="ace/mode/javascript"}.call(h.prototype),t.Mode=h}),ace.define("ace/mode/xml_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("./text_highlight_rules").TextHighlightRules,o=function(e){this.$rules={start:[{token:"string.cdata.xml",regex:"<\\!\\[CDATA\\[",next:"cdata"},{token:["punctuation.xml-decl.xml","keyword.xml-decl.xml"],regex:"(<\\?)(xml)(?=[\\s])",next:"xml_decl",caseInsensitive:!0},{token:["punctuation.instruction.xml","keyword.instruction.xml"],regex:"(<\\?)([-_a-zA-Z0-9]+)",next:"processing_instruction"},{token:"comment.xml",regex:"<\\!--",next:"comment"},{token:["xml-pe.doctype.xml","xml-pe.doctype.xml"],regex:"(<\\!)(DOCTYPE)(?=[\\s])",next:"doctype",caseInsensitive:!0},{include:"tag"},{token:"text.end-tag-open.xml",regex:"</"},{token:"text.tag-open.xml",regex:"<"},{include:"reference"},{defaultToken:"text.xml"}],xml_decl:[{token:"entity.other.attribute-name.decl-attribute-name.xml",regex:"(?:[-_a-zA-Z0-9]+:)?[-_a-zA-Z0-9]+"},{token:"keyword.operator.decl-attribute-equals.xml",regex:"="},{include:"whitespace"},{include:"string"},{token:"punctuation.xml-decl.xml",regex:"\\?>",next:"start"}],processing_instruction:[{token:"punctuation.instruction.xml",regex:"\\?>",next:"start"},{defaultToken:"instruction.xml"}],doctype:[{include:"whitespace"},{include:"string"},{token:"xml-pe.doctype.xml",regex:">",next:"start"},{token:"xml-pe.xml",regex:"[-_a-zA-Z0-9:]+"},{token:"punctuation.int-subset",regex:"\\[",push:"int_subset"}],int_subset:[{token:"text.xml",regex:"\\s+"},{token:"punctuation.int-subset.xml",regex:"]",next:"pop"},{token:["punctuation.markup-decl.xml","keyword.markup-decl.xml"],regex:"(<\\!)([-_a-zA-Z0-9]+)",push:[{token:"text",regex:"\\s+"},{token:"punctuation.markup-decl.xml",regex:">",next:"pop"},{include:"string"}]}],cdata:[{token:"string.cdata.xml",regex:"\\]\\]>",next:"start"},{token:"text.xml",regex:"\\s+"},{token:"text.xml",regex:"(?:[^\\]]|\\](?!\\]>))+"}],comment:[{token:"comment.xml",regex:"-->",next:"start"},{defaultToken:"comment.xml"}],reference:[{token:"constant.language.escape.reference.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}],attr_reference:[{token:"constant.language.escape.reference.attribute-value.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}],tag:[{token:["meta.tag.punctuation.tag-open.xml","meta.tag.punctuation.end-tag-open.xml","meta.tag.tag-name.xml"],regex:"(?:(<)|(</))((?:[-_a-zA-Z0-9]+:)?[-_a-zA-Z0-9]+)",next:[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:"start"}]}],tag_whitespace:[{token:"text.tag-whitespace.xml",regex:"\\s+"}],whitespace:[{token:"text.whitespace.xml",regex:"\\s+"}],string:[{token:"string.xml",regex:"'",push:[{token:"string.xml",regex:"'",next:"pop"},{defaultToken:"string.xml"}]},{token:"string.xml",regex:'"',push:[{token:"string.xml",regex:'"',next:"pop"},{defaultToken:"string.xml"}]}],attributes:[{token:"entity.other.attribute-name.xml",regex:"(?:[-_a-zA-Z0-9]+:)?[-_a-zA-Z0-9]+"},{token:"keyword.operator.attribute-equals.xml",regex:"="},{include:"tag_whitespace"},{include:"attribute_value"}],attribute_value:[{token:"string.attribute-value.xml",regex:"'",push:[{token:"string.attribute-value.xml",regex:"'",next:"pop"},{include:"attr_reference"},{defaultToken:"string.attribute-value.xml"}]},{token:"string.attribute-value.xml",regex:'"',push:[{token:"string.attribute-value.xml",regex:'"',next:"pop"},{include:"attr_reference"},{defaultToken:"string.attribute-value.xml"}]}]},this.constructor===o&&this.normalizeRules()};(function(){this.embedTagRules=function(e,t,i){this.$rules.tag.unshift({token:["meta.tag.punctuation.tag-open.xml","meta.tag."+i+".tag-name.xml"],regex:"(<)("+i+"(?=\\s|>|$))",next:[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:t+"start"}]}),this.$rules[i+"-end"]=[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:"start",onMatch:function(e,t,i){return i.splice(0),this.token}}],this.embedRules(e,t,[{token:["meta.tag.punctuation.end-tag-open.xml","meta.tag."+i+".tag-name.xml"],regex:"(</)("+i+"(?=\\s|>|$))",next:i+"-end"},{token:"string.cdata.xml",regex:"<\\!\\[CDATA\\["},{token:"string.cdata.xml",regex:"\\]\\]>"}])}}).call(s.prototype),n.inherits(o,s),t.XmlHighlightRules=o}),ace.define("ace/mode/behaviour/xml",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator"],function(e,t,i){"use strict";function n(e,t){return e.type.lastIndexOf(t+".xml")>-1}var s=e("../../lib/oop"),o=e("../behaviour").Behaviour,r=e("../../token_iterator").TokenIterator,a=function(){this.add("string_dquotes","insertion",function(e,t,i,s,o){if('"'==o||"'"==o){var a=o,l=s.doc.getTextRange(i.getSelectionRange());if(""!==l&&"'"!==l&&'"'!=l&&i.getWrapBehavioursEnabled())return{text:a+l+a,selection:!1};var c=i.getCursorPosition(),u=s.doc.getLine(c.row),h=u.substring(c.column,c.column+1),d=new r(s,c.row,c.column),p=d.getCurrentToken();if(h==a&&(n(p,"attribute-value")||n(p,"string")))return{text:"",selection:[1,1]};if(p||(p=d.stepBackward()),!p)return;for(;n(p,"tag-whitespace")||n(p,"whitespace");)p=d.stepBackward();var g=!h||h.match(/\s/);if(n(p,"attribute-equals")&&(g||">"==h)||n(p,"decl-attribute-equals")&&(g||"?"==h))return{text:a+a,selection:[1,1]}}}),this.add("string_dquotes","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&('"'==o||"'"==o)){var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(a==o)return s.end.column++,s}}),this.add("autoclosing","insertion",function(e,t,i,s,o){if(">"==o){var a=i.getCursorPosition(),l=new r(s,a.row,a.column),c=l.getCurrentToken()||l.stepBackward();if(!c||!(n(c,"tag-name")||n(c,"tag-whitespace")||n(c,"attribute-name")||n(c,"attribute-equals")||n(c,"attribute-value")))return;if(n(c,"reference.attribute-value"))return;if(n(c,"attribute-value")){var u=c.value.charAt(0);if('"'==u||"'"==u){var h=c.value.charAt(c.value.length-1),d=l.getCurrentTokenColumn()+c.value.length;if(d>a.column||d==a.column&&u!=h)return}}for(;!n(c,"tag-name");)c=l.stepBackward();var p=l.getCurrentTokenRow(),g=l.getCurrentTokenColumn();if(n(l.stepBackward(),"end-tag-open"))return;var m=c.value;if(p==a.row&&(m=m.substring(0,a.column-g)),this.voidElements.hasOwnProperty(m.toLowerCase()))return;return{text:"></"+m+">",selection:[1,1]}}}),this.add("autoindent","insertion",function(e,t,i,n,s){if("\n"==s){var o=i.getCursorPosition(),r=n.getLine(o.row),a=r.substring(o.column,o.column+2);if("</"==a){var l=this.$getIndent(r),c=l+n.getTabString();return{text:"\n"+c+"\n"+l,selection:[1,c.length,1,c.length]}}}})};s.inherits(a,o),t.XmlBehaviour=a}),ace.define("ace/mode/folding/xml",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/range","ace/mode/folding/fold_mode","ace/token_iterator"],function(e,t,i){"use strict";function n(e,t){return e.type.lastIndexOf(t+".xml")>-1}var s=e("../../lib/oop"),o=(e("../../lib/lang"),e("../../range").Range),r=e("./fold_mode").FoldMode,a=e("../../token_iterator").TokenIterator,l=t.FoldMode=function(e,t){r.call(this),this.voidElements=s.mixin(e||{},t||{})};s.inherits(l,r);var c=function(){this.tagName="",this.closing=!1,this.selfClosing=!1,this.start={row:0,column:0},this.end={row:0,column:0}};(function(){this.getFoldWidget=function(e,t,i){var n=this._getFirstTagInLine(e,i);return n?n.closing||!n.tagName&&n.selfClosing?"markbeginend"==t?"end":"":!n.tagName||n.selfClosing||this.voidElements.hasOwnProperty(n.tagName.toLowerCase())?"":this._findEndTagInLine(e,i,n.tagName,n.end.column)?"":"start":""},this._getFirstTagInLine=function(e,t){for(var i=e.getTokens(t),s=new c,o=0;o<i.length;o++){var r=i[o];if(n(r,"tag-open")){if(s.end.column=s.start.column+r.value.length,s.closing=n(r,"end-tag-open"),r=i[++o],!r)return null;for(s.tagName=r.value,s.end.column+=r.value.length,o++;o<i.length;o++)if(r=i[o],s.end.column+=r.value.length,n(r,"tag-close")){s.selfClosing="/>"==r.value;break}return s}if(n(r,"tag-close"))return s.selfClosing="/>"==r.value,s;s.start.column+=r.value.length}return null},this._findEndTagInLine=function(e,t,i,s){for(var o=e.getTokens(t),r=0,a=0;a<o.length;a++){var l=o[a];if(r+=l.value.length,!(s>r)&&n(l,"end-tag-open")&&(l=o[a+1],l&&l.value==i))return!0}return!1},this._readTagForward=function(e){var t=e.getCurrentToken();if(!t)return null;var i=new c;do if(n(t,"tag-open"))i.closing=n(t,"end-tag-open"),i.start.row=e.getCurrentTokenRow(),i.start.column=e.getCurrentTokenColumn();else if(n(t,"tag-name"))i.tagName=t.value;else if(n(t,"tag-close"))return i.selfClosing="/>"==t.value,i.end.row=e.getCurrentTokenRow(),i.end.column=e.getCurrentTokenColumn()+t.value.length,e.stepForward(),i;while(t=e.stepForward());return null},this._readTagBackward=function(e){var t=e.getCurrentToken();if(!t)return null;var i=new c;do{if(n(t,"tag-open"))return i.closing=n(t,"end-tag-open"),i.start.row=e.getCurrentTokenRow(),i.start.column=e.getCurrentTokenColumn(),e.stepBackward(),i;n(t,"tag-name")?i.tagName=t.value:n(t,"tag-close")&&(i.selfClosing="/>"==t.value,i.end.row=e.getCurrentTokenRow(),i.end.column=e.getCurrentTokenColumn()+t.value.length)}while(t=e.stepBackward());return null},this._pop=function(e,t){for(;e.length;){var i=e[e.length-1];if(t&&i.tagName!=t.tagName){if(this.voidElements.hasOwnProperty(t.tagName))return;if(this.voidElements.hasOwnProperty(i.tagName)){e.pop();continue}return null}return e.pop()}},this.getFoldWidgetRange=function(e,t,i){var n=this._getFirstTagInLine(e,i);if(!n)return null;var s,r=n.closing||n.selfClosing,l=[];if(r)for(var c=new a(e,i,n.end.column),u={row:i,column:n.start.column};s=this._readTagBackward(c);){if(s.selfClosing){if(l.length)continue;return s.start.column+=s.tagName.length+2,s.end.column-=2,o.fromPoints(s.start,s.end)}if(s.closing)l.push(s);else if(this._pop(l,s),0==l.length)return s.start.column+=s.tagName.length+2,o.fromPoints(s.start,u)}else for(var c=new a(e,i,n.start.column),h={row:i,column:n.start.column+n.tagName.length+2};s=this._readTagForward(c);){if(s.selfClosing){if(l.length)continue;return s.start.column+=s.tagName.length+2,s.end.column-=2,o.fromPoints(s.start,s.end)}if(s.closing){if(this._pop(l,s),0==l.length)return o.fromPoints(h,s.start)}else l.push(s)}}}).call(l.prototype)}),ace.define("ace/mode/xml",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/text","ace/mode/xml_highlight_rules","ace/mode/behaviour/xml","ace/mode/folding/xml"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("../lib/lang"),o=e("./text").Mode,r=e("./xml_highlight_rules").XmlHighlightRules,a=e("./behaviour/xml").XmlBehaviour,l=e("./folding/xml").FoldMode,c=function(){this.HighlightRules=r,this.$behaviour=new a,this.foldingRules=new l;
};n.inherits(c,o),function(){this.voidElements=s.arrayToMap([]),this.blockComment={start:"<!--",end:"-->"},this.$id="ace/mode/xml"}.call(c.prototype),t.Mode=c}),ace.define("ace/mode/css_highlight_rules",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=(e("../lib/lang"),e("./text_highlight_rules").TextHighlightRules),o=t.supportType="animation-fill-mode|alignment-adjust|alignment-baseline|animation-delay|animation-direction|animation-duration|animation-iteration-count|animation-name|animation-play-state|animation-timing-function|animation|appearance|azimuth|backface-visibility|background-attachment|background-break|background-clip|background-color|background-image|background-origin|background-position|background-repeat|background-size|background|baseline-shift|binding|bleed|bookmark-label|bookmark-level|bookmark-state|bookmark-target|border-bottom|border-bottom-color|border-bottom-left-radius|border-bottom-right-radius|border-bottom-style|border-bottom-width|border-collapse|border-color|border-image|border-image-outset|border-image-repeat|border-image-slice|border-image-source|border-image-width|border-left|border-left-color|border-left-style|border-left-width|border-radius|border-right|border-right-color|border-right-style|border-right-width|border-spacing|border-style|border-top|border-top-color|border-top-left-radius|border-top-right-radius|border-top-style|border-top-width|border-width|border|bottom|box-align|box-decoration-break|box-direction|box-flex-group|box-flex|box-lines|box-ordinal-group|box-orient|box-pack|box-shadow|box-sizing|break-after|break-before|break-inside|caption-side|clear|clip|color-profile|color|column-count|column-fill|column-gap|column-rule|column-rule-color|column-rule-style|column-rule-width|column-span|column-width|columns|content|counter-increment|counter-reset|crop|cue-after|cue-before|cue|cursor|direction|display|dominant-baseline|drop-initial-after-adjust|drop-initial-after-align|drop-initial-before-adjust|drop-initial-before-align|drop-initial-size|drop-initial-value|elevation|empty-cells|fit|fit-position|float-offset|float|font-family|font-size|font-size-adjust|font-stretch|font-style|font-variant|font-weight|font|grid-columns|grid-rows|hanging-punctuation|height|hyphenate-after|hyphenate-before|hyphenate-character|hyphenate-lines|hyphenate-resource|hyphens|icon|image-orientation|image-rendering|image-resolution|inline-box-align|left|letter-spacing|line-height|line-stacking-ruby|line-stacking-shift|line-stacking-strategy|line-stacking|list-style-image|list-style-position|list-style-type|list-style|margin-bottom|margin-left|margin-right|margin-top|margin|mark-after|mark-before|mark|marks|marquee-direction|marquee-play-count|marquee-speed|marquee-style|max-height|max-width|min-height|min-width|move-to|nav-down|nav-index|nav-left|nav-right|nav-up|opacity|orphans|outline-color|outline-offset|outline-style|outline-width|outline|overflow-style|overflow-x|overflow-y|overflow|padding-bottom|padding-left|padding-right|padding-top|padding|page-break-after|page-break-before|page-break-inside|page-policy|page|pause-after|pause-before|pause|perspective-origin|perspective|phonemes|pitch-range|pitch|play-during|pointer-events|position|presentation-level|punctuation-trim|quotes|rendering-intent|resize|rest-after|rest-before|rest|richness|right|rotation-point|rotation|ruby-align|ruby-overhang|ruby-position|ruby-span|size|speak-header|speak-numeral|speak-punctuation|speak|speech-rate|stress|string-set|table-layout|target-name|target-new|target-position|target|text-align-last|text-align|text-decoration|text-emphasis|text-height|text-indent|text-justify|text-outline|text-shadow|text-transform|text-wrap|top|transform-origin|transform-style|transform|transition-delay|transition-duration|transition-property|transition-timing-function|transition|unicode-bidi|vertical-align|visibility|voice-balance|voice-duration|voice-family|voice-pitch-range|voice-pitch|voice-rate|voice-stress|voice-volume|volume|white-space-collapse|white-space|widows|width|word-break|word-spacing|word-wrap|z-index",r=t.supportFunction="rgb|rgba|url|attr|counter|counters",a=t.supportConstant="absolute|after-edge|after|all-scroll|all|alphabetic|always|antialiased|armenian|auto|avoid-column|avoid-page|avoid|balance|baseline|before-edge|before|below|bidi-override|block-line-height|block|bold|bolder|border-box|both|bottom|box|break-all|break-word|capitalize|caps-height|caption|center|central|char|circle|cjk-ideographic|clone|close-quote|col-resize|collapse|column|consider-shifts|contain|content-box|cover|crosshair|cubic-bezier|dashed|decimal-leading-zero|decimal|default|disabled|disc|disregard-shifts|distribute-all-lines|distribute-letter|distribute-space|distribute|dotted|double|e-resize|ease-in|ease-in-out|ease-out|ease|ellipsis|end|exclude-ruby|fill|fixed|georgian|glyphs|grid-height|groove|hand|hanging|hebrew|help|hidden|hiragana-iroha|hiragana|horizontal|icon|ideograph-alpha|ideograph-numeric|ideograph-parenthesis|ideograph-space|ideographic|inactive|include-ruby|inherit|initial|inline-block|inline-box|inline-line-height|inline-table|inline|inset|inside|inter-ideograph|inter-word|invert|italic|justify|katakana-iroha|katakana|keep-all|last|left|lighter|line-edge|line-through|line|linear|list-item|local|loose|lower-alpha|lower-greek|lower-latin|lower-roman|lowercase|lr-tb|ltr|mathematical|max-height|max-size|medium|menu|message-box|middle|move|n-resize|ne-resize|newspaper|no-change|no-close-quote|no-drop|no-open-quote|no-repeat|none|normal|not-allowed|nowrap|nw-resize|oblique|open-quote|outset|outside|overline|padding-box|page|pointer|pre-line|pre-wrap|pre|preserve-3d|progress|relative|repeat-x|repeat-y|repeat|replaced|reset-size|ridge|right|round|row-resize|rtl|s-resize|scroll|se-resize|separate|slice|small-caps|small-caption|solid|space|square|start|static|status-bar|step-end|step-start|steps|stretch|strict|sub|super|sw-resize|table-caption|table-cell|table-column-group|table-column|table-footer-group|table-header-group|table-row-group|table-row|table|tb-rl|text-after-edge|text-before-edge|text-bottom|text-size|text-top|text|thick|thin|transparent|underline|upper-alpha|upper-latin|upper-roman|uppercase|use-script|vertical-ideographic|vertical-text|visible|w-resize|wait|whitespace|z-index|zero",l=t.supportConstantColor="aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow",c=t.supportConstantFonts="arial|century|comic|courier|garamond|georgia|helvetica|impact|lucida|symbol|system|tahoma|times|trebuchet|utopia|verdana|webdings|sans-serif|serif|monospace",u=t.numRe="\\-?(?:(?:[0-9]+)|(?:[0-9]*\\.[0-9]+))",h=t.pseudoElements="(\\:+)\\b(after|before|first-letter|first-line|moz-selection|selection)\\b",d=t.pseudoClasses="(:)\\b(active|checked|disabled|empty|enabled|first-child|first-of-type|focus|hover|indeterminate|invalid|last-child|last-of-type|link|not|nth-child|nth-last-child|nth-last-of-type|nth-of-type|only-child|only-of-type|acequired|root|target|valid|visited)\\b",p=function(){var e=this.createKeywordMapper({"support.function":r,"support.constant":a,"support.type":o,"support.constant.color":l,"support.constant.fonts":c},"text",!0);this.$rules={start:[{token:"comment",regex:"\\/\\*",push:"comment"},{token:"paren.lparen",regex:"\\{",push:"ruleset"},{token:"string",regex:"@.*?{",push:"media"},{token:"keyword",regex:"#[a-z0-9-_]+"},{token:"variable",regex:"\\.[a-z0-9-_]+"},{token:"string",regex:":[a-z0-9-_]+"},{token:"constant",regex:"[a-z0-9-_]+"},{caseInsensitive:!0}],media:[{token:"comment",regex:"\\/\\*",push:"comment"},{token:"paren.lparen",regex:"\\{",push:"ruleset"},{token:"string",regex:"\\}",next:"pop"},{token:"keyword",regex:"#[a-z0-9-_]+"},{token:"variable",regex:"\\.[a-z0-9-_]+"},{token:"string",regex:":[a-z0-9-_]+"},{token:"constant",regex:"[a-z0-9-_]+"},{caseInsensitive:!0}],comment:[{token:"comment",regex:"\\*\\/",next:"pop"},{defaultToken:"comment"}],ruleset:[{token:"paren.rparen",regex:"\\}",next:"pop"},{token:"comment",regex:"\\/\\*",push:"comment"},{token:"string",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]'},{token:"string",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:["constant.numeric","keyword"],regex:"("+u+")(ch|cm|deg|em|ex|fr|gd|grad|Hz|in|kHz|mm|ms|pc|pt|px|rad|rem|s|turn|vh|vm|vw|%)"},{token:"constant.numeric",regex:u},{token:"constant.numeric",regex:"#[a-f0-9]{6}"},{token:"constant.numeric",regex:"#[a-f0-9]{3}"},{token:["punctuation","entity.other.attribute-name.pseudo-element.css"],regex:h},{token:["punctuation","entity.other.attribute-name.pseudo-class.css"],regex:d},{token:["support.function","string","support.function"],regex:"(url\\()(.*)(\\))"},{token:e,regex:"\\-?[a-zA-Z_][a-zA-Z0-9_\\-]*"},{caseInsensitive:!0}]},this.normalizeRules()};n.inherits(p,s),t.CssHighlightRules=p}),ace.define("ace/mode/behaviour/css",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/mode/behaviour/cstyle","ace/token_iterator"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=(e("../behaviour").Behaviour,e("./cstyle").CstyleBehaviour),o=e("../../token_iterator").TokenIterator,r=function(){this.inherit(s),this.add("colon","insertion",function(e,t,i,n,s){if(":"===s){var r=i.getCursorPosition(),a=new o(n,r.row,r.column),l=a.getCurrentToken();if(l&&l.value.match(/\s+/)&&(l=a.stepBackward()),l&&"support.type"===l.type){var c=n.doc.getLine(r.row),u=c.substring(r.column,r.column+1);if(":"===u)return{text:"",selection:[1,1]};if(!c.substring(r.column).match(/^\s*;/))return{text:":;",selection:[1,1]}}}}),this.add("colon","deletion",function(e,t,i,n,s){var r=n.doc.getTextRange(s);if(!s.isMultiLine()&&":"===r){var a=i.getCursorPosition(),l=new o(n,a.row,a.column),c=l.getCurrentToken();if(c&&c.value.match(/\s+/)&&(c=l.stepBackward()),c&&"support.type"===c.type){var u=n.doc.getLine(s.start.row),h=u.substring(s.end.column,s.end.column+1);if(";"===h)return s.end.column++,s}}}),this.add("semicolon","insertion",function(e,t,i,n,s){if(";"===s){var o=i.getCursorPosition(),r=n.doc.getLine(o.row),a=r.substring(o.column,o.column+1);if(";"===a)return{text:"",selection:[1,1]}}})};n.inherits(r,s),t.CssBehaviour=r}),ace.define("ace/mode/css",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/css_highlight_rules","ace/mode/matching_brace_outdent","ace/worker/worker_client","ace/mode/behaviour/css","ace/mode/folding/cstyle"],function(e,t,n){"use strict";var s=e("../lib/oop"),o=e("./text").Mode,r=e("./css_highlight_rules").CssHighlightRules,a=e("./matching_brace_outdent").MatchingBraceOutdent,l=e("../worker/worker_client").WorkerClient,c=e("./behaviour/css").CssBehaviour,u=e("./folding/cstyle").FoldMode,h=function(){this.HighlightRules=r,this.$outdent=new a,this.$behaviour=new c,this.foldingRules=new u};s.inherits(h,o),function(){this.foldingRules="cStyle",this.blockComment={start:"/*",end:"*/"},this.getNextLineIndent=function(e,t,i){var n=this.$getIndent(t),s=this.getTokenizer().getLineTokens(t,e).tokens;if(s.length&&"comment"==s[s.length-1].type)return n;var o=t.match(/^.*\{\s*$/);return o&&(n+=i),n},this.checkOutdent=function(e,t,i){return this.$outdent.checkOutdent(t,i)},this.autoOutdent=function(e,t,i){this.$outdent.autoOutdent(t,i)},this.createWorker=function(e){var t=new l(["ace"],i(414),"Worker");return t.attachToDocument(e.getDocument()),t.on("csslint",function(t){e.setAnnotations(t.data)}),t.on("terminate",function(){e.clearAnnotations()}),t},this.$id="ace/mode/css"}.call(h.prototype),t.Mode=h}),ace.define("ace/mode/html_highlight_rules",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/css_highlight_rules","ace/mode/javascript_highlight_rules","ace/mode/xml_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("../lib/lang"),o=e("./css_highlight_rules").CssHighlightRules,r=e("./javascript_highlight_rules").JavaScriptHighlightRules,a=e("./xml_highlight_rules").XmlHighlightRules,l=s.createMap({a:"anchor",button:"form",form:"form",img:"image",input:"form",label:"form",option:"form",script:"script",select:"form",textarea:"form",style:"style",table:"table",tbody:"table",td:"table",tfoot:"table",th:"table",tr:"table"}),c=function(){a.call(this),this.addRules({attributes:[{include:"tag_whitespace"},{token:"entity.other.attribute-name.xml",regex:"[-_a-zA-Z0-9:]+"},{token:"keyword.operator.attribute-equals.xml",regex:"=",push:[{include:"tag_whitespace"},{token:"string.unquoted.attribute-value.html",regex:"[^<>='\"`\\s]+",next:"pop"},{token:"empty",regex:"",next:"pop"}]},{include:"attribute_value"}],tag:[{token:function(e,t){var i=l[t];return["meta.tag.punctuation."+("<"==e?"":"end-")+"tag-open.xml","meta.tag"+(i?"."+i:"")+".tag-name.xml"]},regex:"(</?)([-_a-zA-Z0-9:]+)",next:"tag_stuff"}],tag_stuff:[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:"start"}]}),this.embedTagRules(o,"css-","style"),this.embedTagRules(r,"js-","script"),this.constructor===c&&this.normalizeRules()};n.inherits(c,a),t.HtmlHighlightRules=c}),ace.define("ace/mode/folding/mixed",["require","exports","module","ace/lib/oop","ace/mode/folding/fold_mode"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=e("./fold_mode").FoldMode,o=t.FoldMode=function(e,t){this.defaultMode=e,this.subModes=t};n.inherits(o,s),function(){this.$getMode=function(e){"string"!=typeof e&&(e=e[0]);for(var t in this.subModes)if(0===e.indexOf(t))return this.subModes[t];return null},this.$tryMode=function(e,t,i,n){var s=this.$getMode(e);return s?s.getFoldWidget(t,i,n):""},this.getFoldWidget=function(e,t,i){return this.$tryMode(e.getState(i-1),e,t,i)||this.$tryMode(e.getState(i),e,t,i)||this.defaultMode.getFoldWidget(e,t,i)},this.getFoldWidgetRange=function(e,t,i){var n=this.$getMode(e.getState(i-1));return n&&n.getFoldWidget(e,t,i)||(n=this.$getMode(e.getState(i))),n&&n.getFoldWidget(e,t,i)||(n=this.defaultMode),n.getFoldWidgetRange(e,t,i)}}.call(o.prototype)}),ace.define("ace/mode/folding/html",["require","exports","module","ace/lib/oop","ace/mode/folding/mixed","ace/mode/folding/xml","ace/mode/folding/cstyle"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=e("./mixed").FoldMode,o=e("./xml").FoldMode,r=e("./cstyle").FoldMode,a=t.FoldMode=function(e,t){s.call(this,new o(e,t),{"js-":new r,"css-":new r})};n.inherits(a,s)}),ace.define("ace/mode/html_completions",["require","exports","module","ace/token_iterator"],function(e,t,i){"use strict";function n(e,t){return e.type.lastIndexOf(t+".xml")>-1}function s(e,t){for(var i=new o(e,t.row,t.column),s=i.getCurrentToken();s&&!n(s,"tag-name");)s=i.stepBackward();return s?s.value:void 0}var o=e("../token_iterator").TokenIterator,r=["accesskey","class","contenteditable","contextmenu","dir","draggable","dropzone","hidden","id","inert","itemid","itemprop","itemref","itemscope","itemtype","lang","spellcheck","style","tabindex","title","translate"],a=["onabort","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextmenu","oncuechange","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onpause","onplay","onplaying","onprogress","onratechange","onreset","onscroll","onseeked","onseeking","onselect","onshow","onstalled","onsubmit","onsuspend","ontimeupdate","onvolumechange","onwaiting"],l=r.concat(a),c={html:["manifest"],head:[],title:[],base:["href","target"],link:["href","hreflang","rel","media","type","sizes"],meta:["http-equiv","name","content","charset"],style:["type","media","scoped"],script:["charset","type","src","defer","async"],noscript:["href"],body:["onafterprint","onbeforeprint","onbeforeunload","onhashchange","onmessage","onoffline","onpopstate","onredo","onresize","onstorage","onundo","onunload"],section:[],nav:[],article:["pubdate"],aside:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],footer:[],address:[],main:[],p:[],hr:[],pre:[],blockquote:["cite"],ol:["start","reversed"],ul:[],li:["value"],dl:[],dt:[],dd:[],figure:[],figcaption:[],div:[],a:["href","target","ping","rel","media","hreflang","type"],em:[],strong:[],small:[],s:[],cite:[],q:["cite"],dfn:[],abbr:[],data:[],time:["datetime"],code:[],"var":[],samp:[],kbd:[],sub:[],sup:[],i:[],b:[],u:[],mark:[],ruby:[],rt:[],rp:[],bdi:[],bdo:[],span:[],br:[],wbr:[],ins:["cite","datetime"],del:["cite","datetime"],img:["alt","src","height","width","usemap","ismap"],iframe:["name","src","height","width","sandbox","seamless"],embed:["src","height","width","type"],object:["param","data","type","height","width","usemap","name","form","classid"],param:["name","value"],video:["src","autobuffer","autoplay","loop","controls","width","height","poster"],audio:["src","autobuffer","autoplay","loop","controls"],source:["src","type","media"],track:["kind","src","srclang","label","default"],canvas:["width","height"],map:["name"],area:["shape","coords","href","hreflang","alt","target","media","rel","ping","type"],svg:[],math:[],table:["summary"],caption:[],colgroup:["span"],col:["span"],tbody:[],thead:[],tfoot:[],tr:[],td:["headers","rowspan","colspan"],th:["headers","rowspan","colspan","scope"],form:["accept-charset","action","autocomplete","enctype","method","name","novalidate","target"],fieldset:["disabled","form","name"],legend:[],label:["form","for"],input:["type","accept","alt","autocomplete","checked","disabled","form","formaction","formenctype","formmethod","formnovalidate","formtarget","height","list","max","maxlength","min","multiple","pattern","placeholder","readonly","acequired","size","src","step","width","files","value"],button:["autofocus","disabled","form","formaction","formenctype","formmethod","formnovalidate","formtarget","name","value","type"],select:["autofocus","disabled","form","multiple","name","size"],datalist:[],optgroup:["disabled","label"],option:["disabled","selected","label","value"],textarea:["autofocus","disabled","form","maxlength","name","placeholder","readonly","acequired","rows","cols","wrap"],keygen:["autofocus","challenge","disabled","form","keytype","name"],output:["for","form","name"],progress:["value","max"],meter:["value","min","max","low","high","optimum"],details:["open"],summary:[],command:["type","label","icon","disabled","checked","radiogroup","command"],menu:["type","label"],dialog:["open"]},u=Object.keys(c),h=function(){};(function(){this.getCompletions=function(e,t,i,s){var o=t.getTokenAt(i.row,i.column);return o?n(o,"tag-name")||n(o,"tag-open")||n(o,"end-tag-open")?this.getTagCompletions(e,t,i,s):n(o,"tag-whitespace")||n(o,"attribute-name")?this.getAttributeCompetions(e,t,i,s):[]:[]},this.getTagCompletions=function(e,t,i,n){return u.map(function(e){return{value:e,meta:"tag",score:Number.MAX_VALUE}})},this.getAttributeCompetions=function(e,t,i,n){var o=s(t,i);if(!o)return[];var r=l;return o in c&&(r=r.concat(c[o])),r.map(function(e){return{caption:e,snippet:e+'="$0"',meta:"attribute",score:Number.MAX_VALUE}})}}).call(h.prototype),t.HtmlCompletions=h}),ace.define("ace/mode/html",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/text","ace/mode/javascript","ace/mode/css","ace/mode/html_highlight_rules","ace/mode/behaviour/xml","ace/mode/folding/html","ace/mode/html_completions","ace/worker/worker_client"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("../lib/lang"),o=e("./text").Mode,r=e("./javascript").Mode,a=e("./css").Mode,l=e("./html_highlight_rules").HtmlHighlightRules,c=e("./behaviour/xml").XmlBehaviour,u=e("./folding/html").FoldMode,h=e("./html_completions").HtmlCompletions,d=e("../worker/worker_client").WorkerClient,p=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],g=["li","dt","dd","p","rt","rp","optgroup","option","colgroup","td","th"],m=function(e){this.fragmentContext=e&&e.fragmentContext,this.HighlightRules=l,this.$behaviour=new c,this.$completer=new h,this.createModeDelegates({"js-":r,"css-":a}),this.foldingRules=new u(this.voidElements,s.arrayToMap(g))};n.inherits(m,o),function(){this.blockComment={start:"<!--",end:"-->"},this.voidElements=s.arrayToMap(p),this.getNextLineIndent=function(e,t,i){return this.$getIndent(t)},this.checkOutdent=function(e,t,i){return!1},this.getCompletions=function(e,t,i,n){return this.$completer.getCompletions(e,t,i,n)},this.createWorker=function(e){if(this.constructor==m){var t=new d(["ace"],"ace/mode/html_worker","Worker");return t.attachToDocument(e.getDocument()),this.fragmentContext&&t.call("setOptions",[{context:this.fragmentContext}]),t.on("error",function(t){e.setAnnotations(t.data)}),t.on("terminate",function(){e.clearAnnotations()}),t}},this.$id="ace/mode/html"}.call(m.prototype),t.Mode=m}),ace.define("ace/mode/markdown_highlight_rules",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/text_highlight_rules","ace/mode/javascript_highlight_rules","ace/mode/xml_highlight_rules","ace/mode/html_highlight_rules","ace/mode/css_highlight_rules"],function(e,t,i){"use strict";function n(e,t){return{token:"support.function",regex:"^\\s*```"+e+"\\s*$",push:t+"start"}}var s=e("../lib/oop"),o=e("../lib/lang"),r=e("./text_highlight_rules").TextHighlightRules,a=e("./javascript_highlight_rules").JavaScriptHighlightRules,l=e("./xml_highlight_rules").XmlHighlightRules,c=e("./html_highlight_rules").HtmlHighlightRules,u=e("./css_highlight_rules").CssHighlightRules,h=function(e){return"(?:[^"+o.escapeRegExp(e)+"\\\\]|\\\\.)*"},d=function(){c.call(this),this.$rules.start.unshift({token:"empty_line",regex:"^$",next:"allowBlock"},{token:"markup.heading.1",regex:"^=+(?=\\s*$)"},{token:"markup.heading.2",regex:"^\\-+(?=\\s*$)"},{token:function(e){return"markup.heading."+e.length},regex:/^#{1,6}(?=\s*[^ #]|\s+#.)/,next:"header"},n("(?:javascript|js)","jscode-"),n("xml","xmlcode-"),n("html","htmlcode-"),n("css","csscode-"),{token:"support.function",regex:"^\\s*```\\s*\\S*(?:{.*?\\})?\\s*$",next:"githubblock"},{token:"string.blockquote",regex:"^\\s*>\\s*(?:[*+-]|\\d+\\.)?\\s+",next:"blockquote"},{token:"constant",regex:"^ {0,2}(?:(?: ?\\* ?){3,}|(?: ?\\- ?){3,}|(?: ?\\_ ?){3,})\\s*$",next:"allowBlock"},{token:"markup.list",regex:"^\\s{0,3}(?:[*+-]|\\d+\\.)\\s+",next:"listblock-start"},{include:"basic"}),this.addRules({basic:[{token:"constant.language.escape",regex:/\\[\\`*_{}\[\]()#+\-.!]/},{token:"support.function",regex:"(`+)(.*?[^`])(\\1)"},{token:["text","constant","text","url","string","text"],regex:'^([ ]{0,3}\\[)([^\\]]+)(\\]:\\s*)([^ ]+)(\\s*(?:["][^"]+["])?(\\s*))$'},{token:["text","string","text","constant","text"],regex:"(\\[)("+h("]")+")(\\]s*\\[)("+h("]")+")(\\])"},{token:["text","string","text","markup.underline","string","text"],regex:"(\\[)("+h("]")+')(\\]\\()((?:[^\\)\\s\\\\]|\\\\.|\\s(?=[^"]))*)(\\s*"'+h('"')+'"\\s*)?(\\))'},{token:"string.strong",regex:"([*]{2}|[_]{2}(?=\\S))(.*?\\S[*_]*)(\\1)"},{token:"string.emphasis",regex:"([*]|[_](?=\\S))(.*?\\S[*_]*)(\\1)"},{token:["text","url","text"],regex:"(<)((?:https?|ftp|dict):[^'\">\\s]+|(?:mailto:)?[-.\\w]+\\@[-a-z0-9]+(?:\\.[-a-z0-9]+)*\\.[a-z]+)(>)"}],allowBlock:[{token:"support.function",regex:"^ {4}.+",next:"allowBlock"},{token:"empty",regex:"",next:"start"}],header:[{regex:"$",next:"start"},{include:"basic"},{defaultToken:"heading"}],"listblock-start":[{token:"support.variable",regex:/(?:\[[ x]\])?/,next:"listblock"}],listblock:[{token:"empty_line",regex:"^$",next:"start"},{token:"markup.list",regex:"^\\s{0,3}(?:[*+-]|\\d+\\.)\\s+",next:"listblock-start"},{include:"basic",noEscape:!0},{token:"support.function",regex:"^\\s*```\\s*[a-zA-Z]*(?:{.*?\\})?\\s*$",next:"githubblock"},{defaultToken:"list"}],blockquote:[{token:"empty_line",regex:"^\\s*$",next:"start"},{token:"string.blockquote",regex:"^\\s*>\\s*(?:[*+-]|\\d+\\.)?\\s+",next:"blockquote"},{include:"basic",noEscape:!0},{defaultToken:"string.blockquote"}],githubblock:[{token:"support.function",regex:"^\\s*```",next:"start"},{token:"support.function",regex:".+"}]}),this.embedRules(a,"jscode-",[{token:"support.function",regex:"^\\s*```",next:"pop"}]),this.embedRules(c,"htmlcode-",[{token:"support.function",regex:"^\\s*```",next:"pop"}]),this.embedRules(u,"csscode-",[{token:"support.function",regex:"^\\s*```",next:"pop"}]),this.embedRules(l,"xmlcode-",[{token:"support.function",regex:"^\\s*```",next:"pop"}]),this.normalizeRules()};s.inherits(d,r),t.MarkdownHighlightRules=d}),ace.define("ace/mode/folding/markdown",["require","exports","module","ace/lib/oop","ace/mode/folding/fold_mode","ace/range"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=e("./fold_mode").FoldMode,o=e("../../range").Range,r=t.FoldMode=function(){};n.inherits(r,s),function(){this.foldingStartMarker=/^(?:[=-]+\s*$|#{1,6} |`{3})/,this.getFoldWidget=function(e,t,i){var n=e.getLine(i);return this.foldingStartMarker.test(n)?"`"==n[0]&&"start"==e.bgTokenizer.getState(i)?"end":"start":""},this.getFoldWidgetRange=function(e,t,i){function n(t){return h=e.getTokens(t)[0],h&&0===h.type.lastIndexOf(d,0)}function s(){var e=h.value[0];return"="==e?6:"-"==e?5:7-h.value.search(/[^#]/)}var r=e.getLine(i),a=r.length,l=e.getLength(),c=i,u=i;if(r.match(this.foldingStartMarker)){if("`"==r[0]){if("start"!==e.bgTokenizer.getState(i)){for(;++i<l&&(r=e.getLine(i),!("`"==r[0]&"```"==r.substring(0,3))););return new o(c,a,i,0)}for(;i-- >0&&(r=e.getLine(i),!("`"==r[0]&"```"==r.substring(0,3))););return new o(i,r.length,c,0)}var h,d="markup.heading";if(n(i)){for(var p=s();++i<l;)if(n(i)){var g=s();if(g>=p)break}if(u=i-(h&&-1!=["=","-"].indexOf(h.value[0])?2:1),u>c)for(;u>c&&/^\s*$/.test(e.getLine(u));)u--;if(u>c){var m=e.getLine(u).length;return new o(c,a,u,m)}}}}}.call(r.prototype)}),ace.define("ace/mode/markdown",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/javascript","ace/mode/xml","ace/mode/html","ace/mode/markdown_highlight_rules","ace/mode/folding/markdown"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("./text").Mode,o=e("./javascript").Mode,r=e("./xml").Mode,a=e("./html").Mode,l=e("./markdown_highlight_rules").MarkdownHighlightRules,c=e("./folding/markdown").FoldMode,u=function(){this.HighlightRules=l,this.createModeDelegates({"js-":o,"xml-":r,"html-":a}),this.foldingRules=new c};n.inherits(u,s),function(){this.type="text",this.blockComment={start:"<!--",end:"-->"},this.getNextLineIndent=function(e,t,i){if("listblock"==e){var n=/^(\s*)(?:([-+*])|(\d+)\.)(\s+)/.exec(t);if(!n)return"";var s=n[2];return s||(s=parseInt(n[3],10)+1+"."),n[1]+s+n[4]}return this.$getIndent(t)},this.$id="ace/mode/markdown"}.call(u.prototype),t.Mode=u})},function(e,t,i){ace.define("ace/mode/css_highlight_rules",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=(e("../lib/lang"),e("./text_highlight_rules").TextHighlightRules),o=t.supportType="animation-fill-mode|alignment-adjust|alignment-baseline|animation-delay|animation-direction|animation-duration|animation-iteration-count|animation-name|animation-play-state|animation-timing-function|animation|appearance|azimuth|backface-visibility|background-attachment|background-break|background-clip|background-color|background-image|background-origin|background-position|background-repeat|background-size|background|baseline-shift|binding|bleed|bookmark-label|bookmark-level|bookmark-state|bookmark-target|border-bottom|border-bottom-color|border-bottom-left-radius|border-bottom-right-radius|border-bottom-style|border-bottom-width|border-collapse|border-color|border-image|border-image-outset|border-image-repeat|border-image-slice|border-image-source|border-image-width|border-left|border-left-color|border-left-style|border-left-width|border-radius|border-right|border-right-color|border-right-style|border-right-width|border-spacing|border-style|border-top|border-top-color|border-top-left-radius|border-top-right-radius|border-top-style|border-top-width|border-width|border|bottom|box-align|box-decoration-break|box-direction|box-flex-group|box-flex|box-lines|box-ordinal-group|box-orient|box-pack|box-shadow|box-sizing|break-after|break-before|break-inside|caption-side|clear|clip|color-profile|color|column-count|column-fill|column-gap|column-rule|column-rule-color|column-rule-style|column-rule-width|column-span|column-width|columns|content|counter-increment|counter-reset|crop|cue-after|cue-before|cue|cursor|direction|display|dominant-baseline|drop-initial-after-adjust|drop-initial-after-align|drop-initial-before-adjust|drop-initial-before-align|drop-initial-size|drop-initial-value|elevation|empty-cells|fit|fit-position|float-offset|float|font-family|font-size|font-size-adjust|font-stretch|font-style|font-variant|font-weight|font|grid-columns|grid-rows|hanging-punctuation|height|hyphenate-after|hyphenate-before|hyphenate-character|hyphenate-lines|hyphenate-resource|hyphens|icon|image-orientation|image-rendering|image-resolution|inline-box-align|left|letter-spacing|line-height|line-stacking-ruby|line-stacking-shift|line-stacking-strategy|line-stacking|list-style-image|list-style-position|list-style-type|list-style|margin-bottom|margin-left|margin-right|margin-top|margin|mark-after|mark-before|mark|marks|marquee-direction|marquee-play-count|marquee-speed|marquee-style|max-height|max-width|min-height|min-width|move-to|nav-down|nav-index|nav-left|nav-right|nav-up|opacity|orphans|outline-color|outline-offset|outline-style|outline-width|outline|overflow-style|overflow-x|overflow-y|overflow|padding-bottom|padding-left|padding-right|padding-top|padding|page-break-after|page-break-before|page-break-inside|page-policy|page|pause-after|pause-before|pause|perspective-origin|perspective|phonemes|pitch-range|pitch|play-during|pointer-events|position|presentation-level|punctuation-trim|quotes|rendering-intent|resize|rest-after|rest-before|rest|richness|right|rotation-point|rotation|ruby-align|ruby-overhang|ruby-position|ruby-span|size|speak-header|speak-numeral|speak-punctuation|speak|speech-rate|stress|string-set|table-layout|target-name|target-new|target-position|target|text-align-last|text-align|text-decoration|text-emphasis|text-height|text-indent|text-justify|text-outline|text-shadow|text-transform|text-wrap|top|transform-origin|transform-style|transform|transition-delay|transition-duration|transition-property|transition-timing-function|transition|unicode-bidi|vertical-align|visibility|voice-balance|voice-duration|voice-family|voice-pitch-range|voice-pitch|voice-rate|voice-stress|voice-volume|volume|white-space-collapse|white-space|widows|width|word-break|word-spacing|word-wrap|z-index",r=t.supportFunction="rgb|rgba|url|attr|counter|counters",a=t.supportConstant="absolute|after-edge|after|all-scroll|all|alphabetic|always|antialiased|armenian|auto|avoid-column|avoid-page|avoid|balance|baseline|before-edge|before|below|bidi-override|block-line-height|block|bold|bolder|border-box|both|bottom|box|break-all|break-word|capitalize|caps-height|caption|center|central|char|circle|cjk-ideographic|clone|close-quote|col-resize|collapse|column|consider-shifts|contain|content-box|cover|crosshair|cubic-bezier|dashed|decimal-leading-zero|decimal|default|disabled|disc|disregard-shifts|distribute-all-lines|distribute-letter|distribute-space|distribute|dotted|double|e-resize|ease-in|ease-in-out|ease-out|ease|ellipsis|end|exclude-ruby|fill|fixed|georgian|glyphs|grid-height|groove|hand|hanging|hebrew|help|hidden|hiragana-iroha|hiragana|horizontal|icon|ideograph-alpha|ideograph-numeric|ideograph-parenthesis|ideograph-space|ideographic|inactive|include-ruby|inherit|initial|inline-block|inline-box|inline-line-height|inline-table|inline|inset|inside|inter-ideograph|inter-word|invert|italic|justify|katakana-iroha|katakana|keep-all|last|left|lighter|line-edge|line-through|line|linear|list-item|local|loose|lower-alpha|lower-greek|lower-latin|lower-roman|lowercase|lr-tb|ltr|mathematical|max-height|max-size|medium|menu|message-box|middle|move|n-resize|ne-resize|newspaper|no-change|no-close-quote|no-drop|no-open-quote|no-repeat|none|normal|not-allowed|nowrap|nw-resize|oblique|open-quote|outset|outside|overline|padding-box|page|pointer|pre-line|pre-wrap|pre|preserve-3d|progress|relative|repeat-x|repeat-y|repeat|replaced|reset-size|ridge|right|round|row-resize|rtl|s-resize|scroll|se-resize|separate|slice|small-caps|small-caption|solid|space|square|start|static|status-bar|step-end|step-start|steps|stretch|strict|sub|super|sw-resize|table-caption|table-cell|table-column-group|table-column|table-footer-group|table-header-group|table-row-group|table-row|table|tb-rl|text-after-edge|text-before-edge|text-bottom|text-size|text-top|text|thick|thin|transparent|underline|upper-alpha|upper-latin|upper-roman|uppercase|use-script|vertical-ideographic|vertical-text|visible|w-resize|wait|whitespace|z-index|zero",l=t.supportConstantColor="aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow",c=t.supportConstantFonts="arial|century|comic|courier|garamond|georgia|helvetica|impact|lucida|symbol|system|tahoma|times|trebuchet|utopia|verdana|webdings|sans-serif|serif|monospace",u=t.numRe="\\-?(?:(?:[0-9]+)|(?:[0-9]*\\.[0-9]+))",h=t.pseudoElements="(\\:+)\\b(after|before|first-letter|first-line|moz-selection|selection)\\b",d=t.pseudoClasses="(:)\\b(active|checked|disabled|empty|enabled|first-child|first-of-type|focus|hover|indeterminate|invalid|last-child|last-of-type|link|not|nth-child|nth-last-child|nth-last-of-type|nth-of-type|only-child|only-of-type|acequired|root|target|valid|visited)\\b",p=function(){
var e=this.createKeywordMapper({"support.function":r,"support.constant":a,"support.type":o,"support.constant.color":l,"support.constant.fonts":c},"text",!0);this.$rules={start:[{token:"comment",regex:"\\/\\*",push:"comment"},{token:"paren.lparen",regex:"\\{",push:"ruleset"},{token:"string",regex:"@.*?{",push:"media"},{token:"keyword",regex:"#[a-z0-9-_]+"},{token:"variable",regex:"\\.[a-z0-9-_]+"},{token:"string",regex:":[a-z0-9-_]+"},{token:"constant",regex:"[a-z0-9-_]+"},{caseInsensitive:!0}],media:[{token:"comment",regex:"\\/\\*",push:"comment"},{token:"paren.lparen",regex:"\\{",push:"ruleset"},{token:"string",regex:"\\}",next:"pop"},{token:"keyword",regex:"#[a-z0-9-_]+"},{token:"variable",regex:"\\.[a-z0-9-_]+"},{token:"string",regex:":[a-z0-9-_]+"},{token:"constant",regex:"[a-z0-9-_]+"},{caseInsensitive:!0}],comment:[{token:"comment",regex:"\\*\\/",next:"pop"},{defaultToken:"comment"}],ruleset:[{token:"paren.rparen",regex:"\\}",next:"pop"},{token:"comment",regex:"\\/\\*",push:"comment"},{token:"string",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]'},{token:"string",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:["constant.numeric","keyword"],regex:"("+u+")(ch|cm|deg|em|ex|fr|gd|grad|Hz|in|kHz|mm|ms|pc|pt|px|rad|rem|s|turn|vh|vm|vw|%)"},{token:"constant.numeric",regex:u},{token:"constant.numeric",regex:"#[a-f0-9]{6}"},{token:"constant.numeric",regex:"#[a-f0-9]{3}"},{token:["punctuation","entity.other.attribute-name.pseudo-element.css"],regex:h},{token:["punctuation","entity.other.attribute-name.pseudo-class.css"],regex:d},{token:["support.function","string","support.function"],regex:"(url\\()(.*)(\\))"},{token:e,regex:"\\-?[a-zA-Z_][a-zA-Z0-9_\\-]*"},{caseInsensitive:!0}]},this.normalizeRules()};n.inherits(p,s),t.CssHighlightRules=p}),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],function(e,t,i){"use strict";var n=e("../range").Range,s=function(){};(function(){this.checkOutdent=function(e,t){return/^\s+$/.test(e)?/^\s*\}/.test(t):!1},this.autoOutdent=function(e,t){var i=e.getLine(t),s=i.match(/^(\s*\})/);if(!s)return 0;var o=s[1].length,r=e.findMatchingBracket({row:t,column:o});if(!r||r.row==t)return 0;var a=this.$getIndent(e.getLine(r.row));e.replace(new n(t,0,t,o-1),a)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(s.prototype),t.MatchingBraceOutdent=s}),ace.define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],function(e,t,i){"use strict";var n,s=e("../../lib/oop"),o=e("../behaviour").Behaviour,r=e("../../token_iterator").TokenIterator,a=e("../../lib/lang"),l=["text","paren.rparen","punctuation.operator"],c=["text","paren.rparen","punctuation.operator","comment"],u={},h=function(e){var t=-1;return e.multiSelect&&(t=e.selection.id,u.rangeCount!=e.multiSelect.rangeCount&&(u={rangeCount:e.multiSelect.rangeCount})),u[t]?n=u[t]:void(n=u[t]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""})},d=function(){this.add("braces","insertion",function(e,t,i,s,o){var r=i.getCursorPosition(),l=s.doc.getLine(r.row);if("{"==o){h(i);var c=i.getSelectionRange(),u=s.doc.getTextRange(c);if(""!==u&&"{"!==u&&i.getWrapBehavioursEnabled())return{text:"{"+u+"}",selection:!1};if(d.isSaneInsertion(i,s))return/[\]\}\)]/.test(l[r.column])||i.inMultiSelectMode?(d.recordAutoInsert(i,s,"}"),{text:"{}",selection:[1,1]}):(d.recordMaybeInsert(i,s,"{"),{text:"{",selection:[1,1]})}else if("}"==o){h(i);var p=l.substring(r.column,r.column+1);if("}"==p){var g=s.$findOpeningBracket("}",{column:r.column+1,row:r.row});if(null!==g&&d.isAutoInsertedClosing(r,l,o))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}else{if("\n"==o||"\r\n"==o){h(i);var m="";d.isMaybeInsertedClosing(r,l)&&(m=a.stringRepeat("}",n.maybeInsertedBrackets),d.clearMaybeInsertedClosing());var p=l.substring(r.column,r.column+1);if("}"===p){var f=s.findMatchingBracket({row:r.row,column:r.column+1},"}");if(!f)return null;var v=this.$getIndent(s.getLine(f.row))}else{if(!m)return void d.clearMaybeInsertedClosing();var v=this.$getIndent(l)}var _=v+s.getTabString();return{text:"\n"+_+"\n"+v+m,selection:[1,_.length,1,_.length]}}d.clearMaybeInsertedClosing()}}),this.add("braces","deletion",function(e,t,i,s,o){var r=s.doc.getTextRange(o);if(!o.isMultiLine()&&"{"==r){h(i);var a=s.doc.getLine(o.start.row),l=a.substring(o.end.column,o.end.column+1);if("}"==l)return o.end.column++,o;n.maybeInsertedBrackets--}}),this.add("parens","insertion",function(e,t,i,n,s){if("("==s){h(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return{text:"("+r+")",selection:!1};if(d.isSaneInsertion(i,n))return d.recordAutoInsert(i,n,")"),{text:"()",selection:[1,1]}}else if(")"==s){h(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),c=l.substring(a.column,a.column+1);if(")"==c){var u=n.$findOpeningBracket(")",{column:a.column+1,row:a.row});if(null!==u&&d.isAutoInsertedClosing(a,l,s))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("parens","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"("==o){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(")"==a)return s.end.column++,s}}),this.add("brackets","insertion",function(e,t,i,n,s){if("["==s){h(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return{text:"["+r+"]",selection:!1};if(d.isSaneInsertion(i,n))return d.recordAutoInsert(i,n,"]"),{text:"[]",selection:[1,1]}}else if("]"==s){h(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),c=l.substring(a.column,a.column+1);if("]"==c){var u=n.$findOpeningBracket("]",{column:a.column+1,row:a.row});if(null!==u&&d.isAutoInsertedClosing(a,l,s))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("brackets","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"["==o){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if("]"==a)return s.end.column++,s}}),this.add("string_dquotes","insertion",function(e,t,i,n,s){if('"'==s||"'"==s){h(i);var o=s,r=i.getSelectionRange(),a=n.doc.getTextRange(r);if(""!==a&&"'"!==a&&'"'!=a&&i.getWrapBehavioursEnabled())return{text:o+a+o,selection:!1};var l=i.getCursorPosition(),c=n.doc.getLine(l.row),u=c.substring(l.column-1,l.column);if("\\"==u)return null;for(var p,g=n.getTokens(r.start.row),m=0,f=-1,v=0;v<g.length&&(p=g[v],"string"==p.type?f=-1:0>f&&(f=p.value.indexOf(o)),!(p.value.length+m>r.start.column));v++)m+=g[v].value.length;if(!p||0>f&&"comment"!==p.type&&("string"!==p.type||r.start.column!==p.value.length+m-1&&p.value.lastIndexOf(o)===p.value.length-1)){if(!d.isSaneInsertion(i,n))return;return{text:o+o,selection:[1,1]}}if(p&&"string"===p.type){var _=c.substring(l.column,l.column+1);if(_==o)return{text:"",selection:[1,1]}}}}),this.add("string_dquotes","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&('"'==o||"'"==o)){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(a==o)return s.end.column++,s}})};d.isSaneInsertion=function(e,t){var i=e.getCursorPosition(),n=new r(t,i.row,i.column);if(!this.$matchTokenType(n.getCurrentToken()||"text",l)){var s=new r(t,i.row,i.column+1);if(!this.$matchTokenType(s.getCurrentToken()||"text",l))return!1}return n.stepForward(),n.getCurrentTokenRow()!==i.row||this.$matchTokenType(n.getCurrentToken()||"text",c)},d.$matchTokenType=function(e,t){return t.indexOf(e.type||e)>-1},d.recordAutoInsert=function(e,t,i){var s=e.getCursorPosition(),o=t.doc.getLine(s.row);this.isAutoInsertedClosing(s,o,n.autoInsertedLineEnd[0])||(n.autoInsertedBrackets=0),n.autoInsertedRow=s.row,n.autoInsertedLineEnd=i+o.substr(s.column),n.autoInsertedBrackets++},d.recordMaybeInsert=function(e,t,i){var s=e.getCursorPosition(),o=t.doc.getLine(s.row);this.isMaybeInsertedClosing(s,o)||(n.maybeInsertedBrackets=0),n.maybeInsertedRow=s.row,n.maybeInsertedLineStart=o.substr(0,s.column)+i,n.maybeInsertedLineEnd=o.substr(s.column),n.maybeInsertedBrackets++},d.isAutoInsertedClosing=function(e,t,i){return n.autoInsertedBrackets>0&&e.row===n.autoInsertedRow&&i===n.autoInsertedLineEnd[0]&&t.substr(e.column)===n.autoInsertedLineEnd},d.isMaybeInsertedClosing=function(e,t){return n.maybeInsertedBrackets>0&&e.row===n.maybeInsertedRow&&t.substr(e.column)===n.maybeInsertedLineEnd&&t.substr(0,e.column)==n.maybeInsertedLineStart},d.popAutoInsertedClosing=function(){n.autoInsertedLineEnd=n.autoInsertedLineEnd.substr(1),n.autoInsertedBrackets--},d.clearMaybeInsertedClosing=function(){n&&(n.maybeInsertedBrackets=0,n.maybeInsertedRow=-1)},s.inherits(d,o),t.CstyleBehaviour=d}),ace.define("ace/mode/behaviour/css",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/mode/behaviour/cstyle","ace/token_iterator"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=(e("../behaviour").Behaviour,e("./cstyle").CstyleBehaviour),o=e("../../token_iterator").TokenIterator,r=function(){this.inherit(s),this.add("colon","insertion",function(e,t,i,n,s){if(":"===s){var r=i.getCursorPosition(),a=new o(n,r.row,r.column),l=a.getCurrentToken();if(l&&l.value.match(/\s+/)&&(l=a.stepBackward()),l&&"support.type"===l.type){var c=n.doc.getLine(r.row),u=c.substring(r.column,r.column+1);if(":"===u)return{text:"",selection:[1,1]};if(!c.substring(r.column).match(/^\s*;/))return{text:":;",selection:[1,1]}}}}),this.add("colon","deletion",function(e,t,i,n,s){var r=n.doc.getTextRange(s);if(!s.isMultiLine()&&":"===r){var a=i.getCursorPosition(),l=new o(n,a.row,a.column),c=l.getCurrentToken();if(c&&c.value.match(/\s+/)&&(c=l.stepBackward()),c&&"support.type"===c.type){var u=n.doc.getLine(s.start.row),h=u.substring(s.end.column,s.end.column+1);if(";"===h)return s.end.column++,s}}}),this.add("semicolon","insertion",function(e,t,i,n,s){if(";"===s){var o=i.getCursorPosition(),r=n.doc.getLine(o.row),a=r.substring(o.column,o.column+1);if(";"===a)return{text:"",selection:[1,1]}}})};n.inherits(r,s),t.CssBehaviour=r}),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=e("../../range").Range,o=e("./fold_mode").FoldMode,r=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};n.inherits(r,o),function(){this.foldingStartMarker=/(\{|\[)[^\}\]]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{]*(\}|\])|^[\s\*]*(\*\/)/,this.getFoldWidgetRange=function(e,t,i,n){var s=e.getLine(i),o=s.match(this.foldingStartMarker);if(o){var r=o.index;if(o[1])return this.openingBracketBlock(e,o[1],i,r);var a=e.getCommentFoldRange(i,r+o[0].length,1);return a&&!a.isMultiLine()&&(n?a=this.getSectionRange(e,i):"all"!=t&&(a=null)),a}if("markbegin"!==t){var o=s.match(this.foldingStopMarker);if(o){var r=o.index+o[0].length;return o[1]?this.closingBracketBlock(e,o[1],i,r):e.getCommentFoldRange(i,r,-1)}}},this.getSectionRange=function(e,t){var i=e.getLine(t),n=i.search(/\S/),o=t,r=i.length;t+=1;for(var a=t,l=e.getLength();++t<l;){i=e.getLine(t);var c=i.search(/\S/);if(-1!==c){if(n>c)break;var u=this.getFoldWidgetRange(e,"all",t);if(u){if(u.start.row<=o)break;if(u.isMultiLine())t=u.end.row;else if(n==c)break}a=t}}return new s(o,r,a,e.getLine(a).length)}}.call(r.prototype)}),ace.define("ace/mode/css",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/css_highlight_rules","ace/mode/matching_brace_outdent","ace/worker/worker_client","ace/mode/behaviour/css","ace/mode/folding/cstyle"],function(e,t,n){"use strict";var s=e("../lib/oop"),o=e("./text").Mode,r=e("./css_highlight_rules").CssHighlightRules,a=e("./matching_brace_outdent").MatchingBraceOutdent,l=e("../worker/worker_client").WorkerClient,c=e("./behaviour/css").CssBehaviour,u=e("./folding/cstyle").FoldMode,h=function(){this.HighlightRules=r,this.$outdent=new a,this.$behaviour=new c,this.foldingRules=new u};s.inherits(h,o),function(){this.foldingRules="cStyle",this.blockComment={start:"/*",end:"*/"},this.getNextLineIndent=function(e,t,i){var n=this.$getIndent(t),s=this.getTokenizer().getLineTokens(t,e).tokens;if(s.length&&"comment"==s[s.length-1].type)return n;var o=t.match(/^.*\{\s*$/);return o&&(n+=i),n},this.checkOutdent=function(e,t,i){return this.$outdent.checkOutdent(t,i)},this.autoOutdent=function(e,t,i){this.$outdent.autoOutdent(t,i)},this.createWorker=function(e){var t=new l(["ace"],i(414),"Worker");return t.attachToDocument(e.getDocument()),t.on("csslint",function(t){e.setAnnotations(t.data)}),t.on("terminate",function(){e.clearAnnotations()}),t},this.$id="ace/mode/css"}.call(h.prototype),t.Mode=h})},function(e,t,i){ace.define("ace/mode/doc_comment_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("./text_highlight_rules").TextHighlightRules,o=function(){this.$rules={start:[{token:"comment.doc.tag",regex:"@[\\w\\d_]+"},{token:"comment.doc.tag",regex:"\\bTODO\\b"},{defaultToken:"comment.doc"}]}};n.inherits(o,s),o.getStartRule=function(e){return{token:"comment.doc",regex:"\\/\\*(?=\\*)",next:e}},o.getEndRule=function(e){return{token:"comment.doc",regex:"\\*\\/",next:e}},t.DocCommentHighlightRules=o}),ace.define("ace/mode/javascript_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/doc_comment_highlight_rules","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("./doc_comment_highlight_rules").DocCommentHighlightRules,o=e("./text_highlight_rules").TextHighlightRules,r=function(){var e=this.createKeywordMapper({"variable.language":"Array|Boolean|Date|Function|Iterator|Number|Object|RegExp|String|Proxy|Namespace|QName|XML|XMLList|ArrayBuffer|Float32Array|Float64Array|Int16Array|Int32Array|Int8Array|Uint16Array|Uint32Array|Uint8Array|Uint8ClampedArray|Error|EvalError|InternalError|RangeError|ReferenceError|StopIteration|SyntaxError|TypeError|URIError|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|eval|isFinite|isNaN|parseFloat|parseInt|JSON|Math|this|arguments|prototype|window|document",keyword:"const|yield|import|get|set|break|case|catch|continue|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|let|var|while|with|debugger|__parent__|__count__|escape|unescape|with|__proto__|class|enum|extends|super|export|implements|private|public|interface|package|protected|static","storage.type":"const|let|var|function","constant.language":"null|Infinity|NaN|undefined","support.function":"alert","constant.language.boolean":"true|false"},"identifier"),t="case|do|else|finally|in|instanceof|return|throw|try|typeof|yield|void",i="[a-zA-Z\\$_-][a-zA-Z\\d\\$_-]*\\b",n="\\\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|[0-2][0-7]{0,2}|3[0-6][0-7]?|37[0-7]?|[4-7][0-7]?|.)";this.$rules={no_regex:[{token:"comment",regex:"\\/\\/",next:"line_comment"},s.getStartRule("doc-start"),{token:"comment",regex:/\/\*/,next:"comment"},{token:"string",regex:"'(?=.)",next:"qstring"},{token:"string",regex:'"(?=.)',next:"qqstring"},{token:"constant.numeric",regex:/0[xX][0-9a-fA-F]+\b/},{token:"constant.numeric",regex:/[+-]?\d+(?:(?:\.\d*)?(?:[eE][+-]?\d+)?)?\b/},{token:["storage.type","punctuation.operator","support.function","punctuation.operator","entity.name.function","text","keyword.operator"],regex:"("+i+")(\\.)(prototype)(\\.)("+i+")(\\s*)(=)",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+i+")(\\.)("+i+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+i+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+i+")(\\.)("+i+")(\\s*)(=)(\\s*)(function)(\\s+)(\\w+)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","text","entity.name.function","text","paren.lparen"],regex:"(function)(\\s+)("+i+")(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","punctuation.operator","text","storage.type","text","paren.lparen"],regex:"("+i+")(\\s*)(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["text","text","storage.type","text","paren.lparen"],regex:"(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:"keyword",regex:"(?:"+t+")\\b",next:"start"},{token:["punctuation.operator","support.function"],regex:/(\.)(s(?:h(?:ift|ow(?:Mod(?:elessDialog|alDialog)|Help))|croll(?:X|By(?:Pages|Lines)?|Y|To)?|t(?:op|rike)|i(?:n|zeToContent|debar|gnText)|ort|u(?:p|b(?:str(?:ing)?)?)|pli(?:ce|t)|e(?:nd|t(?:Re(?:sizable|questHeader)|M(?:i(?:nutes|lliseconds)|onth)|Seconds|Ho(?:tKeys|urs)|Year|Cursor|Time(?:out)?|Interval|ZOptions|Date|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Date|FullYear)|FullYear|Active)|arch)|qrt|lice|avePreferences|mall)|h(?:ome|andleEvent)|navigate|c(?:har(?:CodeAt|At)|o(?:s|n(?:cat|textual|firm)|mpile)|eil|lear(?:Timeout|Interval)?|a(?:ptureEvents|ll)|reate(?:StyleSheet|Popup|EventObject))|t(?:o(?:GMTString|S(?:tring|ource)|U(?:TCString|pperCase)|Lo(?:caleString|werCase))|est|a(?:n|int(?:Enabled)?))|i(?:s(?:NaN|Finite)|ndexOf|talics)|d(?:isableExternalCapture|ump|etachEvent)|u(?:n(?:shift|taint|escape|watch)|pdateCommands)|j(?:oin|avaEnabled)|p(?:o(?:p|w)|ush|lugins.refresh|a(?:ddings|rse(?:Int|Float)?)|r(?:int|ompt|eference))|e(?:scape|nableExternalCapture|val|lementFromPoint|x(?:p|ec(?:Script|Command)?))|valueOf|UTC|queryCommand(?:State|Indeterm|Enabled|Value)|f(?:i(?:nd|le(?:ModifiedDate|Size|CreatedDate|UpdatedDate)|xed)|o(?:nt(?:size|color)|rward)|loor|romCharCode)|watch|l(?:ink|o(?:ad|g)|astIndexOf)|a(?:sin|nchor|cos|t(?:tachEvent|ob|an(?:2)?)|pply|lert|b(?:s|ort))|r(?:ou(?:nd|teEvents)|e(?:size(?:By|To)|calc|turnValue|place|verse|l(?:oad|ease(?:Capture|Events)))|andom)|g(?:o|et(?:ResponseHeader|M(?:i(?:nutes|lliseconds)|onth)|Se(?:conds|lection)|Hours|Year|Time(?:zoneOffset)?|Da(?:y|te)|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Da(?:y|te)|FullYear)|FullYear|A(?:ttention|llResponseHeaders)))|m(?:in|ove(?:B(?:y|elow)|To(?:Absolute)?|Above)|ergeAttributes|a(?:tch|rgins|x))|b(?:toa|ig|o(?:ld|rderWidths)|link|ack))\b(?=\()/},{token:["punctuation.operator","support.function.dom"],regex:/(\.)(s(?:ub(?:stringData|mit)|plitText|e(?:t(?:NamedItem|Attribute(?:Node)?)|lect))|has(?:ChildNodes|Feature)|namedItem|c(?:l(?:ick|o(?:se|neNode))|reate(?:C(?:omment|DATASection|aption)|T(?:Head|extNode|Foot)|DocumentFragment|ProcessingInstruction|E(?:ntityReference|lement)|Attribute))|tabIndex|i(?:nsert(?:Row|Before|Cell|Data)|tem)|open|delete(?:Row|C(?:ell|aption)|T(?:Head|Foot)|Data)|focus|write(?:ln)?|a(?:dd|ppend(?:Child|Data))|re(?:set|place(?:Child|Data)|move(?:NamedItem|Child|Attribute(?:Node)?)?)|get(?:NamedItem|Element(?:sBy(?:Name|TagName)|ById)|Attribute(?:Node)?)|blur)\b(?=\()/},{token:["punctuation.operator","support.constant"],regex:/(\.)(s(?:ystemLanguage|cr(?:ipts|ollbars|een(?:X|Y|Top|Left))|t(?:yle(?:Sheets)?|atus(?:Text|bar)?)|ibling(?:Below|Above)|ource|uffixes|e(?:curity(?:Policy)?|l(?:ection|f)))|h(?:istory|ost(?:name)?|as(?:h|Focus))|y|X(?:MLDocument|SLDocument)|n(?:ext|ame(?:space(?:s|URI)|Prop))|M(?:IN_VALUE|AX_VALUE)|c(?:haracterSet|o(?:n(?:structor|trollers)|okieEnabled|lorDepth|mp(?:onents|lete))|urrent|puClass|l(?:i(?:p(?:boardData)?|entInformation)|osed|asses)|alle(?:e|r)|rypto)|t(?:o(?:olbar|p)|ext(?:Transform|Indent|Decoration|Align)|ags)|SQRT(?:1_2|2)|i(?:n(?:ner(?:Height|Width)|put)|ds|gnoreCase)|zIndex|o(?:scpu|n(?:readystatechange|Line)|uter(?:Height|Width)|p(?:sProfile|ener)|ffscreenBuffering)|NEGATIVE_INFINITY|d(?:i(?:splay|alog(?:Height|Top|Width|Left|Arguments)|rectories)|e(?:scription|fault(?:Status|Ch(?:ecked|arset)|View)))|u(?:ser(?:Profile|Language|Agent)|n(?:iqueID|defined)|pdateInterval)|_content|p(?:ixelDepth|ort|ersonalbar|kcs11|l(?:ugins|atform)|a(?:thname|dding(?:Right|Bottom|Top|Left)|rent(?:Window|Layer)?|ge(?:X(?:Offset)?|Y(?:Offset)?))|r(?:o(?:to(?:col|type)|duct(?:Sub)?|mpter)|e(?:vious|fix)))|e(?:n(?:coding|abledPlugin)|x(?:ternal|pando)|mbeds)|v(?:isibility|endor(?:Sub)?|Linkcolor)|URLUnencoded|P(?:I|OSITIVE_INFINITY)|f(?:ilename|o(?:nt(?:Size|Family|Weight)|rmName)|rame(?:s|Element)|gColor)|E|whiteSpace|l(?:i(?:stStyleType|n(?:eHeight|kColor))|o(?:ca(?:tion(?:bar)?|lName)|wsrc)|e(?:ngth|ft(?:Context)?)|a(?:st(?:M(?:odified|atch)|Index|Paren)|yer(?:s|X)|nguage))|a(?:pp(?:MinorVersion|Name|Co(?:deName|re)|Version)|vail(?:Height|Top|Width|Left)|ll|r(?:ity|guments)|Linkcolor|bove)|r(?:ight(?:Context)?|e(?:sponse(?:XML|Text)|adyState))|global|x|m(?:imeTypes|ultiline|enubar|argin(?:Right|Bottom|Top|Left))|L(?:N(?:10|2)|OG(?:10E|2E))|b(?:o(?:ttom|rder(?:Width|RightWidth|BottomWidth|Style|Color|TopWidth|LeftWidth))|ufferDepth|elow|ackground(?:Color|Image)))\b/},{token:["support.constant"],regex:/that\b/},{token:["storage.type","punctuation.operator","support.function.firebug"],regex:/(console)(\.)(warn|info|log|error|time|trace|timeEnd|assert)\b/},{token:e,regex:i},{token:"keyword.operator",regex:/--|\+\+|[!$%&*+\-~]|===|==|=|!=|!==|<=|>=|<<=|>>=|>>>=|<>|<|>|!|&&|\|\||\?\:|\*=|%=|\+=|\-=|&=|\^=/,next:"start"},{token:"punctuation.operator",regex:/\?|\:|\,|\;|\./,next:"start"},{token:"paren.lparen",regex:/[\[({]/,next:"start"},{token:"paren.rparen",regex:/[\])}]/},{token:"keyword.operator",regex:/\/=?/,next:"start"},{token:"comment",regex:/^#!.*$/}],start:[s.getStartRule("doc-start"),{token:"comment",regex:"\\/\\*",next:"comment_regex_allowed"},{token:"comment",regex:"\\/\\/",next:"line_comment_regex_allowed"},{token:"string.regexp",regex:"\\/",next:"regex"},{token:"text",regex:"\\s+|^$",next:"start"},{token:"empty",regex:"",next:"no_regex"}],regex:[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"string.regexp",regex:"/[sxngimy]*",next:"no_regex"},{token:"invalid",regex:/\{\d+\b,?\d*\}[+*]|[+*$^?][+*]|[$^][?]|\?{3,}/},{token:"constant.language.escape",regex:/\(\?[:=!]|\)|\{\d+\b,?\d*\}|[+*]\?|[()$^+*?.]/},{token:"constant.language.delimiter",regex:/\|/},{token:"constant.language.escape",regex:/\[\^?/,next:"regex_character_class"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp"}],regex_character_class:[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"constant.language.escape",regex:"]",next:"regex"},{token:"constant.language.escape",regex:"-"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp.charachterclass"}],function_arguments:[{token:"variable.parameter",regex:i},{token:"punctuation.operator",regex:"[, ]+"},{token:"punctuation.operator",regex:"$"},{token:"empty",regex:"",next:"no_regex"}],comment_regex_allowed:[{token:"comment",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}],comment:[{token:"comment",regex:"\\*\\/",next:"no_regex"},{defaultToken:"comment"}],line_comment_regex_allowed:[{token:"comment",regex:"$|^",next:"start"},{defaultToken:"comment"}],line_comment:[{token:"comment",regex:"$|^",next:"no_regex"},{defaultToken:"comment"}],qqstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",next:"qqstring"},{token:"string",regex:'"|$',next:"no_regex"},{defaultToken:"string"}],qstring:[{token:"constant.language.escape",regex:n},{token:"string",regex:"\\\\$",next:"qstring"},{token:"string",regex:"'|$",next:"no_regex"},{defaultToken:"string"}]},this.embedRules(s,"doc-",[s.getEndRule("no_regex")])};n.inherits(r,o),t.JavaScriptHighlightRules=r}),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],function(e,t,i){"use strict";var n=e("../range").Range,s=function(){};(function(){this.checkOutdent=function(e,t){return/^\s+$/.test(e)?/^\s*\}/.test(t):!1},this.autoOutdent=function(e,t){var i=e.getLine(t),s=i.match(/^(\s*\})/);if(!s)return 0;var o=s[1].length,r=e.findMatchingBracket({row:t,column:o});if(!r||r.row==t)return 0;var a=this.$getIndent(e.getLine(r.row));e.replace(new n(t,0,t,o-1),a)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(s.prototype),t.MatchingBraceOutdent=s}),ace.define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],function(e,t,i){"use strict";var n,s=e("../../lib/oop"),o=e("../behaviour").Behaviour,r=e("../../token_iterator").TokenIterator,a=e("../../lib/lang"),l=["text","paren.rparen","punctuation.operator"],c=["text","paren.rparen","punctuation.operator","comment"],u={},h=function(e){var t=-1;return e.multiSelect&&(t=e.selection.id,u.rangeCount!=e.multiSelect.rangeCount&&(u={rangeCount:e.multiSelect.rangeCount})),u[t]?n=u[t]:void(n=u[t]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""})},d=function(){this.add("braces","insertion",function(e,t,i,s,o){var r=i.getCursorPosition(),l=s.doc.getLine(r.row);if("{"==o){h(i);var c=i.getSelectionRange(),u=s.doc.getTextRange(c);if(""!==u&&"{"!==u&&i.getWrapBehavioursEnabled())return{text:"{"+u+"}",selection:!1};if(d.isSaneInsertion(i,s))return/[\]\}\)]/.test(l[r.column])||i.inMultiSelectMode?(d.recordAutoInsert(i,s,"}"),{text:"{}",selection:[1,1]}):(d.recordMaybeInsert(i,s,"{"),{text:"{",selection:[1,1]})}else if("}"==o){h(i);var p=l.substring(r.column,r.column+1);if("}"==p){var g=s.$findOpeningBracket("}",{column:r.column+1,row:r.row});if(null!==g&&d.isAutoInsertedClosing(r,l,o))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}else{if("\n"==o||"\r\n"==o){h(i);var m="";d.isMaybeInsertedClosing(r,l)&&(m=a.stringRepeat("}",n.maybeInsertedBrackets),d.clearMaybeInsertedClosing());var p=l.substring(r.column,r.column+1);if("}"===p){var f=s.findMatchingBracket({row:r.row,column:r.column+1},"}");if(!f)return null;var v=this.$getIndent(s.getLine(f.row))}else{if(!m)return void d.clearMaybeInsertedClosing();var v=this.$getIndent(l)}var _=v+s.getTabString();return{text:"\n"+_+"\n"+v+m,selection:[1,_.length,1,_.length]}}d.clearMaybeInsertedClosing()}}),this.add("braces","deletion",function(e,t,i,s,o){var r=s.doc.getTextRange(o);if(!o.isMultiLine()&&"{"==r){h(i);var a=s.doc.getLine(o.start.row),l=a.substring(o.end.column,o.end.column+1);if("}"==l)return o.end.column++,o;n.maybeInsertedBrackets--}}),this.add("parens","insertion",function(e,t,i,n,s){if("("==s){h(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return{text:"("+r+")",selection:!1};if(d.isSaneInsertion(i,n))return d.recordAutoInsert(i,n,")"),{text:"()",selection:[1,1]}}else if(")"==s){h(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),c=l.substring(a.column,a.column+1);if(")"==c){var u=n.$findOpeningBracket(")",{column:a.column+1,row:a.row});if(null!==u&&d.isAutoInsertedClosing(a,l,s))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("parens","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"("==o){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(")"==a)return s.end.column++,s}}),this.add("brackets","insertion",function(e,t,i,n,s){if("["==s){h(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return{text:"["+r+"]",selection:!1};if(d.isSaneInsertion(i,n))return d.recordAutoInsert(i,n,"]"),{text:"[]",selection:[1,1]}}else if("]"==s){h(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),c=l.substring(a.column,a.column+1);if("]"==c){var u=n.$findOpeningBracket("]",{column:a.column+1,row:a.row});if(null!==u&&d.isAutoInsertedClosing(a,l,s))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("brackets","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"["==o){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if("]"==a)return s.end.column++,s}}),this.add("string_dquotes","insertion",function(e,t,i,n,s){if('"'==s||"'"==s){h(i);var o=s,r=i.getSelectionRange(),a=n.doc.getTextRange(r);if(""!==a&&"'"!==a&&'"'!=a&&i.getWrapBehavioursEnabled())return{text:o+a+o,selection:!1};var l=i.getCursorPosition(),c=n.doc.getLine(l.row),u=c.substring(l.column-1,l.column);if("\\"==u)return null;for(var p,g=n.getTokens(r.start.row),m=0,f=-1,v=0;v<g.length&&(p=g[v],"string"==p.type?f=-1:0>f&&(f=p.value.indexOf(o)),!(p.value.length+m>r.start.column));v++)m+=g[v].value.length;if(!p||0>f&&"comment"!==p.type&&("string"!==p.type||r.start.column!==p.value.length+m-1&&p.value.lastIndexOf(o)===p.value.length-1)){if(!d.isSaneInsertion(i,n))return;return{text:o+o,selection:[1,1]}}if(p&&"string"===p.type){var _=c.substring(l.column,l.column+1);if(_==o)return{text:"",selection:[1,1]}}}}),this.add("string_dquotes","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&('"'==o||"'"==o)){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(a==o)return s.end.column++,s}})};d.isSaneInsertion=function(e,t){var i=e.getCursorPosition(),n=new r(t,i.row,i.column);if(!this.$matchTokenType(n.getCurrentToken()||"text",l)){var s=new r(t,i.row,i.column+1);if(!this.$matchTokenType(s.getCurrentToken()||"text",l))return!1}return n.stepForward(),n.getCurrentTokenRow()!==i.row||this.$matchTokenType(n.getCurrentToken()||"text",c)},d.$matchTokenType=function(e,t){return t.indexOf(e.type||e)>-1},d.recordAutoInsert=function(e,t,i){var s=e.getCursorPosition(),o=t.doc.getLine(s.row);this.isAutoInsertedClosing(s,o,n.autoInsertedLineEnd[0])||(n.autoInsertedBrackets=0),n.autoInsertedRow=s.row,n.autoInsertedLineEnd=i+o.substr(s.column),n.autoInsertedBrackets++},d.recordMaybeInsert=function(e,t,i){var s=e.getCursorPosition(),o=t.doc.getLine(s.row);this.isMaybeInsertedClosing(s,o)||(n.maybeInsertedBrackets=0),n.maybeInsertedRow=s.row,n.maybeInsertedLineStart=o.substr(0,s.column)+i,n.maybeInsertedLineEnd=o.substr(s.column),n.maybeInsertedBrackets++},d.isAutoInsertedClosing=function(e,t,i){return n.autoInsertedBrackets>0&&e.row===n.autoInsertedRow&&i===n.autoInsertedLineEnd[0]&&t.substr(e.column)===n.autoInsertedLineEnd},d.isMaybeInsertedClosing=function(e,t){return n.maybeInsertedBrackets>0&&e.row===n.maybeInsertedRow&&t.substr(e.column)===n.maybeInsertedLineEnd&&t.substr(0,e.column)==n.maybeInsertedLineStart},d.popAutoInsertedClosing=function(){n.autoInsertedLineEnd=n.autoInsertedLineEnd.substr(1),n.autoInsertedBrackets--},d.clearMaybeInsertedClosing=function(){n&&(n.maybeInsertedBrackets=0,n.maybeInsertedRow=-1)},s.inherits(d,o),t.CstyleBehaviour=d}),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=e("../../range").Range,o=e("./fold_mode").FoldMode,r=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};n.inherits(r,o),function(){this.foldingStartMarker=/(\{|\[)[^\}\]]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{]*(\}|\])|^[\s\*]*(\*\/)/,this.getFoldWidgetRange=function(e,t,i,n){var s=e.getLine(i),o=s.match(this.foldingStartMarker);if(o){var r=o.index;if(o[1])return this.openingBracketBlock(e,o[1],i,r);var a=e.getCommentFoldRange(i,r+o[0].length,1);return a&&!a.isMultiLine()&&(n?a=this.getSectionRange(e,i):"all"!=t&&(a=null)),
a}if("markbegin"!==t){var o=s.match(this.foldingStopMarker);if(o){var r=o.index+o[0].length;return o[1]?this.closingBracketBlock(e,o[1],i,r):e.getCommentFoldRange(i,r,-1)}}},this.getSectionRange=function(e,t){var i=e.getLine(t),n=i.search(/\S/),o=t,r=i.length;t+=1;for(var a=t,l=e.getLength();++t<l;){i=e.getLine(t);var c=i.search(/\S/);if(-1!==c){if(n>c)break;var u=this.getFoldWidgetRange(e,"all",t);if(u){if(u.start.row<=o)break;if(u.isMultiLine())t=u.end.row;else if(n==c)break}a=t}}return new s(o,r,a,e.getLine(a).length)}}.call(r.prototype)}),ace.define("ace/mode/javascript",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/javascript_highlight_rules","ace/mode/matching_brace_outdent","ace/range","ace/worker/worker_client","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle"],function(e,t,n){"use strict";var s=e("../lib/oop"),o=e("./text").Mode,r=e("./javascript_highlight_rules").JavaScriptHighlightRules,a=e("./matching_brace_outdent").MatchingBraceOutdent,l=(e("../range").Range,e("../worker/worker_client").WorkerClient),c=e("./behaviour/cstyle").CstyleBehaviour,u=e("./folding/cstyle").FoldMode,h=function(){this.HighlightRules=r,this.$outdent=new a,this.$behaviour=new c,this.foldingRules=new u};s.inherits(h,o),function(){this.lineCommentStart="//",this.blockComment={start:"/*",end:"*/"},this.getNextLineIndent=function(e,t,i){var n=this.$getIndent(t),s=this.getTokenizer().getLineTokens(t,e),o=s.tokens,r=s.state;if(o.length&&"comment"==o[o.length-1].type)return n;if("start"==e||"no_regex"==e){var a=t.match(/^.*(?:\bcase\b.*\:|[\{\(\[])\s*$/);a&&(n+=i)}else if("doc-start"==e){if("start"==r||"no_regex"==r)return"";var a=t.match(/^\s*(\/?)\*/);a&&(a[1]&&(n+=" "),n+="* ")}return n},this.checkOutdent=function(e,t,i){return this.$outdent.checkOutdent(t,i)},this.autoOutdent=function(e,t,i){this.$outdent.autoOutdent(t,i)},this.createWorker=function(e){var t=new l(["ace"],i(413),"JavaScriptWorker");return t.attachToDocument(e.getDocument()),t.on("jslint",function(t){e.setAnnotations(t.data)}),t.on("terminate",function(){e.clearAnnotations()}),t},this.$id="ace/mode/javascript"}.call(h.prototype),t.Mode=h})},function(e,t,i){ace.define("ace/mode/json_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("./text_highlight_rules").TextHighlightRules,o=function(){this.$rules={start:[{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"string",regex:'"',next:"string"},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"invalid.illegal",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"invalid.illegal",regex:"\\/\\/.*$"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],string:[{token:"constant.language.escape",regex:/\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|["\\\/bfnrt])/},{token:"string",regex:'[^"\\\\]+'},{token:"string",regex:'"',next:"start"},{token:"string",regex:"",next:"start"}]}};n.inherits(o,s),t.JsonHighlightRules=o}),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],function(e,t,i){"use strict";var n=e("../range").Range,s=function(){};(function(){this.checkOutdent=function(e,t){return/^\s+$/.test(e)?/^\s*\}/.test(t):!1},this.autoOutdent=function(e,t){var i=e.getLine(t),s=i.match(/^(\s*\})/);if(!s)return 0;var o=s[1].length,r=e.findMatchingBracket({row:t,column:o});if(!r||r.row==t)return 0;var a=this.$getIndent(e.getLine(r.row));e.replace(new n(t,0,t,o-1),a)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(s.prototype),t.MatchingBraceOutdent=s}),ace.define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],function(e,t,i){"use strict";var n,s=e("../../lib/oop"),o=e("../behaviour").Behaviour,r=e("../../token_iterator").TokenIterator,a=e("../../lib/lang"),l=["text","paren.rparen","punctuation.operator"],c=["text","paren.rparen","punctuation.operator","comment"],u={},h=function(e){var t=-1;return e.multiSelect&&(t=e.selection.id,u.rangeCount!=e.multiSelect.rangeCount&&(u={rangeCount:e.multiSelect.rangeCount})),u[t]?n=u[t]:void(n=u[t]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""})},d=function(){this.add("braces","insertion",function(e,t,i,s,o){var r=i.getCursorPosition(),l=s.doc.getLine(r.row);if("{"==o){h(i);var c=i.getSelectionRange(),u=s.doc.getTextRange(c);if(""!==u&&"{"!==u&&i.getWrapBehavioursEnabled())return{text:"{"+u+"}",selection:!1};if(d.isSaneInsertion(i,s))return/[\]\}\)]/.test(l[r.column])||i.inMultiSelectMode?(d.recordAutoInsert(i,s,"}"),{text:"{}",selection:[1,1]}):(d.recordMaybeInsert(i,s,"{"),{text:"{",selection:[1,1]})}else if("}"==o){h(i);var p=l.substring(r.column,r.column+1);if("}"==p){var g=s.$findOpeningBracket("}",{column:r.column+1,row:r.row});if(null!==g&&d.isAutoInsertedClosing(r,l,o))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}else{if("\n"==o||"\r\n"==o){h(i);var m="";d.isMaybeInsertedClosing(r,l)&&(m=a.stringRepeat("}",n.maybeInsertedBrackets),d.clearMaybeInsertedClosing());var p=l.substring(r.column,r.column+1);if("}"===p){var f=s.findMatchingBracket({row:r.row,column:r.column+1},"}");if(!f)return null;var v=this.$getIndent(s.getLine(f.row))}else{if(!m)return void d.clearMaybeInsertedClosing();var v=this.$getIndent(l)}var _=v+s.getTabString();return{text:"\n"+_+"\n"+v+m,selection:[1,_.length,1,_.length]}}d.clearMaybeInsertedClosing()}}),this.add("braces","deletion",function(e,t,i,s,o){var r=s.doc.getTextRange(o);if(!o.isMultiLine()&&"{"==r){h(i);var a=s.doc.getLine(o.start.row),l=a.substring(o.end.column,o.end.column+1);if("}"==l)return o.end.column++,o;n.maybeInsertedBrackets--}}),this.add("parens","insertion",function(e,t,i,n,s){if("("==s){h(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return{text:"("+r+")",selection:!1};if(d.isSaneInsertion(i,n))return d.recordAutoInsert(i,n,")"),{text:"()",selection:[1,1]}}else if(")"==s){h(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),c=l.substring(a.column,a.column+1);if(")"==c){var u=n.$findOpeningBracket(")",{column:a.column+1,row:a.row});if(null!==u&&d.isAutoInsertedClosing(a,l,s))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("parens","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"("==o){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(")"==a)return s.end.column++,s}}),this.add("brackets","insertion",function(e,t,i,n,s){if("["==s){h(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return{text:"["+r+"]",selection:!1};if(d.isSaneInsertion(i,n))return d.recordAutoInsert(i,n,"]"),{text:"[]",selection:[1,1]}}else if("]"==s){h(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),c=l.substring(a.column,a.column+1);if("]"==c){var u=n.$findOpeningBracket("]",{column:a.column+1,row:a.row});if(null!==u&&d.isAutoInsertedClosing(a,l,s))return d.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("brackets","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"["==o){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if("]"==a)return s.end.column++,s}}),this.add("string_dquotes","insertion",function(e,t,i,n,s){if('"'==s||"'"==s){h(i);var o=s,r=i.getSelectionRange(),a=n.doc.getTextRange(r);if(""!==a&&"'"!==a&&'"'!=a&&i.getWrapBehavioursEnabled())return{text:o+a+o,selection:!1};var l=i.getCursorPosition(),c=n.doc.getLine(l.row),u=c.substring(l.column-1,l.column);if("\\"==u)return null;for(var p,g=n.getTokens(r.start.row),m=0,f=-1,v=0;v<g.length&&(p=g[v],"string"==p.type?f=-1:0>f&&(f=p.value.indexOf(o)),!(p.value.length+m>r.start.column));v++)m+=g[v].value.length;if(!p||0>f&&"comment"!==p.type&&("string"!==p.type||r.start.column!==p.value.length+m-1&&p.value.lastIndexOf(o)===p.value.length-1)){if(!d.isSaneInsertion(i,n))return;return{text:o+o,selection:[1,1]}}if(p&&"string"===p.type){var _=c.substring(l.column,l.column+1);if(_==o)return{text:"",selection:[1,1]}}}}),this.add("string_dquotes","deletion",function(e,t,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&('"'==o||"'"==o)){h(i);var r=n.doc.getLine(s.start.row),a=r.substring(s.start.column+1,s.start.column+2);if(a==o)return s.end.column++,s}})};d.isSaneInsertion=function(e,t){var i=e.getCursorPosition(),n=new r(t,i.row,i.column);if(!this.$matchTokenType(n.getCurrentToken()||"text",l)){var s=new r(t,i.row,i.column+1);if(!this.$matchTokenType(s.getCurrentToken()||"text",l))return!1}return n.stepForward(),n.getCurrentTokenRow()!==i.row||this.$matchTokenType(n.getCurrentToken()||"text",c)},d.$matchTokenType=function(e,t){return t.indexOf(e.type||e)>-1},d.recordAutoInsert=function(e,t,i){var s=e.getCursorPosition(),o=t.doc.getLine(s.row);this.isAutoInsertedClosing(s,o,n.autoInsertedLineEnd[0])||(n.autoInsertedBrackets=0),n.autoInsertedRow=s.row,n.autoInsertedLineEnd=i+o.substr(s.column),n.autoInsertedBrackets++},d.recordMaybeInsert=function(e,t,i){var s=e.getCursorPosition(),o=t.doc.getLine(s.row);this.isMaybeInsertedClosing(s,o)||(n.maybeInsertedBrackets=0),n.maybeInsertedRow=s.row,n.maybeInsertedLineStart=o.substr(0,s.column)+i,n.maybeInsertedLineEnd=o.substr(s.column),n.maybeInsertedBrackets++},d.isAutoInsertedClosing=function(e,t,i){return n.autoInsertedBrackets>0&&e.row===n.autoInsertedRow&&i===n.autoInsertedLineEnd[0]&&t.substr(e.column)===n.autoInsertedLineEnd},d.isMaybeInsertedClosing=function(e,t){return n.maybeInsertedBrackets>0&&e.row===n.maybeInsertedRow&&t.substr(e.column)===n.maybeInsertedLineEnd&&t.substr(0,e.column)==n.maybeInsertedLineStart},d.popAutoInsertedClosing=function(){n.autoInsertedLineEnd=n.autoInsertedLineEnd.substr(1),n.autoInsertedBrackets--},d.clearMaybeInsertedClosing=function(){n&&(n.maybeInsertedBrackets=0,n.maybeInsertedRow=-1)},s.inherits(d,o),t.CstyleBehaviour=d}),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],function(e,t,i){"use strict";var n=e("../../lib/oop"),s=e("../../range").Range,o=e("./fold_mode").FoldMode,r=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};n.inherits(r,o),function(){this.foldingStartMarker=/(\{|\[)[^\}\]]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{]*(\}|\])|^[\s\*]*(\*\/)/,this.getFoldWidgetRange=function(e,t,i,n){var s=e.getLine(i),o=s.match(this.foldingStartMarker);if(o){var r=o.index;if(o[1])return this.openingBracketBlock(e,o[1],i,r);var a=e.getCommentFoldRange(i,r+o[0].length,1);return a&&!a.isMultiLine()&&(n?a=this.getSectionRange(e,i):"all"!=t&&(a=null)),a}if("markbegin"!==t){var o=s.match(this.foldingStopMarker);if(o){var r=o.index+o[0].length;return o[1]?this.closingBracketBlock(e,o[1],i,r):e.getCommentFoldRange(i,r,-1)}}},this.getSectionRange=function(e,t){var i=e.getLine(t),n=i.search(/\S/),o=t,r=i.length;t+=1;for(var a=t,l=e.getLength();++t<l;){i=e.getLine(t);var c=i.search(/\S/);if(-1!==c){if(n>c)break;var u=this.getFoldWidgetRange(e,"all",t);if(u){if(u.start.row<=o)break;if(u.isMultiLine())t=u.end.row;else if(n==c)break}a=t}}return new s(o,r,a,e.getLine(a).length)}}.call(r.prototype)}),ace.define("ace/mode/json",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/json_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle","ace/worker/worker_client"],function(e,t,n){"use strict";var s=e("../lib/oop"),o=e("./text").Mode,r=e("./json_highlight_rules").JsonHighlightRules,a=e("./matching_brace_outdent").MatchingBraceOutdent,l=e("./behaviour/cstyle").CstyleBehaviour,c=e("./folding/cstyle").FoldMode,u=e("../worker/worker_client").WorkerClient,h=function(){this.HighlightRules=r,this.$outdent=new a,this.$behaviour=new l,this.foldingRules=new c};s.inherits(h,o),function(){this.getNextLineIndent=function(e,t,i){var n=this.$getIndent(t);if("start"==e){var s=t.match(/^.*[\{\(\[]\s*$/);s&&(n+=i)}return n},this.checkOutdent=function(e,t,i){return this.$outdent.checkOutdent(t,i)},this.autoOutdent=function(e,t,i){this.$outdent.autoOutdent(t,i)},this.createWorker=function(e){var t=new u(["ace"],i(419),"JsonWorker");return t.attachToDocument(e.getDocument()),t.on("error",function(t){e.setAnnotations([t.data])}),t.on("ok",function(){e.clearAnnotations()}),t},this.$id="ace/mode/json"}.call(h.prototype),t.Mode=h})},function(e,t){e.exports.id="ace/mode/json_worker",e.exports.src='"no use strict";(function(window){if(void 0===window.window||!window.document){window.console=function(){var msgs=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:msgs})},window.console.error=window.console.warn=window.console.log=window.console.trace=window.console,window.window=window,window.ace=window,window.onerror=function(message,file,line,col,err){console.error("Worker "+(err?err.stack:message))},window.normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return window.normalizeModule(parentId,chunks[0])+"!"+window.normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0)){var base=parentId.split("/").slice(0,-1).join("/");for(moduleName=(base?base+"/":"")+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/^\\.\\//,"").replace(/\\/\\.\\//,"/").replace(/[^\\/]+\\/\\.\\.\\//,"")}}return moduleName},window.acequire=function(parentId,id){if(id||(id=parentId,parentId=null),!id.charAt)throw Error("worker.js acequire() accepts only (parentId, id) as arguments");id=window.normalizeModule(parentId,id);var module=window.acequire.modules[id];if(module)return module.initialized||(module.initialized=!0,module.exports=module.factory().exports),module.exports;var chunks=id.split("/");if(!window.acequire.tlns)return console.log("unable to load "+id);chunks[0]=window.acequire.tlns[chunks[0]]||chunks[0];var path=chunks.join("/")+".js";return window.acequire.id=id,importScripts(path),window.acequire(parentId,id)},window.acequire.modules={},window.acequire.tlns={},window.define=function(id,deps,factory){if(2==arguments.length?(factory=deps,"string"!=typeof id&&(deps=id,id=window.acequire.id)):1==arguments.length&&(factory=id,deps=[],id=window.acequire.id),deps.length||(deps=["require","exports","module"]),0!==id.indexOf("text!")){var req=function(childId){return window.acequire(id,childId)};window.acequire.modules[id]={exports:{},factory:function(){var module=this,returnExports=factory.apply(this,deps.map(function(dep){switch(dep){case"require":return req;case"exports":return module.exports;case"module":return module;default:return req(dep)}}));return returnExports&&(module.exports=returnExports),module}}}},window.define.amd={},window.initBaseUrls=function initBaseUrls(topLevelNamespaces){acequire.tlns=topLevelNamespaces},window.initSender=function initSender(){var EventEmitter=window.acequire("ace/lib/event_emitter").EventEmitter,oop=window.acequire("ace/lib/oop"),Sender=function(){};return function(){oop.implement(this,EventEmitter),this.callback=function(data,callbackId){postMessage({type:"call",id:callbackId,data:data})},this.emit=function(name,data){postMessage({type:"event",name:name,data:data})}}.call(Sender.prototype),new Sender};var main=window.main=null,sender=window.sender=null;window.onmessage=function(e){var msg=e.data;if(msg.command){if(!main[msg.command])throw Error("Unknown command:"+msg.command);main[msg.command].apply(main,msg.args)}else if(msg.init){initBaseUrls(msg.tlns),acequire("ace/lib/es5-shim"),sender=window.sender=initSender();var clazz=acequire(msg.module)[msg.classname];main=window.main=new clazz(sender)}else msg.event&&sender&&sender._signal(msg.event,msg.data)}}})(this),ace.define("ace/lib/oop",["require","exports","module"],function(acequire,exports){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(acequire,exports){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;listeners.length>i&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;listeners.length>i;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback)handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop());else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter}),ace.define("ace/range",["require","exports","module"],function(acequire,exports){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return cmp=this.compare(end.row,end.column),1==cmp?(cmp=this.compare(start.row,start.column),1==cmp?2:0==cmp?1:0):-1==cmp?-2:(cmp=this.compare(start.row,start.column),-1==cmp?-1:1==cmp?42:0)},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)||this.isStart(row,column)?!1:!0:!1},this.insideStart=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)?!1:!0:!1},this.insideEnd=function(row,column){return 0==this.compare(row,column)?this.isStart(row,column)?!1:!0:!1},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?this.start.row>row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?this.end.column>=column?0:1:0:this.start.column>column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(firstRow>this.end.row)var end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(firstRow>this.start.row)var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=comparePoints,Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),column===void 0?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(e){var delta=e.data,range=delta.range;if(!(range.start.row==range.end.row&&range.start.row!=this.row||range.start.row>this.row||range.start.row==this.row&&range.start.column>this.column)){var row=this.row,column=this.column,start=range.start,end=range.end;"insertText"===delta.action?start.row===row&&column>=start.column?start.column===column&&this.$insertRight||(start.row===end.row?column+=end.column-start.column:(column-=start.column,row+=end.row-start.row)):start.row!==end.row&&row>start.row&&(row+=end.row-start.row):"insertLines"===delta.action?start.row===row&&0===column&&this.$insertRight||row>=start.row&&(row+=end.row-start.row):"removeText"===delta.action?start.row===row&&column>start.column?column=end.column>=column?start.column:Math.max(0,column-(end.column-start.column)):start.row!==end.row&&row>start.row?(end.row===row&&(column=Math.max(0,column-end.column)+start.column),row-=end.row-start.row):end.row===row&&(row-=end.row-start.row,column=Math.max(0,column-end.column)+start.column):"removeLines"==delta.action&&row>=start.row&&(row>=end.row?row-=end.row-start.row:(row=start.row,column=0)),this.setPosition(row,column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):0>row?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),0>column&&(pos.column=0),pos}}).call(Anchor.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/lib/event_emitter","ace/range","ace/anchor"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(text){this.$lines=[],0===text.length?this.$lines=[""]:Array.isArray(text)?this._insertLines(0,text):this.insert({row:0,column:0},text)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength();this.remove(new Range(0,0,len,this.getLine(len-1).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},this.$split=0==="aaa".split(/a/).length?function(text){return text.replace(/\\r\\n|\\r/g,"\\n").split("\\n")}:function(text){return text.split(/\\r\\n|\\r|\\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\\r\\n|\\r|\\n)/m);this.$autoNewLine=match?match[1]:"\\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\\r\\n";case"unix":return"\\n";default:return this.$autoNewLine||"\\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\\r\\n"==text||"\\r"==text||"\\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){if(range.start.row==range.end.row)return this.getLine(range.start.row).substring(range.start.column,range.end.column);var lines=this.getLines(range.start.row,range.end.row);lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;return range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column)),lines.join(this.getNewLineCharacter())},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):0>position.row&&(position.row=0),position},this.insert=function(position,text){if(!text||0===text.length)return position;position=this.$clipPosition(position),1>=this.getLength()&&this.$detectNewLine(text);var lines=this.$split(text),firstLine=lines.splice(0,1)[0],lastLine=0==lines.length?null:lines.splice(lines.length-1,1)[0];return position=this.insertInLine(position,firstLine),null!==lastLine&&(position=this.insertNewLine(position),position=this._insertLines(position.row,lines),position=this.insertInLine(position,lastLine||"")),position},this.insertLines=function(row,lines){return row>=this.getLength()?this.insert({row:row,column:0},"\\n"+lines.join("\\n")):this._insertLines(Math.max(row,0),lines)},this._insertLines=function(row,lines){if(0==lines.length)return{row:row,column:0};for(;lines.length>61440;){var end=this._insertLines(row,lines.slice(0,61440));lines=lines.slice(61440),row=end.row}var args=[row,0];args.push.apply(args,lines),this.$lines.splice.apply(this.$lines,args);var range=new Range(row,0,row+lines.length,0),delta={action:"insertLines",range:range,lines:lines};return this._signal("change",{data:delta}),range.end},this.insertNewLine=function(position){position=this.$clipPosition(position);var line=this.$lines[position.row]||"";this.$lines[position.row]=line.substring(0,position.column),this.$lines.splice(position.row+1,0,line.substring(position.column,line.length));var end={row:position.row+1,column:0},delta={action:"insertText",range:Range.fromPoints(position,end),text:this.getNewLineCharacter()};return this._signal("change",{data:delta}),end},this.insertInLine=function(position,text){if(0==text.length)return position;var line=this.$lines[position.row]||"";this.$lines[position.row]=line.substring(0,position.column)+text+line.substring(position.column);var end={row:position.row,column:position.column+text.length},delta={action:"insertText",range:Range.fromPoints(position,end),text:text};return this._signal("change",{data:delta}),end},this.remove=function(range){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),range.start=this.$clipPosition(range.start),range.end=this.$clipPosition(range.end),range.isEmpty())return range.start;var firstRow=range.start.row,lastRow=range.end.row;if(range.isMultiLine()){var firstFullRow=0==range.start.column?firstRow:firstRow+1,lastFullRow=lastRow-1;range.end.column>0&&this.removeInLine(lastRow,0,range.end.column),lastFullRow>=firstFullRow&&this._removeLines(firstFullRow,lastFullRow),firstFullRow!=firstRow&&(this.removeInLine(firstRow,range.start.column,this.getLine(firstRow).length),this.removeNewLine(range.start.row))}else this.removeInLine(firstRow,range.start.column,range.end.column);return range.start},this.removeInLine=function(row,startColumn,endColumn){if(startColumn!=endColumn){var range=new Range(row,startColumn,row,endColumn),line=this.getLine(row),removed=line.substring(startColumn,endColumn),newLine=line.substring(0,startColumn)+line.substring(endColumn,line.length);this.$lines.splice(row,1,newLine);var delta={action:"removeText",range:range,text:removed};return this._signal("change",{data:delta}),range.start}},this.removeLines=function(firstRow,lastRow){return 0>firstRow||lastRow>=this.getLength()?this.remove(new Range(firstRow,0,lastRow+1,0)):this._removeLines(firstRow,lastRow)},this._removeLines=function(firstRow,lastRow){var range=new Range(firstRow,0,lastRow+1,0),removed=this.$lines.splice(firstRow,lastRow-firstRow+1),delta={action:"removeLines",range:range,nl:this.getNewLineCharacter(),lines:removed};return this._signal("change",{data:delta}),removed},this.removeNewLine=function(row){var firstLine=this.getLine(row),secondLine=this.getLine(row+1),range=new Range(row,firstLine.length,row+1,0),line=firstLine+secondLine;this.$lines.splice(row,2,line);var delta={action:"removeText",range:range,text:this.getNewLineCharacter()};this._signal("change",{data:delta})},this.replace=function(range,text){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0==text.length&&range.isEmpty())return range.start;if(text==this.getTextRange(range))return range.end;if(this.remove(range),text)var end=this.insert(range.start,text);else end=range.start;return end},this.applyDeltas=function(deltas){for(var i=0;deltas.length>i;i++){var delta=deltas[i],range=Range.fromPoints(delta.range.start,delta.range.end);"insertLines"==delta.action?this.insertLines(range.start.row,delta.lines):"insertText"==delta.action?this.insert(range.start,delta.text):"removeLines"==delta.action?this._removeLines(range.start.row,range.end.row-1):"removeText"==delta.action&&this.remove(range)}},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--){var delta=deltas[i],range=Range.fromPoints(delta.range.start,delta.range.end);"insertLines"==delta.action?this._removeLines(range.start.row,range.end.row-1):"insertText"==delta.action?this.remove(range):"removeLines"==delta.action?this._insertLines(range.start.row,delta.lines):"removeText"==delta.action&&this.insert(range.start,delta.text)}},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;l>i;i++)if(index-=lines[i].length+newlineLength,0>index)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;row>i;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document}),ace.define("ace/lib/lang",["require","exports","module"],function(acequire,exports){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\\s\\s*/,trimEndRegexp=/\\s\\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;l>i;i++)copy[i]=array[i]&&"object"==typeof array[i]?this.copyObject(array[i]):array[i];return copy},exports.deepCopy=function(obj){if("object"!=typeof obj||!obj)return obj;var cons=obj.constructor;if(cons===RegExp)return obj;var copy=cons();for(var key in obj)copy[key]="object"==typeof obj[key]?exports.deepCopy(obj[key]):obj[key];return copy},exports.arrayToMap=function(arr){for(var map={},i=0;arr.length>i;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;array.length>=i;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,"\\\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})}),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}}),ace.define("ace/worker/mirror",["require","exports","module","ace/document","ace/lib/lang"],function(acequire,exports){"use strict";var Document=acequire("../document").Document,lang=acequire("../lib/lang"),Mirror=exports.Mirror=function(sender){this.sender=sender;var doc=this.doc=new Document(""),deferredUpdate=this.deferredUpdate=lang.delayedCall(this.onUpdate.bind(this)),_self=this;sender.on("change",function(e){return doc.applyDeltas(e.data),_self.$timeout?deferredUpdate.schedule(_self.$timeout):(_self.onUpdate(),void 0)})};(function(){this.$timeout=500,this.setTimeout=function(timeout){this.$timeout=timeout},this.setValue=function(value){this.doc.setValue(value),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(callbackId){this.sender.callback(this.doc.getValue(),callbackId)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(Mirror.prototype)}),ace.define("ace/mode/json/json_parse",["require","exports","module"],function(){"use strict";var at,ch,text,value,escapee={\'"\':\'"\',"\\\\":"\\\\","/":"/",b:"\\b",f:"\\f",n:"\\n",r:"\\r",t:"	"},error=function(m){throw{name:"SyntaxError",message:m,at:at,text:text}},next=function(c){return c&&c!==ch&&error("Expected \'"+c+"\' instead of \'"+ch+"\'"),ch=text.charAt(at),at+=1,ch},number=function(){var number,string="";for("-"===ch&&(string="-",next("-"));ch>="0"&&"9">=ch;)string+=ch,next();if("."===ch)for(string+=".";next()&&ch>="0"&&"9">=ch;)string+=ch;if("e"===ch||"E"===ch)for(string+=ch,next(),("-"===ch||"+"===ch)&&(string+=ch,next());ch>="0"&&"9">=ch;)string+=ch,next();return number=+string,isNaN(number)?(error("Bad number"),void 0):number},string=function(){var hex,i,uffff,string="";if(\'"\'===ch)for(;next();){if(\'"\'===ch)return next(),string;if("\\\\"===ch)if(next(),"u"===ch){for(uffff=0,i=0;4>i&&(hex=parseInt(next(),16),isFinite(hex));i+=1)uffff=16*uffff+hex;string+=String.fromCharCode(uffff)}else{if("string"!=typeof escapee[ch])break;string+=escapee[ch]}else string+=ch}error("Bad string")},white=function(){for(;ch&&" ">=ch;)next()},word=function(){switch(ch){case"t":return next("t"),next("r"),next("u"),next("e"),!0;case"f":return next("f"),next("a"),next("l"),next("s"),next("e"),!1;case"n":return next("n"),next("u"),next("l"),next("l"),null}error("Unexpected \'"+ch+"\'")},array=function(){var array=[];if("["===ch){if(next("["),white(),"]"===ch)return next("]"),array;for(;ch;){if(array.push(value()),white(),"]"===ch)return next("]"),array;next(","),white()}}error("Bad array")},object=function(){var key,object={};if("{"===ch){if(next("{"),white(),"}"===ch)return next("}"),object;for(;ch;){if(key=string(),white(),next(":"),Object.hasOwnProperty.call(object,key)&&error(\'Duplicate key "\'+key+\'"\'),object[key]=value(),white(),"}"===ch)return next("}"),object;next(","),white()}}error("Bad object")};return value=function(){switch(white(),ch){case"{":return object();case"[":return array();case\'"\':return string();case"-":return number();default:return ch>="0"&&"9">=ch?number():word()}},function(source,reviver){var result;return text=source,at=0,ch=" ",result=value(),white(),ch&&error("Syntax error"),"function"==typeof reviver?function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}({"":result},""):result}}),ace.define("ace/mode/json_worker",["require","exports","module","ace/lib/oop","ace/worker/mirror","ace/mode/json/json_parse"],function(acequire,exports){"use strict";var oop=acequire("../lib/oop"),Mirror=acequire("../worker/mirror").Mirror,parse=acequire("./json/json_parse"),JsonWorker=exports.JsonWorker=function(sender){Mirror.call(this,sender),this.setTimeout(200)};oop.inherits(JsonWorker,Mirror),function(){this.onUpdate=function(){var value=this.doc.getValue();try{parse(value)}catch(e){var pos=this.doc.indexToPosition(e.at-1);return this.sender.emit("error",{row:pos.row,column:pos.column,text:e.message,type:"error"}),void 0}this.sender.emit("ok")}}.call(JsonWorker.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function Empty(){}function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}function toInteger(n){return n=+n,n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];return array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),lengthBefore+1==array.length,lengthBefore+1==array.length?!0:void 0}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):void 0==pos?pos=0:0>pos&&(pos=Math.max(length+pos,0)),length>pos+removeCount||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailOldPos>tailNewPos)for(var i=0;tailCount>i;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;add>i;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;length>++i;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];\nif("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT+object);if(owns(object,property)){var descriptor,getter,setter;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),!Object.create){var createEmpty;createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != \'object\'");var Type=function(){};Type.prototype=prototype,object=new Type,object.__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ",ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: ",ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT_TARGET+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=function(freezeObject){return function(object){return"function"==typeof object?object:freezeObject(object)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;ii>i;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="	\\n\x0B\\f\\r \\u2028\\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=RegExp("^"+ws+ws+"*"),trimEndRegexp=RegExp(ws+ws+"*$");String.prototype.trim=function(){return(this+"").replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}var toObject=function(o){if(null==o)throw new TypeError("can\'t convert "+o+" to object");return Object(o)}});';
},function(e,t){ace.define("ace/theme/monokai",["require","exports","module","ace/lib/dom"],function(e,t,i){t.isDark=!0,t.cssClass="ace-monokai",t.cssText=".ace-monokai .ace_gutter {	background: #2F3129;	color: #8F908A	}	.ace-monokai .ace_print-margin {	width: 1px;	background: #555651	}	.ace-monokai {	background-color: #272822;	color: #F8F8F2	}	.ace-monokai .ace_cursor {	color: #F8F8F0	}	.ace-monokai .ace_marker-layer .ace_selection {	background: #49483E	}	.ace-monokai.ace_multiselect .ace_selection.ace_start {	box-shadow: 0 0 3px 0px #272822;	border-radius: 2px	}	.ace-monokai .ace_marker-layer .ace_step {	background: rgb(102, 82, 0)	}	.ace-monokai .ace_marker-layer .ace_bracket {	margin: -1px 0 0 -1px;	border: 1px solid #49483E	}	.ace-monokai .ace_marker-layer .ace_active-line {	background: #202020	}	.ace-monokai .ace_gutter-active-line {	background-color: #272727	}	.ace-monokai .ace_marker-layer .ace_selected-word {	border: 1px solid #49483E	}	.ace-monokai .ace_invisible {	color: #52524d	}	.ace-monokai .ace_entity.ace_name.ace_tag,	.ace-monokai .ace_keyword,	.ace-monokai .ace_meta.ace_tag,	.ace-monokai .ace_storage {	color: #F92672	}	.ace-monokai .ace_punctuation,	.ace-monokai .ace_punctuation.ace_tag {	color: #fff	}	.ace-monokai .ace_constant.ace_character,	.ace-monokai .ace_constant.ace_language,	.ace-monokai .ace_constant.ace_numeric,	.ace-monokai .ace_constant.ace_other {	color: #AE81FF	}	.ace-monokai .ace_invalid {	color: #F8F8F0;	background-color: #F92672	}	.ace-monokai .ace_invalid.ace_deprecated {	color: #F8F8F0;	background-color: #AE81FF	}	.ace-monokai .ace_support.ace_constant,	.ace-monokai .ace_support.ace_function {	color: #66D9EF	}	.ace-monokai .ace_fold {	background-color: #A6E22E;	border-color: #F8F8F2	}	.ace-monokai .ace_storage.ace_type,	.ace-monokai .ace_support.ace_class,	.ace-monokai .ace_support.ace_type {	font-style: italic;	color: #66D9EF	}	.ace-monokai .ace_entity.ace_name.ace_function,	.ace-monokai .ace_entity.ace_other,	.ace-monokai .ace_entity.ace_other.ace_attribute-name,	.ace-monokai .ace_variable {	color: #A6E22E	}	.ace-monokai .ace_variable.ace_parameter {	font-style: italic;	color: #FD971F	}	.ace-monokai .ace_string {	color: #E6DB74	}	.ace-monokai .ace_comment {	color: #75715E	}	.ace-monokai .ace_indent-guide {	background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWPQ0FD0ZXBzd/wPAAjVAoxeSgNeAAAAAElFTkSuQmCC) right repeat-y	}";var n=e("../lib/dom");n.importCssString(t.cssText,t.cssClass)})},function(e,t){ace.define("ace/ext/searchbox",["require","exports","module","ace/lib/dom","ace/lib/lang","ace/lib/event","ace/keyboard/hash_handler","ace/lib/keys"],function(e,t,i){"use strict";var n=e("../lib/dom"),s=e("../lib/lang"),o=e("../lib/event"),r="	.ace_search {	background-color: #ddd;	border: 1px solid #cbcbcb;	border-top: 0 none;	max-width: 297px;	overflow: hidden;	margin: 0;	padding: 4px;	padding-right: 6px;	padding-bottom: 0;	position: absolute;	top: 0px;	z-index: 99;	white-space: normal;	}	.ace_search.left {	border-left: 0 none;	border-radius: 0px 0px 5px 0px;	left: 0;	}	.ace_search.right {	border-radius: 0px 0px 0px 5px;	border-right: 0 none;	right: 0;	}	.ace_search_form, .ace_replace_form {	border-radius: 3px;	border: 1px solid #cbcbcb;	float: left;	margin-bottom: 4px;	overflow: hidden;	}	.ace_search_form.ace_nomatch {	outline: 1px solid red;	}	.ace_search_field {	background-color: white;	border-right: 1px solid #cbcbcb;	border: 0 none;	-webkit-box-sizing: border-box;	-moz-box-sizing: border-box;	box-sizing: border-box;	display: block;	float: left;	height: 22px;	outline: 0;	padding: 0 7px;	width: 214px;	margin: 0;	}	.ace_searchbtn,	.ace_replacebtn {	background: #fff;	border: 0 none;	border-left: 1px solid #dcdcdc;	cursor: pointer;	display: block;	float: left;	height: 22px;	margin: 0;	padding: 0;	position: relative;	}	.ace_searchbtn:last-child,	.ace_replacebtn:last-child {	border-top-right-radius: 3px;	border-bottom-right-radius: 3px;	}	.ace_searchbtn:disabled {	background: none;	cursor: default;	}	.ace_searchbtn {	background-position: 50% 50%;	background-repeat: no-repeat;	width: 27px;	}	.ace_searchbtn.prev {	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADFJREFUeNpiSU1NZUAC/6E0I0yACYskCpsJiySKIiY0SUZk40FyTEgCjGgKwTRAgAEAQJUIPCE+qfkAAAAASUVORK5CYII=);    	}	.ace_searchbtn.next {	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADRJREFUeNpiTE1NZQCC/0DMyIAKwGJMUAYDEo3M/s+EpvM/mkKwCQxYjIeLMaELoLMBAgwAU7UJObTKsvAAAAAASUVORK5CYII=);    	}	.ace_searchbtn_close {	background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAcCAYAAABRVo5BAAAAZ0lEQVR42u2SUQrAMAhDvazn8OjZBilCkYVVxiis8H4CT0VrAJb4WHT3C5xU2a2IQZXJjiQIRMdkEoJ5Q2yMqpfDIo+XY4k6h+YXOyKqTIj5REaxloNAd0xiKmAtsTHqW8sR2W5f7gCu5nWFUpVjZwAAAABJRU5ErkJggg==) no-repeat 50% 0;	border-radius: 50%;	border: 0 none;	color: #656565;	cursor: pointer;	display: block;	float: right;	font-family: Arial;	font-size: 16px;	height: 14px;	line-height: 16px;	margin: 5px 1px 9px 5px;	padding: 0;	text-align: center;	width: 14px;	}	.ace_searchbtn_close:hover {	background-color: #656565;	background-position: 50% 100%;	color: white;	}	.ace_replacebtn.prev {	width: 54px	}	.ace_replacebtn.next {	width: 27px	}	.ace_button {	margin-left: 2px;	cursor: pointer;	-webkit-user-select: none;	-moz-user-select: none;	-o-user-select: none;	-ms-user-select: none;	user-select: none;	overflow: hidden;	opacity: 0.7;	border: 1px solid rgba(100,100,100,0.23);	padding: 1px;	-moz-box-sizing: border-box;	box-sizing:    border-box;	color: black;	}	.ace_button:hover {	background-color: #eee;	opacity:1;	}	.ace_button:active {	background-color: #ddd;	}	.ace_button.checked {	border-color: #3399ff;	opacity:1;	}	.ace_search_options{	margin-bottom: 3px;	text-align: right;	-webkit-user-select: none;	-moz-user-select: none;	-o-user-select: none;	-ms-user-select: none;	user-select: none;	}",a=e("../keyboard/hash_handler").HashHandler,l=e("../lib/keys");n.importCssString(r,"ace_searchbox");var c='<div class="ace_search right">	    <button type="button" action="hide" class="ace_searchbtn_close"></button>	    <div class="ace_search_form">	        <input class="ace_search_field" placeholder="Search for" spellcheck="false"></input>	        <button type="button" action="findNext" class="ace_searchbtn next"></button>	        <button type="button" action="findPrev" class="ace_searchbtn prev"></button>	    </div>	    <div class="ace_replace_form">	        <input class="ace_search_field" placeholder="Replace with" spellcheck="false"></input>	        <button type="button" action="replaceAndFindNext" class="ace_replacebtn">Replace</button>	        <button type="button" action="replaceAll" class="ace_replacebtn">All</button>	    </div>	    <div class="ace_search_options">	        <span action="toggleRegexpMode" class="ace_button" title="RegExp Search">.*</span>	        <span action="toggleCaseSensitive" class="ace_button" title="CaseSensitive Search">Aa</span>	        <span action="toggleWholeWords" class="ace_button" title="Whole Word Search">\\b</span>	    </div>	</div>'.replace(/>\s+/g,">"),u=function(e,t,i){var s=n.createElement("div");s.innerHTML=c,this.element=s.firstChild,this.$init(),this.setEditor(e)};(function(){this.setEditor=function(e){e.searchBox=this,e.container.appendChild(this.element),this.editor=e},this.$initElements=function(e){this.searchBox=e.querySelector(".ace_search_form"),this.replaceBox=e.querySelector(".ace_replace_form"),this.searchOptions=e.querySelector(".ace_search_options"),this.regExpOption=e.querySelector("[action=toggleRegexpMode]"),this.caseSensitiveOption=e.querySelector("[action=toggleCaseSensitive]"),this.wholeWordOption=e.querySelector("[action=toggleWholeWords]"),this.searchInput=this.searchBox.querySelector(".ace_search_field"),this.replaceInput=this.replaceBox.querySelector(".ace_search_field")},this.$init=function(){var e=this.element;this.$initElements(e);var t=this;o.addListener(e,"mousedown",function(e){setTimeout(function(){t.activeInput.focus()},0),o.stopPropagation(e)}),o.addListener(e,"click",function(e){var i=e.target||e.srcElement,n=i.getAttribute("action");n&&t[n]?t[n]():t.$searchBarKb.commands[n]&&t.$searchBarKb.commands[n].exec(t),o.stopPropagation(e)}),o.addCommandKeyListener(e,function(e,i,n){var s=l.keyCodeToString(n),r=t.$searchBarKb.findKeyCommand(i,s);r&&r.exec&&(r.exec(t),o.stopEvent(e))}),this.$onChange=s.delayedCall(function(){t.find(!1,!1)}),o.addListener(this.searchInput,"input",function(){t.$onChange.schedule(20)}),o.addListener(this.searchInput,"focus",function(){t.activeInput=t.searchInput,t.searchInput.value&&t.highlight()}),o.addListener(this.replaceInput,"focus",function(){t.activeInput=t.replaceInput,t.searchInput.value&&t.highlight()})},this.$closeSearchBarKb=new a([{bindKey:"Esc",name:"closeSearchBar",exec:function(e){e.searchBox.hide()}}]),this.$searchBarKb=new a,this.$searchBarKb.bindKeys({"Ctrl-f|Command-f|Ctrl-H|Command-Option-F":function(e){var t=e.isReplace=!e.isReplace;e.replaceBox.style.display=t?"":"none",e[t?"replaceInput":"searchInput"].focus()},"Ctrl-G|Command-G":function(e){e.findNext()},"Ctrl-Shift-G|Command-Shift-G":function(e){e.findPrev()},esc:function(e){setTimeout(function(){e.hide()})},Return:function(e){e.activeInput==e.replaceInput&&e.replace(),e.findNext()},"Shift-Return":function(e){e.activeInput==e.replaceInput&&e.replace(),e.findPrev()},Tab:function(e){(e.activeInput==e.replaceInput?e.searchInput:e.replaceInput).focus()}}),this.$searchBarKb.addCommands([{name:"toggleRegexpMode",bindKey:{win:"Alt-R|Alt-/",mac:"Ctrl-Alt-R|Ctrl-Alt-/"},exec:function(e){e.regExpOption.checked=!e.regExpOption.checked,e.$syncOptions()}},{name:"toggleCaseSensitive",bindKey:{win:"Alt-C|Alt-I",mac:"Ctrl-Alt-R|Ctrl-Alt-I"},exec:function(e){e.caseSensitiveOption.checked=!e.caseSensitiveOption.checked,e.$syncOptions()}},{name:"toggleWholeWords",bindKey:{win:"Alt-B|Alt-W",mac:"Ctrl-Alt-B|Ctrl-Alt-W"},exec:function(e){e.wholeWordOption.checked=!e.wholeWordOption.checked,e.$syncOptions()}}]),this.$syncOptions=function(){n.setCssClass(this.regExpOption,"checked",this.regExpOption.checked),n.setCssClass(this.wholeWordOption,"checked",this.wholeWordOption.checked),n.setCssClass(this.caseSensitiveOption,"checked",this.caseSensitiveOption.checked),this.find(!1,!1)},this.highlight=function(e){this.editor.session.highlight(e||this.editor.$search.$options.re),this.editor.renderer.updateBackMarkers()},this.find=function(e,t){var i=this.editor.find(this.searchInput.value,{skipCurrent:e,backwards:t,wrap:!0,regExp:this.regExpOption.checked,caseSensitive:this.caseSensitiveOption.checked,wholeWord:this.wholeWordOption.checked}),s=!i&&this.searchInput.value;n.setCssClass(this.searchBox,"ace_nomatch",s),this.editor._emit("findSearchBox",{match:!s}),this.highlight()},this.findNext=function(){this.find(!0,!1)},this.findPrev=function(){this.find(!0,!0)},this.replace=function(){this.editor.getReadOnly()||this.editor.replace(this.replaceInput.value)},this.replaceAndFindNext=function(){this.editor.getReadOnly()||(this.editor.replace(this.replaceInput.value),this.findNext())},this.replaceAll=function(){this.editor.getReadOnly()||this.editor.replaceAll(this.replaceInput.value)},this.hide=function(){this.element.style.display="none",this.editor.keyBinding.removeKeyboardHandler(this.$closeSearchBarKb),this.editor.focus()},this.show=function(e,t){this.element.style.display="",this.replaceBox.style.display=t?"":"none",this.isReplace=t,e&&(this.searchInput.value=e),this.searchInput.focus(),this.searchInput.select(),this.editor.keyBinding.addKeyboardHandler(this.$closeSearchBarKb)}}).call(u.prototype),t.SearchBox=u,t.Search=function(e,t){var i=e.searchBox||new u(e);i.show(e.session.getTextRange(),t)}}),function(){ace.acequire(["ace/ext/searchbox"],function(){})}()},function(e,t,i){"use strict";var n=i(409),s=n.acequire("ace/lib/dom"),o=i(423),r={isDark:!1,cssClass:"ace-post-form",cssText:o};s.importCssString(r.cssText,r.cssClass),e.exports=r},function(e,t){e.exports=".ace-post-form .ace_selection{background-color:rgba(220,236,245,0.8)}.ace-post-form .ace_entity{color:#f2992e}.ace-post-form .ace_string{color:#748089}.ace-post-form .ace_underline{color:#56bc8a;text-decoration:underline}.ace-post-form .ace_storage{color:#d95e40}.ace-post-form .ace_operator{color:#748089}.ace-post-form .ace_identifier{color:#9da6af}.ace-post-form .ace_function{color:#f2992e}.ace-post-form .ace_type{color:#a77dc2}.ace-post-form .ace_constant{color:#d95e40}.ace-post-form .ace_variable{color:#56bc8a}.ace-post-form .ace_keyword{color:#f2992e}.ace-post-form .ace_tag,.ace-post-form .ace_attribute-equals,.ace-post-form .ace_attribute-name{color:#529ecc}.ace-post-form .ace_attribute-value{color:#a77dc2}.ace-post-form .ace_heading{color:#529ecc}.ace-post-form .ace_strong{color:#000}.ace-post-form .ace_emphasis{color:#748089}.ace-post-form .ace_list.ace_markup{color:#a77dc2}\n"},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(425),r=i(201),a=(i(202),s.extend({name:"Upload",initialize:function(e){e=n.extend({},e),this.collection=e.collection||(e.collection=new r),this.indexView=new o(e),this.listenTo(this.collection,"all",this._relayCollectionEvent)},_relayCollectionEvent:function(){this.trigger.apply(this,arguments)},addFiles:function(e){return this.indexView.add({files:e})},promise:function(){return this.indexView.promise()},teardown:function(){return this.remove()},remove:function(){return this.indexView.remove(),this.stopListening(),this},render:function(){return this.indexView.render(),this},getElement:function(){return this.indexView.$el}}));e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(6).sprintf,o=i(149),r=i(116),a=i(121),l=i(101),c=i(201),u=i(202),h=i(426),d=["add","submit","send","done","fail","always","progress","progressall","start","stop","change","paste","drop","dragover","chunksend","chunkdone","chunkfail","chunkalways"],p=["add","send","progress","active","enable","disable"],g=o.extend({tagName:"input",attributes:{type:"file"},defaults:{name:"photo",maxUploadSize:!1,uploadPattern:!1,mediaType:"image",message:{cancel:"Canceled upload",error:"Upload error",filesize:"The file is too big. Squish it down, and try again!",filetype:"This is not valid %1$s file."},fileUpload:{singleFileUploads:!0,limitConcurrentUploads:1,sequentialUploads:!1,autoUpload:!0,formData:[],dataType:"json",dropZone:null,pasteZone:null}},_createUploadModel:function(e,t){var i=new u(e);return this.collection.add(i,t||{}),i},_createUploadModelForFile:function(e,t,i){t=n.extend({file:e},t);var s=this._createUploadModel(t,i);return e._uploadModel=s,s},initialize:function(e){if(this.options=n.merge({},this.defaults,e),this.options.url&&(this.options.fileUpload.url=this.options.url),this.options.collection?this.collection=this.options.collection:this.collection=new c,!this.options.fileUpload.url)throw new Error("Upload requires an endpoint URL");this.$el.prop("tabindex",-1),this.options.fileUpload.multiple&&this.$el.prop("multiple",!0),this.options.accept&&this.$el.prop("accept",this.options.accept);var t=n.merge({},this._fileUploadWrap);n.forEach(d,function(e){n.isFunction(t.defaults[e])||(t.defaults[e]=n.noop)},this);var i=new r(t);i.applyTo(this.options.fileUpload),n.forEach(d,function(e){this.options.fileUpload[e]=h(this.options.fileUpload[e],this)},this),this.$el.attr("name",this.options.name).fileupload(this.options.fileUpload),this._fileUpload=this.$el.data("blueimp-fileupload"),n.forEach(p,function(e){this[e]=function(){var t=n.toArray(arguments);t.unshift(e),this._fileUploadInvoke.apply(this,t)}},this)},_fileUploadInvoke:function(e){return this._fileUpload[e].apply(this._fileUpload,n.rest(arguments))},validateFile:function(e,t){t||(t=this.options);var i=[];return t.maxUploadSize&&e.size>t.maxUploadSize&&i.push({type:"filesize",message:s(t.message.filesize,t.maxUploadSize)}),t.uploadPattern&&e.type&&!t.uploadPattern.test(e.type)&&i.push({type:"filetype",message:s(t.message.filetype,t.mediaType)}),i},upload:function(e){this.add({files:[e]})},cancel:function(){var e;return this.jqXHR?(e=this.jqXHR.abort(),this.jqXHR=null):e=a.reject(this.options.message.cancel),e},_forMatchingFiles:function(e,t){var i=n.rest(arguments);this.collection.forEach(function(s){if(n.contains(e,s.get("file"))){var o=n.clone(i);o[0]=s,t.apply(this,o)}},this)},promise:function(){return this.collection.promise()},_fileUploadWrap:{defaults:{change:function(e,t,i){this._fileUpload.options.replaceFileInput&&this.setElement(e)},add:function(e,t,i){var s=i.files[0],o=this.validateFile(s),r={},a={};if(!n.isEmpty(o)){r.error=n.pluck(o,"message"),r.file=s;var l={errorType:"validation",messages:o,file:s};this.collection.trigger("invalid",this.collection,new this.collection.model(r)),this.trigger("error",l),a.silent=!0}return this._createUploadModelForFile(s,r,a),n.isEmpty(o)},send:function(e,t,i){return!0}},before:{},after:{done:function(e,t,i){var s,o=n.get(i,"result.meta.status"),r=n.get(i,"result.response"),a=n.get(i,"result.errors");if(200!==o||n.isEmpty(r)){var c=function(){return r&&r.msg?r.msg:n.isArray(a)?n.isEmpty(a)?l("Woops :("):a:a.join(" ")}();s={error:c,uploading:!1}}else n.isArray(r)&&(r=r[0]),s=n.extend({complete:!0,uploading:!1},r);this._forMatchingFiles(i.files,function(e,t){e.set(t)},s)},fail:function(e,t,i){var s;s="abort"===i.errorThrown?{uploading:!1}:{error:this.options.message.error,uploading:!1},s.responseJSON=n.get(i,"jqXHR.responseJSON"),this._forMatchingFiles(i.files,function(e,t){e.set(t)},s)},progress:function(e,t,i){this._forMatchingFiles(i.files,function(e,t){e.set(t)},{bytesLoaded:i.loaded,bytesTotal:i.total})}},around:{add:function(e,t,i,s){var o=e.apply(this,n.rest(arguments));return o===!1||i.isDefaultPrevented()?!1:((s.autoUpload||s.autoUpload!==!1&&this._fileUpload.options.autoUpload)&&s.process().done(n.bind(function(){this.jqXHR=s.submit()},this)),o)},send:function(e,t,i,s){s.with_form_key=!0;var o=e.apply(this,n.rest(arguments));if(o){this._forMatchingFiles(s.files,function(e,t){e.set(t)},{uploading:!0});var r={files:s.files};this.collection.trigger("send",this.collection,r),this.trigger("send",r)}return o}}}});e.exports=g},function(e,t,i){"use strict";var n=function(e,t){return t||(t=this),function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),e.apply(t,i)}};e.exports=n},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(116),r=i(110),a=new o({defaults:{$tabLimiterEl:n(),_tabLimiterAutoFocus:!1,_tabLimiterItems:[],_tabLimiterSelector:["input","select","textarea","button","object","a","div"],_tabLimiterCurrentIndex:-1,_tabLimiterEnterKey:!0},__tabLimiterTabKeydown:function(e){return e.preventDefault(),e.stopPropagation(),e.shiftKey&&-1===this._tabLimiterCurrentIndex&&(this._tabLimiterCurrentIndex=0),this._tabLimiterCurrentIndex=(this._tabLimiterCurrentIndex+(e.shiftKey?-1:1)+this._tabLimiterItems.length)%this._tabLimiterItems.length,this._focusTabbableItem(),!1},__tabLimiterItemKeydown:function(e){e=e||window.event;var t=e.which||e.keyCode;if(13===t){e.preventDefault(),e.stopPropagation();var i=n(e.target),s=i.find("input");return s.length?s.trigger("click"):i.trigger("click"),!1}},__tabbableItemFocus:function(e){var t=s.indexOf(this._tabLimiterItems,e.target);this._tabLimiterCurrentIndex=t>=0?t:this._tabLimiterCurrentIndex},_focusTabbableItem:function(){if(this.$tabLimiterEl&&this.$tabLimiterEl.length){var e=n(this._tabLimiterItems[this._tabLimiterCurrentIndex]);e.length&&e.focus()}},isTabbable:function(e){var t=n(e),i=e.nodeName.toLowerCase(),s=t.attr("tabindex"),o=!1;return o=/input|select|textarea|button|object/.test(i)?!e.disabled&&!t.is(":hidden"):(e.href||!isNaN(s))&&!t.is(":hidden"),(isNaN(s)||s>=0)&&o},updateTabbableItems:function(){this.$tabLimiterEl&&this.$tabLimiterEl.length&&(this._tabLimiterItems=s.filter(this.$tabLimiterEl.find(this._tabLimiterSelector.join(",")),s.bind(function(e){return this.isTabbable(e)},this)),this._tabLimiterItems.length&&(this._tabLimiterItems=s.sortBy(this._tabLimiterItems,function(e){return e.tabIndex})))},catchTabs:function(e){if(this.releaseTabs(),this.$tabLimiterEl=e?n(e):this.$tabLimiterEl,this.$tabLimiterEl&&this.$tabLimiterEl.length){this.updateTabbableItems(),this._tabLimiterAutoFocus&&this._focusTabbableItem();var t=this._tabLimiterSelector.join(",");this.listenTo(r,"DOMEventor:keydown:tab",this.__tabLimiterTabKeydown),this.listenTo(r,"DOMEventor:keydown:shift+tab",this.__tabLimiterTabKeydown),this.$tabLimiterEl.on("focus.tablimiter",t,s.bind(this.__tabbableItemFocus,this)),this._tabLimiterEnterKey&&this.$tabLimiterEl.on("keydown.tablimiter",t,s.bind(this.__tabLimiterItemKeydown,this))}},releaseTabs:function(){this.$tabLimiterEl&&this.$tabLimiterEl.length&&(this._tabLimiterItems=[],this._tabLimiterCurrentIndex=-1,this.stopListening(r,"DOMEventor:keydown:tab",this.__tabLimiterTabKeydown),this.stopListening(r,"DOMEventor:keydown:shift+tab",this.__tabLimiterTabKeydown),this.$tabLimiterEl.off(".tablimiter"))}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="editor editor-richtext" aria-label="'+(null==(__t=ariaLabel)?"":_.escape(__t))+'" contenteditable="true" data-js-richtexteditor></div><div data-subview="htmlField"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=function(){return{uploadImageUrl:function(e,t,i,s){var o=n.ajax({url:"/svc/post/upload_image_url",type:"POST",with_form_key:!0,data:{url:e}});return"function"==typeof t&&o.done(function(i){t.call(null,i,e)}),"function"==typeof i&&o.fail(i),"function"==typeof s&&o.always(s),o}}}();e.exports=s},function(e,t){"use strict";function i(e){var t,i=[];for(var n in e)t=e[n],i.push([new RegExp("(</?)("+n+")([>\\s])","gi"),"$1"+t+"$3"]);return i}function n(e,t){for(var i=0;i<t.length;i++)e=e.replace.apply(e,t[i]);return e}function s(e,t){for(var s,o=i(t||u),r=e.split(c),h=!1,d="",p=0;p<r.length;p++)s=r[p],d?s===d&&(d=""):h&&(">"===s?h=!1:s.match(l)&&(d=s)),!d&&s.match(a)&&(">"!==s.slice(-1)&&(h=!0),r[p]=n(s,o));return r.join("")}var o="<\\/?\\w+[\\s>]",r="['\"]",a=new RegExp(o,"g"),l=new RegExp(r,"g"),c=new RegExp("("+o+"|"+r+"|>)","g"),u={strong:"b",em:"i"};e.exports=s},function(e,t,i){"use strict";var n=i(3),s=function(e,t){return t||(t=this),function(){var i=n.toArray(arguments);return n.map(e,function(e){return e.apply(t,i)},t)}};e.exports=s},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="title"></div><div data-subview="reblogTree"></div><div data-subview="body"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(340),o=i(143),r=(i(103),i(101)),a=i(192),l=i(106),c="FileReader"in window&&"readAsDataURL"in FileReader.prototype,u=i(193),h=i(185),d=i(434),p=i(468),g=i(356),m=i(342),f=i(473),v=2048,_=s.extend({template:f,defaults:n.defaults({hasMediaView:!0,hasMedia:!1,canAddMedia:!0,showPhotoBooth:!1,showCaption:!1,disablePhotoFromUrl:!1},s.prototype.defaults),afterInitialize:function(){this._urlParser=n.debounce(n.bind(this._photoUrlParser,this),100),!this.post.photos.isEmpty()||this.post.isReblog()?this.set({hasMedia:!0,showCaption:!0}):!this.post.get("caption")&&n.isEmpty(this.post.get("tags"))||this.set("showCaption",!0),this.set("canAddMedia",this.post.canEditMedia()&&this.post.canAddPhotos()),this.set("hideControlsLine",!this.get("showCaption"))},_photoUrlParser:function(e,t,i){if(e=n.trim(e),e&&e.length<v&&u.isUrl(e)){var s=new h;this.listenTo(s,"photo:readUrl",function(e,i){e&&this.post.canAddPhotos()&&(this.post.photos.push(i),t.urlInput.setEditorValue(""),t.urlInput.blur(),t.set({showInput:!1,dropzoneBehavior:"url",defaultBehavior:"url"}))}),s.set("externalUrl",e)}},createSubViews:function(){var e=this.subViewOptions(),t=n.extend({canEditMedia:this.post.canEditMedia()},e),i=n.extend({toggleDropzone:this.get("hasMedia"),dropzoneText:r("Add another"),uploadIcon:"dropzone-add-photo-icon",uploadText:r("Upload photos"),urlIcon:"dropzone-add-url-icon",urlText:r("Add photo from web"),urlPlaceholder:r("Paste a URL"),urlAriaLabel:r("Paste a URL"),urlParser:this._urlParser,uploadOptions:{}},e);n.extend(i.uploadOptions,{name:"photo",maxUploadSize:10485760,uploadPattern:/^image\/(?:.*)$/i,accept:"image/*",url:"/svc/post/upload_photo",fileUpload:{multiple:!0}});var s=n.extend({className:"caption-field",name:"caption",placeholder:r("Add a caption, if you like"),ariaLabel:r("Caption")},e),o=n.extend({isRemovable:!0},e);this.mediaPreview=this.subViews.mediaPreview=new d(t),this.mediaComposer=this.subViews.mediaComposer=new p(i),this.caption=this.subViews.caption=new g(s),this.post.isReblog()&&(this.reblogTree=this.subViews.reblogTree=new m(o))},addStateListeners:function(){this.listenTo(this.mediaComposer,"upload:start",this._onFileUploadStart),this.listenTo(this.mediaComposer,"upload:complete",this._onFileUploadComplete),this.listenTo(this.mediaComposer,"upload:error upload:invalid",this._onFileUploadError),this.listenTo(this.mediaComposer,"webcam:show",function(){this.set("showPhotoBooth",!0)}),this.listenTo(this.post.photos,"add",this._onAddPhotos),this.listenTo(this.post.photos,"remove",this._onRemovePhotos),this.listenTo(this.mediaPreview,"media:ready",function(){var e=n.toArray(arguments);e.unshift("media:ready"),this.trigger.apply(this,e)}),this.listenTo(this.mediaPreview,"media:addFiles",function(e){this.mediaComposer.addFiles(e)}),this.listenTo(this.mediaPreview,"webcam:close",function(){this.set("showPhotoBooth",!1)}),this.listenTo(this.mediaPreview,"webcam:error",function(e){"NO_DEVICES_FOUND"===e&&(o.alert({text_ok:r("Aw, alright"),text:"<p>"+r("Sorry, beautiful. If you wanna take a selfie, you're gonna need a webcam.")+"</p>"}),this.mediaComposer.set("enableSelfie",!1))}),this.listenTo(this,"change:hasMedia",this._onChangeHasMedia),this.listenTo(this,"change:canAddMedia",this._onChangeCanAddMedia),this.listenTo(this,"change:showPhotoBooth",this._onChangeShowPhotoBooth),this.listenTo(this,"change:showCaption",this._onChangeShowCaption)},_onAddPhotos:function(e,t){this.set({hasMedia:!this.post.photos.isEmpty(),canAddMedia:this.post.canAddPhotos()}),n.isEmpty(this.post.get("caption"))&&n.isEmpty(this.post.get("tags"))?this.set("showCaption",this.get("hasMedia")):this.set("showCaption",!0),this.get("showCaption")&&this.caption.focus(),this.mediaComposer.set({toggleDropzone:!this.post.photos.isEmpty()})},_onRemovePhotos:function(e,t){this.set({hasMedia:!this.post.photos.isEmpty()||this.get("showPhotoBooth"),canAddMedia:this.post.canAddPhotos()}),this.mediaComposer.set({toggleDropzone:!this.post.photos.isEmpty()})},_onChangeHasMedia:function(e,t){this.isRendered()&&(t?this.mediaPreview.$el.css({display:"block",opacity:1}):this.mediaPreview.$el.css({display:"none",opacity:0}))},_onChangeCanAddMedia:function(e,t){this.isRendered()&&(this.mediaPreview.$el.toggleClass("photo-media-container--can-add",t),t?this.mediaComposer.$el.css({display:"block",opacity:1}):this.mediaComposer.$el.css({display:"none",opacity:0}))},_onChangeShowPhotoBooth:function(e,t){this.isRendered()&&(this.mediaPreview.set("showPhotoBooth",t),this.mediaPreview.$el.toggleClass("photo-media-container--show-photobooth",t),t?(this.mediaPreview.$el.css({display:"block",opacity:1}),this.mediaComposer.$el.css({display:"none",opacity:0})):(this._onChangeHasMedia(this,this.get("hasMedia")),this._onChangeCanAddMedia(this,this.get("canAddMedia"))))},_onChangeShowCaption:function(e,t){this.set("hideControlsLine",!t),this.isRendered()&&(t?this.js$("caption").css({display:"block",opacity:1}):this.js$("caption").css({display:"none",opacity:0}))},_onFileUploadStart:function(e){if(!n.isEmpty(e.get("error")))return this._onFileUploadError(e);this.uploads.add(e);var t=e.get("file");this.mediaPreview.set({file:t,canEditMedia:!0});var i=new h;c?this.listenTo(i,"photo:readFile",function(e,t){e&&this.post.canAddPhotos()&&(this.post.photos.push(t),this.mediaComposer.set({dropzoneBehavior:"upload",defaultBehavior:"upload"}))}):this.listenTo(i,"change:preuploadUrl",function(e,t){t&&(this.stopListening(e,"change:preuploadUrl"),this.post.canAddPhotos()&&(this.post.photos.push(e),this.mediaComposer.set({dropzoneBehavior:"upload",defaultBehavior:"upload"})))}),e.set("postPhoto",i),i.set("upload",e),i.set("file",t)},_onFileUploadComplete:function(e){var t=e.get("postPhoto");t&&e.get("url")&&t.set("preuploadUrl",e.get("url"))},_onFileUploadError:function(e){var t=e.get("error");n.isString(t)&&(t=[t]),n.isArray(t)||(t=[r("Woops :(")]),e.get("original_filename")&&t.unshift(e.get("original_filename")),o.alert("<p>"+t.join("</p><p>")+"</p>");var i=e.get("postPhoto");this.post.photos.remove(i),this.uploads.remove(e)},afterRender:function(){this.get("disablePhotoFromUrl")||this.checkUrl(),this.renderSubViews(),this.get("canAddMedia")?this.mediaPreview.$el.addClass("photo-media-container--can-add"):this.mediaComposer.$el.css({display:"none",opacity:0}),this.get("hasMedia")||this.mediaPreview.$el.css({display:"none",opacity:0}),this.get("showCaption")?this.delayedFocus(this.caption):this.js$("caption").css({display:"none",opacity:0}),this.get("showPhotoBooth")&&n.defer(n.bind(function(){this._onChangeShowPhotoBooth(this,this.get("showPhotoBooth"))},this))},checkUrl:function(){var e=a.getParameter("src"),t=a.getParameter("caption"),i=a.getParameter("tags");a.isAbsoluteUrl(e)||(e=l.get("Context.hosts.assets_host")+e),"edit"!==this.model.get("mode")&&e&&t&&i&&(this._photoUrlParser(e,this.mediaComposer),this.model.set("caption",t),this.model.set("tags",i.split(",")),this.get("disablePhotoFromUrl")||window.Backbone.history.navigate("/new/photo",{replace:!0}))},getRichTextEditor:function(){return this.caption}});e.exports=_},function(e,t,i){"use strict";var n=i(3),s=i(435),o=i(101),r=i(436),a=i(439),l=i(447),c=i(449),u=i(463),h=i(170),d=i(465),p=i(467),g=s.extend({className:"media-container photo-media-container",template:p,mixins:[h],defaults:n.defaults({canPreview:!0,showPhotoBooth:!1,minFullWidthSize:{}},s.prototype.defaults),afterInitialize:function(){this.addStateListeners(),this._updatePhotosetView=n.debounce(this.updatePhotosetView,50)},addStateListeners:function(){this.listenTo(this.post.photos,"add",this._onPhotosAdd),this.listenTo(this.post.photos,"remove",this._onPhotosRemove),this.listenTo(this,"change:showPhotoBooth",function(e,t){t?(this._createPhotoBooth(),n.isString(t)&&this.photobooth.indexView.set("watermarkUrl",t),this.js$("photoset").css("display","none")):(this.stopListening(this.photobooth),this.photobooth.remove(),this.js$("photoset").css("display",""))})},updatePhotosetView:function(){this.photoset.model.fixLayout(),this.photoset.indexView.trigger("update",this.photoset.model.photos,this.photoset.model.get("layout"))},_onPhotosAdd:function(e,t){this.post.set("linkthrough",""),e=this._preparePhotosetPhotoModel(e),this.photoset.model.add(e),this._updatePhotosetView()},_onPhotosRemove:function(e,t){this.post.set("linkthrough",""),this.photoset.model.remove(e.id),this.updatePhotosetView()},_preparePhotosetPhotoModel:function(e){n.isFunction(e.toJSON)&&(e=e.toJSON()),e.url=e.displayUrl;var t=n.keys(a.prototype.defaults);return t.unshift("id"),n.pick(e,t)},_syncPostToPhotoset:function(e){e||(e=this.photoset.model);var t=this.post.photos.map(this._preparePhotosetPhotoModel,this);e.photos.reset(t),e.set("layout",this.post.get("layout"))},_createPhotoBooth:function(){var e=this.photobooth=new c;e.render(),this.listenTo(e,"webcam:image",function(e){e&&e.base64&&this.post.photos.unshift({
photoRaw:e.base64.split("base64,")[1],base64:e.base64,isSelfie:!0,isSelfieGif:e.isGif||!1,height:e.height,width:e.width})}),this.listenTo(e,"webcam:error",function(e){this.trigger("webcam:error",e)}),this.listenTo(e,"webcam:reset",function(){this.post.photos.shift()}),this.listenTo(e,"webcam:close",function(){this.post.photos.shift(),this.trigger("webcam:close")}),this.js$("photobooth").append(e.getElement())},_createPhotoset:function(){var e={dynamic:!0,padding:2,width:540,minFullWidthSize:this.get("minFullWidthSize"),addMargin:this.options.fullWidthInlineMedia};this.get("canEditMedia")&&(e.PhotosetView=l,e.PhotoView=u,e.post=this.post);var t=this.photoset=new r(e);return this._syncPostToPhotoset(t.model),this.get("canEditMedia")&&(this.listenTo(this.photoset,"change:layout",function(e,t){this.post.set("layout",t)}),this.listenTo(this.photoset,"sort",function(e){this.post.photos.setIdOrder(e.pluck("id"))}),this.listenTo(this.photoset,"photo:remove",function(e,t,i){this.set("layout",i),this.post.photos.remove(t)}),this.listenTo(this.photoset.indexView,"photoset:predrag",function(){this.overlayPopover&&this.overlayPopover.teardown()}),this.listenTo(this.photoset,"photo:editClickthroughUrl",this._createClickthroughUrlPopover),this.listenTo(this.photoset,"photo:editCaption",this._createCaptionPopover),this.listenTo(this.photoset,"change:caption",function(e,t){var i=this.post.photos.get(e.id);i&&i.set("caption",t)})),this.photoset.model.fixLayout(),t.render(),this.js$("photoset").append(t.getElement()),this.get("canEditMedia")&&this.listenTo(this.dragEvents,"drop",this._onDrop),t},_createClickthroughUrlPopover:function(e,t){this.overlayPopover&&(this.overlayPopover=this.overlayPopover.remove());var i=this.overlayPopover=new d({pinnedTarget:t,pinnedTargetContainer:this.photoset.getElement(),value:this.post.get("linkthrough"),ariaLabel:o("Clickthrough URL"),placeholder:"http://"});i.render(),this.listenTo(i,"change:value",function(e,t){t=n.trim(t||""),this.post.set("linkthrough",t)}),this.listenToOnce(i,"close",function(){this.stopListening(i),delete this.overlayPopover})},_createCaptionPopover:function(e,t){this.overlayPopover&&(this.overlayPopover=this.overlayPopover.remove());var i=this.overlayPopover=new d({pinnedTarget:t,pinnedTargetContainer:this.photoset.getElement(),maxLength:200,value:e.get("caption"),placeholder:o("Caption this photo"),updateShift:!1});i.render(),this.listenTo(i,"change:value",function(t,i){e.set("caption",n.trim(i||""))}),this.listenToOnce(i,"close",function(){this.stopListening(i),delete this.overlayPopover})},_onDrop:function(e){if(!n.isEmpty(this.$el.find(e.target))){e.preventDefault();var t=n.result(e.originalEvent.dataTransfer,"files");t&&this.trigger("media:addFiles",t)}},beforeTeardown:function(){this.photobooth&&(this.stopListening(this.photobooth),this.photobooth.remove()),delete this.photobooth,this.photoset&&(this.stopListening(this.photoset),this.photoset.remove()),delete this.photoset,this.overlayPopover&&(this.overlayPopover.remove(),this.stopListening(this.overlayPopover)),delete this.overlayPopover},afterRender:function(){this.js$("photobooth",!0),this.js$("photoset",!0),this._createPhotoset(),this.photobooth=!1,this.trigger("media:ready",this),this.renderSubViews()}});e.exports=g},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(204),a=i(205),l=n.template(""),c=s.extend({className:"media-container",template:l,mixins:[o,r,a],defaults:{canEditMedia:!0},defaultOptions:{},initialize:function(e){this.options=e=n.extend({},this.defaultOptions,e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,["post","user","uploads","dragEvents"])),n.isFunction(this.afterInitialize)&&this.afterInitialize.apply(this,arguments)},serialize:function(){return this.toJSON()},teardown:function(){return this.stopListening(),this},render:function(){return this.$el.html(this.template(this.serialize())),this.attachSubViews(),this}});e.exports=c},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(437),r=(i(439),i(438),i(441),i(442)),a=i(444),l=s.extend({name:"Photoset",initialize:function(e){(n.isArray(e)||e instanceof o)&&(e={photoset:e}),this.options=e=n.extend({},e),e.photoset instanceof o?this.model=e.photoset:this.model=new o(e.photoset);var t=n.keys(r.prototype.defaults);t.push("PhotoView"),t.push("post");var i=n.pick(e,t);i.photoset=this.model,this._PhotosetView=e.PhotosetView||r,this._PhotoView=e.PhotoView||a,this.indexView=new this._PhotosetView(i),this.listenTo(this.model,"all",this._relayModelEvent),this.listenTo(this.model.photos,"all",this._relayModelEvent)},_relayModelEvent:function(){this.trigger.apply(this,arguments)},teardown:function(){return this.indexView.teardown(),this.stopListening(),this},remove:function(){return this.teardown(),this.indexView.remove(),this},render:function(){return this.indexView.render(),this},getElement:function(){return this.indexView.$el}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(114),o=i(438),r=i(440),a=["","1","11","12","13","123","133","1232","1323","12223"],l=3,c=s.extend({defaults:{layout:null},initialize:function(e,t){t=n.extend({},t),this.layouts=t.layouts||a,this.maxPerRow=t.maxPerRow||l,(n.isArray(e)||e instanceof o)&&(this.attributes=n.extend({photos:e},this.defaults)),this.get("photos")instanceof o?this.photos=this.get("photos"):this.photos=new o(this.get("photos")),this.unset("photos"),this.fixLayout()},fixLayout:function(){var e=this.get("layout");return e=e?r.fix(e,this.photos.length,this.layouts,this.maxPerRow):r.calculateDefault(this.photos.length,this.layouts,this.maxPerRow),this.set("layout",e),e},getRows:function(e){return r.toArray(e||this.get("layout"),this.photos,this.layouts,this.maxPerRow)},getPhotoRow:function(e){var t={id:e};return n.findIndex(this.getRows(),function(e){return n.some(e,t)})},removePhoto:function(e){var t=this.getPhotoRow(e),i=this.photos.remove(e),s=n.reduce(this.get("layout").split(""),function(e,i,s){return i=n.parseInt(i),s===t&&i--,e+(i>0?i:"")},"");this.set("layout",s),i&&this.trigger("photo:remove",i,e,s)},toJSON:function(){var e=s.prototype.toJSON.apply(this,arguments);return e.photos=this.photos.toJSON(),e.rows=this.getRows(),e}}),u=["add","remove","reset","push","pop","unshift","shift","slice","where","findWhere","forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.forEach(u,function(e){var t=o.prototype[e];c.prototype[e]=function(){return t.apply(this.photos,n.toArray(arguments))}}),e.exports=c},function(e,t,i){"use strict";var n=i(3),s=i(119),o=i(439),r=s.extend({model:o,getSubset:function(e){return n.isUndefined(e)?[]:n.map(n.isArray(e)?e:n.toArray(arguments),this.get,this)},getSubCollection:function(e){return new r(this.getSubset.apply(this,arguments))},setIdOrder:function(e,t){t||(t={}),this.models=n.map(e,function(e){return this.get(e)},this),t.silent||this.trigger("sort",this,t)}});e.exports=r},function(e,t,i){"use strict";var n=i(114),s=i(440),o=n.extend({defaults:{width:null,height:null,x:"50%",y:"50%",url:"",caption:"",clickthroughUrl:""},getAspectRatio:function(){return s.aspectRatio(this.get("width"),this.get("height"))},getWidthForHeight:function(e){return s.widthForHeight(this.get("width"),this.get("height"),e)},getHeightForWidth:function(e){return s.heightForWidth(this.get("width"),this.get("height"),e)}});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(439),o={},r=function(e,t,i){return e<t.length?t[e]:n.trim(n.pad(e%i||" ",Math.floor(e/i)+1,i+"","right"))},a=function(e,t,i,s){var o=n.isNumber(t)?t:t.length;e?n.isString(e)||(e=e.toString()):e="";var a=o-n.reduce(e.split(""),function(e,t){return e+n.parseInt(t)},0);return a>0?e+=r(a,i,s):0>a&&(e=n(e.split("")).reverse().transform(function(e,t){a?(a+=n.parseInt(t),a>0&&(e.push(a),a=0)):e.push(t)},[]).reverse().value().join("")),e},l=function(e,t,i,s){var o=a(e,t,i,s).split(""),r=0;return n.map(o,function(e){e=n.parseInt(e);var i=n.map(t.slice(r,r+e),function(e){return n.isFunction(e.toJSON)?e.toJSON():e});return r+=e,i})},c=function(e,t){return e&&t?e/t:0},u=function(e,t,i){var n=t?i/t:0;return e*n},h=function(e,t,i){var n=e?i/e:0;return t*n},d=function(e,t){if(!e.length)return 0;var i=n.map(e,function(e){var i,n;return e instanceof s?(i=e.get("width"),n=e.get("height")):(i=e.width,n=e.height),h(i,n,t)});return n.min(i)},p=function(e,t,i){return i||(i=0),(i+t+i)/e-i-i};o.calculateDefault=r,o.fix=a,o.toArray=l,o.aspectRatio=c,o.widthForHeight=u,o.heightForWidth=h,o.rowHeightForWidth=d,o.rowImageWidth=p,e.exports=o},function(e,t,i){"use strict";var n={ImageLoader:i(186),ImageLayout:i(440)};e.exports=n},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(440),a=(i(103),i(204)),l=i(205),c=i(160),u=i(439),h=i(437),d=i(443),p=i(444),g=i(446),m=i(341).getImageType,f=function(e,t,i){n.isNumber(i)||(i=0);var s=0,o=e.length,a=t-2*i*(o-1),l=a/o,c=n.map(e,function(e,t){e instanceof u&&(e=e.toJSON());var i=t%2?Math.ceil(l):Math.floor(l);t>=o-1&&(i=a),a-=i;var n=Math.round(r.heightForWidth(e.width,e.height,i));return(!s||n&&s>n)&&(s=n),{width:i,height:n}});return{width:t,height:s,photos:c}},v=o.extend({className:"photoset",template:d,mixins:[a,l,c],defaults:{dynamic:!1,width:500,height:0,padding:5,minFullWidthSize:300},$$cacheKeys:{row:".photoset--row",cell:".photoset--cell"},$$rows:function(e){return this.$$(this.$$cacheKeys.row,e)},$$cells:function(e){return this.$$(this.$$cacheKeys.cell,e)},initialize:function(e){this.options=e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),this._PhotoView=e.PhotoView||p,this.photoset=e.photoset||new h},_updateRowCache:function(){return this._rowCache=n.map(this.photoset.getRows(),function(e){return n.pluck(e,"id")}),this._rowCache},_updateLayoutCache:function(){var e=this._updateRowCache(),t=this._layoutCache={rows:[],photos:{}},i=this.get("padding"),s=this.get("width"),o=0;return n.forEach(e,function(r,a){var l=this.photoset.photos.getSubset(r),c=a>0?i:0,u=a<e.length-1?i:0,h=this.rowSize(l,s,i),d=h.height+c+u;t.rows[a]={unpaddedHeight:h.height,paddingTop:c,paddingBottom:u,height:d,cells:[]},o+=d,n.forEach(l,function(e,n){var s=n<l.length-1?i:0,o=n>0?i:0,r=h.photos[n],c=e.get("id");t.photos[c]={scaledWidth:r.width,scaledHeight:r.height,displayWidth:r.width,displayHeight:h.height},t.rows[a].cells[n]={photo:c,unpaddedWidth:r.width,paddingLeft:o,paddingRight:s,width:r.width+o+s,height:d}},this)},this),t.width=s,t.height=o,this.set("height",o),t},rowSize:function(e,t,i){return e||(e=this.photoset.photos),n.isNumber(t)||(t=this.get("width")),n.isNumber(i)||(i=this.get("padding")),f(e,t,i)},createRowElement:function(){return s('<div class="photoset--row"></div>')},createCellElement:function(e){var t=s('<div class="photoset--cell"></div>');return null!=e&&g.set(t,"data-photo-id",e),t},createPhotoSubView:function(e){var t=new this._PhotoView({photoset:this.photoset,photos:this.photoset.photos,photo:e});return e.get("id")&&(this.subViews[e.get("id")]=t),t},createSubViews:function(){this.photoset.photos.forEach(this.createPhotoSubView,this)},createSinglePhotoLayout:function(){this._layoutCache||this._updateLayoutCache();var e=this.photoset.photos.at(0),t=e.get("width"),i=e.get("height"),n=m(e.get("url"))||"gif",s=this.getMinFullWidthSize(n);t>=s&&(i=Math.round(r.heightForWidth(t,i,this.get("width"))),t=this.get("width"));var o=e.get("id"),a=this.subViews[o];a.set({scaledWidth:t,scaledHeight:i,displayWidth:t,displayHeight:i});var l=this.js$("layout"),c=this.createRowElement().height(i),u=this.createCellElement(o);u.css({width:t,height:i,padding:0}).addClass("photoset--single-cell"),s>t&&u.addClass("photoset--single-cell-margin"),u.append(a.$el),c.append(u),l.append(c),this.renumberRowsAndCells()},createPhotosetLayout:function(){var e=this._layoutCache||this._updateLayoutCache();n.forEach(e.rows,function(t,i){var s=this.createRowElement();s.height(t.height),n.forEach(t.cells,function(i,o){var r=i.photo,a=e.photos[r],l=this.subViews[r];l.set(a);var c=this.createCellElement(r);c.css({width:i.width,height:i.height,padding:n.map([t.paddingTop,i.paddingRight,t.paddingBottom,i.paddingLeft],function(e){return e?e+"px":0}).join(" ")}),c.append(l.$el),s.append(c)},this),this.js$("layout").append(s)},this),this.renumberRowsAndCells()},renumberRowsAndCells:function(){n.forEach(this.$$rows(!0),function(e,t){g.set(e,"data-photoset-row",t)},this),n.forEach(this.$$cells(!0),function(e,t){g.set(e,"data-photoset-position",t)},this)},getMinFullWidthSize:function(e){var t=this.get("minFullWidthSize");return n.isNumber(t)?t:n.has(t,e)?t[e]:300},serialize:function(){return n.extend(this.toJSON(),{_rowSize:n.bind(this.rowSize,this),photoTemplate:p.prototype.template,photoset:this.photoset.toJSON()})},afterTeardown:function(){return this.stopListening(),delete this._rowCache,delete this._layoutCache,this.teardownSubViews()},render:function(){return this.get("dynamic")?(this.$el.html('<div class="photoset--layout" data-js-layout></div>'),this.createSubViews(),1===this.photoset.photos.length?this.createSinglePhotoLayout():this.createPhotosetLayout()):this.$el.html(this.template(this.serialize())),this}});e.exports=v},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{}){__p+="";var rows=photoset.rows,cellId=0;__p+=' <div data-js-layout class="photoset--layout"> ',_.forEach(rows,function(e,t){__p+=" ";var i=t>0?padding:0,n=t<rows.length-1?padding:0,s=_rowSize(e,width,padding),o=s.height;__p+=' <div data-photoset-row="'+(null==(__t=t)?"":_.escape(__t))+'" style="height:'+(null==(__t=o+i+n)?"":_.escape(__t))+'px" class="photoset--row"> ',_.forEach(e,function(t,r){__p+=" ";var a=s.photos[r],l=a.width,c=a.height,u=o,h=r<e.length-1?padding:0,d=r>0?padding:0,p=l+d+h,g=_.map([i,h,n,d],function(e){return e?e+"px":0}).join(" ");__p+=' <div data-photoset-position="'+(null==(__t=cellId)?"":_.escape(__t))+'" data-photo-id="'+(null==(__t=t.id)?"":_.escape(__t))+'" style="width:'+(null==(__t=p)?"":_.escape(__t))+"px;height:"+(null==(__t=o)?"":_.escape(__t))+"px;padding:"+(null==(__t=g)?"":_.escape(__t))+'" class="photoset--cell"> '+(null==(__t=photoTemplate(_.defaults({scaledWidth:l,scaledHeight:c,displayWidth:a.width,displayHeight:u},t)))?"":__t)+" </div> ",cellId++,__p+=" "}),__p+=" </div> "}),__p+=" </div>"}return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(121),o=i(165).animate,r=i(149),a=150,l=i(204),c=i(205),u=i(160),h=i(439),d=i(445),p=r.extend({className:"photoset--photo",template:d,mixins:[l,c,u],defaults:{scaledWidth:null,scaledHeight:null,displayWidth:null,displayHeight:null},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),this.photo=e.photo||new h,this.photos=e.photos,this.photoset=e.photoset,this.$el.attr("data-photo-id",this.photo.get("id")),this.listenTo(this.photo,"change:id",function(e,t){this.$el.attr("data-photo-id",t)})},thumbnailDimensions:function(e,t){var i=this.photo.getHeightForWidth(100);return t&&i>t&&(i=t,e=this.photo.getWidthForHeight(100)),{width:Math.ceil(e),height:Math.ceil(i)}},resize:function(e){e||(e=a);var t=this.get("displayWidth")||0,i=this.get("displayHeight")||0,n=this.get("scaledWidth")||0,r=this.get("scaledHeight")||0;return o(this.js$("crop"),"stop"),o(this.js$("positioner"),"stop"),o(this.js$("image"),"stop"),s.join(o(this.js$("crop"),{width:t,height:i},{duration:e}),o(this.js$("positioner"),{width:Math.max(0,n-t),height:Math.max(0,r-i)},{duration:e}),o(this.js$("image"),{width:n,height:r},{duration:e}))},serialize:function(){return n.defaults(this.toJSON(),this.photo.toJSON())},beforeTeardown:function(){return this.stopListening(),this},render:function(){var e=this.serialize();return this.$el.html(this.template(e)),this.attachSubViews(),this}});e.exports=p},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div data-js-imagecrop style="width:'+(null==(__t=displayWidth)?"":_.escape(__t))+"px;height:"+(null==(__t=displayHeight)?"":_.escape(__t))+'px" class="photoset--image-crop"><div data-js-imagewrap style="background-image:url('+(null==(__t=url)?"":_.escape(__t))+");background-position:"+(null==(__t=x)?"":_.escape(__t))+" "+(null==(__t=y)?"":_.escape(__t))+'" class="photoset--image-wrap"><img data-js-image src="'+(null==(__t=url)?"":_.escape(__t))+'" alt="'+(null==(__t=caption)?"":_.escape(__t))+'" data-width="'+(null==(__t=width)?"":_.escape(__t))+'" data-height="'+(null==(__t=height)?"":_.escape(__t))+'" class="photoset--image"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o={},r=function(e,t,i){var o=e instanceof s?e:s(e),r=t;n.isObject(t)||(r={},r[t]=i),o.attr(r);var a=n.transform(r,function(e,t,i){i.match(/^data\-/i)&&(e[n.camelCase(i.replace(/^data\-/,""))]=t)},{});return o.data(a),o},a=function(e,t){var i=e instanceof s?e:s(e);return n.isString(t)&&(t=n.rest(arguments)),n.forEach(t,function(e){i.removeAttr(e),e.match(/^data\-/i)&&i.removeData(n.camelCase(e.replace(/^data\-/,"")))}),i};o.set=r,o.remove=a,e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(121),r=i(165).animate,a=i(110),l=i(442),c=150,u=s(window),h=i(446),d=i(448),p=0,g=1,m=2,f=l.extend({className:"editable-photoset photoset",defaults:n.extend({x:null,y:null,dragId:null,sourceCell:null,targetCell:null,dragOverCell:null,isLocked:!1,isDragging:!1,dragScrollVelocityY:0,dragScrollUpdateMs:50,dragScrollHeight:100,dragSlide:20,ghostWidth:100,ghostMaxHeight:120},l.prototype.defaults),events:n.defaults({'mousedown [data-js-sortable][draggable="true"]':"_onMouseDownSortable","dragstart .photoset--photo-dragger":"_onDragStart"},l.prototype.events),initialize:function(){l.prototype.initialize.apply(this,arguments),this.__updateCursorPosition=n.throttle(n.bind(function(e){this.set(d(e))},this)),n.forEach(["_onDragStart","_onDragEnter","_onDragOver","_onDragLeave","_onDragEnd","_onDrop"],function(e){var t=this[e]||n.noop;this["_"+e]=n.bind(t,this)},this)},_onMouseDownSortable:function(e){if(this.get("isLocked"))return e.preventDefault(),void e.stopPropagation();if(1===e.which&&!e.ctrlKey){if(this.get("isDragging"))return this._onDragEnd(e);if(this.trigger("photoset:predrag",this),!window.DataTransfer||!n.isFunction(window.DataTransfer.prototype.setDragImage)){var t=s(e.target),i=t.closest(".photoset--photo"),o=this.photoset.photos.get(i.data("photoId")),r=o?o.get("url")||"":"";r&&(t.css({backgroundColor:"#ffffff",backgroundImage:"url("+r+")"}),t.one("mouseout mouseup",n.bind(function(){t.css({backgroundColor:"",backgroundImage:""})},this)))}}},_onDragStart:function(e){if(this.get("isLocked"))return e.preventDefault(),void e.stopPropagation();a.trigger("photoset:dragstart");var t=s(e.target),i=t.closest(".photoset--photo"),o=i.data("photoId"),r=e.originalEvent.dataTransfer;if(r){r.effectAllowed="move",r.dropEffect="move";var l=this.$('[data-ghost-id="'+o+'"]');!n.isEmpty(l)&&n.isFunction(r.setDragImage)&&r.setDragImage(l.get(0),.5*l.outerWidth(),.5*l.outerHeight());try{var c=this.photoset.photos.get(o),h=c?c.get("url")||"":"";r.setData("text/uri-list",h),r.setData("text/plain",h)}catch(e){}}var d=i.closest(this.$$cacheKeys.cell),p=d.closest(this.$$cacheKeys.row);this.set({sourceCell:null,targetCell:null,dragOverCell:null,dragId:o}),this.listenTo(this,"change:targetCell",this._onChangeTargetCell),this.$el.on("dragover .photoset--cell",this.__onDragOver),this.$el.on("dragend",this.__onDragEnd),this.$el.on("drop .photoset--cell",this.__onDrop),u.on("dragover",this.__updateCursorPosition),this.startDragScroll(),n.defer(n.bind(function(){var e=this.$$cacheKeys.cell;this.set("isDragging",!0),d.addClass("photoset--placeholder-cell photoset--source-cell"),p.addClass("photoset--source-row"),n.isEmpty(d.siblings(e))&&d.closest(this.$$cacheKeys.row).addClass("photoset--placeholder-row"),t.css({backgroundColor:"",backgroundImage:""}),this.createPlaceholders(),this.set({sourceCell:d.data("placeholderCell"),targetCell:d.data("placeholderCell"),dragOverCell:d.data("dragOverCell")}),this.listenTo(this,"change:dragOverCell change:x change:y",this._onChangeDragTarget)},this))},_onDragOver:function(e){e.preventDefault(),e.stopPropagation(),this.__updateCursorPosition(e);var t=s(e.target),i=t.closest(this.$$cacheKeys.cell);this.set("dragOverCell",i.data("dragOverCell"))},_onDragEnd:function(e){e.preventDefault(),e.stopPropagation(),this.stopListening(this,"change:targetCell",this._onChangeTargetCell),this.stopListening(this,"change:dragOverCell change:x change:y",this._onChangeDragTarget);var t=this.get("dragId");if(null!=t){var i=this.placePhotoInCell(t,this.get("targetCell"));this.set({sourceCell:null,targetCell:null,dragId:null}),i.removeClass("photoset--placeholder-cell"),i.closest(this.$$cacheKeys.row).removeClass("photoset--placeholder-row")}this.removePlaceholders(),this.set("isDragging",!1);var s=this.determineLayout();this.photoset.photos.setIdOrder(s.order),this.photoset.set("layout",s.layout),this.set("isLocked",!0),this.resize().then(n.bind(function(){this.removeTemporary(),this.set("isLocked",!1)},this)),this._ensurePhotoInViewport(t),this.$el.off("dragover .photoset--cell",this.__onDragOver),this.$el.off("dragend",this.__onDragEnd),this.$el.off("drop .photoset--cell",this.__onDrop),u.off("dragover",this.__updateCursorPosition),this.stopDragScroll(),a.trigger("photoset:dragend")},_onDrop:function(e){e.preventDefault(),e.stopPropagation()},_onChangeIsDragging:function(e,t){this.$el.toggleClass("photoset--drag-to-sort",t)},_onChangeIsLocked:function(e,t){this.$el.toggleClass("photoset--locked",t),t||this.$(".photoset--cropped-cell").removeClass("photoset--cropped-cell")},_onUpdate:function(e,t){this.teardown().render(),this.photoset.photos.length>1&&this._ensurePhotoInViewport(this.photoset.photos.last().get("id"))},startDragScroll:function(){this.set({dragScrollTop:this.get("dragScrollHeight"),dragScrollBottom:u.height()-this.get("dragScrollHeight")}),this.listenTo(this,"change:y",this._onChangeDragY)},stopDragScroll:function(){clearInterval(this.dragScrollInterval),delete this.dragScrollInterval,this.stopListening(this,"change:y",this._onChangeDragY)},_onChangeDragY:function(e,t){var i=0,s=t-u.scrollTop();i=s<this.get("dragScrollTop")?Math.ceil(100*(s-this.get("dragScrollTop"))/this.get("dragScrollHeight")):s>this.get("dragScrollBottom")?Math.ceil(100*(s-this.get("dragScrollBottom"))/this.get("dragScrollHeight")):0,this.set("dragScrollVelocityY",i),i?this.dragScrollInterval||(this.dragScrollInterval=setInterval(n.bind(function(){var e=this.get("dragScrollVelocityY");e&&a.trigger("Photoset:dragScroll",e)},this),this.get("dragScrollUpdateMs"))):this.dragScrollInterval&&(clearInterval(this.dragScrollInterval),delete this.dragScrollInterval)},_ensurePhotoInViewport:function(e,t){n.isNumber(t)||(t=c);var i=this._layoutCache||this._updateLayoutCache(),s=this.$el.offset().top||0,o=n.find(i.rows,function(t){return n.find(t.cells,{photo:e})?!0:void(s+=t.height)});o&&a.trigger("Photoset:scrollToRow",s,o.height,t)},createPhotoSubView:function(e){var t=l.prototype.createPhotoSubView.apply(this,arguments);return this.options.post&&(t.post=this.options.post),this.listenTo(t,"photoset:hover",function(){var e=n.toArray(arguments);e.unshift("photoset:unhover"),n(this.subViews).omit(t.photo.get("id")).invoke(function(){this.trigger.apply(this,e)}).value()}),t},createPlaceholders:function(){var e=this.photoset.maxPerRow,t=".photoset--placeholder-row",i=".photoset--placeholder-cell",o=".photoset--source-row",r=".photoset--source-cell",a=this.$$cacheKeys.cell,l='<div class="photoset--row photoset--placeholder-row"></div>',c='<div class="photoset--cell photoset--placeholder-cell"></div>';this._createPlaceholders(this.js$("layout"),this.$$rows(),l,t),n.forEach(this.$$rows(!0),function(t,n){var r=s(t),a=r.children(this.$$cacheKeys.cell);(a.length<e||r.is(o))&&this._createPlaceholders(r,a,c,i)},this),n.forEach(this.$$cells(!0).filter(i),function(e,t){h.set(e,"data-placeholder-cell",t)},this);var u=this.determineLayout(),d=this.get("padding"),p=0;n.forEach(this.$$rows(!0),function(e,l){var c=s(e),g=c.index(),m=this.get("width"),f=g<=u.topRow||g>u.bottomRow?0:d,v=g>=u.bottomRow||g<u.topRow?0:d,_=c.height()||0;c.height(_);var b=c.children(a),w=c.prev(t).not(o).find(a),y=c.next(t).not(o).find(a),k=w.data("placeholderCell"),x=y.data("placeholderCell");n.forEach(b,function(e,n){var o=s(e);o.is(i)&&!o.is(r)&&o.css({paddingTop:f,paddingBottom:v,width:c.is(t)?m:0,height:_});var a={top:k,left:o.prev(i).data("placeholderCell"),center:o.data("placeholderCell"),right:o.next(i).data("placeholderCell"),bottom:x};o.data("targetCells",a),h.set(o,"data-drag-over-cell",p++)},!0)},this)},_createPlaceholders:function(e,t,i,o){t.first().is(o)||e.prepend(i),n.forEach(t.not(o),function(e,t){var r=s(e);n.isEmpty(r.next(o))&&r.after(i)},this)},removePlaceholders:function(){this.$$rows(!0).removeClass("photoset--source-row"),this.$$cells(!0).removeClass("photoset--source-cell").removeData("targetCells"),this.$$rows().filter(".photoset--placeholder-row").remove(),this.$$cells().filter(".photoset--placeholder-cell").remove(),this.renumberRowsAndCells(),h.remove(this.$$cells(),"data-drag-over-cell","data-placeholder-cell")},removeTemporary:function(){this.$(".photoset--temporary").remove(),this.$$rows(!0),this.$$cells(!0),this.renumberRowsAndCells()},resize:function(e){n.isNumber(e)||(e=c);var t=n.map(this.$$rows(),function(t,i){return this.resizeRow(t,e,i)},this);return this._updateLayoutCache(),o.all(t)},_calculateCellSize:function(e){var t=s(e),i=t.find(".photoset--photo [data-js-imageCrop]"),o={width:0,height:0,$content:i,$el:t},r=this.photoset.photos.get(t.data("photoId"));return r&&n.extend(o,{isCurrentCell:!0,width:r.get("width"),height:r.get("height")}),o},resizeRow:function(e,t,i){n.isNumber(t)||(t=c);var a=e instanceof s?e:s(e),l=this.determineLayout();n.isNumber(i)||(i=a.index());var u=this.get("width"),h=this.get("padding"),d=i<=l.topRow||i>l.bottomRow?0:h,p=i>=l.bottomRow||i<l.topRow?0:h,g=this.$$cacheKeys.cell,m=n.map(a.children(g),this._calculateCellSize,this),f=[],v=0;n.forEach(m,function(e,t){e.index=t,e.isCurrentCell&&(e.position=v++,e.id=f.length,f.push(e))});var _=this.rowSize(f,u),b=_.height,w=b?b+d+p:0,y=n.map(m,function(e,i){var s={width:e.width,height:b,paddingTop:d,paddingRight:0,paddingBottom:p,paddingLeft:0};null!=e.id&&(s.width=_.photos[e.id].width),null!=e.position&&(s.paddingRight=e.position<v-1?h:0,s.paddingLeft=e.position>0?h:0),n.isEmpty(e.$content)||(r(e.$content,"stop"),r(e.$content,{opacity:1,width:s.width,height:s.height,translateX:0,translateY:0},{duration:t}));var o=this.subViews[e.$el.data("photoId")];return o&&o.set({displayWidth:s.width,displayHeight:s.height}),r(e.$el,"stop"),r(e.$el,n.defaults({width:s.width+s.paddingLeft+s.paddingRight,height:s.height+s.paddingTop+s.paddingBottom},s),{duration:t})},this);r(a,"stop"),y.push(r(a,{height:w},{duration:t})),this.get("isDragging")&&(this._rowHeightCache[a.data("photosetRow")]=w);var k=o.all(y);return k},determineLayout:function(e){if(e&&this._determineLayout)return this._determineLayout;var t="",i=[],o=-1,r=-1,a=this.$$cacheKeys.cell;return n.forEach(this.$$rows(),function(e,l){var c=0;n.forEach(s(e).children(a),function(e){var t=s(e).data("photoId");(t||0===t)&&(i.push(t),c++)},this),c&&(t+=c,0>o&&(o=l),r=l)},this),this._determineLayout={topRow:o,bottomRow:r,order:i,layout:t},this._determineLayout},_onChangeTargetCell:function(e,t){if(null!=t){var i=this.$$cells().filter('[data-placeholder-cell="'+t+'"]'),o=i.closest(this.$$cacheKeys.row),a=i.data("dragOverCell"),l=p;l=i.is(".photoset--source-cell")?p:o.is(".photoset--placeholder-row")?g:m,n.forEach(this.$$cells(),function(e,t){var i=s(e),u=i.find(".photoset--image-crop");if(!n.isEmpty(u)){var h={translateX:0,translateY:0};switch(l){case g:n.isEmpty(o.find(i))&&(i.data("dragOverCell")<a?h.translateY=-this.get("dragSlide"):i.data("dragOverCell")>a&&(h.translateY=this.get("dragSlide")));break;case m:n.isEmpty(o.find(i))||(i.data("dragOverCell")<a?h.translateX=-this.get("dragSlide"):i.data("dragOverCell")>a&&(h.translateX=this.get("dragSlide")))}r(u,"stop"),r(u,h,c)}},this)}else n.forEach(this.$$cells(),function(e){var t=s(e).find(".photoset--image-crop");n.isEmpty(t)||(r(t,"stop"),r(t,{translateX:0,translateY:0},c))},this)},_onChangeDragTarget:function(){var e=this.get("dragOverCell");if(null!=e){var t=this.$$cells().filter('[data-drag-over-cell="'+e+'"]'),i=t.offset(),n=t.width(),s=t.height(),o=this.get("x")-(i.left+.5*n),r=this.get("y")-(i.top+.5*s),a=t.data("targetCells");null!=a.top&&-s/3>r?this.set("targetCell",a.top):null!=a.bottom&&r>s/3?this.set("targetCell",a.bottom):null!=a.center?null!=a.left&&-n/3>o?this.set("targetCell",a.left):null!=a.right&&o>n/3?this.set("targetCell",a.right):this.set("targetCell",a.center):null!=a.left&&0>o?this.set("targetCell",a.left):null!=a.right&&o>0&&this.set("targetCell",a.right)}},placePhotoInCell:function(e,t){var i=this.subViews[e],n=i.$el.closest(this.$$cacheKeys.cell),s=n.closest(this.$$cacheKeys.row),o=this.$$cells().filter('[data-placeholder-cell="'+t+'"]');return h.set(o,"data-photo-id",e),o.is(n)||(n.removeClass("photoset--placeholder-cell").addClass("photoset--temporary"),h.remove(n,"data-photo-id"),s.is(".photoset--placeholder-row")&&s.removeClass("photoset--placeholder-row").addClass("photoset--temporary"),i.js$("imageCrop").css({opacity:0,width:o.width(),height:o.height()}),i.$el.detach(),o.append(i.$el),o.addClass("photoset--cropped-cell")),o},beforeRender:function(){this.listenTo(this,"update",this._onUpdate),this.listenTo(this,"change:isDragging",this._onChangeIsDragging),this.listenTo(this,"change:isLocked",this._onChangeIsLocked)},afterRender:function(){this.renderSubViews(),this.$el.prepend('<div data-js-ghosts class="photoset--ghosts"></div>'),n.forEach(this.subViews,function(e,t){var i=e.thumbnailDimensions(this.get("ghostWidth"),this.get("ghostMaxHeight"));i["background-image"]="url("+e.photo.get("url")+")";var n=s('<div data-js-ghost class="photoset--ghost"></div>').css(i);h.set(n,"data-ghost-id",t),this.js$("ghosts").append(n)},this),this.js$("ghosts").append('<div class="photoset--ghost-cover"></div>').css({width:this.get("ghostWidth"),height:this.get("ghostMaxHeight")})}});e.exports=f},function(e,t,i){"use strict";var n=i(3),s=function(e,t){t||(t=e.originalEvent),n.extend(e,n.pick(t,"pageX","pageY"));var i,s,o;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||document,s=i.documentElement,o=i.body,e.pageX=t.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),{x:e.pageX,y:e.pageY}};e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(450),r=i(457),a=s.extend({name:"Webcam",initialize:function(e){this.options=e=n.extend({},e),this.indexView=new o(e),this.listenTo(this.indexView,"all",this._relayViewEvent);var t=["teardown","render","remove"].concat(a.prototype.commands||[]);n.forEach(t,function(e){var t=this.indexView;this[e]=function(){return t[e].apply(t,arguments),this}},this)},_relayViewEvent:function(){this.trigger.apply(this,arguments)},getElement:function(){return this.indexView.$el},getHeightForWidth:function(e){return this.indexView.get("width")?e*this.indexView.get("height")/this.indexView.get("width"):0}},{hasUserMediaSupport:function(){
return!!r}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(121),r=i(165).animate,a=i(106),l=i(149),c=i(451),u=i(186),h=i(187),d=i(189),p=i(160),g=i(204),m=i(205),f=i(454),v=i(455),_=i(459),b=250,w=300,y=s(document),k="",x=l.extend({className:"webcam",template:f,mixins:[p,g,m],defaults:{watermarkUrl:"",width:540,height:405,retina:!0,mirrored:!0,enabled:!0,needsPermission:!0,showControls:!1,flash:!0,showPreviewContainer:!1,defaultTimer:3e3,timePerFrame:1e3,gifFrameCount:4,gifSpeed:200,enableFlash:!0,enableGifMode:!0,enableRemove:!0},commands:["toggleFlash","toggleMirrored","snap","gif","flash","gifStart","gifSnap","gifComplete","retake","close"],initialize:function(e){this.options=e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),k=a.get("Context/hosts/assets_host"),this._WebcamControlsView=e.WebcamControlsView||_},_onChangeEnabled:function(e,t){t?this.videoStream.startStream():this.videoStream.stopStream()},_onChangeNeedsPermission:function(e,t){var i=200;t||clearTimeout(this._delayedPermissionCheck),r(this.$arrow,"stop"),r(this.$arrow,{opacity:t?1:0},{display:t?"block":"none",duration:i})},_onChangeWatermarkUrl:function(e,t){if(this.js$("watermarkContainer").empty(),this.$watermark=!1,t){if(!n.startsWith(t,"data:image/png;base64")&&(t.match(/^\w*:\/\//i)||!n.startsWith(t,"/")))throw new Error("Webcam watermark must be an absolute path or base64-encoded image.");n.startsWith(t,"/")&&(t=k+t),this.$watermark=s("<img/>",{alt:"",src:t}),this.js$("watermarkContainer").append(this.$watermark)}},_onChangeShowControls:function(e,t){var i=200;r(this.js$("controlContainer"),"stop"),r(this.js$("controlContainer"),{opacity:t?1:0},{display:t?"block":"none",duration:i})},_onChangeShowPreviewContainer:function(e,t){t?this.js$("previewContainer").css("display","block"):(this.js$("previewContainer").children("img").remove(),this.js$("previewContainer").css("display","none"))},startStream:function(){this.set("enabled",!0)},stopStream:function(){this.set("enabled",!1)},snap:function(e,t){this._snapFrame(e,t).then(n.bind(function(e){this.set("showPreviewContainer",!0),this.trigger("webcam:image",e),this.webcamControls.trigger("webcam:snapped")},this))},gif:function(e,t,i,s){n.isNumber(e)||(e=this.get("gifFrameCount")),n.isNumber(t)||(t=this.get("timePerFrame")),!n.isUndefined(i)||(i=this.get("flash")),!n.isUndefined(s)||(s=!!this.get("watermarkUrl")),this.gifStart();var o=0;clearInterval(this._gifInterval),this._gifInterval=setInterval(n.bind(function(){o++,this.gifSnap(o>=e),s&&clearInterval(this._gifInterval)},this),t)},gifStart:function(){this._frameBuffer=[]},gifSnap:function(e,t,i){this._snapFrame(t,i).then(n.bind(function(t){var i=this.js$("canvas"),n=i.get(0),s=document.createElement("canvas");s.width=.5*(n.width||i.width()),s.height=.5*(n.height||i.height()),d.drawElToCanvas(this.js$("canvas"),s),this._frameBuffer.push(s),e&&this.gifComplete()},this))},gifComplete:function(e){n.isNumber(e)||(e=this.get("gifSpeed"));var t=new c({workers:3,quality:1});n.forEach(this._frameBuffer,function(i){t.addFrame(i,{delay:e})},this),t.on("finished",n.bind(function(e){h.read(e).then(n.bind(function(e){u.load(e.base64).then(n.bind(function(e){var t=s('<img data-js-gif class="webcam--preview-image"/>');t.attr("src",e.src),this.js$("previewContainer").append(t),n.extend(e,{base64:e.src,isGif:!0}),this.trigger("webcam:image",e),this.webcamControls.showSnapButtonGroup("retakeButton"),this.set("showPreviewContainer",!0)},this))},this))},this)),t.render(),delete this._frameBuffer},retake:function(){this.set("showPreviewContainer",!1),this.trigger("webcam:reset")},close:function(){this.trigger("webcam:close")},_snapFrame:function(e,t){!n.isUndefined(e)||(e=this.get("flash")),!n.isUndefined(t)||(t=!!this.get("watermarkUrl"));var i=n.bind(this.flash,this),s=n.bind(this.grabVideoFrame,this,t);return o.promise(function(t,o){e?(i(),n.delay(function(){t(s())},.5*w)):t(s())})},drawWatermark:function(){var e=this.$watermark;if(e.get(0)){var t=this.js$("canvas").get(0),i=t.getContext("2d"),n=e.offset(),s=this.$el.offset();i.drawImage(e.get(0),2*(n.left-s.left),2*(n.top-s.top),e.width(),e.height())}},grabVideoFrame:function(e){d.drawElToCanvas(this.videoStream.video,this.js$("canvas"),this.get("mirrored")),e&&this.drawWatermark();var t=this.js$("canvas").get(0);return t?{width:t.width,height:t.height,base64:t.toDataURL("image/jpeg")}:{width:0,height:0,base64:null}},toggleFlash:function(e){!n.isUndefined(e)||(e=!this.get("flash")),this.set("flash",e)},toggleMirrored:function(e){!n.isUndefined(e)||(e=!this.get("mirrored")),this.set("mirrored",e)},flash:function(){return r(this.$flash,"stop"),this.$flash.css({display:"block",opacity:1}),r(this.$flash,{opacity:[0,1]},{display:"block",delay:w,duration:b}).then(n.bind(function(){this.$flash.css("display","none")},this))},_checkVideoStreamPermissions:function(){this._delayedPermissionCheck=n.delay(n.bind(function(){this.get("needsPermission")&&this._onChangeNeedsPermission(this,!0)},this),1e3),this.get("needsPermission")?(this.js$("controlContainer").css({display:"none",opacity:0}),this.listenToOnce(this.videoStream,"change:needsPermission",function(e,t){this.set("needsPermission",t)}),this.listenToOnce(this.videoStream,"change:running",function(e,t){clearTimeout(this._delayedPermissionCheck),t&&(this.set("needsPermission",!1),this.set("showControls",!0))})):this.set("showControls",!0)},serialize:function(){var e=this.toJSON();return e.ratio=(e.width?e.height/e.width*100:0)+"%",e.loading=this.videoStream?!this.videoStream.get("running"):!1,e},teardown:function(){return clearInterval(this._gifInterval),clearTimeout(this._delayedPermissionCheck),y.off("keydown.webcam keyup.webcam"),this.stopListening(),this.$flash&&this.$flash.remove(),delete this.$flash,this.$arrow&&this.$arrow.remove(),delete this.$arrow,this},remove:function(){return this.teardown(),l.prototype.remove.apply(this,arguments)},beforeRender:function(){var e=n.pick(this.attributes,n.keys(v.prototype.defaults)),t=n.pick(this.attributes,n.keys(this._WebcamControlsView.prototype.defaults));this.videoStream=this.subViews.videoStream=new v(e),this.webcamControls=this.subViews.webcamControls=new this._WebcamControlsView(t),this.$flash=s('<div class="webcam--flash"></div>').appendTo("body"),this.$arrow=s('<div class="webcam--permission-arrow"></div>').appendTo("body"),s.browser.mozilla&&this.$arrow.addClass("firefox"),this.set("needsPermission",!this.videoStream.get("running")),this.listenTo(this,"change:enabled",this._onChangeEnabled),this.listenTo(this,"change:needsPermission",this._onChangeNeedsPermission),this.listenTo(this,"change:watermarkUrl",this._onChangeWatermarkUrl),this.listenTo(this,"change:showControls",this._onChangeShowControls),this.listenTo(this,"change:showPreviewContainer",this._onChangeShowPreviewContainer),this.listenTo(this.videoStream,"change:running",function(e,t){this.js$("watermarkContainer").toggleClass("webcam-watermark--hidden",!t)}),this.listenTo(this.videoStream,"error",function(e){this.trigger("webcam:error",e),this.close()}),this.listenTo(this,"change:flash",function(e,t){this.webcamControls.set("flash",t)}),this.listenTo(this,"change:mirrored",function(e,t){this.videoStream.set("mirrored",t),this.webcamControls.set("mirrored",t)}),this.listenTo(this.webcamControls,"webcam",function(e){if(n.contains(this.commands,e)){var t=this[e];n.isFunction(t)&&t.apply(this,n.rest(arguments))}}),y.on("keydown.webcam keyup.webcam",n.bind(function(e){switch(e.which||e.keyCode){case 16:this.set("flash","keyup"===e.type);break;case 18:"keydown"===e.type&&e.metaKey&&this.toggle("mirrored");break;case 91:case 92:case 93:"keydown"===e.type&&e.altKey&&this.toggle("mirrored")}},this))},render:function(){return this.$el.html(this.template(this.serialize())),this.attachSubViews(),this._checkVideoStreamPermissions(),this.get("enabled")&&this.videoStream.startStream(),this.get("watermarkUrl")&&this._onChangeWatermarkUrl(this,this.get("watermarkUrl")),this}});e.exports=x},function(e,t,i){"use strict";var n=i(452).GIF,s=i(453),o=function(e){var t=s;return e||(e={}),e.workerScript||(e.workerScript=t),new n(e)};e.exports=o},function(e,t){(function(e){function t(e,i){if({}.hasOwnProperty.call(t.cache,e))return t.cache[e];var n=t.resolve(e);if(!n)throw new Error("Failed to resolve module "+e);var s={id:e,require:t,filename:e,exports:{},loaded:!1,parent:i,children:[]};i&&i.children.push(s);var o=e.slice(0,e.lastIndexOf("/")+1);return t.cache[e]=s.exports,n.call(s.exports,s,s.exports,o,e),s.loaded=!0,t.cache[e]=s.exports}t.modules={},t.cache={},t.resolve=function(e){return{}.hasOwnProperty.call(t.modules,e)?t.modules[e]:void 0},t.define=function(e,i){t.modules[e]=i};var i=function(t){return t="/",{title:"browser",version:"v0.10.26",browser:!0,env:{},argv:[],nextTick:e.setImmediate||function(e){setTimeout(e,0)},cwd:function(){return t},chdir:function(e){t=e}}}();t.define("/gif.coffee",function(e,i,n,s){function o(e,t){return{}.hasOwnProperty.call(e,t)}function r(e,t){for(var i=0,n=t.length;n>i;++i)if(i in t&&t[i]===e)return!0;return!1}function a(e,t){function i(){this.constructor=e}for(var n in t)o(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e}var l,c,u,h,d;u=t("events",e).EventEmitter,l=t("/browser.coffee",e),d=function(e){function t(e){var t,i;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(e);for(t in c)i=c[t],null!=this.options[t]?this.options[t]:this.options[t]=i}return a(t,e),c={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null},h={delay:500,copy:!1},t.prototype.setOption=function(e,t){return this.options[e]=t,null==this._canvas||"width"!==e&&"height"!==e?void 0:this._canvas[e]=t},t.prototype.setOptions=function(e){var t,i;return function(n){for(t in e)o(e,t)&&(i=e[t],n.push(this.setOption(t,i)));return n}.call(this,[])},t.prototype.addFrame=function(e,t){var i,n;null==t&&(t={}),i={},i.transparent=this.options.transparent;for(n in h)i[n]=t[n]||h[n];if(null!=this.options.width||this.setOption("width",e.width),null!=this.options.height||this.setOption("height",e.height),"undefined"!=typeof ImageData&&null!=ImageData&&e instanceof ImageData)i.data=e.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!=CanvasRenderingContext2D&&e instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!=WebGLRenderingContext&&e instanceof WebGLRenderingContext)t.copy?i.data=this.getContextData(e):i.context=e;else{if(null==e.childNodes)throw new Error("Invalid image");t.copy?i.data=this.getImageData(e):i.image=e}return this.frames.push(i)},t.prototype.render=function(){var e,t;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(t){for(var i=function(){var e;e=[];for(var t=0;0<=this.frames.length?t<this.frames.length:t>this.frames.length;0<=this.frames.length?++t:--t)e.push(t);return e}.apply(this,arguments),n=0,s=i.length;s>n;++n)e=i[n],t.push(null);return t}.call(this,[]),t=this.spawnWorkers();for(var i=function(){var e;e=[];for(var i=0;t>=0?t>i:i>t;t>=0?++i:--i)e.push(i);return e}.apply(this,arguments),n=0,s=i.length;s>n;++n)e=i[n],this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},t.prototype.abort=function(){for(var e;;){if(e=this.activeWorkers.shift(),!(null!=e))break;console.log("killing active worker"),e.terminate()}return this.running=!1,this.emit("abort")},t.prototype.spawnWorkers=function(){var e;return e=Math.min(this.options.workers,this.frames.length),function(){var t;t=[];for(var i=this.freeWorkers.length;this.freeWorkers.length<=e?e>i:i>e;this.freeWorkers.length<=e?++i:--i)t.push(i);return t}.apply(this,arguments).forEach(function(e){return function(t){var i;return console.log("spawning worker "+t),i=new Worker(e.options.workerScript),i.onmessage=function(e){return function(t){return e.activeWorkers.splice(e.activeWorkers.indexOf(i),1),e.freeWorkers.push(i),e.frameFinished(t.data)}}(e),e.freeWorkers.push(i)}}(this)),e},t.prototype.frameFinished=function(e){return console.log("frame "+e.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[e.index]=e,r(null,this.imageParts)?this.renderNextFrame():this.finishRendering()},t.prototype.finishRendering=function(){var e,t,i,n,s,o,r;s=0;for(var a=0,l=this.imageParts.length;l>a;++a)t=this.imageParts[a],s+=(t.data.length-1)*t.pageSize+t.cursor;s+=t.pageSize-t.cursor,console.log("rendering finished - filesize "+Math.round(s/1e3)+"kb"),e=new Uint8Array(s),o=0;for(var c=0,u=this.imageParts.length;u>c;++c){t=this.imageParts[c];for(var h=0,d=t.data.length;d>h;++h)r=t.data[h],i=h,e.set(r,o),o+=i===t.data.length-1?t.cursor:t.pageSize}return n=new Blob([e],{type:"image/gif"}),this.emit("finished",n,e)},t.prototype.renderNextFrame=function(){var e,t,i;if(0===this.freeWorkers.length)throw new Error("No free workers");return this.nextFrame>=this.frames.length?void 0:(e=this.frames[this.nextFrame++],i=this.freeWorkers.shift(),t=this.getTask(e),console.log("starting frame "+(t.index+1)+" of "+this.frames.length),this.activeWorkers.push(i),i.postMessage(t))},t.prototype.getContextData=function(e){return e.getImageData(0,0,this.options.width,this.options.height).data},t.prototype.getImageData=function(e){var t;return null!=this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),t=this._canvas.getContext("2d"),t.setFill=this.options.background,t.fillRect(0,0,this.options.width,this.options.height),t.drawImage(e,0,0),this.getContextData(t)},t.prototype.getTask=function(e){var t,i;if(t=this.frames.indexOf(e),i={index:t,last:t===this.frames.length-1,delay:e.delay,transparent:e.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,repeat:this.options.repeat,canTransfer:"chrome"===l.name},null!=e.data)i.data=e.data;else if(null!=e.context)i.data=this.getContextData(e.context);else{if(null==e.image)throw new Error("Invalid frame");i.data=this.getImageData(e.image)}return i},t}(u),e.exports=d}),t.define("/browser.coffee",function(e,t,i,n){var s,o,r,a,l;a=navigator.userAgent.toLowerCase(),r=navigator.platform.toLowerCase(),l=a.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],o="ie"===l[1]&&document.documentMode,s={name:"version"===l[1]?l[3]:l[1],version:o||parseFloat("opera"===l[1]&&l[4]?l[4]:l[2]),platform:{name:a.match(/ip(?:ad|od|hone)/)?"ios":(a.match(/(?:webos|android)/)||r.match(/mac|win|linux/)||["other"])[0]}},s[s.name]=!0,s[s.name+parseInt(s.version,10)]=!0,s.platform[s.platform.name]=!0,e.exports=s}),t.define("events",function(e,t,n,s){i.EventEmitter||(i.EventEmitter=function(){});var o=t.EventEmitter=i.EventEmitter,r="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=10;o.prototype.setMaxListeners=function(e){this._events||(this._events={}),this._events.maxListeners=e},o.prototype.emit=function(e){if("error"===e&&(!this._events||!this._events.error||r(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var t=this._events[e];if(!t)return!1;if("function"!=typeof t){if(r(t)){for(var i=Array.prototype.slice.call(arguments,1),n=t.slice(),s=0,o=n.length;o>s;s++)n[s].apply(this,i);return!0}return!1}switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:var i=Array.prototype.slice.call(arguments,1);t.apply(this,i)}return!0},o.prototype.addListener=function(e,t){if("function"!=typeof t)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",e,t),this._events[e])if(r(this._events[e])){if(!this._events[e].warned){var i;i=void 0!==this._events.maxListeners?this._events.maxListeners:a,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}this._events[e].push(t)}else this._events[e]=[this._events[e],t];else this._events[e]=t;return this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(e,t){var i=this;return i.on(e,function n(){i.removeListener(e,n),t.apply(this,arguments)}),this},o.prototype.removeListener=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var i=this._events[e];if(r(i)){var n=i.indexOf(t);if(0>n)return this;i.splice(n,1),0==i.length&&delete this._events[e]}else this._events[e]===t&&delete this._events[e];return this},o.prototype.removeAllListeners=function(e){return e&&this._events&&this._events[e]&&(this._events[e]=null),this},o.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),r(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]}}),e.GIF=t("/gif.coffee")}).call(this,this)},function(e,t){var i=(window.URL||window.webkitURL||window.mozURL||window.msURL||{}).createObjectURL;i&&(e.exports=i(new Blob(["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function(b){function a(b,d){if({}.hasOwnProperty.call(a.cache,b))return a.cache[b];var e=a.resolve(b);if(!e)throw new Error('Failed to resolve module '+b);var c={id:b,require:a,filename:b,exports:{},loaded:!1,parent:d,children:[]};d&&d.children.push(c);var f=b.slice(0,b.lastIndexOf('/')+1);return a.cache[b]=c.exports,e.call(c.exports,c,c.exports,f,b),c.loaded=!0,a.cache[b]=c.exports}a.modules={},a.cache={},a.resolve=function(b){return{}.hasOwnProperty.call(a.modules,b)?a.modules[b]:void 0},a.define=function(b,c){a.modules[b]=c},a.define('/gif.worker.coffee',function(d,e,f,g){var b,c;b=a('/GIFEncoder.js',d),c=function(a){var c,e,d,f;return c=new b(a.width,a.height),a.index===0?c.writeHeader():c.firstFrame=!1,c.setTransparent(a.transparent),c.setRepeat(a.repeat),c.setDelay(a.delay),c.setQuality(a.quality),c.addFrame(a.data),a.last&&c.finish(),d=c.stream(),a.data=d.pages,a.cursor=d.cursor,a.pageSize=d.constructor.pageSize,a.canTransfer?(f=function(c){for(var b=0,d=a.data.length;b<d;++b)e=a.data[b],c.push(e.buffer);return c}.call(this,[]),self.postMessage(a,f)):self.postMessage(a)},self.onmessage=function(a){return c(a.data)}}),a.define('/GIFEncoder.js',function(e,h,i,j){function c(){this.page=-1,this.pages=[],this.newPage()}function b(a,b){this.width=~~a,this.height=~~b,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.out=new c}var f=a('/TypedNeuQuant.js',e),g=a('/LZWEncoder.js',e);c.pageSize=4096,c.charMap={};for(var d=0;d<256;d++)c.charMap[d]=String.fromCharCode(d);c.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(c.pageSize),this.cursor=0},c.prototype.getData=function(){var d='';for(var a=0;a<this.pages.length;a++)for(var b=0;b<c.pageSize;b++)d+=c.charMap[this.pages[a][b]];return d},c.prototype.writeByte=function(a){this.cursor>=c.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=a},c.prototype.writeUTFBytes=function(b){for(var c=b.length,a=0;a<c;a++)this.writeByte(b.charCodeAt(a))},c.prototype.writeBytes=function(b,d,e){for(var c=e||b.length,a=d||0;a<c;a++)this.writeByte(b[a])},b.prototype.setDelay=function(a){this.delay=Math.round(a/10)},b.prototype.setFrameRate=function(a){this.delay=Math.round(100/a)},b.prototype.setDispose=function(a){a>=0&&(this.dispose=a)},b.prototype.setRepeat=function(a){this.repeat=a},b.prototype.setTransparent=function(a){this.transparent=a},b.prototype.addFrame=function(a){this.image=a,this.getImagePixels(),this.analyzePixels(),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.writePalette(),this.writePixels(),this.firstFrame=!1},b.prototype.finish=function(){this.out.writeByte(59)},b.prototype.setQuality=function(a){a<1&&(a=1),this.sample=a},b.prototype.writeHeader=function(){this.out.writeUTFBytes('GIF89a')},b.prototype.analyzePixels=function(){var g=this.pixels.length,d=g/3;this.indexedPixels=new Uint8Array(d);var a=new f(this.pixels,this.sample);a.buildColormap(),this.colorTab=a.getColormap();var b=0;for(var c=0;c<d;c++){var e=a.lookupRGB(this.pixels[b++]&255,this.pixels[b++]&255,this.pixels[b++]&255);this.usedEntry[e]=!0,this.indexedPixels[c]=e}this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent))},b.prototype.findClosest=function(e){if(this.colorTab===null)return-1;var k=(e&16711680)>>16,l=(e&65280)>>8,m=e&255,c=0,d=16777216,j=this.colorTab.length;for(var a=0;a<j;){var f=k-(this.colorTab[a++]&255),g=l-(this.colorTab[a++]&255),h=m-(this.colorTab[a]&255),i=f*f+g*g+h*h,b=parseInt(a/3);this.usedEntry[b]&&i<d&&(d=i,c=b),a++}return c},b.prototype.getImagePixels=function(){var a=this.width,g=this.height;this.pixels=new Uint8Array(a*g*3);var b=this.image,c=0;for(var d=0;d<g;d++)for(var e=0;e<a;e++){var f=d*a*4+e*4;this.pixels[c++]=b[f],this.pixels[c++]=b[f+1],this.pixels[c++]=b[f+2]}},b.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var b,a;this.transparent===null?(b=0,a=0):(b=1,a=2),this.dispose>=0&&(a=dispose&7),a<<=2,this.out.writeByte(0|a|0|b),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},b.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},b.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},b.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes('NETSCAPE2.0'),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},b.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);var b=768-this.colorTab.length;for(var a=0;a<b;a++)this.out.writeByte(0)},b.prototype.writeShort=function(a){this.out.writeByte(a&255),this.out.writeByte(a>>8&255)},b.prototype.writePixels=function(){var a=new g(this.width,this.height,this.indexedPixels,this.colorDepth);a.encode(this.out)},b.prototype.stream=function(){return this.out},e.exports=b}),a.define('/LZWEncoder.js',function(e,g,h,i){function f(y,D,C,B){function w(a,b){r[f++]=a,f>=254&&t(b)}function x(b){u(a),k=i+2,j=!0,l(i,b)}function u(b){for(var a=0;a<b;++a)h[a]=-1}function A(z,r){var g,t,d,e,y,w,s;for(q=z,j=!1,n_bits=q,m=p(n_bits),i=1<<z-1,o=i+1,k=i+2,f=0,e=v(),s=0,g=a;g<65536;g*=2)++s;s=8-s,w=a,u(w),l(i,r);a:while((t=v())!=c){if(g=(t<<b)+e,d=t<<s^e,h[d]===g){e=n[d];continue}if(h[d]>=0){y=w-d,d===0&&(y=1);do if((d-=y)<0&&(d+=w),h[d]===g){e=n[d];continue a}while(h[d]>=0)}l(e,r),e=t,k<1<<b?(n[d]=k++,h[d]=g):x(r)}l(e,r),l(o,r)}function z(a){a.writeByte(s),remaining=y*D,curPixel=0,A(s+1,a),a.writeByte(0)}function t(a){f>0&&(a.writeByte(f),a.writeBytes(r,0,f),f=0)}function p(a){return(1<<a)-1}function v(){if(remaining===0)return c;--remaining;var a=C[curPixel++];return a&255}function l(a,c){g&=d[e],e>0?g|=a<<e:g=a,e+=n_bits;while(e>=8)w(g&255,c),g>>=8,e-=8;if((k>m||j)&&(j?(m=p(n_bits=q),j=!1):(++n_bits,n_bits==b?m=1<<b:m=p(n_bits))),a==o){while(e>0)w(g&255,c),g>>=8,e-=8;t(c)}}var s=Math.max(2,B),r=new Uint8Array(256),h=new Int32Array(a),n=new Int32Array(a),g,e=0,f,k=0,m,j=!1,q,i,o;this.encode=z}var c=-1,b=12,a=5003,d=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.exports=f}),a.define('/TypedNeuQuant.js',function(A,F,E,D){function C(A,B){function I(){o=[],q=new Int32Array(256),t=new Int32Array(a),y=new Int32Array(a),z=new Int32Array(a>>3);var c,d;for(c=0;c<a;c++)d=(c<<b+8)/a,o[c]=new Float64Array([d,d,d,0]),y[c]=e/a,t[c]=0}function J(){for(var c=0;c<a;c++)o[c][0]>>=b,o[c][1]>>=b,o[c][2]>>=b,o[c][3]=c}function K(b,a,c,e,f){o[a][0]-=b*(o[a][0]-c)/d,o[a][1]-=b*(o[a][1]-e)/d,o[a][2]-=b*(o[a][2]-f)/d}function L(j,e,n,l,k){var h=Math.abs(e-j),i=Math.min(e+j,a),g=e+1,f=e-1,m=1,b,d;while(g<i||f>h)d=z[m++],g<i&&(b=o[g++],b[0]-=d*(b[0]-n)/c,b[1]-=d*(b[1]-l)/c,b[2]-=d*(b[2]-k)/c),f>h&&(b=o[f--],b[0]-=d*(b[0]-n)/c,b[1]-=d*(b[1]-l)/c,b[2]-=d*(b[2]-k)/c)}function C(p,s,q){var h=2147483647,k=h,d=-1,m=d,c,j,e,n,l;for(c=0;c<a;c++)j=o[c],e=Math.abs(j[0]-p)+Math.abs(j[1]-s)+Math.abs(j[2]-q),e<h&&(h=e,d=c),n=e-(t[c]>>i-b),n<k&&(k=n,m=c),l=y[c]>>g,y[c]-=l,t[c]+=l<<f;return y[d]+=x,t[d]-=r,m}function D(){var d,b,e,c,h,g,f=0,i=0;for(d=0;d<a;d++){for(e=o[d],h=d,g=e[1],b=d+1;b<a;b++)c=o[b],c[1]<g&&(h=b,g=c[1]);if(c=o[h],d!=h&&(b=c[0],c[0]=e[0],e[0]=b,b=c[1],c[1]=e[1],e[1]=b,b=c[2],c[2]=e[2],e[2]=b,b=c[3],c[3]=e[3],e[3]=b),g!=f){for(q[f]=i+d>>1,b=f+1;b<g;b++)q[b]=d;f=g,i=d}}for(q[f]=i+n>>1,b=f+1;b<256;b++)q[b]=n}function E(j,i,k){var b,d,c,e=1e3,h=-1,f=q[i],g=f-1;while(f<a||g>=0)f<a&&(d=o[f],c=d[1]-i,c>=e?f=a:(f++,c<0&&(c=-c),b=d[0]-j,b<0&&(b=-b),c+=b,c<e&&(b=d[2]-k,b<0&&(b=-b),c+=b,c<e&&(e=c,h=d[3])))),g>=0&&(d=o[g],c=i-d[1],c>=e?g=-1:(g--,c<0&&(c=-c),b=d[0]-j,b<0&&(b=-b),c+=b,c<e&&(b=d[2]-k,b<0&&(b=-b),c+=b,c<e&&(e=c,h=d[3]))));return h}function F(){var c,f=A.length,D=30+(B-1)/3,y=f/(3*B),q=~~(y/w),n=d,o=u,a=o>>h;for(a<=1&&(a=0),c=0;c<a;c++)z[c]=n*((a*a-c*c)*m/(a*a));var i;f<s?(B=1,i=3):f%l!==0?i=3*l:f%k!==0?i=3*k:f%p!==0?i=3*p:i=3*j;var r,t,x,e,g=0;c=0;while(c<y)if(r=(A[g]&255)<<b,t=(A[g+1]&255)<<b,x=(A[g+2]&255)<<b,e=C(r,t,x),K(n,e,r,t,x),a!==0&&L(a,e,r,t,x),g+=i,g>=f&&(g-=f),c++,q===0&&(q=1),c%q===0)for(n-=n/D,o-=o/v,a=o>>h,a<=1&&(a=0),e=0;e<a;e++)z[e]=n*((a*a-e*e)*m/(a*a))}function G(){I(),F(),J(),D()}function H(){var b=[],g=[];for(var c=0;c<a;c++)g[o[c][3]]=c;var d=0;for(var e=0;e<a;e++){var f=g[e];b[d++]=o[f][0],b[d++]=o[f][1],b[d++]=o[f][2]}return b}var o,q,t,y,z;this.buildColormap=G,this.getColormap=H,this.lookupRGB=E}var w=100,a=256,n=a-1,b=4,i=16,e=1<<i,f=10,B=1<<f,g=10,x=e>>g,r=e<<f-g,z=a>>3,h=6,t=1<<h,u=z*t,v=30,o=10,d=1<<o,q=8,m=1<<q,y=o+q,c=1<<y,l=499,k=491,p=487,j=503,s=3*j;A.exports=C}),a('/gif.worker.coffee')}.call(this,this))\n//# sourceMappingURL=gif.worker.js.map\n// gif.worker.js 0.1.6 - https://github.com/jnordberg/gif.js\n\n},{}]},{},[1])"],{type:"text/javascript"})))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div data-js-sizer class="webcam--sizer" style="padding-top:'+(null==(__t=ratio)?"":_.escape(__t))+'"><div class="webcam--container"><div data-js-videostreamcontainer class="webcam--container-layer"><div data-subview="videoStream"></div></div><div data-js-watermarkcontainer class="webcam-watermark '+(null==(__t=loading?"webcam-watermark--hidden":"")?"":_.escape(__t))+'"></div><div data-js-previewcontainer class="webcam--container-layer" style="display:'+(null==(__t=showPreviewContainer?"block":"none")?"":_.escape(__t))+'"><canvas data-js-canvas width="'+(null==(__t=retina?2*width:width)?"":_.escape(__t))+'" height="'+(null==(__t=retina?2*height:height)?"":_.escape(__t))+'" class="webcam--canvas"></canvas></div><div data-js-controlcontainer class="webcam--container-layer"><div data-subview="webcamControls"></div></div></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(165).animate,r=i(149),a=i(456),l=i(457),c=i(160),u=i(204),h=i(205),d=i(458),p=i(258),g=r.extend({className:"video-stream",template:d,mixins:[c,u,h],defaultOptions:{video:!0,audio:!1},defaults:{width:500,height:375,retina:!0,mirrored:!0,needsPermission:!0,running:!1},initialize:function(e){this.options=e=n.extend({},this.defaultOptions,e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults)))},_onChangeRetina:function(e,t){t?this.$video.attr({width:2*this.get("width"),height:2*this.get("height")}):this.$video.attr({width:this.get("width"),height:this.get("height")})},_onChangeMirrored:function(e,t){this.$el.toggleClass("mirrored",t)},_onChangeRunning:function(e,t){this.loader&&this.loader.set("animate",!t),o(this.js$("noVideo"),"stop"),o(this.js$("noVideo"),{opacity:t?0:1},{display:t?"none":"block",delay:t?50:0,duration:100})},startStream:function(){if(!l)throw new Error("VideoStream: Cannot initialize without getUserMedia support");return l(n.pick(this.options,["audio","video"]),n.bind(this._onStreamReady,this),n.bind(this._onStreamError,this))},stopStream:function(){this.set("running",!1),this.streamURL=null,this.stream&&(this.stream.getVideoTracks()[0].stop(),this.stream=null)},_onStreamReady:function(e){this.set("needsPermission",!1),this.stream=e,this.streamURL=a(this.stream),this._playVideoSteam()},_onStreamError:function(e){this.stopStream(),this.trigger("error",e)},_playVideoSteam:function(){this.video&&this.streamURL&&(this.video.src=this.streamURL,this.$video.one("loadeddata",n.bind(function(e){this.set("running",!0)},this)),this.video.play())},remove:function(){s(this.video).remove(),r.prototype.apply(this,arguments)},teardown:function(){return this.stopStream(),this.stopListening(),this},beforeRender:function(){this.loader=this.subViews.loader=new p({variation:"centered",loading:!this.get("running")}),this.listenTo(this,"change:retina",this._onChangeRetina),this.listenTo(this,"change:mirrored",this._onChangeMirrored),this.listenTo(this,"change:running",this._onChangeRunning)},render:function(){return this._onChangeMirrored(this,this.get("mirrored")),this.$el.html(this.template(this.toJSON())),this.attachSubViews(),this.$video=this.$(".video-stream--video"),this.video=this.$video.get(0),this._playVideoSteam(),this}});e.exports=g},function(e,t){"use strict";var i=(window.URL||window.webkitURL||window.mozURL||window.msURL||{}).createObjectURL;e.exports=i},function(e,t,i){"use strict";var n=i(3),s=i(9).browser,o=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;s.mozilla&&Math.floor(s.version)>=20&&(o=navigator.mozGetUserMedia),o&&(o=n.bind(o,navigator)),e.exports=o},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<video class="video-stream--video" width="'+(null==(__t=retina?2*width:width)?"":_.escape(__t))+'" height="'+(null==(__t=retina?2*height:height)?"":_.escape(__t))+'"></video><div data-js-novideo class="video-stream--no-video"><div data-subview="loader"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(165).hook,o=i(165).animate,r=i(149),a=i(160),l=i(204),c=i(205),u=i(460),h=i(344),d=i(462),p=r.extend({
className:"webcam-controls",template:d,events:{mouseenter:"_onHoverControls",mouseleave:"_onHoverControls","click [data-js-flashButton]":"_onClickFlashButton","click [data-js-snapButton]":"_onClickSnapButton","click [data-js-gifButton]":"_onClickGifButton","click [data-js-retakeButton]":"_onClickRetakeButton"},mixins:[a,l,c],defaults:{isActive:!1,flash:!0,mirrored:!0,defaultTimer:3e3,timePerFrame:1e3,gifFrameCount:4,enableFlash:!0,enableGifMode:!0,enableRemove:!0},initialize:function(e){this.options=e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults)))},_onHoverControls:function(e){clearTimeout(this._removeIsActive);var t="mouseover"===e.type||"mouseenter"===e.type;t?this.set("isActive",!0):this._removeIsActive=n.delay(n.bind(function(){this.set("isActive",!1)},this),500)},_onClickFlashButton:function(){this.trigger("webcam","toggleFlash",!this.get("flash"))},_onClickSnapButton:function(e){var t=!e.altKey;this.countdownTimer.stop(),this.listenToOnce(this,"webcam:snapped",function(){this.showSnapButtonGroup("retakeButton")});var i=this.get("defaultTimer");t?(this.showSnapButtonGroup("countdownTimer",0),this.countdownTimer.start(i,1).then(n.bind(function(){this.trigger("webcam","snap")},this))):this.trigger("webcam","snap")},_onClickGifButton:function(e){this.countdownTimer.stop(),this.trigger("webcam","gifStart"),this.listenTo(this.countdownTimer,"countdown:tick",function(e,t){this.trigger("webcam","gifSnap",e+1>=t),t>e+1&&this.pulseButton()});var t=this.get("gifFrameCount"),i=this.get("timePerFrame");this.showSnapButtonGroup("countdownTimer",0),this.countdownTimer.start(t*i,t).then(n.bind(function(){this.stopListening(this.countdownTimer,"countdown:tick"),this.showSnapButtonGroup("processing")},this))},_onClickRetakeButton:function(e){this.showSnapButtonGroup("snapButton"),this.trigger("webcam","retake")},pulseButton:function(){var e=1.5;s(this.js$("primaryButton"),"translateX","-50%"),s(this.js$("primaryButton"),"scale",e),o(this.js$("primaryButton"),"stop"),o(this.js$("primaryButton"),{scale:[1,e]},{duration:200})},showSnapButtonGroup:function(e,t){n.isNumber(t)||(t=100);var i=this.js$("snapButtonGroup").filter('[data-js-snapButtonGroup="'+e+'"]');if(!n.isEmpty(i)){var s=this.js$("snapButtonGroup").not(i);o(i,"stop"),o(s,"stop"),o(this.js$("primaryButton"),"stop"),o(i,{opacity:1},{display:"block",duration:t}),o(s,{opacity:0},{display:"none",duration:t}),this.js$("primaryButton").toggleClass("invert","processing"===e);var r=60;"snapButton"===e&&this.get("enableGifMode")&&(r=150),o(this.js$("primaryButton"),{width:r},{display:"block",duration:t})}},serialize:function(){return this.toJSON()},teardown:function(){return this},beforeRender:function(){this.countdownTimer=this.subViews.countdownTimer=new u,this.listenTo(this,"change:flash",function(e,t){this.js$("flashButton").toggleClass("active",t)}),this.removeButton=this.subViews.removeButton=new h({buttonClass:"active",onClick:n.bind(function(){this.trigger("webcam","close")},this)}),this.listenTo(this,"change:isActive",function(e,t){this.js$("overlayButtons").toggleClass("active",t)})},render:function(){return this.$el.html(this.template(this.serialize())),this.attachSubViews(),this.showSnapButtonGroup("snapButton",0),this}});e.exports=p},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(121),r=i(165).hook,a=i(165).animate,l=i(149),c=i(160),u=i(204),h=i(205),d=i(461),p=l.extend({className:"countdown-timer",template:d,mixins:[c,u,h],defaults:{duration:3e3,ticks:1},initialize:function(e){this.options=e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults)))},start:function(e,t){n.isNumber(e)||(e=this.get("duration")),n.isNumber(t)||(t=this.get("ticks")),this.set({duration:e,ticks:t}),this._generateTickMarks(t),this.stop(),this.trigger("countdown:start"),this.js$("inner").removeClass("half-past"),this._halfPastTimeout=n.delay(n.bind(function(){this.js$("inner").addClass("half-past")},this),Math.floor(e/2));var i=0;return o.join(o.promise(n.bind(function(s,o){clearInterval(this._tickerInterval),this._tickerInterval=setInterval(n.bind(function(){this.trigger("countdown:tick",i++,t),i>=t&&(clearInterval(this._tickerInterval),s())},this),e/t)},this)),a(this.js$("rotator"),{rotateZ:["360deg","0deg"]},{easing:"linear",duration:e})).then(n.bind(function(){this.trigger("countdown:complete")},this))},stop:function(){clearTimeout(this._halfPastTimeout),clearInterval(this._tickerInterval),a(this.js$("rotator"),"stop")},teardown:function(){return clearTimeout(this._halfPastTimeout),clearInterval(this._tickerInterval),this.stopListening(),this},remove:function(){return this.teardown(),l.prototype.remove.apply(this,arguments)},_generateTickMarks:function(e){n.isNumber(e)||(e=this.get("ticks")),this.js$("ticks").empty(),e>1&&n.forEach(n.range(e),function(t){var i=s('<div class="countdown-timer--tick"></div>');r(i,"rotateZ",360*t/e+"deg"),r(i,"translateY","-50%"),this.js$("ticks").append(i)},this)},serialize:function(){return this.toJSON()},render:function(){return this.$el.html(this.template(this.serialize())),this._generateTickMarks(),this.attachSubViews(),this}});e.exports=p},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-js-inner class="countdown-timer--inner"><div data-js-ticks class="countdown-timer--ticks"></div><div data-js-inner class="countdown-timer--fill"><div class="mask-static-half"><div class="fill"></div></div><div class="mask-rotating-half"><div data-js-rotator class="fill"></div></div></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div data-js-overlaybuttons class="media-overlay"> ',enableFlash&&(__p+=' <div data-js-flashbutton class="button webcam--flash-button '+(null==(__t=flash?"active":"")?"":_.escape(__t))+'"><div class="icon"></div></div> '),__p+=" ",enableRemove&&(__p+=' <div data-subview="removeButton"></div> '),__p+=' </div><div data-js-primarybutton class="big-button webcam--primary-button"><div data-js-snapbuttongroup="countdownTimer" class="big-button-group"><div data-subview="countdownTimer"></div></div><div data-js-snapbuttongroup="snapButton" class="big-button-group"><div data-js-snapbutton class="button webcam--snap-button"><div class="icon"></div></div> ',enableGifMode&&(__p+=' <div data-js-gifbutton class="button webcam--gif-button"><div class="icon"></div></div> '),__p+=' </div><div data-js-snapbuttongroup="processing" class="big-button-group"><div data-js-processingbutton class="button webcam--processing-button"><div class="icon"></div></div></div><div data-js-snapbuttongroup="retakeButton" class="big-button-group"><div data-js-retakebutton class="button webcam--retake-button"><div class="icon"></div></div></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(444),o=i(344),r=s.prototype.template,a=i(464),l=s.extend({className:"photoset--photo media-container",events:n.extend({mouseenter:"_onHoverMediaContainer",mouseleave:"_onHoverMediaContainer","click [data-js-clickthroughUrlButton]":"_onClickClickthroughUrlButton","click [data-js-captionButton]":"_onClickCaptionButton"},s.prototype.events),defaults:n.extend({enableClickthroughUrl:!1,hasClickthroughUrl:!1,enableCaption:!1,hasCaption:!1,isActive:!1},s.prototype.defaults),template:function(e){return r(e)+a(e)},_onHoverMediaContainer:function(e){clearTimeout(this._removeButtonActive);var t="mouseover"===e.type||"mouseenter"===e.type;t?(this.set("isActive",!0),this.trigger("photoset:hover",this,this.photo)):this._removeButtonActive=n.delay(n.bind(function(){this.set("isActive",!1)},this),500)},_onClickClickthroughUrlButton:function(e){this.photo.trigger("photo:editClickthroughUrl",this.photo,e.currentTarget)},_onClickCaptionButton:function(e){this.photo.trigger("photo:editCaption",this.photo,e.currentTarget)},_updateOverlayButtons:function(){this.js$("clickthroughUrlButton").css("display",this.get("enableClickthroughUrl")?"block":"none"),this.js$("captionButton").css("display",this.get("enableCaption")?"block":"none"),this.js$("clickthroughUrlButton").toggleClass("active",this.get("hasClickthroughUrl")),this.js$("captionButton").toggleClass("active",this.get("hasCaption"))},addStateListeners:function(){this.listenTo(this,"change:isActive",function(e,t){this.js$("removeButton").toggleClass("active",t),this.js$("mediaOverlay").toggleClass("active",t)}),this.listenTo(this,"photoset:unhover",function(e,t){this.set("isActive",!1)}),this.listenTo(this,"change:enableClickthroughUrl change:enableCaption",this._updateOverlayButtons),this.listenTo(this,"change:hasClickthroughUrl change:hasCaption",this._updateOverlayButtons),this.listenTo(this.photos,"add remove",function(){this.photos.length>1?this.js$("sortable").attr("draggable",!0):this.js$("sortable").removeAttr("draggable")}),this.post&&this.listenTo(this.post,"change:linkthrough",function(e,t){this.set("hasClickthroughUrl",!!t)}),this.listenTo(this.photo,"change:caption",function(e,t){this.set("hasCaption",!!t)})},beforeRender:function(){var e=this.photos.length>1;this.set("enableClickthroughUrl",!e),this.set("enableCaption",e),this.set("hasClickthroughUrl",this.post?!!this.post.get("linkthrough"):!1),this.set("hasCaption",!!this.photo.get("caption")),this.removeButton=this.subViews.removeButton=new o({onClick:n.bind(function(){this.photoset.removePhoto(this.photo.id)},this),buttonClass:"top-right"}),this.addStateListeners()},afterRender:function(){s.prototype.afterRender.apply(this,arguments),this.photos.length>1&&this.js$("sortable").attr("draggable",!0),this._updateOverlayButtons()}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div data-js-sortable class="photoset--photo-dragger"></div><div data-js-mediaoverlay class="media-overlay"><div data-js-clickthroughurlbutton class="overlay-button '+(null==(__t=hasClickthroughUrl?"active":"")?"":_.escape(__t))+'"><div class="icon icon_editor_link"></div></div><div data-js-captionbutton class="overlay-button '+(null==(__t=hasCaption?"active":"")?"":_.escape(__t))+'"><div class="icon icon_editor_more"></div></div></div><div data-subview="removeButton"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(121),r=i(165).animate,a=i(171),l=i(101),c=i(149),u=i(205),h=i(160),d=i(204),p=i(211),g=i(466),m=c.extend({className:"overlay-input-popover",mixins:[u,h,d,p],template:g,events:{"keydown [data-js-input]":"_onKeyDown","input [data-js-input]":"_onInput","keyup [data-js-input]":"_onInput","change [data-js-input]":"_onInput","click [data-js-confirm]":"_onClickConfirm"},defaultOptions:{updateValueOnInput:!1,updateValueOnClose:!0,updateShift:!0},defaults:{value:"",placeholder:"",ariaLabel:"",maxLength:2048,confirmText:l("Done")},initialize:function(e){this.options=e=n.extend({},this.defaultOptions,e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),this.$pinnedContainer=s(e.pinnedTargetContainer)},_onKeyDown:function(e){switch(e.which||e.keyCode){case 13:this._onClickConfirm();break;case 27:e.stopPropagation(),this.teardown()}},_onInput:function(){this.options.updateValueOnInput&&this._updateValueFromInput()},_onClickConfirm:function(){this._updateValueFromInput(),this.teardown()},_updateValueFromInput:function(){var e=this.js$("input").val();this.set("value",e)},openAnimation:function(e){n.isNumber(e)||(e=a(100)),this._startWidth=this.$pinned.outerWidth(),this.js$("popover").width(this._startWidth);var t=this.$pinned.position().left;return n.isEmpty(this.$pinnedContainer)?this._offsetLeft=0:this._offsetLeft=this.$pinnedContainer.offset().left-this.$pinned.offset().left+t||0,this.options.updateShift&&this.setShift(n.defaults({x:this._offsetLeft},this.getShift())),o.all([r(this.$pinned,{opacity:0},{display:"none",duration:e}),r(this.js$("confirm"),{opacity:1},{duration:e}),r(this.js$("popover"),{marginLeft:this._offsetLeft,width:this._targetWidth},{duration:e})])},pinnedRect:function(){var e=this.$pinned.css("display");this.$pinned.css("display","block");var t=p.properties.defaults.pinnedRect.apply(this,arguments);return this.$pinned.css("display",e),t},closeAnimation:function(e){return n.isNumber(e)||(e=a(100)),o.all([r(this.$pinned,{opacity:1},{display:"block",duration:e}),r(this.js$("confirm"),{opacity:0},{duration:e}),r(this.js$("popover"),{marginLeft:0,width:this._startWidth},{duration:e})])},serialize:function(){return this.toJSON()},render:function(){return this.$el.html(this.template(this.serialize())),n.isEmpty(this.$pinnedContainer)?this._targetWidth=520:this._targetWidth=this.$pinnedContainer.outerWidth()-20,this.setPinnedSide(!1),n.defer(n.bind(function(){this.openAnimation().then(n.bind(function(){this.js$("input").focus()},this))},this)),this},teardown:function(){return this.options.updateValueOnClose&&this._updateValueFromInput(),this.stopListening(),this.closeAnimation().then(n.bind(function(){this.remove()},this)),this}});e.exports=m},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="overlay-button-popover" data-js-popover><input data-js-input type="text" value="'+(null==(__t=value)?"":_.escape(__t))+'" placeholder="'+(null==(__t=placeholder)?"":_.escape(__t))+'" aria-label="'+(null==(__t=ariaLabel)?"":_.escape(__t))+'" maxlength="'+(null==(__t=maxLength)?"":_.escape(__t))+'" class="input-field"><div data-js-confirm class="input-confirm">'+(null==(__t=confirmText)?"":_.escape(__t))+"</div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="photobooth-container" data-js-photobooth></div><div class="photoset-container" data-js-photoset></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(469),o=i(471),r=i(457),a=s.extend({defaults:n.extend({enableSelfie:r},s.prototype.defaults),events:n.extend({"click [data-js-webcamButton]":"_onClickWebcamButton"},s.prototype.events),_onClickWebcamButton:function(){this.trigger("webcam:show")},afterRender:function(){if(s.prototype.afterRender.apply(this,arguments),this.get("enableSelfie")){var e=this.subViews.webcamButton=new o;e.render().$el.appendTo(this.js$("mediaUpload").children(".split-cell-inner")),this.listenTo(this,"change:enableSelfie",function(t,i){i||(e.teardown().remove(),this.subViews.webcamButton=null,this.stopListening(this,"change:enableSelfie"))})}}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=(i(103),i(424)),a=i(220),l=i(344),c=i(406),u=i(160),h=i(204),d=i(205),p=i(470),g=s(document),m=o.extend({className:"media-dropzone-container media-container",template:p,mixins:[u,h,d],defaults:{droppable:!1,showInput:!1,toggleDropzone:!1,dropzoneText:"",enableUpload:!0,enableUrl:!0,uploadIcon:"",uploadText:"",uploadTooltip:"",urlIcon:!1,urlText:"",urlTooltip:"",url:"",urlPlaceholder:"http://",urlAriaLabel:"http://"},defaultOptions:{uploadOptions:{},modelKey:!1,urlParser:!1,documentDrag:!0,parseOnUpload:!1,parseOnInput:!1,parseOnEnter:!0,parseOnPaste:!0,inputDebounceTime:250},events:{mouseenter:"_onHoverMediaContainer",mouseleave:"_onHoverMediaContainer","click [data-show-tooltip]":"_onClickShowTooltip","click [data-js-mediaUrl]":"_focusUrlInput"},initialize:function(e){this.options=e=n.extend({},this.defaultOptions,e),n.isString(e.dropzoneFineprint)&&(e.dropzoneFineprint=[e.dropzoneFineprint]),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.defaults(this.attributes,{defaultBehavior:this.get("enableUpload")?"upload":"url",dropzoneBehavior:this.get("enableUpload")?"upload":"url",splitDropzone:this.get("enableUpload")&&this.get("enableUrl")}),this.upload=new r(e.uploadOptions),e.modelKey&&this.listenTo(this.upload,"change:url",this._onUploadUrlChange),this.listenTo(this.upload,"add",function(e){this.trigger("upload:start",e)}),this.listenTo(this.upload,"complete",function(e,t){this.trigger("upload:complete",t)}),this.listenTo(this.upload,"error",function(e,t){this.trigger("upload:error",t)}),this.listenTo(this.upload,"invalid",function(e,t){this.trigger("upload:invalid",t)}),this.listenTo(this.upload,"allComplete",function(e,t){this.trigger("uploads:allComplete",e)}),this.listenTo(this,"change:droppable",function(e,t){this.js$("dropzone").toggleClass("droppable",t)}),this.listenTo(this,"change:showInput",function(e,t){t?(this.js$("dropzone").addClass("show-input"),this._onUrlInputChange()):(this.js$("dropzone").removeClass("show-input"),this.js$("dropzone").height(""),this.get("defaultBehavior")!==this.get("dropzoneBehavior")&&this.set("dropzoneBehavior",this.get("defaultBehavior")))}),this.listenTo(this,"url:complete",this._onUrlComplete),this.listenTo(this,"url:error",this._onUrlError),this.listenTo(this,"change:toggleDropzone",function(e,t){t?(this.js$("dropzone").addClass("toggle-dropzone"),this.js$("mediaUploadText").text(this.get("dropzoneText")),this.js$("mediaUrlText").text(this.get("dropzoneText"))):(this.js$("dropzone").removeClass("toggle-dropzone"),this.js$("mediaUploadText").text(this.get("uploadText")),this.js$("mediaUrlText").text(this.get("urlText")))}),this.listenTo(this,"change:dropzoneBehavior",function(e,t){this.js$("dropzone").removeClass("toggle-dropzone-upload toggle-dropzone-url").addClass("toggle-dropzone-"+t)}),this.__updateUrlFromInput=n.debounce(this._updateUrlFromInput,this.options.inputDebounceTime),this.__onDragOver=n.bind(this._onDragOver,this),this.__onDragLeave=n.bind(this._onDragLeave,this)},urlParser:function(e,t){return n.isFunction(this.options.urlParser)?this.options.urlParser(e,this,t):void 0},addFiles:function(e){return this.upload.addFiles(e)},_addDragStartListener:function(e){s(document).on("dragover.dropzone dragenter.dropzone",this.__onDragOver)},_removeDragStartListener:function(e){s(document).off("dragover.dropzone dragenter.dropzone",this.__onDragOver)},_addDragEndListener:function(e){s(document).on("mouseout.dropzone",this.__onDragLeave)},_removeDragEndListener:function(e){s(document).off("mouseout.dropzone",this.__onDragLeave)},_onDragOver:function(e){this._dragging=!0,this.set("droppable",!0),this._removeDragStartListener(),this._addDragEndListener()},_onDragLeave:function(e){this._dragging=!1,this.set("droppable",!1),this._addDragStartListener(),this._removeDragEndListener()},_onClickShowTooltip:function(e){var t=this.$(e.currentTarget).data("showTooltip"),i=n.result(this,t);i&&i instanceof c&&!i.isOrWasRecentlyRendered()&&i.render()},_focusUrlInput:function(e){return this.js$("removeButton").is(e.target)||this.js$("removeButton").find(e.target).length?!0:(this.set("showInput",!0),void(this.urlInput&&this.urlInput.focus()))},_onUploadUrlChange:function(e,t){this.model&&(this.model.set(this.options.modelKey,t),this.options.parseOnUpload&&this.urlParser(t,"upload"))},_updateUrlFromInput:function(){var e=this.urlInput?n.trim(this.urlInput.getEditorValue()||""):"";this.set("url",e)},_onUrlInputChange:function(){this.urlInput&&this.get("showInput")&&(this.js$("dropzone").height(this.urlInput.$el.height()),this.__updateUrlFromInput())},_onUrlInputClientEvent:function(e){if("keydown"===e.type)switch(e.which||e.keyCode){case 27:e.preventDefault(),e.stopImmediatePropagation(),this.set("showInput",!1),this.urlInput.setEditorValue(""),this.js$("dropzone").removeClass("has-error"),this.urlInput.blur();break;case 13:this.options.parseOnEnter&&!e.shiftKey?(e.preventDefault(),e.stopImmediatePropagation(),this._updateUrlFromInput(),this.urlParser(this.get("url"),"enter")):this.options.parseOnInput&&(this.urlParser(this.get("url")),this.listenToOnce(this,"change:url",function(e,t){this.urlParser(t,"input")}));break;default:this.js$("dropzone").removeClass("has-error"),this.options.parseOnInput&&(this.urlParser(this.get("url")),this.listenToOnce(this,"change:url",function(e,t){this.urlParser(t,"input")}))}},_onUrlInputPasteEvent:function(e,t){n.delay(n.bind(function(){this.options.parseOnPaste&&(this._updateUrlFromInput(),this.urlParser(this.get("url"),"paste"))},this),0)},_onUrlComplete:function(){this.js$("dropzone").removeClass("has-error")},_onUrlError:function(){this.js$("dropzone").addClass("has-error")},_onHoverMediaContainer:function(e){clearTimeout(this._removeButtonActive);var t="mouseover"===e.type||"mouseenter"===e.type;t?this.js$("removeButton").addClass("active"):this._removeButtonActive=n.delay(n.bind(function(){this.js$("removeButton").removeClass("active")},this),500)},serialize:function(){return n.mapValues(this.toJSON(),function(e,t){return n.isFunction(e)&&t.match(/^(upload|url)(Icon|Text|Tooltip)$/)?e():e},this)},beforeTeardown:function(){this.upload.getElement().detach(),delete this.subViews.upload,g.off("keydown.postForm.dropzone keyup.postForm.dropzone")},afterTeardown:function(){this.uploadTooltip&&this.uploadTooltip.remove(),this.urlTooltip&&this.urlTooltip.remove(),delete this.uploadTooltip,delete this.urlTooltip,delete this.urlInput,delete this.urlInput,delete this.removeButton,this._removeDragStartListener(),this._removeDragEndListener()},beforeRender:function(){if(this.subViews.upload=this.upload.indexView,this.get("enableUrl")){var e={placeholder:this.get("urlPlaceholder"),name:"url",ariaLabel:this.get("urlAriaLabel"),syncWithModel:!1,onChange:n.bind(this._onUrlInputChange,this),onClientEvent:n.bind(this._onUrlInputClientEvent,this),pasteHook:n.bind(this._onUrlInputPasteEvent,this)};n.defaults(e,n.pick(this.options,n.keys(e))),this.urlInput=this.subViews.urlInput=new a(e),this.removeButton=this.subViews.removeButton=new l({onClick:n.bind(function(){this.set("showInput",!1),this.urlInput.setEditorValue(""),this.js$("dropzone").removeClass("has-error")},this),buttonClass:"top-right"})}g.on("keydown.postForm.dropzone keyup.postForm.dropzone",n.bind(function(e){switch(e.which||e.keyCode){case 18:var t=this.get("defaultBehavior"),i="url"===t?"upload":"url";"keydown"===e.type?this.set("dropzoneBehavior",i):this.get("showInput")||this.set("dropzoneBehavior",t)}},this)),this.options.documentDrag&&this._addDragStartListener()},afterRender:function(){this.get("enableUrl")&&this.urlInput.setEditorValue(this.get("url")||""),this.get("enableUpload")&&this.get("uploadTooltip")&&(this.uploadTooltip=new c({className:"dropzone-tooltip-popover",sanitize:!1,text:n.result(this.attributes,"uploadTooltip")}),this.uploadTooltip.setPinnedTarget(this.js$("uploadTooltip"))),this.get("enableUrl")&&this.get("urlTooltip")&&(this.urlTooltip=new c({className:"dropzone-tooltip-popover",sanitize:!1,text:n.result(this.attributes,"urlTooltip")}),this.urlTooltip.setPinnedTarget(this.js$("urlTooltip"))),this.renderSubViews()},render:function(){return this.$el.html(this.template(this.serialize())),this.attachSubViews(),this}});e.exports=m},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{}){__p+="";var dropzoneClasses=[];showInput&&dropzoneClasses.push("show-input"),splitDropzone&&dropzoneClasses.push("split-dropzone"),toggleDropzone&&dropzoneClasses.push("toggle-dropzone"),defaultBehavior&&dropzoneClasses.push("toggle-dropzone-"+defaultBehavior),__p+=' <div class="media-dropzone '+(null==(__t=dropzoneClasses.join(" "))?"":_.escape(__t))+'" data-js-dropzone><div class="split-cells"> ',enableUpload&&(__p+=' <div class="split-cell media-upload-button" data-js-mediaupload><div class="split-cell-inner"><div class="v-center-outer"><div class="v-center-inner"> ',uploadIcon&&(__p+=' <div class="dropzone-icon '+(null==(__t=uploadIcon)?"":_.escape(__t))+'"></div> '),__p+=" ",uploadText&&(__p+=' <div class="dropzone-title"><span class="dropzone-text" data-js-mediauploadtext>'+(null==(__t=toggleDropzone?dropzoneText:uploadText)?"":_.escape(__t))+"</span> ",uploadTooltip&&(__p+=' <div class="dropzone-tooltip" data-js-uploadtooltip><span class="icon icon_help" data-show-tooltip="uploadTooltip"></span></div> '),__p+=" </div> "),__p+=' </div></div></div><div class="media-upload"><div data-subview="upload"></div></div></div> '),__p+=" ",enableUrl&&(__p+=' <div class="split-cell media-url-button" data-js-mediaurl><div class="split-cell-inner"><div class="v-center-outer"><div class="v-center-inner"> ',urlIcon&&(__p+=' <div class="dropzone-icon '+(null==(__t=urlIcon)?"":_.escape(__t))+'"></div> '),__p+=" ",urlText&&(__p+=' <div class="dropzone-title"><span class="dropzone-text" data-js-mediaurltext>'+(null==(__t=toggleDropzone?dropzoneText:urlText)?"":_.escape(__t))+"</span> ",urlTooltip&&(__p+=' <div class="dropzone-tooltip" data-js-urltooltip><span class="icon icon_help" data-show-tooltip="urlTooltip"></span></div> '),__p+=" </div> "),__p+=' </div></div></div><div class="media-url-cropper media-dropzone-cropper"><div class="media-url"><div class="v-center-outer"><div class="v-center-inner"><div data-subview="urlInput"></div></div></div></div></div><div data-subview="removeButton"></div></div> '),__p+=" </div></div>"}return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(165).animate,o=i(149),r=i(160),a=i(204),l=i(205),c=i(472),u=o.extend({className:"webcam-button-container",template:c,events:{mouseenter:"_onMouseEnter",mouseleave:"_onMouseLeave"},mixins:[r,a,l],wink:function(e){!n.isUndefined(e)||(e=!this.js$("smiley").hasClass("icon_postforms_selfie_wink")),this.js$("smiley").toggleClass("icon_postforms_selfie_wink",e),this.js$("smiley").toggleClass("icon_postforms_selfie",!e)},_onMouseEnter:function(){var e=100;s(this.js$("text"),"stop"),s(this.js$("text"),{opacity:1},{duration:e});var t=this.js$("smiley").outerWidth()+this.js$("text").outerWidth();s(this.$el,"stop"),s(this.$el,{marginLeft:-Math.round(.5*t),width:t},{duration:e}).then(n.bind(function(){this._winkTimeout=n.delay(n.bind(function(){this.wink(!0),this._winkTimeout=n.delay(n.bind(function(){this.wink(!1)},this),100)},this),400)},this))},_onMouseLeave:function(){var e=100;clearTimeout(this._winkTimeout),this.wink(!1),s(this.js$("text"),"stop"),s(this.js$("text"),{opacity:0},{duration:e});var t=this.js$("smiley").outerWidth();s(this.$el,"stop"),s(this.$el,{marginLeft:-Math.round(.5*t),width:t},{duration:e}).then(n.bind(function(){}))},render:function(){return this.$el.html(this.template()),this},teardown:function(){return clearTimeout(this._winkTimeout),this}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div data-js-webcambutton class="webcam-button"><span data-js-smiley class="icon icon_postforms_selfie"></span><span data-js-text class="dropzone-text">'+(null==(__t=__("Take a selfie"))?"":_.escape(__t))+"</span></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="media-wrapper" data-js-media><div data-subview="mediaPreview"></div><div data-subview="mediaComposer"></div></div><div class="caption-wrapper" data-js-caption><div data-subview="reblogTree"></div><div data-subview="caption"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(101),r=i(340),a=i(475),l=i(220),c=i(356),u=i(342),h=i(344),d=i(476),p=i(193),g=i(192),m=i(186),f=r.extend({className:"link-post",events:{"mouseenter [data-js-removable=true]":"_onHoverRemoveButton","mouseleave [data-js-removable=true]":"_onHoverRemoveButton","mouseleave .media-container":"_onHoverRemoveButton"},template:a,defaults:s.defaults({hasMedia:!1,showCaption:!1,ogFetchPending:!1,tagEditor:null,hasCustomTags:!1,numOgTags:5},r.prototype.defaults),afterInitialize:function(){this._ogService=new d,"new"!==this.model.get("mode")&&this.set({hasMedia:!0,hasCustomTags:!0}),this.model.has("caption")&&this.set("showCaption",!0),this.set("hideControlsLine",!this.get("showCaption")),this.tagEditor=this.get("tagEditor")},afterRender:function(){this.renderSubViews(),this.model.canEditMedia()||(this.title.disable(),this.excerpt.disable(),this.url.disable(),this._hideEmptyFields()),this._onChangeThumbnail(this.model,this.model.get("thumbnail")),this._onChangeAuthor(this.model,this.model.get("author")),this._onChangeHasMedia(this,this.get("hasMedia")),this._onChangeShowCaption(this,this.get("showCaption")),this._onChangeShortUrl(this.model,this.model.get("url")),"new"!==this.model.get("mode")||s.isEmpty(this.model.get("url"))||(this.url.setEditorValue(this.model.get("url")),this._onChangeUrl(this.model,this.model.get("url"))),this.trigger("media:ready"),this.get("showCaption")?this.delayedFocus(this.caption):this.delayedFocus(this.url)},createSubViews:function(){var e=this.subViewOptions(),t=s.extend({className:"title",name:"title",isResizable:!1,placeholder:o("Enter a title"),ariaLabel:o("Link title"),forceSingleLine:!0},e),i=s.extend({className:"summary",name:"excerpt",isResizable:!1,placeholder:o("Enter a summary"),ariaLabel:o("Link summary"),forceSingleLine:!1},e),n=s.extend({className:"url",isResizable:!1,placeholder:o("Type or paste a URL"),ariaLabel:o("Type or paste a URL"),forceSingleLine:!0,pasteHook:s.bind(this._onPaste,this),onClientEvent:s.bind(this._onUrlClientEvent,this),onChange:s.bind(s.debounce(this._onUrlEditorChange,500),this)},e),r=s.extend({className:"caption",name:"caption",placeholder:o("Add a description, if you like"),ariaLabel:o("Description")},e),a=s.extend({isRemovable:!0},e);this.url=this.subViews.url=new l(n),this.title=this.subViews.title=new l(t),this.excerpt=this.subViews.excerpt=new l(i),this.caption=this.subViews.caption=new c(r),this.removeButton=this.subViews.removeButton=new h({buttonClass:"top-right"}),this.model.isReblog()&&(this.reblogTree=this.subViews.reblogTree=new u(a))},addStateListeners:function(){"reblog"!==this.model.get("mode")&&this.listenTo(this.model,"change:url",this._onChangeUrl),this.listenTo(this,"change:ogFetchPending",this._onChangeFetchPending),this.listenTo(this,"change:hasMedia",this._onChangeHasMedia),this.listenTo(this,"change:showCaption",this._onChangeShowCaption),this.listenTo(this.model,"change:thumbnail",this._onChangeThumbnail),this.listenTo(this.model,"change:url",this._onChangeShortUrl),this.listenTo(this.model,"change:author",this._onChangeAuthor),this.listenTo(this.model,"change:tagInput",this._onTagInputChange),this.listenTo(this.removeButton,"remove",this._onRemoveClick)},removeThumbnail:function(){this.model.unset("thumbnail")},removeMedia:function(){this.model.softReset(),this.title.setEditorValue(""),this.excerpt.setEditorValue(""),this.url.setEditorValue(""),this.tagEditor&&!this.get("hasCustomTags")&&this.tagEditor.removeTags(),s.isEmpty(this.model.get("caption"))&&(this.caption.setEditorValue(""),s.isEmpty(this.model.get("tags"))&&this.set("showCaption",!1)),this.set("hasMedia",!1),this.url.focus();
},getRichTextEditor:function(){return this.caption},_onHoverRemoveButton:function(e){var t=n(e.relatedTarget||e.toElement),i="mouseover"===e.type||"mouseenter"===e.type;(i||0===t.parents('[data-subview="removeButton"]').length&&0===t.parents("[data-js-removable=true]").length)&&this.js$("removeButton").toggleClass("active",i)},_onChangeThumbnail:function(e,t){var i=this.js$("image"),o=!s.isEmpty(t);this.js$("media").toggleClass("has-thumbnail",o),this.js$("article").attr("data-js-removable",!o),this.$(".publisher-container").attr("data-js-removable",o),i.attr("data-js-removable",o),i.empty(),o&&i.append(n("<img />").attr("src",t)),"reblog"!==this.model.get("mode")&&(o?this.model.unset("remove_thumbnail"):this.model.set("remove_thumbnail",!0))},_onUrlClientEvent:function(e){this.get("ogFetchPending")&&"keydown"===e.type&&27===e.keyCode&&(this._cancelOpenGraphFetch(),e.stopPropagation(),e.preventDefault())},_onUrlEditorChange:function(){var e=this.url.getEditorValue(),t=this._normalizeUrl(e);s.isEmpty(t)||t===this.model.get("url")||this.model.set("url",t)},_onPaste:function(e){var t,i;s.isEmpty(this.url.getEditorValue())&&(t=e.getData("text/plain"),i=this._normalizeUrl(t),s.isEmpty(i)||this.model.set("url",i))},_shouldShowThumbnail:function(e){var t=this.getMinFullWidthSize(g.getExtension(e.src));return s.isNumber(t)&&s.has(e,"width")&&e.width>=t},_onChangeFetchPending:function(e,t){this.model.set("loading",t)},setPostData:function(e){e=e||{},s.has(e,"title")&&this.title.setEditorValue(e.title),s.has(e,"excerpt")&&this.excerpt.setEditorValue(e.excerpt),s.has(e,"thumbnail")&&this.model.set("thumbnail",e.thumbnail),s.has(e,"author")&&this.model.set("author",e.author),s.has(e,"tags")&&(s.each(e.tags,function(e){this.tagEditor.addTag(e.toLowerCase())},this),s.isEmpty(e.tags)||this.tagEditor.removePlaceholder())},_normalizeUrl:function(e){return s.isString(e)?(e=e.trim(),e=g.addProtocolIfMissing(e,"http:"),p.isUrl(e)?e:null):null},_onChangeUrl:function(e,t){this.get("ogFetchPending")||p.isUrl(t)&&(this.set("ogFetchPending",!0),this._ogService.fetchOpenGraphData(t).then(s.bind(this._updateWithGraphInfo,this),s.bind(this._onOpenGraphFail,this)))},_onChangeShortUrl:function(e,t){if(p.isUrl(t))try{var i,n=g.parseUrl(t);n&&s.has(n,"host")&&(i=n.host.replace(/^www\./i,""),this.js$("publisher").attr("href",t).text(i))}catch(o){}},_onChangeAuthor:function(e,t){var i=s.isEmpty(t)?"":o("By %1$s",t);this.js$("author").text(i).toggle(!s.isEmpty(t))},_onTagInputChange:function(e,t){t&&this.set("hasCustomTags",!0)},_updateWithGraphInfo:function(e){var t=e.image,i=function(t){var i,n={title:e.title,excerpt:e.description,author:e.author,thumbnail:t?"":e.image};!this.get("hasCustomTags")&&s.has(e,"tags")&&(i=this._parseOpenGraphTags(e.tags),s.extend(n,{tags:i.slice(0,this.get("numOgTags"))})),this.setPostData(n),this.set({hasMedia:!0,showCaption:!0,ogFetchPending:!1}),this.delayedFocus(this.caption)};s.isEmpty(t)?i.call(this,!1):m.load(t).then(s.bind(function(e){i.call(this,!this._shouldShowThumbnail(e))},this),s.bind(function(){i.call(this,!0)},this))},_onOpenGraphFail:function(){this.set({hasMedia:!0,showCaption:!0,ogFetchPending:!1}),this.delayedFocus(this.caption)},_cancelOpenGraphFetch:function(){this._ogService.abort()},_parseOpenGraphTags:function(e){return e=s.isString(e)?e.split(","):e,s.isArray(e)?e:[]},_onRemoveClick:function(){this.model.get("thumbnail")?this.removeThumbnail():this.removeMedia()},_onChangeHasMedia:function(e,t){this.$el.toggleClass("has-media",t),this.js$("media").toggle(t),this.url.$el.toggle(!t),this.removeButton.$el.toggle(t&&this.model.canEditMedia())},_onChangeShowCaption:function(e,t){this.set("hideControlsLine",!t),this.js$("caption").toggle(t)},_hideEmptyFields:function(){this.title.$el.toggle(!s.isEmpty(this.model.get("title"))),this.excerpt.$el.toggle(!s.isEmpty(this.model.get("excerpt")))}});e.exports=f},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="media-wrapper"><div class="media-container link-media-container"><div class="link-editor"><div data-subview="url"></div><section class="link-media-body" data-js-media><div class="thumbnail" data-js-image data-js-removable="false"></div><article data-js-article data-js-removable="true"><div class="publisher-container"><a href="#" data-js-publisher target="_blank" rel="bookmark" class="publisher"></a></div><div data-subview="title"></div><div data-subview="excerpt"></div><div data-js-author class="author"></div></article></section></div> ',canEditMedia&&(__p+=' <div data-subview="removeButton"></div> '),__p+=' </div></div><div class="caption-wrapper" data-js-caption><div data-subview="reblogTree"></div><div data-subview="caption"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(145),r=o.extend({fetchOpenGraphData:function(e){var t=s.ajax({url:"/svc/post/fetch_og",type:"POST",with_form_key:!0,data:{url:e}});return this.xhr=t,t.then(function(e){var t=s.parseJSON(e)||{};return t.response}).always(n.bind(function(){this.xhr=null},this))},abort:function(){this.xhr&&this.xhr.abort()}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(182),r=i(340),a=i(220),l=i(356),c=i(478),u=r.extend({defaults:n.defaults({fontSizes:["extra_large","large","medium","small"]},r.prototype.defaults),template:c,afterInitialize:function(){this.listenTo(this.model,"change:quote",this.updateQuoteSize),this.wrapSource()},createSubViews:function(){var e=this.subViewOptions(),t=n.extend({className:"quote-field",name:"quote",placeholder:"&ldquo;"+s("Quote")+"&rdquo;",ariaLabel:s("Quote")},e),i=n.extend({className:"source-field",name:"source",placeholder:s("Source"),ariaLabel:s("Source")},e);n.extend(i,{fullWidthInlineMedia:!1}),this.quote=this.subViews.quote=new a(t),this.source=this.subViews.source=new l(i)},afterRender:function(){return this.renderSubViews(),this.updateQuoteSize(this.model,this.model.get("quote")||""),n.isEmpty(this.model.get("source"))?this.delayedFocus(this.quote):this.delayedFocus(this.source),this.quote.editor.isEmpty()&&this.quote.editor.setData(""),this.cleanQuote(),this},teardown:function(){return this.$el.empty(),this},updateQuoteSize:function(e,t){if("string"==typeof t){var i=t.length;20>i?this._setQuoteSize("extra_large"):81>i?this._setQuoteSize("large"):300>i?this._setQuoteSize("medium"):this._setQuoteSize("small")}},_setQuoteSize:function(e){var t=this.quote.$el;t.hasClass(e)||(t.removeClass(this.get("fontSizes").join(" ")),t.addClass(e))},cleanQuote:function(){var e=this.model.get("quote");e&&this.model.set("quote",o.stripHtml(e,!1))},getRichTextEditor:function(){return this.source},wrapSource:function(){var e=this.model.get("source");!e||e.indexOf("<p>")>-1||this.model.set("source","<p>"+e+"</p>")}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="quote"></div><div data-subview="source"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(101),r=i(340),a=i(221).SelectionPersistence,l=i(220),c=i(480),u=/^([^(:|\n)]+:)/,h=r.extend({template:c,placeholders:["%1$sFirefighter:%2$s That's the way the cookie crumbles.%3$s%1$sButler:%2$s It falls on me to reassemble the cookie.","%1$sStockbroker:%2$s I need a vacation.%3$s%1$sTourist:%2$s I'm already on one.%3$s%1$sStockbroker:%2$s Get out of my office.","%1$sAbbott:%2$s Who is the man on first base?%3$s%1$sCostello:%2$s That's what I'm telling you!%3$s%1$sAbbott:%2$s I'm unqualified to manage a baseball team.","%1$sRick:%2$s Our problems don't amount to a hill of beans in this crazy world.%3$s%1$sIlsa:%2$s Great, now I'm hungry for beans.","%1$sAlbert Einstein:%2$s Energy equals mass times the speed of light squared.%3$s%1$sCop:%2$s Tell it to the judge.","%1$sAxl:%2$s Welcome to the jungle.%3$s%1$sCustomer:%2$s We'd like a table for two, please.%3$s%1$sAxl:%2$s Your table is right this way.","%1$sTourist:%2$s Could you give us directions to Olive Garden?%3$s%1$sNew Yorker:%2$s No, but I could give you directions to an actual Italian restaurant.","%1$sPangloss:%2$s Could you give me directions to the Olive Garden?%3$s%1$sCandide:%2$s No, but we can cultivate our own garden.%3$s%1$sPangloss:%2$s That sounds rational to me.","%1$sCharles Dickens:%2$s It was the best of mimes, it was the worst of mimes.%3$s%1$sMime:%2$s ...","%1$sJuliet:%2$s Romeo, Romeo, wherefore art thou, Romeo?%3$s%1$sRomeo:%2$s I'm right here, Juliet.?%3$s%1$sJuliet:%2$s Wherefore means why not where.%3$s%1$sRomeo:%2$s Misunderstandings like these are what define our relationship.","%1$sSeal:%2$s Did you know that when it snows my eyes become larger?%3$s%1$sOptometrist:%2$s That's highly abnormal. I'm going to refer you to a specialist.%3$s%1$sSeal:%2$s BABAAAAAAAYYYY!","%1$sSeal:%2$s There's so much a man can tell you, so much he can say.%3$s%1$sMan:%2$s I've just been waiting for someone to ask!","%1$sUsher:%2$s These are my confessions.%3$s%1$sTheater-goer:%2$s These are my tickets.%3$s%1$sUsher:%2$s Right this way."],afterInitialize:function(){this.user.get("language")&&"en_US"!==this.user.get("language")&&(this._placeholders=n.filter(this.placeholders,function(e){return o(e)!==e}),n.isEmpty(this._placeholders)&&(this._placeholders=this.placeholders))},randomPlaceholder:function(){var e=n.sample(this._placeholders||this.placeholders);return o(e,"<b>","</b>","<br>")},createSubViews:function(){var e=this.subViewOptions(),t=n.extend({className:"title-field",name:"title",isResizable:!0,placeholder:o("Title"),ariaLabel:o("Post title"),allowLinebreaks:!1},e),i=n.extend({className:"chat-field normal",name:"chat",placeholder:this.randomPlaceholder(),onChange:n.bind(function(e){this.formatText()},this),ariaLabel:o("Post body"),convertNewlinesToLinebreaks:!0},e);this.title=this.subViews.title=new l(t),this.chat=this.subViews.chat=new l(i),this.registerTitleKeyboardShortcut(this.title)},afterRender:function(){this.renderSubViews(),this.model.get("chat")&&this.formatText(),this.delayedFocus(this.chat)},formatText:function(){this.chat.getEditorValue()&&this.formatTextNode(this.chat.editor.element)},formatTextNode:function(e){if(e){if(e.nodeType!==Node.TEXT_NODE)return void n.each(e.childNodes,n.bind(function(e){this.formatTextNode(e)},this));if(this.stripZeroWidthSpaceFromNode(e),"B"===e.parentNode.tagName)return void this.cleanBoldNode(e.parentNode);if(!(s(e).prev().length>0&&"BR"!==s(e).prev()[0].tagName)){var t=e.nodeValue.match(u);if(t){var i=a.saveSelection(this.chat.editor.element),o=e.parentNode;if(n.isObject(o)){var r=t[0];e.nodeValue=e.nodeValue.replace(u,"");var l=document.createElement("b");l.innerHTML=r,o.insertBefore(l,e)}a.restoreSelection(i)}}}},cleanBoldNode:function(e){if("B"===e.tagName)if(e.childNodes.length>1)for(;e.childNodes.length>1&&e.innerHTML.match(/<br\s*[\/]?>/);)e.parentNode.insertBefore(e.firstChild,e);else{var t=e.firstChild;if(-1===t.nodeValue.indexOf(":"))return void this.unwrapNode(e);var i=/:(.+)$/,n=t.nodeValue.match(i);if(n){var s=a.saveSelection(this.chat.editor.element),o=n[1],r=document.createTextNode(o);t.nodeValue=t.nodeValue.replace(/:(.+)$/,":"),e.parentNode.insertBefore(r,e.nextSibling),a.restoreSelection(s)}}},unwrapNode:function(e){var t=a.saveSelection(this.chat.editor.element),i=e.parentNode,n=e.firstChild,s=n.nodeValue;s&&(i.insertBefore(n,e.nextSibling),i.normalize()),e.remove(),this.formatTextNode(i),a.restoreSelection(t)},stripZeroWidthSpaceFromNode:function(e){var t=/\u200B/g;if(e&&e.nodeType===Node.TEXT_NODE&&e.nodeValue.match(t)){var i=a.saveSelection(this.chat.editor.element);e.nodeValue=e.nodeValue.replace(t,""),Math.max(i.start,i.end)>e.nodeValue.length&&(i.start=i.end=e.nodeValue.length),a.restoreSelection(i)}}});e.exports=h},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="title"></div><div data-subview="chat"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(340),o=i(101),r=(i(103),i(482)),a=i(220),l=i(483),c=i(485),u=i(487),h=i(494),d=i(356),p=i(342),g=i(496),m=i(143),f=s.extend({defaults:n.defaults({maxSearchResults:4,showSearchField:!0,showAudioUploader:!0,showSearchResultList:!1,showCopyrightWarning:!1,hasMediaView:!0,hasMedia:!1,showTos:!1,showCaption:!1},s.prototype.defaults),template:r,afterInitialize:function(){this.searchService=new g,(this.post.get("url")||"new"!==this.post.get("mode"))&&this.set({hasMedia:!0,showCaption:!0,showSearchField:!1,showAudioUploader:!1,showSearchResultList:!1,showCopyrightWarning:!1})},createSubViews:function(){var e=this.subViewOptions(),t=n.extend({className:"audio-search-field",placeholder:o("Search for a song or paste a URL"),ariaLabel:o("Search for a song or paste a URL"),name:"search",forceSingleLine:!0,onClientEvent:n.bind(this.handleSearchMenuKeys,this)},e),i=n.extend({},e),s={className:"audio-search-results-field"},r=n.extend({url:this.post.get("url"),service:this.post.get("service"),albumArt:this.post.get("albumArt"),canEditMedia:this.post.canEditMedia()},e);this.post.get("bandcamp")&&n.extend(r,this.post.get("bandcamp"));var g=n.extend({},e),m=n.extend({className:"caption-field",name:"caption",placeholder:o("Add a description, if you like"),ariaLabel:o("Description")},e),f=n.extend({isRemovable:!0},e);this.searchField=this.subViews.searchField=new a(t),this.audioUploader=this.subViews.audioUploader=new c(i),this.searchResultList=this.subViews.searchResultList=new l(s),this.mediaPreview=this.subViews.mediaPreview=new u(r),this.confirmTos=this.subViews.confirmTos=new h(g),this.caption=this.subViews.caption=new d(m),this.post.isReblog()&&(this.reblogTree=this.subViews.reblogTree=new p(f))},addStateListeners:function(){this.listenTo(this.audioUploader,"upload:start",this._onFileUploadStart),this.listenTo(this.audioUploader,"upload:complete",this._onFileUploadComplete),this.listenTo(this.audioUploader,"upload:error upload:invalid",this._onFileUploadError),this.searchResultList.listenTo(this.searchService,"searchResults:fetched",this.searchResultList.updateResultsForService),this.listenTo(this.searchService,"audioEmbedData:fetched",this._onAudioEmbedDataFetched),this.searchResultList.listenTo(this.searchField,"searchField:menuKey",this.searchResultList.handleMenuCommand),this.listenTo(this.searchResultList,"searchResults:updated",function(e){var t=n.isEmpty(this.post.get("url"))&&e>0;this.set("showSearchResultList",t)}),this.listenTo(this.searchResultList,"searchResults:selectAudio",this.setAudioContentFromUrl),this.listenTo(this.searchResultList,"searchResults:selectVideo",this.switchToVideoPost),this.listenTo(this.searchResultList,"searchResults:clear",function(){this.set("showCopyrightWarning",!1),this.post.unset("copyrightFallback")}),this.searchField.listenTo(this.searchResultList,"searchResults:clear",function(){this.setEditorValue(""),this.focus()}),this.listenTo(this.mediaPreview,"media:ready",function(){var e=n.toArray(arguments);e.unshift("media:ready"),this.trigger.apply(this,e)}),this.post.canEditMedia()&&this.listenTo(this.mediaPreview,"media:remove",this.removeMedia),this.listenTo(this.post,"change:search",n.debounce(this._onChangeSearchInput,200)),this.listenTo(this,"change:showSearchField",this._onChangeShowSearchField),this.listenTo(this,"change:showAudioUploader",this._onChangeShowAudioUploader),this.listenTo(this,"change:showSearchResultList",this._onChangeShowSearchResultList),this.listenTo(this,"change:hasMedia",this._onChangeHasMedia),this.listenTo(this,"change:showTos",this._onChangeShowTos),this.listenTo(this,"change:showCaption",this._onChangeShowCaption),this.listenTo(this,"change:showCopyrightWarning",this._onChangeShowCopyrightWarning)},removeMedia:function(){this.searchResultList.hasResults()||this.searchField.setEditorValue(""),this.post.softReset();var e=n.isEmpty(this.post.get("search"));this.set({hasMedia:!1,showSearchField:!0,showSearchResultList:!e,showAudioUploader:e,showTos:!1}),this.mediaPreview.set({url:"",service:""}),this.js$("confirmTos").attr("checked",!!this.post.get("confirmTos")),n.isEmpty(this.post.get("caption"))&&n.isEmpty(this.post.get("tags"))&&this.set("showCaption",!1),this.searchField.focus()},_onChangeShowSearchField:function(e,t){this.searchField.$el.css({display:t?"block":"none",opacity:t?1:0})},_onChangeShowAudioUploader:function(e,t){this.audioUploader.$el.css({display:t?"block":"none",opacity:t?1:0})},_onChangeShowSearchResultList:function(e,t){this.searchResultList.$el.css({display:t?"block":"none",opacity:t?1:0})},_onChangeShowCopyrightWarning:function(e,t){this.searchResultList.set("showCopyrightWarning",t)},_onChangeHasMedia:function(e,t){this.isRendered()&&(t?this.mediaPreview.$el.css({display:"block",opacity:1}):this.mediaPreview.$el.css({display:"none",opacity:0}))},_onChangeShowTos:function(e,t){this.isRendered()&&(t?this.js$("tos").css({display:"block",opacity:1}):this.js$("tos").css({display:"none",opacity:0}))},_onChangeShowCaption:function(e,t){this.isRendered()&&(t?this.js$("caption").css({display:"block",opacity:1}):this.js$("caption").css({display:"none",opacity:0}))},setAudioContent:function(e,t,i){n.isObject(e)&&(i=e,e=""),i=n.extend({preuploadUrl:"",url:(e||"").replace(/\u200B/g,""),service:t},i),("bandcamp"!==t||i.id&&i.type)&&(this.mediaPreview.set(i),this.post.set(n.pick(i,["url","preuploadUrl","service","albumArt","preuploadAlbumArt","trackTitle","trackArtist","trackAlbum"])))},setAudioContentFromUrl:function(e,t,i){t||(t=this.searchService.getServiceByUrl(e)),i||(i={}),this.setAudioContent(e,t,i),this.set({hasMedia:!0,showCaption:!0,showSearchField:!1,showSearchResultList:!1,showAudioUploader:!1,showTos:!n.isEmpty(i.preuploadUrl)}),this.caption.focus()},_onChangeSearchInput:function(e,t){t||(t="");var i=n.isEmpty(t)?!1:this.searchService.getServiceByUrl(t);if(i)"direct"===i?this.setAudioContentFromUrl(t,i):this.searchService.getData(t,i),this.post.unset("search");else if(n.isEmpty(t))this.searchResultList.reset(),this.set("showAudioUploader",this.get("showSearchField"));else{if(this.set("showAudioUploader",!1),this.get("showCopyrightWarning")){if(t===this.post.get("copyrightFallback"))return;this.set("showCopyrightWarning",!1),this.post.unset("copyrightFallback"),this.searchResultList.reset()}this._executeAudioSearches(t)}},_executeAudioSearches:function(e,t,i){t=n.isArray(t)?t:this.searchService.searchServices,n.forEach(t,function(t){this.searchService.search(t,e,i)},this)},_onAudioEmbedDataFetched:function(e,t,i){n.isObject(e)&&(i=e,e=i.url),this.setAudioContentFromUrl(e,t,i)},handleSearchMenuKeys:function(e){var t,i=["keyup","keydown"],n={13:"confirm",38:"cycleUp",40:"cycleDown"};return e=e||window.event,-1!==i.indexOf(e.type)&&(t=e.which||e.keyCode,t in n)?("keydown"===e.type&&13===t&&e.stopImmediatePropagation(),this.searchResultList.isRendered()&&"keyup"!==e.type&&(this.searchField.trigger("searchField:menuKey",n[t]),e.preventDefault()),!1):void 0},_onFileUploadStart:function(e){this.uploads.add(e)},_onFileUploadComplete:function(e){var t={preuploadUrl:e.get("url")},i=e.get("album_art_url");i&&(t.preuploadAlbumArt=!0,t.albumArt=i);var s=e.get("id3");n.isObject(s)&&(t.trackTitle=s.Title,t.trackArtist=s.Artist,t.trackAlbum=s.Album),this.setAudioContentFromUrl(t.preuploadUrl,"direct",t)},_onFileUploadError:function(e){var t=e.get("responseJSON");if(t){var i=parseInt(n.get(t,"meta.status"),10),s=n.get(t,"response.is_copyright");if(403===i&&s)return void this.uploadFailedCopyright(n.get(t,"response"))}var r=e.get("error")||o("Error uploading audio");n.isArray(r)&&(r=r.join("</p><p>")),m.alert("<p>"+r+"</p>")},afterRender:function(){this.renderSubViews(),n.forEach({showSearchField:this.searchField,showAudioUploader:this.audioUploader,showSearchResultList:this.searchResultList,hasMedia:this.mediaPreview},function(e,t){this.get(t)||e.$el.css({display:"none",opacity:0})},this),this.get("showTos")||this.js$("tos").css({display:"none",opacity:0}),this.get("showCaption")?this.delayedFocus(this.caption):(this.delayedFocus(this.searchField),this.js$("caption").css({display:"none",opacity:0}))},uploadFailedCopyright:function(e){var t="new"===this.post.get("mode")?["spotify","soundcloud","youtube"]:["spotify","soundcloud"],i={maxResults:3};this.searchResultList.setCopyrightWarningMessage(e.message),this.set({showCopyrightWarning:!0,showAudioUploader:!1}),this.subViews.searchField.setEditorValue(e.search_string),this.post.set("copyrightFallback",e.search_string),this._executeAudioSearches(e.search_string,t,i),this.searchField.focus()},switchToVideoPost:function(e){var t={postParams:{type:"video",copyrightFallback:this.post.get("copyrightFallback")},afterReload:function(t){t.postTypeForm.executeUrlParser(e)}};this.trigger("switchPostType","video",t)},getRichTextEditor:function(){return this.caption}});e.exports=f},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="media-wrapper" data-js-media><div data-subview="mediaPreview"></div><div data-js-mediacomposer class="audio-search-container"><div data-subview="searchField"></div><div data-subview="audioUploader"></div><div data-subview="searchResultList"></div></div></div><div class="caption-wrapper" data-js-tos><div data-subview="confirmTos"></div></div><div class="caption-wrapper" data-js-caption><div data-subview="reblogTree"></div><div data-subview="caption"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(160),a=i(204),l=i(484),c=o.extend({defaults:{currentChoice:-1,serviceResults:{},showCopyrightWarning:!1},events:{"click .clear-results":"clearResults","click .result":"_clickedChoice","mouseover .result":"resetCurrentChoice"},mixins:[r,a],template:l,initialize:function(){this.listenTo(this,"change:serviceResults",function(e){e.trigger("searchResults:updated",e._getResultCount())}),this.listenTo(this,"change:currentChoice",this._styleResults)},updateResultsForService:function(e){var t=this.get("serviceResults"),i=n.clone(t);i[e.service]=e.tracks,this.set("serviceResults",i),!1===n.isEqual(t,e)&&(this.resetCurrentChoice(),this.teardown(),this.render())},handleMenuCommand:function(e){var t=s(".result",this.$el),i=this.get("currentChoice");if("confirm"===e){if(-1!==i){var n=s(t[this.get("currentChoice")]),o=n.attr("data-href"),r=n.hasClass("audio-result")?"searchResults:selectAudio":"searchResults:selectVideo";this.trigger(r,o)}}else{var a="cycleUp"===e?-1:1,l=(this.get("currentChoice")+a+t.length)%t.length;this.set("currentChoice",l)}},render:function(){var e=n.extend(n.pick(this.attributes,"serviceResults"),{resultCount:this._getResultCount(),copyrightWarningMessage:this.get("copyrightWarningMessage")||"",showCopyrightWarning:!!this.get("showCopyrightWarning")});return this.$el.html(this.template(e)),this},teardown:function(){return this.$el.empty(),this},reset:function(){this.set("serviceResults",{})},resetCurrentChoice:function(){this.set("currentChoice",-1)},clearResults:function(){this.trigger("searchResults:clear")},hasResults:function(){return this._getResultCount()>0},setCopyrightWarningMessage:function(e){this.set("copyrightWarningMessage",e)},_clickedChoice:function(e){var t=s(e.currentTarget).attr("data-href"),i=e.currentTarget.classList.contains("audio-result")?"searchResults:selectAudio":"searchResults:selectVideo";this.trigger(i,t)},_getResultCount:function(){return n.reduce(this.get("serviceResults"),function(e,t){return e+(n.isArray(t)?t.length:0)},0)},_styleResults:function(e,t){n.each(s(".result",e.$el),function(e,i){s(e).toggleClass("cycled",i===t)})}});e.exports=c},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="clear-results icon_close '+(null==(__t=0===resultCount?"inactive":"")?"":_.escape(__t))+'"></div><div class="copyright-warning '+(null==(__t=showCopyrightWarning===!1?"inactive":"")?"":_.escape(__t))+'">'+(null==(__t=copyrightWarningMessage)?"":__t)+"</div> ",_.each(serviceResults,function(e,t){__p+=' <div class="audio-result-set" data-service="'+(null==(__t=t)?"":__t)+'"> ',_.each(e,function(e){__p+=' <div class="result '+(null==(__t="youtube"===t?"video-result":"audio-result")?"":_.escape(__t))+'" data-href="'+(null==(__t=e.href)?"":__t)+'"><span class="primary">'+(null==(__t=e.primary)?"":_.escape(__t))+'</span><span class="secondary">'+(null==(__t=e.secondary)?"":_.escape(__t))+'</span><span class="info">'+(null==(__t=e.info)?"":_.escape(__t))+"</span></div> "}),__p+=" </div> "}),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(486),r=i(469),a=r.extend({className:"audio-direct-upload-button",defaultOptions:n.defaults({enableUrl:!1,dropzoneText:"",uploadIcon:"dropzone-add-audio-icon",uploadText:"",uploadOptions:{name:"audio",mediaType:"audio",maxUploadSize:10485760,uploadPattern:s.browser.mozilla?/^audio\/(?:.*)$/i:/^(?:audio\/mp3|audio\/mpeg)$/i,accept:"audio/mp3",url:"/svc/post/upload_audio"}},r.prototype.defaultOptions),template:o});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="media-dropzone" data-js-dropzone><div class="media-upload-button" data-js-mediaupload><div class="v-center-outer"><div class="v-center-inner"><div class="dropzone-icon '+(null==(__t=uploadIcon)?"":_.escape(__t))+'"></div></div></div><div class="media-upload"><div data-subview="upload"></div></div></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(435),o=i(488),r=i(490),a=i(344),l=i(492),c=i(493),u=s.extend({className:"audio-media-container media-container",defaults:n.defaults({url:"",service:"",albumArt:"",type:"",id:""},s.prototype.defaults),events:{mouseenter:"_onHoverRemoveButton",mouseleave:"_onHoverRemoveButton"},template:c,beforeTeardown:function(){return delete this.audioPlayer,this.$el.removeClass(this.post.get("service")),this.$el.empty(),this},_onHoverRemoveButton:function(e){var t="mouseover"===e.type||"mouseenter"===e.type;this.js$("removeButton").toggleClass("active",t)},beforeRender:function(){this.removeButton=this.subViews.removeButton=new a({onClick:n.bind(function(){this.trigger("media:remove",this)},this),buttonClass:"top-right"}),this.$el.addClass(this.post.get("service")),"direct"===this.post.get("service")&&(this.post.canEditMedia()&&(this.id3Editor=this.subViews.id3Editor=new o(this.options),this.albumArtUploader=this.subViews.albumArtUploader=new r(n.defaults({url:this.post.get("albumArt")||""},this.options))),this.audioPlayer=this.subViews.audioPlayer=new l({extra_classes:null,post_id:"",service:"upload",lightbox:!1,preview:this.post.canEditMedia(),cover:this.post.get("albumArt"),tracks:[{stream_url:this.post.get("url"),cover:this.post.get("albumArt"),track:this.post.get("trackTitle"),artist:this.post.get("trackArtist"),album:this.post.get("trackAlbum")}]}))},afterRender:function(){this.listenTo(this.post,"change:url change:service",function(e){this.$el.removeClass(e.previous("service")),this.teardown().render()}),this.renderSubViews(),this.trigger("media:ready",this)}});e.exports=u},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(101),a=i(489),l=o.extend({className:"id3-editor",events:{"input .id3-editor--input":"_onChangeInput","change .id3-editor--input":"_onChangeInput"},template:a,initialize:function(e){this.options=e=n.extend({},e),n.extend(this,n.pick(e,["post","user"]))},_onChangeInput:function(e){var t=s(e.currentTarget);this.post.set(t.attr("name"),t.val())},serialize:function(){var e={id3Fields:n.pick(this.post.toJSON(),"trackTitle","trackArtist","trackAlbum"),id3FieldLabel:{trackTitle:r("Track"),trackArtist:r("Artist"),trackAlbum:r("Album")}};return e},render:function(){return this.$el.html(this.template(this.serialize())),this}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="",_.forEach(id3Fields,function(e,t){__p+=' <div class="id3-editor--container '+(null==(__t=id3FieldLabel[t]?"id3-editor--"+id3FieldLabel[t].toLowerCase():"")?"":_.escape(__t))+'"><input name="'+(null==(__t=t)?"":_.escape(__t))+'" value="'+(null==(__t=e)?"":_.escape(__t))+'" class="id3-editor--input" type="text"><label class="id3-editor--label">'+(null==(__t=id3FieldLabel[t]||__(_.capitalize(t)))?"":_.escape(__t))+"</label></div> "}),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(491),r=i(469),a=r.extend({className:"media-dropzone-container album-art-uploader",defaultOptions:n.defaults({enableUrl:!1,uploadOptions:{name:"album_art",maxUploadSize:10485760,uploadPattern:/^image\/(?:.*)$/i,accept:"image/*",url:"/svc/post/upload_album_art"}},r.prototype.defaultOptions),initialize:function(e){return n.defaults(this.defaultOptions,{dropzoneText:s("Select album art"),uploadText:s("Select album art")}),r.prototype.initialize.apply(this,arguments)},template:o,events:n.extend({"click [data-js-removeButton]":"_onClickRemoveButton"},r.prototype.events),_onClickRemoveButton:function(){this.set("url","")},_onUploadUrlChange:function(e,t){this.set("url",t)},_onUrlChange:function(e,t){this.model.set({preuploadAlbumArt:!n.isEmpty(t),albumArt:t}),this.js$("albumArt").css("background-image",t?"url("+t+")":""),this.$el.toggleClass("can-upload-album-art",n.isEmpty(t))},afterRender:function(){this.listenTo(this.upload,"change:url",this._onUploadUrlChange),this.listenTo(this,"change:url",this._onUrlChange),this.$el.toggleClass("can-upload-album-art",n.isEmpty(this.get("url"))),r.prototype.afterRender.apply(this,arguments)}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="album-art--container"><div data-js-albumart class="album-art" style="'+(null==(__t=url?"background-image:url("+url+");":"")?"":_.escape(__t))+'"></div><div data-js-removebutton class="album-art--remove-button"><div class="v-center-outer"><div class="v-center-inner"><span data-js-removebuttontext>'+(null==(__t=__("Remove image"))?"":_.escape(__t))+'</span></div></div></div></div><div data-js-dropzone class="media-dropzone"><div data-js-mediaupload class="media-upload-button"><div class="v-center-outer"><div class="v-center-inner"><div class="dropzone-title"><span data-js-mediauploadtext class="dropzone-text">'+(null==(__t=dropzoneText)?"":_.escape(__t))+'</span></div></div></div><div class="media-upload"><div data-subview="upload"></div></div></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(204),r=n.get(window,"Tumblr.AudioPlayer"),a=s.extend({mixins:[o],initialize:function(e){this.options=n.extend({},e);
},teardown:function(){return this.audioPlayer.unbind_events(),this.$el.empty(),delete this.audioPlayer,this},render:function(){r||(r=n.get(window,"Tumblr.AudioPlayer"));var e=n.defaults({replace:null,append_to:null,prepend_to:this.$el},this.options);return this.audioPlayer=new r(e),this.options.preview&&this.audioPlayer.$container.addClass("has_art"),this.$el.toggleClass("audio-player--preview-player",this.options.preview),this}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="","spotify"===service&&(__p+=' <iframe data-js-audioembed src="https://embed.spotify.com/?uri='+(null==(__t=encodeURIComponent(url))?"":_.escape(__t))+'&amp;view=coverart" width="500" height="580" frameborder="0" allowtransparency="true" scrolling="no" class="audio-embed--spotify"></iframe> '),__p+=" ","soundcloud"===service&&(__p+=' <iframe data-js-audioembed src="https://w.soundcloud.com/player/?url='+(null==(__t=encodeURIComponent(url))?"":_.escape(__t))+'&amp;visual=true&amp;liking=false&amp;sharing=false&amp;auto_play=false&amp;show_comments=false&amp;continuous_play=false&amp;origin=tumblr" frameborder="0" allowtransparency="true" scrolling="no" width="500" height="500" class="audio-embed--soundcloud"></iframe> '),__p+=" ","bandcamp"===service&&(__p+=' <iframe data-js-audioembed src="https://bandcamp.com/EmbeddedPlayer/size=medium/bgcol=ffffff/linkcol=0687f5/notracklist=true/transparent=true/'+(null==(__t=type)?"":_.escape(__t))+"="+(null==(__t=id)?"":_.escape(__t))+'/" frameborder="0" allowtransparency="true" scrolling="no" width="500" height="120" class="audio-embed--bandcamp"></iframe> '),__p+=" ","direct"===service&&(__p+=' <div data-js-audioembed class="audio-embed--direct '+(null==(__t=canEditMedia?"audio-embed--direct-editable":"")?"":_.escape(__t))+'"><div data-subview="audioPlayer"></div><div data-subview="id3Editor"></div><div data-subview="albumArtUploader"></div></div> '),__p+=" ",canEditMedia&&(__p+=' <div data-subview="removeButton"></div> '),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(204),a=i(205),l=i(160),c=i(495),u=o.extend({className:"confirm-tos",events:{"change [data-js-confirmTos]":"_onChangeConfirmTos","click [data-js-confirmTosText]":"_onClickConfirmTosText"},mixins:[r,a,l],template:c,initialize:function(e){this.options=e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),this.user=e.user,this.post=e.post},_onChangeConfirmTos:function(e){this.post.set("confirmTos",s(e.currentTarget).is(":checked"))},_onClickConfirmTosText:function(){this.js$("confirmTos").trigger("click")},serialize:function(){return{confirmTos:this.post.get("confirmTos")}},render:function(){return this.$el.html(this.template(this.serialize())),this.js$("confirmTos").attr("checked",!!this.post.get("confirmTos")),this},teardown:function(){return this.$el.empty(),this}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<label class="binary_switch"><input class="confirm-tos--checkbox" type="checkbox" name="confirm_tos" data-js-confirmtos> <span class="binary_switch_track"></span><span class="binary_switch_button"></span></label><span class="confirm-tos--text" data-js-confirmtostext>'+(null==(__t=__("This is my original work, or I %1$shave permission%2$s to post this.",'<a href="/terms-of-service" target="_blank">',"</a>"))?"":__t)+"</span>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(7),r=function(){var e=4,t=["spotify","soundcloud","bandcamp"],i=["spotify","soundcloud"],r={},a=[],l=10,c={normalizeResults:function(e,t,i){var s={service:e};switch(e){case"spotify":return n.extend(s,{tracks:n.map(n.take(t.tracks.items,i),function(e){return{primary:e.name,secondary:n.first(e.artists).name,info:e.album.name,href:e.uri,id:e.uri}})});case"soundcloud":return n.extend(s,{tracks:n.map(n.take(t,i),function(e){return{primary:e.title,secondary:e.user.username,info:null,href:e.permalink_url,id:e.id}})});case"youtube":return n.extend(s,{tracks:n.map(n.take(t.items,i),function(e){return{primary:e.snippet.title,secondary:e.snippet.channelTitle,info:null,href:"https://www.youtube.com/watch?v="+e.id.videoId,id:e.id.videoId}})});default:throw"Invalid service: "+e}},getServiceByUrl:function(e){var t={spotify:/(open\.spotify\.com|spotify)[\/|:](track|album|artist|playlist|user)[\/|:](.*)?([\d\w]{22})$/,soundcloud:/(http|https):\/\/soundcloud\.com\/[^\/]+\/(sets\/)?[^\/]+\/?(\?.*)?$/,bandcamp:/(http|https):\/\/(?:([^\/]+\.)\.bandcamp\.com|[^\/]+\.[^\/]+)\/(track|album)\/[^\/]+$/,direct:/[.](mp3)$/i};for(var i in t)if(t[i].test(e))return i;return!1},getData:function(e,i){if(!n.contains(t,i))return!1;if(e in r){var o=r[e];this._notifyOnDataLookup(e,i,o.data,o.isOK)}else{if("spotify"!==i||!e.match(new RegExp(/[\/:]playlist[\/:]/))){var a=s.ajax({url:"/svc/post/get_"+i+"_data",type:"POST",with_form_key:!0,data:{url:e,service:i}});return a.then(n.bind(function(t){t&&!t.error?this._notifyOnDataLookup(e,i,t,!0):this._notifyOnDataLookup(e,i,t,!1)},this),n.bind(function(t){this._notifyOnDataLookup(e,i,t,!1)},this))}this._notifyOnDataLookup(e,i,{},!0)}},_notifyOnDataLookup:function(e,t,i,n){var s=n?"audioEmbedData:fetched":"audioEmbedData:error";this.trigger(s,e,t,i,n)},_cacheDataLookupResults:function(e,t,i,s){r[e]={data:i,isOK:s},a.push(e),n.size(r)>l&&(delete r[a[0]],a.shift())},search:function(t,i,o){var r=o&&o.maxResults&&n.isNumber(o.maxResults)?o.maxResults:e,a=s.ajax({url:"/search_audio",type:"POST",with_form_key:!0,data:{q:i,audio_search_provider:t}});return a.then(n.bind(function(e){this.trigger("searchResults:fetched",this.normalizeResults(t,e,r))},this),n.bind(function(e){this.trigger("searchResults:fetched",{service:t,tracks:[]})},this))}};return function(){this.dataServices=t,this.searchServices=i,n.extend(this,o.Events,c),this.listenTo(this,"audioEmbedData:fetched",this._cacheDataLookupResults),this.listenTo(this,"audioEmbedData:error",this._cacheDataLookupResults)}}();e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(10),r=i(340),a=i(143),l=(i(103),i(108)),c=i(101),u=i(282),h=i(198),d=function(){return s.browser.chrome?".mp4,.mov,.wmv,video/*":s.browser.mozilla?"video/*":""}(),p=i(498),g=i(469),m=i(494),f=i(356),v=i(342),_=i(523),b=r.extend({template:_,maxVideoFileSize:104857600,defaults:n.defaults({hasMediaView:!0,hasMedia:!1,showTos:!1,showCaption:!1},r.prototype.defaults),afterInitialize:function(){this._urlParser=n.debounce(n.bind(this._embedCodeParser,this),100),this.post.getEmbedData()&&this.set({hasMedia:!0,showCaption:!0}),this.post.get("copyrightFallback")&&this.set({hasMedia:!0}),this.set("hideControlsLine",!this.get("showCaption"))},createSubViews:function(){var e=this.subViewOptions(),t=n.extend({embed:this.post.getEmbedData(),canEditMedia:this.post.canEditMedia()},e),i=n.extend({url:this.post.get("embedCode"),showInput:!n.isEmpty(this.post.get("embedCode")),embed:this.post.getEmbedData(),uploadIcon:"dropzone-add-video-icon",uploadText:c("Upload a video"),uploadTooltip:function(){var t=1e3*e.user.get("videoSecondsRemaining");return"<p>"+["<strong>"+c("Upload a video")+"</strong>",c("%1$s minutes of video remaining today.",o.utc(t).format("m:ss")),c("%1$s max per file.","100MB")].join("</p><p>")+"</p>"},urlIcon:"dropzone-add-url-icon",urlText:c("Add video from web"),urlPlaceholder:c("Paste a URL or embed code"),urlParser:this._urlParser,uploadOptions:{}},e);n.extend(i.uploadOptions,{name:"video",maxUploadSize:l.bool("ignore_video_upload_limits")?!1:this.maxVideoFileSize,uploadPattern:/^video\/(?:.*)$/i,accept:d,url:"/svc/post/upload_video"});var s=n.extend({},e),r=n.extend({className:"caption-field",name:"caption",placeholder:c("Add a caption, if you like"),ariaLabel:c("Caption")},e),a=n.extend({isRemovable:!0},e);this.mediaPreview=this.subViews.mediaPreview=new p(t),this.mediaComposer=this.subViews.mediaComposer=new g(i),this.confirmTos=this.subViews.confirmTos=new m(s),this.caption=this.subViews.caption=new f(r),this.post.isReblog()&&(this.reblogTree=this.subViews.reblogTree=new v(a))},addStateListeners:function(){this.listenTo(this.mediaComposer,"upload:start",this._onFileUploadStart),this.listenTo(this.mediaComposer,"upload:complete",this._onFileUploadComplete),this.listenTo(this.mediaComposer,"upload:error upload:invalid",this._onFileUploadError),this.listenTo(this.mediaPreview,"media:ready",function(){var e=n.toArray(arguments);e.unshift("media:ready"),this.trigger.apply(this,e)}),this.post.canEditMedia()&&this.listenTo(this.mediaPreview,"media:remove",this.removeMedia),this.listenTo(this,"change:hasMedia",this._onChangeHasMedia),this.listenTo(this,"change:showTos",this._onChangeShowTos),this.listenTo(this,"change:showCaption",this._onChangeShowCaption)},removeMedia:function(){this.post.softReset(),this.set({hasMedia:!1,showTos:!1}),this.mediaPreview.set({file:!1,embed:!1}),this.js$("confirmTos").attr("checked",!!this.post.get("confirmTos")),n.isEmpty(this.post.get("caption"))&&n.isEmpty(this.post.get("tags"))&&this.set("showCaption",!1)},_onChangeHasMedia:function(e,t){this.isRendered()&&(t?(this.mediaComposer.$el.css({display:"none",opacity:0}),this.mediaPreview.$el.css({display:"block",opacity:1})):(this.mediaPreview.$el.css({display:"none",opacity:0}),this.mediaComposer.$el.css({display:"block",opacity:1})))},_onChangeShowTos:function(e,t){this.isRendered()&&(t?this.js$("tos").css({display:"block",opacity:1}):this.js$("tos").css({display:"none",opacity:0}))},_onChangeShowCaption:function(e,t){this.set("hideControlsLine",!t),this.isRendered()&&(t?this.js$("caption").css({display:"block",opacity:1}):this.js$("caption").css({display:"none",opacity:0}))},_onFileUploadStart:function(e){this.uploads.add(e);var t=e.get("file");this.mediaPreview.set({file:t,canEditMedia:!0}),this.listenToOnce(this.mediaPreview,"media:ready",function(){this.set({hasMedia:!0,showTos:!0,showCaption:!0}),this.caption.focus()})},_onFileUploadComplete:function(e){var t=e.get("file"),i="portrait"===e.get("orientation");this.mediaPreview.set({file:t,canEditMedia:!0,width:i?e.get("height"):e.get("width"),height:i?e.get("width"):e.get("height")}),this.post.set({preuploadUrl:e.get("key"),preuploadKey:e.get("ch")})},_onFileUploadError:function(e){var t=e.get("error")||c("Error uploading video");n.isArray(t)&&(t=t.join("</p><p>")),l.bool("upload_to_vimeo")&&e.get("file").size>this.maxVideoFileSize||"Video file is too large"===t?this.launchVimeoDialog():a.alert("<p>"+t+"</p>"),this.removeMedia()},launchVimeoDialog:function(){var e={text:c("That's an impressively big video. Unfortunately, Tumblr can only handle 100MB at a time. If you're looking to post huuuuuge stuff, just use Vimeo."),type:"video-vimeo-error",visible_glass:!0,buttons:{0:{text:"Nevermind",callback:function(){}},1:{text:"Upload to Vimeo",selected:!0,btn_class:"blue upload-to-vimeo-btn",callback:function(){window.open("https://vimeo.com/upload?utm_source=tumblr&utm_medium=partner&utm_campaign=28742","_blank")}}},scroll_lock:!0};a.dialog(e)},_embedCodeParser:function(e,t,i){if(this._embedCodeParsing&&this._embedCodeParsing.abortEmbedCodeParse(),!n.isEmpty(n.trim(e))){var s=!1,o=this._parseEmbedCode=u.parseEmbedData(e,540).then(n.bind(function(i){s||(this._embedCodeParsing=!1),this.listenToOnce(this.mediaPreview,"media:ready",function(){this.set({hasMedia:!0,showCaption:!0}),this.caption.focus()}),this.mediaPreview.set(n.extend({embed:h(i),canEditMedia:!0},n.pick(i,["width","height"]))),t.trigger("url:complete"),this.post.set({embedCode:e})},this),function(e){t.trigger("url:error")});return o.abortEmbedCodeParse=function(){s=!0},o}},afterRender:function(){this.renderSubViews(),this.get("hasMedia")?this.mediaComposer.$el.css({display:"none",opacity:0}):this.mediaPreview.$el.css({display:"none",opacity:0}),this.get("showTos")||this.js$("tos").css({display:"none",opacity:0}),this.get("showCaption")?this.delayedFocus(this.caption):this.js$("caption").css({display:"none",opacity:0})},executeUrlParser:function(e){this.subViews.mediaComposer.urlParser(e)},getRichTextEditor:function(){return this.caption}});e.exports=b},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(121),r=i(499),a=i(435),l=i(170),c=i(500),u=i(101),h=i(518),d=i(344),p=i(519),g=i(520),m=i(521),f=i(522),v=a.extend({className:"media-container video-media-container",events:{mouseenter:"_onHoverRemoveButton",mouseleave:"_onHoverRemoveButton"},template:p,mixins:[l],defaults:n.defaults({canPreview:!0,file:!1,embed:!1,width:!1,height:!1},a.prototype.defaults),afterInitialize:function(){this.addStateListeners()},addStateListeners:function(){this.listenTo(this,"change",this._onChangeVideo),this.listenTo(this.post,"change:preuploadUrl",this._onChangePreuploadUrl)},_onHoverRemoveButton:function(e){var t="mouseover"===e.type||"mouseenter"===e.type;this.js$("removeButton").toggleClass("active",t)},_onChangeVideo:function(){(this.hasChanged("file")||this.hasChanged("embed")||this.hasChanged("canPreview"))&&(this.hasChanged("file")?this.attributes.embed=!1:this.hasChanged("embed")&&(this.attributes.file=!1),this.hasChanged("canPreview")||this.set("canPreview",!0),this.isRendered()&&(this.teardown(),this.render(),this.addStateListeners()))},_onChangePreuploadUrl:function(e,t){this._updateUploadPreview(t,this.get("file"))},_updateUploadPreview:function(e,t){var i=t&&t.name?'"'+t.name+'"':"";e?(this.js$("previewIcon").removeClass("video-uploading").addClass("video-check"),this.js$("previewMessage").html(u("Your video %1$s has been uploaded",i))):(this.js$("previewIcon").removeClass("video-check").addClass("video-uploading"),this.js$("previewMessage").html(u("Uploading your video %1$s",i)))},_createVideoPlayer:function(e){if(!this.get("canPreview"))return this.js$("video").html(g({icon:"",message:""})),void this._updateUploadPreview(this.post.get("preuploadUrl"),e);var t=540,i=this.get("width"),s=this.get("height"),r=i&&s?h(i,s,t):{width:t};n.extend(r,{file:e,techOrder:["html5"]});var a=this.player=new c(document.createElement("video"),{attributes:{watch:!1},vjsOptions:r}),l=!1,u=this.whenEvent(a,"ready");return u.then(function(){a.player.on("error",function(){l=!0,n.defer(function(){this.set("canPreview",!1),this.trigger("media:ready",this)}.bind(this))}.bind(this))}.bind(this)),o.join(this.whenEvent(a,"change:loaded"),u).then(function(){if(!l){this.js$("video").append(a.$el);var e={width:"auto",height:"auto"},i=a.$video.prop("videoWidth"),n=a.$video.prop("videoHeight");i&&n&&(e=h(i,n,t)),a.$el.css(e),this.trigger("media:ready",this)}}.bind(this)),a.render(),a},_createVideoEmbed:function(){var e=function(e){return s('<a href="'+e.get("blog_url")+'"></a>').prop("hostname")}(this.user.getChannel(this.post.get("tumblelog"))),t=this.get("embed"),i=n.extend({tumblelogHostname:e},t);this.js$("video").html(m(i)),"inline"===t.embedRenderContext?r(function(){this.trigger("media:ready",this)},250,this)():this.trigger("media:ready",this)},beforeTeardown:function(){this.player&&this.player.teardown(),delete this.player},beforeRender:function(){this.removeButton=this.subViews.removeButton=new d({onClick:function(){this.trigger("media:remove",this)}.bind(this),buttonClass:"top-right"})},afterRender:function(){this.js$("video",!0),this.renderSubViews(),this.player=!1,this.get("file")?this._createVideoPlayer(this.get("file")):this.get("embed")?n.isEmpty(this.get("embed"))?(this.js$("video").html(f()),this.trigger("media:ready",this)):this._createVideoEmbed(this.get("embed")):this.trigger("media:ready",this)}});e.exports=v},function(e,t){"use strict";function i(e,t,i){return function(){i||(i=this);var n=arguments;return setTimeout(function(){e.apply(i,n)},t)}}e.exports=i},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(501),r=i(386),a=i(145),l=i(160),c=i(108),u=i(110),h=i(502),d=i(503),p=a.extend({mixins:[l],defaults:{loaded:!1,paused:!0,muted:!1,autoplay:!1,_preload:!1,_preloadThreshold:10,loop:!0,autoheight:!1,watch:!0,duration:0,hideFullscreen:!1,_elapsed:0,_position:0,_startSeekJumpTime:null,minLoopDuration:1},classNames:{base:"crt-video crt-skin-default",autoplay:"crt-state-autoplaying",autoheight:"crt-autoheight",hideFullscreen:"crt-hide-fullscreen-toggle"},constructor:function(e,t){this._id=n.uniqueId("crtplayer"),this.initialize(e,t)},initialize:function(e,t){delete window.videojs,t||(t={}),n.isObject(t.attributes)&&this.set(t.attributes),this.video=e,this.$video=s(this.video);var i=this.$video.data("crt-options")||{};this.$video.removeAttr("data-crt-options"),this.vjsOptions=n.defaults({crt:this,crtOptions:i},t.vjsOptions||{}),i&&i.duration&&this.set("duration",i.duration),this.vjsOptions.crtOptions.livestream&&this.set("autoplay",!0),r.write(function(){this.$video.addClass(this.classNames.base)},this)},render:function(){return r.write(function(){d(this.video,this.vjsOptions).then(n.bind(this.ready,this))},this),this},ready:function(e){this.player=e,this.el=e.player_.el(),this.$el=s(this.el),this.$post=this.$el.closest(".post, .video-ad"),this.playerID=this.player.id_,this.hasLooped=!1,this._bindEvents(),this.setAutoplayState(this.shouldAutoplay()),this.setMutedState(this.shouldAutoplay()),this.setLoopState(!0),this.setAutoheightState(n.get(this.vjsOptions,"crtOptions.autoheight")),this.setFullscreenControl(!h.prop("requestFullscreen")),this.shouldForceHD()&&this.player.src({src:this.vjsOptions.crtOptions.hdUrl,type:"video/mp4"}),this.get("watch")&&this.setupWatcher(),u.trigger("CrtPlayer:ready",this),this.trigger("playerReady",this),this.trigger("ready",this)},_bindEvents:function(){this.listenTo(u,"peepr:open",this.pause),this.listenTo(u,"post:form:show",this.pause),this.listenTo(u,"post:docked:afterRender",this.onDockedAfterRender),this.on("change:autoplay",this.onChangeAutoplay,this),this.on("change:autoheight",this.onChangeAutoheight,this),this.on("change:duration",this.onChangeDuration,this),this.on("change:loop",this.onChangeLoop,this),this.on("change:muted",this.onChangeMuted,this),this.player.on("loadedmetadata",n.bind(this.onLoadedMetadata,this)),this.player.on("durationchange",n.bind(this.onUpdateDuration,this)),this.player.on("play",n.bind(this.onPlay,this)),this.player.on("pause",n.bind(this.onPause,this)),this.player.on("ended",n.bind(this.onEnded,this)),this.player.on("fullscreenchange",n.bind(this.onFullscreenChange,this)),this.player.on("error",n.bind(this.onError,this))},setupWatcher:function(){this.watcher=o.create(this.el,-100),this.watcher.fullyEnterViewport(n.bind(function(){this.trigger("fullyEnterViewport")},this)),this.watcher.partiallyExitViewport(n.bind(function(){this.trigger("partiallyExitViewport")},this)),this.watcher.exitViewport(n.bind(function(){this.trigger("exitViewport"),this.shouldAutoplay()&&this.pause()},this)),this.shouldAutoplay()&&this.$el.on("click.crtAutoPlay touchend.crtAutoPlay",n.bind(this.onClickPlayer,this))},onClickPlayer:function(e){s(e.target).closest(".vjs-mute-control").length||s(e.target).closest(".vjs-fullscreen-control").length?this.restart():this.pause(),this.set("autoplay",!1),this.set("muted",!1),this.$el.off("click.crtAutoPlay touchend.crtAutoPlay")},restart:function(){this.get("autoplay")&&(this.set("autoplay",!1),this.set("muted",!1),this.onTimeUpdate(),this.player.trigger({type:"restart",start:this.player.currentTime(),end:0}),this.player.currentTime(0))},pollTimeUpdate:function(){this.get("paused")||(this.onTimeUpdate(),setTimeout(n.bind(this.pollTimeUpdate,this),150))},shouldAutoplay:function(){return this.get("autoplay")&&!c.bool("is_mobile")&&this.$el.is(":visible")&&(this.get("duration")>this.get("minLoopDuration")||this.vjsOptions.crtOptions.livestream)},shouldForceHD:function(){return!(!this.vjsOptions.forceHD||!this.vjsOptions.crtOptions.hdUrl)},play:function(e){e||(e={}),this.player.paused()&&(this.player.play(),e.skipLog||(e.type="userPlay",this.player.trigger(e)))},pause:function(e){e||(e={}),this.player.paused()||(this.player.pause(),e.skipLog||this.player.trigger("userPause"))},onPlay:function(){this.set("paused",!1),this.pollTimeUpdate()},onPause:function(){this.set("paused",!0)},onUpdateDuration:function(e){this.get("duration")||this.set("duration",this.player.duration())},onLoadedMetadata:function(e){this.set("loaded",!0)},onEnded:function(e){this.get("loop")===!0?(this.play({skipLog:!0}),this.player.trigger("looped"),this.get("autoplay")||this.hasLooped||(this.hasLooped=!0)):(this.pause({skipLog:!0}),this.player.trigger("videoEnded"))},onError:function(e){this.set("paused",!0),this.set("loop",!1),this.set("autoplay",!1)},onChangeAutoplay:function(e,t,i){this.setAutoplayState(t,i)},onChangeAutoheight:function(e,t){this.setAutoheightState(t)},onChangeDuration:function(e,t){this.setLoopState(!0)},onChangeLoop:function(e,t){this.setLoopState(t)},onChangeMuted:function(e,t){this.player.muted(t)},onFullscreenChange:function(){this.$post.hasClass("docked")&&(this.player.isFullscreen()?(this.cached_top=this.$el.position().top,this.$el.css("top",0)):this.$el.css("top",this.cached_top))},onDockedAfterRender:function(e){n.isEmpty(e.embedID)||this.playerID===e.embedID&&this.player.trigger("CRTPlayer:updateDimensions")},setLoopState:function(e){n.isUndefined(e)&&(e=this.get("loop")),this.set("loop",e),"undefined"!=typeof this.get("duration")&&this.get("duration")<=this.get("minLoopDuration")&&this.set("loop",!1)},setMutedState:function(e){n.isUndefined(e)&&(e=this.get("muted")),this.set("muted",e)},setAutoplayState:function(e){n.isUndefined(e)&&(e=this.get("autoplay")),this.set("autoplay",e),this.toggleAttrClass("autoplay",e),!e&&this.get("duration")&&this.setLoopState(!0)},setAutoheightState:function(e){(n.isUndefined(e)||n.isNull(e))&&(e=this.get("autoheight")),this.set("autoheight",e),this.toggleAttrClass("autoheight",e)},setFullscreenControl:function(e){n.isUndefined(e)&&(e=this.get("hideFullscreen")),this.set("hideFullscreen",e),this.toggleAttrClass("hideFullscreen",e)},onTimeUpdate:function(){var e=.3,t=this.get("_position"),i=this.player.currentTime(),n=Math.abs(t-i);e>n&&this.set("_elapsed",this.get("_elapsed")+n),this.set("_position",i),this.set("_startSeekJumpTime",i)},getStartSeekJumpPosition:function(){return this.get("_startSeekJumpTime")},getPosition:function(){return Math.floor(this.get("_position"))},getElapsed:function(){return Math.floor(this.get("_elapsed"))},toggleAttrClass:function(e,t){this.classNames[e]&&r.write(function(){this.$el.toggleClass(this.classNames[e],t)},this)},teardown:function(){this.trigger("teardown",this),this.off(),this.stopListening(),this.watcher&&(this.watcher.destroy(),this.watcher=null),this.player&&(this.player.dispose(),this.player=null)}});e.exports=p},,function(e,t,i){"use strict";var n=i(3),s=i(145),o={requestFullscreen:["requestFullScreen"]},r=s.extend({vendors:["moz","webkit","ms","o","khtml"],el:document.body||document.documentElement,get:n.memoize(function(e){var t=this._getProp(e);return!t&&o[e]&&n.each(o[e],function(e){var i=this._getProp(e);i&&(t=i)},this),t}),prop:function(e){return!!this.get(e)},_getProp:function(e){var t=!1;return"string"==typeof this.el[e]?e:"string"==typeof this._styles()[e]?e:(e=e.charAt(0).toUpperCase()+e.substr(1),n.forEach(this.vendors,function(i){var n=i+e;n in this.el&&(t=n),n in this._styles()&&(t=n)},this),t)},_styles:n.memoize(function(){return this.el.style})});e.exports=new r},function(e,t,i){"use strict";function n(e,t){var i=s.merge({},g(),t);s.extend(i,s.pick(t,"techOrder"));var n=r.defer(),a=function(){var e;t.src&&t.type?(this.src(t),n.resolve(this)):t.file?(e=t.file.type||"video/mp4",this.src({src:l(t.file),type:e}),n.resolve(this),delete t.file):n.resolve(this)};return o(e,i,a),n.promise}var s=i(3),o=i(504);window.videojs=o;var r=i(121),a=i(106),l=i(456),c=i(505),u=i(510),h=i(511);o.registerComponent("BigPlayToggle",i(512)),o.registerComponent("AnimatingMuteToggle",i(513)),o.registerComponent("CrtSeekBar",i(515)),o.registerComponent("LoadingSpinner",i(516)),o.registerComponent("HDToggle",i(517)),o.log=s.noop,o.log.error=s.noop,o.log.warn=s.noop,o.log.history=[];var d=function(e){this.crt=this.options_.crt,this.options_.crt=null,this.hoverSlider=new c(this,e),this.detectBuffering=new u(this,e),this.eventDispatcher=new h(this,e)};o.plugin("crt",d);var p,g=function(){var e=a.get("Context/hosts");return p||(p={children:["mediaLoader","posterImage","bigPlayToggle",{name:"controlBar",children:["playToggle","timeDivider","durationDisplay",{name:"progressControl",children:["crtSeekBar"]},"fullscreenToggle","hDToggle","animatingMuteToggle","loadingSpinner"]},"errorDisplay"],hls:{withCredentials:!1},plugins:{crt:{}},crtOptions:{filmstrip:!1,hdUrl:!1,duration:null,livestream:!1},controls:!0,autoplay:!1,defaultVolume:.8,flash:{swf:e.assets_host+"/assets/src/scripts/vendor/video-js/video-js.swf"},techOrder:["html5","flash"]}),p};e.exports=n},,function(e,t,i){"use strict";var n=i(3),s=i(504),o=i(506),r=i(507),a=i(508),l=i(509),c=s.extend(o,{elSelector:".vjs-progress-holder",initialize:function(e,t){this.children={},this.$el=this.$$(this.elSelector),this.createChildren(),this.$player.on("mousemove.sliderHover",this.elSelector,n.bind(this.onMouseMove,this)),this.$player.on("mouseenter.sliderHover",this.elSelector,n.bind(this.onMouseEnter,this)),this.$player.on("mouseout.sliderHover",this.elSelector,n.bind(this.onMouseOut,this)),this.player.on("dispose",n.bind(this.dispose,this))},createChildren:function(){this.children.hoverSliderHandle=new r(this.player),this.children.hoverSliderTime=new a(this.player),this.player.options_.crtOptions.filmstrip&&(this.$el.addClass("with-filmstrip"),this.children.progressBarTooltip=new l(this.player)),this.appendChildren()},appendChildren:function(){n.each(this.children,n.bind(function(e){this.$el.append(e.render().$el)},this))},updateChildren:function(e){n.each(this.children,function(t){t.update(e)})},onMouseMove:function(e){this.$el.removeClass("auto-hide");var t=this.$el.offset(),i=this.$el.width(),n=e.pageX-t.left,s=Math.max(0,Math.min(1,(e.pageX-t.left)/i)),o=s*this.player.player().duration(),r=o/this.player.player().duration();0>n?n=0:n>i&&(n=i),this.updateChildren({hoverX:n,hoverTime:o,hoverPercent:r})},onMouseOut:function(e){this.$el.addClass("auto-hide")},onMouseEnter:function(e){this.$el.removeClass("auto-hide")},dispose:function(){n.each(this.children,function(e){n.result(e,"dispose")}),o.prototype.dispose.apply(this,arguments)}});e.exports=c},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(504),r=o.getComponent("Component"),a=o.extend(r,{constructor:function(e,t){this.options=t||{},this.player=e,this.$player=s(this.player.el()),this._selectorCache(),this.player.on("dispose",n.bind(this.dispose,this)),this.player.ready(n.bind(function(){this.initialize.apply(this,arguments)},this))},_selectorCache:function(){this.$$=n.memoize(function(e){return this.$player.find(e)},n.identity),this.$$.remove=n.bind(function(e){this.$$.cache["delete"](e)},this),this.$$.clear=n.bind(function(){this.$$.cache=new n.memoize.Cache},this)},initialize:function(){},dispose:function(){this.$$.clear(),this.$player.off()}});e.exports=a},function(e,t,i){"use strict";var n=i(9),s=i(504),o=i(506),r=s.extend(o,{seeking:!1,render:function(){return this.$el=n('<div class="vjs-hover-handle vjs-slider-handle" aria-live="off"><span class="vjs-control-text"></span></div>'),this},update:function(e){e||(e={}),this.$time_el=this.$time_el||this.$el.find(".vjs-hover-handle-time");var t=e.hoverX||0,i=e.hoverTime||"0:00",n=s.formatTime(i);this.$time_el.html(n),this.$el.css("left",t+"px")}});e.exports=r},function(e,t,i){"use strict";var n=i(9),s=i(504),o=i(506),r=s.extend(o,{render:function(){return this.$el=n('<div class="vjs-hover-slider-time" aria-live="off"></div>'),this},update:function(e){e||(e={});var t=e.hoverX||0,i=e.hoverTime||"0:00",n=s.formatTime(i);this.$el.html(n),this.$el.css("left",t+"px")}});e.exports=r},function(e,t,i){"use strict";var n=i(9),s=i(504),o=i(506),r=s.extend(o,{filmstrip_thumbnail_count:10,render:function(){var e=this.player.options_.crtOptions.filmstrip,t=e.url,i=.5*e.width,s=.5*e.height,o=6;return this.$el=n('<div class="crt-progress-tooltip"></div>'),this.$thumbnail=n('<div class="crt-progress-tooltip-thumbnail"></div>'),this.$el.css({transform:"translateX(-50%)",width:i+o+"px",height:s+o+"px"}),this.$thumbnail.css({width:i+"px",height:s+"px","background-image":"url("+t+")","background-size":i*this.filmstrip_thumbnail_count+"px "+s+"px"}),this.$el.append(this.$thumbnail),this},update:function(e){e||(e={});var t=e.hoverX||0;this.$el.css("left",t+"px");var i=isNaN(e.hoverPercent)?0:100*e.hoverPercent,n=100/(this.filmstrip_thumbnail_count-1),s=Math.floor(i/this.filmstrip_thumbnail_count)*n;this.$thumbnail.css("background-position",s+"% 0%")}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(504),o=i(506),r=s.extend(o,{elSelector:".vjs-progress-holder",lastPlayPosition:0,currentPlayPosition:0,lastWaitedTime:0,buffering:!1,polling:!1,interval:100,initialize:function(e,t){this.player.on("play",n.bind(this.startPolling,this)),this.player.on("ended",n.bind(this.stopPolling,this)),this.player.on("pause",n.bind(this.stopPolling,this))},checkBuffering:function(){this.currentPlayPosition=this.player.currentTime();var e=1/this.interval;if(!this.buffering&&this.currentPlayPosition<this.lastPlayPosition+e&&!this.player.paused()&&(this.lastWaitedTime=n.now(),this.$player.trigger("waiting"),this.buffering=!0),this.buffering&&this.currentPlayPosition>this.lastPlayPosition+e&&!this.player.paused()){var t=n.now()-this.lastWaitedTime;this.$player.trigger("stopwaiting",{timeWaited:t}),this.buffering=!1}this.lastPlayPosition=this.currentPlayPosition},tick:function(){this.polling&&(this.checkBuffering(),n.delay(n.bind(this.tick,this),this.interval))},startPolling:function(e){this.polling||(this.polling=!0,this.tick())},stopPolling:function(e){this.polling=!1}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(504),r=i(110),a=i(108),l=i(506),c=o.extend(l,{videoConversionLogged:!1,loggingInProgress:!1,startSeekTime:null,loadStartTime:0,triggerElement:s(),initialize:function(e,t){this.player.crt.on("playerReady",n.bind(function(){this.setPlayerData(),this.bindEvents(),this.cacheUnloadData()},this)),this.$doc=s(document)},setPlayerData:function(){this.playerData={id:this.player.crt.playerID,tech:this.player.techName,postData:this.player.crt.$post.data("json"),duration:this.player.crt.get("duration")}},bindEvents:function(){this.$player.on("mousedown touchstart",n.bind(this.setTriggerElement,this)),this.player.on("userPlay",n.bind(this.onUserPlay,this)),this.player.on("play",n.bind(this.onVJSPlay,this)),this.player.on("userPause",n.bind(this.onUserPause,this)),this.player.on("pause",n.bind(this.onVJSPause,this)),this.player.on("looped",n.bind(this.onLooped,this)),this.player.on("videoEnded",n.bind(this.onVideoEnded,this)),this.player.on("restart",n.bind(this.onRestart,this)),this.player.on("muteClicked",n.bind(this.onMuteClicked,this)),this.player.on("fullscreenchange",n.bind(this.onFullscreenChange,this)),this.player.on("error",n.bind(this.onError,this)),this.player.on("seeking",n.bind(this.onSeeking,this)),this.player.on("resolutionchange",n.bind(this.onResolutionChange,this)),this.player.on("timeupdate",n.bind(this.onTimeUpdate,this)),this.$player.on("stopwaiting",n.bind(this.onStopWaiting,this)),this.player.on("firstplay",n.bind(this.onLoadStart,this)),this.player.on("loadeddata",n.bind(this.onLoadedData,this))},triggerEvent:function(e,t){t=this._buildLoggingData(t),r.trigger("VideoPlayer:"+e,{loggingData:t})},_buildLoggingData:function(e){return e=n.extend({},this.playerData,e),e.elapsed=this.player.crt.getElapsed(),
e.position=this.player.crt.getPosition(),e},setTriggerElement:function(e){this.triggerElement=s(e.target)},onLogComplete:function(){this.triggerElement=s()},cacheUnloadData:function(){this.triggerEvent("cacheUnload")},onError:function(e){var t=this.player.error(),i="MEDIA_ERR_CUSTOM";if(t){switch(t.code){case 1:i="MEDIA_ERR_ABORTED";break;case 2:i="MEDIA_ERR_NETWORK";break;case 3:i="MEDIA_ERR_DECODE";break;case 4:i="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:i="MEDIA_ERR_ENCRYPTED"}this.triggerEvent("error",{code:t.code,name:i})}},onUserPlay:function(e){this.onPlay(!0,e)},onVJSPlay:function(e){this.onPlay(!1,e)},onPlay:function(e,t){if(e||0!==this.triggerElement.closest(".vjs-big-play-button").length||0!==this.triggerElement.closest(".vjs-play-control").length){var i=this.player.crt.get("autoplay"),n={};t.onDock&&(n.onDock=!0),this.logConversion({name:"CONVERSION_ACTION_HTML5_VIDEO",extra:{player:this.player.techName,player_version:2}}),this.triggerEvent(i?"autoplay":"play",n),this.onLogComplete()}},onUserPause:function(){this.onPause(!0)},onVJSPause:function(){this.onPause(!1)},onPause:function(e){(e||0!==this.triggerElement.closest(".vjs-big-play-button").length||0!==this.triggerElement.closest(".vjs-play-control").length)&&(this.triggerEvent("pause",this.playerData),this.onLogComplete())},onLooped:function(){this.triggerEvent("looped")},onVideoEnded:function(){this.triggerEvent("ended")},onRestart:function(e){var t=n.pick(e,["start","end"]);this.triggerEvent("restart",t)},onFullscreenChange:function(){this.triggerEvent("fullscreen",{fullscreen:this.player.isFullscreen()}),this.onLogComplete()},onMuteClicked:function(){this.triggerEvent("muted",{muted:this.player.muted()}),this.onLogComplete()},onSeeking:function(){0!==this.triggerElement.closest(".vjs-progress-control").length&&(this.startSeekTime||(this.startSeekTime=this.player.crt.getStartSeekJumpPosition()),this.$doc.one("mouseup.crtEvents touchend.crtEvents",n.bind(this.onSeeked,this)))},onSeeked:function(){if(this.startSeekTime){var e={start:this.startSeekTime,end:this.player.currentTime()};this.triggerEvent("seek",e),this.startSeekTime=null}},onTimeUpdate:function(){this.triggerEvent("timeupdate")},onResolutionChange:function(e){var t=n.pick(e,"resolution");this.triggerEvent("resolutionchange",t)},onStopWaiting:function(e,t){!t.timeWaited||t.timeWaited<2e3||this.triggerEvent("waiting",t)},onLoadStart:function(){this.loadStartTime=n.now()},onLoadedData:function(){var e=n.now()-this.loadStartTime;this.triggerEvent("initialLoad",{loadTime:e})},logConversion:function(e){if(!this.videoConversionLogged&&a.bool("is_logged_in")&&!this.loggingInProgress){this.loggingInProgress=!0;var t=s.ajax({url:"/svc/log/conversion",type:"POST",contentType:"application/x-www-form-urlencoded",with_form_key:!0,data:"log="+JSON.stringify(e)});t.done(n.bind(this.onConversionSuccess,this)),t.fail(n.bind(this.onConversionFail,this))}},onConversionSuccess:function(){this.videoConversionLogged=!0,this.loggingInProgress=!1},onConversionFail:function(){this.loggingInProgress=!1}});e.exports=c},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(504),r=i(150).animation,a=o.getComponent("ClickableComponent"),l=o.extend(a,{constructor:function(){a.prototype.constructor.apply(this,arguments),this.player().usingNativeControls()&&this.player().controls(!1)},createEl:function(){return a.prototype.createEl.call(this,"div",{className:"vjs-big-play-button",innerHTML:'<span class="vjs-big-play-button-icon"></span><span class="vjs-big-pause-button-icon"></span></span><span aria-hidden="true"></span>'},{"aria-label":"play video"})},handleClick:function(){this.$el=this.$el||n(this.el()),this.player_.userActive(!0),this.player().usingNativeControls()?this.player().paused()&&(this.player().play(),this.player().controls(!0)):this.togglePlay()},togglePlay:function(){r(this.$el,s.bind(function(e){this.$el.removeClass("poof-play poof-pause")},this)),this.player().paused()?(this.player().play(),this.$el.removeClass("poof-pause").addClass("poof-play")):(this.player().pause(),this.$el.removeClass("poof-play").addClass("poof-pause"))}});e.exports=l},function(e,t,i){"use strict";var n=i(504),s=i(514),o=n.getComponent("MuteToggle"),r=n.getComponent("ClickableComponent"),a=n.extend(o,{constructor:function(e,t){o.prototype.constructor.call(this,e,t),this.addListeners(e)},addListeners:function(e){this.on("click",this.onMuteClick)},onMuteClick:function(){this.player_.trigger("muteClicked")},createEl:function(){var e="vjs-mute-control vjs-control";return this.player_.options_.muted&&(e+=" vjs-vol-0"),r.prototype.createEl.call(this,"div",{className:e,innerHTML:s()},{})},update:function(){var e=this.player_.volume(),t=3;0===e||this.player_.muted()?t=0:.33>e?t=1:.67>e&&(t=2),this.controlText(this.player_.muted()?"Unmute":"Mute");for(var i=0;4>i;i++)n.removeClass(this.el_,"vjs-vol-"+i);n.addClass(this.el_,"vjs-vol-"+t)}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="mute-icon"><div class="speaker"></div><div class="unmuted"></div><div class="muted"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(504),s=n.getComponent("SeekBar"),o=n.extend(s,{constructor:function(){s.prototype.constructor.apply(this,arguments),this.handle=document.createElement("div"),this.handle.className="vjs-seek-handle vjs-slider-handle",this.handle.setAttribute("aria-live","off"),this.el_.appendChild(this.handle)},handleMouseMove:function(e){s.prototype.handleMouseMove.apply(this,arguments),this.update()},update:function(){if(this.el_){var e=this.getPercent();isNaN(e)&&(e=0);var t=(100*e).toFixed(2)+"%";this.handle.style.left=t,this.bar.el().style.width=t}}});e.exports=o},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(504),r=o.getComponent("Component"),a=o.extend(r,{isHidden:!0,constructor:function(e,t){r.call(this,e,t),e.ready(s.bind(this.onReady,this))},onReady:function(){this.$player=n(this.player().el_),this.$el=n(this.el()),this.$loader=this.$el.find(".Knight-Rider-loader");var e=s.bind(this.hideLoader,this),t=s.bind(this.showLoader,this);this.player().on("waiting",t),this.player().on("canplay",e),this.player().on("canplaythrough",e),this.player().on("playing",e),this.player().on("seeking",t),this.player().on("seeked",e),this.player().on("ended",e),this.player().on("resolutionchange",t)},createEl:function(){return r.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",innerHTML:'<div class="Knight-Rider-loader centered"><div class="Knight-Rider-bar"></div><div class="Knight-Rider-bar"></div><div class="Knight-Rider-bar"></div></div>'},{"aria-label":"loading"})},hideLoader:function(e){return this.isHidden?this:(this.$loader.removeClass("animate"),this.$player.removeClass("vjs-loading"),this.isHidden=!0,this)},showLoader:function(e){return this.isHidden?(this.$loader.addClass("animate"),this.$player.addClass("vjs-loading"),this.isHidden=!1,this):this},dispose:function(){r.prototype.dispose.apply(this,arguments),this.$player=null,this.$el=null}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(504),o=s.getComponent("Component"),r=s.extend(o,{sdURL:null,hdURL:null,forceHD:null,isUsingSD:!0,timeIntervalBinding:null,constructor:function(e,t){o.prototype.constructor.call(this,e,t),this.addListeners(e)},addListeners:function(e){this.on("click",this.toggleHDState)},createEl:function(){if(this.hdURL=this.player_.options_.crtOptions.hdUrl,this.forceHD=this.player_.options_.forceHD,!this.hdURL||this.forceHD)return o.prototype.createEl.call(this,"div",{},{});this.player_.addClass("vjs-has-hd-toggle");var e=o.prototype.createEl.call(this,"div",{className:"vjs-hd-toggle vjs-sd vjs-menu-button vjs-control",innerHTML:"<span>HD</span>"},{});return e},currentSource:function(){return this.player_.currentSrc()},toggleSrc:function(){var e;this.isUsingSD?(this.sdURL=this.currentSource(),e=this.hdURL,s.removeClass(this.el_,"vjs-sd"),s.addClass(this.el_,"vjs-hd")):(e=this.sdURL,s.removeClass(this.el_,"vjs-hd"),s.addClass(this.el_,"vjs-sd")),this.isUsingSD=!this.isUsingSD,this.player_.src({src:e,type:"video/mp4"})},toggleHDState:function(){var e=this.player_.currentTime(),t=this.player_.paused(),i=this.player_.muted();this.player_.addClass("vjs-quality-toggling"),this.player_.trigger({type:"resolutionchange",resolution:this.isUsingSD?"hd":"sd"}),n.delay(n.bind(function(){this.player_.pause(),this.toggleSrc(),this.player_.ready(function(){this.player_.one("loadedmetadata",n.bind(function(){this.player_.currentTime(e)},this)),this.timeIntervalBinding=n.bind(function(){this.player_.currentTime()-e>.1&&(this.player_.removeClass("vjs-quality-toggling"),this.player_.off("timeupdate",this.timeIntervalBinding),t&&(this.player_.pause(),this.player_.muted(i)))},this),this.player_.on("timeupdate",this.timeIntervalBinding),n.defer(n.bind(function(){this.player_.load(),i===!1&&t===!0&&this.player_.muted(!0),this.player_.play()},this))})},this),300)}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=function(e,t,i){var s={};n.isPlainObject(e)&&(i=t,n.extend(s,e),e=s.width,t=s.height);var o=Math.round(t/e*i);return s.width=i,s.height=o,s};e.exports=s},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="video-container" data-js-video></div> ',canEditMedia&&(__p+=' <div data-subview="removeButton"></div> '),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="media-preview"><div class="v-center-outer"><div class="v-center-inner"><div class="icon '+(null==(__t=icon)?"":_.escape(__t))+'" data-js-previewicon></div><p class="media-preview-text" data-js-previewmessage>'+(null==(__t=message)?"":_.escape(__t))+"</p></div></div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="","inline"===embedRenderContext?__p+=' <div class="video-preview"> '+(null==(__t=previewIframe)?"":__t)+" </div> ":(__p+=' <div class="video-preview video_preview '+(null==(__t=thumbnail&&thumbnail.url?"has_thumbnail":"no_thumbnail")?"":_.escape(__t))+'"> ',thumbnail&&thumbnail.url&&(__p+=' <img src="'+(null==(__t=thumbnail.url)?"":_.escape(__t))+'" alt="" width="'+(null==(__t=thumbnail.width||"")?"":_.escape(__t))+'" height="'+(null==(__t=thumbnail.height||"")?"":_.escape(__t))+'"> '),__p+=' <div class="video_info_wrapper"><i class="icon_post_video"></i><div class="video_text"><span class="clippable">'+(null==(__t=__("Watch on %s",tumblelogHostname))?"":_.escape(__t))+'</span><i class="icon_arrow_carrot_right"></i></div></div></div> '),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="video-error"><div class="v-center-outer"><div class="v-center-inner"><span class="icon"></span><span class="error-message">'+(null==(__t=__("This video embed stopped working. Try another?"))?"":_.escape(__t))+"</span></div></div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="media-wrapper" data-js-media><div data-subview="mediaPreview"></div><div data-subview="mediaComposer"></div></div><div class="caption-wrapper" data-js-tos><div data-subview="confirmTos"></div></div><div class="caption-wrapper" data-js-caption><div data-subview="reblogTree"></div><div data-subview="caption"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(340),r=i(525),a=i(356),l=i(342),c=i(527),u=o.extend({template:c,className:"post-composer_note-post",createSubViews:function(){var e=this.subViewOptions(),t=n.extend({className:"answer-field",name:"answer",placeholder:s("Your answer here"),ariaLabel:s("Answer")},e),i=n.extend({className:"caption-field",name:"caption",placeholder:s("Add your own text, if you like"),ariaLabel:s("Caption")},e),o=n.extend({isRemovable:!0},e);this.askField=this.subViews.askField=new r(e),this.post.isReblog()?(this.reblogTree=this.subViews.reblogTree=new l(o),this.caption=this.subViews.caption=new a(i)):this.answerField=this.subViews.answerField=new a(t)},afterRender:function(){this.renderSubViews(),this.post.isReblog()?this.delayedFocus(this.caption):this.delayedFocus(this.answerField)},getRichTextEditor:function(){return this.model.get("is_reblog")?this.caption:this.answerField}});e.exports=u},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(204),a=i(526),l=s.extend({template:a,mixins:[o,r],serialize:function(){return n.extend({post:this.model.toJSON(),showAnswerField:this.model.isReblog()},this.toJSON())},render:function(){return this.$el.html(this.template(this.serialize())),this}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="note_wrapper" data-name="askField"><div class="note_item"><div class="text"><p class="asker"><span class="name">'+(null==(__t=post.asking_tumblelog.name.toLowerCase())?"":_.escape(__t))+"</span><span>"+(null==(__t=__("asked"))?"":_.escape(__t))+':</span></p><p class="note_text">'+(null==(__t=post.ask)?"":__t)+'</p></div><div class="nipple"></div></div><div class="avatar"><img src="'+(null==(__t=post.asking_tumblelog.avatar)?"":_.escape(__t))+'" alt="" width="40" height="40"></div></div> ',showAnswerField&&(__p+=' <div class="note_wrapper" data-name="answerField"><div class="note_item"><div class="text"><p class="answerer"><span class="name">'+(null==(__t=post.answering_tumblelog.name.toLowerCase())?"":_.escape(__t))+"</span><span>"+(null==(__t=__("answered"))?"":_.escape(__t))+":</span></p> "+(null==(__t=post.answer)?"":__t)+' </div><div class="nipple"></div></div><div class="avatar"><img src="'+(null==(__t=post.answering_tumblelog.avatar)?"":_.escape(__t))+'" alt="" width="40" height="40"></div></div> '),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="askField"></div><div data-subview="answerField"></div><div data-subview="reblogTree"></div><div data-subview="caption"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="post-margin" data-js-margin><div data-subview="avatar"></div></div><div class="post-container" data-js-container-outer><div class="post-container-inner post" data-js-container-inner><div class="post-form--header clearfix" data-js-header><div class="controls-container"><div class="control left"><div data-subview="tumblelogSelect"></div></div><div class="control right"><div data-subview="uploadingIndicator"></div><div data-subview="postSettings"></div></div></div></div><div class="post-form--form post-content-text"><div data-subview="postTypeForm"></div></div><div class="post-form--footer" data-js-footer><div data-subview="tagEditor"></div><div data-subview="editorButtons"></div></div><div class="post-form--guard"></div><div class="post-form--bottom" data-js-bottom><div class="post-form--controls" data-js-postformcontrols><div class="controls-container"><div class="control left"><button class="tx-button" data-js-clickableclose="">'+(null==(__t=closeLabel)?"":_.escape(__t))+'</button></div><div class="control right"><div data-subview="socialButtons"></div></div><div class="control right"><div data-subview="savePostButton"></div></div></div></div><div data-subview="errorBar"></div></div><div data-subview="allowAnswers"></div><div data-subview="richTextEditorTutorial"></div></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(7),r=i(145),a=0,l=function(e){e=null==e||n.isPlainObject(e)?n.extend({target:"body",autostart:!1},e):{target:e,autostart:!1};var t=".drag_eventor_"+a++,i=s(e.target),l=!1,c=0,u=new r;n.extend(u,o.Events);var h=["dragenter","dragover","dragleave","dragend","drop"],d=function(e){u.trigger(e.type,e)};return u.start=function(){c++,l||(l=!0,n.forEach(h,function(e){i.on(e+t,d)}))},u.stop=function(){c--,0>=c&&(l=!1,n.forEach(h,function(e){i.off(e+t,d)}))},e.autostart&&u.start(),u};e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(165).animate,o=i(149),r=i(171),a=i(204),l=i(205),c=i(160),u=o.extend({className:"post-forms-glass",mixins:[a,l,c],initialize:function(e){this.options=e=n.extend({active:!1,visible:!1},e),this.set({active:!!e.active,visible:!!e.visible}),this.get("visible")?this.$el.css({opacity:1,display:"block"}):this.$el.css({opacity:0,display:this.get("active")?"block":"none"}),this.listenTo(this,{"change:active":this._changeActive,"change:visible":this._changeVisible})},show:function(e){return this.set("active",!(null!=e&&!e)),this.attributes.visible&&this._showing?this._showing:(this.attributes.visible=!0,this._show())},hide:function(e){return this.set("active",!(null==e&&!e)),!this.attributes.visible&&this._hiding?this._hiding:(this.attributes.visible=!1,this._hide())},_show:function(){var e=this._showing=s(this.$el,{opacity:1},{duration:r(150),display:"block"});return e},_hide:function(){var e=this._hiding=s(this.$el,{opacity:0},{duration:r(150),display:this.get("active")?"block":"none"});return e},_changeActive:function(e,t){t?this.$el.addClass(this.className+"_active active"):(this.$el.removeClass(this.className+"_active active"),!this._changing||n.has(this.changed,"visible")||this.get("visible")||this.$el.css("display","none"))},_changeVisible:function(e,t){t?(this.$el.addClass(this.className+"_visible visible"),this._show()):(this.$el.removeClass(this.className+"_visible visible"),this._hide())},render:function(){return this}});e.exports=u},function(e,t,i){"use strict";var n=i(9),s=i(165).animate,o=i(149),r=i(171),a=i(204),l=i(205),c=i(160),u=i(532),h=o.extend({className:"post-forms-modal",mixins:[a,l,c],template:u,initialize:function(e){this.set("visible",e&&e.visible),this.get("visible")?this.$el.css({opacity:1,display:"block"}):this.$el.css({opacity:0,display:"none"}),this.$body=n("body"),this.listenTo(this,"change:visible",this._toggleVisible)},show:function(){return this.attributes.visible=!0,this._show()},hide:function(){return this.attributes.visible=!1,this._hide()},setContentSubView:function(e){return this.subViews.content&&(this.stopListening(this.subViews.content),this.subViews.content.remove()),this.subViews.content=e,this.listenTo(e,"prepared",this._onSubViewPrepare),this.listenTo(e,"torndown",this._onSubViewTeardown),this.isRendered()&&this.attachSubView("content"),this},_onSubViewPrepare:function(e){this.show()},_onSubViewTeardown:function(e){this.hide()},_show:function(){this._disableBodyScroll(),this.$el.css("display","block");var e=s(this.$el,{opacity:1},{duration:r(100),display:"block"});return e},_hide:function(){this._enableBodyScroll();var e=s(this.$el,{opacity:0},{duration:r(100),display:"none"});return e},_toggleVisible:function(e,t){t?(this.$el.addClass(this.className+"_visible visible"),this._show()):(this.$el.removeClass(this.className+"_visible visible"),this._hide())},_disableBodyScroll:function(){this.$body.css("overflow","hidden")},_enableBodyScroll:function(){this.$body.css("overflow","")},render:function(){return this.$el.html(this.template(this.attributes)),this.attachSubViews(),this}});e.exports=h},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="v-center-outer"><div class="v-center-inner"><div class="v-center-content"><div data-subview="content"></div></div></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(121),o=i(165).animate,r=i(168),a=i(171),l=i(170),c=i(149),u=(i(103),i(204)),h=i(205),d=i(160),p=i(534),g=i(535),m=i(537),f=c.extend({mixins:[u,h,d,l],template:m,defaultOptions:{animateDuringPrepare:!0,animateHeightWithContent:!1,startHeight:null,useLoader:!0,loaderDelay:250,transitionBackground:!1},defaults:{minHeight:!1,pretransition:!1,midtransition:!1},initialize:function(e){e instanceof c&&(e={postForm:e}),this.options=e=n.extend({},this.defaultOptions,e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),e.postForm&&this.setPostForm(e.postForm),this.listenTo(this,"change:minHeight",this._onChangeMinHeight),this.listenTo(this,"change:pretransition",this._onChangePretransition),this.listenTo(this,"change:midtransition",this._onChangeMidtransition)},_onChangeMinHeight:function(e,t){o(this.$el,"stop"),t||n.isNumber(t)?o(this.$el,{"min-height":t},{duration:a(Math.min(Math.max(250,t),750))}):(t=n.parseInt(this.$el.css("min-height"),10)||0,o(this.$el,{"min-height":[0,t]},{duration:a(Math.min(Math.max(250,t),750))}).then(n.bind(function(){this.$el.css("min-height","")},this)))},_onChangePretransition:function(e,t){t?this.$el.addClass("post-form-container-pretransition"):this.$el.removeClass("post-form-container-pretransition")},_onChangeMidtransition:function(e,t){t?this.$el.addClass("post-form-container-transition"):this.$el.removeClass("post-form-container-transition")},setPostFormComponent:function(e){return this._postFormComponent!==e?(this._postFormComponent&&this.stopListening(this._postFormComponent),this._postFormComponent=e,this.postForm=e.postForm,this):void 0},prepare:function(e){return this.isRendered()||this.render(),this.trigger("prepared",this),this.loadingDelay=n.delay(n.bind(function(){this.loader&&this.options.useLoader&&this.loader.set("loading",!0)},this),this.options.loadingDelay),this.options.animateDuringPrepare&&(this._hideOriginalContent=this.hideOriginalContent(e).then(n.bind(function(){return this._hideOriginalContent=!1,this},this))),s.resolve(this)},attach:function(e){return this.loader&&(clearTimeout(this.loadingDelay),this.loader.set("loading",!1)),this.set("pretransition",!0),this.postForm.forceHidden(),this.attachSubView(this.postForm,"postForm"),s.resolve(this)},hideOriginalContent:function(e){var t=this.options.startHeight||this.originalContent.measureHeight(),i=this.postForm.measureHeight();return t||this.options.originalContent||(t=i),r([function(){null!=t&&this.$el.css("height",t),this.set("midtransition",!0),this.originalContent.set("enabled",!1)},function(){return s.join(e(),this.originalContent.animateHide(a(100)))}],this)},showPostForm:function(e){var t=this.options.startHeight||this.originalContent.measureHeight(),i=this.postForm.measureHeight();return t||this.options.originalContent||(t=i),r([function(){return this.options.animateHeightWithContent||this.originalContent.get("hidden")?void 0:this._hideOriginalContent||this.hideOriginalContent(e)},function(){var n=[];return this.options.animateHeightWithContent&&!this.originalContent.get("hidden")&&n.push(this._hideOriginalContent||this.hideOriginalContent(e)),null==i||null==t||(i===t?this.$el.height(i):n.push(o(this.$el,{height:[i,t]},{duration:a(150),easing:[.4,1.3,.7,1]}))),s.all(n)},function(){return this.set("placeholder",!1),this.postForm.animateShow(a(100))},function(){this.set("pretransition",!1),this.set("midtransition",!1),this.$el.css("height","")}],this)},hidePostForm:function(e){var t=this.postForm.measureHeight(),i=this.originalContent.measureHeight();return i||this.options.originalContent||(i=t),r([function(){this.$el.css("height",t),this.set("midtransition",!0)},function(){return this.postForm.animateHide(a(100))},function(){if(this.set("pretransition",!0),null==i||null==t);else{if(i!==t)return o(this.$el,{height:[i,t]},{duration:a(100),easing:[0,0,.6,1]});this.$el.height(i)}},function(){return s.join(e(),this.originalContent.animateShow(a(50)))},function(){this.set("midtransition",!1),this.set("pretransition",!1),this.$el.css("height",""),this.originalContent.set("enabled",!0)}],this)},serialize:function(){return{originalContent:!!this.options.originalContent,transitionBackground:this.options.transitionBackground}},beforeRender:function(){this.loader||(this.loader=new g),this.originalContent||(this.options.originalContent instanceof p?this.originalContent=this.options.originalContent:this.originalContent=new p({el:this.options.originalContent})),this.originalContent.$el.detach()},render:function(){return this.$el.html(this.template(this.serialize())),this.subViews.originalContent=this.originalContent,this.subViews.loader=this.loader,this.subViews.postForm=this.postForm,this.attachSubViews(),this},afterRender:function(){return this.$el.addClass("post-forms-above-glass is_persistent"),this.renderSubViews()},beforeTeardown:function(){return this.subViews.loader=null,this},afterTeardown:function(){return this.$el.removeClass("post-forms-above-glass post-form-container-pretransition post-form-container-transition is_persistent"),this.loader&&(this.loader.remove(),this.loader=null),this.$el.children(".post-transition-background").remove(),delete this.postForm,this.trigger("torndown",this),this.teardownSubViews()}});e.exports=f},function(e,t,i){"use strict";var n=i(3),s=i(165).animate,o=i(149),r=i(204),a=i(160),l=o.extend({defaults:{hidden:!1,enabled:!0},mixins:[r,a],initialize:function(e){this.set("hasContent",e&&e.el),this.originalCSS=this._getCSS(["opacity"]),this.listenTo(this,"change:enabled",this._onChangeEnabled),this.listenTo(this,"change:hidden",this._onChangeHidden)},_getCSS:function(e){var t={};return n.forEach(e,function(e){t[e]=this.$el.css(e)},this),t},_onChangeEnabled:function(e,t){this.$el.toggleClass("no-pointer-events",!t)},_onChangeHidden:function(e,t){this.$el.toggleClass("collapse",t)},measureHeight:function(){if(!this.get("hasContent"))return null;var e=this.get("hidden");this.set("hidden",!1);var t=this.$el.outerHeight();return this.set("hidden",e),t},animateShow:function(e,t){return e||(e=0),t||(t=0),s(this.$el,{opacity:1},{duration:e,delay:t,begin:n.bind(function(){this.set("hidden",!1)},this)})},animateHide:function(e,t){return e||(e=0),t||(t=0),s(this.$el,{opacity:0},{duration:e,delay:t}).then(n.bind(function(){this.set("hidden",!0)},this))},render:function(){return this},teardown:function(){return this.$el.css(this.originalCSS),this}});e.exports=l},function(e,t,i){"use strict";var n=i(149),s=i(204),o=i(205),r=i(160),a=i(536),l=n.extend({className:"post-forms-loader",mixins:[s,o,r],template:a,initialize:function(e){this.listenTo(this,"change:loading",this._onChangeLoading),this.set("loading",e&&e.loading)},_onChangeLoading:function(e,t){this.isRendered()&&(t?(this.$el.addClass("loading"),this.$$(".Knight-Rider-loader").addClass("animate")):(this.$el.removeClass("loading"),this.$$(".Knight-Rider-loader").removeClass("animate")))},render:function(){return this.$el.html(this.template(this.attributes)),this}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="Knight-Rider-loader ',loading&&(__p+="animate"),__p+='"><div class="Knight-Rider-bar"></div><div class="Knight-Rider-bar"></div><div class="Knight-Rider-bar"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+="",transitionBackground&&(__p+=' <div class="post-transition-background"></div> '),__p+=" ",originalContent&&(__p+=' <div data-subview="originalContent"></div> '),__p+=' <div data-subview="loader"></div><div data-subview="postForm"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(121),o=i(165).animate,r=i(534),a=i(205),l=i(160),c=i(110),u=i(176),h=r.extend({mixins:[a,l],events:{"click [data-js-text]":"_onClickNewPost","click [data-js-photo]":"_onClickNewPost","click [data-js-quote]":"_onClickNewPost","click [data-js-link]":"_onClickNewPost","click [data-js-chat]":"_onClickNewPost","click [data-js-audio]":"_onClickNewPost","click [data-js-video]":"_onClickNewPost"},setPostType:function(e){this.postType=e},animateShow:function(e,t){return e||(e=0),t||(t=0),this.$el.css({display:"block",opacity:1}),function(i){var n=this.js$(i),r=n.children("i"),a=n.children(".new_post_label_text"),l=this.$(".new_post_label").not(n),c=l.children("i"),u=l.children(".new_post_label_text"),h=[o(c,{scale:1,translateY:[0,10],opacity:1},{duration:e,delay:t}),o(u,{translateY:[0,10],opacity:1},{duration:e,delay:t})];return n.length&&r.length&&h.push(o(r,{scale:[1,1.5],translateY:[0,0],opacity:1},{duration:e,delay:t}),o(a,{translateY:[0,0],opacity:1},{duration:e,delay:t})),s.all(h)}.call(this,this.postType)},animateHide:function(e,t){e||(e=0),t||(t=0),function(i){var n=this.js$(i),r=n.children("i"),a=n.children(".new_post_label_text"),l=this.$(".new_post_label").not(n),c=l.children("i"),u=l.children(".new_post_label_text"),h=[o(c,{scale:[1,1],translateY:[10,0],opacity:0},{duration:e,delay:t}),o(u,{translateY:[10,0],opacity:0},{duration:e,delay:t})];return n.length&&r.length&&h.push(o(r,{scale:[1.5,1],translateY:[0,0],opacity:0},{duration:e,delay:.5*e+t}),o(a,{translateY:[0,0],opacity:0},{duration:e,delay:t})),s.all(h)}.call(this,this.postType).then(n.bind(function(){this.$el.css({display:"none",opacity:0})},this))},_onClickNewPost:function(e){if(e.stopPropagation(),e.preventDefault(),this.get("enabled")){var t=e.currentTarget.getAttribute("data-post-endpoint")||e.currentTarget.getAttribute("data-post-type");c.trigger("postForms:open",{postType:t,postFormType:u.inline})}}});e.exports=h},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="post-tab-switching"><div class="tab-post-types count-'+(null==(__t=icons.length)?"":_.escape(__t))+'"> ',_.forEach(icons,function(e,t){__p+=' <div class="tab-post-type item" data-index="'+(null==(__t=t)?"":_.escape(__t))+'" data-post-type="'+(null==(__t=e.name)?"":_.escape(__t))+'"><div class="post-type-icon icon-'+(null==(__t=e.name)?"":_.escape(__t))+'"><i class="post-type-icon-overlay"></i></div><div class="post-type-name"><span class="post-type-name-span">'+(null==(__t=e.label)?"":_.escape(__t))+"</span></div></div> "}),__p+=" </div></div>";
return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(156),s=i(106),o=i(3),r=n.extend({events:{mouseleave:"onMouseLeave"},defaults:{totalImages:10,changeOnHover:!0,image:!1},initialize:function(){this.$rolloverImage=this.$("#rollover-image"),this.generateImageIds(),this.get("image")||this.applyRandomImage(),this.setBackgroundImage(this.get("image")),this.listenTo(this,"change:image",function(e,t){this.setBackgroundImage(t)})},generateImageIds:function(){this.imageIds=o.shuffle(o.range(1,this.get("totalImages")+1))},onMouseLeave:function(e){this.get("changeOnHover")&&this.applyRandomImage()},applyRandomImage:function(){0===this.imageIds.length&&this.generateImageIds(),this.set("image",this.imageIds[0]),this.imageIds.shift()},setBackgroundImage:function(e){var t=s.get("Context/hosts/assets_host"),i=t+"/images/logo/hover-animations/"+e+".gif";this.$rolloverImage.attr("xlink:href",i)}});e.exports=r},function(e,t,i){"use strict";var n=i(149),s=i(542),o=i(111),r=i(549),a=n.extend({events:{click:"openPopover"},addUnreadCount:function(){this.$el.append(r({value:this.user.getUnreadCount()}))},initialize:function(){this.popover=null,this.user=o(),this.addUnreadCount(),this.popoverOptions={container:this.$el,viewOptions:{}}},openPopover:function(e){if(e.preventDefault(),this.popover)this.popover.show();else{var t=this.$el.closest(".l-header-container");t.length&&(this.popoverOptions.viewOptions.isFixedPosition="fixed"===t.css("position")),this.popover=new s(this.popoverOptions).render()}}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(543),r=i(111),a=s.extend({name:"AccountPopover",view:function(e){return e=n.extend({},{model:r(),pinnedTarget:this.container,isFixedPosition:!0,autoTeardown:!1,teardownOnEscape:!1},e),new o(e)},show:function(){this.view.show()},render:function(){return this.view.render(),this.trigger("append"),this}});e.exports=a},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(174),r=i(385),a=i(156),l=i(544),c=i(110),u=i(150).transition,h=i(212),d=i(101),p=i(211),g=i(205),m=i(143),f=i(545),v=i(243),_=a.extend({className:"popover--account-popover",mixins:[p,g],template:l,defaults:{popoverData:{},preventInteraction:!0,order:[],sortable:null},events:{"click [data-js-action-logout]":"logout"},initialize:function(e){this.options=s.extend({},this.defaults,e),this.listenTo(this.model,"change:liked_post_count",this.onLikeCountChange),this.listenTo(this.model,"change:friend_count",this.onFollowingCountChange)},logout:function(e){e.preventDefault();var t=n(e.currentTarget),i=t.attr("href"),o={text:d("Are you sure you want to log out?"),animate_in:{dialog_class:"fade-in-up log-out-dialog"}};return this.hide(),m.confirm(o,s.bind(function(){c.trigger("logout"),window.location.href=i})),!1},numberFormat:function(e){return o(e).format("0,0")},render:function(){return this.$el.html(this.template({model:this.model.toJSON(),numberFormat:this.numberFormat})),this.$pinned.addClass("active"),this.renderUserChannels(),this.makeChannelsSortable(),this.$main=this.$el.find(".popover"),s.delay(s.bind(function(){this.$main.addClass("popover--active"),this.updateScrollbar(),this.bindClickOutside()},this),1),this.bindKeyNavigation(),this},updateScrollbar:function(){this.channelScrollBar&&this.channelScrollBar.update()},afterRender:function(){},bindClickOutside:function(){this.clickOutside=new h(this.el,{preventInteraction:!0}),this.clickOutside.on("click:outside",this.hide,this),this.listenTo(c,"DOMEventor:keyup:escape",this.hide)},unbindClickOutside:function(){this.clickOutside.remove(),this.clickOutside=null,this.stopListening(c,"DOMEventor:keyup:escape")},renderUserChannels:function(){var e=document.createDocumentFragment(),t=this.model.channels.models;if(t.length){var i=this.model.channels.findWhere({is_current:!0});i&&(s.pull(t,i),t.unshift(i)),s.each(t,s.bind(function(t){e.appendChild(this.renderUserChannelItem(t).el)},this)),this.firstItem=this.subviews[t[0].get("name")],this.firstItem.set({showImmediately:!0,uncloseable:!0,open:!0}),this.js$("channel-list").append(e),this.model.channels.length>1&&(s.defer(s.bind(this.addChannelScrollbar,this)),s.defer(s.bind(this.setOrder,this)))}},addChannelScrollbar:function(){this.channelScrollBar=new r(this.js$("channel-list")),this.js$("channel-list").addClass("popover_sublist popover_sublist--scrollable")},renderUserChannelItem:function(e){return this.subviews[e.get("name")]=new f({model:e}),this.listenTo(this.subviews[e.get("name")],"all",this._onSubviewEvent,this),this.subviews[e.get("name")].render()},_onSubviewEvent:function(){var e=s.toArray(arguments);e[0]="subview:"+e[0],this.trigger.apply(this,e)},_removeSubviewReference:function(e){e.off("all",this._onSubviewEvent,this)},makeChannelsSortable:function(){this.model.channels.length&&this.set("sortable",new v({el:this.js$("channel-list"),itemSelector:".popover_menu_item_blog",afterDragEnd:s.bind(this.saveOrder,this),transparentPlaceholder:!0,scrollable:!0}))},getOrder:function(){return s.map(this.get("sortable").sequence(),function(e){return e.replace("blog-list-item--","")})},setOrder:function(e){e||(e=this.getOrder()),this.set("order",e)},saveOrder:function(){if(this.model.channels.length<=1)return!1;var e=this.getOrder();s.isEqual(e,this.get("order"))||(this.setOrder(e),n.ajax({type:"POST",url:"/order",data:"channel_names="+JSON.stringify(e)}),this.firstItem.set({uncloseable:!1}))},hide:function(){this.$pinned.removeClass("active"),this.$main.removeClass("popover--active"),this.unbindClickOutside(),this.unbindKeyNavigation(),this.resetKeyboardSelection(),u(this.$el,s.bind(function(){this.afterHide()},this))},afterHide:function(){this.$el.css({display:"none"})},show:function(){this.bindKeyNavigation(),this.bindClickOutside(),this.$pinned.addClass("active"),this.$el.css({display:"block"}),s.delay(s.bind(function(){this.updateScrollbar(),this.$main.addClass("popover--active")},this),1)},bindKeyNavigation:function(){this.listenTo(c,"DOMEventor:keydown:up",this.highlightPreviousItem),this.listenTo(c,"DOMEventor:keydown:down",this.highlightNextItem),this.listenTo(c,"DOMEventor:keydown:left",this.collapseItem),this.listenTo(c,"DOMEventor:keydown:right",this.expandItem),this.listenTo(c,"DOMEventor:keydown:enter",this.openItemLink)},unbindKeyNavigation:function(){this.stopListening(c,"DOMEventor:keydown:up"),this.stopListening(c,"DOMEventor:keydown:down"),this.stopListening(c,"DOMEventor:keydown:left"),this.stopListening(c,"DOMEventor:keydown:right"),this.stopListening(c,"DOMEventor:keydown:enter")},highlightNextItem:function(e){e.preventDefault();var t=this.$el.find("[data-js-menu-item]:visible"),i=this.$el.find(".currentItem"),n=i.length>0?s.findIndex(t,i.get(0))+1:0;n===t.length&&(n=0);var o=t.get(n);this.highlightItem(o)},highlightPreviousItem:function(e){e.preventDefault();var t=this.$el.find("[data-js-menu-item]:visible"),i=s.findIndex(t,this.$el.find(".currentItem").get(0))-1;-1===i&&(i=t.length-1);var n=t.get(i);this.highlightItem(n)},highlightItem:function(e){this.resetKeyboardSelection();var t=n(e);t.addClass("currentItem"),this.scrollToItem(t)},scrollToItem:function(e){var t=this.js$("channel-list");if(e.closest(t).length){var i=e.closest(".popover_menu_item_blog--open");i.length>0&&(e=i);var n=t.offset().top,s=n+t.height(),o=e.offset().top,r=o+e.height(),a=0;o>=n&&s>=r||(a=n>o?o-n:r-s,t.animate({scrollTop:t.scrollTop()+a},100))}},resetKeyboardSelection:function(){this.$el.find(".currentItem").removeClass("currentItem")},expandItem:function(e){e.preventDefault(),this.$el.find(".currentItem.popover_menu_item_blog:not(.popover_menu_item_blog--open) [data-js-action-details-open]").trigger("click")},collapseItem:function(e){e.preventDefault();var t=this.$el.find(".currentItem.popover_menu_item_blog--open");if(t.length||(t=this.$el.find("[data-js-menu-item]:has(.currentItem)")),t.length>0){var i=t.find("[data-js-action-details-open]:visible");i.length>0&&(i.trigger("click"),this.highlightItem(t.get(0)))}},openItemLink:function(e){e.preventDefault();var t=this.$el.find(".currentItem [data-js-menu-item-link]:first");t.length>0&&t.get(0).click()},beforeTeardown:function(){return s.each(this.subviews,function(e){this._removeSubviewReference(e)},this),this.channelScrollBar&&this.channelScrollBar.destroy(),this.set("sortable",null),this.remove(),this.$pinned.removeClass("active"),this},onFollowingCountChange:function(){var e=this.model.get("friend_count");this.js$("following-count").text(0!==e?this.numberFormat(e):"")},onLikeCountChange:function(){var e=this.model.get("liked_post_count");this.js$("like-count").text(0!==e?this.numberFormat(e):"")}});e.exports=_},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="popover popover_menu popover_gradient"><div class="popover_inner"><ul data-js-account-list class="popover_inner_list"><li class="popover_subsection"><div class="popover_header"> '+(null==(__t=__("Account"))?"":_.escape(__t))+' <div class="popover_item_suffix"><a data-js-action-logout class="logout" href="/logout" id="logout_button">'+(null==(__t=__("Log out"))?"":_.escape(__t))+'</a></div></div><ul class="popover_menu_list"><li class="popover_menu_item" data-js-menu-item><a class="popover_menu_item_anchor" href="/likes" data-js-menu-item-link> ',model.liked_post_count&&model.liked_post_count>0&&(__p+=' <div class="popover_item_suffix" data-js-like-count>'+(null==(__t=numberFormat(model.liked_post_count))?"":_.escape(__t))+"</div> "),__p+=' <i class="popover_menu_item_anchor_icon like-icon"></i> '+(null==(__t=__("Likes"))?"":_.escape(__t))+" </a></li> ",model.friend_count&&model.friend_count>0&&(__p+=' <li class="popover_menu_item" data-js-menu-item><a class="popover_menu_item_anchor" href="/following" data-js-menu-item-link><div class="popover_item_suffix" data-js-following-count>'+(null==(__t=numberFormat(model.friend_count))?"":_.escape(__t))+'</div><i class="popover_menu_item_anchor_icon following-icon"></i> '+(null==(__t=__("Following"))?"":_.escape(__t))+" </a></li> "),__p+=' <li class="popover_menu_item" data-js-menu-item><a class="popover_menu_item_anchor" href="/settings" data-js-menu-item-link><i class="popover_menu_item_anchor_icon settings-icon"></i> '+(null==(__t=__("Settings"))?"":_.escape(__t))+' </a></li><li class="popover_menu_item" data-js-menu-item><a class="popover_menu_item_anchor" href="/help" data-js-menu-item-link><i class="popover_menu_item_anchor_icon help-icon"></i> '+(null==(__t=__("Help"))?"":_.escape(__t))+' </a></li></ul></li><li class="popover_subsection"><div class="popover_header"> '+(null==(__t=__("Tumblrs"))?"":_.escape(__t))+' <div class="popover_item_suffix"><a href="/new/blog">+&nbsp;'+(null==(__t=__("New"))?"":_.escape(__t))+'</a></div></div><ul class="popover_menu_list"><li class="popover_menu_sublist"><ul data-js-channel-list></ul></li></ul></li></ul></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(121),o=i(178),r=i(101),a=i(156),l=i(546),c=i(143),u=i(390),h=i(547),d=a.extend({tagName:"li",className:"popover_menu_item popover_menu_item_blog",template:l,events:{"click [data-js-action-details-open]":"onClickItem","click [data-js-menu-item-link]":"onClickBlogLink"},defaults:{open:!1,showImmediately:!1,detailsReady:!1,uncloseable:!1},initialize:function(){this.on("change:open",this.toggleOpen),this.on("change:uncloseable",this.toggleUncloseable),this.setAvatarSize(),this.$el.attr({id:"blog-list-item--"+this.model.get("name"),"data-js-menu-item":!0})},setAvatarSize:function(){var e=o(this.model.get("avatar_url"));this.set("avatarUrl",e(64))},toggleUncloseable:function(){this.$el.toggleClass("popover_menu_item_blog--uncloseable",this.get("uncloseable"))},toggleOpen:function(e,t){n.isObject(e)||(t=!!e),t?(this.toggleLoader(!0),this.toggleAnimate(!0),this.$el.addClass("popover_menu_item_blog--open")):(this.toggleAnimate(!1),this.$el.removeClass("popover_menu_item_blog--open"))},toggleLoader:function(e){e===!0?this.loader?this.loader.set("loading",!0):this.loader=new u({$container:this.$el,type:"bar",classModifiers:"top",loading:!0}):this.loader.set("loading",!1)},toggleAnimate:function(e,t){n.isObject(e)||(t=!!e),t?this.getDetailsView().then(n.bind(function(e){this.toggleLoader(!1),this.get("showImmediately")?(e.showImmediately(),this.set("showImmediately",!1)):e.show()},this))["catch"](n.bind(function(e){this.toggleLoader(!1),c.alert(r("Woops :(")),this.attributes.open=!1},this)):this.getDetailsView().then(function(e){e.hide()})["catch"](function(e){c.alert(r("Woops :("))})},onClickItem:function(e){e.preventDefault(),this.toggle("open")},onClickBlogLink:function(e){e.metaKey||this.toggleLoader(!0),e.stopPropagation()},isLoaded:function(){return this.model.has("follower_count")},loadDetails:function(){return this.model.fetch_analytics_data()},getDetailsView:function(){return s.promise(n.bind(function(e,t){return this.subviews.details?void e(this.subviews.details):void(this.isLoaded()?e(this.renderDetailsView()):this.loadDetails().then(n.bind(function(){e(this.renderDetailsView())},this))["catch"](function(e){t(e)}))},this))},renderDetailsView:function(){return this.subviews.details?this.subviews.details:(this.subviews.details=new h({model:this.model}),this.renderSubviews(),this.subviews.details)},teardown:function(){return this.remove(),this}});e.exports=d},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="blog-list-item blog-list-item--on-light '+(null==(__t=model.is_private_group_channel?"blog-list-item--private":"")?"":_.escape(__t))+'"> '+(null==(__t=_subview("loader"))?"":__t)+' <a data-js-action-blog-anchor data-js-menu-item-link class="blog-list-item-anchor" href="/blog/'+(null==(__t=model.name)?"":_.escape(__t))+'"><span class="blog-list-item-avatar"><img class="blog-list-item-avatar-image" alt="avatar" src="'+(null==(__t=avatarUrl)?"":_.escape(__t))+'"> ',model.unread_count>0&&(__p+=' <span class="blog-list-item-icon blog-list-item-unread-notice tab_notice tab-notice--outlined tab-notice--active on-light"><span class="tab_notice_value">'+(null==(__t=model.unread_count>99?"99+":model.unread_count)?"":_.escape(__t))+"</span></span> "),__p+=' </span><span class="blog-list-item-info"><span class="blog-list-item-info-name">'+(null==(__t=model.name)?"":_.escape(__t))+"</span>",model.is_private_group_channel&&(__p+='<i class="blog-list-item-icon blog-list-item-icon-private icon_lock_12"></i>'),__p+=' <br><span class="blog-list-item-info-title">'+(null==(__t=model.directory_safe_title)?"":__t)+'</span></span></a><a data-js-action-details-open class="blog-list-item-button blog-list-item-button-details icon_manburger"></a></div> '+(null==(__t=_subview("details"))?"":__t);return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(7),o=i(165),r=i(174),a=i(156),l=i(548),c=a.extend({template:l,className:"popover_menu_item_blog_details",serialize:function(){return{isSelected:this.isSelected,numberFormat:this.numberFormat}},isSelected:function(e){var t="/"+s.history.fragment;return t===e},numberFormat:function(e){return r(e).format("0,0")},addSparkline:function(){var e=this.$el.find(".sparkline"),t=JSON.parse(this.model.get("activity_data").sparkline);t&&0!==n.max(t)&&n.isFunction(e.sparkline)&&(e.sparkline(t,{type:"line",lineColor:"#7f7f7f",fillColor:!1,lineWidth:4,spotColor:!1,minSpotColor:!1,maxSpotColor:!1,disableInteraction:!0,width:"72px",height:"30px"}),e.find("canvas").css({height:"15px",width:"36px"}))},beforeRender:function(){this.stopListening()},afterRender:function(){this.$detailsInner=this.$("[data-blog-details-inner]"),this.listenTo(this.model,"change",function(e){n.any(e.changed,function(e,t){return t.match(/_count$/i)})&&this.render()}),n.defer(n.bind(this.addSparkline,this))},show:function(){this.animateOpen()},hide:function(){this.animateClosed()},animateOpen:function(){var e=this.$detailsInner.outerHeight();return o(this.$el,{height:e},{duration:250,easing:"ease-in-out"})},animateClosed:function(){return o(this.$el,{height:0},{duration:250,easing:"ease-in-out"})},showImmediately:function(){this.$el.css({height:"auto"})},teardown:function(){return this.remove(),this}});e.exports=c},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<ul data-blog-details-inner class="blog-sub-nav-details"><li class="blog-sub-nav-item ',isSelected("/blog/"+model.name)&&(__p+="selected"),__p+='" data-js-menu-item><a href="/blog/'+(null==(__t=model.name)?"":_.escape(__t))+'" class="blog-sub-nav-item-link" data-js-menu-item-link><div class="blog-sub-nav-item-label">'+(null==(__t=__("Posts"))?"":_.escape(__t))+"</div> ",model.post_count>0&&(__p+=' <div class="blog-sub-nav-item-data">'+(null==(__t=numberFormat(model.post_count))?"":_.escape(__t))+"</div> "),__p+=" </a></li> ",model.radar_feature_premium&&(__p+=' <li class="blog-sub-nav-item ',isSelected("/radar/analytics")&&(__p+="selected"),__p+='" data-js-menu-item><a href="/radar/analytics" class="blog-sub-nav-item-link" data-js-menu-item-link><div class="blog-sub-nav-item-label">'+(null==(__t=__("Reach"))?"":_.escape(__t))+"</div></a></li> "),__p+=' <li class="blog-sub-nav-item ',isSelected("/blog/"+model.name+"/followers")&&(__p+="selected"),__p+='" data-js-menu-item><a href="/blog/'+(null==(__t=model.name)?"":_.escape(__t))+'/followers" class="blog-sub-nav-item-link" data-js-menu-item-link><div class="blog-sub-nav-item-label">'+(null==(__t=__("Followers"))?"":_.escape(__t))+"</div> ",model.follower_count>0&&(__p+=' <div class="blog-sub-nav-item-data">'+(null==(__t=numberFormat(model.follower_count))?"":_.escape(__t))+"</div> "),__p+=" </a></li> ",model.activity_data&&model.activity_data.sparkline&&(__p+=' <li class="blog-sub-nav-item ',isSelected("/blog/"+model.name+"/activity")&&(__p+="selected"),__p+='" data-js-menu-item><a href="/blog/'+(null==(__t=model.name)?"":_.escape(__t))+'/activity" class="blog-sub-nav-item-link" data-js-menu-item-link><div class="blog-sub-nav-item-label">'+(null==(__t=__("Activity"))?"":_.escape(__t))+'</div><div class="blog-sub-nav-item-data sparkline" data-sparkline="'+(null==(__t=model.activity_data.sparkline)?"":_.escape(__t))+'"></div></a></li> '),__p+=" ",model.member_count>0&&(__p+=' <li class="blog-sub-nav-item ',isSelected(model.dashboard_url+"/members")&&(__p+="selected"),__p+='" data-js-menu-item><a href="'+(null==(__t=model.dashboard_url)?"":_.escape(__t))+'/members" class="blog-sub-nav-item-link" data-js-menu-item-link><div class="blog-sub-nav-item-label">'+(null==(__t=__("Members"))?"":_.escape(__t))+'</div><div class="blog-sub-nav-item-data">'+(null==(__t=numberFormat(model.member_count))?"":_.escape(__t))+"</div></a></li> "),__p+=" ",model.draft_count>0&&(__p+=' <li class="blog-sub-nav-item ',isSelected(model.dashboard_url+"/drafts")&&(__p+="selected"),__p+='" data-js-menu-item><a href="'+(null==(__t=model.dashboard_url)?"":_.escape(__t))+'/drafts" class="blog-sub-nav-item-link" data-js-menu-item-link><div class="blog-sub-nav-item-label">'+(null==(__t=__("Drafts"))?"":_.escape(__t))+'</div><div class="blog-sub-nav-item-data">'+(null==(__t=numberFormat(model.draft_count))?"":_.escape(__t))+"</div></a></li> "),__p+=" ",model.queued_post_count>0&&(__p+=' <li class="blog-sub-nav-item ',isSelected(model.dashboard_url+"/queue")&&(__p+="selected"),__p+='" data-js-menu-item><a href="'+(null==(__t=model.dashboard_url)?"":_.escape(__t))+'/queue" class="blog-sub-nav-item-link" data-js-menu-item-link><div class="blog-sub-nav-item-label">'+(null==(__t=__("Queue"))?"":_.escape(__t))+'</div><div class="blog-sub-nav-item-data">'+(null==(__t=numberFormat(model.queued_post_count))?"":_.escape(__t))+"</div></a></li> "),__p+=" ",model.transcoding_count>0&&(__p+=' <li class="blog-sub-nav-item ',isSelected(model.dashboard_url+"/processing")&&(__p+="selected"),__p+='" data-js-menu-item><a href="'+(null==(__t=model.dashboard_url)?"":_.escape(__t))+'/processing" class="blog-sub-nav-item-link" data-js-menu-item-link><div class="blog-sub-nav-item-label">'+(null==(__t=__("Processing"))?"":_.escape(__t))+'</div><div class="blog-sub-nav-item-data">'+(null==(__t=numberFormat(model.transcoding_count))?"":_.escape(__t))+"</div></a></li> "),__p+=" ",model.is_visible_premium_partner&&(__p+=' <li class="blog-sub-nav-item ',isSelected(model.analytics_url)&&(__p+="selected"),__p+='" data-js-menu-item><a href="'+(null==(__t=model.analytics_url)?"":_.escape(__t))+'" class="blog-sub-nav-item-link" data-js-menu-item-link><div class="blog-sub-nav-item-label">'+(null==(__t=__("Analytics"))?"":_.escape(__t))+"</div></a></li> "),__p+=" ",model.can_view_customize&&(__p+=' <li class="blog-sub-nav-item ',isSelected("/settings/blog/"+model.name)&&(__p+="selected"),__p+='" data-js-menu-item><a href="/settings/blog/'+(null==(__t=model.name)?"":_.escape(__t))+'" class="blog-sub-nav-item-link" data-js-menu-item-link><div class="blog-sub-nav-item-label">'+(null==(__t=__("Edit appearance"))?"":_.escape(__t))+"</div></a></li> "),__p+=" </ul>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<span class="tab_notice tab-notice--outlined ',value>0&&(__p+="tab-notice--active"),__p+='"><span class="tab_notice_value">'+(null==(__t=value)?"":_.escape(__t))+"</span></span>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(149),s=i(110),o=i(551),r=i(111),a=n.extend({events:{click:"openPopover"},addUnreadCount:function(){},initialize:function(){this.popover=null,this.user=r(),this.addUnreadCount(),this.popoverOptions={container:this.$el,viewOptions:{}}},openPopover:function(e){if(e.preventDefault(),this.popover)this.popover.show();else{var t=this.$el.closest(".l-header-container");t.length&&(this.popoverOptions.viewOptions.isFixedPosition="fixed"===t.css("position")),this.popover=new o(this.popoverOptions).render()}s.trigger("activityLinks:click",{loggingData:{source:"app-header"}})}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(552),r=i(111),a=s.extend({name:"ActivityPopover",view:function(e){return e=n.extend({},{model:r(),pinnedTarget:this.container,isFixedPosition:!0,autoTeardown:!1,teardownOnEscape:!1},e),new o(e)},show:function(){this.view.show()},render:function(){return this.view.render(),this.trigger("append"),this}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(101),r=i(156),a=i(553),l=i(110),c=i(192),u=i(211),h=i(212),d=i(150).transition,p=i(121),g=i(554),m=i(558),f=i(560),v=i(143),_=i(390),b=r.extend({defaults:{popoverData:{},preventInteraction:!0,currentTumblelog:!1},className:"popover--activity-popover",mixins:[u],template:a,initialize:function(e){if(this.options=n.extend({},this.defaults,e),!this.get("currentTumblelog")){var t=this.model.channels.findWhere({is_current:!0});this.set("currentTumblelog",t)}},render:function(){return this.$el.html(this.template()),this.$pinned.addClass("active"),this.$activityNotifications=this.$(".activity-popover-notifications"),this.$activityHeader=this.$(".activity-popover-header"),this.$activityPopoverMenu=this.$(".popover_menu"),n.delay(n.bind(function(){this.$activityPopoverMenu.addClass("popover--active"),this.bindClickOutside(),this.addTumblelogPopoverZIndex()},this),1),this.subviews.tumblelogSelect=new g({className:"activity-popover-tumblelog-select-container",collection:this.model.channels,dropdownClass:"popover--activity-popover-tumblelog-select-dropdown",popoverOptions:{popoverContainer:".popover--activity-popover"}}),this.prepareActivityNotifications(),this.listenTo(this.subviews.tumblelogSelect,"change:currentTumblelog",this.updateSubviews),this},addTumblelogPopoverZIndex:function(){this.$el.attr("data-tumblelog-popover-zindex",this.$el.css("z-index"))},bindClickOutside:function(){var e={preventInteraction:!0,ignoreSelectors:[".popover_content_wrapper",".tumblelog_popover",".ui_peepr_glass",".drawer"]};this.clickOutside=new h(this.el,e),this.clickOutside.on("click:outside",this.hide,this),this.clickOutside.on("click:inside",this.hideActivityPopover,this),this.listenTo(l,"DOMEventor:keyup:escape",this.hide)},unbindClickOutside:function(){this.clickOutside.remove(),this.clickOutside=null,this.stopListening(l,"DOMEventor:keyup:escape")},createSubviews:function(){this.removeSubviews(),this.toggleLoader(!1),this.subviews.sparkline=new m({model:this.get("currentTumblelog")}),this.subviews.activityNotifications=new f({model:this.get("currentTumblelog")}),this.rendered&&(this.appendSubview(this.subviews.sparkline,this.$activityHeader),this.appendSubview(this.subviews.activityNotifications,this.$activityNotifications))},hasNecessaryData:function(){return this.get("currentTumblelog").has("activity_notifications")},loadData:function(){return this.get("currentTumblelog").fetch_activity_notifications()},prepareActivityNotifications:function(){return p.promise(n.bind(function(e,t){this.hasNecessaryData()?e(this.createSubviews()):(this.toggleLoader(!0),this.loadData().then(n.bind(function(){e(this.createSubviews())},this))["catch"](function(e){t(e)}))},this))["catch"](n.bind(function(e){this.toggleLoader(!1),v.alert(o("Woops :("))},this))},updateSubviews:function(e,t){this.set("currentTumblelog",t),this.prepareActivityNotifications()},removeSubviews:function(){this.subviews&&n.each(this.subviews,function(e){e.get("removable")&&e.remove()})},toggleLoader:function(e){e===!0?this.loader?this.loader.set("loading",!0):this.loader=new _({$container:this.$el,type:"bar",classModifiers:"bottom",loading:!0}):this.loader&&this.loader.set("loading",!1)},beforeTeardown:function(){return this.remove(),this.$pinned.removeClass("active"),this},hideActivityPopover:function(e){var t=s(e.target),i=t.closest(".tumblelog_popover"),o=t.closest("[href]");n.isEmpty(i)||n.isEmpty(o)||!c.isTumblelogUrl(o.attr("href"))||this.hide()},hide:function(){this.unbindClickOutside(),this.$pinned.removeClass("active"),this.$activityPopoverMenu.removeClass("popover--active"),d(this.$el,n.bind(function(){this.afterHide()},this))},afterHide:function(){this.$el.css({display:"none"})},show:function(){this.bindClickOutside(),this.$pinned.addClass("active"),this.$el.css({display:"block"}),n.delay(n.bind(function(){this.$activityPopoverMenu.addClass("popover--active")},this),1)}});e.exports=b},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="popover popover_menu popover_gradient"><div class="popover_inner"><div class="activity-popover-header"> '+(null==(__t=_subview("tumblelogSelect"))?"":__t)+" "+(null==(__t=_subview("sparkline"))?"":__t)+" "+(null==(__t=_subview("loader"))?"":__t)+' </div><div class="activity-popover-notifications"> '+(null==(__t=_subview("activityNotifications"))?"":__t)+" </div></div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(555),r=i(556),a=i(205),l=i(178),c=s.extend({template:o,mixins:[a],defaults:{currentTumblelog:!1,isOpen:!1,requiresDropdown:!1,showCaret:!0,showName:!0,dropdownClass:null,popoverOptions:null,avatarSize:96,badgeCountField:null,showTotalBadge:!0,showNumberInBadge:!1,includeCurrentBlogInTotalBadge:!1,maxBadgeCount:99,badgeActiveClass:"has-badge"},events:{"click [data-js-button]":"toggleDropdown"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"collection")),this.get("currentTumblelog")||this.set("currentTumblelog",this.collection.findWhere({is_current:!0})),this.set("requiresDropdown",this.collection.length>1),!n.isEmpty(this.get("badgeCountField"))&&this.get("requiresDropdown")||this.set("showTotalBadge",!1)},getTemplateData:function(){var e=this.get("showTotalBadge"),t=e&&this.get("showNumberInBadge"),i=e?this.getBadgeCount():null;return{avatarUrl:l(this.getCurrentTumblelogProperty("avatar_url"),this.get("avatarSize")),displayName:this.getCurrentTumblelogProperty("name"),requiresDropdown:this.get("requiresDropdown"),hasBadge:e&&i>0,badgeCountString:t?this.getBadgeCountString(i):null}},createDropdown:function(){var e=n.extend({},this.get("popoverOptions"),{identifier:"blogSelector:dropdown",pinnedTarget:this.js$("avatar"),shift:{x:86,y:10},collection:this.collection,currentTumblelog:this.getCurrentTumblelog(),badgeCountField:this.get("badgeCountField"),maxBadgeCount:this.get("maxBadgeCount")});this.dropdown=new r(e),this.get("dropdownClass")&&this.dropdown.$el.addClass(this.get("dropdownClass")),this.listenTo(this.dropdown,"change:currentTumblelog",this.adjustCurrentTumblelog),this.listenTo(this.dropdown,"open",this._onDropdownOpen),this.listenTo(this.dropdown,"close",this._onDropdownClose)},_onDropdownOpen:function(){this.set("isOpen",!0)},_onDropdownClose:function(){this.set("isOpen",!1)},_onChangeIsOpen:function(e,t){this.js$("caret").toggleClass("is-open",t)},toggleDropdown:function(){this.get("requiresDropdown")&&(this.dropdown.isOrWasRecentlyRendered()||(this.createDropdown(),this.dropdown.render()))},afterRender:function(){return this.get("showTotalBadge")&&(this.listenTo(this.collection,"change:"+this.get("badgeCountField"),this._onBadgeCountChange),this._onBadgeCountChange()),this.get("requiresDropdown")&&(this.createDropdown(),this.js$("button").addClass("has-dropdown"),this.listenTo(this,"change:isOpen",this._onChangeIsOpen),this.listenTo(this,"change:showCaret",this._onChangeShowCaret),this._onChangeIsOpen(this,this.get("isOpen")),this._onChangeShowCaret(this,this.get("showCaret"))),this.listenTo(this,"change:showName",this._onChangeShowName),this._onChangeShowName(this,this.get("showName")),this},getCurrentTumblelog:function(){return this.get("currentTumblelog")},getCurrentTumblelogProperty:function(e){var t=this.getCurrentTumblelog();return t&&t.has(e)&&n.isString(e)?t.get(e):void 0},adjustCurrentTumblelog:function(){var e;this.set("currentTumblelog",this.dropdown.get("currentTumblelog")),this.rendered&&(e=l(this.getCurrentTumblelogProperty("avatar_url"),this.get("avatarSize")),this.js$("avatar").attr("src",e),this.js$("label").text(this.getCurrentTumblelogProperty("name")),this.get("showTotalBadge")&&!this.get("includeCurrentBlogInTotalBadge")&&this._onBadgeCountChange())},teardown:function(){return this.remove(),this},getBadgeCount:function(){var e,t=this.get("currentTumblelog");return this.get("badgeCountField")?(e=n.sum(this.collection.pluck(this.get("badgeCountField"))),t&&!this.get("includeCurrentBlogInTotalBadge")&&(e-=t.get(this.get("badgeCountField"))),Math.max(0,e)):null},getBadgeCountString:function(e){var t=this.get("maxBadgeCount");return e>t?t+"+":e>0?e:""},updateBadge:function(e){var t=this.js$("badge");t.toggleClass(this.get("badgeActiveClass"),e>0),this.get("showNumberInBadge")&&t.text(this.getBadgeCountString(e))},_onBadgeCountChange:function(){this.updateBadge(this.getBadgeCount())},_onChangeShowCaret:function(e,t){this.js$("caret").toggle(t)},_onChangeShowName:function(e,t){this.js$("label").toggle(t)}});e.exports=c},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";
Array.prototype.join;with(obj||{})__p+='<div class="blog-selector-container"><div class="selected-blog" data-js-button><img class="avatar" src="'+(null==(__t=avatarUrl)?"":_.escape(__t))+'" alt="'+(null==(__t=displayName)?"":__t)+'" data-js-avatar> <span class="name" data-js-label>'+(null==(__t=displayName)?"":__t)+"</span> ",requiresDropdown&&(__p+=' <span class="caret '+(null==(__t=hasBadge?"has-badge":"")?"":_.escape(__t))+'" data-js-caret data-js-badge>',badgeCountString&&(__p+=""+(null==(__t=badgeCountString)?"":_.escape(__t))),__p+="</span> "),__p+=" </div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(557),r=i(211),a=i(205),l=i(178),c=i(385),u=s.extend({className:"popover--blog-selector-dropdown",events:{"click [data-js-tumblelog]":"selectBlog"},mixins:[a,r],template:o,defaults:{currentTumblelog:!1,avatarSize:96,badgeCountField:null,maxBadgeCount:99,badgeActiveClass:"tab-notice--active"},initialize:function(e){if(e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"collection")),!this.get("currentTumblelog")){var t=this.collection.findWhere({is_current:!0});this.set("currentTumblelog",t)}},selectBlog:function(e){var t=this.$(e.currentTarget).index();this.set("currentTumblelog",this.collection.at(t)),this.teardown()},createScrollbar:function(){this.scrollbar||(this.scrollbar=new c(this.js$("scrollbar")))},afterRender:function(){return this.js$("scrollbar").addClass("popover-sublist popover-sublist--scrollable"),n.defer(n.bind(this.createScrollbar,this)),this.delegateEvents(),this.isShowBadges()&&this.listenTo(this.collection,"change:"+this.get("badgeCountField"),this._onBadgeCountChange),this},isShowBadges:function(){return!n.isEmpty(this.get("badgeCountField"))},getBadgeCount:function(e){return this.get("badgeCountField")&&e?e.get(this.get("badgeCountField")):null},getBadgeCountString:function(e){var t=this.get("maxBadgeCount");return 0>=e?"":e>t?t+"+":e},getTemplateData:function(){var e,t=this.toJSON(),i=this.get("currentTumblelog");return i&&n.extend(t,{currentTumblelog:i.get("name")}),e=this.collection.map(function(e){return n.extend({avatarUrl:l(e.get("avatar_url"),this.get("avatarSize")),displayName:e.getDisplayName(),badgeCountString:this.getBadgeCountString(this.getBadgeCount(e))},e.toJSON())},this),n.extend(t,{channels:e,isShowBadges:this.isShowBadges()}),t},beforeTeardown:function(){this.scrollbar&&(this.scrollbar.destroy(),this.scrollbar=null),this.stopListening()},teardown:function(){return this.remove()},updateBadge:function(e){var t,i=this.$$("[data-js-channel-badge="+e.get("name")+"]");0!==i.length&&(t=this.getBadgeCount(e),i.toggleClass(this.get("badgeActiveClass"),t>0),t>0&&i.find("[data-js-channel-badge-text]").text(this.getBadgeCountString(t)))},_onBadgeCountChange:function(e){return this.updateBadge(e)}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="pop-menu"><ul class="inner select-right" data-js-scrollbar> ',_.forEach(channels,function(e){__p+=' <li class="item-option '+(null==(__t=e.name===currentTumblelog?"selected":"")?"":_.escape(__t))+'" data-js-tumblelog><div class="avatar"><img src="'+(null==(__t=e.avatarUrl)?"":_.escape(__t))+'" alt="'+(null==(__t=e.name)?"":_.escape(__t))+'"> ',isShowBadges&&(__p+=' <span class="unread-indicator tab_notice tab-notice--outlined on-light ',e.badgeCountString&&(__p+="tab-notice--active "),__p+='" data-js-channel-badge="'+(null==(__t=e.name)?"":_.escape(__t))+'"><span class="tab_notice_value" data-js-channel-badge-text>'+(null==(__t=e.badgeCountString)?"":_.escape(__t))+"</span></span> "),__p+=' </div><div class="info-container"><p class="name">'+(null==(__t=e.displayName)?"":_.escape(__t))+'</p><p class="title">'+(null==(__t=e.directory_safe_title)?"":__t)+"</p></div></li> "}),__p+=" </ul></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(559),r=s.extend({template:o,className:"activity-popover-sparkline-container",defaults:{removable:!0,sparklineFormatting:{type:"line",lineColor:"#7f7f7f",fillColor:!1,lineWidth:4,spotColor:!1,minSpotColor:!1,maxSpotColor:!1,disableInteraction:!0,width:"72px",height:"30px"}},getTemplateData:function(){return{activityPageUrl:"/blog/"+this.model.get("name")+"/activity"}},addSparkline:function(){var e=this.$el.find(".sparkline"),t=JSON.parse(this.model.get("activity_data").sparkline);t&&0!==n.max(t)&&n.isFunction(e.sparkline)&&(e.sparkline(t,this.get("sparklineFormatting")),e.find("canvas").css({height:"15px",width:"36px"}))},afterRender:function(){n.defer(n.bind(this.addSparkline,this))},teardown:function(){return this.remove(),this}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<a class="activity-popover-sparkline-link" href="'+(null==(__t=activityPageUrl)?"":__t)+'" title="Activity"><div class="sparkline"></div></a>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(561),r=i(205),a=i(385),l=i(562),c=i(576),u=i(578),h=i(10),d=s.extend({className:"blog-activity",template:o,mixins:[r],defaults:{removable:!0},initialize:function(){},addChannelScrollbar:function(){this.notificationScrollBar=new a(this.js$("blog-activity-notification-list"))},afterRender:function(){this.model.get("activity_notifications").length>1&&(n.defer(n.bind(this.addChannelScrollbar,this)),this.js$("blog-activity-notification-list").addClass("popover_sublist popover_sublist--scrollable"),this.createSubviews())},beforeTeardown:function(){this.notificationScrollBar&&this.notificationScrollBar.destroy()},createSubviews:function(){for(var e,t=this.model.get("activity_notifications"),i=0;i<t.length;i++){var n=!1,s=h.unix(t[i].timestamp).startOf("day");if(e&&s.fromNow()===e.fromNow()||(n=s),n){t[i].dateHeader=n;var o=new c({model:new u(t[i])});this.appendSubview(o,"ul[data-js-blog-activity-notification-list]")}var r=new l({model:new u(t[i])});this.appendSubview(r,"ul[data-js-blog-activity-notification-list]"),e=h.unix(t[i].timestamp).startOf("day")}},teardown:function(){return this.remove(),this}});e.exports=d},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="",__p+=model.activity_notifications.length>1?' <div class="blog-activity-content"><ul data-js-blog-activity-notification-list class="ui_notes"></ul></div><a href="/blog/'+(null==(__t=model.name)?"":_.escape(__t))+'/activity" class="blog-activity-more">'+(null==(__t=__("See everything"))?"":_.escape(__t))+"</a> ":' <div class="blog-activity--empty"><i class="icon_activity"></i><p class="blog-activity--empty-text">'+(null==(__t=__("Check out this tab when you make a post to see Likes, Reblogs, and new followers."))?"":_.escape(__t))+"</p></div> ",__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(563),r=i(120),a=i(564),l=i(150).animation,c=s.extend({tagName:"li",className:"blog-activity-notification",template:o,events:{"click .plus-follow-button":"onClickFollow"},defaults:{tumblelogToFollow:!1,followSource:"FOLLOW_SOURCE_ACTIVITY_POPOVER"},initialize:function(e){if(this.options=n.defaults(e,this.defaults),!this.model.get("is_friend")&&!this.get("tumblelogToFollow")){var t=this.model.get("from_tumblelog");t&&(this.set("tumblelogToFollow",new r({name:t.name})),this.listenTo(this.get("tumblelogToFollow"),"change:following",this.onFollow))}},beforeRender:function(){var e="";this.model.get("new_post")&&this.model.get("new_post").url?e=this.model.get("new_post").url:this.model.get("post")&&this.model.get("post").url?e=this.model.get("post").url:this.model.get("from_tumblelog")&&this.model.get("from_tumblelog").tumblr_url&&(e=this.model.get("from_tumblelog").tumblr_url),this.model.set("clickthrough_url",e)},afterRender:function(){this.$tumblelogLink=this.$(".notification-tumblelog-link"),this.$followButton=this.$(".plus-follow-button"),this.$ui_post_badge=this.$(".ui_post_badge");var e=this.model.get("post"),t={},i="",s=e?e.type:"regular";switch(s){case"photo":case"photoset":t.backgroundImage="url('"+e.media_url+"')";break;case"video":e.video_thumbnail_url&&(t.backgroundImage="url('"+e.video_thumbnail_url+"')",i="has_video_thumbnail");break;case"note":e.is_ask?i="ask":e.is_answer&&(i="ask_answer");break;case"postcard":i="fanmail"}this.$tumblelogLink&&(this.$tumblelogLink.addClass("js-hover-trigger-TumblelogPopover"),this.$(".notification-tumblelog-link, .avatar").hoverIntent({over:n.bind(this.showBlogCardPopover,this),out:n.noop,sensitivity:3})),this.$ui_post_badge.css(t).addClass(i)},onClickFollow:function(e){e.preventDefault(),this.$followButton.closest(".ui_note").addClass("is_friend"),this.get("tumblelogToFollow").follow({tumblelog:this.get("tumblelogToFollow").name})},onFollow:function(e,t){l(this.$followButton,n.bind(function(){this.hideFollowButton()},this)),this.$followButton.toggleClass("follow_poof",t)},hideFollowButton:function(){this.$followButton.css({display:"none"})},showBlogCardPopover:function(){this.popover&&(this.popover.teardown(),this.popover=null),this.popover=new a({model:this.get("tumblelogToFollow"),pinnedTarget:this.$el}),this.popover.$el.css("z-index",this.$el.closest(".popover").css("z-index")),this.popover.openPopover()},teardown:function(){return this.remove(),this}});e.exports=c},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="ui_note '+(null==(__t=model.type)?"":_.escape(__t))+" "+(null==(__t=model.from_tumblelog&&model.from_tumblelog.is_friend?" is_friend":"")?"":_.escape(__t))+'" data-timestamp="'+(null==(__t=model.timestamp)?"":_.escape(__t))+'" data-tumblelog-name="'+(null==(__t=model.from_tumblelog?model.from_tumblelog.name:"")?"":_.escape(__t))+'"><div class="stage"><div class="part_activity"><div class="part_main"><span class="activity"> '+(null==(__t=model.message)?"":__t)+" ",model.post&&model.post.summary&&(__p+=' <span class="summary">&#8220;'+(null==(__t=model.post.summary)?"":_.escape(__t))+"&#8221;</span> "),__p+=' </span></div></div><a class="part_glass" target="_blank" href="'+(null==(__t=model.clickthrough_url)?"":_.escape(__t))+'"></a><div class="part_avatar"> ',__p+=model.from_tumblelog?' <div class="ui_avatar"><div data-avatar-url="'+(null==(__t=model.from_tumblelog.avatar_url_128)?"":_.escape(__t))+'" target="_blank" class="ui_avatar_link frame '+(null==(__t=model.type)?"":_.escape(__t))+'" title="'+(null==(__t=model.from_tumblelog.name)?"":_.escape(__t))+'"><a href="'+(null==(__t=model.from_tumblelog.tumblr_url)?"":_.escape(__t))+'" class="avatar" style="background-image: url(\''+(null==(__t=model.from_tumblelog.avatar_url_48)?"":_.escape(__t))+'\')"><div class="inner_frame"></div><div class="avatar_glass"></div><span class="ui_avatar_tumblelog_name">'+(null==(__t=model.from_tumblelog.name)?"":_.escape(__t))+"</span></a></div></div> ":' <div class="ui_avatar"><div data-avatar-url="/images/anonymous_avatar_64.gif" target="_blank" class="ui_avatar_link frame '+(null==(__t=model.type)?"":_.escape(__t))+'" title="Anonymous"><div class="avatar" style="background-image: url(\'/images/anonymous_avatar_64.gif\')"><div class="inner_frame"></div><div class="avatar_glass"></div><span class="ui_avatar_tumblelog_name"></span></div></div></div> ',__p+=' </div><div class="part_icon"> ',!model.from_tumblelog||model.from_tumblelog.is_friend||"follower"!==model.type&&"user_mention"!==model.type?model.post&&(__p+=' <a href="'+(null==(__t=model.post.url)?"":_.escape(__t))+'" target="_blank" class="ui_post_badge '+(null==(__t=model.post.type)?"":_.escape(__t))+'"><div class="inner_frame"></div></a> '):__p+=' <a class="note_follow plus-follow-button blue" href="/follow/'+(null==(__t=model.from_tumblelog.name)?"":_.escape(__t))+'" data-tumblelog-name="'+(null==(__t=model.from_tumblelog.name)?"":_.escape(__t))+'" title="'+(null==(__t=__("Follow"))?"":_.escape(__t))+'"><span class="icon_plus follow_icon"></span></a> ',__p+=" </div> ",model.note_meta&&(model.note_meta.answer_text||model.note_meta.reply_text)?__p+=' <div class="part_response '+(null==(__t=model.note_meta.answer_text?"is_part_answer":"")?"":_.escape(__t))+" "+(null==(__t=model.note_meta.reply_text?"is_part_reply":"")?"":_.escape(__t))+'"><blockquote> '+(null==(__t=model.note_meta.answer_text?model.note_meta.answer_text:"")?"":_.escape(__t))+" "+(null==(__t=model.note_meta.reply_text?model.note_meta.reply_text:"")?"":_.escape(__t))+" </blockquote></div> ":"reblog"===model.type&&model.new_post&&model.new_post.diff?__p+=' <div class="part_response is_part_reblog"><blockquote> '+(null==(__t=model.new_post.diff)?"":_.escape(__t))+" </blockquote></div> ":"user_mention"==model.type&&model.new_post&&model.new_post.quote&&(__p+=' <div class="part_response is_part_user_mention"><blockquote> '+(null==(__t=model.new_post.quote)?"":__t)+" </blockquote></div> "),__p+=" </div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(110),a=i(204),l=i(211),c=i(565),u=o.extend({mixins:[a,l],className:"tumblelog_popover popover popover--blog-card",blogCardView:null,initialize:function(e){e||(e={}),e.identifier="TumblelogPopover",this.$targetPost=s(e.pinnedTarget).closest(".post"),o.prototype.initialize.call(this,e)},openPopover:function(){return this.blogCardView?(this.render(),this):(this.blogCardView=new c({model:this.model,targetPost:this.$targetPost}),void this.listenToOnce(this.blogCardView,"ready",this.render))},closePopover:function(){this.animateOut(),n.delay(n.bind(this.teardown,this),250)},onMouseMove:function(e){this.overElement(e,this.$el)||this.overElement(e,this.$pinned)?this.teardownTimer&&(clearTimeout(this.teardownTimer),this.teardownTimer=null):this.teardownTimer||(this.teardownTimer=n.delay(n.bind(this.closePopover,this),300))},overElement:function(e,t){var i=t.offset();return e.pageX>i.left&&e.pageY>i.top&&e.pageX<i.left+t.outerWidth()&&e.pageY<i.top+t.outerHeight()},render:function(){return this.blogCardView.render(),this.$el.html(this.blogCardView.el),n.defer(n.bind(this.animateIn,this)),this.boundMouseMove=n.bind(this.onMouseMove,this),s("body").on("mousemove",this.boundMouseMove),this._logOpen(),this},animateIn:function(){return this.$el.css("opacity",1),this},animateOut:function(){return this.$el.css("opacity",0),this},_logOpen:function(){r.trigger("popover:blogcard:open",{loggingData:{blog:this.model.get("name")}})},teardown:function(){return s("body").off("mousemove",this.boundMouseMove),this.$el.remove(),this}});e.exports=u},function(e,t,i){"use strict";e.exports=i(566)},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(567),r=i(574),a=s.extend({defaults:{include_info_popover:!0,disableUnfollowConfirm:!1},className:"poptica_header",initialize:function(e){this.options=n.extend({},this.defaults,e);var t=n.extend({model:this.model},n.pick(this.options,"targetPost","include_info_popover","disableUnfollowConfirm"));this.header=new o(t),this.posts=new r({model:this.model}),this.bindEvents()},bindEvents:function(){this.listenToOnce(this.header,"ready",this._triggerReady)},_triggerReady:function(){this.trigger("ready")},render:function(){return this.$el.append(this.header.render().el,this.posts.render().el),this}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(108),r=i(106),a=i(149),l=i(110),c=i(568),u=i(192),h=i(101),d=i(569),p=i(570),g=i(571),m=a.extend({className:"indash_tumblelog_compact",template:d,defaults:{current_data:{},unfollow_data:{},follow_data:{},template_data:{},hide_posts_on_unfollow:!1,stripDescriptionLineBreaks:!1,include_info_popover:!0},events:{"click .description a":"_descriptionLinkClicked","click .info_popover_button":"_infoPopoverButtonClicked","click .follow":"_onFollowClick","click .unfollow":"_onFollowClick"},initialize:function(e){if(this.options=n.extend({},this.defaults,e||{}),this.bindEvents(),this.is_rendered=!1,this.assets_host=r.get("Context/hosts/assets_host")||"",this.$description=null,this.$description_inner=null,!n.isEmpty(this.current_data)){var t=n.extend({},this.current_data,this.model.toJSON());this.model.set(t,{silent:!0})}this.model.get("global_theme_params")&&n.delay(n.bind(this.render,this),1)},bindEvents:function(){this.listenTo(this.model,"change:following",this._renderFollowButton),this.listenTo(this.model,"change:global_theme_params",this.render)},render:function(){var e=this.model.toJSON();if(e.following||(e.following=!1),this.is_rendered||!e.global_theme_params)return this;var t=n.result(p,e.global_theme_params.title_font),i=c.hexToRgb(e.global_theme_params.title_color);return this.$el.html(this.template(n.merge({},e,{show_navigation:!0,show_share_controls:!1,show_user_controls:this.options.include_info_popover,show_follow_button:!0,show_dismiss_controls:!1,title_font_family:t?t.family:!1,title_color_rgb:String(n.values(i).join(",")),followText:h("Follow"),unfollowText:h("Unfollow")},this.options.template_data))),this.$description=this.$(".description"),this.$description_inner=this.$description.find(".description_inner"),this._renderFontStyles(),this._renderInlineStyles(),this.__addSnowMan(),this.is_rendered=!0,this.$description.length&&(n.delay(n.bind(this.truncateDescription,this),100),this.options.stripDescriptionLineBreaks&&this.stripDescriptionLineBreaks()),this.trigger("ready"),this},stripDescriptionLineBreaks:function(){this.$description_inner.find("br").remove();var e=this.$description_inner.html(),t=e.replace(/[\n\r]/g," ");this.$description_inner.html(t)},truncateDescription:function(){var e=this.$description_inner.get(0);if(!(e.scrollHeight<=e.clientHeight)){var t=this.model.get("global_theme_params"),i=t.background_color,s=c.hexToRgb(i);this.$description.append(this.description_gradient_template({background_color:String(n.values(s).join(","))}))}},__addSnowMan:function(){var e={el:this.$("[data-snowman-container]"),tumblelogName:this.model.get("name")};this.options.include_info_popover&&(e.infoPopover={el:this.$el,auto_show:!1,trigger:this.$el.find(".info_popover_button"),useRecipient:!0,showAsks:!0,showAnonymousAsks:!0,skip_glass:!0,targetPost:this.options.targetPost}),this.snowman=new g(e)},_onFollowClick:function(e){if(e.preventDefault(),!o.bool("is_logged_in"))return void window.open("/follow/"+this.model.get("name"),"_self");var t={follow_data:this.options.follow_data};this.model.get("following")?this._confirm_unfollow(t):(l.trigger("tumblelog:log_follow"),this.model.follow(t))},_confirm_unfollow:function(e){var t={tumblelog:this.model.get("name")},i=this.model.requestUnfollow();if(this.options.disableUnfollowConfirm)i.resolve(),l.trigger("tumblelog:log_unfollow",{loggingData:t});else{var n=h("Are you sure you want to unfollow %1$s?").replace("%1$s","<strong>"+this.model.get("name")+"</strong>"),s={text:n,text_ok:h("Ok"),text_cancel:h("Nevermind")};i.promise.then(function(){l.trigger("tumblelog:log_unfollow",{loggingData:t})}),l.trigger("dialog:confirm:promise",i,s)}},_infoPopoverButtonClicked:function(e){e.preventDefault(),e.stopPropagation(),l.trigger("popticainfopopover:show")},_descriptionLinkClicked:function(e){e.preventDefault();var t=s(e.currentTarget).attr("href");try{if(u&&u.hasAllowedProtocol(t)){if(!u.isAbsoluteUrl(t)){var i="http://"+this.model.get("name")+".tumblr.com/";t="/"===t.charAt(0)?t.substr(1):t,t=i+t}window.open(t,"_blank")}}catch(n){}},_renderFollowButton:function(){var e=this.model.get("following");this.$el.find(".follow").toggle(!e),this.$el.find(".unfollow").toggle(e)},_hidePosts:function(){},_open_dialog:function(e,t){function i(e,t){e.is_disabled=e.is_menu_open,t&&t()}this.is_disabled=!0,e.fail(n.bind(i,null,this)),e.done(n.bind(i,null,this,t))},_renderInlineStyles:function(){var e=this.model.get("global_theme_params"),t=e.header_image_focused&&e.header_stretch&&e.show_header_image,i=c.hexToHsv(e.background_color),n=c.hexToHsv(e.link_color),s=e.link_color;return c.compare(n,i)&&(s=c.readable(i)),t||(this.$(".navigation .nav_icon").css("color",s),this.$(".navigation .blog_name").css("color",s),this.$(".navigation button").css({color:e.background_color,"background-color":s})),this.$(".description a").css("color",e.link_color),this},_renderFontStyles:function(){if(p){var e=this.model.get("global_theme_params");if(n.has(p,e.title_font)){var t=n.result(p,e.title_font),i="webfont_"+t.path;if(t.path&&!s("head #"+i).length){var o=this.assets_host+"/fonts/"+t.path+"/stylesheet.css";o+=n.has(t,"_v")?"?v="+t._v:"",s("<link>",{id:i,rel:"stylesheet",type:"text/css",href:o}).appendTo(s("head"))}}}},description_gradient_template:n.template('<div class="description_gradient" style="background: -moz-linear-gradient(top,  rgba(<%= background_color %>,0) 0%, rgba(<%= background_color %>,0.75) 50%, rgba(<%= background_color %>,1) 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(<%= background_color %>,0)), color-stop(50%,rgba(<%= background_color %>,0.75)), color-stop(100%,rgba(<%= background_color %>,1)));background: -webkit-linear-gradient(top,  rgba(<%= background_color %>,0) 0%,rgba(<%= background_color %>,0.75) 50%,rgba(<%= background_color %>,1) 100%);background: -o-linear-gradient(top,  rgba(<%= background_color %>,0) 0%,rgba(<%= background_color %>,0.75) 50%,rgba(<%= background_color %>,1) 100%);background: -ms-linear-gradient(top,  rgba(<%= background_color %>,0) 0%,rgba(<%= background_color %>,0.75) 50%,rgba(<%= background_color %>,1) 100%);background: linear-gradient(to bottom, rgba(<%= background_color %>,0) 0%,rgba(<%= background_color %>,0.75) 50%,rgba(<%= background_color %>,1) 100%);"></div>')});e.exports=m},function(e,t,i){"use strict";function n(e,t,i){return"#"+((1<<24)+(e<<16)+(t<<8)+i).toString(16).slice(1)}function s(e){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function o(e,t,i){var n=Math.min(Math.min(e,t),i),s=Math.max(Math.max(e,t),i),o=s-n,r={h:6,s:s?(s-n)/s:0,v:s/255};return o?s===e?r.h+=(t-i)/o:s===t?r.h+=2+(i-e)/o:r.h+=4+(e-t)/o:r.h=0,r.h=60*r.h%360,r}function r(e,t,i){var n,s,o;if(t){n=s=o=0;var r=(e+360)%360/60,a=i*t,l=i-a,c=a*(1-Math.abs(r%2-1));1>r?(n=a,s=c):2>r?(n=c,s=a):3>r?(s=a,o=c):4>r?(s=c,o=a):5>r?(o=a,n=c):(o=c,n=a),n+=l,s+=l,o+=l}else n=s=o=i;return{r:Math.round(255*n),g:Math.round(255*s),b:Math.round(255*o)}}function a(e){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t=s(e),i=o(t.r,t.g,t.b);return i}function l(e,t,i){var s=r(e,t,i),o=n(s.r,s.g,s.b);return o}function c(e,t){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var i,n,s,o=parseInt(e,16),r=0>t?0:255,a=0>t?-t:t,l=o>>16,c=o>>8&255,u=255&o;return i=Math.round((r-l)*a)+l,n=Math.round((r-c)*a)+c,s=Math.round((r-u)*a)+u,"#"+(16777216+65536*i+256*n+s).toString(16).slice(1)}function u(e,t,i){return"string"==typeof e&&(e=a(e)),t||(t=.2),i||(i=.8),e.s<t&&e.v>i}function h(e){return"string"==typeof e&&(e=a(e)),u(e)?"#444":"#FFF"}function d(e,t,i){var n={upperBound:.8,lowerBound:.2,diffBound:.1,hueBound:15};p.extend(n,i);var s=n.upperBound,o=n.lowerBound,r=n.diffBound,a=n.hueBound,l=Math.abs(e.h-t.h),c=Math.abs(e.s-t.s),u=Math.abs(e.v-t.v);return r>=l&&r>=c&&r>=u?!0:r>=c&&r>=u&&(c>=s||o>=c&&u>=s||o>=u&&a>=l)}var p=i(3);e.exports={rgbToHex:n,hexToRgb:s,rgbToHsv:o,hsvToRgb:r,hexToHsv:a,hsvToHex:l,brighten:c,readable:h,compare:d,isLight:u}},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{}){__p+="";var is_popover="boolean"==typeof popover?popover:!1,has_avatar=avatar_url&&global_theme_params.show_avatar,has_bg_img=global_theme_params.header_image_focused&&global_theme_params.show_header_image,has_title=title&&global_theme_params.show_title,has_description=description_sanitized&&global_theme_params.show_description,expanded_name=cname?cname:name+".tumblr.com",description_color=title_color_rgb?"rgba("+title_color_rgb+",0.7)":global_theme_params.title_color,header_class=global_theme_params.header_stretch?"":" no_stretch_header";header_class+=has_bg_img?"":" no_header_image",header_class+=has_avatar?"":" no_avatar",header_class+=!has_bg_img||has_avatar||has_title||has_description?"":" header_image_only",header_class+=has_title||has_description?" has_info":" no_info",__p+=' <div class="indash_header_wrapper '+(null==(__t=header_class)?"":__t)+" tumblelog_name_"+(null==(__t=name)?"":_.escape(__t))+'" style="background-color:'+(null==(__t=global_theme_params.background_color)?"":__t)+"; color:"+(null==(__t=global_theme_params.title_color)?"":__t)+'"> ',show_navigation&&(__p+=' <div class="navigation"><div class="navigation_bg" style="background-color: '+(null==(__t=global_theme_params.background_color)?"":__t)+'"></div><div class="navigation_inner"> ',"undefined"!==name&&(__p+=' <h3><a href="'+(null==(__t=url)?"":_.escape(__t))+'" target="_blank" class="blog_name" data-peepr=\'{"tumblelog": "'+(null==(__t=name)?"":_.escape(__t))+'"}\'><span class="name"> '+(null==(__t=name)?"":_.escape(__t))+' </span><span class="full_url">'+(null==(__t=expanded_name)?"":_.escape(__t))+"</span></a></h3> "),__p+=" ",show_share_controls&&(__p+=' <a class="open_blog_button nav_icon icon_export"></a> '),__p+=" ",!customizable&&show_user_controls&&(__p+=' <a data-snowman-container class="info_popover_button nav_icon user_dropdown_lockup"> <? if (!$this->flags->get("web_blog_subscriptions")) : // @TODO Snowman. To be removed ?> <i class="user_dropdown_icon user_dropdown_icon_user icon_user_settings"></i> <? endif ?> </a> '),__p+=" ",!customizable&&show_follow_button&&(__p+=" ",__p+=following?' <button class="chrome unfollow" type="button">'+(null==(__t=unfollowText)?"":_.escape(__t))+'</button> <button class="chrome follow" type="button" style="display:none">'+(null==(__t=followText)?"":_.escape(__t))+"</button> ":' <button class="chrome unfollow" type="button" style="display:none">'+(null==(__t=unfollowText)?"":_.escape(__t))+'</button> <button class="chrome follow" type="button">'+(null==(__t=followText)?"":_.escape(__t))+"</button> ",__p+=" "),__p+=" </div></div> "),__p+=" ",global_theme_params.header_image_focused&&global_theme_params.show_header_image&&(__p+=' <div class="header_image_wrapper',has_avatar&&(__p+=" has_avatar"),__p+='"><div class="header_image" style="background-image:url('+(null==(__t=global_theme_params.header_image_focused)?"":_.escape(__t))+')"> ',__p+=is_popover||!customizable?' <a href="'+(null==(__t=url)?"":__t)+'" target="_blank"><img src="'+(null==(__t=global_theme_params.header_image_focused)?"":_.escape(__t))+'" data-peepr=\'{"tumblelog": "'+(null==(__t=name)?"":_.escape(__t))+'"}\' alt="'+(null==(__t=title)?"":_.escape(__t))+'"> </a> ':' <img src="'+(null==(__t=global_theme_params.header_image_focused)?"":_.escape(__t))+'" alt=""> ',__p+=" </div></div> "),__p+=" ",avatar_url&&global_theme_params.show_avatar&&(__p+=' <div class="avatar '+(null==(__t=global_theme_params.avatar_shape)?"":__t)+'" style="background-color:'+(null==(__t=global_theme_params.background_color)?"":__t)+"; background-image:url("+(null==(__t=avatar_url)?"":__t)+"); color:"+(null==(__t=global_theme_params.background_color)?"":__t)+'"> ',__p+=is_popover||!customizable?' <a href="'+(null==(__t=url)?"":__t)+'" target="_blank"><img src="'+(null==(__t=avatar_url)?"":__t)+'" data-peepr=\'{"tumblelog": "'+(null==(__t=name)?"":_.escape(__t))+'"}\' alt="'+(null==(__t=title)?"":_.escape(__t))+'"></a> ':' <img src="'+(null==(__t=avatar_url)?"":__t)+'" alt=""> ',__p+=" </div> "),__p+=" ",(has_title||has_description)&&(__p+=' <div class="info_wrapper"><div class="info"> ',has_title&&(__p+=' <h1 class="title" style="font-family:'+(null==(__t=title_font_family||"inherit")?"":__t)+"; font-weight:"+(null==(__t=global_theme_params.title_font_weight)?"":__t)+'">'+(null==(__t=title)?"":_.escape(__t))+"</h1> "),__p+=" ",has_description&&(__p+=' <div class="description" style="color:'+(null==(__t=description_color)?"":__t)+'"><div class="description_inner">'+(null==(__t=description_sanitized)?"":__t)+"</div></div> "),__p+=" </div></div> "),__p+=" </div>"}return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t){"use strict";var i={"1785 GLC Baskerville":{display_name:"1785 Baskerville",family:"'1785 GLC Baskerville', serif",path:"1785glcbaskerville",_v:"1"},"Alternate Gothic":{display_name:"Alternate Gothic",family:"'Alternate Gothic', sans-serif",path:"alternategothic",_v:"3"},Arquitecta:{display_name:"Arquitecta",family:"'Arquitecta', sans-serif",path:"arquitecta",_v:"3"},Avalon:{display_name:"Avalon",family:"'Avalon', sans-serif",path:"avalon",_v:"1"},Baskerville:{display_name:"Baskerville",family:"Baskerville, 'Times New Roman', Times, serif"},"Bodoni Recut FS":{display_name:"Bodoni",family:"'Bodoni Recut FS', serif",path:"bodonirecutfs",_v:"3"},Bookmania:{display_name:"Bookmania",family:"'Bookmania', serif",path:"bookmania",_v:"1"},"Brutal Type":{display_name:"Brutal Type",family:"'Brutal Type', sans-serif",path:"brutaltype",_v:"1"},Calluna:{display_name:"Calluna",family:"'Calluna', serif",path:"calluna",_v:"3"},"Calluna Sans":{display_name:"Calluna Sans",family:"'Calluna Sans', sans-serif",path:"callunasans",_v:"3"},Capita:{display_name:"Capita",family:"'Capita', serif",path:"capita",_v:"1"},"Caslon FS":{display_name:"Caslon FS",family:"'Caslon FS', serif",path:"caslonfs",_v:"3"},"Clarendon Text Pro":{display_name:"Clarendon",family:"'Clarendon Text Pro', serif",path:"clarendontextpro",_v:"3"},"Clearface FS":{display_name:"Clearface",family:"'Clearface FS', serif",path:"clearface",_v:"4"},"Courier New":{display_name:"Courier New",family:"'Courier New', Courier, monospace"},FangSong:{display_name:"Fang Song",family:"'FangSong', 'STFangsong', sans-serif"},Futura:{display_name:"Futura",family:"Futura, 'Century Gothic', AppleGothic, sans-serif"},"Garamond Classic FS":{display_name:"Garamond",family:"'Garamond Classic FS', serif",path:"garamondclassicfs",_v:"3"},Georgia:{display_name:"Georgia",family:"Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif"},Gibson:{display_name:"Gibson",family:"'Gibson', sans-serif",path:"gibson",_v:"3"},"Grumpy Black 48":{display_name:"Grumpy",family:"'Grumpy Black 48', serif",path:"grumpyblack48",_v:"3"},"Helvetica Neue":{display_name:"Helvetica",family:"'Helvetica Neue', Arial, Helvetica, sans-serif"},Kaiti:{display_name:"Kaiti",family:"'Kaiti TC', 'KaiTi', sans-serif"},"Lorimer No 2":{display_name:"Lorimer No 2",family:"'Lorimer No 2', sans-serif",path:"lorimerno2",_v:"3"},"Lucida Sans":{display_name:"Lucida Sans",family:"'Lucida Sans', 'Lucida Grande', 'Lucida Sans Unicode', sans-serif"},"News Gothic FS":{display_name:"News Gothic",family:"'News Gothic FS', sans-serif",path:"newsgothicfs",_v:"3"},"Pratt Pro":{display_name:"Pratt Pro",family:"'Pratt Pro', serif",path:"prattpro",_v:"1"},Quadrat:{display_name:"Quadrat",family:"'Quadrat', serif",path:"quadrat",_v:"1"},SimHei:{display_name:"Sim Hei",family:"'SimHei', 'STHeiti', sans-serif"},"Sofia Pro":{display_name:"Sofia Pro",
family:"'Sofia Pro', sans-serif",path:"sofiapro",_v:"2"},Spade:{display_name:"Spade",family:"'Spade', serif",path:"spade",_v:"1"},"Square Serif":{display_name:"Square Serif",family:"'Square Serif', serif",path:"squareserif",_v:"4"},Streetscript:{display_name:"Streetscript",family:"'Streetscript', sans-serif",path:"streetscript",_v:"1"},"Typewriter FS":{display_name:"Typewriter",family:"'Typewriter FS', serif",path:"typewriterfs",_v:"1"},Verdana:{display_name:"Verdana",family:"Verdana, Geneva, Tahoma, sans-serif"},Ziclets:{display_name:"Ziclets",family:"'Ziclets', serif",path:"ziclets",_v:"1"}};e.exports=i},function(e,t,i){"use strict";var n=i(144),s=i(572),o=n.extend({name:"Snowman",autoAppend:!0,initialize:function(e){this.view=new s(e)}});e.exports=o},function(e,t,i){"use strict";var n=i(156),s=i(573),o=i(120),r=n.extend({template:s,defaults:{canSubscribe:!1},events:{click:"__toggleInfoPopover"},initialize:function(e){return this.options=e,this.model||(this.model=new o({name:this.options.tumblelogName})),this.set({canSubscribe:this.model.get("can_subscribe"),isSubscribed:this.model.get("is_subscribed")}),this.listenTo(this.model,"change:is_subscribed",this.__subscribeActionSuccess),e.infoPopoverOnDemand||this.__createInfoPopover(),this},__subscribeActionSuccess:function(e){if(e.id===this.model.get("name")){var t=this.model.get("is_subscribed");this.$("[data-subscription-indicator]").toggleClass("is-subscribed",t)}},__toggleInfoPopover:function(e){e.preventDefault(),e.stopPropagation(),this.options.infoPopoverOnDemand&&!this.infoPopover&&this.__createInfoPopover(),this.infoPopover.toggle()},__createInfoPopover:function(){this.options.infoPopover&&(this.options.infoPopover.model=this.model,this.options.infoPopover.url=this.model.get("url"),this.options.infoPopover.useRecipient&&(this.options.infoPopover.recipient=this.model.get("name")),this.options.infoPopover.showAsks&&(this.options.infoPopover.asks=this.model.get("asks")),this.options.infoPopover.showAnonymousAsks&&(this.options.infoPopover.anonymous_asks=this.model.get("anonymous_asks")),this.infoPopover=new Tumblr.TumblelogPopover.PopticaInfoPopover(this.options.infoPopover))}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<span class="snowman-container"><i data-subscription-indicator class="subscribe-activity '+(null==(__t=canSubscribe&&isSubscribed?"is-subscribed":"")?"":__t)+'"></i><i class="snowman-icon"></i></span>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(110),a=i(575),l=o.extend({className:"recent_posts",template:a,events:{"click a":"onPostClick",mouseenter:"onMouseEnter"},defaults:{on_bottom:!0,blog_bg_color:!0,$popover:s(),min_load_time:500,model:{},dashboard_post:{}},initialize:function(e){n.extend(this,this.defaults,e),this.model&&(this.renderLoader(),this.renderInlineStyles(),this.posts=this.model.get("highlighted_posts"),n.isUndefined(this.posts)&&this.fetchPosts(),this.bindEvents())},bindEvents:function(){this.listenTo(this.model,"change:highlighted_posts",this.render),this.listenTo(this.model,"change:global_theme_params",this.renderInlineStyles)},fetchPosts:function(){this.model.fetch_popover_data({is_tumblelog_popover:!0})},updatePosts:function(e){this.model=e,this.posts=this.model.get("highlighted_posts"),n.isUndefined(this.posts)?this.fetchPosts():this.render(!0)},renderLoader:function(){var e=this.model.toJSON();this.$el.html(this.template({loader_color:e.global_theme_params?e.global_theme_params.title_color:"#D9D9D9"}))},renderInlineStyles:function(){var e=this.model.get("global_theme_params");e&&this.blog_bg_color&&this.$el.css("background-color",e.background_color)},render:function(e){var t=this.posts||this.model.get("highlighted_posts");if(!n.isArray(t))return this;var i=t.join("");return t.length<2?(setTimeout(n.bind(function(){this.$popover.addClass("is_empty"),this.$el.html("")},this),this.min_load_time),this):(this.$el.addClass("has_"+t.length+"_posts"),e===!0?this.$el.addClass("is_cached").html(i):setTimeout(n.bind(function(){this.$el.addClass("is_loaded").html(i)},this),this.min_load_time),this)},onPostClick:function(e){},onMouseEnter:function(e){r.trigger("TumblelogPopover:mouseenter_posts")}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{}){__p+="";var color="undefined"!=typeof loader_color?loader_color:"#D9D9D9";__p+=' <div class="Knight-Rider-loader centered animate"><div class="Knight-Rider-bar" style="background-color:'+(null==(__t=color)?"":__t)+'"></div><div class="Knight-Rider-bar" style="background-color:'+(null==(__t=color)?"":__t)+'"></div><div class="Knight-Rider-bar" style="background-color:'+(null==(__t=color)?"":__t)+'"></div></div>'}return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(156),s=i(577),o=i(10),r=i(101),a=n.extend({tagName:"li",className:"blog-activity-date",template:s,events:{},defaults:{},beforeRender:function(){var e=o();this.model.set("relativeDate",this.getRelativeDate(e))},getRelativeDate:function(e){var t=e.diff(this.model.attributes.dateHeader),i=o.duration(t).asHours(),n=Math.floor(i/24);return 0>=n?r("Today"):1>=n?r("Yesterday"):r("%d days ago",n)},teardown:function(){return this.remove(),this}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="date_header clearfix"><div class="part_relative_date">'+(null==(__t=model.relativeDate)?"":__t)+'</div><div class="part_full_date">'+(null==(__t=model.dateHeader.format("dddd, MMMM D"))?"":__t)+"</div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(114),s=n.extend({});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(144),r=i(110),a=i(192),l=i(111),c=i(142),u=i(143),h=i(120),d=i(580),p=i(581),g=i(582),m=i(584),f=i(585),v=i(588),_=i(593),b=i(605),w=i(609),y=i(610),k=i(615),x=i(616),C=i(618),S=i(646),E=i(692),T=i(603),A=i(594),F=i(693),R=i(694),L=i(638),$=i(396),D=new m,P={CONVERSATION_OPEN_TUMBLELOGS:"messaging:conversation:open:tumblelogs",CONVERSATION_OPEN_MODEL:"messaging:conversation:open:model",CONVERSATION_OPEN_ID:"messaging:conversation:open:id"},I=o.extend({name:"Messaging",defaults:{blogNetworkQueryParameter:"conversation",blogNetworkQueryParameterPathWhitelist:["/dashboard"],resetPollingTypingDebounceRate:3e4},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"inboxAnchorEl","inboxPopoverOptions")),this.eventBus=D,this.user=l(),this.channels=this._getChannelsEnabledForMessagingAsCollection(),this.activeWindow=new d,this.inboxCollection=new F,this.currentBlogModel=new E({channel:this._getInitiallySelectedChannel()}),this.favoritesCollection=new L,this.emptyInboxCollection=new L,this.unreadManager=new f({channels:this.channels}),this.inboxBadge=new k({el:this.inboxAnchorEl,channels:this.channels}).render(),this.messagingLogger=new p,this.messagingNotifier=new w({isEnabled:this.isDesktopNotificationEnabled(),notificationIcon:this.getMessagingNotificationIcon()}),this.keyboardManager=new b,this.windowPersistenceManager=new _({user:this.user,isSyncEnabled:!1}),this.notificationSoundManager=new y,this.searchImageQueries=new $,this.windowManager=new v({eventBus:this.eventBus,user:this.user,channels:this.channels,currentBlogModel:this.currentBlogModel,keyboardManager:this.keyboardManager,isMinimizeEnabled:this.isMinimizeEnabled(),isPersistenceEnabled:this.isPersistenceEnabled(),persistenceManager:this.windowPersistenceManager,inboxConfig:{constructor:C,options:{favoritesCollection:this.favoritesCollection,emptyInboxCollection:this.emptyInboxCollection,appendFavoritesToInboxLimit:this.getAppendFavoritesToInboxLimit(),isAutoFetch:!1},popoverOptions:n.extend({autoTeardown:!0,pinnedSide:"bottom",isFixedPosition:!0,pinnedTarget:this.inboxAnchorEl},this.inboxPopoverOptions)},conversationConfig:{constructor:S,options:{isAutoFetch:!1,isMinimizeEnabled:this.isMinimizeEnabled(),isVerifiedEmail:this.user.isVerifiedEmail(),isSoundsEnabled:this.isSoundsEnabled(),isGifSearchEnabled:this.isGifSearchEnabled(),isIcebreakersEnabled:this.isIcebreakersEnabled(),isSendPhotosEnabled:this.isSendPhotosEnabled(),collection:this.searchImageQueries}}}),this._onConversationMessageInputThrottled=n.throttle(this._onConversationMessageInput,this.get("resetPollingTypingDebounceRate"),{leading:!0,trailing:!1}),this.listenTo(r,P.CONVERSATION_OPEN_TUMBLELOGS,this._onEventBusOpenConversationUsingTumblelogModels),this.listenTo(r,P.CONVERSATION_OPEN_MODEL,this._onEventBusOpenConversationUsingModel),this.listenTo(r,P.CONVERSATION_OPEN_ID,this._onEventBusOpenConversationUsingIdAndParticipant),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_OPEN_CONVERSATION_MODEL,this._onOpenConversationUsingConversationModel),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_OPEN_PARTICIPANT_MODELS,this._onOpenConversationUsingParticipantModels),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_OPEN_TUMBLR_URL,this._onConversationClickBlog),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_DELETE_MODEL,this._onConversationDelete),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_FETCHING,this._onConversationFetching),this.listenTo(this.eventBus,this.eventBus.BLOCK,this._onBlock),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_MESSAGE_SENDING,this._onConversationMessageSending),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_MESSAGE_SENT,this._onConversationMessageSent),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_MESSAGE_FAILED,this._onConversationMessageFailed),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_MESSAGE_INPUT,this._onConversationMessageInputThrottled),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_MESSAGES_UNREAD_FETCHED,this._playConversationSounds),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_MARK_AS_SPAM,this._onConversationMarkAsSpam),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_IMAGE_PREVIEW_ADD,this._onConversationImagePreviewAdd),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_IMAGE_PREVIEW_DISMISS,this._onConversationImagePreviewDismiss),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_IMAGE_PREVIEW_EDIT,this._onConversationImagePreviewEdit),this.listenTo(this.eventBus,this.eventBus.CONVERSATION_COMPOSE_PLUGIN_CLICK,this._onConversationComposePluginClick),this.listenTo(r,"toaster:updateMessagingUnreadCounts",this._onPollUpdate),this.listenTo(r,"logout",this._onEventBusLogout),this.listenTo(this.currentBlogModel,"change",this._onCurrentBlogModelChange),this.listenTo(this.windowManager,"change",this._onWindowManagerChange),this.listenTo(this.unreadManager,"change:channel",this._onUnreadManagerChannelChange),this.listenTo(this.unreadManager,"change:conversation",this._onUnreadManagerConversationChange),this.listenTo(this.windowManager,"inbox:added",this._onWindowManagerInboxAdded),this.listenTo(this.windowManager,"inbox:removed",this._onWindowManagerInboxRemoved),this.listenTo(this.windowManager,"conversation:added",this._onWindowManagerConversationAdded),this.listenTo(this.windowManager,"conversation:removed",this._onWindowManagerConversationRemoved),this.listenTo(this.windowManager,"conversations:loaded",this._onWindowManagerConversationsLoaded),this.listenTo(this.windowManager,"conversation:minimized",this._onWindowManagerConversationMinimized),this.listenTo(this.windowManager,"conversation:unminimized",this._onWindowManagerConversationUnminimized),this.listenTo(this.messagingNotifier,"notification:display",this._onDesktopNotificationDisplayed),this.listenTo(this.messagingNotifier,"notification:permission:change",this._onDesktopNotificationPermissionChange),this.listenTo(this.channels,"change:unread_messages_count_sum",n.debounce(n.bind(this._onChannelsUnreadMessageCountChange,this),0)),this.messagingPoller=new g({channels:this.channels,user:this.user,callback:n.bind(this._onPollUpdate,this),frequency:this.getPollingFrequencyInbox()}),this.hasTutorial()&&this.openTutorialPopover(),this._onWindowManagerChange(this.windowManager),this._processMessagingQuery()},render:function(){this.inboxAnchorEl&&this.inboxAnchorEl.on("click.messaging",n.bind(this._onClickInboxAnchor,this)),this.windowManager.loadConversationsState()},openInboxPopover:function(){this.windowManager.addInbox(this.inboxCollection),this.tutorialPopover&&this.tutorialPopover.hideTutorial()},openConversationPopover:function(e,t){var i;return n.isEmpty(e.get("participantUuid"))&&e.set("participantUuid",this.getCurrentBlogId()),i=this.windowManager.getConversationPopover(e),this.windowManager.removeInbox(this.inboxCollection),i?void i.refresh(e):(this.windowManager.addConversation(e,{context:t}),void(this.tutorialPopover&&this.tutorialPopover.hideTutorial()))},openTutorialPopover:function(){return this.tutorialPopover?void 0:(this.tutorialPopover=new x({eventBus:this.eventBus,viewOptions:{title:s("Talk to a Tumblr"),content:s("Just tap this balloon, type the Tumblr's name, and start a conversation."),ok_text:s("Send a message"),pinnedTarget:this.inboxAnchorEl,fixed_position:n.get(this.inboxPopoverOptions,"isFixedPosition",!0)}}),this.listenToOnce(this.tutorialPopover,"dismiss",n.bind(function(){n.delay(n.bind(function(){this.openInboxPopover()},this),250)},this)),this.listenToOnce(this.tutorialPopover,"hide",n.bind(function(){this.stopListening(this.tutorialPopover),this.tutorialPopover=null},this)),this.tutorialPopover.render(),this.tutorialPopover)},fetchInbox:function(){var e=this.getCurrentBlogId();if(this._pendingInboxRequest&&this._pendingInboxBlog){if(e===this._pendingInboxBlog)return;this._pendingInboxRequest.abort()}this._pendingInboxBlog=e,this._pendingInboxRequest=this.inboxCollection.fetchInbox(e).always(n.bind(function(){this._pendingInboxRequest=null,this._pendingInboxBlog=null},this))},getCurrentChannel:function(){return this.currentBlogModel.getChannel()},getCurrentBlogId:function(){return this.currentBlogModel.getId()},getPollingFrequencyInbox:function(){return n.get(this.data,"polling_frequency_inbox")},getPollingFrequencyConversation:function(){return n.get(this.data,"polling_frequency_conversation")},hasTutorial:function(){return n.get(this.data,"has_tutorial")},getAppendFavoritesToInboxLimit:function(){return n.get(this.data,"append_favorites_to_inbox_limit")},isMinimizeEnabled:function(){return n.get(this.data,"is_minimize_enabled",!1)},isIcebreakersEnabled:function(){return n.get(this.data,"is_icebreakers_enabled",!1)},isPersistenceEnabled:function(){return n.get(this.data,"is_persistence_enabled",!1)&&this.user.isVerifiedEmail()},isDesktopNotificationEnabled:function(){return n.get(this.data,"is_desktop_notifications_enabled",!1)},isSoundsEnabled:function(){return n.get(this.data,"is_sounds_enabled",!1)},isGifSearchEnabled:function(){return n.get(this.data,"is_messaging_gif_search_enabled",!1)},isSendPhotosEnabled:function(){return n.get(this.data,"is_messaging_send_photos_enabled",!1)},getBackoffRatesInbox:function(){return[1,1,2,2,4]},getBackoffRatesConversation:function(){return[1,1,1,1,2,2,2,2,4,4,4,4,8,8,8,8,16]},getMessagingNotificationIcon:function(){return n.get(this.data,"messaging_notification_icon","")},_onWindowManagerInboxAdded:function(e,t){this.fetchInbox(),this.messagingLogger.logInboxOpened()},_onWindowManagerInboxRemoved:function(e,t){this.messagingLogger.logInboxClosed()},_onWindowManagerConversationAdded:function(e,t,i){var s=n.get(i,"isFromPersistence",!1);t.isMinimized()||(t.fetch().always(n.bind(function(){s||this.messagingLogger.logConversationOpened(e,n.get(i,"context"))},this)),t.focus())},_onWindowManagerConversationRemoved:function(e,t,i){this.messagingLogger.logConversationClosed(e,n.get(i,"context"))},_onWindowManagerConversationsLoaded:function(e,t){0===e.length&&0===t.length||this.messagingLogger.logConversationWindowsLoaded(e,t)},_onWindowManagerConversationMinimized:function(e,t){this.messagingLogger.logConversationMinimized(e)},_onWindowManagerConversationUnminimized:function(e,t){this.messagingLogger.logConversationUnminimized(e)},_getChannelsEnabledForMessagingAsCollection:function(){return new R(n.invoke(this.user.getChannelsEnabledForMessaging(),"toJSON"))},_getInitiallySelectedChannel:function(){return this.channels.findWhere({is_current:!0})||n.first(this.channels.models)},_onClickInboxAnchor:function(e){e.preventDefault(),this.openInboxPopover()},_onEventBusOpenConversationUsingIdAndParticipant:function(e,t,i){this._openConversationUsingIdAndParticipant(e,t,i)},_onEventBusOpenConversationUsingTumblelogModels:function(e,t){this._openConversationUsingTumblelogModels(e,t)},_onEventBusOpenConversationUsingModel:function(e,t){this.openConversationPopover(e,t)},_onOpenConversationUsingConversationModel:function(e,t){this.openConversationPopover(e,t)},_openConversationUsingIdAndParticipant:function(e,t,i){var s=new A({id:e,participantUuid:t});s.fetchConversation().then(n.bind(function(){this.openConversationPopover(s,i)},this))},_openConversationUsingTumblelogModels:function(e,t){var i=n.map(e,function(e){return new T(e.toJSON(),{parse:!0})});this._onOpenConversationUsingParticipantModels(i,t)},_onOpenConversationUsingParticipantModels:function(e,t){var i=new T(this.getCurrentChannel().toJSON()),n=new A({participants:[i].concat(e),participantUuid:this.getCurrentBlogId()});this.openConversationPopover(n,t)},_onPollUpdate:function(e,t){e=n.get(e,"unread_messages"),n.get(e,"error")!==!0&&this.unreadManager.setData(e)},_onConversationClickBlog:function(e){var t=n.get(e,"url"),i=n.get(e,"blogName"),s=n.get(e,"postId"),o=n.get(e,"searchTagTerm"),a=n.get(e,"originalEvent");a&&a.preventDefault(),r.trigger("peepr-open-request",{url:t,tumblelog_name:i,post_id:s,searchTagTerm:o}),this.messagingLogger.logPeeprOpen(t,i,s,o)},_onDesktopNotificationDisplayed:function(e){this.messagingLogger.logNotification(e)},_onDesktopNotificationPermissionChange:function(e){e?this.messagingLogger.logNotificationPermissionGranted():this.messagingLogger.logNotificationPermissionDenied()},_onConversationMarkAsSpam:function(e,t){var i;e&&t&&(i=s("%1$s will be blocked and reported. And any trace of this conversation will disappear from your inbox.",t.get("name")),u.confirm(i,n.bind(function(){this.messagingLogger.logConversationSpamIntent(e),this._removeConversation(e),e.markAsSpam().then(n.bind(function(){this.messagingLogger.logConversationSpamSuccess(e)},this)).fail(n.bind(function(){this.messagingLogger.logConversationSpamFail(e)},this))},this),null,s("Mark it spam"),s("Nevermind")))},_onConversationImagePreviewAdd:function(e,t){this.messagingLogger.logImagePreviewAdd(e,t)},_onConversationImagePreviewDismiss:function(e,t){this.messagingLogger.logImagePreviewDismiss(e,t)},_onConversationImagePreviewEdit:function(e,t){this.messagingLogger.logImagePreviewEdit(e,t)},_onConversationComposePluginClick:function(e,t){this.messagingLogger.logComposePluginClick(e,t)},_onBlock:function(e,t){n.isEmpty(e)||c.confirmBlock(e).then(n.bind(function(){c.block(e).then(n.bind(function(){this._onBlockSuccess(e,t)},this))},this))},_onBlockSuccess:function(e,t){n.isEmpty(e)||(t&&this._removeConversation(t),r.trigger("blocks:block_added",{loggingData:{from:"messaging"}}),this.messagingLogger.logBlock(e))},_removeConversation:function(e){this.windowManager.removeConversation(e),this.inboxCollection.remove(e)},_copyCollectionData:function(e,t){t.reset(e.models),t.setNextLink(e.getNextLink())},_onCurrentBlogModelChange:function(){var e=this.currentBlogModel.getPrevChannel(),t=this.currentBlogModel.getChannel();e&&this._copyCollectionData(this.inboxCollection,e.get("conversations")),t&&this._copyCollectionData(t.get("conversations"),this.inboxCollection),this.fetchInbox()},_onConversationDelete:function(e){u.confirm(s("Permanently delete this conversation?"),n.bind(function(){this.messagingLogger.logConversationDeleted(e),e.destroy(),this.windowManager.removeConversation(e),this.inboxCollection.remove(e.get("id"))},this),null,s("Delete"),s("Nevermind"))},_onConversationFetching:function(e){this.unreadManager.setConversationModelCount(e,0)},_onUnreadManagerChannelChange:function(e,t){var i=this.getCurrentChannel(),s=n.sum(t);this.windowManager.isInboxOpen()&&i===e&&this.fetchInbox(),e.set("unread_messages_count_sum",s)},_onUnreadManagerConversationChange:function(e,t,i){this._generateBrowserNotification(e,t,i),this._setConversationUnreadCount(e,t,i)},_onChannelsUnreadMessageCountChange:function(e,t){var i=e.previous("unread_messages_count_sum");t>i&&this._playSoundName("notification-sound")},_playConversationSounds:function(){this._playSoundName("receive-sound")},_playSoundName:function(e){this.isSoundsEnabled()&&this.user.isSoundsEnabled()&&this.notificationSoundManager.playSoundName(e)},_setConversationUnreadCount:function(e,t,i){var n=this.windowManager.getConversationModelByIdAndParticipant(e,i.get("uuid"));n&&n.set("unreadCount",t)},_generateBrowserNotification:function(e,t,i){var n,s=!1;0>=t||(this.activeWindow.isActive&&this.windowManager.get("isConversationOpen")?(n=this.windowManager.getConversationModelByIdAndParticipant(e,i.get("uuid")),n&&this.windowManager.isConversationMinimized(n)&&(s=!0)):s=!0,s&&this.messagingNotifier.notifyOnUnread(e,i))},_onWindowManagerChange:function(e){var t,i,n=e.isInboxOpen(),s=e.isConversationOpen(),o=n||s;return this.user.isVerifiedEmail()&&o?(s?(t=this.getPollingFrequencyConversation(),i=this.getBackoffRatesConversation()):(t=this.getPollingFrequencyInbox(),i=this.getBackoffRatesInbox()),this.messagingPoller.setFrequency(t),this.messagingPoller.setBackoffRates(i),void this.messagingPoller.start()):void this.messagingPoller.stop()},_onConversationMessageSending:function(){this._playSoundName("send-sound")},_onConversationMessageSent:function(e,t){this.messagingLogger.logMessageSent(e,t)},_onConversationMessageFailed:function(e,t){this.messagingLogger.logMessageFailed(e,t)},_onConversationMessageInput:function(e,t){this.messagingPoller.resetPollingFrequency(),this.messagingPoller.poll()},_getRecipientURLParam:function(){return a.getParameter(this.get("blogNetworkQueryParameter"))},_removeRecipientURLParam:function(){var e,t=window.location,i=this.get("blogNetworkQueryParameter"),s=a.parseUrl(t),o=n.get(s,"query"),r=n.get(s,"path","");n.isEmpty(o)||(e=a.getQueryStringHash(o),!n.isEmpty(e)&&n.has(e,i)&&(delete e[i],history.replaceState({},null,a.buildUrl(r,e))))},_openConversationFromBlogName:function(e,t){var i=new h({name:e});return i.fetch_popover_data().then(n.bind(function(){return n.isEmpty(i.get("uuid"))?void 0:this._openConversationUsingTumblelogModels([i],t)},this))},_processMessagingQuery:function(){var e=window.location,t=a.parseUrl(e),i=t.path;if(n.contains(this.get("blogNetworkQueryParameterPathWhitelist"),i)){var s=this._getRecipientURLParam();n.isEmpty(s)||(this._removeRecipientURLParam(),this._openConversationFromBlogName(s,"blog-network"))}},_onEventBusLogout:function(){this.isPersistenceEnabled()&&this.windowPersistenceManager.clear()}});e.exports=I},function(e,t,i){"use strict";var n=i(3),s=function(){window.onfocus=n.bind(this.onFocus,this),window.onblur=n.bind(this.onBlur,this)};s.prototype.onFocus=function(e){this.isActive=!0},s.prototype.onBlur=function(e){this.isActive=!1},s.prototype.isActive=!0;var o,r=function(){return null==o&&(o=new s),o};e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(110),r=s.extend({name:"MessagingLogger",defaults:{namespace:"messaging-interaction",isDebugEnabled:!1,platform:"web"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults)))},logInboxOpened:function(){this._logIt("inbox:open")},logInboxClosed:function(){this._logIt("inbox:closed")},logConversationOpened:function(e,t){this._logIt("conversation:open",{conversationId:e.get("id"),context:t})},logConversationClosed:function(e,t){this._logIt("conversation:closed",{conversationId:e.get("id"),context:t})},logConversationDeleted:function(e){this._logIt("conversation:deleted",{conversationId:e.get("id")})},logConversationStarted:function(e,t){this._logIt("conversation:started",{context:t})},logMessageSent:function(e,t){!n.isEmpty(t)&&t.isNew()&&this.logConversationStarted(t),this._logIt("message:sent",this._getMessageLoggingData(e,t))},logMessageFailed:function(e,t){this._logIt("message:failure",this._getMessageLoggingData(e,t))},logFollow:function(e){this._logIt("conversation:follow",{blogName:e})},logBlock:function(e){this._logIt("block",{blockingBlog:e.currentTumblelog,blockedBlog:e.blockedTumblelog})},logNotification:function(e){this._logIt("notification:display",{conversationId:e})},logNotificationPermissionGranted:function(){this._logIt("notification:permission:granted")},logNotificationPermissionDenied:function(){this._logIt("notification:permission:denied")},logConversationWindowsLoaded:function(e,t){this._logIt("conversation:windows:loaded",{numOpen:e.length,numMinimized:t.length})},logConversationMinimized:function(e){this._logIt("conversation:minimized",{conversationId:e.get("id")})},logConversationUnminimized:function(e){this._logIt("conversation:unminimized",{conversationId:e.get("id")})},logConversationSpamIntent:function(e){this._logIt("conversation:spam:intent",{conversationId:e.get("id")})},logConversationSpamSuccess:function(e){this._logIt("conversation:spam:success",{conversationId:e.get("id")})},logConversationSpamFail:function(e){this._logIt("conversation:spam:fail",{conversationId:e.get("id")})},logImagePreviewAdd:function(e,t){this._logImagePreviewAction("add",e,t)},logImagePreviewDismiss:function(e,t){this._logImagePreviewAction("dismiss",e,t)},logImagePreviewEdit:function(e,t){this._logImagePreviewAction("edit",e,t)},logComposePluginClick:function(e,t){var i,s=t.getName();n.isEmpty(s)||(i=s+":intent",this._logIt(i,{conversationId:e.get("id")}))},logPeeprOpen:function(e,t,i,s){var o={url:e,blogName:t};n.isEmpty(i)||n.extend(o,{postId:i}),n.isEmpty(s)||n.extend(o,{searchTagTerm:s}),this._logIt("peepr:open",o)},_logImagePreviewAction:function(e,t,i){var s,o,r,a=i.get("context");n.isEmpty(a)||(s=i.get("loggingData"),o=a+":"+e,r=n.extend({},s,{conversationId:t.get("id")}),this._logIt(o,r))},_getMessageLoggingData:function(e,t){var i,s,o,r,a,l,c,u,h;return n.isEmpty(e)?null:(l=e.isPost(),i=l?0:(e.getMessage()||"").length,s=e.get("type"),o=e.get("context"),a=e.get("loggingData"),h=e.get("creationUserAction"),r=n.extend({},a,{conversationId:t?t.get("id"):null,messageLength:i,messageType:s}),n.isEmpty(h)||n.extend(r,{creationUserAction:h}),l&&(c=e.get("post").toJSON(),u=n.get(c,"blog.uuid")||n.get(c,"blog"),n.extend(r,{postBlogUuid:u,postId:n.get(c,"id")})),n.isEmpty(o)||n.extend(r,{context:o}),r)},_logIt:function(e,t){t=t||{},n.extend(t,{platform:this.get("platform")}),o.trigger(this.get("namespace")+":"+e,{loggingData:t})}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(583),o=s.extend({name:"MessagingPoller",defaults:n.defaults({url:"/services/poll",frequency:15e3},s.prototype.defaults),initialize:function(e){return e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"channels","user")),this._requestData={token:this.user.get("polling_token"),unread_messages:!0,mention_keys:this.channels.pluck("mention_key").join(",")},s.prototype.initialize.apply(this,arguments)},getRequestData:function(){return this._requestData},hasResponseChanged:function(e){return!n.isEmpty(n.get(e,"unread_messages"))}});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(144),r=o.extend({name:"BasePoller",defaults:{url:null,requestType:"GET",dataType:"JSON",cache:!1,frequency:6e4,backoffRates:[],stopAfterNumErrors:3,isPolling:!1,hasPolled:!1,isDebugEnabled:!1},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"callback")),this.currentErrorCount=0,this.currentUnchangedCount=0},start:function(e){this.set("isPolling",!0),e?this.scheduleNextPoll():this.poll()},stop:function(){this.set("isPolling",!1),this.cancel()},cancel:function(){this.cancelCurrent(),this.cancelNext()},cancelCurrent:function(){this._currentRequest&&(n.result(this._currentRequest,"abort"),this._currentRequest=null)},cancelNext:function(){this._nextPollToken&&(clearTimeout(this._nextPollToken),this._nextPollToken=null)},beforeRemove:function(){this.stop()},setFrequency:function(e){this.set("frequency",e),this.resetPollingFrequency()},setBackoffRates:function(e){this.set("backoffRates",e),this.resetPollingFrequency()},resetPollingFrequency:function(){this.currentUnchangedCount=0,this.set("hasPolled",!1)},poll:function(){this.cancel(),this._lastPollTime=(new Date).getTime();var e=this.makeRequest.call(this);return e.done(n.bind(this._onRequestSuccess,this)).fail(n.bind(this._onRequestFail,this)).always(n.bind(this._onRequestAlways,this)),this._currentRequest=e,e},getRequestData:function(){return{}},hasResponseChanged:function(){return!0},resetErrorCount:function(){this.currentErrorCount=0,this.start()},parse:function(e){return e},getBackoffRate:function(){var e,t=this.get("backoffRates");return n.isEmpty(t)||!n.isArray(t)||0===this.currentUnchangedCount?1:(e=Math.min(this.currentUnchangedCount,t.length)-1,Math.max(1,n.get(t,e,1)))},getPollingFrequency:function(){return this.get("frequency")*this.getBackoffRate()},makeRequest:function(){var e=this.getRequestData(),t={url:this.get("url"),type:this.get("requestType"),dataType:this.get("dataType"),cache:this.get("cache"),data:e};return s.ajax(t)},scheduleNextPoll:function(){var e=this.getPollingFrequency();return this.set("hasPolled",!0),this.get("isPolling")?void(!n.isFinite(e)||0>=e||(this.currentErrorCount<=this.get("stopAfterNumErrors")?(this.cancelNext(),this._nextPollToken=setTimeout(n.bind(this.poll,this),e)):this.stop())):!1},_onRequestSuccess:function(e){this.currentErrorCount=0,e=this.parse(e),this.callback&&this.callback(e,this._lastPollTime),this.hasResponseChanged(e)||!this.get("hasPolled")?this.currentUnchangedCount=0:this.currentUnchangedCount++},_onRequestFail:function(){this.currentErrorCount++},_onRequestAlways:function(){this.scheduleNextPoll()}});e.exports=r},function(e,t,i){var n=i(7),s=i(3),o={CONVERSATION_FETCHING:"conversation:fetching",CONVERSATION_OPEN_CONVERSATION_MODEL:"conversation:open:model:conversation",CONVERSATION_OPEN_PARTICIPANT_MODELS:"conversation:open:model:partipants",CONVERSATION_OPEN_TUMBLR_URL:"conversation:open:tumblr:url",CONVERSATION_DELETE_MODEL:"conversation:delete:model",CONVERSATION_MESSAGE_SENT:"conversation:message:sent",CONVERSATION_MESSAGE_SENDING:"conversation:message:sending",CONVERSATION_MESSAGE_FAILED:"conversation:message:failed",CONVERSATION_MESSAGE_INPUT:"conversation:message:input",CONVERSATION_MESSAGES_UNREAD_FETCHED:"conversation:messages:unread:fetched",CONVERSATION_MARK_AS_SPAM:"conversation:spam",CONVERSATION_IMAGE_PREVIEW_ADD:"conversation:image:preview:add",CONVERSATION_IMAGE_PREVIEW_DISMISS:"conversation:image:preview:dismiss",CONVERSATION_IMAGE_PREVIEW_EDIT:"conversation:image:preview:edit",CONVERSATION_COMPOSE_PLUGIN_CLICK:"conversation:compose:plugin:click",BLOCK:"block"},r=function(){};r.extend=n.Model.extend,s.extend(r.prototype,n.Events),s.extend(r.prototype,o),e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(586),r=s.extend({name:"MessagingUnreadManager",defaults:{dataChannelKey:"mention_key",overridesExpirationInMs:500},initialize:function(e){
e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"channels"));var t=this.channels.map(function(e){return{channelId:e.get("uuid")}});this.unreadCollection=new o(t),this.unreadCollectionOverrides=new o(t),this.listenTo(this.unreadCollection,"change:data",this._onUnreadCollectionChange)},setData:function(e){this._pruneOverrides(),this._updateUnreadCollection(e),this.unreadData=e},setConversationModelCount:function(e,t){var i,n=e.get("id"),s=e.get("participantUuid"),o=this.unreadCollectionOverrides.findWhere({channelId:s});o&&(i=o.get("data")||{},i[n]=t,o.set({data:i,updateDate:new Date}),this._updateUnreadCollection(this.unreadData))},_getOverridesData:function(){var e=this.get("dataChannelKey");return this.unreadCollectionOverrides.reduce(function(t,i){var s=i.get("data"),o=this.channels.get(i.get("channelId")),r=o.get(e);return n.isEmpty(s)||(t[r]=s),t},{},this)},_pruneOverrides:function(){var e=new Date,t=this.get("overridesExpirationInMs");this.unreadCollectionOverrides.each(function(i){var s=i.get("updateDate");n.isDate(s)&&e-s>t&&i.set({updateDate:null,data:null})})},_updateUnreadCollection:function(e,t){var i=this._getOverridesData();this.unreadCollection.each(function(t){var s=this.channels.get(t.get("channelId")),o=s.get(this.get("dataChannelKey")),r=n.get(e,o),a=n.get(i,o);n.isEmpty(a)||(r=n.merge({},r,a)),t.set("data",r)},this)},_onUnreadCollectionChange:function(e){var t,i=e.get("data")||null,s=e.previous("data")||null,o=this.channels.get(e.get("channelId"));this.trigger("change:channel",o,i),n.each(i,function(e,i){t=n.get(s,i),t!==e&&this.trigger("change:conversation",i,e,o)},this)}});e.exports=r},function(e,t,i){"use strict";var n=i(119),s=i(587),o=n.extend({model:s});e.exports=o},function(e,t,i){"use strict";var n=i(114),s=n.extend({idAttribute:"channelId",defaults:{channelId:null,data:null}});e.exports=s},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(121),r=i(144),a=i(589),l=i(591),c=i(592),u=r.extend({name:"MessagingWindowManager",defaults:{isInboxOpen:!1,isConversationOpen:!1,inboxAnimationSpeed:100,conversationAnimationSpeed:250,isMinimizeEnabled:!1,isPersistenceEnabled:!1,isMultipleOpenWindowsEnabled:!1,conversationPopoversContainerClass:"messaging-conversation-popovers",openConversationsContainerClass:"messaging-open-conversations",minimizedConversationsContainerClass:"messaging-minimized-conversations",bodyClassConversationsOpen:"messaging-conversations-open",bodyClassConversationsMinimized:"messaging-conversations-minimized",persistenceKeyOpen:"open",persistenceKeyMinimized:"minimized"},initialize:function(e){e=s.extend({},e),s.extend(this.attributes,s.pick(e,s.keys(this.defaults))),s.extend(this,s.pick(e,"eventBus","user","channels","currentBlogModel","keyboardManager","inboxConfig","conversationConfig","persistenceManager")),this.openConversations=new a,this.minimizedConversations=new a,this.listenTo(this.openConversations,"add remove",this._onConversationsCollectionChange),this.listenTo(this.minimizedConversations,"add remove",this._onConversationsCollectionChange),this.listenTo(this.openConversations,"add remove",this._onOpenConversationsCollectionChange),this.listenTo(this.minimizedConversations,"add remove",this._onMinimizedConversationsCollectionChange),this.listenTo(this.openConversations,"add",this._onOpenConversationAdd),this.listenTo(this.openConversations,"remove",this._onConversationRemove),this.listenTo(this.minimizedConversations,"add",this._onMinimizedConversationAdd),this.listenTo(this.minimizedConversations,"remove",this._onConversationRemove),this.isPersistenceEnabled()&&this.listenTo(this.persistenceManager,"sync",this._onPersistenceManagerSync)},remove:function(e){this.isInboxOpen()&&this.removeInbox(),this.isConversationOpen()&&this.removeConversations(e)},saveConversationsState:function(e,t){this.isPersistenceEnabled()&&!this.get("isSyncing")&&this.persistenceManager.save(e.pluck("model"),t)},loadConversationsState:function(){var e,t;this.isPersistenceEnabled()&&(t=this.persistenceManager.load(this.get("persistenceKeyMinimized")),e=this.persistenceManager.load(this.get("persistenceKeyOpen")),t.then(s.bind(function(e){this._addLoadedConversationModels(e,this.minimizedConversations,{isMinimized:!0}),this.trigger("conversations:loaded:minimized",e)},this)),e.then(s.bind(function(e){this._addLoadedConversationModels(e,this.openConversations),this.trigger("conversations:loaded:open",e)},this)),o.join(e,t).spread(s.bind(function(e,t){this.trigger("conversations:loaded",e,t)},this)))},isPersistenceEnabled:function(){return!s.isEmpty(this.persistenceManager)&&this.get("isPersistenceEnabled")},_addLoadedConversationModels:function(e,t,i){s.each(e,function(e,n){s.delay(s.bind(function(){this._addLoadedConversationModel(e,t,i)},this),n)},this)},_addLoadedConversationModel:function(e,t,i){var n={skipAnimationOnRender:!0},s=this._createConversationPopover(e,n,i),o={isFromPersistence:!0,context:"persistence"};return t.add({model:e,popover:s,options:o},o)},addInbox:function(e,t){var i=this.get("inboxAnimationSpeed");return this.isInboxOpen()?this.inboxPopover:(this.inboxCollection=e,this.inboxPopover=this._createInboxPopover(e),this.trigger("inbox:adding",e,this.inboxPopover,t),i>0?setTimeout(s.bind(function(){this._afterInboxOpened(t)},this),i):this._afterInboxOpened(t),this.listenToOnce(this.inboxPopover,"close",function(){this._onInboxClose(t)}),this.set("isInboxOpen",!0),this.inboxPopover)},removeInbox:function(e){e||(e=this.inboxCollection),e===this.inboxCollection&&this.inboxPopover&&this.inboxPopover.teardown()},isInboxOpen:function(){return this.get("isInboxOpen")},addConversation:function(e,t){var i,n=this.get("isMinimizeEnabled"),s=this.get("isMultipleOpenWindowsEnabled");return s||(n?this.minimizeConversations(!0):this.removeConversations(!0)),i=this._createConversationPopover(e),e.set("lastOpenedDateTs",(new Date).getTime()),this.openConversations.add({model:e,popover:i,options:t}),i},removeConversation:function(e,t){var i=this._getWindowModel(e);this.openConversations.remove(i,{skipAnimation:t})},isConversationMinimized:function(e){var t,i=this.getConversationPopover(e);return i?(t=i.getView(),t&&t.isMinimized()):!1},removeConversations:function(e){this.openConversations.remove(this.openConversations.models,{skipAnimation:e})},isConversationOpen:function(){return this.get("isConversationOpen")},getConversationPopover:function(e){var t=this._getWindowModel(e);return t?t.getPopover():null},getConversationModelByIdAndParticipant:function(e,t){return this.openConversations.getByIdAndParticipant(e,t)||this.minimizedConversations.getByIdAndParticipant(e,t)},minimizeConversations:function(e){var t=s.clone(this.openConversations.models);s.each(t,function(t){t.getView().minimize(e)})},_createConversationPopover:function(e,t,i){var n,o=s.result(this.conversationConfig,"options"),r=s.get(this.conversationConfig,"constructor"),a=s.get(this.conversationConfig,"popoverOptions"),l=s.bind(function(t){return s.extend({},o,{eventBus:this.eventBus,user:this.user,channels:this.channels,model:e,popoverContainer:t.el,keyboardManager:this.keyboardManager},i)},this);return a=s.extend({},a,{viewConstructor:r,viewOptions:l},t),n=new c(a),n.render(),this._removeTimer&&clearTimeout(this._removeTimer),n},_createInboxPopover:function(e){var t,i=s.result(this.inboxConfig,"options"),n=s.get(this.inboxConfig,"constructor"),o=s.result(this.inboxConfig,"popoverOptions"),r=s.bind(function(t){return s.extend({},i,{eventBus:this.eventBus,collection:e,user:this.user,channels:this.channels,currentBlogModel:this.currentBlogModel,keyboardManager:this.keyboardManager,popoverContainer:t.el})},this);return o=s.extend({},o,{viewConstructor:n,animationSpeed:this.get("inboxAnimationSpeed"),viewOptions:r}),t=new l(o),t.render(),t},_removeConversationPopover:function(e,t){var i=this.get("conversationAnimationSpeed");t||0>=i?e.remove():e.teardown(),this._checkRemoveConversationPopoversContainer(t)},_checkRemoveConversationPopoversContainer:function(e){var t=this.get("conversationAnimationSpeed"),i=function(){var e=this.openConversations.length>0,t=this.minimizedConversations.length>0;e||t||this._removeConversationPopoversContainer()};this._removeTimer&&(clearTimeout(this._removeTimer),this._removeTimer=null),e||0>=t?i.call(this):this._removeTimer=setTimeout(s.bind(function(){i.call(this),this._removeTimer=null},this),t)},_focusNextConversationWindow:function(e){return this._incrementFocusConversationWindow(e,1)},_focusPreviousConversationWindow:function(e){return this._incrementFocusConversationWindow(e,-1)},_incrementFocusConversationWindow:function(e,t){var i,n,o,r,a,l=[];return l.push.apply(l,this.openConversations.models),l.push.apply(l,this.minimizedConversations.models),a=l.length,2>a?!1:(i=s.indexOf(l,e),n=i+=t,n>=a||0>n?!1:(o=s.get(l,n),s.isEmpty(o)?!1:(r=o.getPopover(),r.focus(),!0)))},_callAfterDelay:function(e,t){t>0?setTimeout(s.bind(e,this),t):e.call(this)},_onOpenConversationAdd:function(e,t,i){this._onConversationAdd(e,t,i,this._getOpenConversationsContainer())},_onMinimizedConversationAdd:function(e,t,i){this._onConversationAdd(e,t,i,this._getMinimizedConversationsContainer())},_onConversationAdd:function(e,t,i,n){var o=e.getPopover(),r=t.indexOf(e),a=s.get(i,"isMoving",!1);this._insertElementAtIndex(o.$el,n,r),a||this._afterConversationWindowModelAdded(e,i)},_onConversationRemove:function(e,t,i){var n=s.get(i,"skipAnimation",!1),o=s.get(i,"isMoving",!1);o||this._afterConversationWindowModelRemoved(e,n)},_onPersistenceManagerSync:function(e,t){this._syncFlushData||(this._syncFlushData={}),s.set(this._syncFlushData,e,t),this._syncFlushTimer||(this._syncFlushTimer=setTimeout(s.bind(function(){this._flushSync(this._syncFlushData),delete this._syncFlushTimer,delete this._syncFlushData},this),50))},_flushSync:function(e){var t=s.get(e,this.get("persistenceKeyOpen"),[]),i=s.get(e,this.get("persistenceKeyMinimized"),[]),n=this.openConversations.pluck("model"),o=this.minimizedConversations.pluck("model"),r=this._getConversationLookupCache(t),a=this._getConversationLookupCache(i),l=this._getConversationLookupCache(n),c=this._getConversationLookupCache(o),u=[],h=[],d=[],p=[];this.set("isSyncing",!0),s.each(l,s.bind(function(e,t){s.has(r,t)||(s.has(a,t)?h.push(e):u.push(e))},this)),d=s.reduce(c,s.bind(function(e,t,i){return!s.has(a,i)&&s.has(r,i)&&e.push(t),e},this),[]),p=s.reduce(r,s.bind(function(e,t,i){return s.has(l,i)||s.has(c,i)||e.push(t),e},this),[]),s.each(h,s.bind(function(e){var t=this.openConversations.getByConversationModel(e);t.getView().minimize(!0)},this)),s.each(d,s.bind(function(e){var t=this.minimizedConversations.getByConversationModel(e);t.getView().unminimize(!0)},this)),s.each(u,s.bind(function(e){this.removeConversation(e,!0)},this)),s.each(p,s.bind(function(e){this.addConversation(e)},this)),this.set("isSyncing",!1)},_getConversationLookupCacheKey:function(e){var t=[e.getParticipantId()].concat(e.getParticipantsIds());return t.join(":")},_getConversationLookupCache:function(e){return s.mapKeys(e,this._getConversationLookupCacheKey)},_insertElementAtIndex:function(e,t,i){var n=t.children();0===n.length||0===i?t.prepend(e):i>=n.length?t.append(e):e.insertBefore(s.get(n,i))},_onConversationWindowTab:function(e,t){this._focusNextConversationWindow(e)&&t.preventDefault()},_onConversationWindowShiftTab:function(e,t){this._focusPreviousConversationWindow(e)&&t.preventDefault()},_onMinimizedConversationsCollectionChange:function(e,t,i){s.get(i,"isFromPersistence")||this.saveConversationsState(this.minimizedConversations,this.get("persistenceKeyMinimized"))},_onOpenConversationsCollectionChange:function(e,t,i){s.get(i,"isFromPersistence")||this.saveConversationsState(this.openConversations,this.get("persistenceKeyOpen"))},_onConversationsCollectionChange:function(){var e=this.openConversations.length>0||this.minimizedConversations.length>0;this.set("isConversationOpen",e),this._addBodyConversationClasses()},_addBodyConversationClasses:function(){var e=n("body");e.toggleClass(this.get("bodyClassConversationsOpen"),this.openConversations.length>0),e.toggleClass(this.get("bodyClassConversationsMinimized"),this.minimizedConversations.length>0)},_onInboxClose:function(e){var t=this.get("inboxAnimationSpeed");this.trigger("inbox:removing",this.inboxCollection,this.inboxPopover,e),this.set("isInboxOpen",!1),t>0?setTimeout(s.bind(function(){this._afterInboxClosed(e)},this),t):this._afterInboxClosed(e)},_onChangeConversationMinimized:function(e,t){var i=t?this.openConversations:this.minimizedConversations,n=t?this.minimizedConversations:this.openConversations,s=i.getByConversationModel(e),o=t?"conversation:minimized":"conversation:unminimized",r={isMoving:!0};t||this.get("isMultipleOpenWindowsEnabled")||this.minimizeConversations(!0),i.remove(s,r),n.add(s,r),this._addBodyConversationClasses(),this.trigger(o,s.getConversation(),s.getPopover())},_afterInboxOpened:function(e){this.trigger("inbox:added",this.inboxCollection,this.inboxPopover,e)},_afterInboxClosed:function(e){this.trigger("inbox:removed",this.inboxCollection,this.inboxPopover,e),this.inboxPopover=null,this.inboxCollection=null},_getConversationsPopoversContainer:function(){return this.conversationsPopoversContainer||(this.conversationsPopoversContainer=n("<div />").addClass(this.get("conversationPopoversContainerClass")).appendTo(n("body"))),this.conversationsPopoversContainer},_getOpenConversationsContainer:function(){var e;return this.openConversationsContainer||(e=this._getConversationsPopoversContainer(),this.openConversationsContainer=n("<div />").addClass(this.get("openConversationsContainerClass")).prependTo(e)),this.openConversationsContainer},_getMinimizedConversationsContainer:function(){var e;return this.minimizedConversationsContainer||(e=this._getConversationsPopoversContainer(),this.minimizedConversationsContainer=n("<div />").addClass(this.get("minimizedConversationsContainerClass")).appendTo(e)),this.minimizedConversationsContainer},_removeConversationPopoversContainer:function(){this.conversationsPopoversContainer&&(this.conversationsPopoversContainer.remove(),this.conversationsPopoversContainer=null),this.openConversationsContainer&&(this.openConversationsContainer.remove(),this.openConversationsContainer=null),this.minimizedConversationsContainer&&(this.minimizedConversationsContainer.remove(),this.minimizedConversationsContainer=null)},_getWindowModel:function(e){return this.openConversations.getByConversationModel(e)||this.minimizedConversations.getByConversationModel(e)},_addConversationWindowEvents:function(e){var t=e.getView();this.listenTo(t,"keydown:tab",function(t){this._onConversationWindowTab(e,t)}),this.listenTo(t,"keydown:shift+tab",function(t){this._onConversationWindowShiftTab(e,t)}),this.listenToOnce(t,"close",function(){this.removeConversation(e.getConversation())}),this.listenTo(t,"change:isMinimized",function(t,i){this._onChangeConversationMinimized(e.getConversation(),i)})},_afterConversationWindowModelAdded:function(e){var t=e.getConversation(),i=e.getPopover(),n=e.getOptions(),s=this.get("conversationAnimationSpeed"),o=function(){this.trigger("conversation:added",t,i,n)};this.trigger("conversation:adding",t,i,n),this._addConversationWindowEvents(e),this._callAfterDelay(o,s)},_afterConversationWindowModelRemoved:function(e,t){var i=this.get("conversationAnimationSpeed"),n=e.getView(),o=e.getPopover(),r=e.getConversation(),a=e.getOptions(),l=function(){this.trigger("conversation:removed",r,o,a)};this.stopListening(o),this.stopListening(n),this._removeConversationPopover(o,t),this.trigger("conversation:removing",r,o,a),t||0>=i?l.call(this):setTimeout(s.bind(l,this),i)}});e.exports=u},function(e,t,i){"use strict";var n=i(3),s=i(119),o=i(590),r=s.extend({model:o,comparator:function(e){return e.getConversation().get("lastOpenedDateTs")},getByIdAndParticipant:function(e,t){var i=this.find(function(i){var n=i.getConversation();return n.get("id")===e&&n.get("participantUuid")===t});return i?i.getConversation():null},getByConversationModel:function(e){return this.find(function(t){var i=t.getConversation();return!n.isEmpty(i)&&i.isSameConversation(e)})}});e.exports=r},function(e,t,i){"use strict";var n=i(114),s=n.extend({defaults:{popover:null,model:null,options:null,skipAnimation:!1,isMinimizing:!1},getOptions:function(){return this.get("options")},getConversation:function(){return this.get("model")},getPopover:function(){return this.get("popover")},getView:function(){var e=this.getPopover();return e?e.getView():null}});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(156),r=i(211),a=o.extend({className:"popover--inbox-popover",mixins:[r],defaults:{animationSpeed:100},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"viewOptions","viewConstructor"))},render:function(){return this.$wrapper=s("<div />").addClass("popover-inner").appendTo(this.$el),this.$wrapper.addClass("hide-popover"),this.$pinned.addClass("active"),this._createView(this.viewOptions),n.defer(n.bind(function(){this.$wrapper.removeClass("hide-popover")},this)),this},teardown:function(){var e=this.get("animationSpeed");return this.$wrapper.addClass("hide-popover"),this.$pinned.removeClass("active"),e>0?setTimeout(n.bind(this._afterHide,this),this.get("animationSpeed")):this._afterHide(),this},getView:function(){return this.inboxView},_createView:function(e){e=n.isFunction(e)?e.call(this,this):e,this.inboxView&&this.inboxView.remove(),this.inboxView=new this.viewConstructor(e),this.$wrapper.html(this.inboxView.render().$el)},_afterHide:function(){this.inboxView&&this.inboxView.remove(),this.$el.remove()}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(156),o=s.extend({className:"popover--conversation-popover",defaults:{animationSpeed:250,skipAnimationOnRender:!1,skipAnimationOnRemove:!1},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"viewOptions","viewConstructor")),n.isFunction(this.viewOptions)&&(this.viewOptions=this.viewOptions.call(this,this))},render:function(){return this.conversationView=new this.viewConstructor(this.viewOptions),this.$el.html(this.conversationView.render().$el),!this.get("skipAnimationOnRender")&&this.get("animationSpeed")>=0&&this._animateIn(),this},teardown:function(){var e=this.get("animationSpeed");return!this.get("skipAnimationOnRemove")&&e>=0?(this.$el.addClass("hide-popover"),setTimeout(n.bind(this.remove,this),e)):this.remove(),this},beforeRemove:function(){this.conversationView&&this.conversationView.remove()},getView:function(){return this.conversationView},poll:function(){var e=this.getView();return e?e.poll():void 0},refresh:function(e){var t=this.getView();return t?t.refresh(e):void 0},fetch:function(){var e=this.getView();return e?e.fetch():void 0},focus:function(){var e=this.getView();return e?e.focus():void 0},isMinimized:function(){var e=this.getView();return e?e.isMinimized():void 0},_animateIn:function(){this.$el.addClass("hide-popover"),n.defer(n.bind(function(){this.rendered&&this.$el.removeClass("hide-popover")},this))}});e.exports=o},function(e,t,i){"use strict";var n=i(9),s=i(121),o=i(3),r=i(144),a=i(594),l=r.extend({name:"MessagingWindowPersistence",defaults:{storageKeyPrefix:"messaging",isSyncEnabled:!1},initialize:function(e){e=o.extend({},e),o.extend(this.attributes,o.pick(e,o.keys(this.defaults))),o.extend(this,o.pick(e,"user")),this.get("isSyncEnabled")&&this._addSyncListeners()},save:function(e,t){var i,n=s.defer(),r=this._getStorageKey(t);return i=o.map(e,this._getObjectFromModel),this._saveLocalStorage(r,i),n.resolve(),n.promise},load:function(e){var t=s.defer(),i=this._getStorageKey(e),n=this._loadLocalStorage(i),r=o.map(n,this._getModelFromObject);return t.resolve(r||[]),t.promise},clear:function(){var e,t=window.localStorage;if(t){e=this._getStorageKey();try{o.each(o.keys(t),function(i){o.startsWith(i,e+":")&&t.removeItem(i)})}catch(i){this._triggerError(i)}}},remove:function(){this.get("isSyncEnabled")&&this._removeSyncListeners()},_addSyncListeners:function(){n(window).on("storage.messaging-window-persistence",o.bind(this._onStorageChange,this))},_removeSyncListeners:function(){n(window).off(".messaging-window-persistence")},_onStorageChange:function(e){var t,i,n=o.get(e,"originalEvent.key"),s=o.get(e,"originalEvent.newValue"),r=this._getStorageKey(),a=n.substring(r.length+1);if(!o.isEmpty(n)&&!o.isEmpty(a)&&o.startsWith(n,r)&&!o.isEmpty(s))try{t=JSON.parse(s),i=o.map(t,this._getModelFromObject),this.trigger("sync",a,i),this.trigger("sync:"+a,i)}catch(l){this._triggerError(l)}},_getStorageKey:function(e){var t=[this.get("storageKeyPrefix"),this.user.get("name"),e];return o.compact(t).join(":")},_saveLocalStorage:function(e,t){if(window.localStorage)try{window.localStorage.setItem(e,JSON.stringify(t))}catch(i){this._triggerError(i)}},_loadLocalStorage:function(e){var t;if(!window.localStorage)return[];try{return t=window.localStorage.getItem(e),o.isEmpty(t)?[]:JSON.parse(t)}catch(i){return this._triggerError(i),[]}},_getObjectFromModel:function(e){var t=["uuid","url","name","avatar_url","theme"],i=e.get("participants").map(function(e){return e.pick(t)});return{id:e.get("id"),participantUuid:e.get("participantUuid"),participants:i,lastOpenedDateTs:e.get("lastOpenedDateTs")}},_getModelFromObject:function(e){return new a(e)},_triggerError:function(e){this.trigger("error",e)}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(595),r=i(596),a=i(114),l=i(597),c=i(600),u=i(602),h=a.extend({url:"/svc/conversations/messages",mixins:[o,r],relations:{messages:c,participants:u},relationsOrder:["participants","messages"],defaults:{id:null,status:null,last_modified_ts:null,last_read_ts:null,participants:null,messages:null,can_send:!0,is_possible_spam:!1,lastOpenedDateTs:null,participantUuid:null,unreadCount:0},fetchNonErrorCodes:[404],fetchNoRetryOnErrorCodes:[403,428,429],isUnread:function(){return this.get("last_modified_ts")>this.get("last_read_ts")},hasQueuedMessages:function(){return(this.getQueue()||[]).length>0},flushMessageQueue:function(e){return this.flushQueue(this.sendMessage,e).fail(n.bind(function(e){e.isPost()&&(e.canRetry()?this.prependToQueue(e):e.postHasTextMessage()&&this.removeFromMessageQueue(n.first(this.getMessageQueue())))},this))},getMessageQueue:function(){return this.getQueue()},removeFromMessageQueue:function(e){return this.removeFromQueue(e)},appendToMessageQueue:function(e){return this.appendToQueue(e)},prependToMessageQueue:function(e){return this.prependToQueue(e)},canRetryFetch:function(e){return n.isFinite(e)&&!n.contains(this.fetchNoRetryOnErrorCodes,e)},markAsRead:function(){var e=(new Date).getTime();this.set({last_read_ts:parseInt(e/1e3,10),unreadCount:0})},parse:function(e,t){var i=n.get(e,"response")||e;return i},destroy:function(e){var t={conversation_id:this.get("id"),participant:this.get("participantUuid")};return e=n.extend({},e,{url:this.url+"?"+s.param(t)}),a.prototype.destroy.call(this,e)},markAsSpam:function(e){e=e||"inline";var t={conversation_id:this.get("id"),participant:this.get("participantUuid"),context:e,type:"spam"};return s.ajax({url:"/svc/conversations/flag",method:"POST",with_form_key:!0,data:t})},fetchConversation:function(e){var t=new s.Deferred,i=function(){t.resolve.apply(this,arguments)},o=function(){t.reject.apply(this,arguments)};return this.fetch(this._getFullFetchOptions(e)).then(n.bind(i,this)).fail(n.bind(function(e,t){var s=n.get(e,"status");this.isNew()&&n.contains(this.fetchNonErrorCodes,s)?i.call(this,{},t):o.apply(this,arguments)},this)),t},poll:function(e,t){var i;if(!this.isNew())return i={participant:this.get("participantUuid"),conversation_id:this.get("id")},t&&n.extend(i,{limit:t}),this.get("messages").poll({isPolling:!0,data:i})},getConversationDataForMessage:function(){var e={participant:this.get("participantUuid")};return this.isNew()?n.extend(e,{participants:this.getParticipantsIds()}):n.extend(e,{conversation_id:this.get("id")}),e},sendMessage:function(e,t){return t=t||{},e.set(this.getConversationDataForMessage()),this.get("messages").add(e,t),e.save(null,t).then(n.bind(function(e){this.isNew()&&this.set(n.omit(this.parse(e,t),"messages"))},this))},getParticipantModel:function(){return this.get("participants").get(this.get("participantUuid"))},getParticipantId:function(){return this.get("participantUuid")},getParticipantsIds:function(){return this.get("participants").pluck("uuid")},getOtherParticipant:function(){var e=this.get("participants").getWithout([this.getParticipantId()]);return n.first(e)},getInboxMessage:function(){var e=this.get("messages").where({isError:!1});return n.last(e)},isSameConversation:function(e){var t=e.getParticipantId(),i=e.getParticipantsIds(),s=this.getParticipantId(),o=this.getParticipantsIds();return s===t&&n.union(o,i).length===o.length},_getFullFetchOptions:function(e){var t=this.isNew()?this._getDataForFetchByParticipants():this._getDataForFetchById();return t=n.extend({},t,{participant:this.get("participantUuid")}),n.extend({},e,{isFetching:!0,cache:!1,reset:!0,data:t})},_getDataForFetchById:function(e){return{conversation_id:this.get("id")}},_getDataForFetchByParticipants:function(e){return{participants:this.getParticipantsIds()}}},{createPostMessage:function(e,t,i){return i=n.extend({},i,{clientTs:new Date,isPending:!0,type:l.POST,post:{blog:t,id:e}}),new l(i)},createTextMessage:function(e,t){return t=n.extend({},t,{clientTs:new Date,isPending:!0,type:l.TEXT,message:e,content:{text:e}}),new l(t)},createImagePostMessage:function(e,t,i,n,s,o){var r=h.createPostMessage(e,t,o),a=r.getPost();return a.setType("photo"),a.addThumbnail(i,n,s),r}});e.exports=h},function(e,t,i){"use strict";var n=i(3),s=i(7),o=i(116),r=new o({defaults:{relationKeys:function(){return n.keys(this.relations)},getRelations:function(){return n.pick(this.attributes,this.relationKeys())}},before:{initialize:function(e,t){this._bootstrapRelations(e,t)}},extend:{_isModelOrCollection:function(e){return e instanceof s.Collection||e instanceof s.Model},_bootstrapRelations:function(e,t){this._isBootstrapped||(n.forEach(this.relations,function(i,s){var o=this.attributes[s];!n.isEmpty(o)&&o instanceof i||(this.attributes[s]=new i(e[s],t))},this),this._isBootstrapped=!0)}},around:{set:function(e,t,i,o){var r,a,l,c,u,h,d=this.attributes,p=this.relationKeys(),g=!this._isBootstrapped;return n.isObject(t)?(r=t,o=i):(r={})[t]=i,o=o||{},u=n.result(o,"relationalSetOptions")||{},this._bootstrapRelations(r,o),a=n.pick(r,p),n.isEmpty(a)?e.apply(this,n.rest(arguments)):(h=n.isEmpty(this.relationsOrder)?n.keys(a):this.relationsOrder,g||n.forEach(h,function(e){r[e]&&(c=a[e],l=d[e],this._isModelOrCollection(l)&&(o.unset?l instanceof s.Collection?l.reset():l instanceof s.Model&&l.clear():(this._isModelOrCollection(c)&&(c=c.toJSON()),o.reset&&l instanceof s.Collection?l.reset(c,n.extend({},o,u[e])):l.set(c,n.extend({},o,u[e])))))},this),e.call(this,n.omit(r,p),o))},toJSON:function(e){var t=e.apply(this,n.rest(arguments))||{};for(var i in this.relations)this.relations.hasOwnProperty(i)&&(t[i]=n.result(t[i],"toJSON")||t[i]);return t}}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(116),r=new o({extend:{getQueue:function(){return this.queue||(this.queue=[]),this.queue},clearQueue:function(){this.getQueue().length=0},appendToQueue:function(e){var t=this.getQueue();return t.push.apply(t,this._getItemsAsArray(e)),t},prependToQueue:function(e){var t=this.getQueue();return t.unshift.apply(t,this._getItemsAsArray(e)),t},removeFromQueue:function(e){return this.queue=n.difference(this.getQueue(),this._getItemsAsArray(e)),this.queue},flushQueue:function(e,t){var i,o=this.getQueue();return this._isFlushingQueue?this._flushQueueDeferred:n.isFunction(e)?(this._isFlushingQueue=!0,this._flushQueueDeferred=new s.Deferred,i=function(){var s;if(this._isFlushingQueue){if(0===o.length)return this._isFlushingQueue=!1,void this._onQueueSuccess(t);s=o.shift(),this._onQueueItemStart(s,t),e.call(this,s,t).then(n.bind(function(){this._onQueueItemSuccess(s,t),i.call(this)},this)).fail(n.bind(function(){this._isFlushingQueue=!1,this._onQueueItemFail(s,t)},this))}},i.call(this),this._flushQueueDeferred):void 0},abortFlush:function(){this._isFlushingQueue&&(this._isFlushingQueue=!1,this._flushQueueDeferred.reject())},_getItemsAsArray:function(e){return n.isArray(e)||(e=[e]),e},_onQueueItemStart:function(e,t){this._flushQueueDeferred.notify(e,!1,t,this.getQueue())},_onQueueItemSuccess:function(e,t){this._flushQueueDeferred.notify(e,!0,t,this.getQueue())},_onQueueItemFail:function(e,t){this._flushQueueDeferred.reject(e,t,this.getQueue())},_onQueueSuccess:function(e){this._flushQueueDeferred.resolve(e)}}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(114),o=i(595),r=i(598),a=i(599),l={TEXT:"TEXT",POST:"POSTREF"},c=s.extend({mixins:[o],relations:{content:r,post:a},idAttribute:"ts",defaults:{conversation_id:null,type:l.TEXT,ts:null,participant:null,participants:null,content:null,message:null,post:null,collapseGroup:null,clientTs:null,tsHeader:null,isPending:!1,isError:!1,isCollapsed:!1,canRetry:!0,hasAnimation:!1,postHasTextMessage:!1,context:null,creationUserAction:null},persistedFields:["conversation_id","type","participant","participants","message","post","context"],saveNoRetryOnErrorCodes:[403,404,428],validSendMessageContexts:["post-chrome","messaging-gif"],parse:function(e,t){return n.get(e,"response.messages.data.0")||e},save:function(e,t){var i,o,r,a;return t=t||{},e=e||{},e&&this.set(e),o=this.toJSON(),r=n.pick(o,this.persistedFields),a=this._getServerLoggingContext(),n.isEmpty(a)?delete r.context:n.extend(r,{context:a}),n.extend(t,{data:r,emulateJSON:!0}),i=s.prototype.save.call(this,e,t),this.set("isPending",!0),i.then(n.bind(function(){this.set("isError",!1)},this)).fail(n.bind(function(e){this.set({isError:!0,canRetry:this._canRetryOnErrorCode(n.get(e,"status"))})},this)).always(n.bind(function(){this.set("isPending",!1)},this)),i},updateClientTimestamp:function(){this.set("clientTs",(new Date).getTime())},getPost:function(){return this.get("post")},getTimestamp:function(){return this.get("clientTs")||parseInt(this.get("ts"),10)},getMessage:function(){return this.isText()?this.get("content").get("text"):this.isPost()?this.get("post").getMessage():void 0},isError:function(){return this.get("isError")},isText:function(){return this.get("type")===l.TEXT},isPost:function(){return this.get("type")===l.POST},isDisabledPost:function(){return this.isPost()&&this.get("post").isDisabled()},isPending:function(){return this.get("isPending")},canRetry:function(){return this.get("canRetry")},postHasTextMessage:function(){return this.isPost()&&this.get("postHasTextMessage")},_canRetryOnErrorCode:function(e){return n.isFinite(e)&&!n.contains(this.saveNoRetryOnErrorCodes,e)},_getServerLoggingContext:function(){var e=this.get("context");return!n.isEmpty(e)&&(e=n.first(e.split(":")),n.contains(this.validSendMessageContexts,e))?e:null}},l);e.exports=c},function(e,t,i){"use strict";var n=i(114),s=n.extend({defaults:{text:null,formatting:[]}});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(114),r=i(192),a=o.extend({defaults:{type:null,summary:null,state:null,photos:[]},setType:function(e){var t=["photo","link","quote","audio","video","chat"];n.contains(t,e)&&this.set("type",e)},getMessage:function(){return"gif"===this.getType()?null:this.get("summary")},getSentString:function(e){var t,i=this.getType(),o=!n.isEmpty(e),r=o?s("%1$s sent a post",e):s("sent a post:"),a=o?s("%1$s sent a post that's no longer available",e):s("sent a post that's no longer available");return this.isDisabled()?a:(t=o?{photo:s("%1$s sent a photo",e),photoset:s("%1$s sent a photoset",e),gif:s("%1$s sent a GIF",e),link:s("%1$s sent a link",e),quote:s("%1$s sent a quote",e),audio:s("%1$s sent an audio post",e),
video:s("%1$s sent a video",e),chat:s("%1$s sent a chat",e)}:{photo:s("sent a photo:"),photoset:s("sent a photoset:"),gif:s("sent a GIF"),link:s("sent a link:"),quote:s("sent a quote:"),audio:s("sent an audio post:"),video:s("sent a video:"),chat:s("sent a chat:")},n.has(t,i)?n.get(t,i):r)},getType:function(){var e;if("photo"===this.get("type")){if(this._isThumbnailGIF())return"gif";if(e=this.get("photos")||[],e.length>1)return"photoset"}return this.get("type")},getThumbnail:function(e){var t,i=this._getClientThumbnail();return n.isEmpty(i)?(t=this._getPostThumbnail(e),n.isEmpty(t)?null:t):i},hasThumbnail:function(e){return!n.isEmpty(this.getThumbnail(e))},getScaledDimensionsForWidth:function(e,t){var i;return n.has(e,"width")&&n.has(e,"height")?(i=Math.round(n.get(e,"height")/(n.get(e,"width")/t)),{width:t,height:i}):null},isDisabled:function(){return"disabled"===this.get("state")},addThumbnail:function(e,t,i){!n.isEmpty(e)&&n.isNumber(t)&&n.isNumber(i)&&this.set("clientThumbnail",{url:e,width:t,height:i})},_getClientThumbnail:function(){return this.get("clientThumbnail")},_getPostThumbnail:function(e){var t,i,s=this.get("thumbnail_url"),o=this.get("thumbnail_height"),r=this.get("thumbnail_width"),a=this.get("photos");return e=e||250,!n.isEmpty(a)||!n.isEmpty(s)&&n.isFinite(o)&&n.isFinite(r)?n.isEmpty(a)?{url:s,height:o,width:r}:(i=n.sortBy(n.get(n.first(a),"alt_sizes"),"width"),t=n.find(i,function(t){return n.get(t,"width",0)>=e}),n.isEmpty(t)?n.last(i):t):null},_isThumbnailGIF:function(){var e,t=n.get(this.getThumbnail(),"url");return n.isEmpty(t)?!1:(e=r.getExtension(t),"gif"===(e||"").toLowerCase())}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(119),o=i(601),r=i(597),a=s.extend({url:"/svc/conversations/messages",mixins:[o],model:r,comparator:function(e){return e.getTimestamp()},_getRoot:function(e){return n.has(e,"response")?n.get(e,"response.messages"):e},parse:function(e,t){return n.get(this._getRoot(e),"data")||[]},parsePreviousLink:function(e,t){return n.get(this._getRoot(e),"_links.previous")},parseNextLink:function(e,t){return n.get(this._getRoot(e),"_links.next")},poll:function(e){return e=e||{},n.extend(e,{cache:!1,remove:!1,skipParseLinks:!0}),this.fetch(e)}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(121),o=i(116),r=new o({extend:{setNextLink:function(e){var t,i=this.hasNextPage();this._nextLink=e,t=this.hasNextPage(),i!==t&&this.trigger("change:hasNextPage",this,t)},setPreviousLink:function(e){var t,i=this.hasPreviousPage();this._previousLink=e,t=this.hasPreviousPage(),i!==t&&this.trigger("change:hasPreviousPage",this,t)},getNextLink:function(){return this._nextLink},getPreviousLink:function(){return this._previousLink},hasNextPage:function(){return!n.isEmpty(this.getNextLink())},hasPreviousPage:function(){return!n.isEmpty(this.getPreviousLink())},fetchNextPage:function(e,t){return e=e||{},this.hasNextPage()?(e.isInfiniteScroll!==!1&&n.extend(e,{skipParsePreviousLink:!0,remove:!1}),this._fetchPage(this.getNextLink(),e)):s.reject()},fetchPreviousPage:function(e,t){return e=e||{},this.hasPreviousPage()?(e.isInfiniteScroll!==!1&&n.extend(e,{skipParseNextLink:!0,remove:!1}),this._fetchPage(this.getPreviousLink(),e)):s.reject()},_fetchPage:function(e,t){var i=n.isString(e)?e:e.href;return t=t||{},n.extend(t,{url:i}),this.fetch(t)}},defaults:{parsePreviousLink:function(e,t){return null},parseNextLink:function(e,t){return null}},before:{reset:function(e){this.setPreviousLink(null),this.setNextLink(null)},parse:function(e,t){t=t||{},t.skipParseLinks||(!t.skipParsePreviousLink&&n.isFunction(this.parsePreviousLink)&&this.setPreviousLink(this.parsePreviousLink(e,t)),!t.skipParseNextLink&&n.isFunction(this.parseNextLink)&&this.setNextLink(this.parseNextLink(e,t)))}}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(119),o=i(603),r=s.extend({model:o,getSortedByChannels:function(e,t){var i=this.clone(),s=t?-1:1,o=e.length;return i.sortBy(function(t){var i=n.indexOf(e,t.get("uuid")),r=i>-1,a=r?o-i:-1;return s*a})},getWithout:function(e){var t=this.clone();return t.filter(function(t){return!n.contains(e,t.get("uuid"))})}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(595),o=i(178),r=i(114),a=i(604),l=r.extend({url:"/svc/conversations/participant_info",mixins:[s],relations:{theme:a},defaults:{theme:null,is_blog_following_you:!1,is_following_blog:!1,duration_blog_following_you:null,duration_following_blog:null,blog_tags:[]},idAttribute:"uuid",parse:function(e){return!n.has(e,"theme")&&n.has(e,"global_theme_params")&&n.extend(e,{theme:n.get(e,"global_theme_params")}),n.get(e,"response",e)},getAvatarUrl:function(e){return e=e||96,o(this.get("avatar_url"),e)},getAvatarShape:function(){return this.get("theme").get("avatar_shape")},getBlogTags:function(){var e=this.get("blog_tags");return n.isArray(e)?e:[]},getDescription:function(){return this.get("theme").get("show_description")!==!0?"":this.get("description")},fetchAdditionalInfo:function(e,t){return t=n.extend({},t,{merge:!0,data:{q:this.get("uuid"),participant:e}}),this.fetch(t)},isFollowingYou:function(){return this.get("is_blog_following_you")===!0},isFollowing:function(){return this.get("is_following_blog")===!0},isMutuals:function(){return this.isFollowingYou()&&this.isFollowing()},getDurationFollowingYouSeconds:function(){var e=this.get("duration_blog_following_you");return this.isFollowingYou()&&n.isNumber(e)?e:null},getDurationFollowingSeconds:function(){var e=this.get("duration_following_blog");return this.isFollowing()&&n.isNumber(e)?e:null},getDurationMutualsSeconds:function(){var e,t;return this.isMutuals()?(e=this.getDurationFollowingSeconds(),t=this.getDurationFollowingYouSeconds(),Math.min(e,t)):null}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(568),o=i(114),r=o.extend({defaults:{background_color:null,link_color:null,avatar_shape:null,header_image_focused:null,show_header_image:!0,adjustBrightnessFactor:.3},getHeaderImage:function(){return this.get("show_header_image")===!0?this.get("header_image_focused"):null},getBackgroundTint:function(){return this.getTint(this.get("background_color"))},getAccentTint:function(){return this.getTint(this.get("link_color"))},getTint:function(e){var t;return this.get("tint"+e)?this.get("tint"+e):n.isEmpty(e)?null:(t=s.isLight(e,.5)?s.isLight(e,.05,.95)?r.TINT_WHITE:r.TINT_LIGHT:r.TINT_DARK,this.set("tint"+e,t),t)},isDark:function(e){return this.getTint(e)===r.TINT_DARK},isReadableOn:function(e,t){return e=s.hexToHsv(e),t=s.hexToHsv(t),!s.compare(e,t)},adjustColorForBackground:function(e,t){var i=this.get("adjustBrightnessFactor");return this.isReadableOn(e,t)?e:this.adjustBrightness(e,this.isDark(e)?i:-1*i)},getReadableColor:function(e,t){return this.isReadableOn(e,t)?e:s.readable(e)},adjustBrightness:function(e,t){return s.brighten(e,t)},getTintSuffix:function(e){return e===r.TINT_WHITE?"-white":e===r.TINT_LIGHT?"-light":e===r.TINT_DARK?"-dark":void 0}},{TINT_LIGHT:"light",TINT_DARK:"dark",TINT_WHITE:"white"});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(606),o=s.extend({name:"MessagingKeyboardManager",addKeyboardAccess:function(e){return n.isFunction(n.get(e,"soloKeys"))?(e.enableKeys(),e.soloKeys(!0),!0):!1},removeKeyboardAccess:function(e){return n.isFunction(n.get(e,"unSoloKeys"))?(e.disableKeys(),e.unSoloKeys(),!0):!1}});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(607),r=s.extend({name:"BaseKeyboardManager",defaults:{isDebugEnabled:!1,keepInactiveItems:!0,allowMultipleActiveViews:!1},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),this.collection=new o,this.listenTo(this.collection,"add",this._onAddItem),this.listenTo(this.collection,"remove",this._onRemoveItem),this.listenTo(this.collection,"change:isActive",this._onItemActiveChange)},addKeyboardAccess:n.noop,removeKeyboardAccess:n.noop,add:function(e,t){return e&&t?this.collection.get(e)?!1:(this.get("keepInactiveItems")||this.get("allowMultipleActiveViews")||this.collection.remove(this.collection.models),this.collection.unshift({namespace:e,view:t}),this._adjustActiveStates(),!0):!1},remove:function(e){var t=this.collection.getByNamespace(e);return n.isEmpty(t)?!1:(this.collection.remove(t),this._adjustActiveStates(),!0)},toggle:function(e,t,i){return i?this.add(e,t):this.remove(e)},_onAddItem:function(e){return this.addKeyboardAccess(e.get("view"))},_onRemoveItem:function(e){return this.removeKeyboardAccess(e.get("view"))},_adjustActiveStates:function(){var e,t;0!==this.collection.length&&(e=this.collection.first(),t=this.collection.rest(),e&&e.set("isActive",!0),this.get("allowMultipleActiveViews")||n.each(t,function(e){e.set("isActive",!1)},this))},_onItemActiveChange:function(e,t){return t?this.addKeyboardAccess(e.get("view")):this.removeKeyboardAccess(e.get("view"))}});e.exports=r},function(e,t,i){"use strict";var n=i(119),s=i(608),o=n.extend({model:s,getByNamespace:function(e){return this.filter(function(t){return this._isNamespaceMatch(e,t.get("namespace"))},this)},_isNamespaceMatch:function(e,t){return e===t?!0:0===t.indexOf(e+":")}});e.exports=o},function(e,t,i){"use strict";var n=i(114),s=n.extend({idAttribute:"namespace",defaults:{namespace:null,view:null,isActive:!0}});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(144),r=i(110),a=o.extend({name:"MessagingNotifier",defaults:{isEnabled:!1,notificationTimeout:5e3,notificationIcon:null},initialize:function(e){n.extend(this.attributes,n.pick(e,n.keys(this.defaults)))},notifyOnUnread:function(e,t){var i=s("New message for %1$s",t.get("name")),n={conversationId:e,channelUuid:t.get("uuid")};this._generateNotification(i,n)},_supportsNotifications:function(){return this.get("isEnabled")&&"Notification"in window},_needsNotificationPermission:function(){return this._supportsNotifications()&&"granted"!==window.Notification.permission&&"denied"!==window.Notification.permission},_isNotificationPermissionGranted:function(){return this._supportsNotifications()&&"granted"===window.Notification.permission},_requestPermission:function(e){window.Notification.requestPermission(e)},_generateNotification:function(e,t){var i,s;this._supportsNotifications()&&(s={icon:this.get("notificationIcon")},this._isNotificationPermissionGranted()?(i=new Notification(e,s),i instanceof Notification&&(i.addEventListener("click",n.bind(function(e){r.trigger("messaging:conversation:open:id",t.conversationId,t.channelUuid,"notification"),e.target.close()}),this),n.delay(n.bind(function(){this.close()},i),this.get("notificationTimeout")),this.trigger("notification:display",t.conversationId))):this._needsNotificationPermission()&&this._requestPermission(n.bind(function(i){this.trigger("notification:permission:change","granted"===i),this._generateNotification(e,t)},this)))}});e.exports=a},function(e,t,i){"use strict";var n,s=i(144),o=i(3),r=i(611),a=i(612),l=i(613),c=s.extend({name:"NotificationSoundManager",initialize:function(){var e=o.get(this.data,"sounds"),t=this._getSoundModels(e);this.collection=t instanceof r?t:new r(t)},playSoundName:function(e){var t=this.collection.get(e);if(!o.isEmpty(t)){var i=new l({model:t}).render();this.listenToOnce(i,"ended",this._removeSoundView),i.play()}},_removeSoundView:function(e){e.remove()},_getSoundModels:function(e){var t=o.map(e,function(e,t){return new a({name:t,filePath:e})});return t}}),u=function(){return null==n&&(n=new c),n};e.exports=u},function(e,t,i){"use strict";var n=i(119),s=i(612),o=n.extend({model:s});e.exports=o},function(e,t,i){"use strict";var n=i(114),s=n.extend({idAttribute:"name",defaults:{name:null,filePath:null,fileType:"audio/mpeg"}});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(614),r=s.extend({tagName:"audio",template:o,defaults:{filePath:null,fileType:null},events:{ended:"triggerRemove"},initialize:function(e){n.extend(this,n.pick(e,"model"))},getTemplateData:function(){return this.model.toJSON()},play:function(){this.el.play()},triggerRemove:function(){this.trigger("ended",this)}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<source src="'+(null==(__t=filePath)?"":_.escape(__t))+'" type="'+(null==(__t=fileType)?"":_.escape(__t))+'">';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=s.extend({renderWithTemplate:n.noop,initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"channels"))},afterRender:function(){this.listenTo(this.channels,"change:unread_messages_count_sum",this._onChangeChannelUnreadCount),this._onChangeChannelUnreadCount()},updateBadge:function(e){e>0&&this.$(".tab_notice_value").text(e>99?"99+":e),this.$(".tab_notice").toggleClass("tab-notice--active",e>0)},_onChangeChannelUnreadCount:function(){this.updateBadge(n.sum(this.channels.pluck("unread_messages_count_sum")))}});e.exports=o},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(144),r=i(269).FeatureHelpPopoverView,a=i(617),l=o.extend({name:"MessagingTutorial",initialize:function(e){e=s.extend({},e),s.extend(this.attributes,s.pick(e,s.keys(this.defaults))),s.extend(this,s.pick(e,"viewOptions")),this.viewOptions=s.extend({},this.viewOptions,{name:"messaging",template:"standard",className:"messaging-tutorial-popover",glass:!0,position:r.POSITION.BOTTOM,isFadeOnScroll:!1})},render:function(){var e;this.popover=this.createPopover(),this.confettiView=this.createConfetti(),e=n("<div />").addClass("messaging-tutorial-confetti"),e.append(this.confettiView.$el),this.popover.show(this.viewOptions),this.popover.getGlassElement().after(e),this.confettiView.render()},createConfetti:function(){var e=new a({autoParty:!0,amount:50});return e.$el.on("click",s.bind(this._onConfettiClick,this)),e},createPopover:function(){var e=new r;return this.listenTo(e,"dismiss",this._onPopoverDismiss),this.listenTo(e,"removed",this._onPopoverRemoved),e},setSeen:function(){n.ajax({url:"/svc/conversations/tutorial_seen",method:"POST",with_form_key:!0,dataType:"json"})},hideTutorial:function(){this.popover.hide()},_onConfettiClick:function(){this.popover.hide()},_onPopoverDismiss:function(){this.trigger("dismiss")},_onPopoverRemoved:function(){this.remove()},remove:function(){return this.confettiView&&this.confettiView.remove(),this.trigger("hide"),this.setSeen(),o.prototype.remove.apply(this,arguments)}});e.exports=l},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(149),r=i(110),a=o.extend({id:"milestone-confetti",tagName:"canvas",defaults:{amount:100,autoParty:!1,colors:["#D95E40","#F2992E","#56BC8A","#529ECC","#A77DC2","#748089"],size:40,speed:.5,onDone:n.noop},__resize:function(){this.$parent.length&&(this.el.width=this.$parent.width(),this.el.height=this.$parent.height())},_updateConfetti:function(e,t){this.confettiAngle+=.001,e.off||(e.tiltAngle+=e.tiltAngleIncrement,e.tilt=15*Math.sin(e.tiltAngle-t/3),e.y+=(Math.cos(this.confettiAngle+e.density)+.5*e.radius)*this.options.speed),e.y>this.el.height+20&&(this.isAnimating?(e.tilt=a.range(-10,10,!0),e.tileAngle=0,e.tiltAngleIncrement=a.range(.05,.1),e.x=Math.random()*this.el.width,e.y=-20):e.off||(e.off=!0,this.confettiOffscreen++))},_stopAnimating:function(){this.animationInterval&&(clearInterval(this.animationInterval),this.animationInterval=null),this.isAnimating=!1},_startAnimating:function(e){e=e||!1,this._stopAnimating(),this.animationInterval=setInterval(s.bind(this.draw,this),15),this.isAnimating=e?!0:this.isAnimating},initialize:function(e){this.options=s.extend({},this.defaults,e||{}),this.colors=this.options.colors,this.$win=n(window),this.$parent=n(),this.context=this.el.getContext("2d"),this.animationInterval=null,this.confetti=[],this.confettiAngle=0,this.confettiOffscreen=0,this.isAnimating=!1},render:function(){return s.defer(s.bind(this.setup,this)),this},setup:function(){this.$parent=this.$el.parent(),this.$parent.length&&(this.el.width=this.$parent.width(),this.el.height=this.$parent.height()),this.listenTo(r,"DOMEventor:flatresize",this.__resize);for(var e=this.options.size,t=.5*e,i=0,n=this.options.amount;n>i;i++)this.confetti.push({x:Math.random()*this.el.width,y:Math.random()*-this.el.height,radius:a.range(t,e),density:a.range(10,n),tilt:a.range(-10,10,!0),tiltAngle:0,tiltAngleIncrement:a.range(.05,.1),color:this.colors[a.range(0,this.colors.length-1,!0)],off:!1});this.options.autoParty&&this.party()},draw:function(){if(this.context.clearRect(0,0,this.el.width,this.el.height),this.confettiOffscreen===this.confetti.length)return void this.remove();for(var e=5,t=0;t<this.confetti.length;t++){var i=this.confetti[t];this.context.beginPath(),this.context.lineWidth=.5*i.radius,this.context.strokeStyle=i.color,this.context.moveTo(i.x+i.tilt+i.radius/e,i.y),this.context.lineTo(i.x+i.tilt,i.y+i.tilt+i.radius/e),this.context.stroke(),this._updateConfetti(i,t)}},party:function(){return this.confettiOffscreen=0,this._startAnimating(!0),this},stopPartying:function(){return this.isAnimating=!1,this},remove:function(){return this._stopAnimating(),this.options.onDone(),o.prototype.remove.call(this)}},{range:function(e,t,i){i=i||!1;var n=(t-e)*Math.random()+e;return i?Math.round(n):n}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(205),o=i(156),r=i(390),a=i(619),l=i(631),c=i(637),u=i(641),h=i(645),d=o.extend({className:"messaging-inbox",template:h,defaults:{isLoading:!1,isAutoFetch:!0,isEmpty:!1,isLoadingEmptyInboxFavorites:!1,numFavorites:5},mixins:[s],subviews:{headerView:{constructor:l,options:function(e){return{eventBus:e.eventBus,user:e.user,channels:e.channels,currentBlogModel:e.currentBlogModel,popoverContainer:e.popoverContainer}}},composeView:{constructor:c,options:function(e){return{eventBus:e.eventBus,favoritesCollection:e.favoritesCollection,currentBlogModel:e.currentBlogModel,keyboardManager:e.keyboardManager}}},conversationsView:{constructor:a,options:function(e){return{eventBus:e.eventBus,collection:e.collection,emptyInboxCollection:e.emptyInboxCollection,currentBlogModel:e.currentBlogModel,channels:e.channels,favoritesCollection:e.favoritesCollection,appendFavoritesToInboxLimit:e.appendFavoritesToInboxLimit}}},emptyView:{constructor:u,options:function(e){return{eventBus:e.eventBus,collection:e.emptyInboxCollection}}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","collection","user","channels","favoritesCollection","emptyInboxCollection","popoverContainer","currentBlogModel","appendFavoritesToInboxLimit","keyboardManager"))},afterRenderSubviews:function(){this.loader=new r({$container:this.$el,type:"bar",classModifiers:"top",loading:!1}),this.set({isLoading:!this.getCurrentChannel().get("isInboxFetched"),isEmpty:0===this.collection.length}),this.listenTo(this,"change",this._setViewStates),this.listenTo(this.collection,"sync error",this._onSyncCollection),this.listenTo(this.collection,"update reset",this._onChangeCollection),this.listenTo(this.collection,"request",this._onRequestCollection),this.listenTo(this.composeView,"submit",this._onComposeSubmitRecipient),this.listenTo(this.headerView,"change:isComposing",this._setViewStates),this._setViewStates(),this.get("isAutoFetch")&&this.fetch(),this._fetchEmptyInboxFavorites()},beforeRemove:function(){this.keyboardManager.remove("inbox")},getCurrentChannel:function(){return this.currentBlogModel.getChannel()},fetch:function(e){this.collection.fetchInbox(this.currentBlogModel.getId(),e)},_onComposeSubmitRecipient:function(e){this.eventBus.trigger(this.eventBus.CONVERSATION_OPEN_PARTICIPANT_NAMES,e)},_setViewStates:function(){var e=this.get("isEmpty"),t=this.get("isLoading")||this.get("isLoadingEmptyInboxFavorites"),i=this.headerView.get("isComposing");this.loader.set("loading",t&&!i),this.conversationsView.toggle(!i&&!e&&!t),this.emptyView.toggle(e&&!i&&!t),this.composeView.$el.toggle(i),i&&this.composeView.focus()},_onChangeCollection:function(){this.set("isEmpty",0===this.collection.length)},_onSyncCollection:function(){this.set({isLoading:!1,isEmpty:0===this.collection.length}),this.getCurrentChannel().set("isInboxFetched",!0)},_onRequestCollection:function(e,t,i){this.set({isEmpty:0===this.collection.length,isLoading:!this.getCurrentChannel().get("isInboxFetched")})},_fetchEmptyInboxFavorites:function(){this.set("isLoadingEmptyInboxFavorites",!0),this.emptyInboxCollection.fetchFavorites().then(n.bind(function(){this.rendered&&this.favoritesCollection.reset(n.take(this.emptyInboxCollection.toJSON(),this.get("numFavorites")))},this)).always(n.bind(function(){this.rendered&&this.set("isLoadingEmptyInboxFavorites",!1)},this))}});e.exports=d},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(156),r=i(620),a=i(205),l=i(258),c=i(621),u=i(624),h=i(625),d=i(630),p=o.extend({className:"inbox-conversations",template:d,mixins:[a,r],defaults:{isPaginating:!1,showFavorites:!1,hasNextPage:!0,showLoadingContainer:!0,appendFavoritesToInboxLimit:3},subviews:{conversations:{constructor:c,enableBatchRendering:!0,options:function(e){return{eventBus:e.eventBus,channels:e.channels,currentBlogModel:e.currentBlogModel}},collection:function(e){return e.collection}},paginationLoaderView:{constructor:l,options:{variation:"small h-centered",loading:!1}},favoritesView:{constructor:h,options:function(e){return{showMessageOnEmpty:!1,eventBus:e.eventBus,collection:e.favoritesCollection,title:s("More Tumblrs to talk to"),context:"inbox:moretumblrs"}}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","collection","channels","favoritesCollection","currentBlogModel"))},afterRenderSubviews:function(){this.scrollBar=new u({el:this.el}),this.listenTo(this,"change:isPaginating",this._onChangeIsPaginating),this.listenTo(this,"change:showFavorites",this._onChangeShowFavorites),this.listenTo(this,"change:hasNextPage",this._onChangeHasNextPage),this.listenTo(this,"change:showLoadingContainer",this._onChangeShowLoadingContainer),this.listenTo(this.collection,"sort",this._onCollectionSort),this.listenTo(this.collection,"update reset change",this._onCollectionChange),this.listenTo(this.favoritesCollection,"update reset",this._onFavoritesCollectionChange),this.listenTo(this.collection,"reset",this._onCollectionReset),this.listenTo(this,"batch:rendered:conversations",this._onConversationsBatchRendered),this.listenTo(this.collection,"sync",this._onCollectionSync),this.listenTo(this.collection,"change:hasNextPage",this._onChangeCollectionHasNextPage),this.listenTo(this.scrollBar,"scrollbottom",this._onScrollBottom),this._setViewStates(),this._onChangeCollectionHasNextPage(this.collection,this.collection.hasNextPage()),this._onChangeShowFavorites(this,this.get("showFavorites")),this._onChangeHasNextPage(this,this.get("hasNextPage")),this._onChangeShowLoadingContainer(this,this.get("showLoadingContainer")),n.defer(n.bind(this.updateScrollBar,this))},toggle:function(e){this.$el.toggle(e),this.updateScrollBar()},beforeRemove:function(){this.scrollBar&&this.scrollBar.destroy()},getNextPage:function(){this.rendered&&this.collection.hasNextPage()&&(this.set("isPaginating",!0),this.collection.fetchNextPage().always(n.bind(function(){this.rendered&&this.set("isPaginating",!1)},this)))},updateScrollBar:function(){this.scrollBar&&this.scrollBar.update()},_setViewStates:function(){var e=this.get("hasNextPage"),t=this.collection.length>0&&!e&&this.collection.length<=this.get("appendFavoritesToInboxLimit");this.set({showFavorites:t,showLoadingContainer:e}),this.updateScrollBar()},_saveModelOrder:function(){this.lastModelOrder=this._getModelOrderString()},_getModelOrderString:function(){return n.pluck(this.collection.models,"cid").join(" ")},_onCollectionSort:function(e){var t=this._getModelOrderString();this.lastModelOrder&&-1===t.indexOf(this.lastModelOrder)&&this.renderCollectionSubviews("conversations"),this._saveModelOrder()},_onCollectionChange:function(e,t){this._setViewStates(),this._saveModelOrder()},_onCollectionSync:function(){this._onChangeCollectionHasNextPage(this.collection,this.collection.hasNextPage())},_onCollectionReset:function(e){this.$el.scrollTop(0),this._saveModelOrder()},_onConversationsBatchRendered:function(){this.updateScrollBar()},_onChangeCollectionHasNextPage:function(e,t){this.set("hasNextPage",t&&e.length>=10)},_onChangeHasNextPage:function(e,t){this._setViewStates()},_onChangeIsPaginating:function(e,t){this.paginationLoaderView.set("loading",t)},_onScrollBottom:function(e){e&&this.getNextPage()},_onChangeShowFavorites:function(e,t){this.favoritesView.$el.toggle(t)},_onChangeShowLoadingContainer:function(e,t){this.js$("loader-container").toggle(t)},_onFavoritesCollectionChange:function(){this.updateScrollBar()}});e.exports=p},function(e,t,i){"use strict";var n=i(3),s=i(116),o=new s({defaults:{removeCollectionSubviews:function(e){var t=this[e];this.subviews[e]&&!n.isEmpty(t)&&(t=this[e],this._subviews=n.difference(this._subviews,t),n.invoke(t,"remove"),this[e].length=0)},removeCollectionSubview:function(e,t){var i,s=this[e];this.subviews[e]&&!n.isEmpty(s)&&(i=n.findWhere(s,{model:t}),i&&(this._subviews=n.without(this._subviews,i),i.remove(),this[e]=n.without(this[e],i)))},addNewCollectionSubview:function(e,t,i){var s=this.subviews[e];if(i||(i=this._getSubviewCollection(e)),s&&i){var o=s.container||this._createDefaultContainerFunction(e),r=s.prepareViewForAdd||this._createDefaultPrepareViewForAddFunction(e),a=s.options||{},l={insertionIndex:i.indexOf(t)},c=n.has(this,e),u=this.createCollectionSubviewRenderer([t],o,r,a,e,c,l);return this._isBatchRenderingInProgress(e)?void this.once("rendered:"+e,u,this):void(this.rendered?u():this.once("rendered",u,this))}},sortCollectionSubviews:function(e,t){var i,s=this.subviews[e];t||(t=this._getSubviewCollection(e)),s&&t&&this[e]&&(i=n.pluck(t.models,"cid"),i=n.zipObject(i,n.range(0,i.length)),this[e]=n.sortBy(this[e],function(e){return n.get(i,e.model.cid,0)}))},batchRenderCollectionSubviews:function(e){var t=this.subviews[e];if(t){var i=t.container||this._createDefaultContainerFunction(e),s=t.prepareView||this._createDefaultPrepareViewFunction(e),o=t.options||{},r=n.result(t,"batchSize")||5,a=n.result(t,"batchDelay")||100,l=this._getSubviewCollection(e),c=n.chunk(l.models,r),u=n.map(c,function(t,r){return n.bind(function(){var n=this.createCollectionSubviewRenderer(t,i,s,o,e,r>0);return n.call(this)},this)},this),h=n.bind(function(){this._scheduleBatchRenders(e,u,a)},this);this.rendered?h():this.once("rendered",h,this)}},_isBatchRenderingInProgress:function(e){return n.get(this._deferredRenders,e,[]).length>0},_scheduleBatchRenders:function(e,t,i){var s=t.length,o=function(){this._afterBatchRenderCollectionSubviews(e)},r=function(t){t.call(this,e),this._afterEachBatchRenderCollectionSubviews(e),s--,0===s&&o.call(this)};return this._deferredRenders||(this._deferredRenders={}),n.has(this._deferredRenders,e)||(this._deferredRenders[e]=[]),this._cancelBatchRenders(e),0===s?void o.call(this):void n.each(t,function(t,s){var o;return 0===s?void r.call(this,t):(o=setTimeout(n.bind(function(){r.call(this,t),this._deferredRenders[e]=n.without(this._deferredRenders[e],o)},this),i*(s+1)),void this._deferredRenders[e].push(o))},this)},_cancelBatchRenders:function(e){n.isEmpty(this._deferredRenders)||(n.isEmpty(e)||n.has(this._deferredRenders,e))&&(n.isEmpty(e)?(n.each(this._deferredRenders,function(e,t){n.each(e,function(e){clearTimeout(e)},this)},this),this._deferredRenders={}):(n.each(this._deferredRenders[e],function(e){clearTimeout(e)},this),this._deferredRenders[e].length=0))},_afterEachBatchRenderCollectionSubviews:function(e){this.trigger("batch:rendered:"+e)},_afterBatchRenderCollectionSubviews:function(e){this.trigger("rendered:"+e)},_attachCollectionListeners:function(e){var t=this._getSubviewCollection(e);t&&(this.listenTo(t,"add",n.partial(this.addNewCollectionSubview,e)),this.listenTo(t,"remove",n.partial(this.removeCollectionSubview,e)),this.listenTo(t,"reset",n.partial(this.renderCollectionSubviews,e)),this.listenTo(t,"update",n.partial(this.sortCollectionSubviews,e)))},_getSubviewCollection:function(e){var t=n.get(this.subviews[e],"collection");return t===!0?this.collection:n.isFunction(t)?t(this):t?t:null},_createDefaultPrepareViewForAddFunction:function(e){var t=this.subviews[e];return n.bind(function(i,s){var o=i.children(),r=new t.constructor(s),a=s.insertionIndex;return r.$el.attr("data-subview",e),n.isNumber(a)&&a<o.length?r.$el.insertBefore(o.get(a)):i.append(r.$el),r},this)}},before:{renderSubviews:function(){n.each(this.subviews,function(e,t){e.collection&&this._attachCollectionListeners(t)},this)},beforeRemove:function(){this._cancelBatchRenders()}},around:{renderCollectionSubviews:function(e,t){var i=this.subviews[t];if(i)return this.removeCollectionSubviews(t),n.result(i,"enableBatchRendering")===!0?this.batchRenderCollectionSubviews(t):e.apply(this,n.rest(arguments))}}});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(622),r=i(623),a=i(205),l=s.extend({className:"inbox-conversation",template:o,mixins:[a],defaults:{maxInitialMessageLength:100,currentMessage:null},events:{"click [data-open-conversation]":"_onClickConversation"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","channels","currentBlogModel")),this.participants=this.model.get("participants"),this.sortedParticipants=this.participants.getSortedByChannels(this._getOwnSortedBlogIds()),this.otherParticipant=n.first(this.sortedParticipants),this.set("currentMessage",this.model.getInboxMessage())},afterRender:function(){this.listenTo(this.model,"change:last_read_ts change:last_modified_ts",this._onChangeTimestamps),this.listenTo(this,"change:currentMessage",this._onChangeCurrentMessage),this._onChangeCurrentMessage(this,this.get("currentMessage"))},openConversation:function(){this.eventBus.trigger(this.eventBus.CONVERSATION_OPEN_CONVERSATION_MODEL,this.model,"inbox")},getTemplateData:function(){return{name:this.otherParticipant.get("name"),avatarUrl:this.otherParticipant.getAvatarUrl(),message:this._getMessageText(this.get("currentMessage")),additionalBlogName:this._getAdditionalBlogName(this.get("currentMessage"))}},getMessageParticipant:function(e){return this.participants.get(e.get("participant"))},_getMessageText:function(e){var t,i;return n.isEmpty(e)?"":(t=e.getMessage(),e.isPost()&&(i=e.get("post").getSentString(),t=n.compact([i,t]).join(" ")),n.isEmpty(t)?"":t.substring(0,this.get("maxInitialMessageLength")))},_safeTruncateMessage:function(e){var t=this.js$("message"),i=this.js$("message-text"),s=function(){r(t),n.isFunction(e)&&e.call(this,i.text())};t.height()?s.call(this):(this.$el.css("visibility","hidden"),n.defer(n.bind(function(){this.rendered&&(s.call(this),this.$el.css("visibility",""))},this)))},_isLastMessageFromSelf:function(e){return!n.isEmpty(e)&&!n.isEmpty(this.otherParticipant)&&this.otherParticipant.get("uuid")!==e.get("uuid")},_getAdditionalBlogName:function(e){var t;return n.isEmpty(e)?null:(t=this.getMessageParticipant(e),n.isEmpty(t)?null:this._isLastMessageFromSelf(t)?t.get("name"):void 0)},_onChangeTimestamps:function(e){this.set("currentMessage",this.model.getInboxMessage())},_onChangeCurrentMessage:function(e,t){var i=this.getMessageParticipant(t),s=t.get("truncatedText"),o=this._getAdditionalBlogName(t);this.js$("additional-blog-name").text(o).toggle(!n.isEmpty(o)),this.$el.toggleClass("is-unread",this.model.isUnread()&&!this._isLastMessageFromSelf(i)),n.isEmpty(s)?(this.js$("message-text").text(this._getMessageText(t)),this._safeTruncateMessage(function(e){t.set("truncatedText",e)})):this.js$("message-text").text(s)},_onClickConversation:function(e){e.preventDefault(),this.openConversation();
},_getOwnSortedBlogIds:function(){return this.channels.getSortedIds(this.currentBlogModel.getId())}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<a data-open-conversation href="#" class="inbox-row"><img class="avatar" src="'+(null==(__t=avatarUrl)?"":_.escape(__t))+'"><div class="info-container"><div class="name-container"><h3 class="name">'+(null==(__t=name)?"":_.escape(__t))+'</h3></div><h4 class="message" data-js-message><span class="additional-blog-name" data-js-additional-blog-name>'+(null==(__t=additionalBlogName)?"":_.escape(__t))+'</span><span class="text" data-js-message-text>'+(null==(__t=message)?"":_.escape(__t))+"</span></h4></div></a>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";function n(e,t){return e.scrollHeight-t.maxHeight<5}function s(e){return parseInt(c(e).css("max-height"),10)}function o(e,t,i){var s,o=e.nodeValue,r=l.get(t,"truncationString","..."),a="",c="",u=0,h=o.length;if(n(i,t))return!0;for(;h>=u;)s=u+h>>>1,a=l.trimRight(o.substring(0,s))+r,e.nodeValue=a,n(i,t)?(u=s+1,a.length>c.length&&(c=a)):h=s-1;return c.length>0?(e.nodeValue=c,!0):(e.nodeValue="",!1)}function r(e,t,i){var n=c(e).contents();l.each(n.get().reverse(),function(e){e.nodeType===Node.TEXT_NODE?o(e,t,i):r(e,t,i)})}function a(e,t){return t=t||{},l.defaults(t,{truncationString:"..."}),e instanceof c&&(e=e.get(0)),l.has(t,"maxHeight")||l.extend(t,{maxHeight:s(e)}),l.isFinite(l.get(t,"maxHeight"))&&!n(e,t)?r(e,t,e):void 0}var l=i(3),c=i(9);e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(385),o=s.extend({defaults:n.defaults({isDisabled:!1,isAtTop:!1,isAtBottom:!1,topThreshold:50,bottomThreshold:50},s.prototype.defaults),initialize:function(e){return this.options=e||{},s.prototype.initialize.call(this,this.options.el,this.options)},render:function(){return this.listenTo(this,"change:isAtTop",this._changeIsAtTop),this.listenTo(this,"change:isAtBottom",this._changeIsAtBottom),s.prototype.render.apply(this,arguments)},_stealScroll:function(e){return this.get("isDisabled")?(e.preventDefault(),void e.stopPropagation()):s.prototype._stealScroll.apply(this,arguments)},update:function(){return this._updateInfiniteScrollFlags(),s.prototype.update.apply(this,arguments)},_onScrollStop:function(){return this._updateInfiniteScrollFlags(),s.prototype._onScrollStop.apply(this,arguments)},getCurrentPositions:function(){return{height:this._currentHeight,scrollBottom:this._currentScrollBottom,scrollTop:this._currentScrollTop}},isAtTop:function(){return this.get("isAtTop")},isAtBottom:function(){return this.get("isAtBottom")},_isAtTop:function(e){return this._isUserScroll()&&!this.get("isDisabled")&&this._currentScrollTop<=e&&this._currentHeight>e},_isAtBottom:function(e){return this._isUserScroll()&&!this.get("isDisabled")&&this._currentScrollBottom<=e&&this._currentHeight>e},_isUserScroll:function(){var e,t=5;return n.isFinite(this._previousScrollHeight)?(e=Math.abs(this._currentScrollHeight-this._previousScrollHeight),t>=e):!1},setDisabled:function(e){this.set("isDisabled",e)},isDisabled:function(){return this.get("isDisabled")},_setCurrentPositions:function(){var e=this.container;this._previousScrollHeight=this._currentScrollHeight,this._currentScrollHeight=e.scrollHeight,this._currentHeight=e.clientHeight,this._currentScrollBottom=e.scrollHeight-e.scrollTop-this.container.clientHeight,this._currentScrollTop=e.scrollTop},_updateInfiniteScrollFlags:function(){return this.destroyed?!1:(this._setCurrentPositions(),void this.set({isAtTop:this._isAtTop(this.get("topThreshold")),isAtBottom:this._isAtBottom(this.get("bottomThreshold"))}))},_changeIsAtTop:function(e,t){this.trigger("scrolltop",t)},_changeIsAtBottom:function(e,t){this.trigger("scrollbottom",t)}});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(620),r=i(205),a=i(162),l=i(626),c=i(627),u=i(629),h=s.extend({className:"inbox-recipients",template:u,mixins:[r,a,o,l],keycommands:{"keydown:down":"_onKeyPressDown","keydown:up":"_onKeyPressUp","keydown:enter":"_onKeyPressEnter"},defaults:{isEmpty:!0,showMessageOnEmpty:!0,selectedView:null,context:"inbox:recipients"},subviews:{recipients:{constructor:c,options:function(e){return{eventBus:e.eventBus,onSelect:n.bind(e._onSubviewSelect,e),onClear:n.bind(e._onSubviewClear,e),context:e.context}},collection:function(e){return e.collection}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","collection","title","context")),this.keyboardViewName="recipients",this.disableKeys()},afterRender:function(){this.listenTo(this.collection,"reset update",this._onCollectionChange),this.listenTo(this.collection,"sync",this._onCollectionSync),this.listenTo(this.collection,"sort",this._onCollectionSort),this.listenTo(this,"change:isEmpty",this._onChangeIsEmpty),this.listenTo(this,"change:selectedView",this._onChangeSelectedView),this._onCollectionChange(this.collection),this._onChangeIsEmpty(this,this.get("isEmpty"))},getTemplateData:function(){return{title:this.title,noResultsText:this.collection.getNoResultsFoundMessage()}},toggle:function(e){this.$el.toggle(e),e&&this.deselect(this.keyboardViewName)},_onChangeSelectedView:function(e,t){var i=this.previous("selectedView");i&&i.setSelected(!1),t&&t.setSelected(!0)},_onChangeIsEmpty:function(e,t){this.get("showMessageOnEmpty")?this.js$("no-results-container").toggle(t):(this.js$("container").toggle(!t),this.js$("no-results-container").hide())},_shuffleNoResultsText:function(){this.js$("no-results-text").text(this.collection.getNoResultsFoundMessage())},_onCollectionSort:function(){this.renderCollectionSubviews("recipients")},_onCollectionChange:function(e){this.set("isEmpty",0===e.length),this.deselect(this.keyboardViewName)},_onCollectionSync:function(e){0===e.length&&this.get("showMessageOnEmpty")&&this._shuffleNoResultsText()},_onSubviewSelect:function(e){this.set("selectedView",e),this.setSelectedIndex(this.keyboardViewName,n.indexOf(this.recipients,e))},_onSubviewClear:function(e){this.set("selectedView",null),this.deselect(this.keyboardViewName)},_onKeyPressDown:function(e){var t;e.preventDefault(),t=this.isLastSelected(this.keyboardViewName)?this.selectFirst(this.keyboardViewName):this.selectNext(this.keyboardViewName),this.set("selectedView",t)},_onKeyPressUp:function(e){var t;e.preventDefault(),t=this.isFirstSelected(this.keyboardViewName)?this.selectLast(this.keyboardViewName):this.selectPrevious(this.keyboardViewName),this.set("selectedView",t)},_onKeyPressEnter:function(e){var t,i=this.get("selectedView");e.preventDefault(),i?t=i.model:1===this.collection.length&&(t=this.collection.first()),t&&this.eventBus.trigger(this.eventBus.CONVERSATION_OPEN_PARTICIPANT_MODELS,[t],this.context)}});e.exports=h},function(e,t,i){"use strict";var n=i(3),s=i(116),o=new s({defaults:{hasSelection:function(e){return this._validateParams(e)?n.has(this._selectedIndexes,e):null},getSelectedIndex:function(e){return this._validateParams(e)?n.get(this._selectedIndexes,e,0):null},deselect:function(e){this._validateParams(e)&&this.hasSelection(e)&&delete this._selectedIndexes[e]},resetSelected:function(e){this._validateParams(e)&&this.setSelectedIndex(e,0)},setSelectedIndex:function(e,t){var i;return this._validateParams(e)?(i=n.get(this,e,[]),t=Math.max(0,Math.min(t,i.length-1)),n.set(this._selectedIndexes,e,t),t):null},getSelectedView:function(e){var t;return this._validateParams(e)?(t=n.get(this,e,[]),n.get(t,this.getSelectedIndex(e))):null},isFirstSelected:function(e){return this._validateParams(e)?0===this.getSelectedIndex(e):null},isLastSelected:function(e){var t;return this._validateParams(e)?(t=n.get(this,e,[]),this.getSelectedIndex(e)===t.length-1):null},selectFirst:function(e){var t;if(!this._validateParams(e))return null;t=n.get(this,e,[]);var i=this.setSelectedIndex(e,0);return n.get(t,i)},selectLast:function(e){var t;if(!this._validateParams(e))return null;t=n.get(this,e,[]);var i=this.setSelectedIndex(e,t.length-1);return n.get(t,i)},selectNext:function(e){var t,i;return this._validateParams(e)?this.hasSelection(e)?(t=n.get(this,e,[]),i=this._increaseSelectedIndex(e),n.get(t,i)):this.selectFirst(e):null},selectPrevious:function(e){var t,i;return this._validateParams(e)?(t=n.get(this,e,[]),i=this._decreaseSelectedIndex(e),n.get(t,i)):null},_validateParams:function(e){return!!e},_increaseSelectedIndex:function(e){return this._validateParams(e)?this.setSelectedIndex(e,this.getSelectedIndex(e)+1):null},_decreaseSelectedIndex:function(e){return this._validateParams(e)?this.setSelectedIndex(e,this.getSelectedIndex(e)-1):null}},before:{initialize:function(){this._selectedIndexes={}}}});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(628),r=s.extend({className:"inbox-recipient",template:o,defaults:{isSelected:!1,context:"inbox:recipients"},events:{"click [data-start-conversation]":"_onStartConversationClick",mouseenter:"_onRecipientHover",mouseleave:"_onRecipientLeave"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","onSelect","onClear","context"))},afterRender:function(){this.listenTo(this,"change:isSelected",this._onChangeIsSelected)},setSelected:function(e){this.rendered&&this.set("isSelected",e)},getTemplateData:function(){return{name:this.model.get("name"),title:this.model.get("title"),avatarUrl:this.model.getAvatarUrl()}},_onStartConversationClick:function(e){e.preventDefault(),this.eventBus.trigger(this.eventBus.CONVERSATION_OPEN_PARTICIPANT_MODELS,[this.model],this.get("context"))},_onChangeIsSelected:function(e,t){this.$el.toggleClass("selected",t)},_onRecipientHover:function(){n.isFunction(this.onSelect)&&this.onSelect(this,this.model)},_onRecipientLeave:function(){n.isFunction(this.onClear)&&this.onClear(this,this.model)}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<a data-start-conversation href="/conversation/new/'+(null==(__t=name)?"":_.escape(__t))+'" class="inbox-row"><img class="avatar" src="'+(null==(__t=avatarUrl)?"":_.escape(__t))+'"><div class="info-container"><h3>'+(null==(__t=name)?"":_.escape(__t))+"</h3><h4>"+(null==(__t=title)?"":_.escape(__t))+"</h4></div></a>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="<div data-js-container> ",title&&(__p+=" <h2>"+(null==(__t=title)?"":_.escape(__t))+"</h2> "),__p+=' <div data-subview="recipients[]"></div><div data-js-no-results-container class="no-results"><p data-js-no-results-text>'+(null==(__t=noResultsText)?"":_.escape(__t))+"</p></div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-js-conversations-container><div data-subview="conversations[]"></div><div data-subview="favoritesView"></div></div><div class="inbox-pagination-loader" data-js-loader-container><div data-subview="paginationLoaderView"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(632),r=i(634),a=i(636),l=s.extend({className:"inbox-header",template:a,defaults:{isComposing:!1},subviews:{senderView:{constructor:o,options:function(e){return{eventBus:e.eventBus,user:e.user,channels:e.channels,popoverContainer:e.popoverContainer,currentBlogModel:e.currentBlogModel}}},composeToggleView:{constructor:r,options:function(e){return{eventBus:e.eventBus}}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","user","channels","popoverContainer","currentBlogModel"))},afterRenderSubviews:function(){this.listenTo(this.composeToggleView,"change:isComposing",function(e,t){this.set("isComposing",t)}),this.listenTo(this,"change:isComposing",function(e,t){this.composeToggleView.set("isComposing",t)})}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(554),r=i(633),a=s.extend({className:"inbox-sender",template:r,subviews:{blogSelector:{constructor:o,options:function(e){return{className:"inbox-sender-blog-selector",collection:e.channels,popoverOptions:{popoverContainer:e.popoverContainer},currentTumblelog:e.channels.findWhere({uuid:e.currentBlogModel.getId()}),badgeCountField:"unread_messages_count_sum"}}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","user","channels","currentBlogModel","popoverContainer"))},afterRenderSubviews:function(){this.listenTo(this.blogSelector,"change:currentTumblelog",this._onBlogSelectorChange)},_onBlogSelectorChange:function(e,t){this.currentBlogModel.setChannel(t)}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="blogSelector" class="blog-selector"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(635),r=s.extend({className:"inbox-compose-toggle",template:o,defaults:{isComposing:!1},events:{"click [data-js-compose-toggle]":"_onClickToggleCompose"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus"))},afterRender:function(){this.listenTo(this,"change:isComposing",this._onChangeIsComposing)},_onChangeIsComposing:function(e,t){this.$el.toggleClass("active",t)},_onClickToggleCompose:function(e){e.preventDefault(),this.set("isComposing",!this.get("isComposing"))}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<a href="#" class="compose-toggle compose-start" data-js-compose-toggle>'+(null==(__t=__("Compose message"))?"":_.escape(__t))+'</a><a href="#" class="compose-toggle compose-cancel" data-js-compose-toggle>'+(null==(__t=__("Nevermind"))?"":_.escape(__t))+"</a>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="senderView"></div><div data-subview="composeToggleView"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(101),r=i(156),a=i(205),l=i(638),c=i(625),u=i(390),h=i(640),d=r.extend({className:"inbox-compose",template:h,defaults:{isShowFavorites:!0,isLoading:!1,showLoadingAfterMs:250,hasEditorFocus:!1},events:{"input [data-js-textinput]":"_onTextInputChange","focus [data-js-textinput]":"_onTextInputFocus","blur [data-js-textinput]":"_onTextInputBlur"},mixins:[a],subviews:{favoritesView:{constructor:c,options:function(e){return{showMessageOnEmpty:!1,eventBus:e.eventBus,collection:e.favoritesCollection,title:o("Favorites"),context:"inbox:favorites"}}},searchResultView:{constructor:c,options:function(e){return{eventBus:e.eventBus,collection:e.collection,context:"inbox:typeahead"}}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","favoritesCollection","currentBlogModel","keyboardManager")),this.collection=new l,this._debouncedSearch=n.bind(n.debounce(this._search,250),this)},afterRenderSubviews:function(){this.loader=new u({$container:this.$el,type:"bar",classModifiers:"top",loading:!1}),this.listenTo(this,"change:isShowFavorites",this._onChangeIsShowFavorites),this.listenTo(this,"change:isLoading",this._onChangeIsLoading),this.listenTo(this,"change:hasEditorFocus",this._onChangeHasEditorFocus),this._onChangeIsShowFavorites(this,this.get("isShowFavorites"))},_setKeyboardState:function(){this.keyboardManager.remove("inbox:compose"),this.get("hasEditorFocus")&&(this.get("isShowFavorites")?this.keyboardManager.add("inbox:compose:favorites",this.favoritesView):this.keyboardManager.add("inbox:compose:results",this.searchResultView))},_onChangeHasEditorFocus:function(e,t){this._setKeyboardState()},fetchResults:function(e){var t=this.currentBlogModel.getChannel().get("uuid");return this.set("isLoading",!0),this.collection.fetchByQuery(e,t).always(n.bind(function(){this.rendered&&this.set({isShowFavorites:!1,isLoading:!1})},this))},clear:function(){this.js$("textinput").val("")},focus:function(){this.js$("textinput").focus()},blur:function(){this.js$("textinput").blur()},beforeRemove:function(){this.keyboardManager.remove("inbox:compose")},_search:function(e){n.isEmpty(e)?this.set("isShowFavorites",!0):this.fetchResults(e)},_onTextInputChange:function(e){this._debouncedSearch(s(e.target).val())},_onTextInputBlur:function(e){this.set("hasEditorFocus",!1)},_onTextInputFocus:function(e){this.set("hasEditorFocus",!0)},_onChangeIsShowFavorites:function(e,t){this.favoritesView.toggle(t),this.searchResultView.toggle(!t),this._setKeyboardState()},_onChangeIsLoading:function(e,t){return this._loaderTimeout&&(clearTimeout(this._loaderTimeout),this._loaderTimeout=null),t?void(this._loaderTimeout=setTimeout(n.bind(function(){this.loader.set("loading",!0)},this),this.get("showLoadingAfterMs"))):this.loader.set("loading",!1)}});e.exports=d},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(101),r=i(119),a=i(603),l=i(639),c=r.extend({url:"/svc/conversations/participant_suggestions",model:a,resultCache:{},initialize:function(){return this.getNoResultsFoundMessage=l([o("That isn't anyone."),o("Uh, who?"),o("Huh what?"),o("Never heard of 'em."),o("???"),o("Eh?"),o("Whaaa?")]),r.prototype.initialize.apply(this,arguments)},parse:function(e,t){return s.get(e,"response.blogs")||e},fetchByQuery:function(e,t,i){return i=i||{},s.extend(i,{reset:!0,data:{q:e,participant:t}}),this.fetch(i)},fetchFavorites:function(e,t,i,n){return e=e||8,n=n||{},s.extend(n,{reset:!0,data:{limit:e,participant:t,include_recent:i}}),this.fetch(n)},fetch:function(e){var t=JSON.stringify(s.get(e,"data")),i=new n.Deferred,o=s.get(this.resultCache,t);return this.cancelFetch(),o?(this.reset(o),this.trigger("sync",this),i.resolve(),i):(this._request=r.prototype.fetch.apply(this,arguments),this._request.then(s.bind(function(e){s.set(this.resultCache,t,this.parse(e))},this)).always(s.bind(function(){this._request=null},this)),this._request)},cancelFetch:function(){this._request&&(this._request.abort(),this._request=null)}});e.exports=c},function(e,t,i){"use strict";function n(e){var t,i;return e=e||[],function(){return s.isEmpty(t)&&(t=s.shuffle(e),s.isEmpty(i)||(t=s.without(t,i))),i=t.pop()}}var s=i(3);e.exports=n},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="inbox-compose-input"><label class="label"><span class="label-text-container"> '+(null==(__t=__("To:"))?"":_.escape(__t))+' </span><span class="input-container"><input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="input" data-js-textinput></span></label></div><div class="inbox-compose-main"><div data-subview="loader"></div><div data-subview="favoritesView"></div><div data-subview="searchResultView"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(205),r=i(156),a=i(642),l=i(644),c=r.extend({className:"inbox-empty",template:l,mixins:[o],subviews:{blogsView:{constructor:a,options:function(e){return{collection:e.collection,eventBus:e.eventBus}}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","collection"))},getTemplateData:function(){return{header:s("Talk to a Tumblr")}},toggle:function(e){this.$el.toggle(e)}});e.exports=c},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(156),r=i(643),a=o.extend({className:"inbox-empty-blogs",template:r,defaults:{numItemsPerRow:4},events:{"click [data-js-start-conversation]":"_onStartConversation"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","collection"))},afterRender:function(){this.listenTo(this.collection,"update reset",this.render)},getTemplateData:function(){var e,t=this.get("numItemsPerRow"),i=n.map(this.collection.models,function(e){return n.extend(e.toJSON(),{avatarUrl:e.getAvatarUrl()})});return i.length>0&&(e=Math.max(1,Math.floor(i.length/t)),i=i.slice(0,e*t)),{blogs:i}},_onStartConversation:function(e){var t=s(e.currentTarget).attr("data-js-start-conversation"),i=this.collection.findWhere({name:t});this.eventBus.trigger(this.eventBus.CONVERSATION_OPEN_PARTICIPANT_MODELS,[i],"inbox:empty"),e.preventDefault()}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="",_.isEmpty(blogs)||(__p+=' <div class="blogs"> ',_.each(blogs,function(e){__p+=' <a class="blog" href="/messaging/conversation/'+(null==(__t=e.name)?"":_.escape(__t))+'" data-js-start-conversation="'+(null==(__t=e.name)?"":_.escape(__t))+'"><img class="avatar" src="'+(null==(__t=e.avatarUrl)?"":_.escape(__t))+'" alt="'+(null==(__t=e.name)?"":_.escape(__t))+'" title="'+(null==(__t=e.name)?"":_.escape(__t))+'" width="40" height="40"> </a> '}),__p+=" </div> "),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="content"><div class="header-container"><h2 class="header" data-js-header>'+(null==(__t=header)?"":_.escape(__t))+'</h2></div><div data-subview="blogsView"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="headerView"></div><div data-subview="composeView"></div><div class="inbox-main"><div data-subview="loader"></div><div data-subview="conversationsView"></div></div><div data-subview="emptyView"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(165),r=i(101),a=i(156),l=i(258),c=i(205),u=i(150).animation,h=i(647),d=i(649),p=i(665),g=i(667),m=i(671),f=i(674),v=i(676),_=i(678),b=i(594),w=i(679),y=i(682),k=i(653).html,x=i(639),C=i(684),S=i(689),E=i(691),T=a.extend({template:E,className:"messaging-conversation-wrapper",defaults:{isError:!1,canSend:!0,isPossibleSpam:!1,isLoading:!0,isHidePendingPost:!1,isFetching:!0,isFetched:!1,isFetchingIcebreakers:!1,isOffline:!1,isAutoFetch:!0,isMinimized:!1,isMinimizeEnabled:!1,isSoundsEnabled:!1,isIcebreakersEnabled:!1,isGifSearchEnabled:!1,isSendPhotosEnabled:!1,animateInMessageDuration:500,minimizeOpeningClass:"is-minimize-opening",minimizeClosingClass:"is-minimize-closing"},events:{"click [data-js-tumblelog-name]":"_onBlogClick","click [data-js-main]":"_onMainContainerClick",keydown:"_onKeyDown"},mixins:[c],subviews:{conversationLoaderView:{constructor:l,options:{variation:"small centered",loading:!1}},headerView:{constructor:h,options:function(e){return{eventBus:e.eventBus,participants:e.sortedParticipants,theme:e.theme,channels:e.channels,user:e.user,isMinimizeEnabled:e.isMinimizeEnabled()}}},messagesView:{constructor:d,options:function(e){return{eventBus:e.eventBus,collection:e.model.get("messages"),participants:e.model.get("participants"),messageFormatter:e.messageFormatter,animateInMessage:n.bind(e._animateInMessage,e)}}},previewView:{constructor:g},composeView:{constructor:m,options:function(e){return{eventBus:e.eventBus,keyboardManager:e.keyboardManager,keyboardNamespace:e.keyboardNamespace+":compose",pluginsArray:e.getPluginsArray()}}},minimizedView:{constructor:f,options:function(e){return{eventBus:e.eventBus,participant:e.otherParticipant,model:e.model}}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","user","model","channels","messageFormatter","popoverContainer","keyboardManager","isVerifiedEmail","collection")),this.keyboardNamespace="conversation:"+this.cid,this.model||(this.model=new b),this.messageFormatter||(this.messageFormatter=new k),this.conversation=this.model,this.sortedParticipants=this._getSortedParticipantsCopy(),this.otherParticipant=this.conversation.getOtherParticipant(),this.getGenericErrorMessage=x([r("Something went screwy."),r("Something's busted."),r("Something got snagged."),r("Something's acting up."),r("Something sucks!"),r("Internet is being dumb."),r("Computer weirdness."),r("The server is being foolish."),r("Something fizzled."),r("The internet evaporated."),r("The internet is being wiggly."),r("Something went splat."),r("Server turned to dust."),r("Something's wonky."),r("Something's not happening."),r("Something's not working."),r("Something got messed up."),r("Unknown, totally annoying error."),r("A nameless error mysteriously occurred."),r("Our computer is a loser."),r("Something pooped out."),r("Something fell into a volcano."),r("Something is all gummed up."),r("Something melted.")]),this.permanentPostErrorMessage=r("Can't send this post."),this.getRetryPostErrorMessage=x([r("Hrm. Post didn't send."),r("Blegh. Post didn't send."),r("Fffft. Post didn't send."),r("Welp. Post didn't send."),r("Sending machine broke.")]),this.customErrorMessages={409:r("You can only send messages to Tumblrs you follow."),428:r("Sorry, %1$s only allows messages from Tumblrs they follow.",this.otherParticipant.get("name")),429:r("You've hit the daily limit on new conversations. Impressive.")},this.getSpamErrorMessage=x([r("Look sketchy?"),r("Look suspicious?"),r("Look fishy?"),r("Look shady?"),r("Seem fake?"),r("Is this spam?")]),this.easeOutExpo=[.19,1,.22,1]},afterRenderSubviews:function(){this.listenTo(this,"change:isError change:isLoading",this._setOpenViewStates),this.listenTo(this,"change:isHidePendingPost change:isFetching change:isError change:isFetchingIcebreakers",this._setLoadingState),this.listenTo(this,"change:isOffline",this._onChangeIsOffline),this.listenTo(this,"change:canSend",this._onChangeCanSend),this.listenTo(this,"change:isPossibleSpam",this._onChangeIsPossibleSpam),this.listenTo(this,"change:isMinimized",this._onChangeIsMinimized),this.listenTo(this.composeView,"submit",this._onComposeSubmit),this.listenTo(this.composeView,"resize",this._onComposeResize),this.listenTo(this.composeView,"input",this._onComposeInput),this.listenTo(this.composeView,"focus",this._onComposeFocus),this.listenTo(this.composeView,"blur",this._onComposeBlur),this.listenTo(this.composeView,"plugin:preview:add:image",this._onComposeViewPluginPreviewAddImage),this.listenTo(this.composeView,"plugin:click",this._onComposeViewPluginClick),this.listenTo(this.headerView,"closeClick",this._onTriggeredClose),this.listenTo(this.headerView,"minimizeClick",this._onHeaderMinimizeClick),this.listenTo(this.headerView,"moreActionsClick",this._onHeaderMoreActions),this.listenTo(this.conversation,"change:id",this._onChangeId),this.listenTo(this.conversation,"change:unreadCount",this._onChangeUnreadCount),this.listenTo(this.conversation,"change:can_send",this._onChangeConversationCanSend),this.listenTo(this.conversation,"change:is_possible_spam",this._onChangeConversationIsPossibleSpam),this.listenTo(this.conversation.get("messages"),"change:hasNextPage",this._onChangeMessagesHasNextPage),this.listenTo(this.messagesView,"pillClick",this._onPillClick),this.listenTo(this.messagesView,"messageRetryClick",this._onMessageRetryClick),this.listenTo(this.composeView,"close",this._onTriggeredClose),this.listenTo(this.minimizedView,"click",this._onMinimizedViewClick),this.listenTo(this.previewView,"close",this._onPreviewViewClose),this.listenTo(this.previewView,"dismiss",this._onPreviewViewDismiss),this.listenTo(this.previewView,"edit",this._onPreviewViewEdit),this._setLoadingState(),this._setMainViewStates(),this._setOpenViewStates(),this._onChangeConversationCanSend(this.conversation,this.conversation.get("can_send")),this._onChangeCanSend(this,this.get("canSend")),this._onChangeConversationIsPossibleSpam(this.conversation,this.conversation.get("is_possible_spam")),this._onChangeIsPossibleSpam(this,this.get("isPossibleSpam")),this.get("isAutoFetch")&&this.fetch(),this.mainTheme=this._applyTheme(this.el),this.isMinimizeEnabled()||(this.minimizedView.remove(),this.js$("conversation-minimized").remove()),this.isVerifiedEmail||this._showError({message:r("Please verify your email address before talking to a Tumblr."),showButton:!1})},beforeRemove:function(){this.conversation.get("messages").reset(this.conversation.getInboxMessage()),this.keyboardManager.remove(this.keyboardNamespace),this.trigger("close")},fetch:function(e){var t;return this.isVerifiedEmail?(e=e||{},n.extend(e,{error:n.bind(this._onFetchConversationFail,this)}),this.set("isFetching",!0),this.eventBus.trigger(this.eventBus.CONVERSATION_FETCHING,this.conversation),this.conversation.fetchConversation(e).then(n.bind(this._onFetchConversationSuccess,this)).always(n.bind(this._onFetchConversationAlways,this))):(t=new s.Deferred,t.reject(),t)},poll:function(e,t){var i;return this.isVerifiedEmail?(e=e||{},this.eventBus.trigger(this.eventBus.CONVERSATION_FETCHING,this.conversation),this.conversation.poll(e,t).then(n.bind(function(){this.messagesView.scrollToBottom()},this))):(i=new s.Deferred,i.reject(),i)},refresh:function(e){this.conversation.appendToMessageQueue(e.getMessageQueue()),this._flushMessageQueue(),this.unminimize(),this.focus()},focus:function(){return this.isMinimized()?this.focusMinimized():this.focusCompose(),this},isSoundsEnabled:function(){return this.get("isSoundsEnabled")},isGifSearchEnabled:function(){return this.get("isGifSearchEnabled")},isSendPhotosEnabled:function(){return this.get("isSendPhotosEnabled")},getPluginsArray:function(){var e=[];return this.isGifSearchEnabled()&&e.push(new C({collection:this.collection})),this.isSendPhotosEnabled()&&e.push(new S),e},isMinimizeEnabled:function(){return this.get("isMinimizeEnabled")},isMinimized:function(){return this.get("isMinimized")},focusMinimized:function(){this.minimizedView&&this.minimizedView.focus()},focusCompose:function(){this.composeView&&this.composeView.focus()},toggleMinimize:function(e,t){var i,s=this.get("minimizeOpeningClass"),o=this.get("minimizeClosingClass"),r=this.js$("conversation-open"),a=this.js$("conversation-minimized");this.isMinimizeEnabled()&&e!==this.isMinimized()&&(i=function(){this.set("isMinimized",e)},
t?i.call(this):e?this._addAnimationClass(r,o).then(n.bind(function(){i.call(this),this._addAnimationClass(a,s)},this)):this._addAnimationClass(a,o).then(n.bind(function(){i.call(this),this._addAnimationClass(r,s)},this)),e||this.get("isFetched")||this.fetch())},minimize:function(e){this.toggleMinimize(!0,e)},unminimize:function(e){this.toggleMinimize(!1,e)},_showError:function(e){var t,i;return this.conversationErrorView&&this.conversationErrorView.remove(),i=this.js$("main"),t=new v(e),i.append(t.render().$el),this.conversationErrorView=t,this.set({isError:!0,isOffline:!0}),this._applyTheme(t.el),t},_hideError:function(){this.conversationErrorView&&(this.conversationErrorView.remove(),this.conversationErrorView=null),this.set({isError:!1,isOffline:!1}),this.focus()},_onFetchConversationSuccess:function(){this._flushMessageQueue(),this.rendered&&(this.set("isFetched",!0),this._hideError(),this.conversation.markAsRead(),this.otherParticipant=this.conversation.getOtherParticipant(),this.conversation.get("messages").hasNextPage()||(this.set("isFetchingIcebreakers",!0),this._createIcebreakersView().always(n.bind(function(){this.set("isFetchingIcebreakers",!1),this.focus()},this))))},_flushMessageQueue:function(){var e;return this.conversation.hasQueuedMessages()&&this.isVerifiedEmail?this.conversation.flushMessageQueue().progress(n.bind(this._onFlushProgress,this)).fail(n.bind(this._onFlushFail,this)).always(n.bind(this._onFlushAlways,this)):(e=new s.Deferred,e.reject(),e)},_onFlushProgress:function(e,t){this.rendered&&this.set("isHidePendingPost",!t&&!this._canRenderPendingMessage(e)),t?this.eventBus.trigger(this.eventBus.CONVERSATION_MESSAGE_SENT,e,this.conversation):this.eventBus.trigger(this.eventBus.CONVERSATION_MESSAGE_SENDING)},_onFlushFail:function(e){this.eventBus.trigger(this.eventBus.CONVERSATION_MESSAGE_FAILED,e,this.conversation),this.rendered&&e.isPost()&&(this.conversation.get("messages").remove(e),this._showPostSendingError(e))},_onFlushAlways:function(){this.rendered&&(this.set("isHidePendingPost",!1),this.focus())},_onFetchConversationFail:function(e,t){var i,s=t.status;this.rendered&&(i=n.get(this.customErrorMessages,s,this.getGenericErrorMessage()),this._showError({message:i,buttonCallback:n.bind(this._onConversationErrorRetryClick,this),showButton:e.canRetryFetch(n.get(t,"status"))}))},_showPostSendingError:function(e){var t,i,s;this.rendered&&(e.canRetry()?(t=this.getRetryPostErrorMessage(),s=this._onPostSendingErrorRetryClick):(t=this.permanentPostErrorMessage,i=r("Close"),s=this._onPostSendingErrorCloseClick),this._showError({message:t,buttonCallback:n.bind(s,this),buttonText:i}))},_onPostSendingErrorCloseClick:function(){this._hideError()},_onPostSendingErrorRetryClick:function(){this._flushMessageQueue().progress(n.bind(function(e){e.isPost()&&!e.isError()&&this._hideError()},this))},_onFetchConversationAlways:function(){this.rendered&&this.set("isFetching",!1)},_onComposeSubmit:function(e,t){var i,s,o=this.previewView.getMessage();n.isEmpty(o)?(i=b.createTextMessage(e,{hasAnimation:!0,creationUserAction:t}),this._sendMessage(i,{isSendingMessage:!0})):this.previewView.close().then(n.bind(function(){n.delay(n.bind(function(){this.rendered&&(s=this._createPreviewMessages(e,o),n.each(s,function(e){e.set("creationUserAction",t)}),this.conversation.appendToMessageQueue(s),this._flushMessageQueue())},this),150)},this))},_createPreviewMessages:function(e,t){var i,s=[];return t.set("isFromPreview",!0),s.push(t),n.isEmpty(e)||(i=b.createTextMessage(e),i.set("context",t.get("context")),s.push(i),t.isPost()&&t.set("postHasTextMessage",!0)),this._canRenderPendingMessage(t)&&(t.set("hasAnimation",!0),n.isEmpty(i)||i.set("hasAnimation",!0)),s},_canRenderPendingMessage:function(e){return n.isEmpty(e)?!1:e.isPost()?e.getPost().hasThumbnail():!0},_sendMessage:function(e,t){var i;return this.isVerifiedEmail?(this.eventBus.trigger(this.eventBus.CONVERSATION_MESSAGE_SENDING),this.set("isPossibleSpam",!1),this.conversation.sendMessage(e,t).then(n.bind(function(){this.eventBus.trigger(this.eventBus.CONVERSATION_MESSAGE_SENT,e,this.conversation)},this)).fail(n.bind(function(){this.eventBus.trigger(this.eventBus.CONVERSATION_MESSAGE_FAILED,e,this.conversation)},this)).always(n.bind(function(){!this.rendered},this))):(i=new s.Deferred,i.reject(),i)},_resendMessage:function(e){var t=this.conversation.get("messages"),i={isResendingMessage:!0};this._sendMessage(e,i).then(n.bind(function(){t.last()!==e&&(t.remove(e),e.updateClientTimestamp(),t.add(e,i))},this))},_onComposeResize:function(){this.messagesView.updateScrollBar()},_onComposeInput:function(e,t){this.trigger("compose:input",e,t),this.eventBus.trigger(this.eventBus.CONVERSATION_MESSAGE_INPUT,this.conversation,e)},_onComposeFocus:function(e){this.trigger("compose:focus",e)},_onComposeBlur:function(e){this.trigger("compose:blur",e)},_onChangeId:function(e){e.isNew()||this.trigger("created",e)},_onChangeUnreadCount:function(e,t){0===t||this.isMinimized()||(this.messagesView.isAtBottom()?this._fetchUnreadMessages().then(n.bind(function(){this.eventBus.trigger(this.eventBus.CONVERSATION_MESSAGES_UNREAD_FETCHED)},this)):this.messagesView.showPill(t).then(n.bind(this._fetchUnreadMessages,this))["catch"](n.noop))},_fetchUnreadMessages:function(){var e=this.conversation.get("unreadCount"),t=Math.min(10,e+5);return 0!==e?(this.conversation.markAsRead(),this.poll(null,t)):void 0},_getSortedParticipantsCopy:function(){var e=this.conversation.get("participants"),t=this.channels.getSortedIds(this.conversation.get("participantUuid")),i=e.getSortedByChannels(t,!0);return new e.constructor(i)},_setLoadingState:function(){var e=this.get("isFetching")||this.get("isHidePendingPost")||this.get("isFetchingIcebreakers");this.set("isLoading",!this.get("isError")&&e)},_setMainViewStates:function(){var e=this.get("isMinimized"),t=this.js$("conversation-open"),i=this.js$("conversation-minimized");t.toggle(!e),i.toggle(e),e?i.css("display",""):t.css("display","")},_setOpenViewStates:function(){var e=this.get("isError"),t=this.get("isLoading");this.messagesView.toggle(!e&&!t),this.composeView.set("isDisabled",e||t),this.conversationLoaderView.set("loading",t)},_createIcebreakersView:function(){var e;return this.icebreakersView||!this.get("isIcebreakersEnabled")?(e=new s.Deferred,e.reject(),e):this.otherParticipant.fetchAdditionalInfo(this.conversation.getParticipantId()).then(n.bind(function(){var e;this.rendered&&(e=this.conversation.isNew(),this.icebreakersView=new y({participant:this.otherParticipant,isShowTags:e,isShowRelationship:!e,isShowDescription:!e}),this.messagesView.addHeaderView(this.icebreakersView))},this))},_onTriggeredClose:function(){this.trigger("close")},_onHeaderMoreActions:function(e){this.actionsPopover&&this.actionsPopover.isOrWasRecentlyRendered()||this._showMoreActionsPopover(e)},_onHeaderMinimizeClick:function(){this.minimize()},_onMinimizedViewClick:function(){this.unminimize()},_onPillClick:function(){this.focus()},_onBlogClick:function(e){var t=s(e.currentTarget);this.eventBus.trigger(this.eventBus.CONVERSATION_OPEN_TUMBLR_URL,{blogName:t.attr("data-js-tumblelog-name"),postId:t.attr("data-js-post-id"),searchTagTerm:t.attr("data-js-tumblelog-tag"),url:t.attr("href"),originalEvent:e})},_onActionsBlock:function(e){var t=this.conversation.getParticipantModel();n.isEmpty(t)||this.eventBus.trigger(this.eventBus.BLOCK,{currentTumblelog:t.get("name"),blockedTumblelog:e,context:"messaging"},this.conversation)},_onActionsDelete:function(){this.eventBus.trigger(this.eventBus.CONVERSATION_DELETE_MODEL,this.conversation)},_applyTheme:function(e){var t;if(!n.isEmpty(this.otherParticipant)&&(t=this.otherParticipant.get("theme"),!n.isEmpty(t)))return new _({el:e,theme:t}).render()},_showMoreActionsPopover:function(e){var t;this.actionsPopover&&this.actionsPopover.remove(),this.actionsPopover=new w({autoTeardown:!0,pinnedSide:"bottom",pinnedTarget:e,popoverContainer:this.popoverContainer,viewOptions:{participants:this.conversation.get("participants"),user:this.user,isSoundsEnabled:this.isSoundsEnabled()}}),t=this.actionsPopover.getView(),this.listenTo(t,"block",this._onActionsBlock),this.listenTo(t,"delete",this._onActionsDelete),this.actionsPopover.render()},_animateInMessage:function(e,t,i){var s,r,a=e.$el,l=this.composeView.$el.offset(),c=a.offset(),u=Math.max(0,l.top-c.top)+a.height();i.get("isFromPreview")?s=0:(r=t.offset(),s=l.left-r.left),this.messagesView.setIsAnimating(!0),o.animate(a,{translateY:[0,u],translateX:[0,s],opacity:[1,1]},{duration:this.get("animateInMessageDuration"),easing:this.easeOutExpo,complete:n.bind(function(){this.messagesView.setIsAnimating(!1),i.set("hasAnimation",!1),a.css("transform","")},this)})},_addAnimationClass:function(e,t){var i=new s.Deferred;return e.removeClass(t),u(e,function(){e.removeClass(t),i.resolve()}),e.addClass(t),i},_onConversationErrorRetryClick:function(e){return this.fetch()},_onChangeIsOffline:function(e,t){this.composeView.set("isOffline",t)},_onMessageRetryClick:function(e){this._resendMessage(e)},_onChangeConversationCanSend:function(e,t){this.set("canSend",t)},_onChangeConversationIsPossibleSpam:function(e,t){t&&this.set("isPossibleSpam",!0)},_onChangeCanSend:function(e,t){var i=r("This Tumblr can't receive messages.");this.composeView.toggle(t),!t&&this.canSendErrorView||t&&!this.canSendErrorView||(t?(this.messagesView.removeFooterView(this.canSendErrorView),delete this.canSendErrorView):(this.canSendErrorView=new p({message:i,showErrorIcon:!0}),this.messagesView.addFooterView(this.canSendErrorView)))},_onChangeIsPossibleSpam:function(e,t){t&&this.isPossibleSpamView||!t&&!this.isPossibleSpamView||(t?(this.isPossibleSpamView=new p({message:this.getSpamErrorMessage(),actionText:r("Mark as spam"),actionCallback:n.bind(this._onMarkAsSpamLinkClick,this)}),this.messagesView.addFooterView(this.isPossibleSpamView)):(this.messagesView.removeFooterView(this.isPossibleSpamView),delete this.isPossibleSpamView))},_onChangeIsMinimized:function(e,t){this._setMainViewStates(),t||n.defer(n.bind(function(){this.messagesView.updateScrollBar(),this.focus(),this.conversation.get("unreadCount")>0&&(this._fetchUnreadMessages(),this.messagesView.scrollToBottom())},this)),this.trigger(t?"minimized":"unminimized")},_onMainContainerClick:function(){window.getSelection().isCollapsed&&this.focus()},_onKeyDown:function(e){var t=e.keyCode;9===t&&(e.shiftKey?this.trigger("keydown:shift+tab",e):this.trigger("keydown:tab",e))},_onComposeViewPluginPreviewAddImage:function(e){this.previewView.addImage(e).then(n.bind(function(){this.messagesView.updateScrollBar()},this)),this.messagesView.updateScrollBar(),this.composeView.toggleAutoValidation(!1),this.focus(),this.eventBus.trigger(this.eventBus.CONVERSATION_IMAGE_PREVIEW_ADD,this.conversation,e)},_onComposeViewPluginClick:function(e){this.eventBus.trigger(this.eventBus.CONVERSATION_COMPOSE_PLUGIN_CLICK,this.conversation,e)},_onPreviewViewClose:function(e){this.messagesView.updateScrollBar(),this.composeView.toggleAutoValidation(!0),this.focus()},_onPreviewViewDismiss:function(e){this.eventBus.trigger(this.eventBus.CONVERSATION_IMAGE_PREVIEW_DISMISS,this.conversation,e)},_onPreviewViewEdit:function(e){this.eventBus.trigger(this.eventBus.CONVERSATION_IMAGE_PREVIEW_EDIT,this.conversation,e)},_onMarkAsSpamLinkClick:function(){this.eventBus.trigger(this.eventBus.CONVERSATION_MARK_AS_SPAM,this.conversation,this.otherParticipant)},_onChangeMessagesHasNextPage:function(e,t){!this.rendered||this.conversation.isNew()||t||this._createIcebreakersView()}});e.exports=T},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(205),r=i(648),a=s.extend({className:"conversation-header",template:r,mixins:[o],defaults:{separator:"+",isMinimizeEnabled:!1},attributes:{"data-js-theme-background-color-or-image-class":!0,"data-js-theme-accent-color-on-background":!0},events:{"click [data-js-close]":"_onClickCloseButton","click [data-js-more-actions]":"_onClickMoreActions","click [data-js-minimize]":"_onClickMinimizeButton"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","participants","user","channels"))},getTemplateData:function(){var e;return e=this.channels.length>1?this.participants.toJSON():n.invoke(this.participants.getWithout(this.channels.pluck("uuid")),"toJSON"),e=n.filter(e,function(e){return!n.isEmpty(n.get(e,"name"))}),{participants:e,separator:this.get("separator"),isMinimizeEnabled:this.get("isMinimizeEnabled")}},_onClickCloseButton:function(e){this.trigger("closeClick"),e.preventDefault()},_onClickMoreActions:function(e){var t=e.currentTarget;this.trigger("moreActionsClick",t),e.preventDefault()},_onClickMinimizeButton:function(e){this.trigger("minimizeClick"),e.preventDefault()}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{}){__p+='<div class="conversation-header-image" data-js-theme-header-image></div><div class="conversation-header-main"><div data-js-title class="title"> ';var lastIndex=participants.length-2;__p+=" ",_.each(participants,function(e,t){__p+=' <a href="'+(null==(__t=e.url)?"":_.escape(__t))+'" target="_blank" data-js-tumblelog-name="'+(null==(__t=e.name)?"":_.escape(__t))+'">'+(null==(__t=e.name)?"":_.escape(__t))+"</a> "+(null==(__t=t===lastIndex?" "+separator+" ":lastIndex>t?", ":"")?"":_.escape(__t))+" "}),__p+=' </div><div class="controls" data-js-theme-accent-color-on-background><a href="#" data-js-more-actions class="more-actions">'+(null==(__t=__("Actions"))?"":_.escape(__t))+"</a> ",isMinimizeEnabled&&(__p+=' <a href="#" data-js-minimize class="minimize">'+(null==(__t=__("Minimize"))?"":_.escape(__t))+"</a> "),__p+=' <a href="#" data-js-close class="close">'+(null==(__t=__("Close"))?"":_.escape(__t))+"</a></div></div>"}return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(10),o=i(121),r=i(156),a=i(620),l=i(205),c=i(258),u=i(624),h=i(650),d=i(662),p=i(664),g=r.extend({className:"conversation-messages",template:p,mixins:[l,a],defaults:{isVisible:!0,isPaginating:!1,tsHeaderThreshold:36e5,collapseMessagesThreshold:6e4,pillClickScrollSpeed:500,pillBottomThreshold:80},subviews:{paginationLoaderView:{constructor:c,options:{variation:"small h-centered",loading:!1}},messagesView:{constructor:h,options:function(e){return{eventBus:e.eventBus,participants:e.participants,formatter:e.messageFormatter,animateInMessage:e.animateInMessage,afterRetryClick:n.bind(e.afterRetryClick,e)}},collection:function(e){return e.collection}},pillView:{constructor:d,options:function(e){return{eventBus:e.eventBus}}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","collection","participants","messageFormatter","animateInMessage"))},afterRenderSubviews:function(){this.scrollBar=new u({el:this.el,bottomThreshold:this.get("pillBottomThreshold")}),this.listenTo(this.collection,"update reset",this._onCollectionUpdate),this.listenTo(this.collection,"change:hasNextPage",this._onChangeHasNextPage),this.listenTo(this.collection,"change:isError",this._onChangeMessageIsError),this.listenTo(this.scrollBar,"scrolltop",this._onScrollChangeIsAtTop),this.listenTo(this.scrollBar,"scrollbottom",this._onScrollChangeIsAtBottom),this.listenTo(this.scrollBar,"scrollstop",this._createPositionSnapshot),this.listenTo(this.pillView,"click",this._onPillViewClick),this.listenTo(this,"change:isPaginating",this._onChangeIsPaginating),this.listenTo(this,"change:isVisible",this._onChangeIsVisible),this._onChangeHasNextPage(this.collection,this.collection.hasNextPage()),n.defer(n.bind(function(){this._processMessages(),this.updateScrollBar(),this.scrollToBottom()},this))},beforeRemove:function(){this.scrollBar&&this.scrollBar.destroy()},scrollToBottom:function(e){this._setScrollTop(this.el.scrollHeight,e)},getNextPage:function(){this.collection.hasNextPage()&&(this.set("isPaginating",!0),this.collection.fetchNextPage({isPaginating:!0,scrollBottom:this._getCurrentScrollBottom()}).always(n.bind(function(){this.set("isPaginating",!1)},this)))},updateScrollBar:function(){var e,t=this.scrollBar.isDisabled();this.scrollBar.setDisabled(!0),this.scrollBar&&this.scrollBar.update(),e=this._getPositionDiff(),e&&this._setScrollTop(this.$el.scrollTop()+e.height+e.scrollTop),this._createPositionSnapshot(),this.scrollBar.setDisabled(t)},afterRetryClick:function(e){this.trigger("messageRetryClick",e)},toggle:function(e){this.set("isVisible",e)},isAtBottom:function(){return this._lastPosition&&this.scrollBar?this._lastPosition.scrollBottom<this.get("pillBottomThreshold"):!0},showPill:function(e){return this._pillDefer&&this._pillDefer.reject(),this._pillDefer=o.defer(),this.pillView.setCount(e),this._pillDefer.promise},addHeaderView:function(e){var t=this._getCurrentScrollBottom();return this.js$("header").append(e.render().$el),this._adjustScrollbarAfterNewElements(t),e},removeHeaderView:function(e){return e.remove()},addFooterView:function(e){return this.js$("footer").append(e.render().$el),e},removeFooterView:function(e){return e.remove()},setIsAnimating:function(e){this.$el.toggleClass("is-animating",e)},_onChangeIsVisible:function(e,t){this.$el.css("visibility",t?"":"hidden"),t&&(this.updateScrollBar(),this.scrollToBottom())},_setScrollTop:function(e,t){t?this.$el.animate({scrollTop:e},t):this.$el.scrollTop(e)},_getCurrentScrollBottom:function(){return this.el.scrollHeight-this.$el.scrollTop()},_onCollectionUpdate:function(e,t){this._processMessages(t),n.get(t,"isPaginating")&&this._adjustScrollbarAfterNewElements(n.get(t,"scrollBottom")),n.defer(n.bind(function(){this.rendered&&this._adjustScrollbarAfterFetch(t)},this))},_adjustScrollbarAfterFetch:function(e){this.scrollBar&&this.scrollBar.update(),n.get(e,"isPolling")||n.get(e,"isPaginating")||this.scrollToBottom(),this._createPositionSnapshot()},_adjustScrollbarAfterNewElements:function(e){n.isNumber(e)&&(this.scrollBar.setDisabled(!0),this._setScrollTop(this.el.scrollHeight-e),n.delay(n.bind(function(){this.scrollBar.setDisabled(!1)},this),500))},_onChangeIsPaginating:function(e,t){this.paginationLoaderView.set("loading",t)},_onChangeHasNextPage:function(e,t){this.js$("loader-container").toggle(t)},_processMessages:function(e){var t,i=this.get("tsHeaderThreshold"),s=this.get("collapseMessagesThreshold"),o=(new Date).getTime();n.get(e,"isPolling")&&(o="new"),this.collection.each(function(e){e.set({tsHeader:this._getTimestampHeader(e,t,i),isCollapsed:this._getIsCollapsed(e,t,s,o)}),t=e},this)},_getTimestampHeader:function(e,t,i){var n=e?e.getTimestamp():null,o=t?t.getTimestamp():null,r=!o||n-o>i;return r?s(n).calendar():null},_getIsCollapsed:function(e,t,i,n){return e.has("collapseGroup")||e.set("collapseGroup",e.isNew()?"new":n),t?e.get("collapseGroup")!==t.get("collapseGroup")?!1:e.get("participant")!==t.get("participant")?!1:e.getTimestamp()-t.getTimestamp()<i:!1},_getScrollPosition:function(){return this.scrollBar.getCurrentPositions()},_createPositionSnapshot:function(){this._lastPosition=this._getScrollPosition()},_getPositionDiff:function(){if(this._lastPosition){var e=this._getScrollPosition();return{scrollTop:this._lastPosition.scrollTop-e.scrollTop,scrollBottom:this._lastPosition.scrollBottom-e.scrollBottom,height:this._lastPosition.height-e.height}}},_onScrollChangeIsAtTop:function(e){e&&this.getNextPage()},_onScrollChangeIsAtBottom:function(e){e&&this._pillDefer&&(this._pillDefer.resolve(this.pillView.getCount()),this.pillView.setCount(0))},_onPillViewClick:function(){this.pillView.setCount(0),this.scrollToBottom(this.get("pillClickScrollSpeed")),this._pillDefer&&this._pillDefer.resolve()},_onChangeMessageIsError:function(){this.scrollToBottom()}});e.exports=g},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(205),r=i(597),a=i(651),l=i(652),c=i(658),u=i(660),h=s.extend({className:"conversation-message",mixins:[o],template:a,messagesTypes:{},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","participants","afterRetryClick","formatter","animateInMessage")),this.addMessageType(r.POST,c),this.addMessageType(r.TEXT,l,function(e){return{afterRetryClick:e.afterRetryClick,formatter:e.formatter}})},afterRenderSubviews:function(){var e=this.createMessageView(this.model.get("type"));return e?(this.js$("message-container").html(e.render().$el),this.model.get("hasAnimation")&&n.isFunction(this.animateInMessage)&&this.animateInMessage(this,this.js$("message-bubble"),this.model),this.listenTo(this.model,"change:isPending",this._onChangeIsPending),this.listenTo(this.model,"change:isError",this._onChangeIsError),this.listenTo(this.model,"change:isCollapsed",this._onChangeIsCollapsed),this.listenTo(this.model,"change:tsHeader",this._onChangeTsHeader),this._onChangeTsHeader(this.model,this.model.get("tsHeader")),void this._onChangeIsCollapsed(this.model,this.model.get("isCollapsed"))):this.remove()},addMessageType:function(e,t,i){this.messagesTypes[e]={constructor:t,options:i}},getMessageType:function(e){return n.get(this.messagesTypes,e)},createMessageView:function(e){var t,i=this.getMessageType(e);return n.isEmpty(i)||!n.has(i,"constructor")?null:(t=n.get(i,"options",{}),n.isFunction(t)&&(t=t.call(this,this)),n.extend(t,{model:this.model,participants:this.participants,eventBus:this.eventBus}),new i.constructor(t))},_onChangeTsHeader:function(e,t){this.timestampView&&this.timestampView.remove(),n.isEmpty(t)||(this.timestampView=new u({model:this.model}),this.$el.prepend(this.timestampView.render().$el))},_onChangeIsCollapsed:function(e,t){this.$el.toggleClass("collapsed",t)},_onChangeIsPending:function(e,t){this.$el.toggleClass("pending",t)},_onChangeIsError:function(e,t){this.$el.toggleClass("error",t)}});e.exports=h},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+="<div data-js-message-container></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(156),r=i(205),a=i(653).html,l=i(657),c=o.extend({className:"conversation-message-text message-container",mixins:[r],template:l,defaults:{pendingClassName:"is-pending",fullWidthBubblePercentThreshold:60,fullWidthBubbleClass:"full-width-bubble"},events:{"click [data-js-retry-button]":"_onRetryClick"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","participants","afterRetryClick")),this.formatter=e.formatter||new a},afterRenderSubviews:function(){this.listenTo(this.model,"change:isPending change:isError change:canRetry",this._setButtonState),this.listenTo(this.model.get("content"),"change",this.render),this._setButtonState(),this.$el.width()?this._setBubbleStyles():n.defer(n.bind(this._setBubbleStyles,this))},getTemplateData:function(){var e=this.participants.get(this.model.get("participant")),t=this.model.toJSON(),i=this.formatter.render(n.get(t,"content.text"),n.get(t,"content.formatting"));return{message:i,avatarUrl:e?e.getAvatarUrl():null,name:e?e.get("name"):null,url:e?e.get("url"):null}},_setBubbleStyles:function(){var e=this.get("fullWidthBubblePercentThreshold"),t=this.js$("message-bubble"),i=this.$el.width(),n=t.width();n>e/100*i&&t.addClass(this.get("fullWidthBubbleClass"))},_setButtonState:function(){var e,t,i,n,o,r,a;this.rendered&&(e=this.js$("retry-button"),t=this.model.get("isPending"),i=this.model.get("canRetry"),n=this.model.get("isError"),o=s(i?"Retry":"Could not send"),r=t?s("Trying..."):o,a=n,e.toggle(a),a&&(e.text(r).prop("disabled",t||!i),e.toggleClass(this.get("pendingClassName"),t)))},_onRetryClick:function(e){e.preventDefault(),this.model.get("canRetry")&&(this.trigger("retryClick",this.model),n.isFunction(this.afterRetryClick)&&this.afterRetryClick(this.model))}});e.exports=c},function(e,t,i){e.exports={html:i(654)}},function(e,t,i){"use strict";var n=i(3),s=i(655),o=i(656),r=s.extend({name:"html",formatters:{link:o},escape:function(e){return n.escape(e)},applyFormatting:function(e,t){var i=n.bind(this.escape,this),s=n.bind(this.getFormatter,this),o={};n.forEach(t,function(e){var t=s(e.type);if(t){var i=e.position,r=e.attributes,a=i[0],l=i[1];n.isEmpty(o[a])&&(o[a]=[]),n.isEmpty(o[l])&&(o[l]=[]),o[a].push(n.bind(t.open,this,r)),o[l].unshift(n.bind(t.close,this,r))}},this);var r,a,l=n.sortBy(n.keys(o),function(e){return n.parseInt(e)}),c="",u=0;return n.forEach(l,function(t){r=o[t],a=e.substr(u,t-u),c+=i(a),n.forEach(r,function(e){c+=e()}),u=t},this),a=e.substr(u),c+=i(a)}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(145),o=s.extend({name:"unknown",formatters:{},constructor:function(e){this.options=e||{},n.isFunction(this.formatters)?this.formatters=this.formatters():this.formatters=n.clone(this.formatters||{})},registerFormatter:function(e,t){this.formatters[e]=t},getFormatter:function(e){return n.result(this.formatters,e)},escape:function(e){return e},applyFormatting:function(e,t){return this.escape(e)},postFilter:function(e){return e},render:function(e,t){return this.postFilter(this.applyFormatting(e,t))}});e.exports=o},function(e,t,i){"use strict";function n(e){return s(e).omit(s.isUndefined).reduce(function(e,t,i){return(e?e+" ":"")+o('%s="%s"',s.escape(i),s.escape(t))},"")}var s=i(3),o=i(6).sprintf,r={open:function(e){var t=n({"data-js-tumblelog-name":e.blog_name,"data-js-post-id":e.post_id,target:"_blank",href:e.url});return"<a "+t+">"},close:function(e){return"</a>"}};e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<a class="avatar" href="'+(null==(__t=url)?"":_.escape(__t))+'" target="_blank" data-js-tumblelog-name="'+(null==(__t=name)?"":_.escape(__t))+'"><img src="'+(null==(__t=avatarUrl)?"":_.escape(__t))+'"></a><div class="message-bubble" data-js-message-bubble><div class="message-bubble-header"><a href="'+(null==(__t=url)?"":_.escape(__t))+'" class="name" target="_blank" data-js-tumblelog-name="'+(null==(__t=name)?"":_.escape(__t))+'">'+(null==(__t=name)?"":_.escape(__t))+'</a><button class="retry-button" data-js-retry-button> '+(null==(__t=__("Retry"))?"":_.escape(__t))+' </button></div><div class="message">'+(null==(__t=message)?"":__t)+"</div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(205),r=i(623),a=i(659),l=s.extend({className:"conversation-message-post",mixins:[o],template:a,defaults:{thumbnailWidth:210},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","participants","model"))},afterRenderSubviews:function(){this.listenTo(this.model,"change:isError change:isPending",this._onModelChange),this.listenTo(this.model.get("post"),"change:summary change:state",this._onModelChange),this._startTruncateSummary()},getThumbnailAtWidth:function(e){var t,i=this.model.get("post"),s=i.getThumbnail(e);return n.isEmpty(s)?null:(t=i.getScaledDimensionsForWidth(s,e),n.extend({},s,t))},getTemplateData:function(){var e=this.model.get("post"),t=this.participants.get(this.model.get("participant")),i=this.getThumbnailAtWidth(this.get("thumbnailWidth"));return{postType:e.getType(),isDisabled:e.isDisabled(),isError:this.model.get("isError"),isPending:this.model.get("isPending"),sentString:t?e.getSentString(t.get("name")):null,message:e.getMessage(),thumbnail:i,avatarUrl:t?t.getAvatarUrl():null,name:t?t.get("name"):null,url:e.get("post_url"),postBlogName:e.get("blog_name"),postId:e.get("id")}},_startTruncateSummary:function(){n.defer(n.bind(this._truncateSummary,this))},_truncateSummary:function(){r(this.js$("summary",!0))},_onModelChange:function(){this.renderWithTemplate(),this._startTruncateSummary()}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="message-container conversation-message-post--'+(null==(__t=postType)?"":_.escape(__t))+" "+(null==(__t=_.isEmpty(thumbnail)?"no-thumbnail":"has-thumbnail")?"":_.escape(__t))+(null==(__t=isDisabled?" is-disabled":"")?"":_.escape(__t))+'"><div class="avatar"><a href="'+(null==(__t=url)?"":_.escape(__t))+'" target="_blank" data-js-tumblelog-name="'+(null==(__t=name)?"":_.escape(__t))+'"><img src="'+(null==(__t=avatarUrl)?"":_.escape(__t))+'"></a></div> ',isDisabled?__p+=' <div class="message-bubble" data-js-message-bubble><div class="message-bubble-header">'+(null==(__t=sentString)?"":_.escape(__t))+"</div></div> ":(__p+=' <div class="message-bubble" data-js-message-bubble><a href="'+(null==(__t=url)?"":_.escape(__t))+'" data-js-tumblelog-name="'+(null==(__t=postBlogName)?"":_.escape(__t))+'" data-js-post-id="'+(null==(__t=postId)?"":_.escape(__t))+'"><div class="message-bubble-header" data-js-summary><span class="name">'+(null==(__t=sentString)?"":_.escape(__t))+"</span> ",_.isEmpty(message)||(__p+=' <span class="text">'+(null==(__t=message)?"":_.escape(__t))+"</span> "),__p+=' </div></a></div><a href="'+(null==(__t=url)?"":_.escape(__t))+'" data-js-tumblelog-name="'+(null==(__t=postBlogName)?"":_.escape(__t))+'" data-js-post-id="'+(null==(__t=postId)?"":_.escape(__t))+'" class="icon"></a> '),__p+=" </div> ",_.isEmpty(thumbnail)||(__p+=' <a href="'+(null==(__t=url)?"":_.escape(__t))+'" data-js-tumblelog-name="'+(null==(__t=postBlogName)?"":_.escape(__t))+'" data-js-post-id="'+(null==(__t=postId)?"":_.escape(__t))+'" class="thumbnail"><img src="'+(null==(__t=_.get(thumbnail,"url"))?"":_.escape(__t))+'" width="'+(null==(__t=_.get(thumbnail,"width"))?"":_.escape(__t))+'" height="'+(null==(__t=_.get(thumbnail,"height"))?"":_.escape(__t))+'"> </a> '),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(661),r=s.extend({className:"conversation-message-timestamp",template:o,initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus"))},getTemplateData:function(){return{label:this.model.get("tsHeader")}}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div data-js-label class="inline-activity timestamp">'+(null==(__t=label)?"":_.escape(__t))+"</div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(156),r=i(205),a=i(663),l=o.extend({className:"conversation-pill hide-pill",template:a,mixins:[r],events:{"click [data-js-unread-button]":"_onClick"},defaults:{count:0,maxCount:99},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus"))},afterRender:function(){this.listenTo(this,"change:count",this._onChangeCount),this._onChangeCount(this,this.get("count"))},setCount:function(e){this.set("count",n.isFinite(e)?e:0)},getCount:function(){return this.get("count")},getTitle:function(e){var t,i;return n.isFinite(e)?(t=this.get("maxCount"),i=e>t?t+"+":e,e>1?s("%1$s unread messages",i):s("%1$s unread message",i)):null},getTemplateData:function(){return{title:this.getTitle(this.get("count"))}},_onChangeCount:function(e,t){var i=this.getTitle(t);this.$el.toggleClass("hide-pill",0===t||n.isEmpty(i)),
t>0&&this.js$("unread-button").text(i)},_onClick:function(e){e.preventDefault(),this.trigger("click")}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<button tabindex="-1" data-js-theme-button data-js-unread-button class="unread-button">'+(null==(__t=title)?"":_.escape(__t))+"</button>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="conversation-pagination-loader" data-js-loader-container><div data-subview="paginationLoaderView"></div></div><div data-js-header></div><div data-subview="messagesView[]" class="message-list"></div><div data-subview="pillView"></div><div data-js-footer></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(666),r=s.extend({className:"conversation-message-error",template:o,defaults:{message:null,showErrorIconClass:"show-icon",showErrorIcon:!1,actionText:null},events:{"click [data-js-action]":"_onClickAction"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","actionCallback"))},getTemplateData:function(){return{message:this.get("message"),actionText:this.get("actionText")}},afterRender:function(){this.$el.toggleClass(this.get("showErrorIconClass"),this.get("showErrorIcon"))},_onClickAction:function(e){e.preventDefault(),n.isFunction(this.actionCallback)&&this.actionCallback()}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="message"> '+(null==(__t=message)?"":_.escape(__t))+" ",_.isEmpty(actionText)||(__p+=' <span class="action-container"><a href="#" data-js-action class="action">'+(null==(__t=actionText)?"":_.escape(__t))+"</a></span> "),__p+=" </div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(156),r=i(205),a=i(189),l=i(668),c=i(165),u=i(669),h=o.extend({className:"conversation-preview",template:l,mixins:[r],events:{"click [data-js-image-container]":"_onImageContainerClick","click [data-js-preview-remove]":"_onClickPreviewRemove"},defaults:{isVisible:!1,isEditable:!1,maxHeight:150,maxWidth:210,animateInDurationMs:500,animateOutDurationMs:300},afterRender:function(){this.listenTo(this,"change:isVisible",this._onChangeIsVisible),this.listenTo(this,"change:isEditable",this._onChangeIsEditable),this._onChangeIsVisible(this,this.get("isVisible")),this._onChangeIsEditable(this,this.get("isEditable"))},addImage:function(e){var t=e.get("height"),i=e.get("width"),n=this.get("maxHeight"),o=this.get("maxWidth"),r=a.maxSize(i,t,o,n),l=this.js$("image-container");return this.previewImageView&&this.previewImageView.remove(),this.previewImageView=new u({src:e.get("url"),width:s.get(r,"width"),height:s.get(r,"height")}),l.append(this.previewImageView.render().$el),this.set("isVisible",!0),this.set("isEditable",s.isFunction(e.get("editCallback"))),this.previewImageModel=e,this._slideElement(l)},_slideElement:function(e,t){var i=new n.Deferred,o=[.19,1,.22,1],r=[.895,.03,.685,.22],a=e.height(),l=e.offset().top-this.$el.offset().top,u=a+l;return c.animate(e,{translateY:t?[u,0]:[0,u]},{duration:t?this.get("animateOutDurationMs"):this.get("animateInDurationMs"),easing:t?r:o,complete:s.bind(function(){i.resolve(),e.css("transform","")},this)}),i},getMessage:function(){return s.isEmpty(this.previewImageModel)?null:this.previewImageModel.get("message")},close:function(e){return this._slideElement(this.js$("image-container"),!0).then(s.bind(this._onAfterCloseAnimation,this))},_onAfterCloseAnimation:function(){var e=this.previewImageModel;this.previewImageView.remove(),delete this.previewImageModel,this.set("isVisible",!1),this.trigger("close",e)},_onImageContainerClick:function(e){var t,i=this.previewImageModel;this.get("isEditable")&&!s.isEmpty(i)&&(t=i.get("editCallback"),s.isFunction(t)&&(e.preventDefault(),t(),this.trigger("edit",i)))},_onClickPreviewRemove:function(e){e.preventDefault(),e.stopPropagation(),this.trigger("dismiss",this.previewImageModel),this.close()},_onChangeIsVisible:function(e,t){this.$el.toggle(t)},_onChangeIsEditable:function(e,t){this.$el.toggleClass("editable",t)}});e.exports=h},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="conversation-preview-image-container" data-js-image-container><a href="#" class="conversation-preview-remove" data-js-preview-remove>'+(null==(__t=__("Remove"))?"":_.escape(__t))+"</a></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(670),r=s.extend({className:"conversation-preview-image",template:o,defaults:{width:null,height:null,src:null,context:null,loggingData:null},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults)))}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<img src="'+(null==(__t=src)?"":_.escape(__t))+'" width="'+(null==(__t=width)?"":_.escape(__t))+'" height="'+(null==(__t=height)?"":_.escape(__t))+'" alt="'+(null==(__t=__("GIF"))?"":_.escape(__t))+'">';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(205),r=i(162),a=i(156),l=i(672),c=i(639),u=i(673),h=a.extend({className:"conversation-compose",template:u,mixins:[o,r],events:{"click [data-js-submit-button]":"_onSubmitButtonClick","input [data-js-text-input]":"_onTextInputChange","keydown [data-js-text-input]":"_onTextInputKeydown","focus [data-js-text-input]":"_onTextInputFocus","blur [data-js-text-input]":"_onTextInputBlur"},keycommands:{"keydown:escape":"_onKeyPressEscape"},defaults:{isValid:!0,isDisabled:!1,isOffline:!1,placeholder:null,offlinePlaceholder:null,currentPlaceholder:null,currentText:null,hasEditorFocus:!1,isAutoValidationEnabled:!0,buttonSubmittedClass:"submitted",isShufflePlaceholder:!0,animationSpeed:250},subviews:{composePluginsView:{constructor:l,options:function(e){return{pluginsArray:e.pluginsArray}}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","keyboardManager","keyboardNamespace","pluginsArray","isGifSearchEnabled")),this.getRandomPlaceholder=c([s("New message"),s("Your message here"),s("Write a message"),s("Say something"),s("Say your thing")]),n.isEmpty(this.pluginsArray)&&this.hideComposePluginsView(),this.set("isShufflePlaceholder",n.isEmpty(this.get("placeholder"))),n.isEmpty(this.get("placeholder"))&&this.set("placeholder",this.getRandomPlaceholder()),this.set("currentPlaceholder",this.get("placeholder")),n.isEmpty(this.get("offlinePlaceholder"))&&this.set("offlinePlaceholder",s("Currently offline")),this.keyboardManager&&this.disableKeys()},afterRenderSubviews:function(){this.listenTo(this,"change:isValid",this._onChangeIsValid),this.listenTo(this,"change:isDisabled",this._onChangeIsDisabled),this.listenTo(this,"change:isOffline",this._onChangeIsOffline),this.listenTo(this,"change:currentPlaceholder",this._onChangeCurrentPlaceholder),this.listenTo(this,"change:currentText",this._onChangeCurrentText),this.listenTo(this,"change:hasEditorFocus",this._onChangeHasEditorFocus),this.listenTo(this,"change:isAutoValidationEnabled",this._onChangeIsAutoValidationEnabled),this.listenTo(this.composePluginsView,"plugin:preview:add:image",this._onComposePluginPreviewAddImage),this.listenTo(this.composePluginsView,"plugin:click",this._onComposePluginClick),this._onChangeIsValid(this,this.get("isValid")),this._onChangeIsDisabled(this,this.get("isDisabled")),this._onChangeIsOffline(this,this.get("isOffline")),this._onChangeCurrentPlaceholder(this,this.get("currentPlaceholder")),this._onChangeCurrentText(this,this.get("currentText")),this._setValidState(),n.defer(n.bind(function(){this._resizeInput()},this))},getTemplateData:function(){return{placeholder:this.get("placeholder")}},hideComposePluginsView:function(){this.$el.addClass("hide-compose-plugins-container")},toggle:function(e){this.$el.toggle(e),e&&this.$el.css("display","")},submit:function(e){var t=this.get("currentText");this.get("isValid")&&!this.get("isDisabled")&&(this.trigger("submit",t,e),this._startAnimation(n.bind(function(){this.trigger("submit:animated",t,e)},this)),this.clear())},escape:function(){n.isEmpty(this.get("currentText"))?this.trigger("close"):this.clear()},clear:function(){this.js$("text-input").val(""),this.set("currentText",""),this.get("isShufflePlaceholder")&&this._setPlaceholderState(),this._resizeInput()},focus:function(){n.defer(n.bind(function(){this.rendered&&this.js$("text-input").focus()},this))},getMessage:function(){return this.js$("text-input").val()},setPlaceholder:function(e){this.set({placeholder:e,isShufflePlaceholder:!1}),this._setPlaceholderState()},beforeRemove:function(){this.keyboardManager&&this.keyboardManager.remove(this.keyboardNamespace)},toggleAutoValidation:function(e){this.set("isAutoValidationEnabled",e)},_onComposePluginPreviewAddImage:function(e){this.trigger("plugin:preview:add:image",e)},_onComposePluginClick:function(e){this.trigger("plugin:click",e)},_onKeyPressEscape:function(e){e.preventDefault(),this.escape()},_onTextInputChange:function(){var e=n.trim(this.js$("text-input").val());this._resizeInput(),this.set("currentText",e),this.trigger("input",e,this)},_setValidState:function(){return this.get("isAutoValidationEnabled")?void this.set("isValid",!n.isEmpty(this.get("currentText"))):void this.set("isValid",!0)},_resizeInput:function(){var e,t=this.js$("text-input"),i=t.get(0);this._originalInputHeight||(this._originalInputHeight=t.outerHeight()),this.$el.css("height",this.$el.height()),t.css("height","auto"),e=i.scrollHeight,Math.abs(e-this._originalInputHeight)<5&&(e=this._originalInputHeight),t.css("height",e),this.$el.css("height",""),this._detectResize()},_detectResize:function(){var e=this.$el.height();return this._previousHeight?void(e!==this._previousHeight&&(this.trigger("resize",e),this._previousHeight=e)):void(this._previousHeight=e)},_startAnimation:function(e){var t=this.js$("submit-button"),i=this.get("buttonSubmittedClass");return n.isEmpty(i)?void(n.isFunction(e)&&e.call(this)):(t.addClass(i),void n.delay(n.bind(function(){t.removeClass(i),n.isFunction(e)&&e.call(this)},this),this.get("animationSpeed")))},_setPlaceholderState:function(){this.set("currentPlaceholder",this.get("isShufflePlaceholder")?this.getRandomPlaceholder():this.get("placeholder"))},_onChangeCurrentText:function(e,t){this._setValidState()},_onChangeIsValid:function(e,t){this.js$("submit-button").prop("disabled",!t||this.get("isDisabled"))},_onSubmitButtonClick:function(e){e.preventDefault(),this.submit("button")},_onChangeIsDisabled:function(e,t){this.js$("text-input").prop("disabled",t),this.js$("submit-button").prop("disabled",t||!this.get("isValid")),this.composePluginsView.toggleDisabled(t)},_onChangeIsOffline:function(e,t){t?(this.set("previousPlaceholder",this.get("placeholder")),this.set("currentPlaceholder",this.get("offlinePlaceholder"))):this.set("currentPlaceholder",this.get("previousPlaceholder"))},_onChangeCurrentPlaceholder:function(e,t){this.js$("text-input").attr("placeholder",t)},_onTextInputFocus:function(){this.set("hasEditorFocus",!0),this.trigger("focus",this)},_onTextInputBlur:function(){this.set("hasEditorFocus",!1),this.trigger("blur",this)},_onTextInputKeydown:function(e){13!==e.keyCode||e.shiftKey||(this.submit("keyboard"),e.preventDefault())},_onChangeHasEditorFocus:function(e,t){this.keyboardManager&&this.keyboardManager.toggle(this.keyboardNamespace,e,t)},_onChangeIsAutoValidationEnabled:function(e,t){this._setValidState()}});e.exports=h},function(e,t,i){"use strict";var n=i(3),s=i(156),o=s.extend({className:"conversation-compose-plugins-container",mixins:[],renderWithTemplate:n.noop,defaults:{isDisabled:!1},initialize:function(e){e=n.extend({},e),n.extend(this,n.pick(e,"pluginsArray"))},afterRender:function(){this.listenTo(this,"change:isDisabled",this._onChangeIsDisabled),n.each(this.pluginsArray,n.bind(this._addPluginView,this)),this._onChangeIsDisabled(this,this.get("isDisabled"))},toggleDisabled:function(e){this.set("isDisabled",e)},_addPluginView:function(e){e.render(),this.$el.append(e.el),this.listenTo(e,"preview:add:image",this._onPluginViewPreviewAddImage),this.listenTo(e,"click",this._onPluginViewClick)},_onPluginViewPreviewAddImage:function(e){this.trigger("plugin:preview:add:image",e)},_onPluginViewClick:function(e){this.trigger("plugin:click",e)},_onChangeIsDisabled:function(e,t){n.each(this.pluginsArray,n.bind(function(e){e.toggleDisabled(t)}),this)}});e.exports=o},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="composePluginsView" class="compose-plugins-container"></div><div class="text-input-container"><textarea class="text-input" placeholder="'+(null==(__t=placeholder)?"":_.escape(__t))+'" rows="1" maxlength="4096" data-js-text-input></textarea></div><div class="submit-button"><button type="submit" data-js-submit-button data-js-theme-accent-color-on-white class="submit">'+(null==(__t=__("Send"))?"":_.escape(__t))+"</button></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(205),r=i(675),a=s.extend({className:"conversation-minimized",tagName:"a",attributes:{href:"#"},template:r,mixins:[o],events:{click:"_onClick"},defaults:{maxBadgeCount:99,activeBadgeClass:"tab-notice--active",newMessageClass:"new-message"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","participant"))},getTemplateData:function(){return{blogName:this.participant?this.participant.get("name"):null,avatarUrl:this.participant?this.participant.getAvatarUrl():null}},afterRender:function(){this.listenTo(this.model,"change:unreadCount",this._onChangeUnreadCount)},updateBadge:function(e){var t=this.get("maxBadgeCount"),i=this.get("activeBadgeClass");e>0&&this.js$("badge-value").text(e>t?t+"+":e),this.js$("badge").toggleClass(i,e>0)},animate:function(){var e=this.get("newMessageClass");this.$el.addClass(e),n.delay(n.bind(function(){this.$el.removeClass(e)},this),250)},focus:function(){this.$el.focus()},blur:function(){this.$el.blur()},_onChangeUnreadCount:function(e,t){this.updateBadge(t),t>0&&this.animate()},_onClick:function(e){e.preventDefault(),this.blur(),this.trigger("click")}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="avatar"><img src="'+(null==(__t=avatarUrl)?"":_.escape(__t))+'" title="'+(null==(__t=blogName)?"":_.escape(__t))+'"></div><div class="conversation-minimized-badge tab_notice tab-notice--outlined" data-js-badge><span class="tab_notice_value" data-js-badge-value>2</span></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(156),r=i(205),a=i(677),l=o.extend({className:"conversation-error",mixins:[r],template:a,defaults:{message:null,isLoading:!1,showButton:!0,buttonText:null,buttonTextLoading:null,buttonTextCurrent:null},events:{"click [data-js-button]":"_onClickButton"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","buttonCallback")),n.isEmpty(this.get("message"))&&this.set("message",s("Something went screwy.")),n.isEmpty(this.get("buttonText"))&&this.set("buttonText",s("Retry")),n.isEmpty(this.get("buttonTextLoading"))&&this.set("buttonTextLoading",s("Retrying...")),n.isEmpty(this.get("buttonTextCurrent"))&&this.set("buttonTextCurrent",this.get("buttonText"))},afterRender:function(){this.listenTo(this,"change:isLoading",this._onChangeIsLoading),this.listenTo(this,"change:buttonTextCurrent",this._onChangeButtonTextCurrent),this.listenTo(this,"change:showButton",this._onChangeShowButton),this._onChangeIsLoading(this,this.get("isLoading")),this._onChangeShowButton(this,this.get("showButton"))},getTemplateData:function(){return{message:this.get("message"),buttonText:this.get("buttonTextCurrent")}},_onClickButton:function(e){e.preventDefault(),this.get("isLoading")||(this.set("isLoading",!0),this.trigger("buttonClick"),n.isFunction(this.buttonCallback)&&this.buttonCallback.call(this,this))},_onChangeIsLoading:function(e,t){var i=t?this.get("buttonTextLoading"):this.get("buttonText");this.set("buttonTextCurrent",i),this.js$("button").toggleClass("disabled",t).prop("disabled",t)},_onChangeButtonTextCurrent:function(e,t){this.js$("button").text(t)},_onChangeShowButton:function(e,t){this.js$("button").toggle(t)}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="content"><label>'+(null==(__t=message)?"":_.escape(__t))+'</label><button data-js-theme-button data-js-button class="chrome">'+(null==(__t=buttonText)?"":_.escape(__t))+"</button></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(205),r=i(160),a=s.extend({mixins:[o,r],defaults:{removeDataAttrAfterApplyingTheme:!0},configuration:{"theme-background-color":{themeField:"background_color",applyStyle:"background-color"},"theme-accent-color":{themeField:"link_color",applyStyle:"color"},"theme-accent-color-on-white":{themeField:"link_color",unsetMissingStyle:"color",applyStyle:function(e,t,i){e.css("color",i.adjustColorForBackground(t,"#ffffff"))}},"theme-accent-color-on-grey":{themeField:"link_color",unsetMissingStyle:"color",applyStyle:function(e,t,i){e.css("color",i.adjustColorForBackground(t,"#f2f2f2"))}},"theme-accent-color-on-background":{themeField:"link_color",unsetMissingStyle:"color",applyStyle:function(e,t,i){e.css("color",i.getReadableColor(t,i.get("background_color")))}},"theme-accent-color-as-background":{themeField:"link_color",unsetMissingStyle:"background-color",applyStyle:function(e,t,i){e.css("background-color",i.adjustColorForBackground(t,"#ffffff"))}},"theme-button":{themeField:function(e){var t=e.get("background_color"),i=e.get("link_color");return n.isEmpty(t)||n.isEmpty(i)?null:{text:t,background:e.getReadableColor(i,t)}},applyStyle:function(e,t,i){e.addClass("themed"),i.getHeaderImage()||e.css({"background-color":t.background,"border-color":t.background,color:t.text})}},"theme-header-image":{themeField:function(e){return e.getHeaderImage()},applyStyle:function(e,t){e.css("background-image","url("+t+")")}},"theme-background-tint":{themeField:function(e){return e.getTintSuffix(e.getBackgroundTint())},applyStyle:function(e,t,i){e.addClass("theme-background"+t)}},"theme-background-color-or-image-class":{themeField:"background_color",applyStyle:function(e,t,i){n.isEmpty(i.getHeaderImage())?e.css("background-color",t):e.addClass("has-image")}},"theme-avatar-shape-class":{themeField:"avatar_shape",applyStyle:function(e,t){e.addClass("avatar-shape--"+t)}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"theme"))},render:function(){this.theme&&n.each(this.configuration,function(e,t){var i,s,o=e.unsetMissingStyle,r=e.applyStyle;if(i=n.isFunction(e.themeField)?e.themeField.call(this,this.theme):this.theme.get(e.themeField),s=this.js$(t),0!==s.length){if(n.isEmpty(i))return void(n.isFunction(o)?o.call(this,s,i,this.theme):n.isEmpty(o)?n.isFunction(r)||s.css(r,""):s.css(o,""));n.isFunction(r)?r.call(this,s,i,this.theme):s.css(r,i),this.get("removeDataAttrAfterApplyingTheme")&&s.removeAttr("data-js-"+t)}},this)},setTheme:function(e){return this.theme=e,this.render()}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(156),r=i(211),a=i(680),l=o.extend({className:"popover--conversation-actions info_popover popover_gradient popover",mixins:[r],initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"viewOptions")),this.view=new a(this.viewOptions)},render:function(){return this.$wrapper=s("<div />").addClass("popover-inner popover_inner").appendTo(this.$el),this.$wrapper.html(this.view.render().$el),this},teardown:function(){return this.remove()},getView:function(){return this.view}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(156),r=i(681),a=o.extend({className:"conversation-actions",tagName:"ul",template:r,events:{"click [data-js-block-blogname]":"_onBlockClick","click [data-js-delete-conversation]":"_onDeleteConversationClick"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","user","participants","isSoundsEnabled")),this.blockableParticipants=this.participants.getWithout(this.user.channels.pluck("uuid"))},getTemplateData:function(){return{blockableParticipants:n.invoke(this.blockableParticipants,"toJSON"),isSoundsEnabled:this.isSoundsEnabled}},_onBlockClick:function(e){var t=s(e.currentTarget),i=t.attr("data-js-block-blogname");e.preventDefault(),n.isEmpty(i)||this.trigger("block",i)},_onDeleteConversationClick:function(e){e.preventDefault(),this.trigger("delete")}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="",isSoundsEnabled&&(__p+=' <li><a class="external-link" href="/settings/dashboard">'+(null==(__t=__("Sound settings"))?"":_.escape(__t))+"</a></li> "),__p+=' <li><a href="#" data-js-delete-conversation>'+(null==(__t=__("Delete conversation"))?"":_.escape(__t))+"</a></li> ",_.each(blockableParticipants,function(e){__p+=' <li><a href="#" data-js-block-blogname="'+(null==(__t=e.name)?"":_.escape(__t))+'">'+(null==(__t=__("Block %1$s",e.name))?"":_.escape(__t))+"</a></li> "}),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(10),r=i(156),a=i(205),l=i(283),c=i(623),u=i(678),h=i(683),d=n.template('<a href="<%- blogUrl %>/tagged/<%- tag %>" data-js-tumblelog-name="<%- blogName %>" data-js-tumblelog-tag="<%- tag %>">'),p=r.extend({className:"conversation-icebreakers",template:h,mixins:[a],defaults:{isShowTags:!0,isShowRelationship:!0,isShowDescription:!0},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"eventBus","participant"))},getTemplateData:function(){return{description:this.get("isShowDescription")?this._getCleanDescriptionString():null,relationship:this.get("isShowRelationship")?this._getRelationshipString():null,tagsMarkup:this.get("isShowTags")?this._getTagsDescriptionMarkup():null,name:this.participant.get("name"),avatarUrl:this.participant.getAvatarUrl(),url:this.participant.get("url")}},afterRender:function(){this.theme=new u({el:this.el,theme:this.participant.get("theme")}).render(),this.get("isShowDescription")&&n.defer(n.bind(function(){c(this.js$("description"))},this))},_getOpeningTagAnchor:function(e){var t=this.participant.get("name"),i=this.participant.get("url");return d({blogUrl:i,blogName:t,tag:e})},_getClosingTagAnchor:function(){return"</a>"},_getOpeningTagText:function(){return'<span class="text">'},_getClosingTagText:function(){return"</span>"},_getTagsDescriptionMarkup:function(){var e=this.participant.getBlogTags(),t=this._getOpeningTagText(),i=this._getClosingTagText(),o=this._getClosingTagAnchor();return e.length>1?s("%1$sPosts about%2$s %3$s#%4$s%5$s %6$sand%7$s %8$s#%9$s%10$s",t,i,this._getOpeningTagAnchor(e[0]),n.escape(e[0]),o,t,i,this._getOpeningTagAnchor(e[1]),n.escape(e[1]),o):1===e.length?s("%1$sPosts about%2$s %3$s#%4$s%5$s",t,i,this._getOpeningTagAnchor(e[0]),n.escape(e[0]),o):null},_getCleanDescriptionString:function(){return l.stripTags(this.participant.getDescription())},_getRelationshipString:function(){var e;if(this.participant.isMutuals()){if(e=this._getRelativeTimeString(this.participant.getDurationMutualsSeconds()),!n.isEmpty(e))return s("Mutuals for %1$s",e)}else if(this.participant.isFollowingYou()){if(e=this._getRelativeTimeString(this.participant.getDurationFollowingYouSeconds()),!n.isEmpty(e))return s("Followed you %1$s ago",e)}else if(this.participant.isFollowing()&&(e=this._getRelativeTimeString(this.participant.getDurationFollowingSeconds()),!n.isEmpty(e)))return s("Following for %1$s",e);return s("Not following each other")},_getRelativeTimeString:function(e){return n.isNumber(e)?o(Date.now()-1e3*e).fromNow(!0):null}});e.exports=p},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<a class="avatar" href="'+(null==(__t=url)?"":_.escape(__t))+'" target="_blank" data-js-tumblelog-name="'+(null==(__t=name)?"":_.escape(__t))+'" data-js-theme-avatar-shape-class><img src="'+(null==(__t=avatarUrl)?"":_.escape(__t))+'"></a><div class="name"><a href="'+(null==(__t=url)?"":_.escape(__t))+'" target="_blank" data-js-tumblelog-name="'+(null==(__t=name)?"":_.escape(__t))+'">'+(null==(__t=name)?"":_.escape(__t))+"</a></div> ",_.isEmpty(description)||(__p+=' <div class="description" data-js-description><a href="'+(null==(__t=url)?"":_.escape(__t))+'" target="_blank" data-js-tumblelog-name="'+(null==(__t=name)?"":_.escape(__t))+'"> '+(null==(__t=description)?"":_.escape(__t))+" </a></div> "),__p+=" ",_.isEmpty(relationship)||(__p+=' <div class="relationship">'+(null==(__t=relationship)?"":_.escape(__t))+"</div> "),__p+=" ",_.isEmpty(tagsMarkup)||(__p+=' <div class="tags">'+(null==(__t=tagsMarkup)?"":__t)+"</div> "),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(685),o=i(365),r=i(687),a=i(688),l=i(594),c=s.extend({className:"conversation-compose-plugin conversation-compose-plugin--gif-search",template:r,defaults:n.defaults({selectedGif:null,query:"",resultLimit:200,resultImageWidth:250},s.prototype.defaults),events:{click:"_onClick"},initialize:function(e){e=n.extend({},e),n.extend(this,n.pick(e,"collection")),this.popoverOptions={collection:this.collection,query:this.get("query"),resultLimit:this.get("resultLimit"),imageWidth:this.get("resultImageWidth"),loggingContext:this.getName(),loadFullImageBeforeSelect:!1,autoTeardown:!0,teardownOnEscape:!1,pinnedTarget:this.$el,pinnedSide:"top",isFixedPosition:!0}},getName:function(){return"messaging-gif"},onEdit:function(e,t){this._openGifSearchPopover(e,t)},_onClick:function(e){e.preventDefault(),this._openGifSearchPopover(this.get("query")),this.trigger("click",this)},_openGifSearchPopover:function(e,t){this.gifSearchPopover&&this._closePopover(),n.extend(this.popoverOptions,{query:e,selectedImageUrl:t}),this.gifSearchPopover=new o(this.popoverOptions),this.gifSearchPopover.render(),this.toggleActive(!0),this.listenToOnce(this.gifSearchPopover,"close",this._onGifSearchPopoverClose),this.listenToOnce(this.gifSearchPopover,"selectImage",this._onGifSearchPopoverSelectImage),this.listenTo(this.collection,"search",function(e){this.set("query",e)})},_closePopover:function(){this.stopListening(this.gifSearchPopover),this.stopListening(this.collection),this.gifSearchPopover.teardown(),this.toggleActive(!1)},_onGifSearchPopoverSelectImage:function(e){var t,i,s,o,r,c,u,h=n.get(e,"postId"),d=n.get(e,"postBlogUuid"),p=this.get("resultImageWidth"),g=this.getName();n.isEmpty(h)||n.isEmpty(d)||(s=n.get(e,"mediaUrl",""),r=n.get(e,"width"),c=n.get(e,"height"),u=this.get("query"),o=s.replace(/_\d+\./,"_"+p+"."),t=l.createImagePostMessage(h,d,o,r,c,{context:g,loggingData:{query:u}}),i=new a({url:o,width:r,height:c,message:t,context:g,editCallback:n.bind(n.partial(this.onEdit,u,s),this),loggingData:{query:u,postId:h,postBlogUuid:d}}),this.addToImagePreview(i),this._closePopover())},_onGifSearchPopoverClose:function(){this._closePopover()}});e.exports=c},function(e,t,i){"use strict";var n=i(686),s=n.extend({tagName:"button",attributes:{"data-js-theme-accent-color-on-white":!0},afterRender:function(){this.listenTo(this,"change:isActive",this._onChangeIsActive),this.listenTo(this,"change:isDisabled",this._onChangeIsDisabled),this._onChangeIsActive(this,this.get("isActive")),this._onChangeIsDisabled(this,this.get("isDisabled"))},_onChangeIsActive:function(e,t){this.$el.toggleClass("active",t)},_onChangeIsDisabled:function(e,t){this.$el.prop("disabled",t)}});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(156),o=s.extend({defaults:{isDisabled:!1,isActive:!1},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults)))},getName:function(){return null},addToImagePreview:function(e){this.trigger("preview:add:image",e)},toggleActive:function(e){this.set("isActive",e)},toggleDisabled:function(e){this.set("isDisabled",e)}});e.exports=o},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+=""+(null==(__t=__("Add GIF"))?"":_.escape(__t));return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(114),s=n.extend({defaults:{message:null,url:null,width:null,height:null,editCallback:null}});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(685),r=i(205),a=i(186),l=i(187),c=i(688),u=i(690),h=o.extend({className:"conversation-compose-plugin conversation-compose-plugin--photo-upload",tagName:"div",template:u,mixins:[r],events:{"focus [data-js-file-picker]":"_onFilePickerFocus","change [data-js-file-picker]":"_onFilePickerChange","click [data-js-file-picker]":"_onFilePickerClick"},initialize:function(e){e=n.extend({},e)},_onFilePickerChange:function(e){var t,i=n.first(s(e.target).prop("files"));this.toggleActive(!1),n.get(i,"type","").match(/image\/(jpg|jpeg|png|gif)/i)&&l.read(i).then(n.bind(function(e){a.load(e.objectUrl||e.base64).then(n.bind(function(e){t=new c({url:e.src,width:e.width,height:e.height}),this.addToImagePreview(t),this.js$("file-picker").val("")},this))},this))},_onFilePickerClick:function(){this.toggleActive(!0)},_onFilePickerFocus:function(){this.toggleActive(!1)},_onChangeIsDisabled:function(e,t){this.js$("file-picker").prop("disabled",t)}});e.exports=h},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+=""+(null==(__t=__("Add Photo"))?"":_.escape(__t))+' <input type="file" class="input-file-picker" data-js-file-picker name="messaging-photo" accept="image/*" tabindex="-1">';
return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="messaging-conversation messaging-conversation--open" data-js-theme-background-tint data-js-conversation-open><div data-subview="headerView"></div><div class="conversation-main" data-js-theme-background-color data-js-main><div data-subview="messagesView"></div><div data-subview="conversationLoaderView"></div></div><div data-subview="previewView"></div><div data-subview="composeView"></div></div><div class="messaging-conversation messaging-conversation--minimized" data-js-conversation-minimized data-js-theme-accent-color data-js-theme-avatar-shape-class><div data-subview="minimizedView"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(114),s=n.extend({defaults:{channel:null},getChannel:function(){return this.get("channel")},setChannel:function(e){return this.set("channel",e)},getId:function(){return this.get("channel").get("uuid")},getPrevChannel:function(){return this.previous("channel")},getPrevProperty:function(e){var t=this.getPrevChannel();return t?t.get(e):null},getPrevId:function(){return this.getPrevProperty("uuid")}});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(119),o=i(601),r=i(594),a=s.extend({url:"/svc/conversations",mixins:[o],model:r,comparator:function(e){return-e.get("last_modified_ts")},_getRoot:function(e){return n.has(e,"response")?n.get(e,"response"):e},parse:function(e,t){return n.get(this._getRoot(e),"conversations")||[]},parsePreviousLink:function(e,t){return n.get(this._getRoot(e),"_links.previous")},parseNextLink:function(e,t){return n.get(this._getRoot(e),"_links.next")},fetchInbox:function(e,t){t=t||{};var i=n.extend({},t.data,{participant:e});return n.extend(t,{cache:!1,remove:!1,skipParseLinks:0!==this.length,data:i}),this.fetch(t)},getUnreadCount:function(){return n.reduce(this.models,function(e,t){return t.isUnread()?e+1:e},0)}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(119),o=i(695),r=s.extend({model:o,getSortedModels:function(e){return this.sortBy(function(t){return t.get("uuid")===e?-1:0})},getSortedIds:function(e){var t=this.getSortedModels(e);return n.pluck(n.invoke(t,"toJSON"),"uuid")}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(114),o=i(595),r=i(693),a=i(120),l=s.extend({idAttribute:"uuid",mixins:[o],relations:{conversations:r},defaults:{conversations:null,unread_messages_count_sum:0}});n.defaults(l.prototype,a.prototype),e.exports=l},function(e,t,i){"use strict";var n,s=i(9),o=i(144),r=i(697),a=i(698),l=o.extend({name:"footer",initialize:function(){this.createFooter()},createFooter:function(){s(".l-footer").length&&(this.footerView=new r({el:".l-footer"})),s(".sidebar_nav").length&&(this.sidebarFooterView=new a({el:".pinned_sidebar_footer"}))}});e.exports=function(){return n||(n=new l),n}},function(e,t,i){"use strict";var n=i(156),s=n.extend({});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(110),r=i(150).transition,a=s.extend({defaults:{fadeScrollDistance:2e3,visible:!0},initialize:function(){this.listenTo(o,"DOMEventor:flatscroll",this.onScroll),this.on("change:visible",this.toggleVisibility),this.$nav=this.$el.find(".sidebar_nav")},onScroll:function(e){e&&(e.windowScrollY>=this.get("fadeScrollDistance")?this.set("visible",!1):this.set("visible",!0))},toggleVisibility:function(e,t){t===!0?(this.showElement(),n.defer(n.bind(function(){this.$nav.toggleClass("visible",t)},this))):(r(this.$nav,n.bind(function(){this.hideElement()},this)),this.$nav.toggleClass("visible",t)),o.trigger("sidebarFooterVisibilityChange",t)},hideElement:function(){this.$el.css("display","none")},showElement:function(){this.$el.css("display","block")}});e.exports=a},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(110),r=i(144),a=i(700),l=i(703),c=i(106),u=r.extend({name:"peepr",params:"",initialize:function(){this.listenTo(o,"peepr-open-request",this.onPeeprRequest);var e=c.get("Components/Peepr")||{};this.params=e,e.blog_name&&(this.listenToOnce(o,"peepr:close",this.onPeeprClose),n(document).ready(s.bind(this.onPeeprRequestWithParams,this)))},onPeeprClose:function(){window.Backbone.history.navigate("/dashboard")},onPeeprRequestWithParams:function(){o.trigger("peepr-open-request",{tumblelog_name:this.params.blog_name,post_id:this.params.post_id})},onPeeprRequest:function(e){e.tumblelog_name&&this.open(e)},open:function(e){e.className="peepr-drawer",a().canOpen()&&(n("body").addClass("flag--peepr-redux"),a().open(l,e,"peepr-drawer-container"))}});e.exports=u},function(e,t,i){"use strict";var n,s=i(9),o=i(3),r=i(101),a=i(144),l=i(110),c=i(162),u=i(143),h=i(701),d=a.extend({name:"drawer",selector:"body",mixins:[c],defaults:{suspended:!1,needsCloseConfirmation:!1},keycommands:{"keydown:escape":"initiateClose"},initialize:function(){this.$glass=null,this.$container=s(this.container),this.bindEvents()},bindEvents:function(){this.listenTo(l,"post:form:show",this.suspend),this.listenTo(l,"post:form:hide",this.resume),this.listenTo(l,"drawer:suspend",this.suspend),this.listenTo(l,"drawer:resume",this.resume),this.listenTo(l,"drawer:enableCloseConfirmation",this.enableCloseConfirmation),this.listenTo(l,"drawer:disableCloseConfirmation",this.disableCloseConfirmation),this.listenTo(l,"drawer:hideGlass",this.hideGlass),this.listenTo(l,"indashblog:post:photo_lightbox",this.disableKeys),this.listenTo(l,"tumblr_lightbox:form:hide",this.enableKeys),this.$container.on("click.drawerOpen","[data-drawer-open]",o.bind(this.onClickOpen,this))},suspend:function(){this.set("suspended",!0)},resume:function(){this.set("suspended",!1)},enableCloseConfirmation:function(){this.set("needsCloseConfirmation",!0)},disableCloseConfirmation:function(){this.set("needsCloseConfirmation",!1)},canOpen:function(){return!this.get("suspended")&&!this.view},isSuspended:function(){return this.get("suspended")},isOpen:function(){return!!this.view},toggle:function(e,t){this.canOpen?this.open(e,t):this.close()},open:function(e,t,i){this.view=new h({subviews:{"drawer-content":{constructor:e,options:t||{}}}}),this.view.$el.addClass(i),this.showGlass(),l.trigger("keycommands:suspend"),l.trigger("toaster:suspend"),this.append(),this.trigger("open"),l.trigger("drawer:open")},replace:function(e,t,i){this.view?(this.view.animateRemove(),this.view=null,o.delay(o.bind(function(){this.view=new h({subviews:{"drawer-content":{constructor:e,options:t||{}}}}),this.view.$el.addClass(i),this.append()},this),400)):this.open(e,t,i)},onClickOpen:function(e){e.preventDefault();var t=s(e.currentTarget).attr("data-drawer-open");this.trigger("open:"+t),l.trigger("drawer:open:"+t)},initiateClose:function(){this.view&&!this.get("suspended")&&(this.get("needsCloseConfirmation")===!0?u.confirm(r("Close without sending?"),o.bind(this.close,this),this.noop,r("OK"),r("Cancel")):this.close())},close:function(){this.view&&(this.view.animateRemove(),this.view=null,this.hideGlass(),l.trigger("keycommands:resume"),l.trigger("toaster:resume"),this.trigger("close"),l.trigger("drawer:close"))},remove:function(){return this.close(),this},showGlass:function(){this.$glass=s("<div>",{"class":"ui_peepr_glass"}).appendTo(this.$container);var e=o.bind(function(){this.$container.addClass("peepr")},this);this.animationDelay=o.delay(e,50),this.$glass.on("click",o.bind(this.initiateClose,this))},hideGlass:function(){var e=this.$glass;this.$glass=null,this.$container.removeClass("peepr"),this.animationDelay&&clearTimeout(this.animationDelay),o.delay(function(){e.remove()},150)}});e.exports=function(){return n||(n=new d),n}},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(110),r=i(156),a=i(702),l=r.extend({template:a,className:"drawer",defaults:{visible:!1},initialize:function(e){e.subviews&&(this.$body=n("body"),this.bindEvents())},bindEvents:function(){this.listenTo(o,"DOMEventor:keydown:tab",this.disableKey)},afterRender:function(){this.show()},disableKey:function(e){var t=n(e.target).is("input");t||e.preventDefault()},show:function(){this.get("visible")||(this.set("visible",!0),this.toggleAnimation("open",!0))},hide:function(e){this.get("visible")?(this.set("visible",!1),this.toggleAnimation("open",!1),s.delay(e,500)):e()},toggleAnimation:function(e,t){var i=s.bind(function(){this.$el.toggleClass(e,t)},this);window.requestAnimationFrame?window.requestAnimationFrame(i):s.defer(i)},animateRemove:function(){return this.hide(s.bind(function(){this.remove()},this)),this}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+=""+(null==(__t=_subview("drawer-content"))?"":__t);return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(110),r=i(156),a=i(704),l=i(705),c=i(706),u=i(707),h=i(708),d=i(709),p=i(711),g=i(712),m=r.extend({template:c,subviews:{posts:{constructor:u},header:{constructor:h},bigLoader:{constructor:p}},initialize:function(e){this.$body=s("body"),this.options=e,this.loadCount=0,this.setCollection(),this.postKeycommandsView=new g({el:this.$el}),this.collection.fetch().then(n.bind(this.onFirstSync,this)),this.bindEvents(),o.trigger("peepr:open",{tumblelog_name:this.options.tumblelog_name,post_id:this.options.post_id,loggingData:{tumblelog_name:this.options.tumblelog_name,post_id:this.options.post_id}}),a.setup()},setCollection:function(){this.collection&&this.collection.stopListening(),this.collection=new d([],{blogNameOrId:this.options.tumblelog_name,postId:this.options.post_id}),this.listenTo(this.collection.tumblelog,"change:global_theme_params",this.setBkgColor),this.listenTo(this.collection,"error",this.onSyncError),n.each(this.subviews,function(e){e.options=n.defaults({collection:this.collection,editing_appearance:this.options.editing_appearance,searchTagTerm:this.options.searchTagTerm||""},e.options||{})},this)},bindEvents:function(){this.$el.scroll(this.onBodyScroll),this.listenTo(o,"peepr-open-request",this.onPeeprOpenRequest),this.listenTo(o,"peepr:like_update",this.onPostLike),this.listenTo(o,"peepr:follow_update",this.onHeaderFollow),this.listenTo(o,"indashblog:post:reblog",this.onLegacyReblog),this.listenTo(o,"indashblog:search:start indashblog:search:clear",this.scrollToPosts)},afterRender:function(){this.autoPager&&(this.autoPager.close(),this.autoPager=null),this.autoPager=new l({$target:this.$(".peepr-body")}),this.listenTo(this.autoPager,"trigger",n.throttle(this.onAutopagerTrigger,500,{trailing:!1})),document.activeElement.blur()},onAutopagerTrigger:function(){this.collection.fetchMore(),this.log("paginate",{postCount:this.collection.length})},onBodyScroll:function(e){var t={windowScrollTop:s(e.currentTarget).scrollTop()};window.requestAnimationFrame?requestAnimationFrame(function(){o.trigger("peepr-body-scroll",t)}):o.trigger("peepr-body-scroll",t)},onLegacyReblog:function(e){var t="POST_CONTEXT_PEEPR";e.reblog_key||(e.reblog_key=this.collection.get(e.id).get("reblog_key")),o.trigger("postForms:reblog",{reblogSource:t,reblogId:e.id,reblogKey:e.reblog_key,pt:e.pt}),this.listenToOnce(o,"postForms:saved",this.onPostFormReblogSuccess),this.log("peepr_reblog",{postId:e.id})},onPostFormReblogSuccess:function(e,t){this.log("peepr_reblog_success",{postId:t.responseJSON.post.id})},onPostLike:function(e,t){this.log("peepr_like_update",{postId:t.id,liked:t.liked})},onHeaderFollow:function(e){this.log("peepr_follow",{following:e})},onFirstSync:function(){this.rendered&&(this.bigLoader.hide(),this.$(".indash_blog").addClass("intro"),n.delay(n.bind(function(){this.rendered&&this.$(".indash_blog").removeClass("intro")},this),1e3),this.log(this.loadCount?"reload":"load"),this.loadCount++)},onPeeprOpenRequest:function(e){e.tumblelog_name&&(this.options=e,this.setCollection(),this.reload())},reload:function(){this.stopListening(this.autoPager),this.removeSubviews(),this.render(),this.collection.fetch().then(n.bind(this.onFirstSync,this))},setBkgColor:function(){var e=this.collection.tumblelog.get("global_theme_params")||{};n.has(e,"background_color")&&this.$(".peepr-body").css("background-color",e.background_color)},scrollToPosts:function(){this.headerScrollHeight=this.headerScrollHeight||this.$(".header_image_wrapper").height()-this.$(".navigation").height(),this.$el.scrollTop(this.headerScrollHeight)},onSyncError:function(){this.log("ajax-error",{offset:this.collection.length,path:window.location.href})},log:function(e,t){var i=n.defaults({blogname:this.options.tumblelog_name,postId:this.options.postId,loadCount:this.loadCount},t||{});o.trigger("peepr:log:"+e,{loggingData:{payload:i}})},remove:function(){this.log("close"),this.collection.stopListening(),this.postKeycommandsView&&this.postKeycommandsView.remove(),o.trigger("peepr:close",this.options.tumblelog_name,this.options.post_id),r.prototype.remove.call(this)}});e.exports=m},function(e,t,i){"use strict";var n,s=i(9),o=i(3),r=i(110),a=i(144),l=a.extend({name:"TrackingPixels",initialize:function(){this.listenTo(r,"component:TrackingPixels",this.initPixels)},initPixels:function(e){e.init&&o.each(e.init,function(e){e.script&&s("body").append(e.script)})}});e.exports={setup:function(){return n||(n=new l),n}}},function(e,t,i){"use strict";var n=i(110),s=i(3),o=i(7),r=i(145),a=i(109),l=r.extend({defaults:{offset:175,throttle:200,lockStep:!1,triggerCachingDelta:-1},constructor:function(e){this.options=s.extend({},this.defaults,e),this.handler=s.bind(this.options.$target?this.onTargetScroll:this.onWindowScroll,this),this.options.throttle&&(this.handler=s.throttle(this.handler,this.options.throttle)),this.locked=!1,this.bindEvents()},forceCheck:function(e){this.options.$target?this.handler(null,e):this.handler(a.rect(),e)},bindEvents:function(){this.options.$target?this.options.$target.parent().on("scroll",this.handler):(this.listenTo(n,"DOMEventor:flatscroll",this.handler),this.listenTo(n,"DOMEventor:flatresize",this.handler))},unlock:function(){this.locked=!1},onWindowScroll:function(e,t){if(!this.locked&&(this.buffer||(this.buffer=this.getBuffer(e)),this.nearBottom(e))){var i=s.clone(e);if(!t&&-1!==this.options.triggerCachingDelta&&this.triggerCache){var n=Math.abs(e.windowScrollTop-this.triggerCache.windowScrollTop);if(n<this.options.triggerCachingDelta)return}this.trigger("trigger"),this.options.lockStep&&(this.locked=!0),t||-1===this.options.triggerCachingDelta||(this.triggerCache=i)}},onTargetScroll:function(e,t){var i=this.options.$target.parent().height(),n=this.options.$target.outerHeight(),s=this.options.$target.position().top,o={windowScrollTop:-s,documentHeight:n,windowHeight:i};this.onWindowScroll(o,t)},getRemainingDocHeight:function(e){return e.documentHeight-e.windowScrollTop-e.windowHeight-this.buffer},getBuffer:function(e){var t=e.windowHeight;return s.isNull(t)?!1:Math.round(.666*t)},nearBottom:function(e){if(s.isNull(e.windowScrollTop))return!1;var t=this.options.offset,i=this.getRemainingDocHeight(e);return t>i},close:function(){this.options.$target&&this.options.$target.parent().off("scroll",this.handler)}});s.extend(l.prototype,o.Events),e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="peepr-body"><div class="indash_blog"><header data-subview="header" class="header"></header><main data-subview="posts" class="posts"></main></div></div><div data-subview="bigLoader"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(110),r=i(156),a=i(108),l=i(258),c=r.extend({className:"posts",initialize:function(){this.postViews=[],this.listenTo(o,"indashblog:post:photo_lightbox",this.onLightboxRequest),this.listenTo(this.collection,"sync",this.onCollectionSync),this.listenTo(this.collection,"reset",this.onCollectionReset),this.listenTo(this.collection,"request",this.onCollectionRequest),this.listenTo(this.collection,"add",this.renderPost),this.listenTo(o,"DOMEventor:flatresize",this.setMinHeight),this.listenTo(o,"indashblog:search:results-end",this.onSearchResultsEnd)},render:function(){return this.loader=new l,this.$el.append(this.loader.render().$el),this.setMinHeight(),this},renderWithTemplate:n.noop,setMinHeight:function(){var e=s(window).height();this.navHeight=this.navHeight||s(".peepr-body .navigation").height()+s(".peepr-body .info_wrapper").height(),this.$el.css("min-height",e-this.navHeight+"px")},renderPost:function(e){if(!a.bool("one_true_post")){var t=new window.Tumblr.IndashBlog.PostView({model:e});this.postViews.push(t),this.$(".knight-rider-container").before(t.render().el),n.defer(n.bind(function(){this.make_tags_draggable()},t))}},onSearchResultsEnd:function(e){e&&(this.searchResultsEndView=e,this.$(".knight-rider-container").before(this.searchResultsEndView.render().$el))},onCollectionReset:function(){this.searchResultsEndView&&this.searchResultsEndView.remove(),this.collection.length?this.collection.each(this.renderPost,this):(n.each(this.postViews,function(e){e.remove()}),this.postViews=[])},onCollectionRequest:function(){this.loader.set("loading",!0)},onCollectionSync:function(){this.loader.set("loading",!1)},onLightboxRequest:function(e){var t=e.post,i=t.get("photos"),s=e.photosetIndex||0,r=[];n.each(i,function(e){r.push({width:e.original_size.width,height:e.original_size.height,low_res:e.alt_sizes[0].url,high_res:e.original_size.url})}),o.trigger("lightbox-open-request",r,s)}});e.exports=c},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(110),r=i(156),a=i(106),l=i(570),c=r.extend({renderWithTemplate:n.noop,className:"header",initialize:function(e){this.options=e,this.listenToOnce(this.collection,"sync",this.insertHeader)},insertHeader:function(){this.header=new window.Tumblr.IndashBlog.HeaderView({model:this.collection.tumblelog,el:this.$el,is_peepr:!0,show_share_controls:!0,show_follow_button:!0,show_user_controls:!0,show_dismiss_controls:!1,on_customize_open:n.bind(this.renderAllFontStyles,this)}).render(),this.setupHeader()},setupHeader:function(){var e=this.collection.tumblelog.get("global_theme_params").title_font;this.renderSingleFontStyle(e),this.$(".navigation").width(this.$el.width()||585),o.trigger("indashblog:ready-animation-start"),this.options.editing_appearance&&this.header.start_customizing(),this.options.searchTagTerm&&o.trigger("peeprsearch:change:term",{term:this.options.searchTagTerm})},renderAllFontStyles:function(){n.each(l,function(e){this.appendFontToHead(e)},this)},renderSingleFontStyle:function(e){var t=n.result(l,e);t&&this.appendFontToHead(t)},appendFontToHead:function(e){var t=a.get("Context/hosts/assets_host")||"",i="webfont_"+e.path;if(e.path&&!s("head #"+i).length){var o=t+"/fonts/"+e.path+"/stylesheet.css";o+=n.has(e,"_v")?"?v="+e._v:"",s("<link>",{id:i,rel:"stylesheet",type:"text/css",href:o}).appendTo(s("head"))}},remove:function(){this.header&&this.header.remove(),r.prototype.remove.call(this)}});e.exports=c},function(e,t,i){"use strict";var n=i(3),s=i(110),o=i(276),s=i(110),r=i(119),a=i(710),l=r.extend({model:o,url:"/svc/indash_blog/posts",blogNameOrId:"",_hasFetchedEverything:!1,initialize:function(e,t){this.loading=!1,this.tumblelog=new a,t=t||{},this.blogNameOrId=t.blogNameOrId,this.postId=t.postId,t.url&&(this.url=t.url),this.listenTo(s,"indashblog:post:like",this.likePostbyId),this.bindBlogSearchEvents()},bindBlogSearchEvents:function(){this.listenTo(s,"indashblog:search:start",this.blogSearchStarted),this.listenTo(s,"indashblog:search:complete",this.blogSearchCompleted),this.listenTo(s,"indashblog:search:post-added",this.blogSearchPostAdded),this.listenTo(s,"indashblog:search:results-end",this.blogSearchResultsEnd),this.listenTo(s,"indashblog:search:clear",this.blogSearchClear)},blogSearchStarted:function(){this.searchMode=!0,this.reset(),this.trigger("request",this),this.loading=!0,s.trigger("indashblog:search:fetch-requested")},blogSearchPostAdded:function(e){this.add(e)},blogSearchCompleted:function(e){this.reset(e),this.trigger("sync",this),this.loading=!1},blogSearchResultsEnd:function(e){this._hasFetchedEverything=!0,this.loading=!1,this.trigger("sync",this)},blogSearchClear:function(){this.searchMode=!1,this.reset(),this.trigger("request",this),this.fetch()},fetch:function(e){return this.loading?void 0:this.searchMode?(this.trigger("request",this),void s.trigger("indashblog:search:fetch-requested",e)):(e=e||{},e.blogNameOrId&&(this.blogNameOrId=e.blogNameOrId),e.data={tumblelog_name_or_id:this.blogNameOrId,post_id:this.postId||null,limit:this.postId?1:e.limit||10,offset:e.offset||0},this.loading=!0,r.prototype.fetch.call(this,e))},fetchMore:function(e){if(e=e||{},!this.hasFetchedEverything()&&!this.loading){if(this.searchMode)return this.trigger("request",this),void s.trigger("indashblog:search:fetch-requested",e);var t=this.models.length;return this.postId&&(t-=1,this.postId=null),e=n.extend({offset:t,remove:!1},e),this.fetch(e)}},parse:function(e,t){return(!e.response.posts.length||e.response.posts.length<t.data.limit)&&(this._hasFetchedEverything=!0),e.response.tumblelog&&this.tumblelog.set(e.response.tumblelog),e.response.tracking_html&&!n.isEmpty(e.response.tracking_html)&&s.trigger("component:TrackingPixels",{init:e.response.tracking_html}),this.loading=!1,e.response.posts},reset:function(){this._hasFetchedEverything=!1,r.prototype.reset.apply(this,arguments)},hasFetchedEverything:function(){return this._hasFetchedEverything},likePostbyId:function(e,t){var i=this.get(e);i&&(t=t||"mouse",i.like(t),s.trigger("peepr:like_update",i.get("tumblelog"),i.toJSON()))}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(120),o=i(110),r=i(114),a=i(570),l=r.extend({url:"/svc/indash_blog/header",initialize:function(e,t){t=t||{},this.listenTo(this,"change",this.onModelChange)},onModelChange:function(e){this.tumblelog=this.tumblelog||new s({name:this.get("name")}),this.tumblelog_name_or_id=this.get("name");var t=this.tumblelog.get("following");if(!n.isUndefined(t)&&this.get("following")!==t){var i={source:this.get("following")?"FOLLOW_SOURCE_PEEPR_HEADER":"UNFOLLOW_SOURCE_PEEPR_HEADER"};this.tumblelog.save_following({following:this.get("following")},i),o.trigger("peepr:follow_update",this.get("following"))}if(e.hasChanged("following")){var r={can_subscribe:e.get("following")};e.get("following")||(r.is_subscribed=!1),this.set(r)}this.tumblelog.set(this.toJSON())},get_theme_param:function(e){var t=this.get("global_theme_params")||{};return t[e]},set_theme_params:function(e){var t=n.clone(this.get("global_theme_params"));this.set("global_theme_params",n.extend({},t,e))},fetch:function(e){e=e||{},e.data={tumblelog_name_or_id:e.tumblelog_name_or_id||this.get("name")},r.prototype.fetch.call(this,e)},save:function(e,t){var i=n.extend({},this.defaults,e);return i.global_theme_params=n.omit(i.global_theme_params,["header_image_dimens","header_image_focused"]),t=t||{},t.contentType="application/json",t.data=JSON.stringify({tumblelog_name_or_id:this.get("name"),tumblelog:i}),t.with_form_key=!0,r.prototype.save.call(this,e,t)},getAvailableFonts:function(){return a}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(258),r=s.extend({renderWithTemplate:n.noop,className:"peepr-big-loader",initialize:function(e){this.options=n.defaults({},e),this.loader=new o,this.loader.set("loading",this.options.loading)},render:function(){this.$el.append(this.loader.render().$el)},toggle:function(e){this.options.loading=e,this.loader.set("loading",e),this.$el.toggleClass("hidden",!e)},show:function(){this.toggle(!0)},hide:function(){this.toggle(!1)}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(110),r=i(162),a=i(149),l=a.extend({mixins:[r],keycommands:{"keydown:j":"scrollToNextItem","keydown:k":"scrollToPrevItem","keydown:l":"like","keydown:r":"reblog","keydown:s":"share","keydown:period":"ttt","keydown:enter":"openBlog"},defaults:{selector:".post",scrollOffset:60,speed:200},initialize:function(e){this.options=n.defaults(e||{},this.defaults),this.listenTo(o,"post:form:show indashblog:keycommands:suspend",this.disableKeys),this.listenTo(o,"post:form:hide indashblog:keycommands:resume",this.enableKeys),this.listenTo(o,"keycommands:resume",this.onDashboardKeycommandsResume),this.listenTo(o,"drawer:close",this.resumeDashboardKeycommands)},onDashboardKeycommandsResume:function(){o.trigger("keycommands:suspend")},resumeDashboardKeycommands:function(){this.stopListening(o,"keycommands:resume"),o.trigger("keycommands:resume")},indexPageableItems:function(){var e={};this.currentPosition=this.getScrollOffset(),this.goToPosition=0,this.$(this.options.selector).each(function(t){var i=s(this);e[t]=Math.round(i.position().top)}),this.positions=e},getScrollOffset:function(){return this.$el.scrollTop()},like:function(){var e=this.findPostId();e&&o.trigger("indashblog:post:like",e,"keyboard")},reblog:function(){var e=this.findPostId();e&&o.trigger("indashblog:post:reblog",{id:e},"keyboard")},share:function(){var e=this.$(".post[data-post-id="+this.findPostId()+"] [data-subview=messaging]");n.isEmpty(e)||1!==e.length||e.get(0).click()},ttt:function(){this.goToPosition=1,this.$el.stop().animate({scrollTop:0},this.options.speed,n.bind(function(){this.animating=!1},this))},openBlog:function(){var e=this.$("[data-post-id="+this.findPostId()+"] .reblog_info.post_info_link");e.length&&o.trigger("peepr-open-request",{url:e.attr("href"),tumblelog_name:e.data("tumblelog-name")})},scrollToNextItem:function(){this.indexPageableItems(),this.nextPosition(),o.trigger("keycommands:jk",{loggingData:{source:"peepr"}})},scrollToPrevItem:function(){this.indexPageableItems(),this.previousPosition(),o.trigger("keycommands:jk",{loggingData:{source:"peepr"}})},nextPosition:function(){for(var e in this.positions){var t=this.positions[e];t>this.currentPosition+this.options.scrollOffset&&(t<this.goToPosition||!this.goToPosition)&&(this.goToPosition=t)}this.animate()},previousPosition:function(){for(var e in this.positions){var t=this.positions[e];t<this.currentPosition-this.options.scrollOffset&&t>this.goToPosition&&(this.goToPosition=t)}this.animate()},animate:function(){this.goToPosition&&!this.animating&&(this.animating=!0,this.$el.stop().animate({scrollTop:this.goToPosition-this.options.scrollOffset},this.options.speed,n.bind(function(){this.animating=!1},this)))},findPostId:function(){if(this.goToPosition-this.options.scrollOffset===this.getScrollOffset()){var e=n.invert(this.positions)[this.goToPosition];if(e){var t=this.$(this.options.selector).get(e);if(t)return s(t).data("post-id")}}return!1}});e.exports=l},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(144),r=i(101),a=i(178),l=i(110),c=i(530),u=i(531),h=i(714),d=i(716),p=o.extend({name:"AskComponent",initialize:function(e){e=e||{},this.user=e.user,this.user&&(this.blog=this.user.getChannel(),this.question=new d({recipient:null,anonymous:!1,question:""}),this.listenTo(l,"ask:form:open",this.presentAskForm),this.listenTo(this.question,"save:success",this.onSaveSuccess))},presentAskForm:function(e){return this.askFormView?this:(this.question.set("recipient",e.recipient),n("body").addClass("postforms-open"),l.trigger("drawer:suspend"),l.trigger("keycommands:suspend"),this.glass=new c,this.modal=new u,this.askFormView=new h({model:this.question,characterLimit:500,recipient:{name:e.recipient,allowAnonymous:e.allow_anonymous},sender:this.blog}),this.askFormView.render(),this.modal.setContentSubView(this.askFormView),this.glass.render().$el.appendTo("body"),this.modal.render().$el.appendTo("body"),this.glass.show().then(s.bind(this.modal.show,this.modal)),this.listenTo(this.askFormView,"close",this.dismissAskForm),this.listenTo(this.askFormView,"submit",this.submit),this)},beforeRemove:function(){this.dismissAskForm()},dismissAskForm:function(){this.askFormView&&(this.stopListening(this.askFormView),this.modal.hide(),this.modal.remove(),this.modal=null,this.glass.hide(),this.glass.remove(),this.glass=null,this.askFormView.remove(),this.askFormView=null,l.trigger("keycommands:resume"),l.trigger("drawer:resume"),l.trigger("ask:form:hidden"),n("body").removeClass("postforms-open"))},submit:function(e){this.question.set("anonymous",!!e.anonymous),this.question.set("question",e.question),this.question.save()},onSaveSuccess:function(){l.trigger("ask:form:success"),this.dismissAskForm(),s.delay(s.bind(this.toastSuccess,this,{recipient:this.question.get("recipient"),avatar:this.question.get("anonymous")?"https://secure.assets.tumblr.com/images/anonymous_avatar_64.gif":a(this.blog.get("avatar_url"))(64)}),350)},toastSuccess:function(e){var t=r("Question sent to %1$s",e.recipient),i={type:"image_text",message:"<strong>"+t+" </strong>",is_link:!1,href:"#",img1:{url:e.avatar,is_link:!1,href:"#"}};l.trigger("toaster:toast",i)}});e.exports=p},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(178),r=i(156),a=i(162),l=i(205),c=i(715),u=r.extend({className:"ask-form",template:c,mixins:[a,l],keycommands:{"keydown:enter":"preventNewlines","keydown:escape":"dismiss"},events:{"click button.close":"dismiss","change .ask-anonymously-switch":"toggleAnonymous","submit form":"submit","input .ask-question":"onTextAreaUpdate"},initialize:function(e){this.characterLimit=e.characterLimit,this.sender=e.sender,this.recipient=e.recipient,this.onTextAreaUpdate=s.throttle(s.bind(this.onTextAreaUpdate,this),100),this.listenTo(this.model,"change:isSaving",this.toggleSubmit),this.listenTo(this.model,"save:success",this.render),this.listenTo(this.model,"save:error",this.displayErrors)},getTemplateData:function(){var e={};return e.recipient=s.clone(this.recipient)||{},e.recipient.allow_anonymous=e.recipient.allowAnonymous,e.sender=this.sender.toJSON(),e.sender.avatar_url=o(this.sender.get("avatar_url"))(128),e.character_limit=this.characterLimit,e},dismiss:function(){this.trigger("close")},toggleSubmit:function(e,t){t?this.disableSubmit():this.enableSubmit()},toggleAnonymous:function(e){var t=this.$(e.target);this.isAnonymous=t.prop("checked");var i=this.$$(".post_avatar_link"),n=this.$$(".ask-from .tumblelog_name"),s=this.$$(".ask-from .anonymous");this.isAnonymous?(i.removeClass("use_blog_avatar"),n.hide(),s.show()):(i.addClass("use_blog_avatar"),n.show(),s.hide())},submit:function(e){e.preventDefault(),this.trigger("submit",{question:this.$$(".ask-question").val(),anonymous:this.isAnonymous})},preventNewlines:function(e){e.preventDefault()},onTextAreaUpdate:function(){var e=this.$$(".ask-question").val(),t=e;e.match(/\n/g)&&(e=e.replace(/\n/g,""));var i=s.trim(e).length;i>0&&i<=this.characterLimit?this.enableSubmit():this.disableSubmit(),e!==t&&this.$$(".ask-question").val(e);var n=this.characterLimit-e.length,o=this.$$(".ask-character-count");o.text(n),100>=n?(o.addClass("active"),o.removeClass("count-ok count-warning count-danger"),n>40?o.addClass("count-ok"):n>20?o.addClass("count-warning"):o.addClass("count-danger")):o.removeClass("active")},enableSubmit:function(){this.model.get("isSaving")||this.$$(".ask-button").prop("disabled",!1)},disableSubmit:function(){this.$$(".ask-button").prop("disabled",!0)},showMessages:function(e,t){var i=this.$$("."+e),o=i.get(0);o&&(i.removeClass("active").hide().empty(),"string"==typeof t&&(t=[t]),s.each(t,s.bind(function(e){var t=n("<li/>",{text:e});i.append(t)},this)),i.show(),s.defer(function(){i.addClass("active")}))},displayErrors:function(e){this.showMessages("errors-ask",e)}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;
with(obj||{}){__p+='<div class="post_form_wrapper v_center_el"><div class="post_avatar"><a class="post_avatar_link use_blog_avatar animating" data-user-avatar-url="'+(null==(__t=sender.avatar_url)?"":_.escape(__t))+'" data-avatar-url="'+(null==(__t=sender.avatar_url)?"":_.escape(__t))+'" data-blog-url="'+(null==(__t=sender.blog_url)?"":_.escape(__t))+'"><span class="post_avatar_link blog_avatar anonymous" data-anonymous-avatar-url="/images/anonymous_avatar_64.gif" style="background-image: url(/images/anonymous_avatar_64.gif)"></span><span class="post_avatar_link blog_avatar new" style="background-image: url('+(null==(__t=sender.avatar_url)?"":_.escape(__t))+')"></span></a></div><div class="post-container"><form enctype="multipart/form-data" class="active"><div class="post-container-inner post post-form--asks"><div class="post-form--header"><div class="controls-container"> ';var senderMarkup='<span class="ask-from"><span class="tumblelog_name">'+sender.name+'</span><span class="anonymous">'+__("anonymous")+"</span></span>",recipientMarkup='<span class="ask-recipient-label">'+recipient.name+"</span>";if(__p+=" "+(null==(__t=__('%1$s <span class="ask-to-label">to</span> %2$s',senderMarkup,recipientMarkup))?"":__t)+' <span class="ask-character-count"></span></div></div><div class="post-form--form post-content-text"><textarea class="ask-question" name="question" placeholder="'+(null==(__t=__("Ask me anything"))?"":_.escape(__t))+'" maxlength="'+(null==(__t=character_limit)?"":_.escape(__t))+'" autofocus></textarea></div><div class="post-form--bottom"><div class="post-form--controls"><div class="controls-container"><div class="control left"><button type="button" class="chrome flat close">'+(null==(__t=__("Close"))?"":_.escape(__t))+"</button></div> ",recipient.allow_anonymous){__p+=' <div class="control right"><div class="ask-anonymously"> ';var randId=Math.floor(1e6*Math.random());__p+=' <label class="binary_switch"><input id="ask_anonymously_switch_'+(null==(__t=randId)?"":_.escape(__t))+'" class="ask-anonymously-switch" type="checkbox" name="anonymous" value="1"> <span class="binary_switch_track"></span><span class="binary_switch_button"></span></label><label class="ask-anonymously-label" for="ask_anonymously_switch_'+(null==(__t=randId)?"":_.escape(__t))+'">'+(null==(__t=__("Ask anonymously"))?"":_.escape(__t))+"</label></div></div> "}__p+=' <div class="control right"><button class="chrome blue ask-button" type="submit" disabled="disabled">'+(null==(__t=__("Ask"))?"":_.escape(__t))+'</button></div></div></div><ul class="post-form--error-bar messages errors-ask"></ul></div></div></form></div></div>'}return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(114),s=i(3),o=i(101),r=n.extend({urlRoot:"/svc/post/ask",validate:function(e){return s.trim(e.question)?this.isUrl(e.question)?{error:o("Sorry, but please don't include links in questions.")}:void 0:{error:o("You need to enter a question!")}},isUrl:function(e){return!!(e.match(/(http|https):\/\//i)||e.match(/www\./i)||e.match(/[a-zA-Z0-9]+(\.arpa|\.root|\.aero|\.biz|\.cat|\.com|\.coop|\.edu|\.gov|\.info|\.int|\.jobs|\.mil|\.mobi|\.museum|\.name|\.net|\.org|\.pro|\.travel|TLD|\.ac|\.ad|\.ae|\.af|\.ag|\.ai|\.al|\.am|\.an|\.ao|\.aq|\.ar|\.as|\.at|\.au|\.aw|\.ax|\.az|\.ba|\.bb|\.bd|\.be|\.bf|\.bg|\.bh|\.bi|\.bj|\.bm|\.bn|\.bo|\.br|\.bs|\.bt|\.bv|\.bw|\.by|\.bz|\.ca|\.cc|\.cd|\.cf|\.cg|\.ch|\.ci|\.ck|\.cl|\.cm|\.cn|\.co|\.cr|\.cu|\.cv|\.cx|\.cy|\.cz|\.de|\.dj|\.dk|\.dm|\.do|\.dz|\.ec|\.ee|\.eg|\.er|\.es|\.et|\.eu|\.fi|\.fj|\.fk|\.fm|\.fo|\.fr|\.ga|\.gb|\.gd|\.ge|\.gf|\.gg|\.gh|\.gi|\.gl|\.gm|\.gn|\.gp|\.gq|\.gr|\.gs|\.gt|\.gu|\.gw|\.gy|\.hk|\.hm|\.hn|\.hr|\.ht|\.hu|\.id|\.ie|\.il|\.im|\.in|\.io|\.iq|\.ir|\.is|\.it|\.je|\.jm|\.jo|\.jp|\.ke|\.kg|\.kh|\.ki|\.km|\.kn|\.kr|\.kw|\.ky|\.kz|\.la|\.lb|\.lc|\.li|\.lk|\.lr|\.ls|\.lt|\.lu|\.lv|\.ly|\.ma|\.mc|\.md|\.mg|\.mh|\.mk|\.ml|\.mm|\.mn|\.mo|\.mp|\.mq|\.mr|\.ms|\.mt|\.mu|\.mv|\.mw|\.mx|\.my|\.mz|\.na|\.nc|\.ne|\.nf|\.ng|\.ni|\.nl|\.no|\.np|\.nr|\.nu|\.nz|\.om|\.pa|\.pe|\.pf|\.pg|\.ph|\.pk|\.pl|\.pm|\.pn|\.pr|\.ps|\.pt|\.pw|\.py|\.qa|\.re|\.ro|\.ru|\.rw|\.sa|\.sb|\.sc|\.sd|\.se|\.sg|\.sh|\.si|\.sj|\.sk|\.sl|\.sm|\.sn|\.so|\.sr|\.st|\.su|\.sv|\.sy|\.sz|\.tc|\.td|\.tf|\.tg|\.th|\.tj|\.tk|\.tl|\.tm|\.tn|\.to|\.tp|\.tr|\.tt|\.tv|\.tw|\.tz|\.ua|\.ug|\.uk|\.um|\.us|\.uy|\.uz|\.va|\.vc|\.ve|\.vg|\.vi|\.vn|\.vu|\.wf|\.ws|\.ye|\.yt|\.yu|\.za|\.zm|\.zw)/i))},save:function(e,t){t=t||{};var i=t.success,o=t.error;t.success=s.bind(function(e,t){if(s.isEmpty(s.result(t.response,"errors")))this.trigger("save:success"),i&&i.call(null,e,t);else{var n=t.response.errors[0];this.trigger("save:error",n),o&&o.call(null,e,n)}this.set("isSaving",!1)},this),t.error=s.bind(function(e,t){this.trigger("save:error",t),o&&o.call(null,e,t)},this),this.set("isSaving",!0);var r=n.prototype.save.call(this,e,t);!r&&this.validationError&&(this.trigger("save:error",this.validationError.error),this.set("isSaving",!1))}});e.exports=r},function(e,t,i){"use strict";var n=i(144),s=i(718),o=n.extend({name:"MobileNav",autoAppend:!0,view:function(){return this.data?new s(this.data):void 0}});e.exports=o},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(149),r=i(110),a=i(109),l=i(108),c=i(204),u=i(160),h=i(719),d=i(720),p=i(728),g=i(738),m=o.extend({className:"mobile-header",mixins:[c,u],template:h,defaults:{logged_in:!1},initialize:function(e){e=s.extend({},e),s.extend(this.attributes,s.pick(e,s.keys(this.defaults))),this.subViews.logoTitle=new d(e),this.subViews.navMenu=new p(e),l.bool("mobile_web_sticky_header")&&this.setSticky(),l.bool("mobile_web_search")&&(this.subViews.search=new g(e))},render:function(){return this.$el.html(this.template()),this.attachSubViews(),this},setSticky:function(){n("body").addClass("sticky-header"),this.lastPosition=a.rect().windowScrollTop,this.listenTo(r,"DOMEventor:flatscroll",this.getScrollDirection)},getScrollDirection:function(e){e.windowScrollTop>45?s.delay(s.bind(function(){this.$el.addClass("sticky")},this),500):this.$el.removeClass("sticky"),this.lastPosition<e.windowScrollTop&&e.windowScrollTop>45?this.$el.addClass("hide-nav"):this.$el.removeClass("hide-nav"),this.lastPosition=e.windowScrollTop}});e.exports=m},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="navMenu"></div><div data-subview="logoTitle"></div><div data-subview="search"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(108),r=i(204),a=i(160),l=i(721),c=i(722),u=i(724),h=i(726),d=s.extend({className:"nav-logo-title",mixins:[r,a],template:l,initialize:function(e){e=n.extend({},e),n.extend(this.attributes,e),this.subViews.logo=new c,o.bool("mobile_web_page_titles")&&this.get("page_title")&&this.get("logged_in")&&!this.get("search_term")?(this.subViews.pageTitle=new u(e),this.set("show_page_title",!0)):this.set("show_page_title",!1),o.bool("mobile_web_search")?(this.set("show_search_field",!!this.get("search_term")),this.subViews.searchField=new h(e)):this.set("show_search_field",!1)},render:function(){return this.$el.html(this.template(this.toJSON())),this.attachSubViews(),this}});e.exports=d},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="mobile-logo-wrapper',show_page_title&&(__p+=" show-page-title "),__p+=" ",!_.isUndefined(show_search_field)&&show_search_field&&(__p+=" show-search-field "),__p+='"><div data-subview="logo"></div><div data-subview="pageTitle"></div><div data-subview="searchField"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(149),s=i(723),o=n.extend({template:s,className:"mobile-logo",render:function(){return this.$el.html(this.template()),this}});e.exports=o},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<a href="/" class="logo-link"><svg class="tumblr-svg-t" width="29px" height="39px" viewBox="0 0 29 39" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g class="t-logo" id="Dashboard" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path class="large-shadow" d="M21.9956664,26.3 L21.9956664,19.0055544 L27.9954227,19.0055542 L27.9954227,13.0048828 L27.9954227,11.0108643 L23.522766,11.0108643 L23.5540067,11.6669807 L23.7388305,15.5486452 L17.6832886,15.4792482 L17.4,24 C17.5,26.3 18.8,26.5 19.8,26.5 C20.2,26.5 21.4956664,26.4 21.9956664,26.3 Z M18.7154541,4.00225829 L17.4,2.9 L17.4,8 L22.000122,7.34490957 L22.000122,4.00225829 L18.7154541,4.00225829 Z M24.3,29.6 L24.9,31.5 C23.8,32.9 21,34 18.4,34 L18.1,34 C16.3,34 14.8,33.7 13.6,33.2 C15,35.4 17.5999998,38.0021971 21.7999998,38.0021971 C21.7999996,38.6099361 22.0022113,38.0021971 22.0999998,38.0021971 C24.6999998,38.0021971 27.4,36.1 28.6,34.7 L26.7,28.8 C26,29.2 25.1,29.5 24.3,29.6 Z" id="Shape" opacity="0.5" fill="#000000"></path><path class="inner" d="M18.5,33.6 L18.3,33.6 C11.1,33.6 9,28.2005493 9,25.0005493 L9,15 C8.58245849,15 4.99298096,15 5,15 L4.99298096,10.0285034 C4.99298096,9.92850342 5.1,9.9 5.2,9.9 C8.9,8.5 11.3,6.7 11.9,2.3 C11.8,2 12,2 12,2 L16.8,2 L17,2 L17,9.00006104 L23.012207,9.00006104 L23.012207,15 L17,15 L17,24.0839844 C17,26.1839844 17.8,27.3 19.8,27.3 C20.6,27.3 21.5,27.1 22.4,26.8 C22.5,26.8 22.6,26.8 22.6,26.9 L24.1,31.3 L24.1,31.7 C23,32.8 20.7,33.6 18.5,33.6 Z"></path><path class="outer" d="M26.1,32.2 L26.3,31.9 L23.9,25.1 C23.9,25 23.8,25 23.8,25 L19.2,25 C19.1,25 19,25.1 19,25 C18.9,24.8 19,24.4 19,24.1 L19,17 L25,17 L25,7 C25,7 19,7 19,7 L19,0 L8,0 C7.3,0 6.4,0.8 6.3,1.8 C5.8,5.9 4.1,7.5 0.5,8.7 L0.1,8.8 C0,8.9 0,8.9 0,9 L0,17.0000006 C0,17.1000006 0.1,17 0.1,17 L4,17 L4,24.8 C4,31.8 8.46560059,36.0067139 17.3656006,36.0067139 C22.0656006,36.0067139 25,33.7 26.1,32.2 Z M18.5,33.6 L18.3,33.6 C11.1,33.6 9,28.2005493 9,25.0005493 L9,15 C8.58245849,15 4.99298096,15 5,15 L4.99298096,10.0285034 C4.99298096,9.92850342 5.1,9.9 5.2,9.9 C8.9,8.5 11.3,6.7 11.9,2.3 C11.8,2 12,2 12,2 L16.8,2 L17,2 L17,9.00006104 L23.012207,9.00006104 L23.012207,15 L17,15 L17,24.0839844 C17,26.1839844 17.8,27.3 19.8,27.3 C20.6,27.3 21.5,27.1 22.4,26.8 C22.5,26.8 22.6,26.8 22.6,26.9 L24.1,31.3 L24.1,31.7 C23,32.8 20.7,33.6 18.5,33.6 Z"></path><path class="small-shadow" d="M4,19 L7,19 L7,17.0833333 C7,17 6.9,17 6.9,17 L4,17 L4,19 L4,19 Z" opacity="0.5" fill="#37465D"></path></g></svg> </a>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(725),a=s.extend({template:r,className:"page-title",mixins:[o],initialize:function(e){e=n.extend({},e),n.extend(this.attributes,e)},render:function(){return this.$el.html(this.template(this.toJSON())),this}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+=""+(null==(__t=page_title)?"":_.escape(__t));return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(110),r=i(160),a=i(727),l=i(390),c=s.extend({template:a,className:"search-field",mixins:[r],events:{"submit form":"__submitForm"},__submitForm:function(){this.toggleLoader(!0)},__handleSearchClick:function(){var e=this.$searchInput.val();this.$el.hasClass("search-term-exists")?e===this.get("search_term")?this.setFocus():this.$submitForm.trigger("submit"):!e&&this.$mobileLogoWrapper.hasClass("show-search-field")?this.hideSearchField():e&&this.$mobileLogoWrapper.hasClass("show-search-field")?this.$submitForm.trigger("submit"):this.showSearchField()},__handleNsfwFilterClick:function(e){this.$searchNsfwFilterInput.val(e),this.$submitForm.prop("action","/search/"+this.get("search_term")),this.$searchInput.prop("name",""),this.$submitForm.trigger("submit")},__handleFilterChange:function(e){var t="top";"CREATED_DESC"===e.get("sort")&&(t="recent");var i=e.get("post_type").toLowerCase();this.$searchFilterSortInput.val(t),this.$searchFilterPostTypeInput.val(i),this.$searchNsfwFilterInput.val(e.get("filter_nsfw")),this.$submitForm.prop("action","/search/"+this.get("search_term")),this.$searchInput.prop("name",""),this.$submitForm.trigger("submit")},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,e),this.listenTo(o,"mobileHeader:search:click",this.__handleSearchClick),this.listenTo(o,"mobileHeader:nsfw:update",this.__handleNsfwFilterClick),this.listenTo(o,"mobileHeader:filter:update",this.__handleFilterChange),this.listenTo(o,"drawer:open",this.hideSearchField)},render:function(){return this.get("search_term")&&this.$el.addClass("search-term-exists"),this.$el.html(this.template(this.toJSON())),this.$searchInput=this.$(".search-input"),this.$searchNsfwFilterInput=this.$(".search-nsfw-filter-input"),this.$searchFilterSortInput=this.$(".filter-sort-input"),this.$searchFilterPostTypeInput=this.$(".filter-post-type-input"),this.$submitForm=this.$("form"),this.$mobileLogoWrapper=this.$el.parent(),this},toggleLoader:function(e){e?this.loader?this.loader.set("loading",!0):this.loader=new l({$container:this.$el,type:"bar",classModifiers:"top",loading:!0}):this.loader.set("loading",!1)},showSearchField:function(){this.$mobileLogoWrapper.addClass("show-search-field"),n.delay(n.bind(this.setFocus,this),250)},hideSearchField:function(){this.$searchInput.blur(),this.$mobileLogoWrapper.removeClass("show-search-field")},setFocus:function(){var e=2*this.$searchInput.val().length;this.$searchInput.focus(),this.$searchInput.get(0).setSelectionRange(e,e)}});e.exports=c},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<form action="/search" method="get"><input type="text" placeholder="'+(null==(__t=__("Search Tumblr"))?"":_.escape(__t))+'" autocomplete="off" class="search-input" id="search-input" name="q" value="',search_term&&(__p+=""+(null==(__t=search_term)?"":_.escape(__t))),__p+='"> <input type="hidden" class="search-nsfw-filter-input" name="filter_nsfw"> <input type="hidden" class="filter-sort-input" name="sort" value="top"> <input type="hidden" class="filter-post-type-input" name="filter_post_type" value="any"> '+(null==(__t=_subview("loader"))?"":__t)+" </form>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(149),r=i(204),a=i(160),l=i(110),c=i(729),u=i(730),h=i(736),d=o.extend({className:"nav-menu",template:c,mixins:[r,a],events:{"click .menu-burger":"__clickMenuBurger","click [data-subnav]":"__clickSubnav","click .sneeze-guard":"__clickSneezeGuard"},__clickSneezeGuard:function(e){e.preventDefault(),this.closeDrawer()},__clickSubnav:function(e){e.preventDefault(),this.openSubNav(s(e.currentTarget).data("subnav"))},__clickMenuBurger:function(e){e.preventDefault(),this.toggleDrawer()},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,e),this.get("drawer_open")&&this.openDrawer(),this.get("logged_in")?this.subViews.drawer=new u(e):this.subViews.drawer=new h(e),this.listenTo(l,"mobileHeader:search:click",this.closeDrawer)},render:function(){return this.$el.html(this.template()),this.$body=s("body"),this.$html=s("html"),this.attachSubViews(),this},toggleDrawer:function(){this.$el.hasClass("subnav-active")?this.closeSubNav():this.get("drawer_open")?this.closeDrawer():this.openDrawer()},openDrawer:function(){this.set("drawer_open",!0),this.$body.addClass("nav-drawer-open"),this.$html.addClass("nav-drawer-open"),this.$el.addClass("active"),l.trigger("drawer:open")},closeDrawer:function(){this.set("drawer_open",!1),this.$body.removeClass("nav-drawer-open"),this.$html.removeClass("nav-drawer-open"),this.$el.removeClass("active subnav-active"),l.trigger("drawer:closed")},openSubNav:function(e){this.$el.addClass("subnav-active"),l.trigger("drawer:subnav:open",e)},closeSubNav:function(){this.$el.removeClass("subnav-active"),l.trigger("drawer:subnav:close")}});e.exports=d},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="menu-burger"><div class="burger bun top"></div><div class="burger patty"></div><div class="burger bun bottom"></div></div><div class="drawer" data-subview="drawer"></div><div class="sneeze-guard"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(204),a=i(731),l=i(732),c=i(734),u=s.extend({template:a,mixins:[r,o],className:"drawer logged-in",initialize:function(e){e=n.extend({},e),n.extend(this.attributes,e),this.subViews.primaryNav=new l(e),this.subViews.secondaryNav=new c(e)},render:function(){return this.$el.html(this.template(this.toJSON())),this.attachSubViews(),this}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="nav-wrapper"><div data-subview="primaryNav"></div><div data-subview="secondaryNav"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(733),a=s.extend({template:r,mixins:[o],className:"primary-nav",initialize:function(e){e=n.extend({},e),n.extend(this.attributes,e)},render:function(){return this.$el.html(this.template(this.toJSON())),this}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<nav class="nav-site-sections"><a href="/dashboard" class="nav-item with-icon"><span class="nav-text nav-item-dashboard">'+(null==(__t=__("Dashboard"))?"":_.escape(__t))+'</span></a><a href="/likes" class="nav-item with-icon"><span class="nav-count">',parseInt(likes,10)>0&&(__p+=""+(null==(__t=likes)?"":_.escape(__t))),__p+=' </span><span class="nav-text nav-item-likes">'+(null==(__t=__("Likes"))?"":_.escape(__t))+'</span></a><a href="/following" class="nav-item with-icon"><span class="nav-count">'+(null==(__t=following)?"":_.escape(__t))+'</span><span class="nav-text nav-item-following">'+(null==(__t=__("Following"))?"":_.escape(__t))+'</span></a><a href="/settings" class="nav-item with-icon" data-subnav="settings"><span class="nav-text nav-item-settings has-subnav">'+(null==(__t=__("Settings"))?"":_.escape(__t))+'</span></a><a href="'+(null==(__t=url_prefix)?"":_.escape(__t))+'/new/text" class="nav-item with-icon"><span class="nav-text nav-item-create-post">'+(null==(__t=__("Create a post"))?"":_.escape(__t))+'</span></a></nav><nav class="nav-blog-list"><span class="nav-section-title">'+(null==(__t=__("Blogs"))?"":_.escape(__t))+"</span> ",_.each(blogs,function(e){__p+=' <a href="'+(null==(__t=e.url)?"":_.escape(__t))+'" class="nav-item"><img src="'+(null==(__t=e.avatar)?"":_.escape(__t))+'" class="blog-avatar"><div class="blog-name-wrapper"><span class="blog-name">'+(null==(__t=e.name)?"":_.escape(__t))+'</span><span class="blog-title">'+(null==(__t=e.safe_title)?"":__t)+"</span></div></a> "}),__p+=" </nav>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(110),a=s.extend({mixins:[o],className:"secondary-nav",templates:{settings:i(735)},_getTemplate:function(e){return"settings"===e?this.templates.settings(this.toJSON()):void 0},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,e),this.listenTo(r,"drawer:subnav:open",this.render)},render:function(e){return e&&this.$el.html(this._getTemplate(e)),this}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<nav class="nav-site-sections"><a href="/settings/password" class="nav-item"><span class="nav-text">'+(null==(__t=__("Change Password"))?"":_.escape(__t))+'</span></a><a href="/settings/tfa" class="nav-item"><span class="nav-text">'+(null==(__t=__("Two Factor Authentication"))?"":_.escape(__t))+'</span></a><a href="/help" class="nav-item"><span class="nav-text">'+(null==(__t=__("Help"))?"":_.escape(__t))+'</span></a><a href="/settings/account" class="nav-item" target="_blank"><span class="nav-text desktop-view">'+(null==(__t=__("Account"))?"":_.escape(__t))+'</span></a><a href="/settings/notifications" class="nav-item" target="_blank"><span class="nav-text desktop-view">'+(null==(__t=__("Notifications"))?"":_.escape(__t))+'</span></a><a href="/settings/apps" class="nav-item" target="_blank"><span class="nav-text desktop-view">'+(null==(__t=__("Apps"))?"":_.escape(__t))+"</span></a></nav>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(160),r=i(110),a=i(737),l=s.extend({template:a,mixins:[o],className:"drawer logged-out",initialize:function(e){e=n.extend({},e),n.extend(this.attributes,e),this.listenToOnce(r,"drawer:open",this.downloadBackground)},downloadBackground:function(){var e=new Image,t=this.$splashBg.data("img-src");e.onload=n.bind(function(){this.$splashBg.css("background-image","url("+t+")"),this.$splashBg.addClass("loaded")},this),e.src=t},render:function(){return this.$el.html(this.template(this.toJSON())),this.$splashBg=this.$(".splash-bg"),this}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="splash-bg" data-img-src="'+(null==(__t=splash.image)?"":_.escape(__t))+'"></div><div class="splash-sections"><div class="splash-section top"><a href="/login" class="splash-login">'+(null==(__t=__("Log in"))?"":_.escape(__t))+'</a></div><div class="splash-section middle"><div class="middle-inner"><span class="splash-pitch">'+(null==(__t=__("Splash headline"))?"":_.escape(__t))+'</span><a href="/register" class="signin tx-button blue">'+(null==(__t=__("Get started"))?"":_.escape(__t))+"</a> ",has_app&&(__p+='<a href="'+(null==(__t=app_url)?"":_.escape(__t))+'" class="tx-button get-the-app">'+(null==(__t=__("Get the app"))?"":_.escape(__t))+"</a>"),__p+=' </div></div><div class="splash-section bottom"><a href="'+(null==(__t=splash.url)?"":_.escape(__t))+'" target="_blank" rel="nofollow" class="splash-avatar" style="background-image:url('+(null==(__t=splash.avatar)?"":_.escape(__t))+')"></a><a href="'+(null==(__t=splash.url)?"":_.escape(__t))+'" target="_blank" rel="nofollow" class="splash-name">'+(null==(__t=__("Posted by"))?"":_.escape(__t))+"&nbsp;<strong>"+(null==(__t=splash.name)?"":_.escape(__t))+"</strong></a></div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(110),o=i(149),r=i(204),a=i(160),l=i(108),c=i(739),u=i(740),h=i(742),d=i(744),p=i(749),g=o.extend({className:"nav-search",mixins:[r,a],template:c,defaults:{show_filter_icon:!1},events:{"click .toggle-nsfw-filter":"__lockIconClick","click .search-label":"__searchLabelClick"},__lockIconClick:function(){this.set("filter_nsfw",!this.get("filter_nsfw")),this.lockIconUpdate(),s.trigger("mobileHeader:nsfw:update",this.get("filter_nsfw"))},__searchLabelClick:function(){s.trigger("mobileHeader:search:click")},lockIconUpdate:function(){this.get("filter_nsfw")?this.lockIconUpdateEnable():this.lockIconUpdateDisable()},lockIconUpdateDisable:function(){this.set("filter_nsfw",!1),this.$el.removeClass("nsfw-filter-on"),this.$el.addClass("nsfw-filter-off")},lockIconUpdateEnable:function(){this.set("filter_nsfw",!0),this.$el.removeClass("nsfw-filter-off"),this.$el.addClass("nsfw-filter-on")},togglePopover:function(){this.popover||(this.popover=new d({pinnedTarget:this.subViews.filterIcon.$el,model:this.model}),this.popover.render(),this.listenTo(this.popover,"close",this.onPopoverClose))},onPopoverClose:function(){n.defer(n.bind(function(){this.popover=null},this))},__filterIconClick:function(){this.togglePopover()},onFilterChange:function(e){s.trigger("mobileHeader:filter:update",e),this.popover.hide()},bindEvents:function(){this.model&&(this.listenTo(this.model,"change:sort",this.onFilterChange),this.listenTo(this.model,"change:post_type",this.onFilterChange),this.listenTo(this.model,"change:filter_nsfw",this.onFilterChange)),this.events["click .toggle-filter"]="__filterIconClick"},initialize:function(e){this.subViews.lockIcon=new u,e=n.extend({},e),n.extend(this.attributes,e),l.bool("mobile_web_search_filter")&&this.get("logged_in")&&(this.subViews.filterIcon=new h,this.set("show_filter_icon",!0),this.model=new p({showOriginalPostsSwitch:!1,showNsfwSwitch:!0,sort:this.get("filter_sort").toUpperCase(),post_type:this.get("filter_post_type").toUpperCase(),filter_nsfw:this.get("filter_nsfw")}),this.bindEvents())},render:function(){return this.lockIconUpdate(),this.$el.html(this.template(this.toJSON())),this.attachSubViews(),this},teardown:function(){this.popover&&this.popover.teardown()}});e.exports=g},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+="",__p+=show_filter_icon?' <span class="toggle-filter"></span><div data-subview="filterIcon"></div><div data-subview="filters"></div> ':' <span class="toggle-nsfw-filter"></span><div data-subview="lockIcon"></div> ',__p+=' <span class="search-label" for="search-input"></span>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(149),s=i(741),o=n.extend({template:s,className:"lock-icon",render:function(){return this.$el.html(this.template()),this}});e.exports=o},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<svg width="19px" height="22px" viewBox="0 0 26 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"><path class="top-open" d="M13,10.0178223 L13,6.87965469 C13,6.06618011 12.84,2.7245838 14.527,1.44641061 C15.998,-0.143241692 17.454,0.00292164862 19.602,0.00392966862 C21.465,0.00292164862 23.022,0.163197309 24.209,1.44641061 C25.399,2.73063194 26,4.966427 26,6.87965469 L26,10.0178223 L23,10.0178223 L23,7.11103029 C23,6.27883295 22.983076,5.4231481 22.7865717,4.7089045 C22.6847765,4.3389045 22.5347899,4.00686105 22.314,3.73570197 C21.664,2.94225222 20.538,2.65089839 19.602,2.65089839 C19.4989445,2.65089839 19.3929679,2.65441527 19.2850939,2.66172851 C18.4111108,2.72097959 17.4125863,3.02942637 16.834,3.73570197 C16.189,4.53260651 16,5.84772931 16,7.11103029 L16,10.0178223 L13,10.0178223 Z" fill="#000000" sketch:type="MSShapeGroup"></path><path class="top-closed" d="M3,10.0178223 L3,6.87965469 C3,6.06618011 2.84,2.7245838 4.527,1.44641061 C5.998,-0.143241692 7.454,0.00292164862 9.602,0.00392966862 C11.465,0.00292164862 13.022,0.163197309 14.209,1.44641061 C15.399,2.73063194 16,4.966427 16,6.87965469 L16,10.0178223 L13,10.0178223 L13,7.11103029 C13,6.27883295 12.983076,5.4231481 12.7865717,4.7089045 C12.6847765,4.3389045 12.5347899,4.00686105 12.314,3.73570197 C11.664,2.94225222 10.538,2.65089839 9.602,2.65089839 C9.49894451,2.65089839 9.39296788,2.65441527 9.28509392,2.66172851 C8.41111079,2.72097959 7.41258628,3.02942637 6.834,3.73570197 C6.189,4.53260651 6,5.84772931 6,7.11103029 L6,10.0178223 L3,10.0178223 Z" fill="#000000" sketch:type="MSShapeGroup"></path><path d="M3,10.0178223 L1,10.0845369 C0.421,10.2438046 0,10.6084343 0,11.0882532 L0,20.991977 C0,21.4707879 0.527,22 1,22 L18,22 C18.476,22 19,20.9597202 19,20.9597202 L19,11.0882532 C19,10.0802302 18.475,10.0178223 18,10.0178223 L16,10.0178223 L3,10.0178223 Z" fill="#000000" sketch:type="MSShapeGroup"></path></g></svg>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(156),s=i(743),o=n.extend({template:s,className:"filter-icon",render:function(){return this.$el.html(this.template()),this}});e.exports=o},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<i class="icon_filter"></i>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(745),s=i(747),o=n.extend({className:n.prototype.className+" blog-search-filters-popover",Subview:s});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(150).transition,r=i(212),a=i(204),l=i(211),c=i(162),u=i(746),h=s.extend({className:"popover--blog-search",mixins:[a,l,c],template:u,keycommands:{"keydown:down":"targetNextLi","keydown:tab":"targetNextLi","keydown:up":"targetPrevLi","keydown:shift+tab":"targetPrevLi","keyup:enter":"selectLi"},defaults:{keycommands:!1,keyboardFocusClass:"keyboard_focus"},initialize:function(e){return this.options=n.defaults(e,this.defaults),this.Subview?(this.subview=new this.Subview(e),void this.bindEvents()):void this.remove()},render:function(){return this.$el.html(this.template()),this.$(".popover_inner").append(this.subview.render().$el),this.$main=this.$el.find(".popover"),n.delay(n.bind(function(){this.$main.addClass("popover--active"),this.bindClickOutside()},this),1),this},bindEvents:function(){this.listenTo(this.subview,"remove",this.hide),this.options.keycommands||this.disableKeys()},bindClickOutside:function(){this._popoverBase.autoTeardown&&(this.clickOutside=new r(this.el),this.clickOutside.on("click:outside",this.hide,this))},unbindClickOutside:function(){this.clickOutside&&(this.clickOutside.remove(),this.clickOutside=null)},targetNextLi:function(e){e.preventDefault(),this.$active?(this.$active.removeClass(this.options.keyboardFocusClass),this.$active=this.$active.next().length?this.$active.next():this.$(".popover_menu_item").first()):this.$active=this.$(".popover_menu_item").first(),this.$active.addClass(this.options.keyboardFocusClass),this.scrollToActive()},targetPrevLi:function(e){e.preventDefault(),this.$active?(this.$active.removeClass(this.options.keyboardFocusClass),this.$active=this.$active.prev().length?this.$active.prev():this.$(".popover_menu_item").last()):this.$active=this.$(".popover_menu_item").last(),this.$active.addClass(this.options.keyboardFocusClass),this.scrollToActive()},selectLi:function(){this.$active&&this.trigger("itemSelected",this.$active)},scrollToActive:function(){this.$scrollable=this.$scrollable||this.$(".popover_inner"),this.$scrollable.scrollTop(this.$scrollable.scrollTop()+this.$active.position().top-this.$scrollable.height()+this.$active.outerHeight())},hide:function(){this.$main.removeClass("popover--active"),this.unbindClickOutside(),
o(this.$el,n.bind(function(){this.subview.remove(),this.remove(),this.teardown()},this))}});e.exports=h},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="popover popover_menu popover_gradient"><div class="popover_inner"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=i(156),o=i(748),r=s.extend({template:o,events:{"click [data-filter]":"onFilterClick","click .sort_filter.toggle":"onToggleFilterClick","click .option-radio":"onCheckboxClick","change [type=checkbox]":"onCheckboxChange"},initialize:function(){this.bindEvents()},afterRender:function(){this.onPostTypeChange(),this.onSortChange(),this.onPostRoleChange(),this.onFilterNsfwChange()},bindEvents:function(){this.listenTo(this.model,"change:sort",this.onSortChange),this.listenTo(this.model,"change:post_type",this.onPostTypeChange),this.listenTo(this.model,"change:post_role",this.onPostRoleChange),this.listenTo(this.model,"change:filter_nsfw",this.onFilterNsfwChange)},onPostRoleChange:function(){this.$("#post_role").prop("checked",this.model.get("post_role")!==this.model.defaults.post_role)},onPostTypeChange:function(){this.$(".post_type_filter.active").removeClass("active"),this.$('[data-filter="post_type:'+this.model.get("post_type")+'"]').addClass("active")},onFilterNsfwChange:function(){this.$(".search-nsfw-filter-checkbox-input").prop("checked",this.model.get("filter_nsfw")!==this.model.defaults.filter_nsfw)},onSortChange:function(){this.$(".sort_filter.active").removeClass("active"),this.$('[data-filter="sort:'+this.model.get("sort")+'"]').addClass("active")},onFilterClick:function(e){var t=n(e.currentTarget).data("filter").split(":");this.model.set(t[0],t[1])},onCheckboxChange:function(e){var t=n(e.currentTarget),i=e.currentTarget.id,s=t.data("value"),o=t.prop("checked");this.model.set(i,o?s:this.model.defaults[i])},onCheckboxClick:function(e){e.stopPropagation()},onToggleFilterClick:function(e){var t=n(e.currentTarget).find("[type=checkbox]"),i=t.prop("checked");t.prop("checked",!i).trigger("change")}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<ul class="popover_inner_list search_filter_items"><li class="popover_menu_item sort_filter" data-filter="sort:POPULARITY_DESC"><span class="popover_menu_item_anchor"><i class="icon icon_checkmark"></i> '+(null==(__t=__("Top Posts"))?"":_.escape(__t))+' </span></li><li class="popover_menu_item sort_filter" data-filter="sort:CREATED_DESC"><span class="popover_menu_item_anchor"><i class="icon icon_checkmark"></i> '+(null==(__t=__("Recent Posts"))?"":_.escape(__t))+" </span></li></ul> ",model.showOriginalPostsSwitch&&(__p+=' <ul class="popover_inner_list search_filter_items"><li class="popover_menu_item sort_filter toggle"><span class="popover_menu_item_anchor"></span><div class="option-radio"><label class="binary_switch"><input type="checkbox" name="post_role" id="post_role" data-value="ORIGINAL"> <span class="binary_switch_track"></span><span class="binary_switch_button"></span></label></div> '+(null==(__t=__("Original Posts"))?"":_.escape(__t))+" </li></ul> "),__p+=' <ul class="popover_inner_list search_filter_items"><li class="popover_menu_item post_type_filter" data-filter="post_type:ANY"><span class="popover_menu_item_anchor"><i class="icon icon_checkmark"></i> '+(null==(__t=__("All Types"))?"":_.escape(__t))+' </span></li><li class="popover_menu_item post_type_filter post_text_filter" data-filter="post_type:TEXT"><span class="popover_menu_item_anchor"><i class="icon icon_checkmark"></i><i class="icon post_type_icon icon_post_text_small"></i> '+(null==(__t=__("Text"))?"":_.escape(__t))+' </span></li><li class="popover_menu_item post_type_filter post_photo_filter" data-filter="post_type:PHOTO"><span class="popover_menu_item_anchor"><i class="icon icon_checkmark"></i><i class="icon post_type_icon icon_post_photo_small"></i> '+(null==(__t=__("Photo"))?"":_.escape(__t))+' </span></li><li class="popover_menu_item post_type_filter post_quote_filter" data-filter="post_type:QUOTE"><span class="popover_menu_item_anchor"><i class="icon icon_checkmark"></i><i class="icon post_type_icon icon_post_quote_small"></i> '+(null==(__t=__("Quote"))?"":_.escape(__t))+' </span></li><li class="popover_menu_item post_type_filter post_link_filter" data-filter="post_type:LINK"><span class="popover_menu_item_anchor"><i class="icon icon_checkmark"></i><i class="icon post_type_icon icon_post_link_small"></i> '+(null==(__t=__("Link"))?"":_.escape(__t))+' </span></li><li class="popover_menu_item post_type_filter post_chat_filter" data-filter="post_type:CHAT"><span class="popover_menu_item_anchor"><i class="icon icon_checkmark"></i><i class="icon post_type_icon icon_post_chat_small"></i> '+(null==(__t=__("Chat"))?"":_.escape(__t))+' </span></li><li class="popover_menu_item post_type_filter post_audio_filter" data-filter="post_type:AUDIO"><span class="popover_menu_item_anchor"><i class="icon icon_checkmark"></i><i class="icon post_type_icon icon_post_audio_small"></i> '+(null==(__t=__("Audio"))?"":_.escape(__t))+' </span></li><li class="popover_menu_item post_type_filter post_video_filter" data-filter="post_type:VIDEO"><span class="popover_menu_item_anchor"><i class="icon icon_checkmark"></i><i class="icon post_type_icon icon_post_video_small"></i> '+(null==(__t=__("Video"))?"":_.escape(__t))+" </span></li></ul> ",model.showNsfwSwitch&&(__p+=' <ul class="popover_inner_list search_filter_items"><li class="popover_menu_item sort_filter toggle"><span class="popover_menu_item_anchor"></span><div class="option-radio"><label class="binary_switch"><input type="checkbox" name="filter_nsfw" id="filter_nsfw" data-value="true" class="search-nsfw-filter-checkbox-input"> <span class="binary_switch_track"></span><span class="binary_switch_button"></span></label></div> '+(null==(__t=__("Safe search"))?"":_.escape(__t))+" </li></ul> "),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(110),o=i(114),r=i(119),a=o.extend({urlRoot:"/svc/search/blog_search",defaults:{next_offset:0,limit:10,sort:"CREATED_DESC",post_type:"ANY",term:"",unsetTerm:"",post_role:"ANY",filter_nsfw:!1,showOriginalPostsSwitch:!0,showNsfwSwitch:!1},initialize:function(){this.listenTo(this,"change:unsetTerm",this.onUnsetTermChange),this.listenTo(s,"peeprsearch:change:term",this.onTermSelect),this.listenTo(this,"change:term change:sort change:post_type change:post_role",this.resetSearch),this.posts=new r},resetSearch:function(){this.set(n.pick(this.defaults,["limit","next_offset"])),this.posts.reset(),this.trigger("search:reset")},reset:function(){this.posts.reset(),this.set(this.defaults),this.trigger("reset")},url:function(){return this.urlRoot+"/"+this.get("blogname")+"/"+this.get("term")},onTermSelect:function(e){this.search(e.term)},onUnsetTermChange:function(){s.trigger("peeprsearch:change:unsetTerm",{term:this.get("unsetTerm")})},search:function(e){e=e||this.get("unsetTerm"),e.length&&this.set("term",e)},fetch:function(){this.get("next_offset")<0||o.prototype.fetch.apply(this,arguments)},parse:function(e){return this.posts.length?n.each(e.response.posts,function(e){this.posts.add(e)},this):this.posts.reset(e.response.posts),delete e.response.posts,e.response},sync:function(e,t,i){"read"===e&&(i.data=this.pick("next_offset","limit","sort","post_type","post_role","filter_nsfw")),o.prototype.sync.apply(this,arguments)}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(751),o=s.extend({logKey:"dashboard_embed",logOptions:{init_event:!1},events:{"/^post:((?:un)?docked)$/":"handleEvent","post:embed:stateChange":"logStateChange"},handleEvent:function(e,t){var i=n.extend({},t);i.postData&&(i.post_id=i.postData.id,i.tumblelog=i.postData.tumblelog,delete i.postData),this.log(e,i)},logStateChange:function(e,t){if(!n.isEmpty(t)&&t.state&&t.postID&&t.service){if("tumblr"===t.service)return;this.log(t.state,{service:t.service,post_id:t.postID})}}});e.exports=o},function(e,t,i){"use strict";var n=i(7),s=i(3),o=i(145),r=i(110),a=i(103),l=[];l.push(i(752));var c=/^\/(.+)\/([gimy]*)$/,u=o.extend({constructor:function(){this._eventHandlers=[],this.setupEndpoints(),this.initialize();var e=s.result(this,"events")||{};s.forEach(e,this._addEventHandlerByString,this);var t=s.result(this,"eventBus");this.listenTo(t,"all",this._handleEvent),a.log("LogLady","[instrument]",this.logKey)},logSpots:l,eventBus:r,_addEventHandlerByString:function(e,t){var i,n=t.match(c);if(n){var s=new RegExp(n[1],n[2]);i=function(e){var t=e.match(s);if(t){for(var i=new Array(t.length-1),n=0;n<t.length;n+=1)n>0&&(i[n-1]=t[n]);return i}}}else if("*"===t[t.length-1]){var o=t.substring(0,t.length-1);i=function(e){var t=e.indexOf(o);return 0===t?[e.substring(o.length,e.length)]:void 0}}else i=function(e){return e===t?[e]:null};this._addEventHandler(e,i)},_addEventHandler:function(e,t){this._eventHandlers.push({method:e,matcher:t})},_handleEvent:function(e,t){for(var i,n,o,r=this._eventHandlers.length-1;r>=0;r--)i=this._eventHandlers[r],o=i.callback||this[i.method],o&&(n=i.matcher.call(this,e,t),s.isArray(n)&&(t&&t.loggingData&&n.push(s.cloneDeep(t.loggingData)),o.apply(this,n)))},setupEndpoints:function(){var e=s.result(this,"logSpots");this.loggers=s(e).map(function(e){return e(this)},this).compact().value()},initialize:s.noop,log:function(){for(var e=this.loggers.length-1;e>=0;e--){var t=this.loggers[e];t.trigger.apply(t,arguments)}}},{start:function(){return this._setupInstance||(this._setupInstance=new this),this._setupInstance}});s.extend(u.prototype,n.Events),e.exports=u},function(e,t,i){"use strict";function n(e){var t=s.result(e,"logKey"),i=s.result(e,"logEnv");if(t){var n=s.result(e,"logOptions")||{};return i&&(n.env=i),o.log(t,n)}}var s=i(3),o=i(753);e.exports=n},function(e,t,i){"use strict";var n=i(754),s=i(755),o=i(766),r=new s({EventClass:o,event_payload_name:"payload",event_filter:function(){return!0},endpoint:function(){return(n.get("secureWWW")||"")+"/services/cslog"}});e.exports=r},function(e,t,i){"use strict";function n(e){s||(s=r.get("Context/hosts"));var t=o.snakeCase(e);return o.endsWith(t,"_host")||(t+="_host"),o.get(s,t)}var s,o=i(3),r=i(106),a={get:o.memoize(n)};e.exports=a},function(e,t,i){"use strict";function n(e){this.watching={},this.pending_events=[],this.endpoint=e.endpoint,e.event_payload_name&&(this.event_payload_name=e.event_payload_name),e.event_filter&&(this.event_filter=e.event_filter),e.payload_formatter&&(this.payload_formatter=e.payload_formatter),s.bindAll(this,"_flush_from_timeout"),this._flush_from_timeout();var t=e.EventClass||f;this.Log=m.extend({EventClass:t}),o(window).on("beforeunload.log_lady",s.bind(this._flush_on_unload,this)),this.set_flush_rate()}var s=i(3),o=i(9),r=i(7),a=(i(103),i(108)),l=i(756),c=l.getRealNow,u=i(757),h=i(758),d=i(759),p=[].slice,g=i(760),m=i(762),f=i(765),v=1e3;s.extend(n.prototype,r.Events,{initialize:s.noop,defaults:{flush_rate:15*v},min_flush_rate:function(){var e=s.map(this.watching,function(e){return s.result(e,"flush_rate")});return e.push(this.defaults.flush_rate),s.min(e)},set_flush_rate:function(e){return e&&(this.defaults.flush_rate=e),this.flush_rate=this.min_flush_rate(),this.flush_is_overdue()&&this._flush_from_timeout(),this.flush_rate},flush:function(){var e=s.result(this,"endpoint"),t=this.build_payload();return!e||t[this.event_payload_name].length<1||!a.bool("log_lady")?void 0:(d(e,t,!this.unloading),this.last_flush_at=c(),!0)},_flush_on_unload:function(){this._flush_timeout&&clearTimeout(this._flush_timeout),this._trigger_unloads(),this.unloading=!0,this.flush()},_trigger_unloads:function(){var e;for(var t in this.watching)e=this.watching[t],"function"==typeof e.unloaded&&e.unloaded()},_flush_from_timeout:function(){this._flush_timeout&&clearTimeout(this._flush_timeout);var e=this.flush();e!==!1&&(this._flush_timeout=setTimeout(this._flush_from_timeout,this.flush_rate))},flush_is_overdue:function(){this.last_flush_at||(this.last_flush_at=c());var e=c()-this.last_flush_at;return e>this.flush_rate},watch:function(){var e,t,i,n=p.apply(arguments);for(i=0;i<n.length;i++)e=n[i],this.is_valid(e)&&(e.log_lady=this,this.watching[e.log_key]&&(t=this.watching[e.log_key],t&&s.isFunction(t.replaced)&&t.replaced(e)),this.watching[e.log_key]=e);return this.set_flush_rate(),this},unwatch:function(e){this.watching[e.log_key]&&e&&s.isFunction(e.replaced)&&e.replaced(),delete this.watching[e.log_key]},pending_log_events:function(){var e=this.pending_events;return this.pending_events=[],e},event_payload_name:"payload",payload_formatter:function(e){return e},event_filter:function(){return!0},build_payload:function(){var e=s.merge({},this.watching,[this]),t=s(e).collect(function(e){return e.pending_log_events()}).flatten().filter(this.event_filter).collect(s.bind(function(e){return e.json},this)).value(),i={};return i[this.event_payload_name]=this.payload_formatter(t),i},is_valid:function(e){var t=!!e;return t&&(t=s.result(e,"log_key")),t&&(t=s.result(e,"uuid")),t&&(t=s.isFunction(e.pending_log_events)),t},log:function(e,t){if(e){if(!(e in this.watching)){t&&t.log_key&&console.warn("log key gets overridden by log name");var i=g("keys",e);t=s.extend({},i,t,{log_key:e});var n=new this.Log(t);this.watch(n)}return this.watching[e]}},new_uuid:h}),n.extend=u,n.Log=m,e.exports=n},function(e,t,i){"use strict";function n(e){return(e||a())-a.realStartedAt}var s=i(3),o=i(106),r=s.once(function(){return o.get("Context/time")}),a=s.get(window,"Tumblr.getRealNow");if(!a){var l=window.performance,c=l&&l.timing&&l.timing.responseStart||Date.now();a=function(){return r()+(Date.now()-c)},a.startedAt=(new Date).getTime(),a.realStartedAt=a()}e.exports={getRealNow:a,startedAt:a.startedAt,realStartedAt:a.realStartedAt,getElapsed:n}},function(e,t,i){"use strict";function n(e,t){var i,n=this;i=e&&s.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},s.extend(i,n,t);var o=function(){this.constructor=i};return o.prototype=n.prototype,i.prototype=new o,e.defaults&&(s.extend(i.prototype.defaults,e.defaults),delete e.defaults),e&&s.extend(i.prototype,e),i.__super__=n.prototype,i}var s=i(3);e.exports=n},function(e,t){"use strict";function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"===e?t:3&t|8;return i.toString(16)})}e.exports=i},function(e,t,i){"use strict";function n(e,t,i){return!!r.ajax({url:e,type:"POST",data:JSON.stringify(t),contentType:"text/plain",async:i})}function s(e,t,i){var s=window.navigator.sendBeacon(e,JSON.stringify(t));return s||(s=n(e,t,i)),s}var o,r=i(9);o=window.navigator&&window.navigator.sendBeacon?s:n,e.exports=o},function(e,t,i){"use strict";function n(){for(var e,t=r.apply(arguments),i=o,n=0;n<t.length;n++){if(e=t[n],!i||!s.has(i,e))return null;i=i[e]}return i}var s=i(3),o=i(761),r=[].slice;e.exports=n},function(e,t,i){"use strict";var n,s=i(106),o=function(){return n||(n=s.get("Components/LogLady")),n};e.exports=o()},function(e,t,i){"use strict";function n(e,t){e.uuid?(t=e,e=t.uuid):t||!e||s.isString(e)||(t=e,e=void 0),this.options=s.extend({},this.defaults,t),delete this.options.log_key,delete this.options.env,delete this.options.uuid,l(this,"uuid",e||this._generate_uuid()),t.env||(t.env={}),s.each(t.flags,function(e){t.env.flags||(t.env.flags={}),t.env.flags[e]=r.bool(e)}),l(this,"env",t.env),this.log_key=t.log_key||this.log_key,this.events=[],this.event_count=0,this.pending_events=[],this.event_counts={},this.started_at||(this.started_at=this.options.started_at||a.getRealNow()),delete this.options.started_at,this.initialize(t),this.options.init_event&&this.trigger("init")}var s=i(3),o=i(7),r=i(108),a=i(756),l=i(763),c=i(757),u=i(758),h=i(760),d=i(765);s.extend(n.prototype,o.Events,{EventClass:d,initialize:s.noop,_generate_uuid:function(){return h("default_session")||u()},defaults:{init_event:!0,keep_counts:!1},pending_log_events:function(){var e=this.pending_events;return this.pending_events=[],e},generate_relative_id:function(){return this.event_count},unloaded:function(e){e||(e={}),e=this.before_unloaded(e)||{},this.options.keep_counts&&s.extend(e,{event_counts:this.event_counts}),s.isEmpty(e)||this.trigger("unload",e)},before_unloaded:function(e){return e},replaced:function(e){this.before_replaced(e);for(var t=this.pending_log_events();t.length;)this.log_lady.pending_events.push(t.shift())},before_replaced:s.noop,stop:function(){this.log_lady&&this.log_lady.unwatch(this)},trigger:function(e,t){var i=new this.EventClass(this,e,t);return this.options.keep_counts&&"init"!==e&&"unload"!==e&&(this.event_counts[e]||(this.event_counts[e]=0),this.event_counts[e]++),this.event_count+=1,this.pending_events.push(i),o.Events.trigger.call(this,e,i,this),this}}),n.extend=c,e.exports=n},function(e,t,i){"use strict";function n(e,t,i){s.isObject(i)&&o(i),Object.defineProperty(e,t,{value:i,writeable:!1,enumerable:!0,configurable:!1})}var s=i(3),o=i(764);e.exports=n},function(e,t){"use strict";function i(e){var t,n;Object.freeze(e);for(n in e)t=e[n],e.hasOwnProperty(n)&&null!==t&&"object"==typeof t&&!Object.isFrozen(t)&&i(t)}e.exports=i},function(e,t,i){"use strict";function n(e,t,i){this.name=t,this.log_key=s.result(e,"log_key"),this.data=i||null;var n=r(),o=s.result(e,"generate_relative_id"),l=s.result(e,"env"),c=e.uuid,u={};u.log_key=this.log_key,u.uuid=c,u.event=this.name,u.ts=n,o!==!1&&void 0!==o&&(u.rid=o),u.elapsed=u.ts-a,u.data=this.data,u.env=l,this.json=u}var s=i(3),o=i(756),r=o.getRealNow,a=o.realStartedAt;e.exports=n},function(e,t,i){"use strict";function n(e){return o.isString(e)?e:JSON.stringify(e)}function s(e,t,i){this.name=t,this.log_key=o.result(e,"log_key"),this.data=i||null;var s=l(),r=o.result(e,"generate_relative_id"),u=o.result(e,"env"),h=e.uuid,d={category:this.log_key},p=8,g=new Array(p);g[0]=n(s),g[1]=n(c),g[2]=n(h),g[3]=n(r),g[4]=n(a.getElapsed(s)),g[5]=n(t),g[6]=n(i),g[7]=n(u),d.fields=g,this.json=d}var o=i(3),r=i(271),a=i(756),l=a.getRealNow,c=r.get("tmgioct");e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"helpform",events:{"helpform:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"keycommands_trigger",events:{"keycommands:*":"handleEvent"},initialize:function(){this.hasLoggedJK=!1},handleEvent:function(e,t){if("jk"===e){if(this.hasLoggedJK)return;this.hasLoggedJK=!0}this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=i(108),o=n.extend({FLOW_VERSION_SINGLEFIELD:"singlefield",FLOW_VERSION_STANDARD:"standard",logKey:"loginregister",events:{"loginregister:*":"handleEvent"},initialize:function(){this.hasStartedFunnel=!1},logEnv:function(){return{actionType:"/login"===document.location.pathname?"login":"register",captchaType:"recaptcha",version:this._getFlowVersion()}},handleEvent:function(e,t){if("beginFlow"===e){if(this.hasStartedFunnel)return;this.hasStartedFunnel=!0}this.log(e,t)},_getFlowVersion:function(){return s.bool("oneid_force_newlandingpage")?this.FLOW_VERSION_SINGLEFIELD:this.FLOW_VERSION_STANDARD}});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(751),o=s.extend({logKey:"videoplayer",logEnv:{referrer:document.location.pathname},events:{"VideoPlayer:cacheUnload":"cacheUnloadLog","VideoPlayer:timeupdate":"updateLogCache","VideoPlayer:*":"handleEvent"},initialize:function(){this.excludedEvents=["cacheUnload","timeupdate"],this.unloadData={},n.each(this.loggers,function(e){e.before_unloaded=n.bind(this.beforeUnloaded,this)},this)},handleEvent:function(e,t){if(!n.contains(this.excludedEvents,e)){var i=n.extend({},t);i.postData&&(i.post_id=i.postData.id,delete i.postData),this.log(e,i)}},cacheUnloadLog:function(e,t){this.unloadData[t.id]=t},beforeUnloaded:function(e){n.each(this.unloadData,function(e){this.handleEvent("unload",e)},this)},updateLogCache:function(e,t){var i=["elapsed","position"];this.unloadData[t.id]=n.extend(this.unloadData[t.id],n.pick(t,i))}});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(751),o=s.extend({logKey:"vendorbutton",logEnv:{referrer:document.location.pathname},events:{"VendorButton:*":"handleEvent"},handleEvent:function(e,t){var i=n.extend({},t);i.post_id=t.postData.id,i.root_post_id=t.postData.root_id,i.tumblelog=t.postData.tumblelog,delete i.postData,this.log(e,i)}});e.exports=o},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"dashboard_sharing",events:{"dashboard-share:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){t=t||{},this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"related_recommendations",logOptions:{init_event:!1},events:{"rapid-recommendations:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"explore_trending",logOptions:{init_event:!1},events:{"explore-trending:*":"log"},logEnv:{location:document.location.pathname}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"roadblock",events:{"roadblock:*":"log"}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"linkpost_interactions",logOptions:{init_event:!1},events:{"linkpost:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(106),o=i(752),r=i(758),a=i(751),l=a.extend({logKey:"peepr",logEnv:{baseSessionId:s.get("Components/LogLady/default_session"),context:s.get("Context/name")},events:{"peepr:message:*":"logMessage","peepr:open":"logOpen","peepr:close":"logClose","peepr:log:*":"logMessage"},logMessage:function(e,t){this.log(e,t.payload)},logOpen:function(){this.logger()},logClose:function(){this._logger.stop(),this._logger=null},setupEndpoints:n.noop,logOptions:function(){return{uuid:r()}},logger:function(){return this._logger||(this._logger=o(this)),this._logger},log:function(){var e=this.logger();e.trigger.apply(e,arguments)}});e.exports=l},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"abuseform",events:{"abuseform:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=i(106),o=n.extend({logKey:"recommended_blogs",logEnv:{context:s.get("Context/name"),location:document.location.pathname},logOptions:{init_event:!1},events:{"recommendedBlogs:*":"log"}});e.exports=o},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"tourguide_account",logEnv:{referrer:document.location.pathname},logOptions:{init_event:!1},events:{"TourGuideAccount:*":"log"}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"blocks",events:{"blocks:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"postform_interactions",logOptions:{init_event:!1},events:{"postform-interaction:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"header_search",logEnv:{referrer:document.location.pathname},events:{"header_search:*":"log"}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"gifsearch_interactions",logOptions:{init_event:!1},events:{"gifsearch:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){"unload"!==e&&this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=i(786),o=i(108),r=n.extend({logKey:null,logSpots:[],events:function(){var e={};return o.bool("little_sister_kill_switch")||(e["LSLog:*"]="log"),e},log:function(e,t){if(t&&t.pt){var i={pt:t.pt,eventName:e};t.video_details&&(i.video_details=t.video_details),s.log(t.pt).trigger(e,i),t.is_ad&&s.flush()}}});e.exports=r},function(e,t,i){"use strict";function n(e){var t=[];return s.forEach(e,function(e){var i=s.find(t,{pt:e.pt});i||(i={pt:e.pt,events:[]},t.push(i)),i.events.push(e.event_data)}),t}var s=i(3),o=i(755),r=i(787),a=i(756),l=a.getRealNow,c=o.extend({build_payload:function(){var e=o.prototype.build_payload.call(this);return e.flushTime=l(),e}}),u=new c({EventClass:r,event_payload_name:"trackers",event_filter:function(e){return e.data&&e.data.pt},payload_formatter:n,endpoint:"https://ls.srvcs.tumblr.com/services/bblog"});e.exports=u},function(e,t,i){"use strict";function n(e,t,i){this.name=t,this.log_key=s.result(e,"log_key"),this.data=i||{};var n=r(),o={pt:this.data.pt,event_data:{timestamp:n,eventString:this.data.eventName}};this.data.video_details&&(o.event_data.data=this.data.video_details),this.json=o}var s=i(3),o=i(756),r=o.getRealNow;e.exports=n},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"messaging_interactions",logOptions:{init_event:!1},events:{"messaging-interaction:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=i(106),o=n.extend({logKey:"verified_onboarding_blogs",logEnv:{context:s.get("Context/name"),location:document.location.pathname},logOptions:{init_event:!1},events:{"verifiedBlogs:*":"log"}});e.exports=o},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"reactivation",logOptions:{init_event:!1},events:{"reactivation:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"external_inline_images",logOptions:{init_event:!1},events:{"external-inline-images:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"activity_links",logOptions:{init_event:!1},logEnv:{location:document.location.pathname},events:{"activityLinks:*":"handleEvent"},handleEvent:function(e,t){this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"notes_interactions",logOptions:{init_event:!1},logEnv:{location:document.location.pathname},events:{"notes-interactions:*":"log"}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"postchrome_interactions",logOptions:{init_event:!1},events:{"postchrome-interactions:*":"handleEvent"},logEnv:{location:document.location.pathname},handleEvent:function(e,t){this.log(e,t)}});e.exports=s},function(e,t,i){"use strict";var n=i(751),s=n.extend({logKey:"toastlog",events:{"toastlog:*":"log"}});e.exports=s},function(e,t,i){"use strict";var n=i(167);n({"Tumblr.Prima.Upload":i(424),"Tumblr.Prima.Ligature":i(221),"Tumblr.Events":i(110),"Tumblr.Prima.Events":i(110),"Tumblr.Prima.Dialog":i(143),"Tumblr.Dialog":i(143),"Tumblr.PostMessageChannel":i(797),"Tumblr.Prima.DOMEventor":i(109),"Tumblr.Prima.gutterMediaManager":i(800),"Tumblr.Prima.Vendor.when":i(121),"Tumblr.Prima.Vendor.sequence":i(169),"Tumblr.log_lady":i(801),"Tumblr.Prima.logLady":i(801),"Tumblr.Prima.Models.Post":i(276),"Tumblr.Prima.Models.Tumblelog":i(120),"Tumblr.Prima.CrtPlayer":i(500),"Tumblr.Prima.BlogCard":i(565),"Tumblr.Prima.Url":i(192),ace:i(409),"Tumblr.Prima.ToolTip":i(804),"Tumblr.Prima.SharePopover":i(270),"Tumblr.Prima.Messaging.SharePost":i(807),"Tumblr.Prima.utils.caniuse":i(502),"Tumblr.Prima.ConfettiView":i(617),"Tumblr.Prima.FlatSelect":i(851),"Tumblr.Prima.Mixins.loggingData":i(277),"Tumblr.Prima.Scrollbar":i(385),"Tumblr.Prima.MessageControlsPopover":i(853),"Tumblr.Prima.Block":i(142),"Tumblr.Prima.PeeprSearch":i(855),"Tumblr.Prima.MessagingPopover":i(869),"Tumblr.Prima.currentUser":i(111),"Tumblr.Prima.AdsPaginationHelper":i(876),"Tumblr.Prima.SortableView":i(243),"Tumblr.Prima.getLoggingPayloadFromNote":i(877),"Tumblr.Prima.Snowman":i(571),"Tumblr.Prima.PostActivity":i(878),"Tumblr.Prima.Lib.hosts":i(754)}),e.exports=n},function(e,t,i){"use strict";function n(e){return"string"==typeof e||e&&"object"==typeof e&&"[object String]"===d.call(e)||!1}function s(){var e=new g;return e.cid=m,m+=1,f[e.cid]=e,e}function o(e,t){for(var i,n=v.length-1;n>=0;n--)v[n].message_callback(e,t);for(n=_.length-1;n>=0;n--)i=_[n],i&&i.shouldRespond&&i.shouldRespond(e,t)&&i.cb(e,t)}function r(e){if(e||(e={}),!(c&&c.stringify&&c.parse))throw"Must have JSON parsing and stringify";if(e.iframe&&(e.window=e.iframe.contentWindow,!e.origin)){var t=e.iframe.src,i=t.match(/^(http(?:s)?:\/\/[\w_\-\.]+(?::\d+)?)\/?/);i&&(e.origin=i[1])}this.namespace=e.namespace?e.namespace+":":"",this.origin=e.origin||"*",this.responders={_method_callback_responder:b,_syn:h(this._syn,this)},this._on_connected=new p,this._unanswered_calls={},this.on_connection(h(this.enable_sending_post_message,this)),v.push(this),e.window&&this.setWindow(e.window)}function a(e,t,i){i||(i=this.origin),e.postMessage(t,i)}var l=i(99),c=l("JSON",function(e){return e&&e.stringify}),u=[].slice,h=function(e,t){return function(){return e.apply(t,arguments)}},d=Object.prototype.toString,p=i(798),g=i(799),m=1,f={},v=[],_=[];!function(){var e=window.addEventListener?"addEventListener":"attachEvent",t=window[e],i="attachEvent"===e?"onmessage":"message";t(i,function(e){var t;if("string"==typeof e.data){try{e.data&&"{"===e.data[0]&&(t=c.parse(e.data))}catch(i){}t&&t.method&&o(e,t)}},!1)}();var b=function(e){if(e.cid_response&&e.cid_response in f){var t=f[e.cid_response];t.resolve.call(null,this,e.response),delete f[e.cid_response]}};r.prototype.setWindow=function(e){if(e){this.window=e;var t=this.call("_syn");t.then(h(function(e,t){"ack"===t&&this._is_connected()},this))}},r.on=function(e,t){var i;i="*"===e?function(){return!0}:"*"===e[e.length-1]?function(t,i){return 0===i.method.indexOf(e.substring(0,e.length-2))}:function(t,i){return i.method===e},_.push({shouldRespond:i,cb:t})},r.off=function(e){for(var t,i=_.length-1;i>=0;i--)if(_[i].cb===e){t=i;break}return t&&t>-1?(_.splice(t,1),!0):!1},r.prototype.match_origin=function(e){return"*"===this.origin?!0:this.origin===e},r.prototype.message_callback=function(e,t){var i;if((!this.window||e.source===this.window)&&this.match_origin(e.origin)){if(t.method&&t.method.slice(0,this.namespace.length)===this.namespace&&(i=t.method.slice(this.namespace.length,t.method.length)),t.args&&n(t.args))try{t.args=c.parse(t.args)}catch(s){return}this.call_responder(i,e,t)}},r.prototype.call_responder=function(e,t,i){var n,s;if(e){if(i.args||(i.args=[]),s=this.responders[e],!s)return this._unanswered_calls[e]||(this._unanswered_calls[e]=[]),void this._unanswered_calls[e].push(arguments);n=s.apply(t,i.args),i.cid&&"_method_callback_responder"!==e&&this.send_to_window(t.source,"_method_callback_responder",{cid_response:i.cid,response:n})}},r.prototype._syn=function(){return this._is_connected(),"ack"},r.prototype._is_connected=function(){this.connected||(this.connected=!0,this._on_connected.trigger(this))},r.prototype.on_connection=function(e){return this._on_connected.push.apply(this._on_connected,arguments),this},r.prototype.method=function w(e){var t=this,w=function(){var i=1<=arguments.length?u.call(arguments,0):[];return i.unshift(e),t.send.apply(t,i)};return w},r.prototype.call=function(){var e=1<=arguments.length?u.call(arguments,0):[];return this.window?(e.unshift(this.window),this.call_on_window.apply(this,e)):void console.warn("no window specified on channel")},r.prototype.call_on_window=function(e,t){var i=3<=arguments.length?u.call(arguments,2):[],n=s();
try{var o=c.stringify({method:this.namespace+t,args:i,cid:n.cid});"_syn"===t||"_method_callback_responder"===t?a.call(this,e,o):this.send_post_message(e,o)}catch(r){n.reject(r)}return n.promise()},r.prototype.send=function(){var e=1<=arguments.length?u.call(arguments,0):[];return this.window?(e.unshift(this.window),this.send_to_window.apply(this,e)):void console.warn("no window specified on channel")},r.prototype.send_to_window=function(e,t){var i=3<=arguments.length?u.call(arguments,2):[],n=c.stringify({method:this.namespace+t,args:i});"_syn"===t||"_method_callback_responder"===t?a.call(this,e,n):this.send_post_message(e,n)},r.prototype.send_post_message=function(){this._delayed_sent_messages||(this._delayed_sent_messages=[]),this._delayed_sent_messages.push(arguments)},r.prototype.enable_sending_post_message=function(){if(this.send_post_message=a,this._delayed_sent_messages){for(var e=0;e<this._delayed_sent_messages.length;e+=1)a.apply(this,this._delayed_sent_messages[e]);delete this._delayed_sent_messages}},r.prototype.listening_to=function(e){return e in this.responders},r.prototype.listen_to=function(e,t,i){if(n(e)){if(e in this.responders)return void console.warn("already listening to this method, turn it off first");if(i&&(t=h(t,i)),this.responders[e]=t,this._unanswered_calls[e]){var s,o=this._unanswered_calls[e];delete this._unanswered_calls[e];for(var r=0;r<o.length;r+=1)s=o[r],this.call_responder.apply(this,s)}}else{var a=e;for(e in a)a.hasOwnProperty(e)&&this.listen_to(e,a[e],i)}},r.prototype.stop_listen_to=function(e){return"_method_callback_responder"===e?void console.warn("cannot disable the method callback responder"):void delete this.responders[e]},r.prototype.ensureChannelConnection=function(e){this.send_to_window(e,"_syn")},e.exports=r},function(e,t){"use strict";function i(){this.length=0}var n=[].slice,s=[].push;i.prototype={slice:n,indexOf:Array.prototype.indexOf},i.prototype.push=function(){if(this.triggered_with)for(var e=1<=arguments.length?n.call(arguments,0):[],t=0;t<e.length;t+=1)e[t].apply(null,this.triggered_with);return s.apply(this,arguments)},i.prototype.trigger=function(){var e=1<=arguments.length?n.call(arguments,0):[],t=this.length;this.triggered_with=e;for(var i=0;t>i;i+=1)this[i].apply(null,this.triggered_with);return this},e.exports=i},function(e,t,i){"use strict";function n(){this._on_resolved=new r,this._on_rejected=new r,this.then=o(this.then,this),this.fail=o(this.fail,this),this.resolve=o(this.resolve,this),this.reject=o(this.reject,this)}var s=[].slice,o=function(e,t){return function(){return e.apply(t,arguments)}},r=i(798);n.prototype.then=function(){return this._on_resolved.push.apply(this._on_resolved,arguments),this},n.prototype.success=n.prototype.then,n.prototype.fail=function(){return this._on_resolved.push.apply(this._on_rejected,arguments),this},n.prototype.resolve=function(){return this.resolved||this.rejected?void 0:(this._on_resolved.trigger.apply(this._on_resolved,arguments),this.resolved=!0,this)},n.prototype.reject=function(){return this.resolved||this.rejected?void 0:(this._on_rejected.trigger.apply(this._on_rejected,arguments),this.rejected=!0,this)},n.prototype.reject_timeout=function(){var e=1<=arguments.length?s.call(arguments,0):[],t=e.shift();return setTimeout(o(function(){this.reject.apply(this,e)},this),t),this},n.prototype.promise=function(){function e(){var e=this;this.fail=function(){return t.fail.apply(t,arguments),e},this.then=function(){return t.then.apply(t,arguments),e},this.success=this.then,this.reject_timeout=function(){return t.reject_timeout.apply(t,arguments),e},this.cid=t.cid}var t=this;return new e},e.exports=n},function(e,t,i){"use strict";var n=i(144),s=i(109),o=i(110),r=i(9),a=i(3),l=n.extend({name:"GutterMediaManager",gutteredView:null,gutterMargin:20,gutterWidth:215,maxViewWidth:300,viewportTransitionWidth:900,initialize:function(){this.layoutHasGutter=this.$right_column().length>0,this.layoutHasGutter||(this.gutterMargin=-65)},$right_column:function(){return this._$right_column||(this._$right_column=r(".right_column")),this._$right_column},toggleBackground:function(e){this.layoutHasGutter&&(e?(this.$right_column().addClass("has_docked_post"),this.$right_column().on("click.gutterManager",a.bind(this.handleGutterClick,this))):(this.$right_column().removeClass("has_docked_post"),this.$right_column().off("click.gutterManager")))},putViewInGutter:function(e,t){return t=a.defaults(t||{},{winRect:s.rect(),gutterPosition:this.gutterPosition(),animation:null,dimRadar:!0,removeOnGutterClick:!1,onDock:a.noop,onUndock:a.noop,dockLoggingName:"post:docked",dockLoggingData:null,undockLoggingName:"post:undocked",undockLoggingData:null}),this.isDockable(e,t)?(t.onDock=t.onDock||a.noop,this.gutteredView&&this.removeGutteredView(),this.gutteredView={view:e,options:t},t.onDock.call(e,t),t.dimRadar&&this.toggleBackground(!0),t.dockLoggingName&&t.dockLoggingData&&o.trigger(t.dockLoggingName,{loggingData:t.dockLoggingData}),this.gutteredView):!1},removeGutteredView:function(){if(this.gutteredView){var e=this.gutteredView.options,t=this.gutteredView.view;e.onUndock=e.onUndock||a.noop,e.onUndock.call(t,e),this.gutteredView=null,e.dimRadar&&this.toggleBackground(!1),e.undockLoggingName&&e.undockLoggingData&&o.trigger(e.undockLoggingName,{loggingData:e.undockLoggingData})}},isViewInGutter:function(e){return this.gutteredView&&this.gutteredView.view===e},isDockable:function(e,t){if(!this.gutteredView)return!0;var i=this.gutteredView?this.gutteredView.options.alwaysEvict:!0,n=t.alwaysEvict;return this.gutteredView.view!==e&&(!n||i)},handleGutterClick:function(e){this.gutteredView&&(e.preventDefault(),this.gutteredView.options.removeOnGutterClick&&this.removeGutteredView())},gutterPosition:function(){var e=s.rect(),t=this.viewportTransitionWidth/2-this.gutterMargin-this.gutterWidth,i={width:this.maxViewWidth,left:"50%",bottom:20,translateX:t},n=this.maxViewWidth-this.gutterWidth+this.viewportTransitionWidth;return e.windowWidth<n&&(i.width=n-e.windowWidth),i.width<this.gutterWidth&&(i.width=this.gutterWidth),i}});e.exports=new l},function(e,t,i){"use strict";var n=i(802);e.exports=n},function(e,t,i){"use strict";var n=i(110),s=i(755),o=i(765),r=i(803),a=new s({EventClass:o,event_payload_name:"events",event_filter:r,endpoint:"/svc/log/lady"});n.on("Capture:push",function(e,t,i){a.log(e,{init_event:!1}).trigger(t,i)}),e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(760),o=n.keys(s("keys"));e.exports=function(e){return o.indexOf(e.log_key)>=0}},function(e,t,i){"use strict";var n=i(144),s=i(805),o=n.extend({name:"ToolTip",class_name:"tumblr_tooltip",initialize:function(e){this.toolTipView=new s(e)}});e.exports=o},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(149),r=i(806),a=o.extend({class_name:"tumblr_tooltip",template:r,defaults:{selector:"",class_name:"",offset:"50%",placement:"up"},initialize:function(e){this.options=e||{},this.options.selector=n.trim((e.selector||this.defaults.selector)+" "),this.options.class_name=e.class_name||this.defaults.class_name,this.options.offset=e.offset||this.defaults.offset,this.options.placement=e.placement||this.defaults.placement,this.tooltips=n(this.options.selector+"[data-tooltip]"),this.tooltips.on("remove",n.proxy(this.remove,this)),this.tooltips.on("mouseenter",s.bind(this.show,this)),this.tooltips.on("mouseleave",s.bind(this.hide,this))},show:function(e){var t=n(e.currentTarget);this.tooltip_template_data={tooltip:t.data("tooltip")};var i=n(this.tooltip(this.tooltip_template_data));t.append(i),this.setElement(i),this.delegateEvents(),i.removeClass("is_closed").addClass("is_open")},hide:function(e){var t=n(e.currentTarget),i=t.find("."+this.class_name);i.removeClass("is_open").addClass("is_closed"),i.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",s.bind(function(e){this.remove(e)},this))},remove:function(e){n(e.currentTarget).remove()},tooltip:function(e){return this.class_name="tooltip_wrapper",this.attributes={text:e.tooltip,placement:this.options.placement,class_name:this.options.class_name,left_css:this.options.offset},this.template(this.attributes)}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="tooltip_wrapper '+(null==(__t=placement)?"":_.escape(__t))+" "+(null==(__t=class_name)?"":_.escape(__t))+'" style="left:'+(null==(__t=left_css)?"":_.escape(__t))+'"><div class="tooltip"> '+(null==(__t=text)?"":__t)+" </div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(7),o=i(144),r=i(111),a=i(120),l=i(110),c=i(108),u=i(808),h=i(809),d=i(638),p=i(603),g=new d,m=o.extend({name:"MessagingSharePost",initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),this.options=e,this.user=r(),this.channels=this._getChannelsEnabledForMessagingAsCollection(),this.messagingShareLogger=new u},render:function(){return this.openPopover(this.options),this},openPopover:function(e){var t,i,s=n.get(e,"postId"),o=n.get(e,"blogUuid"),r=n.get(e,"favoritesNames",[]),a=n.get(e,"popoverContainer"),l=n.get(e,"pinnedTarget"),u=n.get(e,"externalNetworksData",{});return n.isEmpty(s)?null:n.isEmpty(o)?null:n.isEmpty(l)?null:(t={viewOptions:n.bind(function(e){return{shareData:{blogUuid:o,postId:s},popoverContainer:e.el,favoritesCollection:g,additionalFavorites:this._getAdditionalFavoritesAsParticipants(r),channels:this.channels,externalNetworksData:u,isShowConsolidatedShareInterface:c.bool("consolidated_share_web")&&!n.isEmpty(u),isExternalSharingEnabled:this.isExternalSharingEnabled()}},this),autoTeardown:!0,teardownOnEscape:!1,pinnedSide:"bottom",isFixedPosition:!1,pinnedTarget:l,popoverContainer:a},i=new h(t).render(),this._afterPopoverOpen(i),i)},isExternalSharingEnabled:function(){return n.get(this.data,"is_external_sharing_enabled",!1)},_afterPopoverOpen:function(e){var t=e.getView();this.listenToOnce(e,"close",function(){this._onPopoverClose(e)}),this.listenTo(t,"external:click",this._onPopoverExternalNetworkShareClick),this.listenTo(t,"external:success",this._onPopoverExternalNetworkShareSuccess),this.listenTo(t,"external:fail",this._onPopoverExternalNetworkShareFail),l.trigger("keycommands:suspend")},_onPopoverClose:function(e){this.stopListening(e),this.stopListening(e.getView()),l.trigger("keycommands:resume")},_onPopoverExternalNetworkShareClick:function(e){this.messagingShareLogger.logExternalNetworkClicked(e)},_onPopoverExternalNetworkShareSuccess:function(e){this.messagingShareLogger.logExternalNetworkShareSuccess(e)},_onPopoverExternalNetworkShareFail:function(e){this.messagingShareLogger.logExternalNetworkShareFail(e)},_getChannelsEnabledForMessagingAsCollection:function(){return new s.Collection(this.user.getChannelsEnabledForMessaging())},_getAdditionalFavoritesAsParticipants:function(e){return n.reduce(e,function(e,t){var i=new a({name:t});return i.get("uuid")&&i.get("can_receive_messages")&&e.push(new p(i.toJSON(),{parse:!0})),e},[],this)}});e.exports=m},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(144),r=i(110),a=o.extend({name:"MessagingShareLogger",defaults:{namespace:"postchrome-interactions",platform:"web",isDebugEnabled:!1},initialize:function(e){e=s.extend({},e),s.extend(this.attributes,s.pick(e,s.keys(this.defaults)))},logExternalNetworkClicked:function(e){var t=e.getName(),i=e.getPostModel(),o=s.extend({},this._getCommonExternalShareData(e),{viewType:e.getType()});this._logIt("share:external",o),r.trigger("dashboard-share:"+t),e.isTypePopup()&&!s.isEmpty(i)&&n.ajax({url:"/svc/share/"+t,method:"POST",with_form_key:!0,data:{post_id:i.get("post_id"),tumblelog_name:i.get("tumblelog_name"),share_fallback:!0}})},logExternalNetworkShareSuccess:function(e){this._logIt("share:external:success",this._getCommonExternalShareData(e))},logExternalNetworkShareFail:function(e){this._logIt("share:external:fail",this._getCommonExternalShareData(e))},_logIt:function(e,t){t=t||{},s.extend(t,{platform:this.get("platform")}),r.trigger(this.get("namespace")+":"+e,{loggingData:t})},_getCommonExternalShareData:function(e){var t=e.getPostModel(),i={network:e.getName()};return s.isEmpty(t)||s.extend(i,{postId:t.get("post_id"),tumblelogName:t.get("tumblelog_name")}),i}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(156),r=i(211),a=i(810),l=o.extend({className:"popover--messaging-share-post popover popover_menu popover_gradient",mixins:[r],initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"viewOptions"))},render:function(){var e=n.isFunction(this.viewOptions)?this.viewOptions(this):this.viewOptions;return this.$wrapper=s("<div />").addClass("popover-inner popover_inner").appendTo(this.$el),this.$pinned.addClass("active"),this.sharePostView&&(this.stopListening(this.sharePostView),this.sharePostView.remove()),this.sharePostView=new a(e),this.listenToOnce(this.sharePostView,"close",this.teardown),this.$wrapper.html(this.sharePostView.render().$el),this},teardown:function(){return this.sharePostView&&this.sharePostView.remove(),this.remove()},getView:function(){return this.sharePostView}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(110),r=i(205),a=i(162),l=i(156),c=i(390),u=i(811),h=i(258),d=i(812),p=i(814),g=i(818),m=i(845),f=i(847),v=i(849),_=i(605),b=i(594),w=i(678),y=i(671),k=i(638),x=i(850),C=l.extend({className:"messaging-share-post",template:u,defaults:{senderBlog:null,isSending:!1,isLoading:!1,isLoadingFavorites:!1,isDisabled:!1,isEmpty:!1,isShowFavorites:!0,isShowMessage:!1,isShowConsolidatedShareInterface:!0,isExternalSharingEnabled:!0,isShowingExternalNetworkSubview:!1,closeAfterExternalNetworkShareMs:3e3,showLoadingAfterMs:250,numFavorites:20,defaultPlaceholder:null,additionalFavoritesPlaceholder:null,sendingPlaceholder:null,currentPlaceholder:null,focusIndex:0,isResultContainerFocused:!1,isExternalNetworksContainerFocused:!1,loadingClass:"is-loading",baseLoggingContext:"post-chrome",tabbingView:null},mixins:[r,a],keycommands:{"keydown:up":"_onKeyPressUp","keydown:down":"_onKeyPressDown","keydown:tab":"_onKeyPressTab","keydown:shift+tab":"_onKeyPressShiftTab","keydown:escape":"_onKeyPressEscape"},subviews:{searchView:{constructor:d,options:function(e){return{collection:e.collection,selectedRecipientModel:e.selectedRecipientModel,keyboardManager:e.keyboardManager,keyboardNamespace:"messagingshare:search"}}},resultsView:{constructor:p,options:function(e){return{collection:e.collection,selectedRecipientModel:e.selectedRecipientModel,keyboardManager:e.keyboardManager,keyboardNamespace:"messagingshare:results"}}},messageView:{constructor:y,options:function(e){return{isAutoValidationEnabled:!1,className:"messaging-share-post-message",placeholder:e.get("currentPlaceholder"),keyboardManager:e.keyboardManager,keyboardNamespace:"messagingshare:message",buttonSubmittedClass:"submitted--send-a-post",animationSpeed:250,pluginsArray:e.pluginsArray}}},externalNetworksView:{constructor:g,options:function(e){return{isExternalSharingEnabled:e.get("isExternalSharingEnabled"),keyboardManager:e.keyboardManager,keyboardNamespace:"messagingshare:external",externalNetworksData:e.externalNetworksData}}},errorView:{constructor:f},favoritesLoaderView:{constructor:h,options:{className:"messaging-share-post-favorites-loader",variation:"small centered",loading:!1}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"favoritesCollection","shareData","channels","popoverContainer","additionalFavorites","externalNetworksData")),this.blogSelectorPlugin=new v({collection:this.channels,currentTumblelog:this.get("senderBlog"),popoverOptions:{popoverContainer:this.popoverContainer}}),this.pluginsArray=[this.blogSelectorPlugin],this.collection=new k,this.keyboardManager=new _({allowMultipleActiveViews:!0}),n.isEmpty(this.get("defaultPlaceholder"))&&this.set("defaultPlaceholder",s("Say something if you like...")),n.isEmpty(this.get("additionalFavoritesPlaceholder"))&&this.set("additionalFavoritesPlaceholder",s("Discuss this post if you like...")),n.isEmpty(this.get("sendingPlaceholder"))&&this.set("sendingPlaceholder",s("Sending...")),this.additionalFavoritesIds=n.pluck(n.invoke(this.additionalFavorites,"toJSON"),"uuid"),this.channelIds=this.channels.pluck("uuid"),this.selectedRecipientModel=new x,this.set({currentPlaceholder:this.get("defaultPlaceholder"),senderBlog:this._getInitiallySelectedChannel()}),this.disableKeys()},afterRenderSubviews:function(){this.loader=new c({$container:this.$el,type:"bar",classModifiers:"top",loading:!1}),this._onSearchInputDebounced=n.bind(n.debounce(function(){this._onSearchInput(this.searchView.getQuery())},250),this),this.listenTo(this.selectedRecipientModel,"change:participant",this._onChangeSelectedRecipient),this.listenTo(this,"change:isSending",this._onChangeIsSending),this.listenTo(this,"change:isDisabled",this._onChangeIsDisabled),this.listenTo(this,"change:isLoading",this._onChangeIsLoading),this.listenTo(this,"change:isLoadingFavorites",this._onChangeisLoadingFavorites),this.listenTo(this,"change:isEmpty",this._onChangeIsEmpty),this.listenTo(this,"change:isShowFavorites",this._onChangeIsShowFavorites),this.listenTo(this,"change:isShowExternalNetworks",this._onChangeIsShowExternalNetworks),this.listenTo(this,"change:isShowMessage",this._onChangeIsShowMessage),this.listenTo(this,"change:currentPlaceholder",this._onChangeCurrentPlaceholder),this.listenTo(this,"change:focusIndex",this._onChangeFocusIndex),this.listenTo(this.blogSelectorPlugin.getBlogSelector(),"change:currentTumblelog",this._onBlogSelectorChange),this.listenTo(this.messageView,"submit:animated",this._onMessageSubmit),this.listenTo(this.searchView,"search",this._onSearchInputDebounced),this.listenTo(this.searchView,"clear",this._onSearchClear),this.listenTo(this.searchView,"focus",this._onViewFocusChange),this.listenTo(this.searchView,"submit",this._onSearchSubmit),this.listenTo(this.messageView,"focus",this._onViewFocusChange),this.listenTo(this.resultsView,"focus",this._onViewFocusChange),this.listenTo(this.externalNetworksView,"focus",this._onViewFocusChange),this.listenTo(this.externalNetworksView,"share:subview:show",this._onExternalNetworkShowSubview),this.listenTo(this.externalNetworksView,"share:success",this._onExternalNetworkShareSuccess),this.listenTo(this.externalNetworksView,"share:fail",this._onExternalNetworkShareFail),this.listenTo(this.externalNetworksView,"share:click",this._onExternalNetworkClick),this.listenTo(this.collection,"sync",this._onCollectionSync),this._setViewStates(),this._fetchFavorites(),this._setCollectionState(),this.messageTheme=new w({removeDataAttrAfterApplyingTheme:!1,el:this.messageView.el}),this.searchTheme=new w({removeDataAttrAfterApplyingTheme:!1,el:this.searchView.el}),n.defer(n.bind(function(){this.rendered&&this.searchView.focus()},this)),this.keyboardManager.add("messagingshare:main",this),this.focusKeys()},beforeRemove:function(){this.keyboardManager.remove("messagingshare")},fetchByQuery:function(e){n.isEmpty(e)?this.set({isEmpty:!1,isShowFavorites:!0,isLoading:!1}):(this.set("isLoading",!0),this.collection.fetchByQuery(e,this.get("senderBlog").get("uuid")).always(n.bind(function(){this.rendered&&this.set("isLoading",!1)},this)))},getSelectedRecipient:function(){return this.selectedRecipientModel.get("participant")},clearSelectedRecipient:function(){this.selectedRecipientModel.set("participant",null)},sendPost:function(e,t){var i,s,r,a=this.shareData,l=n.get(this.shareData,"postId"),c=n.get(this.shareData,"blogUuid"),u=[],h=!n.isEmpty(e),d=this._getLoggingContext();this.get("isDisabled")||this.get("isSending")||n.isEmpty(a)||(s=b.createPostMessage(l,c,{postHasTextMessage:h,context:d,creationUserAction:t}),u.push(s),h&&(r=b.createTextMessage(e,{context:d,creationUserAction:t}),u.push(r)),i=this._createConversation(),n.isEmpty(i)||(this.set("isSending",!0),i.appendToMessageQueue(u),o.trigger("messaging:conversation:open:model",i,d),this.close()))},close:function(){this.trigger("close")},_createConversation:function(){var e=this.get("senderBlog"),t=this.getSelectedRecipient();if(n.isEmpty(e)||n.isEmpty(t))return null;var i=e.toJSON(),s=t.toJSON();return new b({participantUuid:e.get("uuid"),participants:[i,s]})},_onCollectionSync:function(e){var t;return!this.rendered||n.isEmpty(this.searchView.getQuery())?void this._setCollectionState():(this.clearSelectedRecipient(),t=0===this.collection.length,t&&this.errorView.setTitle(this.collection.getNoResultsFoundMessage()),this.set({isShowFavorites:!1,isEmpty:t}),void this._resetResultsScroll())},_resetResultsScroll:function(){this.resultsView.$el.scrollLeft(0)},_resetExternalNetworksScroll:function(){this.externalNetworksView.$el.scrollLeft(0)},_getInitiallySelectedChannel:function(){return this.channels.findWhere({is_current:!0})||n.first(this.channels.models)},_applyTheme:function(e){this.messageTheme.setTheme(e),this.searchTheme.setTheme(e)},_setViewStates:function(){var e=this.get("isShowMessage"),t=this.get("isEmpty"),i=this.get("isLoadingFavorites"),n=this.get("isShowConsolidatedShareInterface");this.js$("submission").toggleClass("show-submission",e),this.js$("external").toggle(n),this.errorView.$el.toggle(t),this.resultsView.toggle(!t),this.favoritesLoaderView.set("loading",i),this._setFocusViews()},_onSearchInput:function(e){this.rendered&&this.fetchByQuery(e)},_onSearchClear:function(){this.rendered&&(this.fetchByQuery(null),this.clearSelectedRecipient())},_onSearchSubmit:function(){this.get("isShowFavorites")||1===this.collection.length&&this.selectedRecipientModel.set("participant",this.collection.first())},_setPlaceholderState:function(){var e=this.getSelectedRecipient(),t=this.get("isSending"),i=!n.isEmpty(e)&&n.contains(this.additionalFavoritesIds,e.get("uuid"));return t?void this.set("currentPlaceholder",this.get("sendingPlaceholder")):void this.set("currentPlaceholder",i?this.get("additionalFavoritesPlaceholder"):this.get("defaultPlaceholder"))},_setButtonState:function(){var e=this.get("isSending"),t=this.get("isDisabled"),i=e||t;this.messageView.set("isDisabled",i)},_setDisabledState:function(){var e=this.getSelectedRecipient(),t=this.get("senderBlog"),i=!n.isEmpty(e)&&e.get("uuid")===t.get("uuid");this.set("isDisabled",i)},_setCollectionState:function(){this.get("isShowFavorites")&&this.collection.reset(this.favoritesCollection.toJSON())},_setFocusViews:function(){var e=[this.searchView],t=[];this.get("isEmpty")||this.get("isLoadingFavorites")||(e.push(this.resultsView),t.push(this.resultsView)),this.get("isShowConsolidatedShareInterface")&&(e.push(this.externalNetworksView),t.push(this.externalNetworksView)),this.get("isShowMessage")&&e.push(this.messageView),this._focusViews=e,this._tabbableViews=t},_getLoggingContext:function(){var e,t,i=this.get("baseLoggingContext"),s=this.getSelectedRecipient();return n.isEmpty(s)?i:(e=n.contains(this.additionalFavoritesIds,s.get("uuid")),t=e?"trail":this.get("isShowFavorites")?"favorites":"search",i+":"+t)},_onChangeIsSending:function(e,t){this._setButtonState(),this._setPlaceholderState()},_onChangeIsDisabled:function(e,t){this._setButtonState()},_onChangeSelectedRecipient:function(e,t){var i=!n.isEmpty(t);i?(this.messageView.focus(),this._applyTheme(t.get("theme"))):this.searchView.focus(),this.set("isShowMessage",i),this._setViewStates(),this._setDisabledState(),this._setPlaceholderState()},_onChangeIsEmpty:function(){this._setViewStates()},_onChangeIsShowFavorites:function(){this._setCollectionState(),this._resetResultsScroll()},_onChangeIsShowExternalNetworks:function(){this._setViewStates(),this._resetExternalNetworksScroll()},_onChangeIsShowMessage:function(e,t){this.set("isShowExternalNetworks",!t)},_onBlogSelectorChange:function(e,t){this.set("senderBlog",t),this.messageView.focus(),this._setDisabledState()},_onChangeIsLoading:function(e,t){return this._loaderTimeout&&(clearTimeout(this._loaderTimeout),this._loaderTimeout=null),t?void(this._loaderTimeout=setTimeout(n.bind(function(){this.rendered&&(this.loader.set("loading",!0),this.$el.addClass(this.get("loadingClass")))},this),this.get("showLoadingAfterMs"))):(this.$el.removeClass(this.get("loadingClass")),void this.loader.set("loading",!1))},_onChangeisLoadingFavorites:function(){this._setViewStates()},_onMessageSubmit:function(e,t){this.sendPost(e,t)},_onChangeCurrentPlaceholder:function(e,t){this.messageView.setPlaceholder(t)},_addAdditionalFavorites:function(){!n.isEmpty(this.additionalFavorites)&&n.isArray(this.additionalFavorites)&&n.each(this.additionalFavorites.reverse(),function(e){var t=e.get("uuid"),i=this.favoritesCollection.get(t);n.contains(this.channelIds,t)||(n.isEmpty(i)?this.favoritesCollection.unshift(e):(this.favoritesCollection.remove(t),this.favoritesCollection.unshift(i)))},this)},_fetchFavorites:function(){this.set("isLoadingFavorites",!0),this.favoritesCollection.fetchFavorites(this.get("numFavorites"),null,!0).always(n.bind(function(){this.rendered&&(this._addAdditionalFavorites(),this._setCollectionState(),this.set("isLoadingFavorites",!1))},this))},_getFocusViews:function(){return this._focusViews},_moveFocusUp:function(){this.set("focusIndex",Math.max(0,this.get("focusIndex")-1))},_moveFocusDown:function(){var e=this._getFocusViews()||[];this.set("focusIndex",Math.min(e.length-1,this.get("focusIndex")+1))},_onViewFocusChange:function(e){var t=this._getFocusViews(),i=n.indexOf(t,e);this.set("tabbingView",n.contains(this._tabbableViews,e)?e:null),this.set("focusIndex",i,{silent:!0})},_onChangeFocusIndex:function(e,t){var i=n.get(this._getFocusViews(),t);this.set("tabbingView",n.contains(this._tabbableViews,i)?i:null),n.result(i,"focus")},_onKeyPressTab:function(e){var t=this.get("tabbingView");e.preventDefault(),n.isEmpty(t)||t.isLastFocused()?this._moveFocusDown():t.focusNext()},_onKeyPressShiftTab:function(e){var t=this.get("tabbingView");e.preventDefault(),n.isEmpty(t)||t.isFirstFocused()?this._moveFocusUp():t.focusPrevious()},_onKeyPressEscape:function(e){this.close(),e.preventDefault()},_onKeyPressUp:function(e){e.preventDefault(),this._moveFocusUp()},_onKeyPressDown:function(e){e.preventDefault(),this._moveFocusDown()},_onExternalNetworkShowSubview:function(e){var t="messagingshare:externalnetwork",i=new m({externalNetworkSubview:e});i.render(),this.disableKeys(),this.keyboardManager.add(t,i),this.listenToOnce(i,"goBack",function(){this.stopListening(e),this.keyboardManager.remove(t,i),this.enableKeys(),i.remove(),this.set("isShowingExternalNetworkSubview",!1),this.searchView.focus()}),this.listenToOnce(i,"close",function(){this.close()}),this.js$("external-network-subview-wrapper").html(i.$el),this.set("isShowingExternalNetworkSubview",!0)},_onExternalNetworkShareSuccess:function(e){setTimeout(n.bind(function(){this.rendered&&this.close()},this),this.get("closeAfterExternalNetworkShareMs")),this.trigger("external:success",e)},_onExternalNetworkShareFail:function(e){this.trigger("external:fail",e)},_onExternalNetworkClick:function(e){this.trigger("external:click",e)}});e.exports=C},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="searchView"></div><div class="messaging-share-post-main"><div class="messaging-share-post-results-wrapper"><div data-subview="errorView"></div><div data-subview="resultsView"></div><div data-subview="favoritesLoaderView"></div></div><div data-subview="loader"></div></div><div data-js-external class="messaging-share-post-external-networks-wrapper"><div data-subview="externalNetworksView"></div></div><div data-js-submission class="messaging-share-post-submission"><div data-subview="messageView"></div></div><div data-js-external-network-subview-wrapper></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(156),r=i(205),a=i(162),l=i(813),c=o.extend({className:"messaging-share-post-search",template:l,mixins:[r,a],events:{"input [data-js-input]":"_onInputChange","focus [data-js-input]":"_onInputFocus","blur [data-js-input]":"_onInputBlur",click:"_onContainerClick"},defaults:{hasSelectedBlogNameClass:"has-selected-blog",isFocused:!1,currentQuery:""},keycommands:{"keydown:backspace":"_onKeyPressBackspace","keydown:enter":"_onKeyPressEnter"},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"selectedRecipientModel","keyboardManager","keyboardNamespace")),this.disableKeys()},afterRender:function(){this.listenTo(this.selectedRecipientModel,"change:participant",this._onChangeSelectedRecipient),this.listenTo(this,"change:isFocused",this._onChangeIsFocused),this.listenTo(this,"change:currentQuery",this._onChangeCurrentQuery),this.js$("selected-blog").hide()},focus:function(){this.js$("input").focus()},getQuery:function(){return this.get("currentQuery")},_clearInput:function(){this._setInputValue()},_setInputValue:function(e){e=e||"",this.js$("input").val(e),this._prevVal=e},_getSelectedRecipient:function(){return this.selectedRecipientModel.get("participant")},_hasSelectedRecipient:function(){return!n.isEmpty(this._getSelectedRecipient())},_onChangeSelectedRecipient:function(e,t){this._setBlogPillRecipient(t),n.isEmpty(t)?this._setInputValue(this.get("currentQuery")):this._clearInput()},_setBlogPillRecipient:function(e){var t=!n.isEmpty(e);this.js$("selected-blog").text(t?e.get("name"):"").toggle(t),this.$el.toggleClass(this.get("hasSelectedBlogNameClass"),t)},_setCurrentQuery:function(e,t){t&&this.unset("currentQuery",{silent:!0}),this.set("currentQuery",e)},_onInputChange:function(e){var t,i,n=s(e.currentTarget).val();this._prevVal!==n&&(t=this.get("currentQuery"),i=this._hasSelectedRecipient()&&n===t,this._setCurrentQuery(n,i),this._prevVal=n)},_onKeyPressBackspace:function(e){this._hasSelectedRecipient()&&(e.preventDefault(),this._setCurrentQuery("",!0))},_onKeyPressEnter:function(e){e.preventDefault(),this.trigger("submit",this)},_onContainerClick:function(){this.focus()},_onInputFocus:function(){this.set("isFocused",!0)},_onInputBlur:function(){this.set("isFocused",!1)},_onChangeIsFocused:function(e,t){t?(this.keyboardManager.add(this.keyboardNamespace,this),this.trigger("focus",this)):(this.keyboardManager.remove(this.keyboardNamespace),this.trigger("blur",this))},_onChangeCurrentQuery:function(e,t){t=t||"",this._hasSelectedRecipient()&&this._setBlogPillRecipient(null),n.isEmpty(t)?this.trigger("clear"):this.trigger("search",t)}});e.exports=c},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="search-input-wrapper" data-js-search-container><div class="search-input-container"><input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="search-input" placeholder="'+(null==(__t=__("Message to..."))?"":_.escape(__t))+'" data-js-input> <button class="selected-blog" data-js-selected-blog data-js-theme-accent-color-as-background></button></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(620),r=i(162),a=i(385),l=i(626),c=i(815),u=i(817),h=s.extend({className:"messaging-share-post-results",template:u,defaults:{isFocused:!1,focusedView:null,selectedView:null},mixins:[r,o,l],keycommands:{"keydown:left":"_onKeyPressLeft","keydown:right":"_onKeyPressRight","keydown:backspace":"_onKeyPressBackspace","keydown:shift+backspace":"_onKeyPressBackspace"
},subviews:{resultView:{constructor:c,options:function(e){return{onSelect:n.bind(e._onSubviewSelect,e),onFocus:n.bind(n.partial(e._setIsFocusedDebounced,!0),e),onBlur:n.bind(n.partial(e._setIsFocusedDebounced,!1),e)}},collection:function(e){return e.collection}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"collection","selectedRecipientModel","keyboardNamespace","keyboardManager")),this.keyboardViewName="resultView",this.disableKeys()},afterRenderSubviews:function(){this.listenTo(this.collection,"reset update",this._onCollectionChange),this.listenTo(this,"change:isFocused",this._onChangeIsFocused),this.listenTo(this,"change:focusedView",this._onChangeFocusedView),this.listenTo(this,"change:selectedView",this._onChangeSelectedView),this.listenTo(this.selectedRecipientModel,"change:participant",this._onChangeSelectedRecipientModel),this._setIsFocusedDebounced=n.debounce(n.bind(this._setIsFocused,this),0),this.scrollbar=new a(this.$el),this.updateScrollbar()},resetFocus:function(){this.set("focusedView",null),this.deselect(this.keyboardViewName)},toggle:function(e){this.$el.toggle(e),e||this.resetFocus()},focus:function(){var e=this.get("selectedView"),t=!n.isEmpty(e);t&&this.setSelectedIndex(this.keyboardViewName,n.indexOf(this.resultView,e)),t?this.set("focusedView",this.getSelectedView(this.keyboardViewName)):this.focusFirst()},focusFirst:function(){this.set("focusedView",this.selectFirst(this.keyboardViewName))},focusLast:function(){this.set("focusedView",this.selectLast(this.keyboardViewName))},focusNext:function(){this.set("focusedView",this.selectNext(this.keyboardViewName))},focusPrevious:function(){this.set("focusedView",this.selectPrevious(this.keyboardViewName))},isLastFocused:function(){return this.isLastSelected(this.keyboardViewName)},isFirstFocused:function(){return this.isFirstSelected(this.keyboardViewName)},updateScrollbar:function(e){this.rendered&&this.scrollbar&&n.defer(n.bind(this.scrollbar.update,this.scrollbar))},beforeRemove:function(){this.keyboardManager.remove(this.keyboardNamespace),this.scrollbar&&this.scrollbar.destroy()},_onKeyPressLeft:function(e){e.preventDefault(),this.focusPrevious()},_onKeyPressRight:function(e){e.preventDefault(),this.focusNext()},_onKeyPressBackspace:function(e){e.preventDefault()},_onChangeFocusedView:function(e,t){var i=this.previous("focusedView");i&&i.setFocused(!1),t&&t.setFocused(!0)},_onChangeSelectedView:function(e,t){var i=this.previous("selectedView");i&&i.setSelected(!1),t&&t.setSelected(!0)},_onSubviewSelect:function(e,t){var i=e!==this.get("selectedView")?e:null,s=n.isEmpty(i)?null:t;this.selectedRecipientModel.set("participant",s),this.set("selectedView",i)},_setIsFocused:function(e){this.rendered&&this.set("isFocused",e)},_onChangeIsFocused:function(e,t){t?(this.keyboardManager.add(this.keyboardNamespace,this),this.trigger("focus",this)):(this.set("focusedView",null),this.keyboardManager.remove(this.keyboardNamespace),this.trigger("blur",this))},_onCollectionChange:function(){this.resetFocus(),this.updateScrollbar()},_onChangeSelectedRecipientModel:function(e,t){var i;return n.isEmpty(t)?void this.set("selectedView",null):(i=n.find(this.resultView,function(e){return e.model.get("uuid")===t.get("uuid")}),void this.set("selectedView",i))}});e.exports=h},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(816),r=i(678),a=s.extend({className:"messaging-share-post-result",tagName:"a",attributes:{href:"#",tabIndex:1},events:{click:"_onSelect",focus:"_onFocus",blur:"_onBlur"},defaults:{isSelected:!1,isFocused:!1,selectedClass:"is-selected",focusedClass:"is-focused"},template:o,initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"onSelect","onFocus","onBlur"))},afterRender:function(){this.listenTo(this,"change:isSelected",this._onChangeIsSelected),this.listenTo(this,"change:isFocused",this._onChangeIsFocused),this.conversationTheme=new r({theme:this.model.get("theme"),el:this.el}).render()},getTemplateData:function(){return{name:this.model.get("name"),title:this.model.get("title"),avatarUrl:this.model.getAvatarUrl(),avatarShape:this.model.getAvatarShape()}},setSelected:function(e){this.rendered&&this.set("isSelected",e)},setFocused:function(e){this.rendered&&this.set("isFocused",e)},_onSelect:function(e){e.preventDefault(),n.isFunction(this.onSelect)&&this.onSelect(this,this.model)},_onFocus:function(e){e.preventDefault(),n.isFunction(this.onFocus)&&this.onFocus(this,this.model)},_onBlur:function(e){e.preventDefault(),n.isFunction(this.onBlur)&&this.onBlur(this,this.model)},_onChangeIsSelected:function(e,t){this.$el.toggleClass(this.get("selectedClass"),t)},_onChangeIsFocused:function(e,t){this.$el.toggleClass(this.get("focusedClass"),t),t&&this.$el.focus()}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="container" data-js-theme-accent-color-on-grey><div class="avatar" data-js-theme-avatar-shape-class><img src="'+(null==(__t=avatarUrl)?"":_.escape(__t))+'" alt="'+(null==(__t=name)?"":_.escape(__t))+'" title="'+(null==(__t=name)?"":_.escape(__t))+'"></div><div class="name">'+(null==(__t=name)?"":_.escape(__t))+'</div><div class="title">',__p+=_.isEmpty(title)?"&nbsp;":""+(null==(__t=title)?"":_.escape(__t)),__p+="</div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="resultView[]"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(620),r=i(162),a=i(385),l=i(276),c=i(626),u=i(819),h=i(821),d=i(823),p=i(844),g=s.extend({className:"messaging-share-post-external-networks",template:p,defaults:{isFocused:!1,focusedView:null,isExternalSharingEnabled:!0},mixins:[r,o,c],keycommands:{"keydown:left":"_onKeyPressLeft","keydown:right":"_onKeyPressRight","keydown:backspace":"_onKeyPressBackspace","keydown:shift+backspace":"_onKeyPressBackspace"},subviews:{networkView:{constructor:h,options:function(e){return{onFocus:n.bind(n.partial(e._setIsFocusedDebounced,!0),e),onBlur:n.bind(n.partial(e._setIsFocusedDebounced,!1),e),onShowSubview:n.bind(e._onShowSubview,e),onShareSuccess:n.bind(e._onShareSuccess,e),onShareFail:n.bind(e._onShareFail,e),onShareClick:n.bind(e._onShareClick,e)}},collection:function(e){return e.collection}}},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"keyboardNamespace","keyboardManager","externalNetworksData")),this._setIsFocusedDebounced=n.debounce(n.bind(this._setIsFocused,this),0),this.keyboardViewName="networkView",this.collection=new u(n.map(this._getExternalNetworks(),function(e){return{component:e}})),this.disableKeys()},afterRenderSubviews:function(){this.listenTo(this.collection,"reset update",this._onCollectionChange),this.listenTo(this,"change:isFocused",this._onChangeIsFocused),this.listenTo(this,"change:focusedView",this._onChangeFocusedView),this.scrollbar=new a(this.$el),this.updateScrollbar(!0)},beforeRemove:function(){this.keyboardManager.remove(this.keyboardNamespace),this.scrollbar&&this.scrollbar.destroy()},resetFocus:function(){this.set("focusedView",null),this.deselect(this.keyboardViewName)},toggle:function(e){this.$el.toggle(e),e||this.resetFocus()},focus:function(){this.focusFirst()},focusFirst:function(){this.set("focusedView",this.selectFirst(this.keyboardViewName))},focusLast:function(){this.set("focusedView",this.selectLast(this.keyboardViewName))},focusNext:function(){this.set("focusedView",this.selectNext(this.keyboardViewName))},focusPrevious:function(){this.set("focusedView",this.selectPrevious(this.keyboardViewName))},isLastFocused:function(){return this.isLastSelected(this.keyboardViewName)},isFirstFocused:function(){return this.isFirstSelected(this.keyboardViewName)},updateScrollbar:function(e){this.rendered&&this.scrollbar&&n.defer(n.bind(this.scrollbar.update,this.scrollbar))},_setIsFocused:function(e){this.rendered&&this.set("isFocused",e)},_getExternalNetworks:function(){var e=this.get("isExternalSharingEnabled"),t=[{Constructor:d.Permalink,options:this._getPermalinkOptions,isExternal:!1},{Constructor:d.Embed,options:this._getEmbedOptions,isExternal:!1},{Constructor:d.Facebook,options:this._getFacebookOptions,isExternal:!0},{Constructor:d.Twitter,options:this._getTwitterOptions,isExternal:!0},{Constructor:d.Pinterest,options:this._getPinterestOptions,isIncluded:this._isShowPinterest,isExternal:!0},{Constructor:d.Reddit,options:this._getRedditOptions,isExternal:!0},{Constructor:d.Email,options:this._getEmailOptions,isExternal:!0},{Constructor:d.Flag,options:this._getFlagOptions,isExternal:!1}];return n.reduce(t,n.bind(function(t,i){var s;return!e&&i.isExternal?t:n.isFunction(i.isIncluded)&&!i.isIncluded.call(this)?t:(s=new i.Constructor(this._getBaseAndNetworkOptions(i.options.call(this))),t.push(s),t)},this),[])},_getPermalinkOptions:function(){return{}},_getEmbedOptions:function(){return{}},_getEmailOptions:function(){return{}},_getTwitterOptions:function(){var e=n.get(this.externalNetworksData,"twitter_username");return{isPopup:n.isEmpty(e),username:e}},_getFacebookOptions:function(){return{isPopup:!n.get(this.externalNetworksData,"has_facebook",!1)}},_getPinterestOptions:function(){var e=n.get(this.externalNetworksData,"pinterest_share_window"),t=n.get(e,"url"),i=n.get(e,"dimensions");return{popupOptions:i,popupUrl:t}},_isShowPinterest:function(){return n.get(this.externalNetworksData,"show_pinterest",!0)},_getRedditOptions:function(){return{}},_getFlagOptions:function(){return{}},_getBaseExternalNetworkOptions:function(){var e=new l(this.externalNetworksData);return{postModel:e}},_getBaseAndNetworkOptions:function(e){return this._baseExternalNetworkOptions||(this._baseExternalNetworkOptions=this._getBaseExternalNetworkOptions()),n.extend({},this._baseExternalNetworkOptions,e)},_onKeyPressLeft:function(e){e.preventDefault(),this.focusPrevious()},_onKeyPressRight:function(e){e.preventDefault(),this.focusNext()},_onKeyPressBackspace:function(e){e.preventDefault()},_onChangeFocusedView:function(e,t){var i=this.previous("focusedView");i&&i.setFocused(!1),t&&t.setFocused(!0)},_onChangeIsFocused:function(e,t){t?(this.keyboardManager.add(this.keyboardNamespace,this),this.trigger("focus",this)):(this.set("focusedView",null),this.keyboardManager.remove(this.keyboardNamespace),this.trigger("blur",this))},_onCollectionChange:function(){this.resetFocus(),this.updateScrollbar()},_onShowSubview:function(e){this.trigger("share:subview:show",e)},_onShareSuccess:function(e){this.trigger("share:success",e)},_onShareFail:function(e){this.trigger("share:fail",e)},_onShareClick:function(e){this.trigger("share:click",e)}});e.exports=g},function(e,t,i){"use strict";var n=i(119),s=i(820),o=n.extend({model:s});e.exports=o},function(e,t,i){"use strict";var n=i(114),s=n.extend({defaults:{component:null}});e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(822),r=s.extend({className:"messaging-share-post-external-network",tagName:"a",attributes:{href:"#",tabIndex:1},events:{focus:"_onFocus",blur:"_onBlur",click:"_onClick"},defaults:{isFocused:!1,focusedClass:"is-focused"},template:o,initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"onFocus","onBlur","onShareSuccess","onShareFail","onShareClick","onShowSubview")),this.component=this.model.get("component")},getTemplateData:function(){return{label:this.component.getLabel()}},afterRender:function(){this.listenTo(this,"change:isFocused",this._onChangeIsFocused),this.listenTo(this.component,"share:fail",this._onShareFail),this.listenToOnce(this.component,"share:success",this._onShareSuccess),this._setLinkClass(),this._setLinkHref()},remove:function(){this.stopListening(this.component)},setFocused:function(e){this.rendered&&this.set("isFocused",e)},_setLinkHref:function(){var e=this.component.getButtonHref();n.isEmpty(e)||this.$el.attr({href:e,target:"_blank"})},_setLinkClass:function(){this.$el.addClass("network--"+this.component.getName())},_onFocus:function(e){e.preventDefault(),n.isFunction(this.onFocus)&&this.onFocus(this,this.model)},_onBlur:function(e){e.preventDefault(),n.isFunction(this.onBlur)&&this.onBlur(this,this.model)},_onClick:function(e){this.onShareClick&&this.onShareClick(this.component),this.component.isTypeHref()||(e.preventDefault(),this.component.isTypeCallback()?this.component.onClickHandler(e):this.component.isTypePopup()?this._openShareWindow():this.component.isTypeSubview()&&this.component.getSubviewInstance().then(n.bind(function(e){n.isFunction(this.onShowSubview)&&this.onShowSubview(e)},this))["catch"](n.bind(function(e){},this)))},_openShareWindow:function(){var e=this.component.getPopupUrl(),t=this.component.getPopupOptions(),i=this.component.getName();n.isEmpty(e)||window.open(e,i+"-share-dialog",t)},_onChangeIsFocused:function(e,t){this.$el.toggleClass(this.get("focusedClass"),t),t&&this.$el.focus()},_onShareSuccess:function(){n.isFunction(this.onShareSuccess)&&this.onShareSuccess(this.component)},_onShareFail:function(){n.isFunction(this.onShareFail)&&this.onShareFail(this.component)}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+=""+(null==(__t=label)?"":_.escape(__t));return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(824),s=i(830),o=i(831),r=i(832),a=i(833),l=i(834),c=i(837),u=i(841);e.exports={Facebook:n,Reddit:s,Pinterest:o,Permalink:r,Embed:l,Flag:a,Email:c,Twitter:u}},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(101),r=i(825),a=i(827),l=r.extend({defaults:{isPopup:!0,username:null,getUsernameUrl:"/svc/facebook_status"},getName:function(){return"facebook"},getLabel:function(){return o("Facebook")},getType:function(){return this.get("isPopup")?r.TYPE_POPUP:r.TYPE_SUBVIEW},getPopupOptions:function(){return"width=626,height=436"},getPopupUrl:function(){var e=this.getPostTinyUrl()||this.getPostUrl();return"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(e)},getSubviewConstructor:function(){return a},getSubviewOptions:function(){return{username:this.get("username")}},afterSubviewCreated:function(e){s.isEmpty(this.get("username"))&&this._getUsername().then(s.bind(function(t){this.set("username",t),e.set("username",t)},this))},_getUsername:function(){return n.ajax({url:this.get("getUsernameUrl"),method:"POST",with_form_key:!0})}});e.exports=l},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(121),r=i(144),a=i(826),l=r.extend({name:"BaseExternalNetwork",initialize:function(e){s.extend(this.attributes,s.pick(e,s.keys(this.defaults))),s.extend(this,s.pick(e,"postModel"))},getName:function(){return null},getLabel:function(){return null},getType:function(){return l.TYPE_POPUP},getPopupUrl:function(){return null},getPopupOptions:function(){return null},getSubviewConstructor:function(){return null},getSubviewOptions:function(){return null},getButtonHref:function(){return null},onClickHandler:function(e){},getPostModel:function(){return this.postModel},getPostUrl:function(){return this.postModel.get("post_url")},getPostTinyUrl:function(){return this.postModel.get("post_tiny_url")},getShareUrl:function(){return"/svc/share/"+this.getName()},isTypePopup:function(){return this.isTypeEqual(l.TYPE_POPUP)},isTypeSubview:function(){return this.isTypeEqual(l.TYPE_SUBVIEW)},isTypeCallback:function(){return this.isTypeEqual(l.TYPE_CALLBACK)},isTypeHref:function(){return this.isTypeEqual(l.TYPE_HREF)},isTypeEqual:function(e){return this.getType()===e},createSubviewInstance:function(e){var t,i,n;return t=this.getSubviewConstructor(),s.isEmpty(t)?null:t.prototype instanceof a?(i=s.extend({},this.getSubviewOptions(),e),n=new t(i),this.listenToOnce(n,"remove",function(e){this.stopListening(e),this.afterSubviewRemoved(e)}),this.listenTo(n,"share",function(e,t){this.onSubviewShare(e,t)}),this.afterSubviewCreated(n),n):null},getSubviewInstance:function(e){var t=o.defer(),i=this.createSubviewInstance(e);return s.isEmpty(i)?t.reject("Could not create external network subview (subview constructor must extend ExternalNetworkEmbedSubview)."):t.resolve(i),t.promise},getShareRequestDataFromSubviewData:function(e){return e},sendShareRequest:function(e){return n.ajax({url:this.getShareUrl(),method:"POST",with_form_key:!0,data:e})},onSubviewShare:function(e,t){var i=this.getShareRequestDataFromSubviewData(e),n=s.extend({},this._getBaseShareRequestData(),i);return this._beforeShare(t,e),this.sendShareRequest(n).then(s.bind(function(){this._afterShareSuccess(t,e),this._afterShare(t,e)},this)).fail(s.bind(function(){this._afterShareFail(t,e),this._afterShare(t,e)},this))},afterSubviewCreated:function(e){},afterSubviewRemoved:function(e){},_getBaseShareRequestData:function(){var e=this.getPostModel(),t={post_id:e.get("post_id"),tumblelog_name:e.get("tumblelog_name")};return this.isTypeSubview()||s.extend(t,{share_fallback:!0}),t},_beforeShare:function(e,t){e.set({isSharing:!0,isShareSuccess:!1,isShareFail:!1}),this.trigger("share:start")},_afterShareSuccess:function(e,t){e.set({isShareSuccess:!0,isShareFail:!1}),e.onShareSuccess(t),this.trigger("share:success")},_afterShareFail:function(e,t){e.set({isShareFail:!0,isShareSuccess:!1}),e.onShareFail(t),this.trigger("share:fail")},_afterShare:function(e,t){e.set("isSharing",!1),e.afterShare(t),this.trigger("share:finished")}},{TYPE_POPUP:"popup",TYPE_SUBVIEW:"subview",TYPE_CALLBACK:"callback",TYPE_HREF:"href"});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(156),o=s.extend({defaults:{isSharing:!1,isShareSuccess:!1,isShareFail:!1},initialize:function(e){n.extend(this.attributes,n.pick(e,n.keys(this.defaults)))},getTitle:function(){return null},onShareSuccess:function(e){},onShareFail:function(e){},afterShare:function(e){},isShareSuccess:function(){return this.get("isShareSuccess")},isShareFail:function(){return this.get("isShareFail")},share:function(e){this.trigger("share",e,this)},close:function(){this.trigger("close",this)},remove:function(){return this.trigger("remove",this),s.prototype.remove.apply(this,arguments)}});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(828),r=i(829),a=i(205),l=o.extend({className:"external-network-facebook-subview external-network-form-subview",template:r,mixins:[a],defaults:n.defaults({username:null,characterLimit:255},o.prototype.defaults),getTitle:function(){var e=this.get("username");return n.isEmpty(e)?s("Facebook"):s("Facebook (%1$s)",e)},afterRender:function(){this.listenTo(this,"change:username",this._onChangeUsername),n.defer(n.bind(this.focus,this)),o.prototype.afterRender.apply(this,arguments)},getTemplateData:function(){return{characterLimit:this.get("characterLimit")}},focus:function(){this.js$("message").focus()},onFormSubmit:function(e){var t=this.js$("message").val();this.share({message:t})},_onChangeUsername:function(){this.trigger("changeTitle",this.getTitle())}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(826),r=i(617),a=i(205),l=o.extend({tagName:"form",mixins:[a],className:"external-network-form-subview",defaults:n.defaults({isFormValid:!1,isShowConfetti:!0},o.prototype.defaults),events:{"click [data-js-success-container]":"_onSuccessContainerClick",submit:"_onFormSubmit"},initialize:function(e){n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),o.prototype.initialize.apply(this,arguments)},afterRender:function(){var e=this.getSubmitButtonElement();this.listenTo(this,"change:isFormValid",this._onChangeIsFormValid),this.listenTo(this,"change:isSharing",this._onChangeIsSharing),n.isEmpty(e)||(this.submitTextDefault=e.text(),this.submitTextSending=e.attr("data-text-sending")||s("Sending...")),this.validateForm(),this._setSubmitButtonState(),this._toggleElement(this.getShareFailElement(),!1),this._toggleElement(this.getShareSuccessElement(),!1)},getSubmitButtonElement:function(){return this.js$("submit-button")},getShareSuccessElement:function(){return this.js$("success-container")},getShareFailElement:function(){return this.js$("fail-container")},onShareSuccess:function(e){var t,i=this.getShareSuccessElement();this._toggleElement(i,!0),this._toggleElement(this.getShareFailElement(),!1),i&&this.get("isShowConfetti")&&(t=this._createConfettiView(),i.append(t.render().$el))},onShareFail:function(e){this._toggleElement(this.getShareFailElement(),!0),this._toggleElement(this.getShareSuccessElement(),!1)},isFormFieldsValid:function(){return!0},validateForm:function(){this.set("isFormValid",this.isFormFieldsValid())},setFormIsValid:function(e){this.set("isFormValid",e)},isFormValid:function(){return this.get("isFormValid")},onFormSubmit:function(e){},_createConfettiView:function(){return new r({className:"external-network-form-subview-confetti",autoParty:!0,amount:30,speed:.2})},_setSubmitButtonState:function(){var e=this.getSubmitButtonElement(),t=this.get("isFormValid"),i=this.get("isSharing"),n=!t||i;e.prop("disabled",n),e.text(i?this.submitTextSending:this.submitTextDefault)},_onChangeIsSharing:function(e,t){this._setSubmitButtonState()},_onChangeIsFormValid:function(e,t){this._setSubmitButtonState()},_onSuccessContainerClick:function(e){this.close()},_toggleElement:function(e,t){n.isEmpty(e)||e.toggleClass("visible",t)},_onFormSubmit:function(e){e.preventDefault(),this.onFormSubmit(e)}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="form-main"><textarea data-js-message maxlength="'+(null==(__t=characterLimit)?"":_.escape(__t))+'" placeholder="'+(null==(__t=__("Message (Optional)"))?"":_.escape(__t))+'" class="message textarea" aria-label="'+(null==(__t=__("Optional Facebook message content"))?"":_.escape(__t))+'"></textarea></div><div class="form-result form-result--fail" data-js-fail-container> '+(null==(__t=__("Something went screwy."))?"":_.escape(__t))+' </div><footer class="footer"><button type="submit" class="button tx-button blue" data-js-submit-button data-js-text-sending="'+(null==(__t=__("Sending..."))?"":_.escape(__t))+'">'+(null==(__t=__("Send"))?"":_.escape(__t))+'</button></footer><div class="form-result form-result--success" data-js-success-container> '+(null==(__t=__("Post shared!"))?"":_.escape(__t))+" </div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(101),s=i(825),o=s.extend({getName:function(){return"reddit"},getLabel:function(){return n("Reddit")},getPopupOptions:function(){return"scrollbars=1,width=860,height=600"},getPopupUrl:function(){return"https://reddit.com/submit?url="+encodeURIComponent(this.getPostUrl())}});e.exports=o},function(e,t,i){"use strict";var n=i(101),s=i(825),o=s.extend({defaults:{popupUrl:null,popupOptions:null},getName:function(){return"pinterest"},getLabel:function(){return n("Pinterest")},getPopupOptions:function(){return this.get("popupOptions")},getPopupUrl:function(){return this.get("popupUrl")}});e.exports=o},function(e,t,i){"use strict";var n=i(101),s=i(825),o=s.extend({getName:function(){return"permalink"},getLabel:function(){return n("Permalink")},getType:function(){return s.TYPE_HREF},getButtonHref:function(){return this.getPostUrl()}});e.exports=o},function(e,t,i){"use strict";var n=i(110),s=i(101),o=i(825),r=o.extend({getName:function(){return"flag"},getLabel:function(){return s("Report")},getType:function(){return o.TYPE_CALLBACK},onClickHandler:function(e){n.trigger("abuseform:open",{mode:"post",post:this.getPostModel()})}});e.exports=r},function(e,t,i){"use strict";var n=i(101),s=i(825),o=i(835),r=s.extend({getName:function(){return"embed"},getLabel:function(){return n("Embed")},getType:function(){return s.TYPE_SUBVIEW},getSubviewConstructor:function(){return o},getSubviewOptions:function(){return{embedCode:this.postModel.getEmbedCode()}}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(826),r=i(836),a=i(205),l=o.extend({tagName:"form",className:"external-network-embed-subview external-network-form-subview",defaults:{embedCode:null},mixins:[a],events:{"click [data-js-embed-code]":"_onEmbedCodeClick"},template:r,getTitle:function(){return s("Embed")},getTemplateData:function(){return{embedCode:this.get("embedCode")}},afterRender:function(){n.defer(n.bind(this.selectEmbedCode,this))},selectEmbedCode:function(){var e=this.js$("embed-code");e.focus(),e.select()},_onEmbedCodeClick:function(e){this.selectEmbedCode()}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="form-main"><textarea spellcheck="false" readonly="readonly" data-js-embed-code class="embed-code textarea" aria-label="'+(null==(__t=__("Embed code"))?"":_.escape(__t))+'">'+(null==(__t=embedCode)?"":_.escape(__t))+"</textarea></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(825),r=i(838),a=o.extend({getName:function(){return"email"},getLabel:function(){return s("Email")},getType:function(){return o.TYPE_SUBVIEW},getSubviewConstructor:function(){return r},getShareRequestDataFromSubviewData:function(e){var t={message:n.get(e,"message"),email_address:n.get(e,"email")};return n.get(e,"isAllowReply",!1)&&n.extend(t,{allow_reply_to:!0}),t}});e.exports=a},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(839),r=i(828),a=i(840),l=r.extend({className:"external-network-email-subview external-network-form-subview",template:a,events:n.defaults({"input [data-js-email]":"_onEmailInput"},r.prototype.events),getTitle:function(){return s("Email")},afterRender:function(){n.defer(n.bind(this.focus,this)),r.prototype.afterRender.apply(this,arguments)},focus:function(){this.js$("email").focus()},isFormFieldsValid:function(){return o.isEmail(this.js$("email").val())},onFormSubmit:function(e){var t,i,n;this.isFormValid()&&(t=this.js$("email").val(),i=this.js$("message").val(),n=this.js$("allow-reply-checkbox").is(":checked"),this.share({email:t,message:i,isAllowReply:n}))},_onEmailInput:function(e){this.validateForm()}});e.exports=l},function(e,t,i){"use strict";var n=i(9),s={isBlank:function(e){return""===n.trim(e)},minLength:function(e,t){return e.length>=t},maxLength:function(e,t){return e.length<=t},range:function(e,t,i){return e.length>=t&&e.length<=i},pattern:function(e,t){return!!new RegExp(t,"gi").test(e)},isEmail:function(e){return this.pattern(e,"^[a-zA-Z0-9._+-]+@[a-zA-Z0-9][a-zA-Z0-9.-]*[.]{1}[a-zA-Z]{2,20}$")},isUrl:function(e){return this.pattern(e,"^\\s*((https?:)?[/\\\\]+)?([a-z0-9_-]+\\.){1,}([a-z\\.]{2,6})(/[^\\s]*)?\\s*$")},equals:function(e,t){return e===t}};e.exports=s},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="form-main"><input type="email" data-js-email placeholder="'+(null==(__t=__("To email"))?"":_.escape(__t))+'" class="email input" aria-label="'+(null==(__t=__("To email"))?"":_.escape(__t))+'"><textarea maxlength="255" data-js-message placeholder="'+(null==(__t=__("Message (Optional)"))?"":_.escape(__t))+'" class="message textarea" aria-label="'+(null==(__t=__("Optional email message content"))?"":_.escape(__t))+'"></textarea><label class="reply-option"><span class="binary-switch reply-switch"><input type="checkbox" data-js-allow-reply-checkbox> <span class="binary-switch-track"></span><span class="binary-switch-button"></span></span> '+(null==(__t=__("Let them reply to my email address"))?"":_.escape(__t))+' </label></div><div class="form-result form-result--fail" data-js-fail-container> '+(null==(__t=__("Something went screwy."))?"":_.escape(__t))+' </div><footer class="footer"><button type="submit" class="button tx-button blue" data-js-submit-button data-js-text-sending="'+(null==(__t=__("Sending..."))?"":_.escape(__t))+'">'+(null==(__t=__("Send"))?"":_.escape(__t))+'</button></footer><div class="form-result form-result--success" data-js-success-container> '+(null==(__t=__("Post shared!"))?"":_.escape(__t))+" </div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(101),s=i(825),o=i(842),r=s.extend({defaults:{isPopup:!0,username:null,urlToken:"[URL]"},getName:function(){return"twitter"},getLabel:function(){return n("Twitter")},getType:function(){return this.get("isPopup")?s.TYPE_POPUP:s.TYPE_SUBVIEW},getPopupUrl:function(){var e=this.getPostTinyUrl()||this.getPostUrl();return"https://twitter.com/intent/tweet?url="+encodeURIComponent(e)},getPopupOptions:function(){return"width=550,height=420"},getSubviewConstructor:function(){return o},getSubviewOptions:function(){return{username:this.get("username"),urlToken:this.get("urlToken")}}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(828),r=i(843),a=i(205),l=o.extend({className:"external-network-twitter-subview external-network-form-subview",template:r,mixins:[a],defaults:n.defaults({username:null,urlToken:"[URL]",shortUrlLength:23,characterLimit:140,characterCount:0,characterCountExceedsLenghClass:"exceeds-length"},o.prototype.defaults),events:n.defaults({"input [data-js-message]":"_onMessageInput"},o.prototype.events),getTitle:function(){var e=this.get("username");return n.isEmpty(e)?s("Twitter"):s("Twitter (@%1$s)",e)},getTemplateData:function(){return{urlToken:this.get("urlToken")}},afterRender:function(){this.listenTo(this,"change:characterCount",this._onChangeCharacterCount),this._updateCharacterCount(),this._onChangeCharacterCount(this,this.get("characterCount")),n.defer(n.bind(this.focus,this)),o.prototype.afterRender.apply(this,arguments)},isFormFieldsValid:function(){var e=this.get("characterCount");return e>0&&e<=this.get("characterLimit")},onFormSubmit:function(e){this.isFormValid()&&this.share({message:this._getMessage()})},focus:function(){this.js$("message").focus()},_getMessage:function(){return this.js$("message").val()},_updateCharacterCount:function(){var e=this._calculateCharacterCount(this._getMessage());this.set("characterCount",e)},_updateCharacterCountContainer:function(e){var t=this.js$("character-count"),i=this.get("characterCountExceedsLenghClass"),n=this.get("characterLimit")-e;t.text(n).toggleClass(i,0>n)},_getUrlTokenCountFromMessage:function(e){var t=this.get("urlToken"),i=new RegExp(n.escapeRegExp(t),"ig"),s=e.match(i);return n.isEmpty(s)?0:s.length},_getAdditionalUrLengthFromMessage:function(e){var t=this.get("urlToken"),i=this.get("shortUrlLength"),n=this._getUrlTokenCountFromMessage(e);return 0===n?0:n*i-n*t.length},_calculateCharacterCount:function(e){return e.length+this._getAdditionalUrLengthFromMessage(e)},_onChangeCharacterCount:function(e,t){this._updateCharacterCountContainer(t)},_onMessageInput:function(e){this._updateCharacterCount(),this.validateForm()}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<form class="form-main"><textarea data-js-message placeholder="'+(null==(__t=__("Message (Optional)"))?"":_.escape(__t))+'" class="message textarea" aria-label="'+(null==(__t=__("Optional Twitter message content"))?"":_.escape(__t))+'"> '+(null==(__t=urlToken)?"":_.escape(__t))+'</textarea></form><div class="form-result form-result--fail" data-js-fail-container> '+(null==(__t=__("Something went screwy."))?"":_.escape(__t))+' </div><footer class="footer"><button type="submit" class="button tx-button blue" data-js-submit-button data-js-text-sending="'+(null==(__t=__("Sending..."))?"":_.escape(__t))+'">'+(null==(__t=__("Send"))?"":_.escape(__t))+'</button><div data-js-character-count class="character-count"></div></footer><div class="form-result form-result--success" data-js-success-container> '+(null==(__t=__("Post shared!"))?"":_.escape(__t))+" </div>";
return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div data-subview="networkView[]"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(846),r=i(205),a=i(162),l=s.extend({className:"messaging-share-post-external-network-subview-wrapper",template:o,mixins:[r,a],events:{"click [data-js-back-button]":"_onBackButtonClick"},keycommands:{"keydown:escape":"_onKeyPressEscape"},initialize:function(e){n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,"externalNetworkSubview"))},getTemplateData:function(){return{title:this.externalNetworkSubview.getTitle()}},afterRender:function(){this.externalNetworkSubview.render(),this.listenTo(this.externalNetworkSubview,"changeTitle",this._onSubviewChangeTitle),this.listenToOnce(this.externalNetworkSubview,"close",this._onSubviewClose),this.js$("external-network-subview").html(this.externalNetworkSubview.$el)},goBack:function(){this.trigger("goBack")},close:function(){this.trigger("close")},remove:function(){return this.externalNetworkSubview.remove(),s.prototype.remove.apply(this,arguments)},_onSubviewChangeTitle:function(e){this.js$("title").text(e)},_onSubviewClose:function(){this.close()},_onBackButtonClick:function(e){e.preventDefault(),this.goBack()},_onKeyPressEscape:function(e){e.preventDefault(),this.externalNetworkSubview.isShareSuccess()?this.close():this.goBack()}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="header"><a href="#" data-js-back-button class="back-button">'+(null==(__t=__("Back"))?"":_.escape(__t))+'</a><div data-js-title class="title">'+(null==(__t=title)?"":_.escape(__t))+'</div></div><div class="external-network-subview" data-js-external-network-subview></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(205),r=i(848),a=s.extend({className:"messaging-share-post-error",mixins:[o],template:r,defaults:{title:null},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults)))},setTitle:function(e){this.set("title",e)},getTemplateData:function(){return{title:this.get("title")}},afterRender:function(){this.listenTo(this,"change:title",this._onChangeTitle)},_onChangeTitle:function(e,t){this.js$("title").text(t)}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="<p data-js-title>"+(null==(__t=title)?"":_.escape(__t))+"</p>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(686),o=i(554),r=s.extend({className:"conversation-compose-plugin conversation-compose-plugin--blog-selector",defaults:n.defaults({currentTumblelog:null},s.prototype.defaults),renderWithTemplate:n.noop,initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults)));var t=n.extend({className:"conversation-compose-plugin-blog-selector",showName:!1,showCaret:!1},n.pick(e,"collection","currentTumblelog","popoverOptions"));this.blogSelectorView=new o(t)},afterRender:function(){this.blogSelectorView.render(),this.$el.html(this.blogSelectorView.el)},getName:function(){return"blog-selector"},getBlogSelector:function(){return this.blogSelectorView}});e.exports=r},function(e,t,i){"use strict";var n=i(114),s=n.extend({defaults:{participant:null}});e.exports=s},function(e,t,i){"use strict";var n=i(144),s=i(852),o=n.extend({name:"FlatSelect",view:function(e){return new s(e)}});e.exports=o},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(149),r=o.extend({el:"body",defaults:{},events:{"change .flat_select select":"__selectChange"},__selectChange:function(e){var t=n(e.currentTarget);this.updateSelect(t)},initialize:function(e){this.options=s.extend({},this.defaults,e)},updateSelect:function(e){var t=e.siblings("label");t.text(e.find(":selected").text())}});e.exports=r},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(110),r=i(204),a=i(211),l=i(106),c=i(854),u=s.extend({className:"popover--message-controls-popover",mixins:[r,a],template:c,events:{'click [data-action="delete"]':"_delete",'click [data-action="block"]':"_block",'click [data-action="flag"]':"_flag"},initialize:function(e){this.options=n.extend({},e),this.showFlagAndBlock=this.options.blockString&&this._notUsersOwnBlog(),this.post=e.post},_getSender:function(){return this.options.blockString&&-1===this.options.blockString.indexOf(":")?this.options.blockString:!1},_notUsersOwnBlog:function(){var e=this._getSender();if(e){var t=l.get("Context/userinfo/channels");return t=n.pluck(t,"name"),!n.includes(t,e)}return!0},_delete:function(e){e.preventDefault(),this.post["delete"](e)},_block:function(e){e.preventDefault(),this.post.block(e)},_flag:function(e){e.preventDefault();var t={mode:"message",post:this.post.model},i=this._getSender();i&&(t.sender=i),o.trigger("abuseform:open",t)},render:function(){return this.$el.html(this.template()),this},teardown:function(){return this.$el.remove(),this}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="popover popover_menu popover_gradient message-controls-popover"><div class="popover_inner"><ul> ',this.showFlagAndBlock&&(__p+=' <li class="popover_menu_item" data-action="block" data-block="'+(null==(__t=this.options.blockString)?"":_.escape(__t))+'"><a class="popover_menu_item_anchor" href="#">'+(null==(__t=__("Block"))?"":_.escape(__t))+'</a></li><li class="popover_menu_item" data-action="flag"><a class="popover_menu_item_anchor" href="#">'+(null==(__t=__("Flag"))?"":_.escape(__t))+"</a></li> "),__p+=' <li class="popover_menu_item" data-action="delete" data-confirm="'+(null==(__t=__("Are you sure you want to delete this?"))?"":__t)+'"><a class="popover_menu_item_anchor" href="#">'+(null==(__t=__("Delete"))?"":_.escape(__t))+"</a></li></ul></div></div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";function n(e){return new s(e)}var s=i(856);e.exports=n},function(e,t,i){"use strict";var n=i(3),s=i(9),o=i(156),r=i(110),a=i(857),l=i(858),c=i(860),u=i(867),h=i(749),d=o.extend({className:"peepr-blog-search",template:a,subviews:{filters:{constructor:l},input:{constructor:c}},events:{"submit .blog-search-form":"formSubmitHandler","click .blog-search-form":"onFormClick","click .clear-search":"clearSearch","click .toggle-search":"toggleSearch"},initialize:function(e){this.options=e,this.searchActive=!1,this.blog=e.blog,this.model=new h({blogname:this.blog.tumblelog_name_or_id,themeParams:this.blog.get("global_theme_params")}),n.each(this.subviews,function(e){e.options=e.options||{},e.options.model=this.model},this),this.bindEvents()},bindEvents:function(){this.listenTo(this.model.posts,"reset",this.onPostsReset),this.listenTo(this.model.posts,"add",this.onPostsAdd),this.listenTo(this.model,"search:reset",this.onSearchReset),this.listenTo(this.model,"change:next_offset",this.onOffsetChange),this.listenTo(this.model,"change:term",n.bind(this.log,this,"search-start",{})),this.listenTo(r,"indashblog:search:fetch-requested",this.onFetchRequested),this.listenTo(r,"indashblog:ready-animation-start",this.onPeeprReady)},onPeeprReady:function(){this.setWidth()},setWidth:function(){var e=this.$el.parents(".navigation_inner"),t=e.width(),i=e.find(".header_controls").outerWidth();this.$el.width(t-i)},onFetchRequested:function(e){this.model.fetch(e)},formSubmitHandler:function(e){e.preventDefault(),this.model.search()},onFormClick:function(e){e.stopPropagation()},toggleSearch:function(e){return e=n.defaults(e,{force:null,focus:!0}),this.model.get("term").length&&null===e.force?void this.clearSearch():(this.searchActive=n.isBoolean(e.force)?e.force:!this.searchActive,this.$el.toggleClass("show-search",this.searchActive),s(".indash_header_wrapper").toggleClass("search-active",this.searchActive),void(this.searchActive?e.focus&&n.delay(n.bind(this.input.focusInput,this.input),300):this.model.reset()))},clearSearch:function(){this.toggleSearch({force:!1}),r.trigger("indashblog:search:clear"),this.log("search-clear")},onSearchReset:function(){var e=this.model.get("term").length>0;this.$el.toggleClass("term-entered",e),e&&(r.trigger("indashblog:search:start"),this.searchActive||this.toggleSearch({focus:!1,force:!0}))},onPostsReset:function(e){e.length&&(r.trigger("indashblog:search:complete",e.toJSON()),this.log("search-complete"))},onOffsetChange:function(e,t){t>=0||(r.trigger("indashblog:search:results-end",this.model.posts.length?null:new u({model:this.model})),this.log("search-results-end"))},onPostsAdd:function(e){r.trigger("indashblog:search:post-added",e.toJSON())},log:function(e,t){var i={loggingData:n.defaults({blogname:this.blog.tumblelog_name_or_id,term:this.model.get("term"),sort:this.model.get("sort"),post_type:this.model.get("post_type"),post_role:this.model.get("post_role"),next_offset:this.model.get("next_offset")},t||{})};r.trigger("peepr-search:"+e,i)},remove:function(){this.model.stopListening(),o.prototype.remove.call(this)}});e.exports=d},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<form class="blog-search-form"><div data-subview="filters"></div><i class="icon_arrow_thin_left clear-search nav_icon"></i><i class="icon_search toggle-search nav_icon"></i><div data-subview="input"></div></form>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(859),r=i(744),a=s.extend({className:"search-filters",template:o,events:{"click .show-filter-popover":"showPopover"},initialize:function(){this.listenTo(this.model,"search:reset",this.hidePopover)},showPopover:function(){this.popover||(this.popover=new r({pinnedTarget:this.$el,model:this.model,preventInteraction:!0}),this.popover.render(),this.listenTo(this.popover,"close",this.onPopoverClose))},hidePopover:function(){this.popover&&this.popover.hide()},onPopoverClose:function(){n.defer(n.bind(function(){this.popover=null},this))}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<i class="icon_filter show-filter-popover nav_icon"></i>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(110),r=i(205),a=i(861),l=i(865),c=i(866),u=s.extend({className:"search-input",template:c,mixins:[r],$$cacheKeys:{"blog-search-input":".blog-search-input"},initialize:function(){this.autocompletePopover=null,this.bindEvents(),this.blogSearchAutocompleteModel=new l({blogname:this.model.get("blogname")})},afterRender:function(){this.blogSearchAutocompleteHelper=new a({model:this.blogSearchAutocompleteModel,el:this.$$(".blog-search-input")})},events:{"focus .blog-search-input":"inputFocusHandler","keyup .blog-search-input":"inputKeyUpHandler","blur .blog-search-input":"inputBlurHandler"},bindEvents:function(){this.listenTo(this.model,"change:term",this.onTermChange),this.listenTo(this.model,"reset",this.onModelReset)},inputKeyUpHandler:function(){this.model.set("unsetTerm",this.getTerm()),this.blogSearchAutocompleteModel.set("matchTerm",this.getTerm())},focusInput:function(){this.$$(".blog-search-input").focus(),this.blogSearchAutocompleteHelper.showPopover()},getTerm:function(){return n.trim(this.$$(".blog-search-input").val())},setTerm:function(e){this.$$(".blog-search-input").val(e).blur()},onTermChange:function(e,t){this.setTerm(t)},onModelReset:function(){this.setTerm("")},inputFocusHandler:function(){o.trigger("indashblog:keycommands:suspend",!0)},inputBlurHandler:function(){o.trigger("indashblog:keycommands:resume")}});e.exports=u},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(862),r=s.extend({events:{click:"showPopover",blur:"onInputBlur"},initialize:function(){this.popover=null,this.bindEvents()},bindEvents:function(){this.listenTo(this.model,"change:matchTerm",this.onMatchTermChange)},onMatchTermChange:function(){this.model.get("typeAheadMatches").length?this.showPopover():this.hidePopover()},showPopover:function(){this.model.getItems().then(n.bind(function(){!this.popover&&this.model.hasMatches()&&(this.popover=new o({pinnedTarget:this.$el,model:this.model,shift:{x:-this.getLeftOffset(),y:0},preventInteraction:!0,keycommands:!0}).render(),this.listenTo(this.popover,"close",this.onPopoverClose))},this))},getLeftOffset:function(){return this._leftOffset=this._leftOffset||this.$el.width()/2,this._leftOffset},onInputBlur:function(){n.delay(n.bind(this.hidePopover,this),100)},hidePopover:function(){this.popover&&this.popover.hide()},onPopoverClose:function(){n.defer(n.bind(function(){this.popover=null},this))}});e.exports=r},function(e,t,i){"use strict";var n=i(745),s=i(863),o=n.extend({className:n.prototype.className+" blog-search-autocomplete-popover",bindEvents:function(){n.prototype.bindEvents.apply(this,arguments),this.listenTo(this,"itemSelected",this.subview.selectTerm)},Subview:s});e.exports=o},function(e,t,i){"use strict";var n=i(9),s=i(110),o=i(156),r=i(864),a=o.extend({template:r,events:{"click [data-term]":"onTermClick"},initialize:function(){this.bindEvents()},bindEvents:function(){this.listenTo(this.model,"change:typeAheadMatches",this.render)},onTermClick:function(e){this.selectTerm(n(e.currentTarget))},selectTerm:function(e){s.trigger("peeprsearch:change:term",{term:e.attr("data-term")})}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{}){__p+='<ul class="popover_inner_list search_filter_items"><li class="popover_header"> '+(null==(__t=__("Popular Tags:"))?"":_.escape(__t))+" </li> ";for(var i=0;i<model.maxRender&&i<model.typeAheadMatches.length;i++)__p+=' <li class="popover_menu_item" data-term="'+(null==(__t=model.typeAheadMatches[i].tag)?"":_.escape(__t))+'"><span class="popover_menu_item_anchor">#'+(null==(__t=model.typeAheadMatches[i].tag)?"":_.escape(__t))+" </span></li> ";__p+=" </ul>"}return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(110),r=i(114),a=i(119),l=r.extend({defaults:{maxRender:20,matchTerm:"",typeAheadMatches:[]},urlRoot:"/svc/search/blog_search_typeahead",url:function(){return this.urlRoot+"/"+this.get("blogname")},initialize:function(){this.items=new a,this.fetched=!1,this.listenTo(o,"peeprsearch:change:unsetTerm",this.onUnsetTermChange),this.listenTo(this,"change:matchTerm sync",this.setMatches)},onUnsetTermChange:function(e){this.set("matchTerm",e.term)},hasMatches:function(){return this.items.length&&this.get("typeAheadMatches").length||!this.fetched},setMatches:function(){var e=this.get("matchTerm");if(!e.length)return void this.set("typeAheadMatches",this.items.toJSON());var t=this.items.filter(function(t){return t.get("tag").indexOf(e)>-1});this.set("typeAheadMatches",s.invoke(t,"toJSON"))},getItems:function(){if(this.items.length){var e=n.Deferred();return e.resolve(),e.promise()}return this.fetch(arguments)},parse:function(e){return this.items.reset(e.tags),this.fetched=!0,s.omit(e,"tags")}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<input type="text" class="blog-search-input" placeholder="'+(null==(__t=__("Search %s",model.blogname))?"":_.escape(__t))+'">';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(110),r=i(156),a=i(868),l=r.extend({className:"search-no-results",template:a,afterRender:function(){this.setHeight(),this.listenTo(o,"DOMEventor:flatresize",s.throttle(this.setHeight,300))},setHeight:function(){var e=n(".indash_blog .posts"),t=e.outerHeight()-e.height(),i=n(".indash_blog .header").height();this.$el.height(n(window).height()-i-t)}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<p class="no-results-text" style="color: '+(null==(__t=model.themeParams.title_color)?"":_.escape(__t))+'">'+(null==(__t=__("Nothing here about<br/>%s.",_.escape(model.term)))?"":__t)+"</p>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";e.exports=i(870)},function(e,t,i){"use strict";var n=i(3),s=i(110),o=i(156),r=i(871),a=i(875),l=o.extend({template:a,className:"messaging-popover-icon nav_icon",events:{click:"_onIconClick"},initialize:function(e){this.options=n.extend({},this.defaults,e),n.extend(this,n.pick(e,"model"))},showPopover:function(){this.popover||(this.popover=new r({pinnedTarget:this.$el,model:this.model,preventInteraction:!0}),this.popover.render(),this.listenTo(this.popover.getView(),"messagingSelected",this._onMessagingSelected),this.listenTo(this.popover.getView(),"askSelected",this._onAskSelected),this.listenTo(this.popover,"close",this._onPopoverClose))},openMessaging:function(){s.trigger("messaging:conversation:open:tumblelogs",[this.model],"peepr")},openAsk:function(){s.trigger("ask:form:open",{recipient:this.model.get("name"),allow_anonymous:this.model.get("anonymous_asks")})},_onIconClick:function(){this.model.get("asks")?this.showPopover():this.openMessaging()},_onMessagingSelected:function(){this.openMessaging()},_onAskSelected:function(){this.openAsk()},_onPopoverClose:function(){this.stopListening(this.popover),this.stopListening(this.popover.getView()),this.popover=null}});e.exports=l},function(e,t,i){"use strict";var n=i(3),s=i(149),o=i(872),r=i(204),a=i(211),l=i(874),c=s.extend({className:"popover--messaging-peepr popover info_popover popover_gradient",template:l,mixins:[r,a],initialize:function(e){this.options=n.extend({},this.defaults,e),this.view=new o({model:this.model})},render:function(){return this.$el.html(this.template),this.$(".popover_inner").append(this.view.render().$el),this.listenTo(this.view,"popoverClose",this.teardown),this},teardown:function(){this.view.remove(),this.remove()},getView:function(){return this.view}});e.exports=c},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(873),r=s.extend({tagName:"ul",template:o,events:{"click [data-js-ask]":"_onClickAsk","click [data-js-message]":"_onClickMessage"},getTemplateData:function(){return{hasMessaging:this.model.get("can_receive_messages")===!0,hasAsks:this.model.get("asks")===!0,url:this.model.get("url")}},_onClickMessage:function(e){e.preventDefault(),this.trigger("messagingSelected"),this.trigger("popoverClose")},_onClickAsk:function(e){e.preventDefault(),this.trigger("askSelected"),n.delay(n.bind(function(){this.trigger("popoverClose")},this),1)}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="",hasAsks&&(__p+=' <li data-js-ask><a class="ask" href="'+(null==(__t=url)?"":_.escape(__t))+'/ask">'+(null==(__t=_("Ask a question"))?"":_.escape(__t))+"</a></li> "),__p+=" ",hasMessaging&&(__p+=' <li data-js-message><a href="#">'+(null==(__t=_("Send a message"))?"":_.escape(__t))+"</a></li> "),__p+="";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="popover_inner"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+=""+(null==(__t=_("Send a message"))?"":_.escape(__t));return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(106),r=s.extend({name:"AdsPaginationHelper",defaults:{nextAdPos:0},initialize:function(){var e=o.get("Components/AdsPaginationHelper");this.adsData=n.extend({},this.defaults,e)},getNextAdPos:function(){return this.adsData.nextAdPos}});e.exports=r},function(e,t,i){"use strict";function n(e){var t=e.filter(function(e){return o.includes(r,e)});return t.join("_")}function s(e){var t=e.closest(".post"),i=o.get(t.data("json"),"post-id")||t.attr("data-post-id"),s=t.find(".note_link_current").data("count"),r=n(e.attr("class").split(" "));return{postId:i,noteCount:s,noteType:r}}var o=i(3),r=["like","reblog","answer","reply","photo","with_commentary"];e.exports=s},function(e,t,i){"use strict";var n=i(3),s=i(144),o=i(110),r=i(879),a=i(888),l=i(605),c=s.extend({name:"PostActivity",defaults:{postModel:null,pinnedTarget:null,shouldFocusReplyField:!1},initialize:function(e){this.popoverOptions=n.pick(e,["popoverContainer"])},render:function(){return this.openPopover(this.popoverOptions),this},openPopover:function(e){var t=this.get("postModel"),i=this.get("pinnedTarget");n.isEmpty(t)||n.isEmpty(i)||(this.keyboardManager=new l,t.has("postActivity")||t.set("postActivity",new r({postTumblelog:t.get("tumblelog"),postCanReply:t.get("can_reply"),postId:t.get("id")},{parse:!0,skipParseLinks:!0,validate:!0})),t.get("postActivity").resetMode(),this._afterPopoverOpen(new a({autoTeardown:!0,pinnedSide:"right",isFixedPosition:!1,pinnedTarget:i,popoverContainer:n.get(e,"popoverContainer"),viewOptions:{keyboardManager:this.keyboardManager,model:t.get("postActivity"),postModel:t,shouldFocusReplyField:this.get("shouldFocusReplyField")}}).render()))},_afterPopoverOpen:function(e){e.fetch(),this.listenToOnce(e,"close",this._onPopoverClose),o.trigger("keycommands:suspend");var t={postId:this.get("postModel").get("id"),noteCount:this.get("pinnedTarget").data("count"),clickTarget:this.get("shouldFocusReplyField")?"reply_icon":"note_link_current"};o.trigger("notes-interactions:open",{loggingData:t})},_onPopoverClose:function(){o.trigger("keycommands:resume")}});e.exports=c},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(114),r=i(601),a=i(595),l=i(198),c=i(756).getRealNow,u=i(880),h=i(881),d=i(883),p=i(886),g=i(885),m=i(887),f=o.extend({urlRoot:function(){return["","svc/tumblelog",this.get("postTumblelog"),this.get("postId"),"notes"].join("/")},url:function(){return[o.prototype.url.apply(this),"?"+n.param(this.pick(["mode"]))].join("")},defaults:{mode:m.CONVERSATION,postTumblelog:"",postCanReply:!1,postId:"",totalNotes:0,totalViews:0},mixins:[r,a],relations:{notes:h,rollupNotes:d},initialize:function(){this._setupLinksByMode(),this.listenTo(this,"change:mode",this._onChangeMode)},parse:function(e){var t=p(e);return t=l(t,0),t.notes=s.sortBy(t.notes,function(e){return parseInt(e.timestamp,10)}),this.get("mode")===m.ROLLUP&&(t={rollupNotes:[s.pick(t,["notes","totalNotes","totalLikes","totalReblogs"])]}),t.rollupNotes&&(t.rollupNotes[0].type=g.LIKES_AND_REBLOGS),t},parsePreviousLink:function(e){var t=p(e),i=s.get(t,"_links.previous"),n=s.get(t,"mode",this.get("mode"));return this._setPreviousLinkForMode(i,n),this._getPreviousLinkForMode(n)},parseNextLink:function(e){var t=p(e),i=s.get(t,"_links.next"),n=s.get(t,"mode",this.get("mode"));return this._setNextLinkForMode(i,n),this._getNextLinkForMode(n)},resetMode:function(){var e=this.get("mode")===m.ROLLUP;e&&this.set("mode",m.CONVERSATION)},_setupLinksByMode:function(){var e=["_nextLinks","_previousLinks"];s.forEach(e,function(e){var t=s.values(m);this[e]=s.reduce(t,function(e,t){return e[t]=[],e},{})},this)},_onChangeMode:function(e,t){this.setPreviousLink(this._getPreviousLinkForMode()),this.setNextLink(this._getNextLinkForMode());var i=t===m.ROLLUP,n=0===this._nextLinks[t].length;i&&n&&this.fetch()},_setNextLinkForMode:function(e,t){t||(t=this.get("mode")),this._nextLinks[t].push(e)},_getNextLinkForMode:function(e){return e||(e=this.get("mode")),s.last(this._nextLinks[e])},_setPreviousLinkForMode:function(e,t){t||(t=this.get("mode")),this._previousLinks[t].push(e)},_getPreviousLinkForMode:function(e){return e||(e=this.get("mode")),s.last(this._previousLinks[e])},createReplyNote:function(e,t,i){i||(i=c()/1e3);var n=e.get("avatar_url"),s=this._getAvatarUrlsForSizes(n,[24,48]);return this.get("notes").add({avatarUrl:s,blogName:e.get("name"),blogUrl:e.get("blog_url"),blogUuid:e.get("uuid"),replyText:t,timestamp:i,type:u.REPLY},{parse:!0,validate:!0})},_getAvatarUrlsForSizes:function(e,t){return s.reduce(t,function(t,i){return t[i]=e.replace(/(_)\d+(\.png)$/,"$1"+i+"$2"),t},{})}});e.exports=f},function(e,t){"use strict";var i={ANSWER:"answer",LIKE:"like",REPLY:"reply",PHOTO:"photo",REBLOG:"reblog",POST_ATTRIBUTION:"post_attribution",POSTED:"posted"};e.exports=i},function(e,t,i){"use strict";var n=i(119),s=i(882),o=n.extend({model:s,comparator:"timestamp"});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(114),o=i(754),r=i(198),a=i(880),l=n.template("<%- blogUuid || blogName %>-<%- timestamp %>-<%- type %>"),c=s.extend({defaults:function(){return{timestamp:0,blogName:"",blogUuid:"",blogUrl:"",type:"",followed:!1,avatarShape:"square",reblogParentBlogName:"",postId:"",addedText:"",avatarUrl:{24:o.get("secureAssets")+"/images/anonymous_avatar_24.gif",48:o.get("secureAssets")+"/images/anonymous_avatar_48.gif"}}},initialize:function(){this.set("id",l(this.pick(["blogName","blogUuid","timestamp","type"])))},parse:function(e){var t=r(e,0);return t.timestamp&&(t.timestamp=parseInt(t.timestamp,10)),t.answerText&&(t.addedText=t.answerText,delete t.answerText),t.replyText&&(t.addedText=t.replyText,delete t.replyText),t},validate:function(e,t){return e.type&&n.includes(a,e.type)?void 0:new Error("Unrecognized note type: "+e.type)},getAvatarUrl:function(e){return n.isUndefined(this.get("avatarUrl")[e])?n.sortBy(this.get("avatarUrl"),function(t){return Math.abs(parseInt(t,10)-e)})[0]:this.get("avatarUrl")[e]}},a);e.exports=c},function(e,t,i){"use strict";var n=i(119),s=i(884),o=n.extend({model:s});e.exports=o},function(e,t,i){"use strict";var n=i(3),s=i(114),o=i(595),r=i(881),a=i(198),l=i(885),c=s.extend({idAttribute:"type",defaults:{totalNotes:0,totalLikes:0,totalReblogs:0},mixins:[o],relations:{notes:r},parse:function(e){var t=a(e,0);return t.notes=n.sortBy(t.notes,function(e){return parseInt(e.timestamp,10)}),t},validate:function(e,t){return e.type&&n.includes(l,e.type)?void 0:new Error("Unrecognized rollup type: "+e.type)}});e.exports=c},function(e,t){"use strict";var i={LIKES:"likes",REBLOGS:"reblogs",LIKES_AND_REBLOGS:"likes_and_reblogs"};e.exports=i},function(e,t,i){"use strict";var n=i(3);e.exports=function(e){return n.get(e,"response",e)}},function(e,t){"use strict";var i={CONVERSATION:"conversation",ROLLUP:"rollup",ALL:"all"};e.exports=i},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(156),r=i(211),a=i(889),l=i(890),c=o.extend({className:"post-activity-popover popover popover_menu popover_gradient",template:a,mixins:[r],subviews:{postActivityView:{constructor:l,options:function(e){return e.viewOptions}}},initialize:function(e){this.viewOptions=n.result(e,"viewOptions",{})},afterRenderSubviews:function(){var e=this.$el.children().first(),t=this.postActivityView.$el.width();e.width(t-t%2),this.reposition(),this.listenToOnce(this.postActivityView,"close",this.teardown),this.listenTo(this.postActivityView.model,"change:totalNotes",this._onChangeTotalNotes)},teardown:function(){return n.invoke(this.postActvitiy,"remove"),this.remove()},fetch:function(){this.postActivityView.fetch()},_onChangeTotalNotes:function(e,t){var i=this._getNotesString(t-1),n=this._getNotesString(t+1),s=this._getNotesString(t);this.$pinned.attr({"data-count":t,"data-less":i,"data-more":n,title:s}).text(s)},_getNotesString:function(e){return 1!==e?s("%1$s notes",e.toLocaleString()):s("%1$s note",e.toLocaleString())}});e.exports=c},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="popover-inner popover_inner"><div class="post-activity-view" data-subview="postActivityView"></div></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(156),r=i(111),a=i(891),l=i(892),c=i(390),u=i(894),h=i(904),d=i(912),p=i(881),g=i(887),m=o.extend({className:function(){return s.compact(["post-activity",this.get("isLoading")?"is-loading":"",this.model.get("postCanReply")?"can-reply":""]).join(" ")},template:a,defaults:{maxHeight:600,isLoading:!1,shouldFocusReplyField:!1},subviews:{postActivityHeader:{constructor:l,options:function(e){return{model:e.model}}},postActivityRollups:{constructor:u,options:function(e){return{model:e.model,collection:e.model.get("rollupNotes")}}},postActivityNotes:{constructor:h,options:function(e){return{model:e.model,collection:new p(null,{parse:!0,validate:!0})}}},postActivityReply:{constructor:d,options:function(e){return{keyboardManager:e.keyboardManager,keyboardNamespace:e.keyboardNamespace+":reply",model:e.model}}}},initialize:function(e){s.extend(this,s.pick(e,["keyboardManager","postModel"])),this.keyboardNamespace="post-activity:"+this.cid},afterRenderSubviews:function(){s.isEmpty(this.loader)&&(this.loader=new c({$container:this.$el,type:"bar",classModifiers:"bottom",loading:!1})),this.listenTo(this.postActivityReply,"submit",this._onReplySubmit),this.listenTo(this.postActivityReply,"resize",this._onReplyResize),this.listenTo(this.postActivityReply,"close",this._onReplyClose),this.listenTo(this,"change:isLoading",this._onChangeIsLoading),this.listenTo(this.model,"change:mode",this._onChangeMode),this._onChangeMode(this.model,this.model.get("mode")),this._updateHeight()},getTemplateData:function(){var e=this.model.get("postCanReply"),t=this.model.get("mode");return{postCanReply:e&&t!==g.ROLLUP}},fetch:function(){this.set("isLoading",!0),this.listenToOnce(this.model,"sync",function(){this.set("isLoading",!1),this.get("shouldFocusReplyField")&&this.postActivityReply.focus();var e=this.model.get("notes");this._resetActiveNotesCollection(e)}),this.model.get("notes").reset(),this.model.get("rollupNotes").reset(),this.throttledFetch()},throttledFetch:s.throttle(function(){this.model.fetch()},1e3,{leading:!0,trailing:!1}),_onChangeMode:function(e,t){var i;switch(t){case g.ALL:case g.CONVERSATION:s.result(this.postActivityRollups,"$el.show"),i=e.get("notes"),this._resetActiveNotesCollection(i),s.result(this.postActivityReply,"$el.show");break;case g.ROLLUP:s.result(this.postActivityRollups,"$el.hide"),i=e.get("rollupNotes").at(0).get("notes"),this._resetActiveNotesCollection(i),s.result(this.postActivityReply,"$el.hide")}},_resetActiveNotesCollection:function(e){s.isEmpty(this.postActivityNotes)||(s.isEmpty(this._activeNotesCollection)||this.stopListening(this._activeNotesCollection),
this._activeNotesCollection=e,this.listenTo(this._activeNotesCollection,"add",s.bind(function(e,t,i){this.postActivityNotes.collection.add(e,{parse:!0,validate:!0})},this)),this.postActivityNotes.collection.reset(this._activeNotesCollection.models,{parse:!0,validate:!0}),this._updateHeight())},_updateHeight:function(){this.$el.css("height",this._getTotalScrollHeight()),this.postActivityNotes.updateScrollbar(),this.postActivityNotes.scrollToBottom()},_onChangeIsLoading:function(e,t){this.$el.toggleClass("is-loading",t),this.postActivityHeader.set("isLoading",t),this.loader.set("loading",t)},_getSubviewScrollHeight:function(e){return s.get(this,e+".el.scrollHeight",0)},_getTotalScrollHeight:function(){var e=s.keys(this.subviews),t=s.map(e,this._getSubviewScrollHeight,this),i=n(window).height(),o=this.get("maxHeight"),r=s.min([o,i-132,s.sum(t)]);return r=Math.ceil(r),r+r%2},_onReplySubmit:function(){var e=this.postActivityReply.get("currentText"),t=r().getChannel();this.postModel.reply(e).done(s.bind(function(i){this.model.createReplyNote(t,e),this.model.set("totalNotes",this.model.get("totalNotes")+1),this._updateHeight()},this))},_onReplyResize:function(){this._updateHeight()},_onReplyClose:function(){this.trigger("close")}});e.exports=m},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="header-container"><div class="header-container-inner"><div class="post-activity-header" data-subview="postActivityHeader"></div><div class="post-activity-rollups" data-subview="postActivityRollups"></div></div><div class="loader" data-subview="loader"></div></div><div class="main-container"><div class="post-activity-notes" data-subview="postActivityNotes"></div></div><div class="footer-container"> ',postCanReply&&(__p+=' <div class="post-activity-reply" data-subview="postActivityReply"></div> '),__p+=" </div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(156),r=i(893),a=o.extend({className:function(){return n.compact(["post-activity-header",this.model.get("mode")]).join(" ")},template:r,defaults:{isLoading:!1},events:{"click .return":"_onClickReturn"},afterRenderSubviews:function(){this.listenTo(this,"change:isLoading",this._onChange),this.listenTo(this.model,"change",this._onChange)},getTemplateData:function(){return{mode:this.model.get("mode"),primaryMessageString:this._getPrimaryMessageString(),secondaryMessageString:this._getSecondaryMessageString()}},_onChange:function(){this.$el.attr("class",n.result(this,"className")),this.stopListening(),this.render()},_onClickReturn:function(e){e.preventDefault(),this.model.set("mode",this.$(".return").data("target-mode"))},_getPrimaryMessageString:function(){var e=this.model.get("totalNotes"),t=this._getNotesString(e),i=s("Loading");return this.get("isLoading")?i:t},_getSecondaryMessageString:function(){var e=this.model.get("totalViews"),t=e?this._getViewsString(e):"",i="";return this.get("isLoading")?i:t},_getNotesString:function(e){return 1!==e?s("%1$s notes",e.toLocaleString()):s("%1$s note",e.toLocaleString())},_getViewsString:function(e){return 1!==e?s("%1$s views",e.toLocaleString()):s("%1$s view",e.toLocaleString())}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="<header> ","rollup"===mode&&(__p+=' <a href="#conversation" class="return" data-target-mode="conversation"></a> '),__p+=' <div class="header-inner"><p class="primary-message">'+(null==(__t=primaryMessageString)?"":_.escape(__t))+"</p> ",_.isEmpty(secondaryMessageString)||(__p+=' <p class="secondary-message">'+(null==(__t=secondaryMessageString)?"":_.escape(__t))+"</p> "),__p+=" </div></header>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(620),r=i(895),a=i(896),l=s.extend({className:"post-activity-rollups",template:r,mixins:[o],events:{"click .rollup-item":"_onClick"},subviews:{postActivityRollup:{constructor:a,collection:function(e){return e.collection}}},afterRenderSubviews:function(){n.defer(n.bind(function(){n.forEach(this.postActivityRollup,function(e){this.listenTo(e,"click:rollup",this._onClickRollup)},this)},this))},_onClick:function(e){e.preventDefault(),this.model.set("mode","rollup")}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<ol class="rollup-list" data-subview="postActivityRollup[]"></ol>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(897),r=i(898),a=s.extend({className:function(){return n.compact(["post-activity-rollup","rollup-item",n.kebabCase(this.model.get("type"))]).join(" ")},tagName:"li",template:o,subviews:{postActivityRollupNotes:{constructor:r,options:function(e){return{model:e.model,collection:e.model.get("notes")}}}}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="post-activity-rollup-notes" data-subview="postActivityRollupNotes"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(156),r=i(620),a=i(899),l=i(900),c=i(881),u=o.extend({className:"post-activity-rollup-notes",template:a,mixins:[r],subviews:{postActivityRollupNote:{constructor:l,enableBatchRendering:!0,collection:function(e){return new c(e.collection.slice(0,8))}}},afterRenderSubviews:function(){this.$el.toggleClass("has-notes",this.collection.length>0),this.listenTo(this.collection,"reset update",this._onResetUpdate)},getTemplateData:function(){return{rollupNotesSummary:this._getRollupNotesSummary()}},_getRollupNotesSummary:function(){var e=this.model.get("totalLikes"),t=this.model.get("totalReblogs"),i=n.escape(e.toLocaleString()),o=n.escape(t.toLocaleString()),r='<span class="rollup-notes-summary-likes">',a='<span class="rollup-notes-summary-reblogs">',l="</span>";return e>1&&t>1?s("%1$s%2$s likes%3$s and %4$s%5$s reblogs%3$s",r,i,l,a,o):e>1&&1===t?s("%1$s%2$s likes%3$s and %4$s%5$s reblog%3$s",r,i,l,a,o):1===e&&t>1?s("%1$s%2$s like%3$s and %4$s%5$s reblogs%3$s",r,i,l,a,o):0===t&&0!==e?e>1?s("%1$s%2$s likes%3$s",r,i,l):s("%1$s%2$s like%3$s",r,i,l):0===e&&0!==t?t>1?s("%1$s%2$s reblogs%3$s",a,o,l):s("%1$s%2$s reblog%3$s",a,o,l):""},_onResetUpdate:function(e,t){this.$el.toggleClass("has-notes",e.length>0)}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<ol class="rollup-note-list" data-subview="postActivityRollupNote[]"></ol><p class="rollup-notes-summary"> '+(null==(__t=rollupNotesSummary)?"":__t)+" </p>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(901),r=i(902),a=s.extend({className:function(){return n.compact(["post-activity-rollup-note","rollup-note-item",n.kebabCase(this.model.get("type")),this.model.get("addedText")?"with-commentary":"without-commentary",this.model.get("followed")?"is-followed":""]).join(" ")},tagName:"li",template:o,subviews:{postActivityNoteAvatar:{constructor:r,options:function(e){return{model:e.model}}}}});e.exports=a},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="post-activity-note-avatar" data-subview="postActivityNoteAvatar"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(903),r=s.extend({className:"post-activity-note-avatar",defaults:{avatarSize:24},template:o,getTemplateData:function(){var e=this.get("avatarSize"),t=this.model.getAvatarUrl(2*e);return n.defaults(this.model.pick(["blogName","blogUrl"]),{avatarSize:e,avatarUrl:t})}});e.exports=r},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<a class="post-activity-avatar-link" href="'+(null==(__t=blogUrl)?"":_.escape(__t))+'" title="'+(null==(__t=blogName)?"":_.escape(__t))+'" target="_blank"><img class="post-activity-avatar-image" src="'+(null==(__t=avatarUrl)?"":_.escape(__t))+'" width="'+(null==(__t=avatarSize)?"":_.escape(__t))+'" height="'+(null==(__t=avatarSize)?"":_.escape(__t))+'" alt="'+(null==(__t=blogName)?"":_.escape(__t))+'"> </a>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(9),s=i(3),o=i(156),r=i(620),a=i(205),l=i(905),c=i(258),u=i(624),h=i(906),d=o.extend({className:"post-activity-notes",template:l,mixins:[r,a],defaults:{isPagingNext:!1},subviews:{nextLoader:{constructor:c,options:{variation:"small h-centered",loading:!1}},postActivityNote:{constructor:h,collection:function(e){return e.collection}}},afterRenderSubviews:function(){this.$el.toggleClass("has-notes",this.collection.length>0),this._setupScrollbar(),this.listenTo(this.collection,"reset update",this._onResetUpdate),this.listenTo(this.model,"change:hasNextPage",this._onChangeHasNextPage),this._onChangeHasNextPage(this.model,this.model.hasNextPage()),this.listenTo(this,"change:isPagingNext",this._onChangeIsPagingNext)},fetchNextPage:function(){return this.model.hasNextPage()?(this.set("isPagingNext",!0),this.model.fetchNextPage()):(new n.Deferred).resolve()},updateScrollbar:function(){s.isUndefined(this.scrollbar)||this.scrollbar.update()},scrollToBottom:function(){this._setScrollTop(this.el.scrollHeight)},_setScrollTop:function(e){this.$el.scrollTop(e)},_setupScrollbar:function(){s.isEmpty(this.scrollbar)&&(this.scrollbar=new u({el:this.el})),this.listenTo(this.scrollbar,"scrolltop",this._onChangeIsAtTop),s.defer(s.bind(function(){this.updateScrollbar(),this.scrollToBottom()},this))},_onResetUpdate:function(e,t){this.$el.toggleClass("has-notes",e.length>0),this.get("isPagingNext")&&this.updateScrollbar(),this.set("isPagingNext",!1)},_onChangeHasNextPage:function(e,t){this.js$("next-loader").toggle(t)},_onChangeIsPagingNext:function(e,t){this.nextLoader.set("loading",t)},_onChangeIsAtTop:function(e){if(e&&this.model.hasNextPage()){var t=this.scrollbar.getCurrentPositions();this.fetchNextPage().always(s.bind(function(){this._setScrollTop(this.el.scrollHeight-(t.scrollBottom+t.height)),this.updateScrollbar()},this))}}});e.exports=d},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="next-loader" data-js-next-loader><div data-subview="nextLoader"></div></div><ol class="note-list" data-subview="postActivityNote[]"></ol>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(156),o=i(907),r=i(902),a=i(908),l=s.extend({className:function(){return n.compact(["post-activity-note","note-item",n.kebabCase(this.model.get("type")),this.model.get("addedText")?"with-commentary":"without-commentary",this.model.get("followed")?"is-followed":""]).join(" ")},tagName:"li",template:o,attributes:function(){var e=this.model.get("blogName"),t=this.model.get("postId"),i=n.omit({tumblelog:e,postId:t},n.isEmpty);return{"data-tumblelog":e,"data-peepr":JSON.stringify(i)}},subviews:{postActivityNoteAvatar:{constructor:r,options:function(e){return{model:e.model}}},postActivityNoteContent:{constructor:a,options:function(e){return{model:e.model}}}}});e.exports=l},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="post-activity-note-avatar" data-subview="postActivityNoteAvatar"></div><div class="post-activity-note-content" data-subview="postActivityNoteContent"></div>';return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(156),r=i(909),a=i(910),l=i(911),c=i(880),u=o.extend({className:"post-activity-note-content",template:r,getTemplateData:function(){var e=this.model.pick(["blogUrl","blogName","type","reblogParentBlogName"]);return n.assign(e,{noteString:this._getNoteString(),addedTextString:this.model.get("addedText")})},_getNoteString:function(){var e=this._getBlogNameLink();switch(this.model.get("type")){case c.ANSWER:case c.LIKE:case c.REPLY:return e;case c.REBLOG:return[e,this._getReblogParentSpan()].join(" ");case c.POST_ATTRIBUTION:return s("%1$s added this GIF to a post",e);case c.POSTED:return s("%1$s posted this",e);default:return""}},_getBlogNameLink:function(){return a(this.model.pick(["blogName","blogUrl"]))},_getReblogParentSpan:function(){return l(this.model.pick(["reblogParentBlogName"]))}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="note-content-inner"><p class="note-text '+(null==(__t=type)?"":_.escape(__t))+'"> '+(null==(__t=noteString)?"":__t)+" </p> ",_.isEmpty(addedTextString)||(__p+=' <p class="note-added-text">'+(null==(__t=addedTextString)?"":_.escape(__t))+"</p> "),__p+=" </div>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<a class="note-text-link" href="'+(null==(__t=blogUrl)?"":_.escape(__t))+'" title="'+(null==(__t=blogName)?"":_.escape(__t))+'" target="_blank"> '+(null==(__t=blogName)?"":_.escape(__t))+" </a>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<span class="note-text-reblog-parent"><span class="reblog-icon"></span>'+(null==(__t=reblogParentBlogName)?"":_.escape(__t))+" </span>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},function(e,t,i){"use strict";var n=i(3),s=i(101),o=i(205),r=i(162),a=i(156),l=i(639),c=i(913),u=a.extend({className:"post-activity-reply",template:c,mixins:[o,r],events:{"click [data-js-submit-button]":"_onSubmitButtonClick","input [data-js-text-input]":"_onTextInputChange","keydown [data-js-text-input]":"_onTextInputKeydown","focus [data-js-text-input]":"_onTextInputFocus","blur [data-js-text-input]":"_onTextInputBlur"},keycommands:{"keydown:escape":"_onKeyPressEscape"},defaults:{isValid:!0,isDisabled:!1,isOffline:!1,placeholder:null,offlinePlaceholder:null,currentPlaceholder:null,currentText:null,hasEditorFocus:!1,isAutoValidationEnabled:!0,buttonSubmittedClass:"submitted",isShufflePlaceholder:!0,animationSpeed:250},subviews:{},initialize:function(e){e=n.extend({},e),n.extend(this.attributes,n.pick(e,n.keys(this.defaults))),n.extend(this,n.pick(e,["keyboardManager","keyboardNamespace"])),this.getRandomPlaceholder=l([s("Add to the discussion"),s("Unleash a compliment"),s("Have something to say?"),s("Reply your heart out"),s("Add something wonderful"),s("Send something nice"),s("Your words here"),s("Say your thing")]),this.set("isShufflePlaceholder",n.isEmpty(this.get("placeholder"))),n.isEmpty(this.get("placeholder"))&&this.set("placeholder",this.getRandomPlaceholder()),this.set("currentPlaceholder",this.get("placeholder")),n.isEmpty(this.get("offlinePlaceholder"))&&this.set("offlinePlaceholder",s("Currently offline")),this.keyboardManager&&this.disableKeys()},afterRenderSubviews:function(){this.listenTo(this,"change:isValid",this._onChangeIsValid),this.listenTo(this,"change:isDisabled",this._onChangeIsDisabled),this.listenTo(this,"change:isOffline",this._onChangeIsOffline),this.listenTo(this,"change:currentPlaceholder",this._onChangeCurrentPlaceholder),this.listenTo(this,"change:currentText",this._onChangeCurrentText),this.listenTo(this,"change:hasEditorFocus",this._onChangeHasEditorFocus),this._onChangeIsValid(this,this.get("isValid")),this._onChangeIsDisabled(this,this.get("isDisabled")),this._onChangeIsOffline(this,this.get("isOffline")),this._onChangeCurrentPlaceholder(this,this.get("currentPlaceholder")),this._onChangeCurrentText(this,this.get("currentText")),this._setValidState(),n.defer(n.bind(function(){this._resizeInput()},this))},getTemplateData:function(){return{placeholderString:this.get("placeholder"),labelString:s("Reply")}},submit:function(){var e=this.get("currentText");this.get("isValid")&&!this.get("isDisabled")&&(this.trigger("submit",e),this.clear())},escape:function(){n.isEmpty(this.get("currentText"))?this.trigger("close"):this.clear()},clear:function(){this.js$("text-input").val(""),this.set("currentText",""),this.get("isShufflePlaceholder")&&this._setPlaceholderState(),this._resizeInput()},focus:function(){n.defer(n.bind(function(){this.rendered&&this.js$("text-input").focus()},this))},beforeRemove:function(){this.keyboardManager&&this.keyboardManager.remove(this.keyboardNamespace)},_onKeyPressEscape:function(e){e.preventDefault(),this.escape()},_onTextInputChange:function(){var e=n.trim(this.js$("text-input").val());this._resizeInput(),this.set("currentText",e),this.trigger("input",e,this)},_setValidState:function(){this.get("isAutoValidationEnabled")&&this.set("isValid",!n.isEmpty(this.get("currentText")))},_resizeInput:function(){var e,t=this.js$("text-input"),i=t.get(0);this._originalInputHeight||(this._originalInputHeight=t.outerHeight()),this.$el.css("height",this.$el.height()),t.css("height","auto"),e=i.scrollHeight,Math.abs(e-this._originalInputHeight)<5&&(e=this._originalInputHeight),t.css("height",e),this.$el.css("height",""),this._detectResize()},_detectResize:function(){var e=this.$el.height();return this._previousHeight?void(e!==this._previousHeight&&(this.trigger("resize",e),this._previousHeight=e)):void(this._previousHeight=e)},_setPlaceholderState:function(){var e=this.get("isShufflePlaceholder")?this.getRandomPlaceholder():this.get("placeholder");this.set("currentPlaceholder",this.get("isOffline")?this.get("offlinePlaceholder"):e)},_onChangeCurrentText:function(e,t){this._setValidState()},_onChangeIsValid:function(e,t){this.js$("submit-button").prop("disabled",!t||this.get("isDisabled"))},_onSubmitButtonClick:function(e){e.preventDefault(),this.submit()},_onChangeIsDisabled:function(e,t){this.js$("text-input").prop("disabled",t),this.js$("submit-button").prop("disabled",t||!this.get("isValid"))},_onChangeIsOffline:function(e,t){this._setPlaceholderState()},_onChangeCurrentPlaceholder:function(e,t){this.js$("text-input").attr("placeholder",t)},_onTextInputFocus:function(){this.set("hasEditorFocus",!0),this.trigger("focus",this),this._resizeInput()},_onTextInputBlur:function(){this.set("hasEditorFocus",!1),this.trigger("blur",this)},_onTextInputKeydown:function(e){13!==e.keyCode||e.shiftKey||(this.submit(),e.preventDefault())},_onChangeHasEditorFocus:function(e,t){this.keyboardManager&&this.keyboardManager.toggle(this.keyboardNamespace,e,t)}});e.exports=u},function(module,exports,__webpack_require__){var _=__webpack_require__(3);module.exports=Function(_.keys(_.templateSettings.imports),"return "+function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="text-input-container"><textarea class="text-input" placeholder="'+(null==(__t=placeholderString)?"":_.escape(__t))+'" rows="1" maxlength="475" data-js-text-input></textarea></div><button type="submit" data-js-submit-button class="submit">'+(null==(__t=labelString)?"":_.escape(__t))+"</button>";return __p}.toString()).apply(void 0,_.values(_.templateSettings.imports))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){}]);