function Sys$Enum$parse(n,t){var i,r,h,f,e,o,s,u,c;if(t){if(i=this.__lowerCaseValues,!i){this.__lowerCaseValues=i={},f=this.prototype;for(e in f)i[e.toLowerCase()]=f[e]}}else i=this.prototype;if(this.__flags){for(o=(t?n.toLowerCase():n).split(","),s=0,u=o.length-1;u>=0;u--){if(c=o[u].trim(),r=i[c],typeof r!="number")throw Error.argument("value",String.format(Sys.Res.enumInvalidValue,n.split(",")[u].trim(),this.__typeName));s|=r}return s}if(h=t?n.toLowerCase():n,r=i[h.trim()],typeof r!="number")throw Error.argument("value",String.format(Sys.Res.enumInvalidValue,n,this.__typeName));return r}function Sys$Enum$toString(n){var r,t,i,u,e,o,f;if(typeof n=="undefined"||n===null)return this.__string;if(r=this.prototype,this.__flags&&n!==0){if(i=this.__sortedValues,!i){i=[];for(t in r)i[i.length]={key:t,value:r[t]};i.sort(function(n,t){return n.value-t.value}),this.__sortedValues=i}for(u=[],e=n,t=i.length-1;t>=0;t--)if((o=i[t],f=o.value,f!==0)&&(f&n)===f&&(u[u.length]=o.key,e-=f,e===0))break;if(u.length&&e===0)return u.reverse().join(", ")}else for(t in r)if(r[t]===n)return t;return""}function Sys$Component$_setProperties(n,t){var u,c=Object.getType(n),e=c===Object||c===Sys.UI.DomElement,l=Sys.Component.isInstanceOfType(n)&&!n.get_isUpdating(),r,i,f,o,s;l&&n.beginUpdate();for(r in t)if(i=t[r],f=e?null:n["get_"+r],e||typeof f!="function")o=n[r],i&&typeof i=="object"&&(!e||o)?Sys$Component$_setProperties(o,i):n[r]=i;else if(s=n["set_"+r],typeof s=="function")s.apply(n,[i]);else if(i instanceof Array){u=f.apply(n);for(var h=0,a=u.length,v=i.length;h<v;h++,a++)u[a]=i[h]}else typeof i=="object"&&Object.getType(i)===Object&&(u=f.apply(n),Sys$Component$_setProperties(u,i));l&&n.endUpdate()}function Sys$Component$_setReferences(n,t){var i,r,u;for(i in t)r=n["set_"+i],u=$find(t[i]),r.apply(n,[u])}var $create,$removeHandler,$get,$find;Function.__typeName="Function",Function.__class=!0,Function.createCallback=function(n,t){return function(){var u=arguments.length,r,i;if(u>0){for(r=[],i=0;i<u;i++)r[i]=arguments[i];return r[u]=t,n.apply(this,r)}return n.call(this,t)}},Function.createDelegate=function(n,t){return function(){return t.apply(n,arguments)}},Function.emptyFunction=Function.emptyMethod=function(){},Function.validateParameters=function(n,t,i){return Function._validateParams(n,t,i)},Function._validateParams=function(n,t,i){var r,e=t.length,u,s,f,o;if(i=i||typeof i=="undefined",r=Function._validateParameterCount(n,t,i),r)return r.popStackFrame(),r;for(u=0,s=n.length;u<s;u++){if(f=t[Math.min(u,e-1)],o=f.name,f.parameterArray)o+="["+(u-e+1)+"]";else if(!i&&u>=e)break;if(r=Function._validateParameter(n[u],f,o),r)return r.popStackFrame(),r}return null},Function._validateParameterCount=function(n,t,i){var r,f,u=t.length,e=n.length,o,s,h;if(e<u){for(o=u,r=0;r<u;r++)s=t[r],(s.optional||s.parameterArray)&&o--;e<o&&(f=!0)}else if(i&&e>u)for(f=!0,r=0;r<u;r++)if(t[r].parameterArray){f=!1;break}return f?(h=Error.parameterCount(),h.popStackFrame(),h):null},Function._validateParameter=function(n,t,i){var r,o=t.type,l=!!t.integer,a=!!t.domElement,v=!!t.mayBeNull,f,e,s,h,u,c;if(r=Function._validateParameterType(n,o,l,a,v,i),r)return r.popStackFrame(),r;if(f=t.elementType,e=!!t.elementMayBeNull,o===Array&&typeof n!="undefined"&&n!==null&&(f||!e))for(s=!!t.elementInteger,h=!!t.elementDomElement,u=0;u<n.length;u++)if(c=n[u],r=Function._validateParameterType(c,f,s,h,e,i+"["+u+"]"),r)return r.popStackFrame(),r;return null},Function._validateParameterType=function(n,t,i,r,u,f){var e,h,o,c,s;if(typeof n=="undefined")return u?null:(e=Error.argumentUndefined(f),e.popStackFrame(),e);if(n===null)return u?null:(e=Error.argumentNull(f),e.popStackFrame(),e);if(t&&t.__enum){if(typeof n!="number")return e=Error.argumentType(f,Object.getType(n),t),e.popStackFrame(),e;if(n%1==0)if(o=t.prototype,t.__flags&&n!==0){c=n;for(h in o)if((s=o[h],s!==0)&&((s&n)===s&&(c-=s),c===0))return null}else for(h in o)if(o[h]===n)return null;return e=Error.argumentOutOfRange(f,n,String.format(Sys.Res.enumInvalidValue,n,t.getName())),e.popStackFrame(),e}return r&&(!Sys._isDomElement(n)||n.nodeType===3)?(e=Error.argument(f,Sys.Res.argumentDomElement),e.popStackFrame(),e):t&&!Sys._isInstanceOfType(t,n)?(e=Error.argumentType(f,Object.getType(n),t),e.popStackFrame(),e):t===Number&&i&&n%1!=0?(e=Error.argumentOutOfRange(f,n,Sys.Res.argumentInteger),e.popStackFrame(),e):null},Error.__typeName="Error",Error.__class=!0,Error.create=function(n,t){var i=new Error(n),r;if(i.message=n,t)for(r in t)i[r]=t[r];return i.popStackFrame(),i},Error.argument=function(n,t){var r="Sys.ArgumentException: "+(t?t:Sys.Res.argument),i;return n&&(r+="\n"+String.format(Sys.Res.paramName,n)),i=Error.create(r,{name:"Sys.ArgumentException",paramName:n}),i.popStackFrame(),i},Error.argumentNull=function(n,t){var r="Sys.ArgumentNullException: "+(t?t:Sys.Res.argumentNull),i;return n&&(r+="\n"+String.format(Sys.Res.paramName,n)),i=Error.create(r,{name:"Sys.ArgumentNullException",paramName:n}),i.popStackFrame(),i},Error.argumentOutOfRange=function(n,t,i){var r="Sys.ArgumentOutOfRangeException: "+(i?i:Sys.Res.argumentOutOfRange),u;return n&&(r+="\n"+String.format(Sys.Res.paramName,n)),typeof t!="undefined"&&t!==null&&(r+="\n"+String.format(Sys.Res.actualValue,t)),u=Error.create(r,{name:"Sys.ArgumentOutOfRangeException",paramName:n,actualValue:t}),u.popStackFrame(),u},Error.argumentType=function(n,t,i,r){var u="Sys.ArgumentTypeException: ",f;return u+=r?r:t&&i?String.format(Sys.Res.argumentTypeWithTypes,t.getName(),i.getName()):Sys.Res.argumentType,n&&(u+="\n"+String.format(Sys.Res.paramName,n)),f=Error.create(u,{name:"Sys.ArgumentTypeException",paramName:n,actualType:t,expectedType:i}),f.popStackFrame(),f},Error.argumentUndefined=function(n,t){var r="Sys.ArgumentUndefinedException: "+(t?t:Sys.Res.argumentUndefined),i;return n&&(r+="\n"+String.format(Sys.Res.paramName,n)),i=Error.create(r,{name:"Sys.ArgumentUndefinedException",paramName:n}),i.popStackFrame(),i},Error.format=function(n){var i="Sys.FormatException: "+(n?n:Sys.Res.format),t=Error.create(i,{name:"Sys.FormatException"});return t.popStackFrame(),t},Error.invalidOperation=function(n){var i="Sys.InvalidOperationException: "+(n?n:Sys.Res.invalidOperation),t=Error.create(i,{name:"Sys.InvalidOperationException"});return t.popStackFrame(),t},Error.notImplemented=function(n){var i="Sys.NotImplementedException: "+(n?n:Sys.Res.notImplemented),t=Error.create(i,{name:"Sys.NotImplementedException"});return t.popStackFrame(),t},Error.parameterCount=function(n){var i="Sys.ParameterCountException: "+(n?n:Sys.Res.parameterCount),t=Error.create(i,{name:"Sys.ParameterCountException"});return t.popStackFrame(),t},Error.prototype.popStackFrame=function(){var r,t;if(typeof this.stack!="undefined"&&this.stack!==null&&typeof this.fileName!="undefined"&&this.fileName!==null&&typeof this.lineNumber!="undefined"&&this.lineNumber!==null){for(var n=this.stack.split("\n"),i=n[0],u=this.fileName+":"+this.lineNumber;typeof i!="undefined"&&i!==null&&i.indexOf(u)===-1;)n.shift(),i=n[0];(r=n[1],typeof r!="undefined"&&r!==null)&&(t=r.match(/@(.*):(\d+)$/),typeof t!="undefined"&&t!==null)&&(this.fileName=t[1],this.lineNumber=parseInt(t[2]),n.shift(),this.stack=n.join("\n"))}},Object.__typeName="Object",Object.__class=!0,Object.getType=function(n){var t=n.constructor;return!t||typeof t!="function"||!t.__typeName||t.__typeName==="Object"?Object:t},Object.getTypeName=function(n){return Object.getType(n).getName()},String.__typeName="String",String.__class=!0,String.prototype.endsWith=function(n){return this.substr(this.length-n.length)===n},String.prototype.startsWith=function(n){return this.substr(0,n.length)===n},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.trimEnd=function(){return this.replace(/\s+$/,"")},String.prototype.trimStart=function(){return this.replace(/^\s+/,"")},String.format=function(){return String._toFormattedString(!1,arguments)},String._toFormattedString=function(n,t){for(var u="",e=t[0],o,f,i=0;;){if(o=e.indexOf("{",i),f=e.indexOf("}",i),o<0&&f<0){u+=e.slice(i);break}if(f>0&&(f<o||o<0)){u+=e.slice(i,f+1),i=f+2;continue}if(u+=e.slice(i,o),i=o+1,e.charAt(i)==="{"){u+="{",i++;continue}if(f<0)break;var s=e.substring(i,f),h=s.indexOf(":"),l=parseInt(h<0?s:s.substring(0,h),10)+1,c=h<0?"":s.substring(h+1),r=t[l];(typeof r=="undefined"||r===null)&&(r=""),u+=r.toFormattedString?r.toFormattedString(c):n&&r.localeFormat?r.localeFormat(c):r.format?r.format(c):r.toString(),i=f+1}return u},Boolean.__typeName="Boolean",Boolean.__class=!0,Boolean.parse=function(n){var t=n.trim().toLowerCase();return t==="false"?!1:t==="true"?!0:void 0},Date.__typeName="Date",Date.__class=!0,Number.__typeName="Number",Number.__class=!0,RegExp.__typeName="RegExp",RegExp.__class=!0,window||(this.window=this),window.Type=Function,Type.prototype.callBaseMethod=function(n,t,i){var r=Sys._getBaseMethod(this,n,t);return i?r.apply(n,i):r.apply(n)},Type.prototype.getBaseMethod=function(n,t){return Sys._getBaseMethod(this,n,t)},Type.prototype.getBaseType=function(){return typeof this.__baseType=="undefined"?null:this.__baseType},Type.prototype.getInterfaces=function(){for(var n=[],t=this,i,r,f,u;t;){if(i=t.__interfaces,i)for(r=0,f=i.length;r<f;r++)u=i[r],Array.contains(n,u)||(n[n.length]=u);t=t.__baseType}return n},Type.prototype.getName=function(){return typeof this.__typeName=="undefined"?"":this.__typeName},Type.prototype.implementsInterface=function(n){var r,t,u,i,f;if(this.resolveInheritance(),r=n.getName(),t=this.__interfaceCache,t){if(u=t[r],typeof u!="undefined")return u}else t=this.__interfaceCache={};for(i=this;i;){if(f=i.__interfaces,f&&Array.indexOf(f,n)!==-1)return t[r]=!0;i=i.__baseType}return t[r]=!1},Type.prototype.inheritsFrom=function(n){this.resolveInheritance();for(var t=this.__baseType;t;){if(t===n)return!0;t=t.__baseType}return!1},Type.prototype.initializeBase=function(n,t){return this.resolveInheritance(),this.__baseType&&(t?this.__baseType.apply(n,t):this.__baseType.apply(n)),n},Type.prototype.isImplementedBy=function(n){if(typeof n=="undefined"||n===null)return!1;var t=Object.getType(n);return!!(t.implementsInterface&&t.implementsInterface(this))},Type.prototype.isInstanceOfType=function(n){return Sys._isInstanceOfType(this,n)},Type.prototype.registerClass=function(n,t,i){var r,u,f;if(this.prototype.constructor=this,this.__typeName=n,this.__class=!0,t&&(this.__baseType=t,this.__basePrototypePending=!0),Sys.__upperCaseTypes[n.toUpperCase()]=this,i)for(this.__interfaces=[],r=2,u=arguments.length;r<u;r++)f=arguments[r],this.__interfaces.push(f);return this},Type.prototype.registerInterface=function(n){return Sys.__upperCaseTypes[n.toUpperCase()]=this,this.prototype.constructor=this,this.__typeName=n,this.__interface=!0,this},Type.prototype.resolveInheritance=function(){var n,t,i;if(this.__basePrototypePending){n=this.__baseType,n.resolveInheritance();for(t in n.prototype)i=n.prototype[t],this.prototype[t]||(this.prototype[t]=i);delete this.__basePrototypePending}},Type.getRootNamespaces=function(){return Array.clone(Sys.__rootNamespaces)},Type.isClass=function(n){return typeof n=="undefined"||n===null?!1:!!n.__class},Type.isInterface=function(n){return typeof n=="undefined"||n===null?!1:!!n.__interface},Type.isNamespace=function(n){return typeof n=="undefined"||n===null?!1:!!n.__namespace},Type.parse=function(n,t){var i;return t?(i=Sys.__upperCaseTypes[t.getName().toUpperCase()+"."+n.toUpperCase()],i||null):n?(Type.__htClasses||(Type.__htClasses={}),i=Type.__htClasses[n],i||(i=eval(n),Type.__htClasses[n]=i),i):null},Type.registerNamespace=function(n){for(var r=window,u=n.split("."),f,t,i=0;i<u.length;i++)f=u[i],t=r[f],t||(t=r[f]={}),t.__namespace||(i===0&&n!=="Sys"&&(Sys.__rootNamespaces[Sys.__rootNamespaces.length]=t),t.__namespace=!0,t.__typeName=u.slice(0,i+1).join("."),t.getName=function(){return this.__typeName}),r=t},Type._checkDependency=function(n,t){var i=Type._registerScript._scripts,r=i?!!i[n]:!1;if(typeof t!="undefined"&&!r)throw Error.invalidOperation(String.format(Sys.Res.requiredScriptReferenceNotIncluded,t,n));return r},Type._registerScript=function(n,t){var i=Type._registerScript._scripts,r,f,u;if(i||(Type._registerScript._scripts=i={}),i[n])throw Error.invalidOperation(String.format(Sys.Res.scriptAlreadyLoaded,n));if(i[n]=!0,t)for(r=0,f=t.length;r<f;r++)if(u=t[r],!Type._checkDependency(u))throw Error.invalidOperation(String.format(Sys.Res.scriptDependencyNotFound,n,u));},Type.registerNamespace("Sys"),Sys.__upperCaseTypes={},Sys.__rootNamespaces=[Sys],Sys._isInstanceOfType=function(n,t){if(typeof t=="undefined"||t===null)return!1;if(t instanceof n)return!0;var i=Object.getType(t);return!!(i===n)||i.inheritsFrom&&i.inheritsFrom(n)||i.implementsInterface&&i.implementsInterface(n)},Sys._getBaseMethod=function(n,t,i){var u=n.getBaseType(),r;return u?(r=u.prototype[i],r instanceof Function?r:null):null},Sys._isDomElement=function(n){var i=!1,t,r;return typeof n.nodeType!="number"&&(t=n.ownerDocument||n.document||n,t!=n?(r=t.defaultView||t.parentWindow,i=r!=n):i=typeof t.body=="undefined"),!i},Array.__typeName="Array",Array.__class=!0,Array.add=Array.enqueue=function(n,t){n[n.length]=t},Array.addRange=function(n,t){n.push.apply(n,t)},Array.clear=function(n){n.length=0},Array.clone=function(n){return n.length===1?[n[0]]:Array.apply(null,n)},Array.contains=function(n,t){return Sys._indexOf(n,t)>=0},Array.dequeue=function(n){return n.shift()},Array.forEach=function(n,t,i){for(var u,r=0,f=n.length;r<f;r++)u=n[r],typeof u!="undefined"&&t.call(i,u,r,n)},Array.indexOf=function(n,t,i){return Sys._indexOf(n,t,i)},Array.insert=function(n,t,i){n.splice(t,0,i)},Array.parse=function(n){return n?eval(n):[]},Array.remove=function(n,t){var i=Sys._indexOf(n,t);return i>=0&&n.splice(i,1),i>=0},Array.removeAt=function(n,t){n.splice(t,1)},Sys._indexOf=function(n,t,i){var u,r;if(typeof t=="undefined")return-1;if(u=n.length,u!==0)for(i=+i,isNaN(i)?i=0:(isFinite(i)&&(i=i-i%1),i<0&&(i=Math.max(0,u+i))),r=i;r<u;r++)if(typeof n[r]!="undefined"&&n[r]===t)return r;return-1},Type._registerScript._scripts={"MicrosoftAjaxCore.js":!0,"MicrosoftAjaxGlobalization.js":!0,"MicrosoftAjaxSerialization.js":!0,"MicrosoftAjaxComponentModel.js":!0,"MicrosoftAjaxHistory.js":!0,"MicrosoftAjaxNetwork.js":!0,"MicrosoftAjaxWebServices.js":!0},Sys.IDisposable=function(){},Sys.IDisposable.prototype={},Sys.IDisposable.registerInterface("Sys.IDisposable"),Sys.StringBuilder=function(n){this._parts=typeof n!="undefined"&&n!==null&&n!==""?[n.toString()]:[],this._value={},this._len=0},Sys.StringBuilder.prototype={append:function(n){this._parts[this._parts.length]=n},appendLine:function(n){this._parts[this._parts.length]=typeof n=="undefined"||n===null||n===""?"\r\n":n+"\r\n"},clear:function(){this._parts=[],this._value={},this._len=0},isEmpty:function(){return this._parts.length===0?!0:this.toString()===""},toString:function(n){var t,r,i;if(n=n||"",t=this._parts,this._len!==t.length&&(this._value={},this._len=t.length),r=this._value,typeof r[n]=="undefined"){if(n!=="")for(i=0;i<t.length;)typeof t[i]=="undefined"||t[i]===""||t[i]===null?t.splice(i,1):i++;r[n]=this._parts.join(n)}return r[n]}},Sys.StringBuilder.registerClass("Sys.StringBuilder"),Sys.Browser={},Sys.Browser.InternetExplorer={},Sys.Browser.Firefox={},Sys.Browser.Safari={},Sys.Browser.Opera={},Sys.Browser.agent=null,Sys.Browser.hasDebuggerStatement=!1,Sys.Browser.name=navigator.appName,Sys.Browser.version=parseFloat(navigator.appVersion),Sys.Browser.documentMode=0,navigator.userAgent.indexOf(" MSIE ")>-1?(Sys.Browser.agent=Sys.Browser.InternetExplorer,Sys.Browser.version=parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1]),Sys.Browser.version>=8&&document.documentMode>=7&&(Sys.Browser.documentMode=document.documentMode),Sys.Browser.hasDebuggerStatement=!0):navigator.userAgent.indexOf(" Firefox/")>-1?(Sys.Browser.agent=Sys.Browser.Firefox,Sys.Browser.version=parseFloat(navigator.userAgent.match(/Firefox\/(\d+\.\d+)/)[1]),Sys.Browser.name="Firefox",Sys.Browser.hasDebuggerStatement=!0):navigator.userAgent.indexOf(" AppleWebKit/")>-1?(Sys.Browser.agent=Sys.Browser.Safari,Sys.Browser.version=parseFloat(navigator.userAgent.match(/AppleWebKit\/(\d+(\.\d+)?)/)[1]),Sys.Browser.name="Safari"):navigator.userAgent.indexOf("Opera/")>-1&&(Sys.Browser.agent=Sys.Browser.Opera),Sys.EventArgs=function(){},Sys.EventArgs.registerClass("Sys.EventArgs"),Sys.EventArgs.Empty=new Sys.EventArgs,Sys.CancelEventArgs=function(){Sys.CancelEventArgs.initializeBase(this),this._cancel=!1},Sys.CancelEventArgs.prototype={get_cancel:function(){return this._cancel},set_cancel:function(n){this._cancel=n}},Sys.CancelEventArgs.registerClass("Sys.CancelEventArgs",Sys.EventArgs),Type.registerNamespace("Sys.UI"),Sys._Debug=function(){},Sys._Debug.prototype={_appendConsole:function(n){typeof Debug!="undefined"&&Debug.writeln,window.console&&window.console.log&&window.console.log(n),window.opera&&window.opera.postError(n),window.debugService&&window.debugService.trace(n)},_appendTrace:function(n){var t=document.getElementById("TraceConsole");t&&t.tagName.toUpperCase()==="TEXTAREA"&&(t.value+=n+"\n")},assert:function(n,t,i){n||(t=i&&this.assert.caller?String.format(Sys.Res.assertFailedCaller,t,this.assert.caller):String.format(Sys.Res.assertFailed,t),confirm(String.format(Sys.Res.breakIntoDebugger,t))&&this.fail(t))},clearTrace:function(){var n=document.getElementById("TraceConsole");n&&n.tagName.toUpperCase()==="TEXTAREA"&&(n.value="")},fail:function(n){this._appendConsole(n),Sys.Browser.hasDebuggerStatement&&eval("debugger")},trace:function(n){this._appendConsole(n),this._appendTrace(n)},traceDump:function(n,t){var i=this._traceDump(n,t,!0)},_traceDump:function(n,t,i,r,u){var e,o,f,c,l,s,h;if(t=t?t:"traceDump",r=r?r:"",n===null){this.trace(r+t+": null");return}switch(typeof n){case"undefined":this.trace(r+t+": Undefined");break;case"number":case"string":case"boolean":this.trace(r+t+": "+n);break;default:if(Date.isInstanceOfType(n)||RegExp.isInstanceOfType(n)){this.trace(r+t+": "+n.toString());break}if(u){if(Array.contains(u,n)){this.trace(r+t+": ...");return}}else u=[];if(Array.add(u,n),n==window||n===document||window.HTMLElement&&n instanceof HTMLElement||typeof n.nodeName=="string")e=n.tagName?n.tagName:"DomElement",n.id&&(e+=" - "+n.id),this.trace(r+t+" {"+e+"}");else if(o=Object.getTypeName(n),this.trace(r+t+(typeof o=="string"?" {"+o+"}":"")),r===""||i)if(r+="    ",Array.isInstanceOfType(n))for(c=n.length,f=0;f<c;f++)this._traceDump(n[f],"["+f+"]",i,r,u);else for(s in n)h=n[s],Function.isInstanceOfType(h)||this._traceDump(h,s,i,r,u);Array.remove(u,n)}}},Sys._Debug.registerClass("Sys._Debug"),Sys.Debug=new Sys._Debug,Sys.Debug.isDebug=!1,Type.prototype.registerEnum=function(n,t){Sys.__upperCaseTypes[n.toUpperCase()]=this;for(var i in this.prototype)this[i]=this.prototype[i];this.__typeName=n,this.parse=Sys$Enum$parse,this.__string=this.toString(),this.toString=Sys$Enum$toString,this.__flags=t,this.__enum=!0},Type.isEnum=function(n){return typeof n=="undefined"||n===null?!1:!!n.__enum},Type.isFlags=function(n){return typeof n=="undefined"||n===null?!1:!!n.__flags},Sys.CollectionChange=function(n,t,i,r,u){this.action=n,t&&(t instanceof Array||(t=[t])),this.newItems=t||null,typeof i!="number"&&(i=-1),this.newStartingIndex=i,r&&(r instanceof Array||(r=[r])),this.oldItems=r||null,typeof u!="number"&&(u=-1),this.oldStartingIndex=u},Sys.CollectionChange.registerClass("Sys.CollectionChange"),Sys.NotifyCollectionChangedAction=function(){throw Error.notImplemented();},Sys.NotifyCollectionChangedAction.prototype={add:0,remove:1,reset:2},Sys.NotifyCollectionChangedAction.registerEnum("Sys.NotifyCollectionChangedAction"),Sys.NotifyCollectionChangedEventArgs=function(n){this._changes=n,Sys.NotifyCollectionChangedEventArgs.initializeBase(this)},Sys.NotifyCollectionChangedEventArgs.prototype={get_changes:function(){return this._changes||[]}},Sys.NotifyCollectionChangedEventArgs.registerClass("Sys.NotifyCollectionChangedEventArgs",Sys.EventArgs),Sys.Observer=function(){},Sys.Observer.registerClass("Sys.Observer"),Sys.Observer.makeObservable=function(n){var i=n instanceof Array,t=Sys.Observer;return n.setValue===t._observeMethods.setValue?n:(t._addMethods(n,t._observeMethods),i&&t._addMethods(n,t._arrayMethods),n)},Sys.Observer._addMethods=function(n,t){for(var i in t)n[i]=t[i]},Sys.Observer._addEventHandler=function(n,t,i){Sys.Observer._getContext(n,!0).events._addHandler(t,i)},Sys.Observer.addEventHandler=function(n,t,i){Sys.Observer._addEventHandler(n,t,i)},Sys.Observer._removeEventHandler=function(n,t,i){Sys.Observer._getContext(n,!0).events._removeHandler(t,i)},Sys.Observer.removeEventHandler=function(n,t,i){Sys.Observer._removeEventHandler(n,t,i)},Sys.Observer.raiseEvent=function(n,t,i){var u=Sys.Observer._getContext(n),r;u&&(r=u.events.getHandler(t),r&&r(n,i))},Sys.Observer.addPropertyChanged=function(n,t){Sys.Observer._addEventHandler(n,"propertyChanged",t)},Sys.Observer.removePropertyChanged=function(n,t){Sys.Observer._removeEventHandler(n,"propertyChanged",t)},Sys.Observer.beginUpdate=function(n){Sys.Observer._getContext(n,!0).updating=!0},Sys.Observer.endUpdate=function(n){var t=Sys.Observer._getContext(n),i,r;t&&t.updating&&(t.updating=!1,i=t.dirty,t.dirty=!1,i&&(n instanceof Array&&(r=t.changes,t.changes=null,Sys.Observer.raiseCollectionChanged(n,r)),Sys.Observer.raisePropertyChanged(n,"")))},Sys.Observer.isUpdating=function(n){var t=Sys.Observer._getContext(n);return t?t.updating:!1},Sys.Observer._setValue=function(n,t,i){for(var r,s,a=n,f=t.split("."),c,v,l,u,o,e=0,h=f.length-1;e<h;e++)if(c=f[e],r=n["get_"+c],n=typeof r=="function"?r.call(n):n[c],v=typeof n,n===null||v==="undefined")throw Error.invalidOperation(String.format(Sys.Res.nullReferenceInPath,t));if(u=f[h],r=n["get_"+u],s=n["set_"+u],l=typeof r=="function"?r.call(n):n[u],typeof s=="function"?s.call(n,i):n[u]=i,l!==i){if(o=Sys.Observer._getContext(a),o&&o.updating){o.dirty=!0;return}Sys.Observer.raisePropertyChanged(a,f[0])}},Sys.Observer.setValue=function(n,t,i){Sys.Observer._setValue(n,t,i)},Sys.Observer.raisePropertyChanged=function(n,t){Sys.Observer.raiseEvent(n,"propertyChanged",new Sys.PropertyChangedEventArgs(t))},Sys.Observer.addCollectionChanged=function(n,t){Sys.Observer._addEventHandler(n,"collectionChanged",t)},Sys.Observer.removeCollectionChanged=function(n,t){Sys.Observer._removeEventHandler(n,"collectionChanged",t)},Sys.Observer._collectionChange=function(n,t){var i=Sys.Observer._getContext(n),r;i&&i.updating?(i.dirty=!0,r=i.changes,r?r.push(t):i.changes=r=[t]):(Sys.Observer.raiseCollectionChanged(n,[t]),Sys.Observer.raisePropertyChanged(n,"length"))},Sys.Observer.add=function(n,t){var i=new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,[t],n.length);Array.add(n,t),Sys.Observer._collectionChange(n,i)},Sys.Observer.addRange=function(n,t){var i=new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,t,n.length);Array.addRange(n,t),Sys.Observer._collectionChange(n,i)},Sys.Observer.clear=function(n){var t=Array.clone(n);Array.clear(n),Sys.Observer._collectionChange(n,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.reset,null,-1,t,0))},Sys.Observer.insert=function(n,t,i){Array.insert(n,t,i),Sys.Observer._collectionChange(n,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.add,[i],t))},Sys.Observer.remove=function(n,t){var i=Array.indexOf(n,t);return i!==-1?(Array.remove(n,t),Sys.Observer._collectionChange(n,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.remove,null,-1,[t],i)),!0):!1},Sys.Observer.removeAt=function(n,t){if(t>-1&&t<n.length){var i=n[t];Array.removeAt(n,t),Sys.Observer._collectionChange(n,new Sys.CollectionChange(Sys.NotifyCollectionChangedAction.remove,null,-1,[i],t))}},Sys.Observer.raiseCollectionChanged=function(n,t){Sys.Observer.raiseEvent(n,"collectionChanged",new Sys.NotifyCollectionChangedEventArgs(t))},Sys.Observer._observeMethods={add_propertyChanged:function(n){Sys.Observer._addEventHandler(this,"propertyChanged",n)},remove_propertyChanged:function(n){Sys.Observer._removeEventHandler(this,"propertyChanged",n)},addEventHandler:function(n,t){Sys.Observer._addEventHandler(this,n,t)},removeEventHandler:function(n,t){Sys.Observer._removeEventHandler(this,n,t)},get_isUpdating:function(){return Sys.Observer.isUpdating(this)},beginUpdate:function(){Sys.Observer.beginUpdate(this)},endUpdate:function(){Sys.Observer.endUpdate(this)},setValue:function(n,t){Sys.Observer._setValue(this,n,t)},raiseEvent:function(n,t){Sys.Observer.raiseEvent(this,n,t)},raisePropertyChanged:function(n){Sys.Observer.raiseEvent(this,"propertyChanged",new Sys.PropertyChangedEventArgs(n))}},Sys.Observer._arrayMethods={add_collectionChanged:function(n){Sys.Observer._addEventHandler(this,"collectionChanged",n)},remove_collectionChanged:function(n){Sys.Observer._removeEventHandler(this,"collectionChanged",n)},add:function(n){Sys.Observer.add(this,n)},addRange:function(n){Sys.Observer.addRange(this,n)},clear:function(){Sys.Observer.clear(this)},insert:function(n,t){Sys.Observer.insert(this,n,t)},remove:function(n){return Sys.Observer.remove(this,n)},removeAt:function(n){Sys.Observer.removeAt(this,n)},raiseCollectionChanged:function(n){Sys.Observer.raiseEvent(this,"collectionChanged",new Sys.NotifyCollectionChangedEventArgs(n))}},Sys.Observer._getContext=function(n,t){var i=n._observerContext;return i?i():t?(n._observerContext=Sys.Observer._createContext())():null},Sys.Observer._createContext=function(){var n={events:new Sys.EventHandlerList};return function(){return n}},Date._appendPreOrPostMatch=function(n,t){for(var f=0,i=!1,u,r=0,e=n.length;r<e;r++){u=n.charAt(r);switch(u){case"'":i?t.append("'"):f++,i=!1;break;case"\\":i&&t.append("\\"),i=!i;break;default:t.append(u),i=!1}}return f},Date._expandFormat=function(n,t){t||(t="F");var i=t.length;if(i===1)switch(t){case"d":return n.ShortDatePattern;case"D":return n.LongDatePattern;case"t":return n.ShortTimePattern;case"T":return n.LongTimePattern;case"f":return n.LongDatePattern+" "+n.ShortTimePattern;case"F":return n.FullDateTimePattern;case"M":case"m":return n.MonthDayPattern;case"s":return n.SortableDateTimePattern;case"Y":case"y":return n.YearMonthPattern;default:throw Error.format(Sys.Res.formatInvalidString);}else i===2&&t.charAt(0)==="%"&&(t=t.charAt(1));return t},Date._expandYear=function(n,t){var r=new Date,u=Date._getEra(r),i;return t<100&&(i=Date._getEraYear(r,n,u),t+=i-i%100,t>n.Calendar.TwoDigitYearMax&&(t-=100)),t},Date._getEra=function(n,t){var r,u,i,f;if(!t)return 0;for(u=n.getTime(),i=0,f=t.length;i<f;i+=4)if(r=t[i+2],r===null||u>=r)return i;return 0},Date._getEraYear=function(n,t,i,r){var u=n.getFullYear();return!r&&t.eras&&(u-=t.eras[i+3]),u},Date._getParseRegExp=function(n,t){var r,c,l,e;if(n._parseRegExp){if(n._parseRegExp[t])return n._parseRegExp[t]}else n._parseRegExp={};r=Date._expandFormat(n,t),r=r.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var i=new Sys.StringBuilder("^"),o=[],f=0,s=0,h=Date._getTokenRegExp(),u;(u=h.exec(r))!==null;){if(c=r.slice(f,u.index),f=h.lastIndex,s+=Date._appendPreOrPostMatch(c,i),s%2==1){i.append(u[0]);continue}switch(u[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":i.append("(\\D+)");break;case"tt":case"t":i.append("(\\D*)");break;case"yyyy":i.append("(\\d{4})");break;case"fff":i.append("(\\d{3})");break;case"ff":i.append("(\\d{2})");break;case"f":i.append("(\\d)");break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":i.append("(\\d\\d?)");break;case"zzz":i.append("([+-]?\\d\\d?:\\d{2})");break;case"zz":case"z":i.append("([+-]?\\d\\d?)");break;case"/":i.append("(\\"+n.DateSeparator+")")}Array.add(o,u[0])}return Date._appendPreOrPostMatch(r.slice(f),i),i.append("$"),l=i.toString().replace(/\s+/g,"\\s+"),e={regExp:l,groups:o},n._parseRegExp[t]=e,e},Date._getTokenRegExp=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g},Date.parseLocale=function(n){return Date._parse(n,Sys.CultureInfo.CurrentCulture,arguments)},Date.parseInvariant=function(n){return Date._parse(n,Sys.CultureInfo.InvariantCulture,arguments)},Date._parse=function(n,t,i){for(var u,e,o,s=!1,r=1,f=i.length;r<f;r++)if(e=i[r],e&&(s=!0,u=Date._parseExact(n,e,t),u))return u;if(!s)for(o=t._getDateTimeFormats(),r=0,f=o.length;r<f;r++)if(u=Date._parseExact(n,o[r],t),u)return u;return null},Date._parseExact=function(n,t,i){var b,et,r,tt,k,y,v,w,ht,u,rt,p,ft;n=n.trim();var s=i.dateTimeFormat,ct=Date._getParseRegExp(s,t),st=new RegExp(ct.regExp).exec(n);if(st===null)return null;var ot=ct.groups,it=null,e=null,f=null,c=null,l=null,o=0,a,nt=0,d=0,h=0,g=null,ut=!1;for(b=0,et=ot.length;b<et;b++)if(r=st[b+1],r)switch(ot[b]){case"dd":case"d":if(c=parseInt(r,10),c<1||c>31)return null;break;case"MMMM":if(f=i._getMonthIndex(r),f<0||f>11)return null;break;case"MMM":if(f=i._getAbbrMonthIndex(r),f<0||f>11)return null;break;case"M":case"MM":if(f=parseInt(r,10)-1,f<0||f>11)return null;break;case"y":case"yy":if(e=Date._expandYear(s,parseInt(r,10)),e<0||e>9999)return null;break;case"yyyy":if(e=parseInt(r,10),e<0||e>9999)return null;break;case"h":case"hh":if(o=parseInt(r,10),o===12&&(o=0),o<0||o>11)return null;break;case"H":case"HH":if(o=parseInt(r,10),o<0||o>23)return null;break;case"m":case"mm":if(nt=parseInt(r,10),nt<0||nt>59)return null;break;case"s":case"ss":if(d=parseInt(r,10),d<0||d>59)return null;break;case"tt":case"t":if(tt=r.toUpperCase(),ut=tt===s.PMDesignator.toUpperCase(),!ut&&tt!==s.AMDesignator.toUpperCase())return null;break;case"f":if(h=parseInt(r,10)*100,h<0||h>999)return null;break;case"ff":if(h=parseInt(r,10)*10,h<0||h>999)return null;break;case"fff":if(h=parseInt(r,10),h<0||h>999)return null;break;case"dddd":if(l=i._getDayIndex(r),l<0||l>6)return null;break;case"ddd":if(l=i._getAbbrDayIndex(r),l<0||l>6)return null;break;case"zzz":if((k=r.split(/:/),k.length!==2)||(a=parseInt(k[0],10),a<-12||a>13)||(y=parseInt(k[1],10),y<0||y>59))return null;g=a*60+(r.startsWith("-")?-y:y);break;case"z":case"zz":if(a=parseInt(r,10),a<-12||a>13)return null;g=a*60;break;case"g":case"gg":if(v=r,!v||!s.eras)return null;for(v=v.toLowerCase().trim(),w=0,ht=s.eras.length;w<ht;w+=4)if(v===s.eras[w+1].toLowerCase()){it=w;break}if(it===null)return null}if(u=new Date,p=s.Calendar.convert,rt=p?p.fromGregorian(u)[0]:u.getFullYear(),e===null?e=rt:s.eras&&(e+=s.eras[(it||0)+3]),f===null&&(f=0),c===null&&(c=1),p){if(u=p.toGregorian(e,f,c),u===null)return null}else if((u.setFullYear(e,f,c),u.getDate()!==c)||l!==null&&u.getDay()!==l)return null;return ut&&o<12&&(o+=12),u.setHours(o,nt,d,h),g!==null&&(ft=u.getMinutes()-(g+u.getTimezoneOffset()),u.setHours(u.getHours()+parseInt(ft/60,10),ft%60)),u},Date.prototype.format=function(n){return this._toFormattedString(n,Sys.CultureInfo.InvariantCulture)},Date.prototype.localeFormat=function(n){return this._toFormattedString(n,Sys.CultureInfo.CurrentCulture)},Date.prototype._toFormattedString=function(n,t){function f(n){return n<10?"0"+n:n.toString()}function w(n){return n<10?"00"+n:n<100?"0"+n:n.toString()}function tt(n){return n<10?"000"+n:n<100?"00"+n:n<1e3?"0"+n:n.toString()}function g(){return s||k?s:(s=d.test(n),k=!0,s)}var r=t.dateTimeFormat,p=r.Calendar.convert,a,b,h,l,i,u,s,k,d,v,y,e;if(!n||!n.length||n==="i")return t&&t.name.length?p?this._toFormattedString(r.FullDateTimePattern,t):(a=new Date(this.getTime()),b=Date._getEra(this,r.eras),a.setFullYear(Date._getEraYear(this,r,b)),a.toLocaleString()):this.toString();for(h=r.eras,l=n==="s",n=Date._expandFormat(r,n),i=new Sys.StringBuilder,d=/([^d]|^)(d|dd)([^d]|$)/g,v=0,y=Date._getTokenRegExp(),!l&&p&&(e=p.fromGregorian(this));;){var it=y.lastIndex,c=y.exec(n),nt=n.slice(it,c?c.index:n.length);if(v+=Date._appendPreOrPostMatch(nt,i),!c)break;if(v%2==1){i.append(c[0]);continue}function o(n,t){if(e)return e[t];switch(t){case 0:return n.getFullYear();case 1:return n.getMonth();case 2:return n.getDate()}}switch(c[0]){case"dddd":i.append(r.DayNames[this.getDay()]);break;case"ddd":i.append(r.AbbreviatedDayNames[this.getDay()]);break;case"dd":s=!0,i.append(f(o(this,2)));break;case"d":s=!0,i.append(o(this,2));break;case"MMMM":i.append(r.MonthGenitiveNames&&g()?r.MonthGenitiveNames[o(this,1)]:r.MonthNames[o(this,1)]);break;case"MMM":i.append(r.AbbreviatedMonthGenitiveNames&&g()?r.AbbreviatedMonthGenitiveNames[o(this,1)]:r.AbbreviatedMonthNames[o(this,1)]);break;case"MM":i.append(f(o(this,1)+1));break;case"M":i.append(o(this,1)+1);break;case"yyyy":i.append(tt(e?e[0]:Date._getEraYear(this,r,Date._getEra(this,h),l)));break;case"yy":i.append(f((e?e[0]:Date._getEraYear(this,r,Date._getEra(this,h),l))%100));break;case"y":i.append((e?e[0]:Date._getEraYear(this,r,Date._getEra(this,h),l))%100);break;case"hh":u=this.getHours()%12,u===0&&(u=12),i.append(f(u));break;case"h":u=this.getHours()%12,u===0&&(u=12),i.append(u);break;case"HH":i.append(f(this.getHours()));break;case"H":i.append(this.getHours());break;case"mm":i.append(f(this.getMinutes()));break;case"m":i.append(this.getMinutes());break;case"ss":i.append(f(this.getSeconds()));break;case"s":i.append(this.getSeconds());break;case"tt":i.append(this.getHours()<12?r.AMDesignator:r.PMDesignator);break;case"t":i.append((this.getHours()<12?r.AMDesignator:r.PMDesignator).charAt(0));break;case"f":i.append(w(this.getMilliseconds()).charAt(0));break;case"ff":i.append(w(this.getMilliseconds()).substr(0,2));break;case"fff":i.append(w(this.getMilliseconds()));break;case"z":u=this.getTimezoneOffset()/60,i.append((u<=0?"+":"-")+Math.floor(Math.abs(u)));break;case"zz":u=this.getTimezoneOffset()/60,i.append((u<=0?"+":"-")+f(Math.floor(Math.abs(u))));break;case"zzz":u=this.getTimezoneOffset()/60,i.append((u<=0?"+":"-")+f(Math.floor(Math.abs(u)))+":"+f(Math.abs(this.getTimezoneOffset()%60)));break;case"g":case"gg":r.eras&&i.append(r.eras[Date._getEra(this,h)+1]);break;case"/":i.append(r.DateSeparator)}}return i.toString()},String.localeFormat=function(){return String._toFormattedString(!0,arguments)},Number.parseLocale=function(n){return Number._parse(n,Sys.CultureInfo.CurrentCulture)},Number.parseInvariant=function(n){return Number._parse(n,Sys.CultureInfo.InvariantCulture)},Number._parse=function(n,t){var l,f,e,r,a,v,y,h,c;if(n=n.trim(),n.match(/^[+-]?infinity$/i))return parseFloat(n);if(n.match(/^0x[a-f0-9]+$/i))return parseInt(n);var i=t.numberFormat,o=Number._parseNumberNegativePattern(n,i,i.NumberNegativePattern),s=o[0],u=o[1];return(s===""&&i.NumberNegativePattern!==1&&(o=Number._parseNumberNegativePattern(n,i,1),s=o[0],u=o[1]),s===""&&(s="+"),e=u.indexOf("e"),e<0&&(e=u.indexOf("E")),e<0?(f=u,l=null):(f=u.substr(0,e),l=u.substr(e+1)),v=f.indexOf(i.NumberDecimalSeparator),v<0?(r=f,a=null):(r=f.substr(0,v),a=f.substr(v+i.NumberDecimalSeparator.length)),r=r.split(i.NumberGroupSeparator).join(""),y=i.NumberGroupSeparator.replace(/\u00A0/g," "),i.NumberGroupSeparator!==y&&(r=r.split(y).join("")),h=s+r,a!==null&&(h+="."+a),l!==null&&(c=Number._parseNumberNegativePattern(l,i,1),c[0]===""&&(c[0]="+"),h+="e"+c[0]+c[1]),h.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/))?parseFloat(h):Number.NaN},Number._parseNumberNegativePattern=function(n,t,i){var r=t.NegativeSign,u=t.PositiveSign;switch(i){case 4:r=" "+r,u=" "+u;case 3:if(n.endsWith(r))return["-",n.substr(0,n.length-r.length)];if(n.endsWith(u))return["+",n.substr(0,n.length-u.length)];break;case 2:r+=" ",u+=" ";case 1:if(n.startsWith(r))return["-",n.substr(r.length)];if(n.startsWith(u))return["+",n.substr(u.length)];break;case 0:if(n.startsWith("(")&&n.endsWith(")"))return["-",n.substr(1,n.length-2)]}return["",n]},Number.prototype.format=function(n){return this._toFormattedString(n,Sys.CultureInfo.InvariantCulture)},Number.prototype.localeFormat=function(n){return this._toFormattedString(n,Sys.CultureInfo.CurrentCulture)},Number.prototype._toFormattedString=function(n,t){function s(n,t,i){for(var r=n.length;r<t;r++)n=i?"0"+n:n+"0";return n}function c(n,t,i,r,u){var a=i[0],v=1,p=Math.pow(10,t),y=Math.round(n*p)/p,w,h,c;isFinite(y)||(y=n),n=y;var e=n.toString(),f="",o,l=e.split(/e/i);for(e=l[0],o=l.length>1?parseInt(l[1]):0,l=e.split("."),e=l[0],f=l.length>1?l[1]:"",o>0?(f=s(f,o,!1),e+=f.slice(0,o),f=f.substr(o)):o<0&&(o=-o,e=s(e,o+1,!0),f=e.slice(-o,e.length)+f,e=e.slice(0,-o)),t>0?(f=f.length>t?f.slice(0,t):s(f,t,!1),f=u+f):f="",h=e.length-1,c="";h>=0;){if(a===0||a>h)return c.length>0?e.slice(0,h+1)+r+c+f:e.slice(0,h+1)+f;c=c.length>0?e.slice(h-a+1,h+1)+r+c:e.slice(h-a+1,h+1),h-=a,v<i.length&&(a=i[v],v++)}return e.slice(0,h+1)+r+c+f}var i,f,r,u,h,e,l,o;if(!n||n.length===0||n==="i")return t&&t.name.length>0?this.toLocaleString():this.toString();var w=["n %","n%","%n"],p=["-n %","-n%","-%n"],y=["(n)","-n","- n","n-","n -"],v=["$n","n$","$ n","n $"],a=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"];i=t.numberFormat,f=Math.abs(this),n||(n="D"),r=-1,n.length>1&&(r=parseInt(n.slice(1),10));switch(n.charAt(0)){case"d":case"D":u="n",r!==-1&&(f=s(""+f,r,!0)),this<0&&(f=-f);break;case"c":case"C":u=this<0?a[i.CurrencyNegativePattern]:v[i.CurrencyPositivePattern],r===-1&&(r=i.CurrencyDecimalDigits),f=c(Math.abs(this),r,i.CurrencyGroupSizes,i.CurrencyGroupSeparator,i.CurrencyDecimalSeparator);break;case"n":case"N":u=this<0?y[i.NumberNegativePattern]:"n",r===-1&&(r=i.NumberDecimalDigits),f=c(Math.abs(this),r,i.NumberGroupSizes,i.NumberGroupSeparator,i.NumberDecimalSeparator);break;case"p":case"P":u=this<0?p[i.PercentNegativePattern]:w[i.PercentPositivePattern],r===-1&&(r=i.PercentDecimalDigits),f=c(Math.abs(this)*100,r,i.PercentGroupSizes,i.PercentGroupSeparator,i.PercentDecimalSeparator);break;default:throw Error.format(Sys.Res.formatBadFormatSpecifier);}for(h=/n|\$|-|%/g,e="";;){if(l=h.lastIndex,o=h.exec(u),e+=u.slice(l,o?o.index:u.length),!o)break;switch(o[0]){case"n":e+=f;break;case"$":e+=i.CurrencySymbol;break;case"-":/[1-9]/.test(f)&&(e+=i.NegativeSign);break;case"%":e+=i.PercentSymbol}}return e},Sys.CultureInfo=function(n,t,i){this.name=n,this.numberFormat=t,this.dateTimeFormat=i},Sys.CultureInfo.prototype={_getDateTimeFormats:function(){if(!this._dateTimeFormats){var n=this.dateTimeFormat;this._dateTimeFormats=[n.MonthDayPattern,n.YearMonthPattern,n.ShortDatePattern,n.ShortTimePattern,n.LongDatePattern,n.LongTimePattern,n.FullDateTimePattern,n.RFC1123Pattern,n.SortableDateTimePattern,n.UniversalSortableDateTimePattern]}return this._dateTimeFormats},_getIndex:function(n,t,i){var u=this._toUpper(n),r=Array.indexOf(t,u);return r===-1&&(r=Array.indexOf(i,u)),r},_getMonthIndex:function(n){return this._upperMonths||(this._upperMonths=this._toUpperArray(this.dateTimeFormat.MonthNames),this._upperMonthsGenitive=this._toUpperArray(this.dateTimeFormat.MonthGenitiveNames)),this._getIndex(n,this._upperMonths,this._upperMonthsGenitive)},_getAbbrMonthIndex:function(n){return this._upperAbbrMonths||(this._upperAbbrMonths=this._toUpperArray(this.dateTimeFormat.AbbreviatedMonthNames),this._upperAbbrMonthsGenitive=this._toUpperArray(this.dateTimeFormat.AbbreviatedMonthGenitiveNames)),this._getIndex(n,this._upperAbbrMonths,this._upperAbbrMonthsGenitive)},_getDayIndex:function(n){return this._upperDays||(this._upperDays=this._toUpperArray(this.dateTimeFormat.DayNames)),Array.indexOf(this._upperDays,this._toUpper(n))},_getAbbrDayIndex:function(n){return this._upperAbbrDays||(this._upperAbbrDays=this._toUpperArray(this.dateTimeFormat.AbbreviatedDayNames)),Array.indexOf(this._upperAbbrDays,this._toUpper(n))},_toUpperArray:function(n){for(var i=[],t=0,r=n.length;t<r;t++)i[t]=this._toUpper(n[t]);return i},_toUpper:function(n){return n.split("\u00a0").join(" ").toUpperCase()}},Sys.CultureInfo.registerClass("Sys.CultureInfo"),Sys.CultureInfo._parse=function(n){var t=n.dateTimeFormat;return t&&!t.eras&&(t.eras=n.eras),new Sys.CultureInfo(n.name,n.numberFormat,t)},Sys.CultureInfo.InvariantCulture=Sys.CultureInfo._parse({name:"",numberFormat:{CurrencyDecimalDigits:2,CurrencyDecimalSeparator:".",IsReadOnly:!0,CurrencyGroupSizes:[3],NumberGroupSizes:[3],PercentGroupSizes:[3],CurrencyGroupSeparator:",",CurrencySymbol:"\u00a4",NaNSymbol:"NaN",CurrencyNegativePattern:0,NumberNegativePattern:1,PercentPositivePattern:0,PercentNegativePattern:0,NegativeInfinitySymbol:"-Infinity",NegativeSign:"-",NumberDecimalDigits:2,NumberDecimalSeparator:".",NumberGroupSeparator:",",CurrencyPositivePattern:0,PositiveInfinitySymbol:"Infinity",PositiveSign:"+",PercentDecimalDigits:2,PercentDecimalSeparator:".",PercentGroupSeparator:",",PercentSymbol:"%",PerMilleSymbol:"\u2030",NativeDigits:["0","1","2","3","4","5","6","7","8","9"],DigitSubstitution:1},dateTimeFormat:{AMDesignator:"AM",Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,IsReadOnly:!0},DateSeparator:"/",FirstDayOfWeek:0,CalendarWeekRule:0,FullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",LongDatePattern:"dddd, dd MMMM yyyy",LongTimePattern:"HH:mm:ss",MonthDayPattern:"MMMM dd",PMDesignator:"PM",RFC1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",ShortDatePattern:"MM/dd/yyyy",ShortTimePattern:"HH:mm",SortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",TimeSeparator:":",UniversalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",YearMonthPattern:"yyyy MMMM",AbbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ShortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],DayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],AbbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],MonthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],IsReadOnly:!0,NativeCalendarName:"Gregorian Calendar",AbbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],MonthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""]},eras:[1,"A.D.",null,0]}),typeof __cultureInfo=="object"?(Sys.CultureInfo.CurrentCulture=Sys.CultureInfo._parse(__cultureInfo),delete __cultureInfo):Sys.CultureInfo.CurrentCulture=Sys.CultureInfo._parse({name:"en-US",numberFormat:{CurrencyDecimalDigits:2,CurrencyDecimalSeparator:".",IsReadOnly:!1,CurrencyGroupSizes:[3],NumberGroupSizes:[3],PercentGroupSizes:[3],CurrencyGroupSeparator:",",CurrencySymbol:"$",NaNSymbol:"NaN",CurrencyNegativePattern:0,NumberNegativePattern:1,PercentPositivePattern:0,PercentNegativePattern:0,NegativeInfinitySymbol:"-Infinity",NegativeSign:"-",NumberDecimalDigits:2,NumberDecimalSeparator:".",NumberGroupSeparator:",",CurrencyPositivePattern:0,PositiveInfinitySymbol:"Infinity",PositiveSign:"+",PercentDecimalDigits:2,PercentDecimalSeparator:".",PercentGroupSeparator:",",PercentSymbol:"%",PerMilleSymbol:"\u2030",NativeDigits:["0","1","2","3","4","5","6","7","8","9"],DigitSubstitution:1},dateTimeFormat:{AMDesignator:"AM",Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,IsReadOnly:!1},DateSeparator:"/",FirstDayOfWeek:0,CalendarWeekRule:0,FullDateTimePattern:"dddd, MMMM dd, yyyy h:mm:ss tt",LongDatePattern:"dddd, MMMM dd, yyyy",LongTimePattern:"h:mm:ss tt",MonthDayPattern:"MMMM dd",PMDesignator:"PM",RFC1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",ShortDatePattern:"M/d/yyyy",ShortTimePattern:"h:mm tt",SortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",TimeSeparator:":",UniversalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",YearMonthPattern:"MMMM, yyyy",AbbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ShortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],DayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],AbbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],MonthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],IsReadOnly:!1,NativeCalendarName:"Gregorian Calendar",AbbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],MonthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""]},eras:[1,"A.D.",null,0]}),Type.registerNamespace("Sys.Serialization"),Sys.Serialization.JavaScriptSerializer=function(){},Sys.Serialization.JavaScriptSerializer.registerClass("Sys.Serialization.JavaScriptSerializer"),Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs=[],Sys.Serialization.JavaScriptSerializer._charsToEscape=[],Sys.Serialization.JavaScriptSerializer._dateRegEx=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',"g"),Sys.Serialization.JavaScriptSerializer._escapeChars={},Sys.Serialization.JavaScriptSerializer._escapeRegEx=new RegExp('["\\\\\\x00-\\x1F]',"i"),Sys.Serialization.JavaScriptSerializer._escapeRegExGlobal=new RegExp('["\\\\\\x00-\\x1F]',"g"),Sys.Serialization.JavaScriptSerializer._jsonRegEx=new RegExp("[^,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]","g"),Sys.Serialization.JavaScriptSerializer._jsonStringRegEx=new RegExp('"(\\\\.|[^"\\\\])*"',"g"),Sys.Serialization.JavaScriptSerializer._serverTypeFieldName="__type",Sys.Serialization.JavaScriptSerializer._init=function(){var i=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000b","\\f","\\r","\\u000e","\\u000f","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001a","\\u001b","\\u001c","\\u001d","\\u001e","\\u001f"],n,t;for(Sys.Serialization.JavaScriptSerializer._charsToEscape[0]="\\",Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs["\\"]=new RegExp("\\\\","g"),Sys.Serialization.JavaScriptSerializer._escapeChars["\\"]="\\\\",Sys.Serialization.JavaScriptSerializer._charsToEscape[1]='"',Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs['"']=new RegExp('"',"g"),Sys.Serialization.JavaScriptSerializer._escapeChars['"']='\\"',n=0;n<32;n++)t=String.fromCharCode(n),Sys.Serialization.JavaScriptSerializer._charsToEscape[n+2]=t,Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs[t]=new RegExp(t,"g"),Sys.Serialization.JavaScriptSerializer._escapeChars[t]=i[n]},Sys.Serialization.JavaScriptSerializer._serializeBooleanWithBuilder=function(n,t){t.append(n.toString())},Sys.Serialization.JavaScriptSerializer._serializeNumberWithBuilder=function(n,t){if(isFinite(n))t.append(String(n));else throw Error.invalidOperation(Sys.Res.cannotSerializeNonFiniteNumbers);},Sys.Serialization.JavaScriptSerializer._serializeStringWithBuilder=function(n,t){var r,i;if(t.append('"'),Sys.Serialization.JavaScriptSerializer._escapeRegEx.test(n))if(Sys.Serialization.JavaScriptSerializer._charsToEscape.length===0&&Sys.Serialization.JavaScriptSerializer._init(),n.length<128)n=n.replace(Sys.Serialization.JavaScriptSerializer._escapeRegExGlobal,function(n){return Sys.Serialization.JavaScriptSerializer._escapeChars[n]});else for(r=0;r<34;r++)i=Sys.Serialization.JavaScriptSerializer._charsToEscape[r],n.indexOf(i)!==-1&&(n=Sys.Browser.agent===Sys.Browser.Opera||Sys.Browser.agent===Sys.Browser.FireFox?n.split(i).join(Sys.Serialization.JavaScriptSerializer._escapeChars[i]):n.replace(Sys.Serialization.JavaScriptSerializer._charsToEscapeRegExs[i],Sys.Serialization.JavaScriptSerializer._escapeChars[i]));t.append(n),t.append('"')},Sys.Serialization.JavaScriptSerializer._serializeWithBuilder=function(n,t,i,r){var u,f,e,o,h,s;switch(typeof n){case"object":if(n)if(Number.isInstanceOfType(n))Sys.Serialization.JavaScriptSerializer._serializeNumberWithBuilder(n,t);else if(Boolean.isInstanceOfType(n))Sys.Serialization.JavaScriptSerializer._serializeBooleanWithBuilder(n,t);else if(String.isInstanceOfType(n))Sys.Serialization.JavaScriptSerializer._serializeStringWithBuilder(n,t);else if(Array.isInstanceOfType(n)){for(t.append("["),u=0;u<n.length;++u)u>0&&t.append(","),Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(n[u],t,!1,r);t.append("]")}else{if(Date.isInstanceOfType(n)){t.append('"\\/Date('),t.append(n.getTime()),t.append(')\\/"');break}f=[],e=0;for(o in n)o.startsWith("$")||(o===Sys.Serialization.JavaScriptSerializer._serverTypeFieldName&&e!==0?(f[e++]=f[0],f[0]=o):f[e++]=o);for(i&&f.sort(),t.append("{"),h=!1,u=0;u<e;u++)s=n[f[u]],typeof s!="undefined"&&typeof s!="function"&&(h?t.append(","):h=!0,Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(f[u],t,i,r),t.append(":"),Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(s,t,i,r));t.append("}")}else t.append("null");break;case"number":Sys.Serialization.JavaScriptSerializer._serializeNumberWithBuilder(n,t);break;case"string":Sys.Serialization.JavaScriptSerializer._serializeStringWithBuilder(n,t);break;case"boolean":Sys.Serialization.JavaScriptSerializer._serializeBooleanWithBuilder(n,t);break;default:t.append("null")}},Sys.Serialization.JavaScriptSerializer.serialize=function(n){var t=new Sys.StringBuilder;return Sys.Serialization.JavaScriptSerializer._serializeWithBuilder(n,t,!1),t.toString()},Sys.Serialization.JavaScriptSerializer.deserialize=function(n,t){if(n.length===0)throw Error.argument("data",Sys.Res.cannotDeserializeEmptyString);try{var i=n.replace(Sys.Serialization.JavaScriptSerializer._dateRegEx,"$1new Date($2)");if(t&&Sys.Serialization.JavaScriptSerializer._jsonRegEx.test(i.replace(Sys.Serialization.JavaScriptSerializer._jsonStringRegEx,"")))throw null;return eval("("+i+")")}catch(r){throw Error.argument("data",Sys.Res.cannotDeserializeInvalidJson);}},Type.registerNamespace("Sys.UI"),Sys.EventHandlerList=function(){this._list={}},Sys.EventHandlerList.prototype={_addHandler:function(n,t){Array.add(this._getEvent(n,!0),t)},addHandler:function(n,t){this._addHandler(n,t)},_removeHandler:function(n,t){var i=this._getEvent(n);i&&Array.remove(i,t)},removeHandler:function(n,t){this._removeHandler(n,t)},getHandler:function(n){var t=this._getEvent(n);return!t||t.length===0?null:(t=Array.clone(t),function(n,i){for(var r=0,u=t.length;r<u;r++)t[r](n,i)})},_getEvent:function(n,t){if(!this._list[n]){if(!t)return null;this._list[n]=[]}return this._list[n]}},Sys.EventHandlerList.registerClass("Sys.EventHandlerList"),Sys.CommandEventArgs=function(n,t,i){Sys.CommandEventArgs.initializeBase(this),this._commandName=n,this._commandArgument=t,this._commandSource=i},Sys.CommandEventArgs.prototype={_commandName:null,_commandArgument:null,_commandSource:null,get_commandName:function(){return this._commandName},get_commandArgument:function(){return this._commandArgument},get_commandSource:function(){return this._commandSource}},Sys.CommandEventArgs.registerClass("Sys.CommandEventArgs",Sys.CancelEventArgs),Sys.INotifyPropertyChange=function(){},Sys.INotifyPropertyChange.prototype={},Sys.INotifyPropertyChange.registerInterface("Sys.INotifyPropertyChange"),Sys.PropertyChangedEventArgs=function(n){Sys.PropertyChangedEventArgs.initializeBase(this),this._propertyName=n},Sys.PropertyChangedEventArgs.prototype={get_propertyName:function(){return this._propertyName}},Sys.PropertyChangedEventArgs.registerClass("Sys.PropertyChangedEventArgs",Sys.EventArgs),Sys.INotifyDisposing=function(){},Sys.INotifyDisposing.prototype={},Sys.INotifyDisposing.registerInterface("Sys.INotifyDisposing"),Sys.Component=function(){Sys.Application&&Sys.Application.registerDisposableObject(this)},Sys.Component.prototype={_id:null,_initialized:!1,_updating:!1,get_events:function(){return this._events||(this._events=new Sys.EventHandlerList),this._events},get_id:function(){return this._id},set_id:function(n){this._id=n},get_isInitialized:function(){return this._initialized},get_isUpdating:function(){return this._updating},add_disposing:function(n){this.get_events().addHandler("disposing",n)},remove_disposing:function(n){this.get_events().removeHandler("disposing",n)},add_propertyChanged:function(n){this.get_events().addHandler("propertyChanged",n)},remove_propertyChanged:function(n){this.get_events().removeHandler("propertyChanged",n)},beginUpdate:function(){this._updating=!0},dispose:function(){if(this._events){var n=this._events.getHandler("disposing");n&&n(this,Sys.EventArgs.Empty)}delete this._events,Sys.Application.unregisterDisposableObject(this),Sys.Application.removeComponent(this)},endUpdate:function(){this._updating=!1,this._initialized||this.initialize(),this.updated()},initialize:function(){this._initialized=!0},raisePropertyChanged:function(n){if(this._events){var t=this._events.getHandler("propertyChanged");t&&t(this,new Sys.PropertyChangedEventArgs(n))}},updated:function(){}},Sys.Component.registerClass("Sys.Component",null,Sys.IDisposable,Sys.INotifyPropertyChange,Sys.INotifyDisposing),$create=Sys.Component.create=function(n,t,i,r,u){var f=u?new n(u):new n,e=Sys.Application,s=e.get_isCreatingComponents(),o;if(f.beginUpdate(),t&&Sys$Component$_setProperties(f,t),i)for(o in i)f["add_"+o](i[o]);return f.get_id()&&e.addComponent(f),s?(e._createdComponents[e._createdComponents.length]=f,r?e._addComponentToSecondPass(f,r):f.endUpdate()):(r&&Sys$Component$_setReferences(f,r),f.endUpdate()),f},Sys.UI.MouseButton=function(){throw Error.notImplemented();},Sys.UI.MouseButton.prototype={leftButton:0,middleButton:1,rightButton:2},Sys.UI.MouseButton.registerEnum("Sys.UI.MouseButton"),Sys.UI.Key=function(){throw Error.notImplemented();},Sys.UI.Key.prototype={backspace:8,tab:9,enter:13,esc:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,del:127},Sys.UI.Key.registerEnum("Sys.UI.Key"),Sys.UI.Point=function(n,t){this.rawX=n,this.rawY=t,this.x=Math.round(n),this.y=Math.round(t)},Sys.UI.Point.registerClass("Sys.UI.Point"),Sys.UI.Bounds=function(n,t,i,r){this.x=n,this.y=t,this.height=r,this.width=i},Sys.UI.Bounds.registerClass("Sys.UI.Bounds"),Sys.UI.DomEvent=function(n){var t=n,u=this.type=t.type.toLowerCase(),i,r;this.rawEvent=t,this.altKey=t.altKey,typeof t.button!="undefined"&&(this.button=typeof t.which!="undefined"?t.button:t.button===4?Sys.UI.MouseButton.middleButton:t.button===2?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton),u==="keypress"?this.charCode=t.charCode||t.keyCode:this.keyCode=t.keyCode&&t.keyCode===46?127:t.keyCode,this.clientX=t.clientX,this.clientY=t.clientY,this.ctrlKey=t.ctrlKey,this.target=t.target?t.target:t.srcElement,u.startsWith("key")||(typeof t.offsetX!="undefined"&&typeof t.offsetY!="undefined"?(this.offsetX=t.offsetX,this.offsetY=t.offsetY):this.target&&this.target.nodeType!==3&&typeof t.clientX=="number"&&(i=Sys.UI.DomElement.getLocation(this.target),r=Sys.UI.DomElement._getWindow(this.target),this.offsetX=(r.pageXOffset||0)+t.clientX-i.x,this.offsetY=(r.pageYOffset||0)+t.clientY-i.y)),this.screenX=t.screenX,this.screenY=t.screenY,this.shiftKey=t.shiftKey},Sys.UI.DomEvent.prototype={preventDefault:function(){this.rawEvent.preventDefault?this.rawEvent.preventDefault():window.event&&(this.rawEvent.returnValue=!1)},stopPropagation:function(){this.rawEvent.stopPropagation?this.rawEvent.stopPropagation():window.event&&(this.rawEvent.cancelBubble=!0)}},Sys.UI.DomEvent.registerClass("Sys.UI.DomEvent");var $addHandler=Sys.UI.DomEvent.addHandler=function(n,t,i,r){var u,f,e;n._events||(n._events={}),u=n._events[t],u||(n._events[t]=u=[]),n.addEventListener?(f=function(t){return i.call(n,new Sys.UI.DomEvent(t))},n.addEventListener(t,f,!1)):n.attachEvent&&(f=function(){var t={};try{t=Sys.UI.DomElement._getWindow(n).event}catch(r){}return i.call(n,new Sys.UI.DomEvent(t))},n.attachEvent("on"+t,f)),u[u.length]={handler:i,browserHandler:f,autoRemove:r},r&&(e=n.dispose,e!==Sys.UI.DomEvent._disposeHandlers&&(n.dispose=Sys.UI.DomEvent._disposeHandlers,typeof e!="undefined"&&(n._chainDispose=e)))},$addHandlers=Sys.UI.DomEvent.addHandlers=function(n,t,i,r){var f,u;for(f in t)u=t[f],i&&(u=Function.createDelegate(i,u)),$addHandler(n,f,u,r||!1)},$clearHandlers=Sys.UI.DomEvent.clearHandlers=function(n){Sys.UI.DomEvent._clearHandlers(n,!1)};Sys.UI.DomEvent._clearHandlers=function(n,t){var r,u,f,i,e;if(n._events){r=n._events;for(u in r)for(f=r[u],i=f.length-1;i>=0;i--)e=f[i],(!t||e.autoRemove)&&$removeHandler(n,u,e.handler);n._events=null}},Sys.UI.DomEvent._disposeHandlers=function(){Sys.UI.DomEvent._clearHandlers(this,!0);var n=this._chainDispose,t=typeof n;t!=="undefined"&&(this.dispose=n,this._chainDispose=null,t==="function"&&this.dispose())},$removeHandler=Sys.UI.DomEvent.removeHandler=function(n,t,i){Sys.UI.DomEvent._removeHandler(n,t,i)},Sys.UI.DomEvent._removeHandler=function(n,t,i){for(var f=null,u=n._events[t],r=0,e=u.length;r<e;r++)if(u[r].handler===i){f=u[r].browserHandler;break}n.removeEventListener?n.removeEventListener(t,f,!1):n.detachEvent&&n.detachEvent("on"+t,f),u.splice(r,1)},Sys.UI.DomElement=function(){},Sys.UI.DomElement.registerClass("Sys.UI.DomElement"),Sys.UI.DomElement.addCssClass=function(n,t){Sys.UI.DomElement.containsCssClass(n,t)||(n.className===""?n.className=t:n.className+=" "+t)},Sys.UI.DomElement.containsCssClass=function(n,t){return Array.contains(n.className.split(" "),t)},Sys.UI.DomElement.getBounds=function(n){var t=Sys.UI.DomElement.getLocation(n);return new Sys.UI.Bounds(t.x,t.y,n.offsetWidth||0,n.offsetHeight||0)},$get=Sys.UI.DomElement.getElementById=function(n,t){var u,f,r,i;if(!t)return document.getElementById(n);if(t.getElementById)return t.getElementById(n);for(u=[],f=t.childNodes,r=0;r<f.length;r++)i=f[r],i.nodeType==1&&(u[u.length]=i);while(u.length){if(i=u.shift(),i.id==n)return i;for(f=i.childNodes,r=0;r<f.length;r++)i=f[r],i.nodeType==1&&(u[u.length]=i)}return null},Sys.UI.DomElement.getLocation=document.documentElement.getBoundingClientRect?function(n){var u,e,o;if(n.self||n.nodeType===9||n===document.documentElement||n.parentNode===n.ownerDocument.documentElement)return new Sys.UI.Point(0,0);if(u=n.getBoundingClientRect(),!u)return new Sys.UI.Point(0,0);var f=n.ownerDocument.documentElement,s=n.ownerDocument.body,l,i=Math.round(u.left)+(f.scrollLeft||s.scrollLeft),r=Math.round(u.top)+(f.scrollTop||s.scrollTop);if(Sys.Browser.agent===Sys.Browser.InternetExplorer){try{e=n.ownerDocument.parentWindow.frameElement||null,e&&(o=e.frameBorder==="0"||e.frameBorder==="no"?2:0,i+=o,r+=o)}catch(a){}if(Sys.Browser.version===7&&!document.documentMode){var h=document.body,c=h.getBoundingClientRect(),t=(c.right-c.left)/h.clientWidth;t=Math.round(t*100),t=(t-t%5)/100,isNaN(t)||t===1||(i=Math.round(i/t),r=Math.round(r/t))}(document.documentMode||0)<8&&(i-=f.clientLeft,r-=f.clientTop)}return new Sys.UI.Point(i,r)}:Sys.Browser.agent===Sys.Browser.Safari?function(n){var r,o,s;if(n.window&&n.window===n||n.nodeType===9)return new Sys.UI.Point(0,0);for(var u=0,f=0,h=null,e=null,i,t=n;t;h=t,e=i,t=t.offsetParent)i=Sys.UI.DomElement._getCurrentStyle(t),r=t.tagName?t.tagName.toUpperCase():null,(t.offsetLeft||t.offsetTop)&&(r!=="BODY"||!e||e.position!=="absolute")&&(u+=t.offsetLeft,f+=t.offsetTop),h&&Sys.Browser.version>=3&&(u+=parseInt(i.borderLeftWidth),f+=parseInt(i.borderTopWidth));if(i=Sys.UI.DomElement._getCurrentStyle(n),o=i?i.position:null,!o||o!=="absolute")for(t=n.parentNode;t;t=t.parentNode)if(r=t.tagName?t.tagName.toUpperCase():null,r!=="BODY"&&r!=="HTML"&&(t.scrollLeft||t.scrollTop)&&(u-=t.scrollLeft||0,f-=t.scrollTop||0),i=Sys.UI.DomElement._getCurrentStyle(t),s=i?i.position:null,s&&s==="absolute")break;return new Sys.UI.Point(u,f)}:function(n){var r,o;if(n.window&&n.window===n||n.nodeType===9)return new Sys.UI.Point(0,0);for(var u=0,f=0,s=null,e=null,i=null,t=n;t;s=t,e=i,t=t.offsetParent)r=t.tagName?t.tagName.toUpperCase():null,i=Sys.UI.DomElement._getCurrentStyle(t),!t.offsetLeft&&!t.offsetTop||r==="BODY"&&(!e||e.position!=="absolute")||(u+=t.offsetLeft,f+=t.offsetTop),s!==null&&i&&(r!=="TABLE"&&r!=="TD"&&r!=="HTML"&&(u+=parseInt(i.borderLeftWidth)||0,f+=parseInt(i.borderTopWidth)||0),r==="TABLE"&&(i.position==="relative"||i.position==="absolute")&&(u+=parseInt(i.marginLeft)||0,f+=parseInt(i.marginTop)||0));if(i=Sys.UI.DomElement._getCurrentStyle(n),o=i?i.position:null,!o||o!=="absolute")for(t=n.parentNode;t;t=t.parentNode)r=t.tagName?t.tagName.toUpperCase():null,r!=="BODY"&&r!=="HTML"&&(t.scrollLeft||t.scrollTop)&&(u-=t.scrollLeft||0,f-=t.scrollTop||0,i=Sys.UI.DomElement._getCurrentStyle(t),i&&(u+=parseInt(i.borderLeftWidth)||0,f+=parseInt(i.borderTopWidth)||0));return new Sys.UI.Point(u,f)},Sys.UI.DomElement.isDomElement=function(n){return Sys._isDomElement(n)},Sys.UI.DomElement.removeCssClass=function(n,t){var i=" "+n.className+" ",r=i.indexOf(" "+t+" ");r>=0&&(n.className=(i.substr(0,r)+" "+i.substring(r+t.length+1,i.length)).trim())},Sys.UI.DomElement.resolveElement=function(n,t){var i=n;return i?(typeof i=="string"&&(i=Sys.UI.DomElement.getElementById(i,t)),i):null},Sys.UI.DomElement.raiseBubbleEvent=function(n,t){for(var r=n,i;r;){if(i=r.control,i&&i.onBubbleEvent&&i.raiseBubbleEvent){Sys.UI.DomElement._raiseBubbleEventFromControl(i,n,t);return}r=r.parentNode}},Sys.UI.DomElement._raiseBubbleEventFromControl=function(n,t,i){n.onBubbleEvent(t,i)||n._raiseBubbleEvent(t,i)},Sys.UI.DomElement.setLocation=function(n,t,i){var r=n.style;r.position="absolute",r.left=t+"px",r.top=i+"px"},Sys.UI.DomElement.toggleCssClass=function(n,t){Sys.UI.DomElement.containsCssClass(n,t)?Sys.UI.DomElement.removeCssClass(n,t):Sys.UI.DomElement.addCssClass(n,t)},Sys.UI.DomElement.getVisibilityMode=function(n){return n._visibilityMode===Sys.UI.VisibilityMode.hide?Sys.UI.VisibilityMode.hide:Sys.UI.VisibilityMode.collapse},Sys.UI.DomElement.setVisibilityMode=function(n,t){Sys.UI.DomElement._ensureOldDisplayMode(n),n._visibilityMode!==t&&(n._visibilityMode=t,Sys.UI.DomElement.getVisible(n)===!1&&(n.style.display=n._visibilityMode===Sys.UI.VisibilityMode.hide?n._oldDisplayMode:"none"),n._visibilityMode=t)},Sys.UI.DomElement.getVisible=function(n){var t=n.currentStyle||Sys.UI.DomElement._getCurrentStyle(n);return t?t.visibility!=="hidden"&&t.display!=="none":!0},Sys.UI.DomElement.setVisible=function(n,t){t!==Sys.UI.DomElement.getVisible(n)&&(Sys.UI.DomElement._ensureOldDisplayMode(n),n.style.visibility=t?"visible":"hidden",n.style.display=t||n._visibilityMode===Sys.UI.VisibilityMode.hide?n._oldDisplayMode:"none")},Sys.UI.DomElement._ensureOldDisplayMode=function(n){if(!n._oldDisplayMode){var t=n.currentStyle||Sys.UI.DomElement._getCurrentStyle(n);if(n._oldDisplayMode=t?t.display:null,!n._oldDisplayMode||n._oldDisplayMode==="none")switch(n.tagName.toUpperCase()){case"DIV":case"P":case"ADDRESS":case"BLOCKQUOTE":case"BODY":case"COL":case"COLGROUP":case"DD":case"DL":case"DT":case"FIELDSET":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HR":case"IFRAME":case"LEGEND":case"OL":case"PRE":case"TABLE":case"TD":case"TH":case"TR":case"UL":n._oldDisplayMode="block";break;case"LI":n._oldDisplayMode="list-item";break;default:n._oldDisplayMode="inline"}}},Sys.UI.DomElement._getWindow=function(n){var t=n.ownerDocument||n.document||n;return t.defaultView||t.parentWindow},Sys.UI.DomElement._getCurrentStyle=function(n){var t,i,f,e,r,u;if(n.nodeType===3)return null;if(t=Sys.UI.DomElement._getWindow(n),n.documentElement&&(n=n.documentElement),i=t&&n!==t&&t.getComputedStyle?t.getComputedStyle(n,null):n.currentStyle||n.style,!i&&Sys.Browser.agent===Sys.Browser.Safari&&n.style){f=n.style.display,e=n.style.position,n.style.position="absolute",n.style.display="block",r=t.getComputedStyle(n,null),n.style.display=f,n.style.position=e,i={};for(u in r)i[u]=r[u];i.display="none"}return i},Sys.IContainer=function(){},Sys.IContainer.prototype={},Sys.IContainer.registerInterface("Sys.IContainer"),Sys.ApplicationLoadEventArgs=function(n,t){Sys.ApplicationLoadEventArgs.initializeBase(this),this._components=n,this._isPartialLoad=t},Sys.ApplicationLoadEventArgs.prototype={get_components:function(){return this._components},get_isPartialLoad:function(){return this._isPartialLoad}},Sys.ApplicationLoadEventArgs.registerClass("Sys.ApplicationLoadEventArgs",Sys.EventArgs),Sys._Application=function(){Sys._Application.initializeBase(this),this._disposableObjects=[],this._components={},this._createdComponents=[],this._secondPassComponents=[],this._unloadHandlerDelegate=Function.createDelegate(this,this._unloadHandler),Sys.UI.DomEvent.addHandler(window,"unload",this._unloadHandlerDelegate),this._domReady()},Sys._Application.prototype={_creatingComponents:!1,_disposing:!1,_deleteCount:0,get_isCreatingComponents:function(){return this._creatingComponents},get_isDisposing:function(){return this._disposing},add_init:function(n){this._initialized?n(this,Sys.EventArgs.Empty):this.get_events().addHandler("init",n)},remove_init:function(n){this.get_events().removeHandler("init",n)},add_load:function(n){this.get_events().addHandler("load",n)},remove_load:function(n){this.get_events().removeHandler("load",n)},add_unload:function(n){this.get_events().addHandler("unload",n)},remove_unload:function(n){this.get_events().removeHandler("unload",n)},addComponent:function(n){this._components[n.get_id()]=n},beginCreateComponents:function(){this._creatingComponents=!0},dispose:function(){var t,i,n,f,r,u;if(!this._disposing){for(this._disposing=!0,this._timerCookie&&(window.clearTimeout(this._timerCookie),delete this._timerCookie),this._endRequestHandler&&(Sys.WebForms.PageRequestManager.getInstance().remove_endRequest(this._endRequestHandler),delete this._endRequestHandler),this._beginRequestHandler&&(Sys.WebForms.PageRequestManager.getInstance().remove_beginRequest(this._beginRequestHandler),delete this._beginRequestHandler),window.pageUnload&&window.pageUnload(this,Sys.EventArgs.Empty),t=this.get_events().getHandler("unload"),t&&t(this,Sys.EventArgs.Empty),i=Array.clone(this._disposableObjects),n=0,f=i.length;n<f;n++)r=i[n],typeof r!="undefined"&&r.dispose();Array.clear(this._disposableObjects),Sys.UI.DomEvent.removeHandler(window,"unload",this._unloadHandlerDelegate),Sys._ScriptLoader&&(u=Sys._ScriptLoader.getInstance(),u&&u.dispose()),Sys._Application.callBaseMethod(this,"dispose")}},disposeElement:function(n,t){var f,e,u,i;if(n.nodeType===1){for(var s=n.getElementsByTagName("*"),o=s.length,h=new Array(o),r=0;r<o;r++)h[r]=s[r];for(r=o-1;r>=0;r--)f=h[r],e=f.dispose,e&&typeof e=="function"?f.dispose():(u=f.control,u&&typeof u.dispose=="function"&&u.dispose()),i=f._behaviors,i&&this._disposeComponents(i),i=f._components,i&&(this._disposeComponents(i),f._components=null);t||(e=n.dispose,e&&typeof e=="function"?n.dispose():(u=n.control,u&&typeof u.dispose=="function"&&u.dispose()),i=n._behaviors,i&&this._disposeComponents(i),i=n._components,i&&(this._disposeComponents(i),n._components=null))}},endCreateComponents:function(){for(var t=this._secondPassComponents,i,n=0,r=t.length;n<r;n++)i=t[n].component,Sys$Component$_setReferences(i,t[n].references),i.endUpdate();this._secondPassComponents=[],this._creatingComponents=!1},findComponent:function(n,t){return t?Sys.IContainer.isInstanceOfType(t)?t.findComponent(n):t[n]||null:Sys.Application._components[n]||null},getComponents:function(){var n=[],t=this._components,i;for(i in t)n[n.length]=t[i];return n},initialize:function(){if(!this.get_isInitialized()&&!this._disposing){if(Sys._Application.callBaseMethod(this,"initialize"),this._raiseInit(),this.get_stateString){Sys.WebForms&&Sys.WebForms.PageRequestManager&&(this._beginRequestHandler=Function.createDelegate(this,this._onPageRequestManagerBeginRequest),Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(this._beginRequestHandler),this._endRequestHandler=Function.createDelegate(this,this._onPageRequestManagerEndRequest),Sys.WebForms.PageRequestManager.getInstance().add_endRequest(this._endRequestHandler));var n=this.get_stateString();n!==this._currentEntry?this._navigate(n):this._ensureHistory()}this.raiseLoad()}},notifyScriptLoaded:function(){},registerDisposableObject:function(n){if(!this._disposing){var t=this._disposableObjects,i=t.length;t[i]=n,n.__msdisposeindex=i}},raiseLoad:function(){var n=this.get_events().getHandler("load"),t=new Sys.ApplicationLoadEventArgs(Array.clone(this._createdComponents),!!this._loaded);this._loaded=!0,n&&n(this,t),window.pageLoad&&window.pageLoad(this,t),this._createdComponents=[]},removeComponent:function(n){var t=n.get_id();t&&delete this._components[t]},unregisterDisposableObject:function(n){var u,t,i,r,f;if(!this._disposing&&(u=n.__msdisposeindex,typeof u=="number"&&(t=this._disposableObjects,delete t[u],delete n.__msdisposeindex,++this._deleteCount>1e3))){for(i=[],r=0,f=t.length;r<f;r++)n=t[r],typeof n!="undefined"&&(n.__msdisposeindex=i.length,i.push(n));this._disposableObjects=i,this._deleteCount=0}},_addComponentToSecondPass:function(n,t){this._secondPassComponents[this._secondPassComponents.length]={component:n,references:t}},_disposeComponents:function(n){var t,i;if(n)for(t=n.length-1;t>=0;t--)i=n[t],typeof i.dispose=="function"&&i.dispose()},_domReady:function(){function t(){u.initialize()}var n,e,u=this,r=function(){Sys.UI.DomEvent.removeHandler(window,"load",r),t()},f,i;if(Sys.UI.DomEvent.addHandler(window,"load",r),document.addEventListener)try{document.addEventListener("DOMContentLoaded",n=function(){document.removeEventListener("DOMContentLoaded",n,!1),t()},!1)}catch(o){}else document.attachEvent&&(window==window.top&&document.documentElement.doScroll?(i=document.createElement("div"),n=function(){try{i.doScroll("left")}catch(r){f=window.setTimeout(n,0);return}i=null,t()},n()):document.attachEvent("onreadystatechange",n=function(){document.readyState==="complete"&&(document.detachEvent("onreadystatechange",n),t())}))},_raiseInit:function(){var n=this.get_events().getHandler("init");n&&(this.beginCreateComponents(),n(this,Sys.EventArgs.Empty),this.endCreateComponents())},_unloadHandler:function(){this.dispose()}},Sys._Application.registerClass("Sys._Application",Sys.Component,Sys.IContainer),Sys.Application=new Sys._Application,$find=Sys.Application.findComponent,Sys.UI.Behavior=function(n){Sys.UI.Behavior.initializeBase(this),this._element=n;var t=n._behaviors;t?t[t.length]=this:n._behaviors=[this]},Sys.UI.Behavior.prototype={_name:null,get_element:function(){return this._element},get_id:function(){var n=Sys.UI.Behavior.callBaseMethod(this,"get_id");return n?n:!this._element||!this._element.id?"":this._element.id+"$"+this.get_name()},get_name:function(){if(this._name)return this._name;var n=Object.getTypeName(this),t=n.lastIndexOf(".");return t!==-1&&(n=n.substr(t+1)),this.get_isInitialized()||(this._name=n),n},set_name:function(n){this._name=n},initialize:function(){Sys.UI.Behavior.callBaseMethod(this,"initialize");var n=this.get_name();n&&(this._element[n]=this)},dispose:function(){var n,t,i;Sys.UI.Behavior.callBaseMethod(this,"dispose"),n=this._element,n&&(t=this.get_name(),t&&(n[t]=null),i=n._behaviors,Array.remove(i,this),i.length===0&&(n._behaviors=null),delete this._element)}},Sys.UI.Behavior.registerClass("Sys.UI.Behavior",Sys.Component),Sys.UI.Behavior.getBehaviorByName=function(n,t){var i=n[t];return i&&Sys.UI.Behavior.isInstanceOfType(i)?i:null},Sys.UI.Behavior.getBehaviors=function(n){return n._behaviors?Array.clone(n._behaviors):[]},Sys.UI.Behavior.getBehaviorsByType=function(n,t){var r=n._behaviors,u=[],i,f;if(r)for(i=0,f=r.length;i<f;i++)t.isInstanceOfType(r[i])&&(u[u.length]=r[i]);return u},Sys.UI.VisibilityMode=function(){throw Error.notImplemented();},Sys.UI.VisibilityMode.prototype={hide:0,collapse:1},Sys.UI.VisibilityMode.registerEnum("Sys.UI.VisibilityMode"),Sys.UI.Control=function(n){Sys.UI.Control.initializeBase(this),this._element=n,n.control=this;var t=this.get_role();t&&n.setAttribute("role",t)},Sys.UI.Control.prototype={_parent:null,_visibilityMode:Sys.UI.VisibilityMode.hide,get_element:function(){return this._element},get_id:function(){return this._element?this._element.id:""},set_id:function(){throw Error.invalidOperation(Sys.Res.cantSetId);},get_parent:function(){if(this._parent)return this._parent;if(!this._element)return null;for(var n=this._element.parentNode;n;){if(n.control)return n.control;n=n.parentNode}return null},set_parent:function(n){this._parent=n},get_role:function(){return null},get_visibilityMode:function(){return Sys.UI.DomElement.getVisibilityMode(this._element)},set_visibilityMode:function(n){Sys.UI.DomElement.setVisibilityMode(this._element,n)},get_visible:function(){return Sys.UI.DomElement.getVisible(this._element)},set_visible:function(n){Sys.UI.DomElement.setVisible(this._element,n)},addCssClass:function(n){Sys.UI.DomElement.addCssClass(this._element,n)},dispose:function(){Sys.UI.Control.callBaseMethod(this,"dispose"),this._element&&(this._element.control=null,delete this._element),this._parent&&delete this._parent},onBubbleEvent:function(){return!1},raiseBubbleEvent:function(n,t){this._raiseBubbleEvent(n,t)},_raiseBubbleEvent:function(n,t){for(var i=this.get_parent();i;){if(i.onBubbleEvent(n,t))return;i=i.get_parent()}},removeCssClass:function(n){Sys.UI.DomElement.removeCssClass(this._element,n)},toggleCssClass:function(n){Sys.UI.DomElement.toggleCssClass(this._element,n)}},Sys.UI.Control.registerClass("Sys.UI.Control",Sys.Component),Sys.HistoryEventArgs=function(n){Sys.HistoryEventArgs.initializeBase(this),this._state=n},Sys.HistoryEventArgs.prototype={get_state:function(){return this._state}},Sys.HistoryEventArgs.registerClass("Sys.HistoryEventArgs",Sys.EventArgs),Sys.Application._appLoadHandler=null,Sys.Application._beginRequestHandler=null,Sys.Application._clientId=null,Sys.Application._currentEntry="",Sys.Application._endRequestHandler=null,Sys.Application._history=null,Sys.Application._enableHistory=!1,Sys.Application._historyFrame=null,Sys.Application._historyInitialized=!1,Sys.Application._historyPointIsNew=!1,Sys.Application._ignoreTimer=!1,Sys.Application._initialState=null,Sys.Application._state={},Sys.Application._timerCookie=0,Sys.Application._timerHandler=null,Sys.Application._uniqueId=null,Sys._Application.prototype.get_stateString=function(){var n=null,t,i;return Sys.Browser.agent===Sys.Browser.Firefox?(t=window.location.href,i=t.indexOf("#"),n=i!==-1?t.substring(i+1):""):(n=window.location.hash,n.length>0&&n.charAt(0)==="#"&&(n=n.substring(1)),n)},Sys._Application.prototype.get_enableHistory=function(){return this._enableHistory},Sys._Application.prototype.set_enableHistory=function(n){this._enableHistory=n},Sys._Application.prototype.add_navigate=function(n){this.get_events().addHandler("navigate",n)},Sys._Application.prototype.remove_navigate=function(n){this.get_events().removeHandler("navigate",n)},Sys._Application.prototype.addHistoryPoint=function(n,t){var i,r,u,f;this._ensureHistory(),i=this._state;for(r in n)u=n[r],u===null?typeof i[r]!="undefined"&&delete i[r]:i[r]=u;f=this._serializeState(i),this._historyPointIsNew=!0,this._setState(f,t),this._raiseNavigate()},Sys._Application.prototype.setServerId=function(n,t){this._clientId=n,this._uniqueId=t},Sys._Application.prototype.setServerState=function(n){this._ensureHistory(),this._state.__s=n,this._updateHiddenField(n)},Sys._Application.prototype._deserializeState=function(n){var f={},t,e,u,o,i,r,s,h;for(n=n||"",t=n.indexOf("&&"),t!==-1&&t+2<n.length&&(f.__s=n.substr(t+2),n=n.substr(0,t)),e=n.split("&"),u=0,o=e.length;u<o;u++)i=e[u],r=i.indexOf("="),r!==-1&&r+1<i.length&&(s=i.substr(0,r),h=i.substr(r+1),f[s]=decodeURIComponent(h));return f},Sys._Application.prototype._enableHistoryInScriptManager=function(){this._enableHistory=!0},Sys._Application.prototype._ensureHistory=function(){if(!this._historyInitialized&&this._enableHistory){Sys.Browser.agent===Sys.Browser.InternetExplorer&&(!document.documentMode||document.documentMode<8)&&(this._historyFrame=document.getElementById("__historyFrame"),this._ignoreIFrame=!0),this._timerHandler=Function.createDelegate(this,this._onIdle),this._timerCookie=window.setTimeout(this._timerHandler,100);try{this._initialState=this._deserializeState(this.get_stateString())}catch(n){}this._historyInitialized=!0}},Sys._Application.prototype._navigate=function(n){var t,r,i;if(this._ensureHistory(),t=this._deserializeState(n),this._uniqueId&&(r=this._state.__s||"",i=t.__s||"",i!==r)){this._updateHiddenField(i),__doPostBack(this._uniqueId,i),this._state=t;return}this._setState(n),this._state=t,this._raiseNavigate()},Sys._Application.prototype._onIdle=function(){delete this._timerCookie;var n=this.get_stateString();n!==this._currentEntry?this._ignoreTimer||(this._historyPointIsNew=!1,this._navigate(n)):this._ignoreTimer=!1,this._timerCookie=window.setTimeout(this._timerHandler,100)},Sys._Application.prototype._onIFrameLoad=function(n){(!document.documentMode||document.documentMode<8)&&(this._ensureHistory(),this._ignoreIFrame||(this._historyPointIsNew=!1,this._navigate(n)),this._ignoreIFrame=!1)},Sys._Application.prototype._onPageRequestManagerBeginRequest=function(){this._ignoreTimer=!0,this._originalTitle=document.title},Sys._Application.prototype._onPageRequestManagerEndRequest=function(n,t){var u=t.get_dataItems()[this._clientId],f=this._originalTitle,r,i,e;this._originalTitle=null,r=document.getElementById("__EVENTTARGET"),r&&r.value===this._uniqueId&&(r.value=""),typeof u!="undefined"?(this.setServerState(u),this._historyPointIsNew=!0):this._ignoreTimer=!1,i=this._serializeState(this._state),i!==this._currentEntry&&(this._ignoreTimer=!0,typeof f=="string"?(Sys.Browser.agent!==Sys.Browser.InternetExplorer||Sys.Browser.version>7?(e=document.title,document.title=f,this._setState(i),document.title=e):this._setState(i),this._raiseNavigate()):(this._setState(i),this._raiseNavigate()))},Sys._Application.prototype._raiseNavigate=function(){var u=this._historyPointIsNew,t=this.get_events().getHandler("navigate"),i={},n,r,f;for(n in this._state)n!=="__s"&&(i[n]=this._state[n]);if(r=new Sys.HistoryEventArgs(i),t&&t(this,r),!u)try{Sys.Browser.agent===Sys.Browser.Firefox&&window.location.hash&&(!window.frameElement||window.top.location.hash)&&(Sys.Browser.version<3.5?window.history.go(0):location.hash=this.get_stateString())}catch(e){}},Sys._Application.prototype._serializeState=function(n){var i=[],t,r,u;for(t in n)r=n[t],t==="__s"?u=r:i[i.length]=t+"="+encodeURIComponent(r);return i.join("&")+(u?"&&"+u:"")},Sys._Application.prototype._setState=function(n,t){var i,u,f,e,r,o;this._enableHistory&&(n=n||"",n!==this._currentEntry&&(window.theForm&&(i=window.theForm.action,u=i.indexOf("#"),window.theForm.action=(u!==-1?i.substring(0,u):i)+"#"+n),this._historyFrame&&this._historyPointIsNew&&(f=document.createElement("div"),f.appendChild(document.createTextNode(t||document.title)),e=f.innerHTML,this._ignoreIFrame=!0,r=this._historyFrame.contentWindow.document,r.open("javascript:'<html></html>'"),r.write("<html><head><title>"+e+'</title><script type="text/javascript">parent.Sys.Application._onIFrameLoad('+Sys.Serialization.JavaScriptSerializer.serialize(n)+");<\/script></head><body></body></html>"),r.close()),this._ignoreTimer=!1,this._currentEntry=n,(this._historyFrame||this._historyPointIsNew)&&(o=this.get_stateString(),n!==o&&(window.location.hash=n,this._currentEntry=this.get_stateString(),typeof t!="undefined"&&t!==null&&(document.title=t))),this._historyPointIsNew=!1))},Sys._Application.prototype._updateHiddenField=function(n){if(this._clientId){var t=document.getElementById(this._clientId);t&&(t.value=n)}},window.XMLHttpRequest||(window.XMLHttpRequest=function(){for(var t=["Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP"],n=0,i=t.length;n<i;n++)try{return new ActiveXObject(t[n])}catch(r){}return null}),Type.registerNamespace("Sys.Net"),Sys.Net.WebRequestExecutor=function(){this._webRequest=null,this._resultObject=null},Sys.Net.WebRequestExecutor.prototype={get_webRequest:function(){return this._webRequest},_set_webRequest:function(n){this._webRequest=n},get_started:function(){throw Error.notImplemented();},get_responseAvailable:function(){throw Error.notImplemented();},get_timedOut:function(){throw Error.notImplemented();},get_aborted:function(){throw Error.notImplemented();},get_responseData:function(){throw Error.notImplemented();},get_statusCode:function(){throw Error.notImplemented();},get_statusText:function(){throw Error.notImplemented();},get_xml:function(){throw Error.notImplemented();},get_object:function(){return this._resultObject||(this._resultObject=Sys.Serialization.JavaScriptSerializer.deserialize(this.get_responseData())),this._resultObject},executeRequest:function(){throw Error.notImplemented();},abort:function(){throw Error.notImplemented();},getResponseHeader:function(){throw Error.notImplemented();},getAllResponseHeaders:function(){throw Error.notImplemented();}},Sys.Net.WebRequestExecutor.registerClass("Sys.Net.WebRequestExecutor"),Sys.Net.XMLDOM=function(n){var r,i,u,t,f;if(window.DOMParser)try{return f=new window.DOMParser,f.parseFromString(n,"text/xml")}catch(e){}else for(r=["Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"],i=0,u=r.length;i<u;i++)try{return t=new ActiveXObject(r[i]),t.async=!1,t.loadXML(n),t.setProperty("SelectionLanguage","XPath"),t}catch(e){}return null},Sys.Net.XMLHttpExecutor=function(){Sys.Net.XMLHttpExecutor.initializeBase(this);var n=this;this._xmlHttpRequest=null,this._webRequest=null,this._responseAvailable=!1,this._timedOut=!1,this._timer=null,this._aborted=!1,this._started=!1,this._onReadyStateChange=function(){if(n._xmlHttpRequest.readyState===4){try{if(typeof n._xmlHttpRequest.status=="undefined")return}catch(t){return}n._clearTimer(),n._responseAvailable=!0;try{n._webRequest.completed(Sys.EventArgs.Empty)}finally{n._xmlHttpRequest!=null&&(n._xmlHttpRequest.onreadystatechange=Function.emptyMethod,n._xmlHttpRequest=null)}}},this._clearTimer=function(){n._timer!=null&&(window.clearTimeout(n._timer),n._timer=null)},this._onTimeout=function(){n._responseAvailable||(n._clearTimer(),n._timedOut=!0,n._xmlHttpRequest.onreadystatechange=Function.emptyMethod,n._xmlHttpRequest.abort(),n._webRequest.completed(Sys.EventArgs.Empty),n._xmlHttpRequest=null)}},Sys.Net.XMLHttpExecutor.prototype={get_timedOut:function(){return this._timedOut},get_started:function(){return this._started},get_responseAvailable:function(){return this._responseAvailable},get_aborted:function(){return this._aborted},executeRequest:function(){var t,n,i,r,u,f;if(this._webRequest=this.get_webRequest(),t=this._webRequest.get_body(),n=this._webRequest.get_headers(),this._xmlHttpRequest=new XMLHttpRequest,this._xmlHttpRequest.onreadystatechange=this._onReadyStateChange,i=this._webRequest.get_httpVerb(),this._xmlHttpRequest.open(i,this._webRequest.getResolvedUrl(),!0),this._xmlHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest"),n)for(r in n)u=n[r],typeof u!="function"&&this._xmlHttpRequest.setRequestHeader(r,u);i.toLowerCase()==="post"&&(n!==null&&n["Content-Type"]||this._xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),t||(t="")),f=this._webRequest.get_timeout(),f>0&&(this._timer=window.setTimeout(Function.createDelegate(this,this._onTimeout),f)),this._xmlHttpRequest.send(t),this._started=!0},getResponseHeader:function(n){var t;try{t=this._xmlHttpRequest.getResponseHeader(n)}catch(i){}return t||(t=""),t},getAllResponseHeaders:function(){return this._xmlHttpRequest.getAllResponseHeaders()},get_responseData:function(){return this._xmlHttpRequest.responseText},get_statusCode:function(){var n=0;try{n=this._xmlHttpRequest.status}catch(t){}return n},get_statusText:function(){return this._xmlHttpRequest.statusText},get_xml:function(){var n=this._xmlHttpRequest.responseXML;if(n&&n.documentElement)navigator.userAgent.indexOf("MSIE")!==-1&&typeof n.setProperty!="undefined"&&n.setProperty("SelectionLanguage","XPath");else if(n=Sys.Net.XMLDOM(this._xmlHttpRequest.responseText),!n||!n.documentElement)return null;return n.documentElement.namespaceURI==="http://www.mozilla.org/newlayout/xml/parsererror.xml"&&n.documentElement.tagName==="parsererror"?null:n.documentElement.firstChild&&n.documentElement.firstChild.tagName==="parsererror"?null:n},abort:function(){this._aborted||this._responseAvailable||this._timedOut||(this._aborted=!0,this._clearTimer(),this._xmlHttpRequest&&!this._responseAvailable&&(this._xmlHttpRequest.onreadystatechange=Function.emptyMethod,this._xmlHttpRequest.abort(),this._xmlHttpRequest=null,this._webRequest.completed(Sys.EventArgs.Empty)))}},Sys.Net.XMLHttpExecutor.registerClass("Sys.Net.XMLHttpExecutor",Sys.Net.WebRequestExecutor),Sys.Net._WebRequestManager=function(){this._defaultTimeout=0,this._defaultExecutorType="Sys.Net.XMLHttpExecutor"},Sys.Net._WebRequestManager.prototype={add_invokingRequest:function(n){this._get_eventHandlerList().addHandler("invokingRequest",n)},remove_invokingRequest:function(n){this._get_eventHandlerList().removeHandler("invokingRequest",n)},add_completedRequest:function(n){this._get_eventHandlerList().addHandler("completedRequest",n)},remove_completedRequest:function(n){this._get_eventHandlerList().removeHandler("completedRequest",n)},_get_eventHandlerList:function(){return this._events||(this._events=new Sys.EventHandlerList),this._events},get_defaultTimeout:function(){return this._defaultTimeout},set_defaultTimeout:function(n){this._defaultTimeout=n},get_defaultExecutorType:function(){return this._defaultExecutorType},set_defaultExecutorType:function(n){this._defaultExecutorType=n},executeRequest:function(n){var t=n.get_executor(),u,f,i,r;if(!t){u=!1;try{f=eval(this._defaultExecutorType),t=new f}catch(e){u=!0}n.set_executor(t)}t.get_aborted()||(i=new Sys.Net.NetworkRequestEventArgs(n),r=this._get_eventHandlerList().getHandler("invokingRequest"),r&&r(this,i),i.get_cancel()||t.executeRequest())}},Sys.Net._WebRequestManager.registerClass("Sys.Net._WebRequestManager"),Sys.Net.WebRequestManager=new Sys.Net._WebRequestManager,Sys.Net.NetworkRequestEventArgs=function(n){Sys.Net.NetworkRequestEventArgs.initializeBase(this),this._webRequest=n},Sys.Net.NetworkRequestEventArgs.prototype={get_webRequest:function(){return this._webRequest}},Sys.Net.NetworkRequestEventArgs.registerClass("Sys.Net.NetworkRequestEventArgs",Sys.CancelEventArgs),Sys.Net.WebRequest=function(){this._url="",this._headers={},this._body=null,this._userContext=null,this._httpVerb=null,this._executor=null,this._invokeCalled=!1,this._timeout=0},Sys.Net.WebRequest.prototype={add_completed:function(n){this._get_eventHandlerList().addHandler("completed",n)},remove_completed:function(n){this._get_eventHandlerList().removeHandler("completed",n)},completed:function(n){var t=Sys.Net.WebRequestManager._get_eventHandlerList().getHandler("completedRequest");t&&t(this._executor,n),t=this._get_eventHandlerList().getHandler("completed"),t&&t(this._executor,n)},_get_eventHandlerList:function(){return this._events||(this._events=new Sys.EventHandlerList),this._events},get_url:function(){return this._url},set_url:function(n){this._url=n},get_headers:function(){return this._headers},get_httpVerb:function(){return this._httpVerb===null?this._body===null?"GET":"POST":this._httpVerb},set_httpVerb:function(n){this._httpVerb=n},get_body:function(){return this._body},set_body:function(n){this._body=n},get_userContext:function(){return this._userContext},set_userContext:function(n){this._userContext=n},get_executor:function(){return this._executor},set_executor:function(n){this._executor=n,this._executor._set_webRequest(this)},get_timeout:function(){return this._timeout===0?Sys.Net.WebRequestManager.get_defaultTimeout():this._timeout},set_timeout:function(n){this._timeout=n},getResolvedUrl:function(){return Sys.Net.WebRequest._resolveUrl(this._url)},invoke:function(){Sys.Net.WebRequestManager.executeRequest(this),this._invokeCalled=!0}},Sys.Net.WebRequest._resolveUrl=function(n,t){var r,i,u,f,e;return n&&n.indexOf("://")!==-1?n:(t&&t.length!==0||(r=document.getElementsByTagName("base")[0],t=r&&r.href&&r.href.length>0?r.href:document.URL),i=t.indexOf("?"),i!==-1&&(t=t.substr(0,i)),i=t.indexOf("#"),i!==-1&&(t=t.substr(0,i)),t=t.substr(0,t.lastIndexOf("/")+1),!n||n.length===0)?t:n.charAt(0)==="/"?(u=t.indexOf("://"),f=t.indexOf("/",u+3),t.substr(0,f)+n):(e=t.lastIndexOf("/"),t.substr(0,e+1)+n)},Sys.Net.WebRequest._createQueryString=function(n,t,i){t=t||encodeURIComponent;var e=0,u,o,f,r=new Sys.StringBuilder;if(n)for(f in n)(u=n[f],typeof u!="function")&&(o=Sys.Serialization.JavaScriptSerializer.serialize(u),e++&&r.append("&"),r.append(f),r.append("="),r.append(t(o)));return i&&(e&&r.append("&"),r.append(i)),r.toString()},Sys.Net.WebRequest._createUrl=function(n,t,i){if(!t&&!i)return n;var r=Sys.Net.WebRequest._createQueryString(t,null,i);return r.length?n+(n&&n.indexOf("?")>=0?"&":"?")+r:n},Sys.Net.WebRequest.registerClass("Sys.Net.WebRequest"),Sys._ScriptLoaderTask=function(n,t){this._scriptElement=n,this._completedCallback=t},Sys._ScriptLoaderTask.prototype={get_scriptElement:function(){return this._scriptElement},dispose:function(){this._disposed||(this._disposed=!0,this._removeScriptElementHandlers(),Sys._ScriptLoaderTask._clearScript(this._scriptElement),this._scriptElement=null)},execute:function(){this._ensureReadyStateLoaded()&&this._executeInternal()},_executeInternal:function(){this._addScriptElementHandlers(),document.getElementsByTagName("head")[0].appendChild(this._scriptElement)},_ensureReadyStateLoaded:function(){return this._useReadyState()&&this._scriptElement.readyState!=="loaded"&&this._scriptElement.readyState!=="complete"?(this._scriptDownloadDelegate=Function.createDelegate(this,this._executeInternal),$addHandler(this._scriptElement,"readystatechange",this._scriptDownloadDelegate),!1):!0},_addScriptElementHandlers:function(){this._scriptDownloadDelegate&&($removeHandler(this._scriptElement,"readystatechange",this._scriptDownloadDelegate),this._scriptDownloadDelegate=null),this._scriptLoadDelegate=Function.createDelegate(this,this._scriptLoadHandler),this._useReadyState()?$addHandler(this._scriptElement,"readystatechange",this._scriptLoadDelegate):$addHandler(this._scriptElement,"load",this._scriptLoadDelegate),this._scriptElement.addEventListener&&(this._scriptErrorDelegate=Function.createDelegate(this,this._scriptErrorHandler),this._scriptElement.addEventListener("error",this._scriptErrorDelegate,!1))},_removeScriptElementHandlers:function(){if(this._scriptLoadDelegate){var n=this.get_scriptElement();this._scriptDownloadDelegate&&($removeHandler(this._scriptElement,"readystatechange",this._scriptDownloadDelegate),this._scriptDownloadDelegate=null),this._useReadyState()&&this._scriptLoadDelegate?$removeHandler(n,"readystatechange",this._scriptLoadDelegate):$removeHandler(n,"load",this._scriptLoadDelegate),this._scriptErrorDelegate&&(this._scriptElement.removeEventListener("error",this._scriptErrorDelegate,!1),this._scriptErrorDelegate=null),this._scriptLoadDelegate=null}},_scriptErrorHandler:function(){this._disposed||this._completedCallback(this.get_scriptElement(),!1)},_scriptLoadHandler:function(){if(!this._disposed){var n=this.get_scriptElement();this._useReadyState()&&n.readyState!=="complete"||this._completedCallback(n,!0)}},_useReadyState:function(){return Sys.Browser.agent===Sys.Browser.InternetExplorer&&(Sys.Browser.version<9||(document.documentMode||0)<9)}},Sys._ScriptLoaderTask.registerClass("Sys._ScriptLoaderTask",null,Sys.IDisposable),Sys._ScriptLoaderTask._clearScript=function(n){!Sys.Debug.isDebug&&n.parentNode&&n.parentNode.removeChild(n)},Type.registerNamespace("Sys.Net"),Sys.Net.WebServiceProxy=function(){},Sys.Net.WebServiceProxy.prototype={get_timeout:function(){return this._timeout||0},set_timeout:function(n){if(n<0)throw Error.argumentOutOfRange("value",n,Sys.Res.invalidTimeout);this._timeout=n},get_defaultUserContext:function(){return typeof this._userContext=="undefined"?null:this._userContext},set_defaultUserContext:function(n){this._userContext=n},get_defaultSucceededCallback:function(){return this._succeeded||null},set_defaultSucceededCallback:function(n){this._succeeded=n},get_defaultFailedCallback:function(){return this._failed||null},set_defaultFailedCallback:function(n){this._failed=n},get_enableJsonp:function(){return!!this._jsonp},set_enableJsonp:function(n){this._jsonp=n},get_path:function(){return this._path||null},set_path:function(n){this._path=n},get_jsonpCallbackParameter:function(){return this._callbackParameter||"callback"},set_jsonpCallbackParameter:function(n){this._callbackParameter=n},_invoke:function(n,t,i,r,u,f,e){return u=u||this.get_defaultSucceededCallback(),f=f||this.get_defaultFailedCallback(),(e===null||typeof e=="undefined")&&(e=this.get_defaultUserContext()),Sys.Net.WebServiceProxy.invoke(n,t,i,r,u,f,e,this.get_timeout(),this.get_enableJsonp(),this.get_jsonpCallbackParameter())}},Sys.Net.WebServiceProxy.registerClass("Sys.Net.WebServiceProxy"),Sys.Net.WebServiceProxy.invoke=function(n,t,i,r,u,f,e,o,s,h){function it(n){var r,i,o,c,s,h;if(n.get_responseAvailable()){r=n.get_statusCode(),i=null;try{o=n.getResponseHeader("Content-Type"),i=o.startsWith("application/json")?n.get_object():o.startsWith("text/xml")?n.get_xml():n.get_responseData()}catch(l){}c=n.getResponseHeader("jsonerror"),s=c==="true",s?i&&(i=new Sys.Net.WebServiceError(!1,i.Message,i.StackTrace,i.ExceptionType,i)):o.startsWith("application/json")&&(i=!i||typeof i.d=="undefined"?i:i.d),r<200||r>=300||s?f&&(i&&s||(i=new Sys.Net.WebServiceError(!1,String.format(Sys.Res.webServiceFailedNoMsg,t))),i._statusCode=r,f(i,e,t)):u&&u(i,e,t)}else h=n.get_timedOut()?String.format(Sys.Res.webServiceTimedOut,t):String.format(Sys.Res.webServiceFailedNoMsg,t),f&&f(new Sys.Net.WebServiceError(n.get_timedOut(),h,"",""),e,t)}var k=s!==!1?Sys.Net.WebServiceProxy._xdomain.exec(n):null,l,y=k&&k.length===3&&(k[1]!==location.protocol||k[2]!==location.host),p,c;i=y||i,y&&(h=h||"callback",l="_jsonp"+Sys._jsonp++),r||(r={}),p=r,i&&p||(p={});var d,v,a=null,w,b=null,g=Sys.Net.WebRequest._createUrl(t?n+"/"+encodeURIComponent(t):n,p,y?h+"=Sys."+l:null);if(y){d=document.createElement("script"),d.src=g,w=new Sys._ScriptLoaderTask(d,function(n,i){(!i||l)&&nt({Message:String.format(Sys.Res.webServiceFailedNoMsg,t)},-1)});function tt(){a!==null&&(a=null,v=new Sys.Net.WebServiceError(!0,String.format(Sys.Res.webServiceTimedOut,t)),w.dispose(),delete Sys[l],f&&f(v,e,t))}function nt(n,i){a!==null&&(window.clearTimeout(a),a=null),w.dispose(),delete Sys[l],l=null,typeof i!="undefined"&&i!==200?f&&(v=new Sys.Net.WebServiceError(!1,n.Message||String.format(Sys.Res.webServiceFailedNoMsg,t),n.StackTrace||null,n.ExceptionType||null,n),v._statusCode=i,f(v,e,t)):u&&u(n,e,t)}return Sys[l]=nt,o=o||Sys.Net.WebRequestManager.get_defaultTimeout(),o>0&&(a=window.setTimeout(tt,o)),w.execute(),null}return c=new Sys.Net.WebRequest,c.set_url(g),c.get_headers()["Content-Type"]="application/json; charset=utf-8",i||(b=Sys.Serialization.JavaScriptSerializer.serialize(r),b==="{}"&&(b="")),c.set_body(b),c.add_completed(it),o&&o>0&&c.set_timeout(o),c.invoke(),c},Sys.Net.WebServiceProxy._generateTypedConstructor=function(n){return function(t){if(t)for(var i in t)this[i]=t[i];this.__type=n}},Sys._jsonp=0,Sys.Net.WebServiceProxy._xdomain=/^\s*([a-zA-Z0-9\+\-\.]+\:)\/\/([^?#\/]+)/,Sys.Net.WebServiceError=function(n,t,i,r,u){this._timedOut=n,this._message=t,this._stackTrace=i,this._exceptionType=r,this._errorObject=u,this._statusCode=-1},Sys.Net.WebServiceError.prototype={get_timedOut:function(){return this._timedOut},get_statusCode:function(){return this._statusCode},get_message:function(){return this._message},get_stackTrace:function(){return this._stackTrace||""},get_exceptionType:function(){return this._exceptionType||""},get_errorObject:function(){return this._errorObject||null}},Sys.Net.WebServiceError.registerClass("Sys.Net.WebServiceError");/*! Version=16.00.1216.006 */
function DebugUtils(){}Type.registerNamespace("_o365su"),_o365su.h=function(){},_o365su.h.prototype={GET:0,POST:1,PUT:2,PATCH:3,DELETE:4},_o365su.h.registerEnum("_o365su.h",!1),_o365su.i=function(){},_o365su.i.registerInterface("_o365su.i"),_o365su.f=function(){},_o365su.f.a=function(n,t,i,r,u,f,e){_o365su.f.b(n,t,i);var o=i<=r?i+u:i-u;i<=r&&o<=r||i>r&&o>r?window.setTimeout(function(){_o365su.f.a(n,t,o,r,u,f,e)},f):(_o365su.f.b(n,t,r),e&&e())},_o365su.f.b=function(n,t,i){switch(t){case 0:n.style.left=i+"px";break;case 1:n.style.right=i+"px";break;case 2:n.style.opacity=i.toString()}},DebugUtils.a=function(n){DebugUtils.ConsLog&&window.console&&console.log&&console.log(n)},DebugUtils.ConsoleLog=function(n){for(var t,u,f,e,r=[],i=1;i<arguments.length;++i)r[i-1]=arguments[i];t=null;try{u=arguments.callee.caller.toString(),t=u.match(/\s*function\s*([^\(\s]*)/)[1],t=t?"["+t+"]":"[(anonymous)]"}catch(o){t="[(unavailable)]"}n||(n=""),f=_o365su.d.e.apply(null,[n].concat(r)),e=String.format("DEBUG{0} {1}",t,f),DebugUtils.a(e)},DebugUtils.ConsoleLogIf=function(n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];n},DebugUtils.Alert=function(n){for(var e,f,i,t,o,s,r=[],u=1;u<arguments.length;++u)r[u-1]=arguments[u];for(e=new Array(r.length),f=0;f<r.length;f++)e[f]=Sys.Serialization.JavaScriptSerializer.serialize(r[f]);i=null;try{throw Error.create();}catch(h){i=h}t=null,"stacktrace"in i?t=i.stacktrace.toString():"stack"in i&&(t=i.stack.toString()),t&&(t="\n\nStack Trace:\n"+t),o=String.format.apply(null,[n].concat(e)),s=String.format("{0}{1}",o,t),alert(s)},DebugUtils.AlertIf=function(n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];n},DebugUtils.Break=function(){},DebugUtils.BreakIf=function(n){n},_o365su.a=function(){},_o365su.a.a=function(n,t,i,r){_o365su.c.c(n,"addEventListener")?n.addEventListener(t,i,r):_o365su.c.c(n,"attachEvent")?n.attachEvent("on"+t,i):n["on"+t]=i},_o365su.a.b=function(n,t,i){_o365su.c.c(n,"removeEventListener")?n.removeEventListener(t,i,!1):_o365su.c.c(n,"detachEvent")?n.detachEvent("on"+t,i):n["on"+t]=null},_o365su.a.d=function(n){_o365su.c.c(n,"stopPropagation")?n.stopPropagation():n.cancelBubble=!0},_o365su.a.c=function(n){_o365su.c.c(n,"preventDefault")?n.preventDefault():n.returnValue=!1},_o365su.b=function(){},_o365su.b.ThrowOnNull=function(n,t){if(_o365su.c.d(n))throw Error.argumentNull(t);},_o365su.b.ThrowOnUndefined=function(n,t){if(_o365su.c.e(n))throw Error.argumentUndefined(t);},_o365su.b.ThrowOnNullOrUndefined=function(n,t){_o365su.b.ThrowOnUndefined(n,t),_o365su.b.ThrowOnNull(n,t)},_o365su.b.ThrowOnNullOrEmpty=function(n,t){if(_o365su.b.ThrowOnNullOrUndefined(n,t),!n.length)throw Error.argument(t);},_o365su.b.ThrowOnNullOrEmptyArray=function(n,t){if(_o365su.b.ThrowOnNullOrUndefined(n,t),!n.length)throw Error.argument(t);},_o365su.e=function(){},_o365su.e.b=function(n,t){return function(){n(t)}},_o365su.e.c=function(n,t){return function(i){n(i,t)}},_o365su.e.d=function(n,t,i){return function(){n(t,i)}},_o365su.e.a=function(n,t){try{n(t)}catch(i){}},_o365su.c=function(){},_o365su.c.c=function(n,t){return!1===_o365su.c.a(n[t])},_o365su.c.d=function(n){return n===null},_o365su.c.e=function(n){return typeof n=="undefined"},_o365su.c.a=function(n){return _o365su.c.d(n)||_o365su.c.e(n)},_o365su.c.b=function(n,t){var r,i,f,u;if(_o365su.c.a(n)||!n.length)return null;for(r=n.split("."),i=t,i||(i=window.self),f=r.length,u=0;u<r.length;u++)if(_o365su.c.c(i,r[u]))i=i[r[u]];else return null;return _o365su.c.a(i)?null:i},_o365su.d=function(){},_o365su.d.f=function(n,t){var r,u;if(n.length>t){if(t<4){for(r=new Sys.StringBuilder,u=0;u<t;u++)r.append(".");return r.toString()}var f=n.length-t+2,e=n.length-f,i=Math.floor(e/2),o=i*2<e?i+1:i,s=i;return n.substr(0,o)+".."+n.substr(o+f,s)}return n},_o365su.d.a=function(n){return Sys.Serialization.JavaScriptSerializer.serialize(n)},_o365su.d.b=function(n){return n?Sys.Serialization.JavaScriptSerializer.deserialize(n):n},_o365su.d.c=function(n){var t=null;return t=encodeURIComponent(n)},_o365su.d.e=function(n){for(var u,r,t=[],i=1;i<arguments.length;++i)t[i-1]=arguments[i];for(u=new Array(t.length),r=0;r<t.length;r++)u[r]=_o365su.d.a(t[r]);return String.format.apply(null,[n].concat(u))},_o365su.d.d=function(n,t){if(n){var i=n[t];if(i)return i.toString()}return null},_o365su.g=function(){},_o365su.g.a=function(n){return!!n&&(n.toLowerCase().startsWith("http://")||n.toLowerCase().startsWith("https://"))},DebugUtils.registerClass("DebugUtils"),DebugUtils.ConsLog=!1;/*! Version=16.00.1216.006 */
Type.registerNamespace("_o365cl"),_o365cl.h=function(){},_o365cl.h.registerInterface("_o365cl.h"),_o365cl.i=function(){},_o365cl.i.registerInterface("_o365cl.i"),_o365cl.j=function(){},_o365cl.j.registerInterface("_o365cl.j"),Type.registerNamespace("O365"),O365.LogArea=function(){},O365.LogArea.prototype={NotSpecified:0,Shell:1,SuiteApi:2,PendingGet:3,O365Framework:4,Notifications:5,PAdminHome:6,WebTrends:7,Domains:8,UserManagement:9,Wizard:10,AssistancePanel:11,Signup:12,SuiteServiceProxy:13,MessageCenter:14,GetStarted:15,Commerce:16,GeminiWizard:17,Profile:18,O365Settings:19,O365AdminHome:20,IWHome:21,ModernAdminPortal:22},O365.LogArea.registerEnum("O365.LogArea",!1),O365.LogLevel=function(){},O365.LogLevel.prototype={Trace:0,Info:1,Warning:4,Error:6},O365.LogLevel.registerEnum("O365.LogLevel",!1),O365.LogParameter=function(){},O365.LogParameter.prototype={Empty:0,Deferred:1},O365.LogParameter.registerEnum("O365.LogParameter",!1),_o365cl.d=function(){},_o365cl.d.prototype={shell:0,page:1},_o365cl.d.registerEnum("_o365cl.d",!1),_o365cl.e=function(){},_o365cl.e.prototype={ClientTelemetryUrl:null,ClientTelemetrySource:null,TenantToken:null,UIVersion:null},O365.Log=function(){},O365.Log.h=function(){return[!1,!1,!1,!0]},O365.Log.WriteLog=function(n,t,i,r){for(var f=[],u=4;u<arguments.length;++u)f[u-4]=arguments[u];return O365.Log.g.apply(null,[1,n,t,i,r].concat(f))},O365.Log.a=function(n,t,i,r){for(var f=[],u=4;u<arguments.length;++u)f[u-4]=arguments[u];return O365.Log.g.apply(null,[0,n,t,i,r].concat(f))},O365.Log.SetLoggerInstance=function(n){var t;if(O365.Log.b=n,n){O365.Log.f=2;for(var r=O365.Log.c,u=r.length,i=0;i<u;++i)t=r[i],O365.Log.g.apply(null,[t.m,t.i,t.h,t.g,t.e?1:0].concat(t.f))}else O365.Log.f=1;O365.Log.c.length=0},O365.Log.RegisterAdditionalLogParameter=function(n,t){O365.Log.b&&O365.Log.b.a&&O365.Log.b.a.RegisterAdditionalParameter(n,t)},O365.Log.d=function(n){var i=null,r,t;if(n)for(i={},r=[0,1,4,6],t=0;t<n.length;t++)i[O365.LogLevel.toString(r[t])]=n[t];return i},O365.Log.i=function(n,t,i,r){O365.Log.b.a.InitializeTelemetryConfiguration(n,t,i,r)},O365.Log.g=function(n,t,i,r,u){for(var f,o=[],e=5;e<arguments.length;++e)o[e-5]=arguments[e];switch(O365.Log.f){case 2:return O365.Log.b.c(t,i,r,u===1,n,o);case 0:O365.Log.c.length>1e3?(O365.Log.j(),O365.Log.SetLoggerInstance(null)):(f=new _o365cl.b(null),f.m=n,f.i=t,f.h=i,f.g=r,f.e=u===1,f.f=o,Array.add(O365.Log.c,f))}return null},O365.Log.j=function(){if(O365.Log.e){var n=new _o365cl.c;n.LogUrl=O365.Log.e,n.LogLevelSwitches=O365.Log.d(O365.Log.h()),O365.Log.b=new O365.Logger(n),O365.Log.b.c(405003,6,1,!1,0,null)}},_o365cl.c=function(){},_o365cl.c.prototype={LogSenderOverride:null,LogUrl:null,LogProcessorOverride:null,LogLevelSwitches:null,LogLevelSwitchesForPage:null,MaxAdditionalParametersLength:440,MaxMessagesPerPayload:10,MaxPayloadSize:2048,MaxSingleArgumentLength:1024},O365.Logger=function(n){var t;if(_o365su.b.ThrowOnNullOrUndefined(n,"configuration"),this.b=n,n.LogSenderOverride)t=n.LogSenderOverride;else if(n.LogUrl)t=new _o365cl.g(n.LogUrl);else return;this.a=n.LogProcessorOverride?n.LogProcessorOverride:new _o365cl.f(_o365su.c.a(n.MaxSingleArgumentLength)?1024:n.MaxSingleArgumentLength,_o365su.c.a(n.MaxMessagesPerPayload)?10:n.MaxMessagesPerPayload,_o365su.c.a(n.MaxPayloadSize)?2048:n.MaxPayloadSize,_o365su.c.a(n.MaxAdditionalParametersLength)?440:n.MaxAdditionalParametersLength),this.a.Start(t)},O365.Logger.prototype={b:null,a:null,c:function(n,t,i,r,u,f){var o=u?this.b.LogLevelSwitchesForPage:this.b.LogLevelSwitches,s=!o||o[O365.LogLevel.toString(t)],e=null;s&&(e=new _o365cl.b(null),e.g=i,e.h=t,e.i=n,e.k=+new Date,e.f=f,e.e=r,this.a.AddLogMessage(e));try{this.a.get_IsAzureTelemetryManagerInitialize()&&this.d(n,t,i,r,u,f)}catch(h){e=new _o365cl.b(null),e.g=i,e.h=6,e.i=413314,e.e=!0,this.a.AddLogMessage(e)}return e?e.e?e:null:null},d:function(n,t,i,r,u,f){var e=new _o365cl.b(null);e.g=i,e.h=t,e.i=n,e.k=+new Date,e.f=f,e.e=r,this.a.SendClientTelemetry(e)}},_o365cl.b=function(n){this.j=n},_o365cl.b.prototype={i:0,h:0,g:0,k:0,f:null,e:!1,m:0,l:!1,j:null,c:function(){return this.j},b:function(){return this.l},a:function(n){this.e&&Array.add(this.f,n)},d:function(n){return Array.contains(this.f,n)}},_o365cl.f=function(n,t,i,r){this.l=Function.createDelegate(this,this.v),this.a=new Sys.StringBuilder,this.g=new Sys.StringBuilder,this.n={},this.e=-1,this.h=[],this.r=n,this.q=t,this.j=i,this.p=r,this.c=new _o365cl.e},_o365cl.f.prototype={p:0,q:0,j:0,r:0,o:null,f:0,b:0,d:0,i:null,c:null,m:!1,get_IsAzureTelemetryManagerInitialize:function(){return this.m},Start:function(n){_o365su.b.ThrowOnNullOrUndefined(n,"logSender"),this.o=n,_o365su.a.a(window.self,"beforeunload",this.l,!1)},InitializeTelemetryConfiguration:function(n,t,i,r){this.c.ClientTelemetryUrl=n,this.c.ClientTelemetrySource=t,this.c.TenantToken=i,this.c.UIVersion=r;try{microsoft.applications.telemetry.LogManager.initialize(this.c.TenantToken),this.i=new microsoft.applications.telemetry.Logger(this.c.TenantToken),this.m=!0}catch(f){var u=new _o365cl.b(null);u.g=1,u.h=6,u.i=413353,u.e=!0,this.AddLogMessage(u)}},AddLogMessage:function(n){var t=n,i;t.e?(Array.add(this.h,t),i=this,t.j=_o365su.e.b(function(){t.e&&!t.l&&(t.e=!1,i.u(t))},t)):this.u(t)},SendClientTelemetry:function(n){var t,r,u,f,e,i;if(_o365su.b.ThrowOnNullOrUndefined(this.i,"telemetryManager"),t=n,r=new Sys.StringBuilder,r.append("["),t.f)for(u=0;u<t.f.length;u++)u>0&&r.append(","),f=t.f[u],e=this.s(f),r.append(e);r.append("]"),i=new microsoft.applications.telemetry.EventProperties,i.name=O365.LogArea.toString(t.g),i.eventType=_o365cl.d.toString(t.m),i.setProperty("LogArea",O365.LogArea.toString(t.g),!1),i.setProperty("TagId",t.i.toString(),!1),i.setProperty("LogLevel",t.h.toString(),!1),i.setProperty("ClientTimestamp",t.k.toString(),!1),i.setProperty("Arguments",r.toString(),!1),this.b>0&&i.setProperty("AdditionalParameters",this.g.toString(),!1),this.i.logEvent(i)},RegisterAdditionalParameter:function(n,t){var i,r;!n||n in this.n||(this.n[n]=!0,t&&t.length>64&&(O365.Log.a(406749,4,4,0,n,t,64),t=t.substr(0,64)),i="",i=this.b>0?String.format(',"{0}","{1}"',n,t):String.format('"{0}","{1}"',n,t),r=_o365su.d.c(i).length,r+this.b>this.p?O365.Log.a(171058,6,4,0,n,t,this.g):(this.g.append(i),this.b+=r))},u:function(n){var t,i,f,r,u;n.l=!0,t=this.w(n),i=t.length,4+i+this.t()>this.j||(this.e>-1&&(window.clearTimeout(this.e),this.e=-1),f=this.d>0?this.d+1:4,f+i+this.t()>this.j&&this.k(),this.f?(this.a.append(","),this.d++):(r="{m:[",this.a.append(r),this.d=r.length),this.a.append(t),this.d+=t.length,this.f++,this.f>=this.q?this.k():(u=this,this.e=window.setTimeout(function(){u.e=-1,u.k()},3e4)))},w:function(n){var t=new Sys.StringBuilder,i,r,u;if(t.append("{"),t.append("t:"+n.i.toString()),t.append(",l:"+n.h.toString()),t.append(",ct:"+n.k.toString()),t.append(",a:["),n.f)for(i=0;i<n.f.length;i++)i>0&&t.append(","),r=n.f[i],u=this.s(r),t.append(u);return t.append("]}"),t.toString()},s:function(n){var t="",i;return _o365su.c.d(n)?t="[null]":_o365su.c.e(n)?t="[undefined]":(i=Object.getType(n),t=i===String?n:i===Error?n.message:n.toString()),t=_o365su.d.c(_o365su.d.c(t)),t='"'+_o365su.d.f(t,this.r)+'"'},t:function(){return this.b+(this.b>0?5:0)+2+17},k:function(){this.f>0&&(this.a.append("]"),this.b>0&&(this.a.append(",a:["),this.a.append(this.g.toString()),this.a.append("]")),this.a.append("}"),this.o.Send(this.a.toString()),this.a=new Sys.StringBuilder,this.f=0,this.d=0)},v:function(){_o365su.a.b(window.self,"beforeunload",this.l);for(var t=this.h.length,n=0;n<t;n++)this.h[n].e&&this.h[n].j();this.k()}},_o365cl.g=function(n){_o365su.b.ThrowOnNullOrUndefined(n,"loggingEndpointUrl"),this.a=n},_o365cl.g.prototype={a:null,Send:function(n){var t=(+new Date).toString(),i=document.createElement("IMG");i.setAttribute("src",String.format("{0}?d={1}&cb={2}",this.a,n,t))}},_o365cl.a=function(){},_o365cl.a.a=function(n,t,i,r){for(var f=[],u=4;u<arguments.length;++u)f[u-4]=arguments[u];try{O365.Log.a.apply(null,[n,i,r,0].concat(f))}catch(e){}return Error.create(String.format("ARG:{0}",t))},_o365cl.a.b=function(n,t,i){for(var u=[],r=3;r<arguments.length;++r)u[r-3]=arguments[r];try{O365.Log.a.apply(null,[n,i,t,0].concat(u))}catch(f){}return Error.invalidOperation()},O365.Log.registerClass("O365.Log"),_o365cl.c.registerClass("_o365cl.c"),O365.Logger.registerClass("O365.Logger"),_o365cl.b.registerClass("_o365cl.b",null,_o365cl.h),O365.Log.UNTAGGED=0,O365.Log.b=null,O365.Log.f=0,O365.Log.c=new Array(0),O365.Log.e=null;var pmgControls={},pmgUtils={};pmgUtils.WindowWidth=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},pmgUtils.isIE=function(){var n=navigator.userAgent.toLowerCase(),t=n.indexOf('msie')!=-1?parseInt(n.split('msie')[1]):!1;return t||n.indexOf('trident/7.0')==-1||(t=11),t},pmgControls.CategoryHeader=function(n){try{var u=n.categoryMenuLink,f=n.headerItem,e=n.menu,o=n.categoryHeaderLogo,s=n.menuSection,h=n.allMenus,r=$(n.skipNavigation+' a'),t=$(n.skipNavigation),i=function(n,t,i,r){t.find('svg').attr('class',''),t.removeClass('pmg-selected'),i.addClass('hidden'),i.off('click'),i.off('keyup'),n.attr("aria-expanded","false"),$('body').off('click.categoryheader'),Accessibility.FocusRelease(r)};$(u).on('click',function(n){var r=$(this),o=$(f),s=$(h),c=$(this).parent(),t=c.find(e),l=t.hasClass('hidden');if(i(r,o,s,t),l){r.attr("aria-expanded","true"),c.find('svg').attr('class','flipped-upside-down'),c.addClass('pmg-selected'),t.removeClass('hidden');t.on('click',function(n){n.stopPropagation()});t.on('keyup',function(n){n.keyCode==27&&i(r,o,s,t)});$(u).on('keyup',function(n){n.keyCode==27&&i(r,o,s,t)});$('body').on('click.categoryheader',function(){i(r,o,s,t)});Accessibility.FocusTrap(t)}n.stopPropagation()});$(o).on('click',function(n){if(window.innerWidth<=768){n.preventDefault();var i=$(this),r=i.parent(),t=r.find(s),u=t.is(':hidden');u?(t.hide(),t.slideDown('normal',function(){i.find('svg').attr('class','flipped-upside-down')})):t.slideUp('normal',function(){t.attr('style',''),i.find('svg').attr('class','')})}});r.on('keyup',function(i){i.keyCode==13?($(n.firstBodyLink).focus(),t.addClass('hidden'),$(n.skipNavigationTabPlaceholder).attr('tabindex','0')):i.keyCode==27&&(t.addClass('hidden'),$(n.skipNavigationTabPlaceholder).attr('tabindex','0'))});r.on('blur',function(){t.addClass('hidden'),$(n.skipNavigationTabPlaceholder).attr('tabindex','0')});$(n.skipNavigationTabPlaceholder).on('focus',function(){t.removeClass('hidden'),r.focus(),$(n.skipNavigationTabPlaceholder).attr('tabindex','-1')});$(window).on("scroll",function(){$(window).scrollTop()>46?($(n.categoryHeaderSection).addClass("floating"),$(n.categoryHeaderSectionPlaceholder).addClass("floating")):($(n.categoryHeaderSection).removeClass("floating"),$(n.categoryHeaderSectionPlaceholder).removeClass("floating"))})}catch(c){console.log(c)}},pmgControls.FatFooter=function(n){var t=function(n){var i=$(n).parent(),r=i.find('.pmg-expand-control'),u=i.find('.pmg-collapse-control'),t=i.find('.pmg-footer-accordion-content'),f=i.find('.pmg-footer-accordion-header'),e=t.is(":hidden"),o=pmgUtils.WindowWidth();$(n).hasClass('pmg-footer-expanded')?t.slideUp({complete:function(){r.removeClass("hidden"),u.addClass("hidden"),t.addClass("hide-xs"),f.removeClass("pmg-footer-expanded"),t.removeClass("pmg-footer-expanded")}}):t.slideDown({complete:function(){r.addClass("hidden"),u.removeClass("hidden"),t.removeClass("hide-xs"),f.addClass("pmg-footer-expanded"),t.addClass("pmg-footer-expanded")}})};$(n).on("click",function(){t(this)});$(n).on("keyup",function(n){n.which==13&&t(this)})},$(function(){pmgControls.CategoryHeader({categoryHeaderSection:".pmg-category-header",categoryHeaderSectionPlaceholder:".pmg-category-header-placeholder",categoryMenuLink:".pmg-category-header .pmg-menu-link",headerItem:".pmg-header-item",menu:".pmg-menu",categoryHeaderLogo:".pmg-category-header .pmg-category-header-logo",menuSection:".pmg-header-item",allMenus:".pmg-category-header .pmg-menu",skipNavigation:".pmg-skip-navigation-flyout",firstBodyLink:".first-body-link",categoryLogoLink:".pmg-category-header .pmg-category-header-logo .pmg-category-header-logo-link",skipNavigationTabPlaceholder:"#pmg-category-header--skip-navigation-flyout-tab-placeholder"}),pmgControls.FatFooter('.pmg-footer-expand-collapse'),pmgUtils.isIE()&&$('html').addClass('ie'+pmgUtils.isIE())});var HomePage;(function(n){var i=function(){function n(){}return n}(),t;n.BannerSettings=i,t=function(){function n(){this.$banner=$("#BannerContainer"),this.$settings=$("#BannerSettings"),this.init()}return n.prototype.init=function(){var n=this;this.$banner.length&&this.$settings.length&&(this.settings=JSON.parse(this.$settings.html()),$("#bannerCloseLink").click(function(t){n.close(),t.preventDefault()}),this.initialized=!0)},n.prototype.close=function(){if(this.initialized){var n=new Date;n.setFullYear(n.getFullYear()+1),document.cookie=this.settings.dismissCookieName+"=1; path=/; secure; expires="+n.toUTCString(),this.$banner.hide()}},n}(),n.Banner=t})(HomePage||(HomePage={})),$(function(){HomePage.banner=new HomePage.Banner});var SigninSignupUtil;(function(n){function t(n,t,i,r){var u=t+"/login?es=click&IdentityProvider=MSAFed&ru="+encodeURIComponent(this.appendAuthParamToUrl(r,!0))+"&login_hint="+encodeURIComponent(i);O365.Log.WriteLog(n,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,u),window.location.href=u}function i(n,t,i,r,u,f){var o=i+"&StepsData.Email="+encodeURIComponent(t)+"&origin="+encodeURIComponent(r)+"&idp="+encodeURIComponent(u),e;f!==undefined&&(o=o+"&"+f),O365.Log.WriteLog(n,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,o),e=$('#signinSignupPostForm'),e.length==0?(e=$('<form id="signinSignupPostForm" method="POST" action="'+o+'"></form>'),$('body').append(e)):e.attr('action',o),e.submit()}function r(n,t,i,r,u,f,e){var o=u.getResponseHeader('X-CorrelationId'),s=u.getResponseHeader('X-OfficeCluster');return t>0?(O365.Log.WriteLog(n,O365.LogLevel.Error,O365.LogArea.IWHome,O365.LogParameter.Empty,r,u.statusText,o,s),e(t-1),!0):(f===""?O365.Log.WriteLog(i,O365.LogLevel.Error,O365.LogArea.IWHome,O365.LogParameter.Empty,r,u.statusText,o,s):O365.Log.WriteLog(i,O365.LogLevel.Error,O365.LogArea.IWHome,O365.LogParameter.Empty,u.statusText,o,s,f),!1)}function u(n,t){return n+=t===!0?n.indexOf('?')>0?"&auth=1&nf=1":"?auth=1&nf=1":n.indexOf('?')>0?"&auth=2&nf=1":"?auth=2&nf=1"}n.evoStsAndMsaSignIn=t,n.postbackForSignup=i,n.retryAndLogEmailHrdError=r,n.appendAuthParamToUrl=u})(SigninSignupUtil||(SigninSignupUtil={}));var IWAppSignInResource={welcomeTo:'Welcome to \x7b0\x7d',createAccount:'Create an account',signInMarketingText:'Sign in to Office Online to create, edit, and work with others online in your web browser.',signUpMarketingText:'You\x27ll use it to sign in and use Word, Excel, PowerPoint, and OneNote online. Store your files in OneDrive and share them with others.',signInText:'Sign in',SignInIfYoursText:'Sign in now if it\x27s yours',signUpText:'Sign up',signUpForFreeText:'Sign up for free',dontHaveAccountText:'Don\x27t have an account\x3f',alreadyHaveAccountText:'Already have an account\x3f',accountExistMsg:'We already have an account for \x7b0\x7d.',accountNotExistMsg:'Sorry, we don\x27t recognize \x7b0\x7d.',processingMsg:'Working on it ...'},BrandStrings={WordOnline:"Word Online",ExcelOnline:"Excel Online",PowerPointOnline:"PowerPoint Online",OneNoteOnline:"OneNote Online"},AppInfo={appName:"",appUrl:"",themeColor:""},IWAppSigInSettings,signInState=!0,defaultTextColor="#333",errorMsgColor="red",lastFocusedElement;(function(n){var o=function(t){if(window.jQuery){var i=navigator.userAgent.toLowerCase(),r=i.indexOf("msie")!=-1||i.indexOf("trident")!=-1;r&&n("input[placeholder]",t).each(function(){var t=n(this),i=n("#"+t.attr("ID")+"_placeholder");i.length==0&&(i=n('<span class="placeholder" id="'+t.attr("ID")+'_placeholder">'+t.attr("placeholder")+"</span>").appendTo(t.parent()),t.before(i)),i.attr("style",t.attr("style")),n("html").attr("dir")=="rtl"&&t.css("float").toLowerCase()=="left"||i.css("left",t.offset().left-t.parent().offset().left+"px"),i.attr("class",i.attr("class")+" "+n(this).attr("class")).click(function(){n(this).siblings("input").focus()}),t.attr("placeholder"," "),t.val()!=''&&t.siblings(".placeholder").hide()}).focus(function(){var t=n(this);t.val()==""?t.siblings(".placeholder").show():t.siblings(".placeholder").hide()}).keydown(function(){n(this).siblings(".placeholder").hide()}).keyup(function(){var t=n(this);t.val()==""?t.siblings(".placeholder").show():t.siblings(".placeholder").hide()}).blur(function(){var t=n(this);t.val()==""?t.siblings(".placeholder").show():t.siblings(".placeholder").hide()})}},f=function(){var t=IWAppSignInResource.welcomeTo.replace("{0}",AppInfo.appName);n("#appsignin-title").text(t),n("#appsignin-marketingtext").text(IWAppSignInResource.signInMarketingText),n("#signinsignup-button").text(IWAppSignInResource.signInText),n("#appsignin-switcher-msg").text(IWAppSignInResource.dontHaveAccountText),n("#appsignin-switcher-link").text(IWAppSignInResource.signUpForFreeText),n("#appsignin-switcher").show(),o(),signInState=!0},s=function(){n("#appsignin-title").text(IWAppSignInResource.createAccount),n("#appsignin-marketingtext").text(IWAppSignInResource.signUpMarketingText),n("#signinsignup-button").text(IWAppSignInResource.signUpText),n("#appsignin-switcher-msg").text(IWAppSignInResource.alreadyHaveAccountText),n("#appsignin-switcher-link").text(IWAppSignInResource.signInText),n("#appsignin-switcher").show(),signInState=!1,O365.Log.WriteLog(415928,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,AppInfo.appName)},h=function(){n("#signinsignup-button").attr("disabled",!0),n("#appsignin-switcher").hide(),n("#appsignin-erroraction").hide(),n("#appsignin-processing").text(IWAppSignInResource.processingMsg),n("#appsignin-processing").show()},c=function(t){n("#appsignin-switcher").hide(),n("#appsignin-erroraction-msg").text(IWAppSignInResource.accountExistMsg.replace("{0}",t)),n("#appsignin-erroraction-link").text(IWAppSignInResource.SignInIfYoursText),n("#appsignin-erroraction").show(),n("#appsignin-erroraction-msg").hide().show(),n("#appsignin-erroraction-link").focus()},l=function(t){n("#appsignin-switcher").hide(),n("#appsignin-erroraction-msg").text(IWAppSignInResource.accountNotExistMsg.replace("{0}",t)),n("#appsignin-erroraction-link").text(IWAppSignInResource.signUpText),n("#appsignin-erroraction").show(),n("#appsignin-erroraction-msg").hide().show(),n("#appsignin-erroraction-link").focus()},t=function(n,t,i){h(),SigninSignupUtil.postbackForSignup(n,t,IWAppSigInSettings.signupUrl,"OfficeApps",i,"appTheme="+encodeURIComponent(AppInfo.themeColor)+"&appUrl="+encodeURIComponent(AppInfo.appUrl))},a=function(t){if(t){var i=new RegExp(n('#Email').attr("data-val-regex-pattern"));return i.test(t)}return!1},u=function(t){var i=n('#appsignin-error');t?i.text(n('#Email').attr("data-val-regex")):i.text(n('#Email').attr("data-val-required")),i.show(),n("#Email").focus()},v=function(t){return a(t)?(n('#appsignin-error').hide(),n('#appsignin-erroraction').hide(),!0):(u(t),!1)},i=function(r){var f=n('#Email').val(),e;return v(f)?(e=IWAppSigInSettings.emailHrdServiceUrl+"?hm=0&emailAddress="+encodeURIComponent(f),O365.Log.WriteLog(414980,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,e),n.get(e).done(function(n,e,o){var s;if(signInState)switch(n){case'Neither':l(f);break;case'Both':case'OrgId,Placeholder':t(414979,f,n);break;case'MSAccount':SigninSignupUtil.evoStsAndMsaSignIn(414978,IWAppSigInSettings.portalRootUrl,f,AppInfo.appUrl);break;case'MSAccountNonEmail':u(f);break;default:s=SigninSignupUtil.retryAndLogEmailHrdError(417083,r,414981,n,o,"",i),s||SigninSignupUtil.evoStsAndMsaSignIn(414978,IWAppSigInSettings.portalRootUrl,f,AppInfo.appUrl)}else switch(n){case'MSAccount':c(f);break;case'Both':case'OrgId,Placeholder':case'Neither':t(414979,f,n);break;case'MSAccountNonEmail':u(f);break;default:s=retryAndLogEmailHrdError(417083,r,414982,n,o,"",i),s||t(414979,f,n)}}).fail(function(n,u){var e=SigninSignupUtil.retryAndLogEmailHrdError(417083,r,414983,"",n,u,i);e||(signInState?SigninSignupUtil.evoStsAndMsaSignIn(414978,IWAppSigInSettings.portalRootUrl,f,AppInfo.appUrl):t(414979,f,"Unknown"))}),!1):!1},y=function(n){switch(n){case"Word":return BrandStrings.WordOnline;case"Excel":return BrandStrings.ExcelOnline;case"PowerPoint":return BrandStrings.PowerPointOnline;case"OneNote":return BrandStrings.OneNoteOnline;default:return n}},e=function(i){if(AppInfo.appName=y(i.getAttribute("aria-label")),O365.Log.WriteLog(414984,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,AppInfo.appName),IWAppSigInSettings.appSignInEnabled){AppInfo.appUrl=i.href,AppInfo.themeColor=n(i).data('color')||n(i).css('background-color');var r=Identity.GetFirstAadUser();return r!=null?(O365.Log.WriteLog(416965,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,AppInfo.appName),t(414979,r.memberName,"OrgId,Placeholder"),!1):Identity.GetFirstMsaUser()!=null?(O365.Log.WriteLog(416966,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,AppInfo.appName),document.location.href=appendAuthParamToUrl(i.href,!0),!1):(lastFocusedElement=i,n("#signinsignup-button").css({'background-color':AppInfo.themeColor}),n("#appsignin-section").show(),f(),Accessibility.FocusTrap(n("#appsignin-dialog"),n("#Email")),O365.Log.WriteLog(414985,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,AppInfo.appName),!1)}return!0},r;n("#WordOnline_link,#ExcelOnline_link,#PowerPointOnline_link,#OneNoteOnline_link,#ShellDocuments_link").click(function(){return e(this)}).keydown(function(){var n=event.keyCode?event.keyCode:event.which;if(n==32||n==13)return e(this)}),r=function(){IWAppSigInSettings.appSignInEnabled&&(O365.Log.WriteLog(415023,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,AppInfo.appName),signInState=!0,n("#Email").val(""),n('#appsignin-error').hide(),n('#appsignin-erroraction').hide(),n('#appsignin-processing').hide(),n("#appsignin-switcher").show(),n("#appsignin-section").hide(),Accessibility.FocusRelease(n("#appsignin-dialog")),lastFocusedElement.focus())},n("#appsignin-overlay").click(function(){r()}),n('#appsignin-dialog').keydown(function(n){var t=n.keyCode?n.keyCode:n.which;t==27&&r()}),n("#appsignin-close").click(function(){r()}),n("#signinsignup-button").click(function(){return IWAppSigInSettings.appSignInEnabled?(signInState?O365.Log.WriteLog(417070,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,AppInfo.appName):O365.Log.WriteLog(417071,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,AppInfo.appName),i(IWAppSigInSettings.emailHrdRetryLimit),!1):!0}),n("#appsignin-switcher-link,#appsignin-erroraction-link").click(function(){return IWAppSigInSettings.appSignInEnabled?(signInState?(s(),n("#Email").focus()):(f(),n("#Email").focus()),n('#appsignin-error').hide(),n('#appsignin-erroraction').hide(),!1):!0}),n("#Email").keypress(function(t){var i=t.keyCode?t.keyCode:t.which;return i==13?(n("#signinsignup-button").click(),!1):!0})})(jQuery);var __extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},HomePage;(function(n){function a(){try{var n=JSON.parse($("#clientLoggingConfig").text()),t=new O365.Logger({LogUrl:n.LogUrl});O365.Log.SetLoggerInstance(t),O365.Log.RegisterAdditionalLogParameter("s","IWApp"),O365.Log.RegisterAdditionalLogParameter("sid",O365.CLSID)}catch(i){console.error(i);return}O365.Log.WriteLog(414427,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty)}function g(){a(),new v($("#hero-banner-section")),new l($("#app-launcher-section")),new d($("#video-banner-section")),new s($("#get-to-know-office-section")),new o($("#more-about-office-section1")),new e($("#more-about-office-section2")),new f($("#more-about-office-section3")),new c($("#download-apps-section")),new u($("#ready-to-buy-section")),new h($("#simplesignup-section"))}var i=function(){function n(){}return n.debounce=function(n,t){var f=60,i,r,u,e=function(){t?i=null:(n.apply(r,u),r=u=null,i=null)};return function(){r=this,u=arguments;var o=t&&!i;i||(i=setTimeout(e,f)),o&&(n.apply(r,u),r=u=null)}},n.isIE9OrLess=function(){var n=navigator.userAgent.match(/MSIE (\d+)/i);return n&&n.length===2&&parseInt(n[1])<=9},n}(),k=function(){function n(n,t){this.$imageSet=n,this.name=t,this.images=[]}return n.prototype.update=function(){var n=!1;this.images.forEach(function(t){t.update(n)&&(n=!0)})},n}(),b=function(){function n(n,t,i){this.$image=n,this.src=t,this.mediaQuery=i,this.parsedMediaQuery=[],i&&(this.parsedMediaQuery=i.match(/(max-width|min-width): (\d+)px/i))}return n.parse=function(t){var i=t.data("src"),r=t.data("media-query");return new n(t,i,r)},n.prototype.update=function(n){return!n&&this.isEligible()?(this.activate(),!0):(this.deactivate(),!1)},n.prototype.isEligible=function(){return!this.mediaQuery||this.safeMatchMedia()},n.prototype.safeMatchMedia=function(){var n,t,i;return window.matchMedia?window.matchMedia(this.mediaQuery).matches:(n=$(window).width(),this.parsedMediaQuery.length===3&&(t=this.parsedMediaQuery[1],i=parseInt(this.parsedMediaQuery[2]),t==="max-width"))?n<=i:!1},n.prototype.activate=function(){this.active||(this.$image.attr("src")?this.$image.trigger("load"):this.$image.attr("src",this.src),this.$image.removeClass(n.deactivatedClass),this.active=!0)},n.prototype.deactivate=function(){this.$image.addClass(n.deactivatedClass),this.active=!1},n.deactivatedClass="background-deactivated",n}(),t=function(){function n(n){var t=this;if(this.$el=n,n.length){var f=$.Deferred(),u=function(){t.isItemPartiallyVisible(t.$el)&&f.resolve()},r=i.debounce(function(){u()},!0);$(window).on("load",u);$(window).on("resize",r);$(window).on("scroll",r);f.then(function(){return t.loadImages().then(function(){return t.playAnimations().then(function(){$(window).off("load",u),$(window).off("resize",r),$(window).off("scroll",r),t.swapImagesOnBreakpoints(),t.updateParallaxOnScroll(),t.initialized()})})})}}return n.prototype.isItemPartiallyVisible=function(n){var i=0,r=window.innerHeight,u=0,f=window.innerWidth,t=n[0].getBoundingClientRect();return t.top<=r&&t.bottom>=i&&t.left<=f&&t.right>=u},n.prototype.loadImages=function(){var n=this,t=[],i;return this.imageSets=[],i=$("img[data-imgset]",this.$el),i.each(function(i,r){var s=$(r),u=s.data("imgset"),f,e,o;if(!(u in n.imageSets)){f=$("img[data-imgset=\""+u+"\"]"),e=new k(f,u),n.imageSets.push(e),n.imageSets[u]=e,o=$.Deferred();f.one("load",function(){o.resolve()});t.push(o)}n.imageSets[u].images.push(b.parse(s))}),this.imageSets.forEach(function(n){n.update()}),$.when.apply(this,t)},n.prototype.swapImagesOnBreakpoints=function(){var n=this,t=i.debounce(function(){n.imageSets.forEach(function(n){n.update()})},!0);$(window).on("resize",t)},n.prototype.playAnimations=function(){var t=$("."+n.animateBeforeClass,this.$el);return t.addClass(n.animateAfterClass).removeClass(n.animateBeforeClass),$.Deferred().resolve()},n.prototype.updateParallaxOnScroll=function(){this.getParallaxStrategy().activate()},n.prototype.getParallaxStrategy=function(){return new p(this.$el,n.parallaxItemClass,n.parallaxDisabledStateClass,n.parallaxDelayInPixels)},n.prototype.initialized=function(){},n.parallaxItemClass="parallax-item",n.parallaxDisabledStateClass="parallax-disabled",n.parallaxDelayInPixels=46,n.animateBeforeClass="animate-before",n.animateAfterClass="animate-after",n.imageStretchWidthClass="background-stretch-width",n.imageStretchHeightClass="background-stretch-height",n}(),r=function(){function n(n,t,i,r){this.parallaxFallbackStateClass=i,this.delayOffsetY=r,this.$container=n,this.$items=n.find("."+t),this.applyPolyfills()}return n.prototype.applyPolyfills=function(){if(!window.requestAnimationFrame){var n=0;window.requestAnimationFrame=function(t){var i=+new Date,r=Math.max(0,16-(i-n)),u=i+r,f=window.setTimeout(function(){t(u)},r);return n=u,f}}},n.prototype.activate=function(){this.canActivate()&&(this.shouldFallback()?this.activateFallback():this.activateEffect())},n.prototype.canActivate=function(){return this.$items.length>0},n.prototype.shouldFallback=function(){return i.isIE9OrLess()},n.prototype.activateEffect=function(){},n.prototype.activateFallback=function(){var n=this;this.$items.each(function(t,i){$(i).addClass(n.parallaxFallbackStateClass)})},n}(),w=function(){function n(){}return n}(),p=function(n){function t(t,i,r,u){n.call(this,t,i,r,u),this.items={}}return __extends(t,n),t.prototype.activateEffect=function(){var n=this,i=function(){var t=$(window).height(),i=n.$container.outerHeight(!1),r=n.$container.offset().top;n.$items.each(function(u,f){var o=$(f).outerHeight(!1),s=t,h=o-i,c=h/s,l=t+$(window).scrollTop(),a=r,v=Math.max(0,l-a-n.delayOffsetY),y=Math.round(c*v),e=new w;e.offsetY=y,n.items[f.id]=e})},r=function(){n.$items.each(function(t,i){var r=n.items[i.id];r.offsetY>0&&$(i).attr("style","top: "+r.offsetY+"px")})},t=function(){i(),requestAnimationFrame(r)};$(window).on("resize",t);$(window).on("scroll",t);t()},t}(r),y=function(n){function t(t,i,r,u){n.call(this,t,i,r,u)}return __extends(t,n),t.prototype.activateEffect=function(){var n=this,t=function(){var t=.2,i=$(window).scrollTop(),r=n.$container.offset().top,u=Math.max(0,i-r+n.delayOffsetY),f=Math.round(t*u);n.$items.each(function(n,t){$(t).attr("style","top: "+f+"px;")})};$(window).on("scroll",function(){requestAnimationFrame(t)});requestAnimationFrame(t)},t.prototype.activateFallback=function(){},t}(r),v=function(n){function r(t){n.call(this,t)}return __extends(r,n),r.prototype.initialized=function(){this.fitImageOnResize()},r.prototype.getParallaxStrategy=function(){return new y(this.$el,t.parallaxItemClass,t.parallaxDisabledStateClass,t.parallaxDelayInPixels)},r.prototype.fitImageOnResize=function(){var n=this,u=this.$el.find("img.background"),r=i.debounce(function(){u.each(function(i,r){var u=$(r).outerHeight(!1),f=$(r).outerWidth(!1),e=n.$el.outerHeight(!1),o=n.$el.outerWidth(!1);u<e?$(r).addClass(t.imageStretchHeightClass).removeClass(t.imageStretchWidthClass):f<o&&$(r).addClass(t.imageStretchWidthClass).removeClass(t.imageStretchHeightClass)})},!0);$(window).on("resize",r);r()},r}(t),l=function(n){function t(t){n.call(this,t),this.initExpanderButtons()}return __extends(t,n),t.prototype.initExpanderButtons=function(){var i=this.$el.find(".expand-apps"),t=this.$el.find(".expand-apps-mobile"),n=this.$el.find(".apps-list");this.$el.on("click",".expand-apps-trigger",function(r){r.preventDefault(),r.stopPropagation(),i.toggleClass("expanded"),t.toggleClass("expanded"),n.toggleClass("expanded"),n.attr("aria-expanded",n.hasClass("expanded")?"true":"false")})},t}(t),d=function(n){function t(t){n.call(this,t),this.$cover=t.find(".cover"),this.$player=t.find(".player"),this.initInteractivity()}return __extends(t,n),t.prototype.initInteractivity=function(){var n=this,f=this.$cover.find(".play-button"),i=this.$player.find(".close-button"),r=this.$player.find(".iframe-positioner"),u=this.$player;f.click(function(){var f='<iframe width="560" height="315" src="https://www.youtube.com/embed/'+t.videoId+'?rel=0&autoplay=1&rel=0" frameborder="0" allowfullscreen></iframe>';return n.$player.fadeTo(350,1),n.$cover.fadeTo(350,0,function(){$(this).hide(),r.html(f),Accessibility.FocusTrap(u)}),!1}),i.click(function(){return n.$cover.fadeTo(350,1),n.$player.fadeTo(350,0,function(){$(this).hide(),r.html(""),Accessibility.FocusRelease(u)}),!1});this.$player.on("keydown",function(n){return n.keyCode===27?(i.click(),!1):!0})},t.videoId="tkTwUL-CMPs",t}(t),c=function(n){function t(t){n.call(this,t),this.wireLinkToChooser("#download-apps-platform-link-ios","#download-apps-device-chooser-ios"),this.wireLinkToChooser("#download-apps-platform-link-android","#download-apps-device-chooser-android"),this.wireLinkToChooser("#download-apps-platform-link-windows","#download-apps-device-chooser-windows")}return __extends(t,n),t.prototype.wireLinkToChooser=function(n,t){var r=this,u=$("#download-apps-platform-chooser"),f=$(n),i=$(t),o=i.find(".back-button"),s=i.find(".device-links"),h=function(){return r.isTweenedForward(i)||(r.$lastDeviceLink=f,r.tweenForward(u),r.tweenForward(i),Accessibility.FocusTrap(i,s)),!0},e=function(){return r.isTweenedBack(i)||(r.tweenBack(i),r.tweenBack(u),Accessibility.FocusRelease(i)),!0};f.click(h),o.click(e);i.on(Accessibility.FocusReleaseEvent,e)},t.prototype.tweenForward=function(n){n.removeClass("before-tween").addClass("after-tween")},t.prototype.tweenBack=function(n){n.removeClass("after-tween").addClass("before-tween")},t.prototype.isTweenedForward=function(n){return n.hasClass("after-tween")},t.prototype.isTweenedBack=function(n){return n.hasClass("before-tween")},t}(t),h=function(){function n(n){n.length&&(this.simpleSignupResource={accountExistMsg:'Looks like you already have an account.',processingMsg:'Working on it ...',signinText:'Sign in',alreadyHaveAccountText:'Already have an account\x3f'},this.setup())}return n.prototype.directSignin=function(){O365.Log.WriteLog(417151,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,simpleSignupSettings.directSigninUrl),window.location.href=simpleSignupSettings.directSigninUrl},n.prototype.simplesignup_validateEmailAddress=function(n){if(n){var t=new RegExp($('#signup-email-input-textbox').attr("data-val-regex-pattern"));return t.test(n)}return!1},n.prototype.simplesignup_showEmailError=function(){this.resetSignupStatus();var t=$("#simplesignup-message");t.text($('#signup-email-input-textbox').attr("data-val-regex")),t.attr('class','validationmessage'),t.attr('tabindex','0'),t.show(),$("#signup-email-input-textbox").focus()},n.prototype.simplesignup_validateEmailAndSHowError=function(n){return this.simplesignup_validateEmailAddress(n)?!0:(this.simplesignup_showEmailError(n),!1)},n.prototype.trytosignup=function(n){var i=this,t=$('#signup-email-input-textbox').val(),r="Office",u;if(this.simplesignup_validateEmailAndSHowError(t)){this.simplesignup_showProcessing(),u=simpleSignupSettings.emailHrdServiceUrl+"?hm=0&emailAddress="+encodeURIComponent(t),O365.Log.WriteLog(417365,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty,u),$.get(u).done(function(u,f,e){switch(u){case'MSAccount':i.simpleSignupShowAccountAlreadyExistsMessage(t,u);break;case'Both':case'OrgId,Placeholder':case'Neither':SigninSignupUtil.postbackForSignup(417374,t,simpleSignupSettings.signupUrl,r,u);break;case'MSAccountNonEmail':i.simplesignup_showEmailError(t);break;default:var o=SigninSignupUtil.retryAndLogEmailHrdError(417375,n,417377,u,e,"",i.trytosignup);o||SigninSignupUtil.postbackForSignup(417374,t,simpleSignupSettings.signupUrl,r,u)}}).fail(function(u,f){var e=SigninSignupUtil.retryAndLogEmailHrdError(417375,n,417378,"",u,f,i.trytosignup);e||SigninSignupUtil.postbackForSignup(417374,t,simpleSignupSettings.signupUrl,r,"unknown")});return}},n.prototype.resetSignupStatus=function(){$("#simplesignup-button").removeAttr('disabled'),$("#simplesignup-button").removeAttr('aria-disabled'),$("#simplesignup-message").removeAttr('tabindex'),$("#simplesignup-message").text(''),$("#simplesignup-already-have-account").hide(),$("#simplesignin-section").css('visibility','visible')},n.prototype.simplesignup_showProcessing=function(){this.resetSignupStatus(),$("#simplesignup-message").attr('class','promptmessage'),$("#simplesignup-message").text(this.simpleSignupResource.processingMsg),$("#simplesignup-already-have-account").hide()},n.prototype.simpleSignupShowAccountAlreadyExistsMessage=function(){$("#simplesignup-message").hide(),$("#simplesignup-button").attr("disabled",'disabled'),$("#simplesignup-button").attr("aria-disabled",'true'),$("#simplesignin-section").css('visibility','hidden'),$("#simplesignup-already-have-account").show(),$("#already-have-account-signin-link").focus()},n.prototype.setup=function(){var n=this;$("#simplesignup-button").on("click",function(){return n.trytosignup(simpleSignupSettings.emailHrdRetryLimit),!1});$("#signup-email-input-textbox").on("keyup",function(t){var i=t.keyCode?t.keyCode:t.which;i==13?($("#simplesignup-button").focus(),$("#simplesignup-button").click()):n.resetSignupStatus()});$("#signup-email-input-textbox").on("mousedown",function(){n.resetSignupStatus()});$("#signup-email-input-textbox").on("change paste",function(){n.resetSignupStatus()});$("#simplesignin-link").click(function(){n.directSignin()}),$("#signup-email-input-textbox-placeholder").click(function(){$(this).siblings("input").focus()}),$("#signup-email-input-textbox").focus(function(){var n=$(this);n.val()===""?n.siblings(".placeholder").show():n.siblings(".placeholder").hide()}).keydown(function(){$(this).siblings(".placeholder").hide()}).keyup(function(){var n=$(this);n.val()===""?n.siblings(".placeholder").show():n.siblings(".placeholder").hide()}).blur(function(){var n=$(this);n.val()===""?n.siblings(".placeholder").show():n.siblings(".placeholder").hide()}),$("#already-have-account-signin-link").click(function(){SigninSignupUtil.evoStsAndMsaSignIn(417379,simpleSignupSettings.portalRootUrl,$('#signup-email-input-textbox').val(),simpleSignupSettings.retUrl)}),$("#signup-email-input-textbox").val()!==""&&$("#signup-email-input-textbox-placeholder").hide()},n}(),s=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(t),o=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(t),e=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(t),f=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(t),u=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(t);n.init=g})(HomePage||(HomePage={}));var Identity;(function(n){function u(){var i=JSON.parse(sessionStorage.getItem(n.IdentitySettings.authenticatedUsersSessionStorageKey)),r;for(r in i)if(i[r].idp===t.IDP_TYPE_MSA||i[r].idp===t.IDP_TYPE_MSAFED)return i[r];return null}function f(){var i=JSON.parse(sessionStorage.getItem(n.IdentitySettings.authenticatedUsersSessionStorageKey)),r;for(r in i)if(i[r].idp===t.IDP_TYPE_AAD)return i[r];return null}function e(){return JSON.parse(sessionStorage.getItem(n.IdentitySettings.authenticatedUsersSessionStorageKey))}var i,t,r;n.GetFirstMsaUser=u,n.GetFirstAadUser=f,n.GetAllAuthenticatedUsers=e,i=function(){function t(){}return t.Initialize=function(t){n.IdentitySettings=JSON.parse($(t).html())},t}(),n.IdentitySettings=i,t=function(){function n(){}return n.IDP_TYPE_MSA="msa",n.IDP_TYPE_MSAFED="msaFed",n.IDP_TYPE_AAD="aad",n.AUTHENTICATED_STATE_NONE="0",n.AUTHENTICATED_STATE_SIGNED_INTO_APPLICATION="1",n.AUTHENTICATED_STATE_SIGNED_INTO_IDP="2",n}(),n.IdentityConstants=t,r=function(){function i(){var i=this;this.numResponsesReceived=0,this.userList=[],this.WriteSavedUsersResults=function(){return i.writeSavedUsersResults()},this.HandleAadResponse=function(n){return i.handleAadResponse(n)},this.CreateSavedUsersIframe=function(){return i.createSavedUsersIframe()},this.writeSavedUsersResults=function(){for(var r={},u={},h=[],o=[],i,c,e,l,s,f=0;f<this.userList.length;f++)i=this.userList[f],i.idp===t.IDP_TYPE_MSA||i.authenticatedState===t.AUTHENTICATED_STATE_SIGNED_INTO_APPLICATION||i.authenticatedState===t.AUTHENTICATED_STATE_SIGNED_INTO_IDP?r[i.memberName]==null?r[i.memberName]=i:i.idp===t.IDP_TYPE_MSAFED&&(r[i.memberName]=i):u[i.memberName]==null?u[i.memberName]=i:i.idp===t.IDP_TYPE_MSAFED&&(u[i.memberName]=i);for(e in r)c=r[e],o.push(this.TrimUserInfo(c));for(e in u)l=u[e],h.push(this.TrimUserInfo(l));O365.Log.WriteLog(416582,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty),$(document).trigger(n.IdentitySettings.receiveAuthenticatedUsersEventName,[o]),sessionStorage.setItem(n.IdentitySettings.unauthenticatedUsersSessionStorageKey,JSON.stringify(h)),sessionStorage.setItem(n.IdentitySettings.authenticatedUsersSessionStorageKey,JSON.stringify(o)),s=$("#"+n.IdentitySettings.savedUsersIframeId),s.length&&(s.remove(),$(window).unbind('message',this.HandleAadResponse))},this.handleAadResponse=function(t){var r=t.originalEvent,f,u,i;if(r.origin&&n.IdentitySettings.savedUsersEndpointUrl.lastIndexOf(r.origin,0)===0){try{for(f=JSON.parse(r.data),u=f.userList,i=0;i<u.length;i++)this.userList.push(u[i]);this.numResponsesReceived=this.numResponsesReceived+1}catch(e){O365.Log.WriteLog(417478,O365.LogLevel.Error,O365.LogArea.IWHome,O365.LogParameter.Empty)}this.numResponsesReceived>=2&&this.WriteSavedUsersResults()}},this.createSavedUsersIframe=function(){var i=this,t=document.createElement('iframe');t.frameBorder="0",t.id=n.IdentitySettings.savedUsersIframeId,t.src=decodeURI(n.IdentitySettings.savedUsersEndpointUrl.replace(/&amp;/g,"&")),t.setAttribute("style","visibility:hidden; display:none"),document.body.appendChild(t);$(window).on("message",this.HandleAadResponse);O365.Log.WriteLog(416589,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty),window.setTimeout(function(){i.numResponsesReceived<2&&(O365.Log.WriteLog(416581,O365.LogLevel.Info,O365.LogArea.IWHome,O365.LogParameter.Empty),i.WriteSavedUsersResults())},1e4)}}return i.prototype.TrimUserInfo=function(n){var t={};return t.authenticatedState=n.authenticatedState,t.idp=n.idp,t.memberName=n.memberName,t.firstName=n.firstName,t.lastName=n.lastName,t},i}(),n.IdentityInformation=r})(Identity||(Identity={})),$(document).ready(function(){var n="#identitySettings",t;$(n).length&&(Identity.IdentitySettings.Initialize(n),t=new Identity.IdentityInformation,t.CreateSavedUsersIframe())});var Accessibility;(function(n){function u(n,i){i===void 0&&(i=null);var u=n[0].id;u in t||(t[u]=new r(n,i)),t[u].engage()}function f(n){var i=n[0].id;i in t&&t.hasOwnProperty(i)&&t[i].release()}var i,t,r;(function(n){n[n.Escape=27]="Escape",n[n.Tab=9]="Tab"})(i||(i={})),t={},n.FocusTrapEvent="accessibility.focus.trap",n.FocusReleaseEvent="accessibility.focus.release",n.FocusTrap=u,n.FocusRelease=f,r=function(){function t(n,t){this.$context=n,this.$initialFocus=t;var i=this.getFocusableElements();this.firstElement=i[0],this.lastElement=i[i.length-1]}return t.prototype.engage=function(){var i=this,t;if(!this.engaged){this.outsideSavedElement=document.activeElement;this.$context.on("keydown.accessbility.focustrap",function(n){return i.handleKeydown(n)});this.engaged=!0,this.$context.trigger(n.FocusTrapEvent),t=this.getInitialFocusElement(),t&&setTimeout(function(){$(t).get(0).focus()},500)}},t.prototype.release=function(){var t=this;this.engaged&&(this.insideSavedElement=document.activeElement,this.$context.off("keydown.accessibility.focustrap"),this.engaged=!1,this.$context.trigger(n.FocusReleaseEvent),this.outsideSavedElement&&setTimeout(function(){$(t.outsideSavedElement).get(0).focus()},500))},t.prototype.getInitialFocusElement=function(){return this.$initialFocus?this.$initialFocus[0]:this.insideSavedElement?this.insideSavedElement:this.firstElement},t.prototype.getFocusableElements=function(){var n="a[href],input,select,button,textarea,[tabindex]";return this.$context.find(n).addBack(n).not('[tabindex="-1"]').not('[disabled]').not('[type="hidden"]')},t.prototype.handleKeydown=function(n){return n.keyCode===i.Escape?(this.release(),!1):this.cycleFocus(n)},t.prototype.cycleFocus=function(n){if(n.keyCode===i.Tab){if(n.shiftKey){if(n.target===this.firstElement)return $(this.lastElement).focus(),!1}else if(n.target===this.lastElement)return $(this.firstElement).focus(),!1;return!0}return!0},t}()})(Accessibility||(Accessibility={}));