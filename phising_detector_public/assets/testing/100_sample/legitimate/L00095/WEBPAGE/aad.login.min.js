function pageOnReady(){try{$(".no_display").attr("aria-hidden","true"),$(".hidden").attr("aria-hidden","true")}catch(e){}if($(".login_inner_container.no_display").removeClass("no_display"),$("#background_background_image").css("width","auto"),$("#background_background_image").css("height","auto"),User.RegisterOnLoadImage(),$.browser.msie&&"8"==$.browser.version.slice(0,1)?document.body.onresize=function(){User.resize_bg()}:$(window).resize(function(){User.resize_bg()}),void 0!=$("#cred_userid_inputtext").val()&&User.setupCredFieldsWithPlaceHolder(),Context.whr=decodeURIComponent(Util.ExtractQSParam("whr")),User.updateGuestLink(),$("#redirect_cancel_link").attr("href","javascript:Context.back_action_stack.TriggerCancelAction();"),$("#login_panel").show(),$("#login_no_script_panel").hide(),$(".login_cred_container").append($("<input/>").attr("id","home_realm_discovery").attr("type","hidden").val(Context.username_state.home_realm_state)),Constants.IS_HOLOGRAPHIC)$("div.progress").css("visibility","hidden");else{var t=$("#cred_sign_in_button"),n=$("#cred_cancel_button");t.click(function(){Post.SubmitCreds()}),t.keydown(function(e){User.KeyPressEnter(e,Post.SubmitCreds,13)}),$(".refresh_domain_state").click(function(){User.RefreshDomainState()}),$("input[type=checkbox]").click(function(){User.RefreshDomainState()}),n.click(function(){if(Constants.IS_CXH_REQUEST||Constants.IS_ADAL_REQUEST&&!Constants.ADAL_UX_OVERRIDE)if(Constants.CANCEL_REDIRECT_URL)User.Redirect(Constants.CANCEL_REDIRECT_URL);else{var e=0;Context.back_action_stack.DoesCancelActionExist()&&(e=Context.back_action_stack.BackActionStack.pop(),Context.back_action_stack.AddAction(e)),e===Constants.CancelAction.FROM_DISAMBIGUATION_SCREEN_TO_LOGIN?Context.back_action_stack.TriggerCancelAction():event.preventDefault()}else Context.back_action_stack.TriggerCancelAction()}),n.keydown(function(e){User.KeyPressEnter(e,function(){n.click(),e.preventDefault()},13)})}$("#background_company_name_text").text(Constants.PARTNER_NAME),Constants.FEDERATION_QUERY_PARAMETERS=Constants.FEDERATION_QUERY_PARAMETERS.replace(/&username(=[^&]*)?|^username(=[^&]*)?&?/,""),Support.renderBrowserSpecific(),Support.UpdatePasswordResetLink(),Instrument.document_ready_end_time=Util.now()}!function(){var e=window,t=e.$Debug=e.$Debug||{};t.options={tracePagePath:!1},t.fail=function(t){var n=new Error(t+" "),o=e.$WebWatson;throw o&&o.submitFromException(n,void 0,33),n},t.assert=function(e,n){e||(n="Assert failed: "+n,$Config.uxDebug&&confirm(n+"\r\n\r\nBreak into debugger?")&&t.fail(n))},t.failIf=function(e,n){e||t.fail(n)},t.trace=function(n,o){if(n||(n=""),e.console&&e.console.log){if(t.options.tracePagePath){var i=e.location.pathname;o=o?i+": "+o:i}o&&(n=o+": "+n),e.console.log(n)}}}(),function(){var e=window,t=e.$Debug,n=e.Array.prototype;n.addRange||(n.addRange=function(e){return e&&this.push.apply(this,e),this}),n.exists||(n.exists=function(e){return this.indexOf(e)>=0}),n.contains||(n.contains=n.exists),n.clone||(n.clone=function(){return[].addRange(this)}),n.indexOf||(n.indexOf=function(e,t){var n=this.length;for((t=t||0)<0&&(t=Math.max(0,n+t));n>t;)if(this[t++]===e)return t-1;return-1}),n.forEach||(n.forEach=function(e,n){t&&t.assert(e,"fnCb must be provided");for(var o=this.length,i=0;o>i;i++)e.call(n,this[i],i,this);t&&t.assert(o==this.length,"Do not modify array during forEach")}),n.insert||(n.insert=function(e,t){this.splice(e,0,t)}),n.remove||(n.remove=function(e){var t=this.indexOf(e);return t>=0&&this.splice(t,1),t>=0})}(),function(){function e(e,t,o){var i=o.s===t;if(!i){t=t||0;var a,r,s=e.charCodeAt(t);o.s=-1,55296>s||s>57343?o.c=s:56319>=s?(a=s,r=e.charCodeAt(t+1),n&&n.assert(!isNaN(r),"High surrogate not followed by low surrogate in fixedCharCodeAt()"),o.c=1024*(a-55296)+(r-56320)+65536,o.s=t+1):(o.c=-1,i=!0)}return!i}var t=window,n=t.$Debug,o=t.String.prototype;o.endsWith=function(e){return n&&n.assert(e,"must provide suffix"),this.substr(this.length-e.length)==e},o.startsWith=function(e){return n&&n.assert(e,"must provide prefix"),this.substr(0,e.length)==e},o.lTrim=function(){return this.replace(/^\s*/,"")},o.rTrim=function(){return this.replace(/\s*$/,"")},o.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var i=/\{\d+\}/g,a=/[\{\}]/g;o.format=function(){function e(e){var o=t[e.replace(a,"")];return n&&n.assert("undefined"!=typeof o,"String Format- Provide argument at index "+e.replace(a,"")),null==o&&(o=""),o}var t=arguments;return this.replace(i,e)};var r=/[^\w.,-]/g;o.encodeXmlAttribute=o.encodeHtmlAttribute=function(){return this.replace(r,function(e){return["&#",e.charCodeAt(0),";"].join("")})};var s=/[^\w .,-]/g;o.encodeXml=o.encodeHtml=function(){var t={c:0,s:-1};return this.replace(s,function(n,o,i){return e(i,o,t)?["&#",t.c,";"].join(""):""})};var _=/[^\w.%-]/g;o.encodeURIComponent=o.encodeUrl=function(){return encodeURIComponent(this).replace(_,function(e){var t=e.charCodeAt(0).toString(16);return"%"+(1==t.length?"0"+t:t).toUpperCase()})};var d=/[^\w .,-]/g;o.encodeJson=function(){return this.replace(d,function(e){var t=e.charCodeAt(0).toString(16),n=new Array(4-t.length+1).join("0");return"\\u"+n+t.toUpperCase()})},o.decodeURIComponent=o.decodeUrl=function(){return decodeURIComponent(this)};var c=/([\\\.\{\}\(\)\[\]\/\+\*\?\|\^\$])/gi;o.escapeRegex=function(e){return(0==arguments.length?this:e).replace(c,"\\$1")},o.areEqualIgnoreCase=function(e){var t=this;return t.toLowerCase()===e.toLowerCase()?!0:!1},o.qs=function(e,t){var n=new RegExp("([?&])"+e+"=([^&#]*)","i");if(t)return this.match(n)?this.replace(n,"$1"+e+"="+t):this.indexOf("?")>0?this+"&"+e+"="+t:this+"?"+e+"="+t;var o=n.exec(this);return null==o?"":o[2]},o.upsertQueryStringParam=function(e,t){return void 0===t?this:this.qs(e,t)},o.removeQueryStringParam=function(e,t){var n=new RegExp("([?&])"+t+"=.*?(&|$)","i");return this.match(n)?this.replace(n,"$1"):this},o.getQueryStringParam=function(e){if(!e)return"";var t=new RegExp("([?&])"+e+"=([^&#]*)","i"),n=this.match(t);return n?n[2]:""},o.htmlEncode=function(){return $("<span/>").text(this).html()}}(),function(){var _object=window.Object;"Object"!=_object.__typeName&&(_object.isString=function(e){return"string"==typeof e||e&&e.constructor===String},_object.isArray=function(e){return e instanceof Array},_object.isFunction=function(e){return"function"==typeof e},_object.isObject=function(e){return e&&"object"==typeof e},_object.isBoolean=function(e){return"boolean"==typeof e||e&&e.constructor===Boolean},_object.isNumber=function(e){return"number"==typeof e||e&&e.constructor===Number},_object.resolve=function(e){try{"string"==typeof e?e=Function.parse(e):"object"==typeof e?e=e.constructor:"function"!=typeof e&&(e=null)}catch(t){return null}return e},_object.compare=function(e,t){var n=this.resolve(e);return n&&n==this.resolve(t)},_object.getType=function(e){var t=e.constructor;return t&&"function"==typeof t&&t.__typeName&&"Object"!=t.__typeName?t:_object},_object.isNull=function(e){return null==e||void 0==e},_object.getTypeName=function(e){return _object.getType(e).__typeName},_object.fromJSON||(_object.fromJSON=function $Object$fromJSON(text){try{if("undefined"!=typeof JSON&&JSON.parse)return JSON.parse(text);if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return eval("("+text+")")}catch(e){}return null}),_object.toJSON||(_object.toJSON=function(e){if(""===e)return'""';if("undefined"!=typeof JSON&&JSON.stringify)return JSON.stringify(e);var t=_object.toJSON,n="null";if(!_object.isNull(e))if(_object.isArray(e)){n=[];for(var o=0;o<e.length;o++)n.push(t(e[o]));n="["+n.join(",")+"]"}else if(_object.isObject(e)){n=[];for(var i in e)n.push('"'+i.encodeJson()+'":'+t(e[i]));n="{"+n.join(",")+"}"}else _object.isString(e)?n='"'+e.encodeJson()+'"':_object.isFunction(e)||(n=e.toString());return n}),_object.__typeName="Object")}();var MSLogin={};MSLogin.ErrorCodes={IDP_ERROR:2147776681,IDP_ERROR2:2147776682,NAMESPACE_ERROR:2147778860,PARSE_ERROR:2147762276};var ErrorCodes=MSLogin.ErrorCodes;MSLogin.Constants={REDIRECT_COUNTDOWN_DEFAULT:3,FEDERATION_QUERY_PARAMETERS:"",CDN_IMAGE_PATH:"images/",LATENCY_THRESHOLD:2e3,HIP_DATA_URL:"",PREFETCH_URL:"",LATENCY_SENSITIVITY_DEFAULT:1,OTHER_ACCOUNT_TEXT:"",MAX_TILE_TEXT_LENGTH:25,PREFILL_MEMBER_NAME:"",MEMBER_NAME:"",DEFAULT_FOOTER_LINKS:{},DEFAULT_ENABLED_FOOTER_LINKS:["legal","privacy","feedback"],FOOTER_LINKS:{},REDIRECT_MESSAGES:{},HAS_SUBMITTED:!1,METRICS_MODE:1,SUBMIT_METRICS_ON_REDIRECT:!1,SUBMIT_METRICS_ON_POST:!1,MOBILE_WIDTH_THRESHOLD:600,MOBILE_HEIGHT_THRESHOLD:600,PARTNER_NAME:"",MSA_LABEL:"",FEATURE_SLOT_MASK:0,FEATURE_SLOT_THRESHOLD:2147483647,SAVED_USER_COOKIE:"MSSavedUser",PREFILL_USER_COOKIE:"MSPPre",SAVED_USER_COOKIE_INFO_DELIMITER:"$",SAVED_USER_COOKIE_USER_DELIMITER:"|",ANCHORED_FOOTER_LINKS:!1,MAX_USER_TILES:1,DIR:"ltr",TWOFA_POLLING_INTERVAL:null,TWOFA_MAX_POLLS:null,TWOFA_MARKET:null,TWOFA_MAXMETHODS:20,TWOFA_OTP_MAX_LEN:6,TWOFA_TIMEOUT:1e4,TWOFA_ANIMATION_INTERVAL:3e3,TWOFA_AUTH_TIMEOUT:12e4,TWOFA_REMEMBER_DEVICE_ENABLED:!1,SSPR_TIMEOUT:1e4,EMAIL_DISCOVERY_SERVICE_TIMEOUT:3e3,EMAIL_DISCOVERY_SERVICE_URI:"/GetUserRealmExtended.srf",EMAIL_DISCOVERY_DEFAULT_TILES:null,MSA_AUTH_URL:null,TENANT_BRANDING:null,LCID:null,MSA_ACCOUNT_IMG_ALT_TEXT:"",AAD_ACCOUNT_IMG_ALT_TEXT:"",MSA_ACCOUNT_TILE_ALT_TEXT:"",AAD_ACCOUNT_TILE_ALT_TEXT:"",HIP_IMAGE_ALT_TEXT:null,DEFAULT_ILLUSTRATION:"",DEFAULT_ILLUSTRATION_ALT:"",DEFAULT_LOGO:"",DEFAULT_LOGO_ALT:"",DEFAULT_BACKGROUND_COLOR:"#333333",GENERIC_ERROR_CODES:[ErrorCodes.IDP_ERROR,ErrorCodes.IDP_ERROR2,ErrorCodes.NAMESPACE_ERROR,ErrorCodes.PARSE_ERROR],REALM_RESOLVER_URL:"/GetUserRealm.srf",DYNAMIC_BRANDING_CTA_ENABLED:!0,USERNAME_HINT_TEXT:"someone@example.com",REGEX_PHONE:/^[\+]{0,1}([\(\)\- \*\.#/\[\]]*\d[\(\)\- \*\.#/\[\]]*){4,20}$/,REGEX_EMAIL:/^([\w-\.\']+@([\w-]+\.)+[\w-]{2,46})?$/},MSLogin.Constants.State={NONE:0,FEDERATED:1,MANAGED:2,INVALID:3,PENDING:4},MSLogin.Constants.MSAccount={EXISTS:0,NOT_EXIST:1,THROTTLED:2},MSLogin.Constants.TokenizedStringMsgs={GENERIC_ERROR:"",UPN_DISAMBIGUATE_MESSAGE:""},MSLogin.Constants.NameSpaceType={UNKNOWN:"Unknown",FEDERATED:"Federated",MANAGED:"Managed"},MSLogin.Constants.FederationProtocol={SAML20:"SAML20"},MSLogin.Constants.EmailDiscoveryAccountState={AAD_UNKNOWN_AND_MSA_NOT_EXIST:0,AAD_UNKNOWN_AND_MSA_EXISTS:1,AAD_UNKNOWN_AND_MSA_THROTTLED:2,AAD_UNKNOWN_AND_MSA_TIMED_OUT:3,AAD_FEDERATED_AND_MSA_NOT_EXIST:4,AAD_FEDERATED_AND_MSA_EXISTS:5,AAD_FEDERATED_AND_MSA_THROTTLED:6,AAD_FEDERATED_AND_MSA_TIMED_OUT:7,AAD_MANAGED_AND_MSA_NOT_EXIST:8,AAD_MANAGED_AND_MSA_EXISTS:9,AAD_MANAGED_AND_MSA_THROTTLED:10,AAD_MANAGED_AND_MSA_TIMED_OUT:11,AAD_TIMED_OUT_AND_MSA_NOT_EXIST:12,AAD_TIMED_OUT_AND_MSA_EXISTS:13,AAD_TIMED_OUT_AND_MSA_THROTTLED:14,AAD_TIMED_OUT_AND_MSA_TIMED_OUT:15,ERROR:16},MSLogin.Constants.CancelAction={FROM_REDIRECT_TO_LOGIN:0,FROM_SHOW_USER_TO_TILES:1,FROM_MANY_TO_EMAILDISCOVERY_INIT:2,FROM_EMAILDISCOVERY_START_TO_TILES:3,FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START:4,FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_START:5,FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_SPLITTER:6,FROM_EMAILDISCOVERY_LOOKING_FOR_ACCOUNT_TO_EMAILDISCOVERY_START:7,FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_START:8,FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_SPLITTER:9,FROM_EMAILDISCOVERY_SPLITTER_FALLBACK_TO_TILES:10,FROM_DISAMBIGUATION_SCREEN_TO_LOGIN:11},MSLogin.Constants.AuthNForwardType={NORMAL:0,MULTIAUTH_ADFS:1,NON_MULTIAUTH_ADFS:2,WIAORMULTIAUTHN_ADFS:3},MSLogin.BackActionStack=function(){this.BackActionStack=[]},MSLogin.BackActionStack.prototype.AddAction=function(e){this.BackActionStack.push(e)},MSLogin.BackActionStack.prototype.TriggerCancelAction=function(){Context.post_from_tile=!1;var e=this.BackActionStack.pop();switch(e){case Constants.CancelAction.FROM_REDIRECT_TO_LOGIN:User.CancelRedirect();break;case Constants.CancelAction.FROM_SHOW_USER_TO_TILES:TenantBranding.RestoreDefaultPageBranding(),Tiles.CancelTileRedirect();break;case Constants.CancelAction.FROM_MANY_TO_EMAILDISCOVERY_INIT:EmailDiscovery.Init();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_START_TO_TILES:EmailDiscovery.BackToUserTiles();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START:Context.username_state.last_checked_email="",EmailDiscovery.HideSplitter(),EmailDiscovery.ShowEmailDiscovery();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_START:Context.username_state.last_checked_email="",EmailDiscovery.HideAADLoginLayout(),EmailDiscovery.ShowEmailDiscovery();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_SPLITTER:EmailDiscovery.HideAADLoginLayout(),Context.email_discovery_use_msa_api?this.TriggerCancelAction():EmailDiscovery.ShowSplitter();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_LOOKING_FOR_ACCOUNT_TO_EMAILDISCOVERY_START:Context.username_state.last_checked_email="",EmailDiscovery.CancelLookingForAccount();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_START:Context.username_state.last_checked_email="",EmailDiscovery.CancelRedirect(),EmailDiscovery.ShowEmailDiscovery();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_SPLITTER:EmailDiscovery.CancelRedirect(),Context.email_discovery_use_msa_api?this.TriggerCancelAction():EmailDiscovery.ShowSplitter();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_FALLBACK_TO_TILES:EmailDiscovery.HideSplitter(),this.TriggerCancelAction();break;case Constants.CancelAction.FROM_DISAMBIGUATION_SCREEN_TO_LOGIN:Context.username_state.last_checked_email="",Tiles.hideDisambiguationScreen(),Tiles.showUserLoginPage()}},MSLogin.Store=function(){this.Map={}},MSLogin.Store.prototype.Get=function(e){var t=$.trim(e).toLowerCase();return this.Map[t]},MSLogin.Store.prototype.Add=function(e,t){var n=$.trim(e).toLowerCase();this.Map[n]=t},MSLogin.BackActionStack.prototype.RemoveLastCancelAction=function(){this.BackActionStack.pop()},MSLogin.BackActionStack.prototype.DoesCancelActionExist=function(){return this.BackActionStack.length>0},MSLogin.BackActionStack.prototype.ClearCancelActions=function(){this.BackActionStack=[]};var Constants=MSLogin.Constants;MSLogin.Context={whr:"",use_instrumentation:!1,query_search_params:document.location.search,federated_domain:"",redirect_countdown:Constants.REDIRECT_COUNTDOWN_DEFAULT,redirect_auth_url:"",animationTid:null,redirectTid:null,metrics_on_redirect_submitted:!1,cobranding_image_visible:!1,prefetch_initiated:!1,user_tiles:null,email_discovery_lookup_xhr:null,email_discovery_mode:!1,email_discovery_tiles_mode:!1,email_discovery_response:null,email_discovery_timeout_occurred:!1,email_discovery_splitter_shown:!1,email_discovery_workflow_state:0,email_discovery_easi_user:!1,email_discovery_use_msa_api:!0,cred_height:-1,has_forced_cred_block_height:!1,original_orientation:window.orientation,back_action_stack:new MSLogin.BackActionStack,tenant_branding_tid:null,tenant_branding_retry_count:2e3,tenant_branding_polling_interval:20,tenant_branding_ts:0,authn_forward_state:0,post_from_tile:!1,on_load_image_background_loaded:!1,password_reset_link_url:"",redirect_to_manage:!1,getuserrealmresult:null},MSLogin.Context.username_state={is_empty:!0,is_partial:!1,is_timeout:!1,home_realm_state:0,disable_password:!0,enable_guests:!0,enable_redirect:!1,enable_progress_bar:!1,last_checked_email:""},MSLogin.Context.TenantBranding={key:null,user:null,prev_key:null,prev_obj:null,prev_user:null,prev_boiler_plate_height:0,default_page:!1,whr_key:null,applied:!1,info:null,info_context:null,enabled:!1,has_logo:!1,has_background_img:!1,background_color:Constants.DEFAULT_BACKGROUND_COLOR,footer_height:0,footer_height_saved:!1,cred_height:0,cred_height_saved:!1,workload_branding_saved:!1,workload_branding_illustration:null,workload_branding_illustration_alt:null,workload_branding_logo:null,workload_branding_logo_alt:null,workload_branding_footer_height:0,workload_branding_footer_height_saved:!1,workload_branding_color:null,workload_branding_height:0,workload_branding_enabled:!1,workload_branding_login_cta_text:"",store:new MSLogin.Store,kmsi_checkbox_hidden:!1,username_hint_changed:!1};var Context=MSLogin.Context;MSLogin.Background={delayed_background_fetch_url:"",background_image_ratio:0,background_image_loaded:!1,background_image_wait:null,winW:-1,winH:460,viewport_height:460,alt_image_path:"",alt_background_path:"",background_resized:!1};var Background=MSLogin.Background;MSLogin.Logo={logo_image_loaded:!1,logo_image_wait:null,winW:-1,winH:159,alt_image_path:"",alt_logo_path:""};var Logo=MSLogin.Logo;MSLogin.Instrument={latency_sensitivity:Constants.LATENCY_SENSITIVITY_DEFAULT,home_realm_start:null,home_realm_load_time:0,prefetch_done:!1,prefetch_start:null,prefetch_load_time:0,background_image_loaded:!1,background_image_start:null,background_image_load_time:0,background_image_error:!1,logo_image_loaded:!1,logo_image_start:null,logo_image_load_time:0,logo_image_error:null,email_discovery_ui_code:0,email_discovery_splitter_choice:0,possible_easi_user:0,tenant_branding_start_time:(new Date).getTime(),tenant_branding_process_end_time:0,tenant_branding_json_end_time:0,tenant_branding_load_error:!1,has_tenant_branding:!1,has_dynamic_tenant_branding:!1,tenant_branding_total_time:0,tenant_branding_number_of_switches:0,tenant_branding_right_side_time:0,logo_image_end_time:0,background_image_end_time:0,document_ready_end_time:0,document_load_end_time:0};var Instrument=MSLogin.Instrument;MSLogin.User={UpdateUsernameState:function(){var e=$.trim($("#cred_userid_inputtext").val());if($("input#cred_userid_inputtext").val(e),Context.username_state.is_empty=!1,Context.username_state.is_partial=!1,e!=Context.username_state.last_checked_email&&(Context.username_state.home_realm_state=Constants.State.NONE),""==e&&(Context.username_state.is_empty=!0,Context.username_state.is_partial=!0,Context.username_state.is_timeout=!1,Context.username_state.disable_password=!0,Context.username_state.enable_redirect=!1,Context.username_state.home_realm_state=Constants.State.NONE),!Support.validateUsernameCredInput(e))if(Constants.IS_MSA_PHONE_USERNAME_SUPPORTED&&Constants.REGEX_PHONE.test(e))Context.username_state.is_empty=!1,Context.username_state.is_partial=!1,Context.username_state.home_realm_state=Constants.State.NONE;else if(Context.username_state.is_empty=!1,Context.username_state.is_partial=!0,Context.username_state.home_realm_state=Constants.State.NONE,!Constants.IS_NAME_COEXISTENCE_ACCOUNT){var t=30064;null!=e&&e.indexOf("\\")>-1&&(t=30066),Support.showClientError(t)}switch(Context.username_state.is_timeout&&(Context.username_state.is_timeout=!0,Context.username_state.disable_password=!1,Context.username_state.enable_redirect=!1),Context.username_state.home_realm_state){case Constants.State.FEDERATED:Context.username_state.is_timeout=!1,Context.username_state.disable_password=!0,Context.username_state.enable_redirect=!0;break;case Constants.State.MANAGED:Context.username_state.is_timeout=!1,Context.username_state.disable_password=!1,Context.username_state.enable_redirect=!1;break;case Constants.State.INVALID:Context.username_state.is_timeout=!1,Context.username_state.disable_password=!0,Context.username_state.enable_redirect=!1;break;default:Context.username_state.is_timeout=!1,Context.username_state.disable_password=!0,Context.username_state.enable_redirect=!1}$("#home_realm_discovery").val(Context.username_state.home_realm_state)},IsGuestUser:function(){var e=window.location.href;return null!=e&&(Context.query_search_params.indexOf("guests=1")>-1||Context.query_search_params.indexOf("guest=1")>-1)?!0:!1},UsernameOnChangeHandler:function(){User.UpdateUsernameState(),$("#recover_container").removeClass("hidden"),$("#recover_container").css("opacity",1),Context.username_state.disable_password?$("#cred_sign_in_button").addClass("disabled_button"):$("#cred_sign_in_button").removeClass("disabled_button"),Context.username_state.enable_redirect?($("#cred_password_container").css("opacity",0),$("#cred_password_container").addClass("hidden"),$("#redirect_message_container").removeClass("no_display"),$("#redirect_message_container").css("opacity",1),$("#redirect_message_container").removeClass("hidden"),$(".login_guest_container").css("opacity",0),$("#cred_sign_in_button").css("opacity",0),$("#cred_sign_in_button").addClass("hidden")):($("#cred_password_container").removeClass("hidden"),$("#cred_password_container").css("opacity",1),$("#redirect_message_container").css("opacity",0),$("#redirect_message_container").addClass("hidden"),$("#redirect_message_container").addClass("no_display"),$(".login_guest_container").css("opacity",1),$("#cred_sign_in_button").css("opacity",1),$("#cred_sign_in_button").removeClass("hidden")),Context.username_state.enable_guests&&User.IsGuestUser()?($("#guest_hint_text").show(),$("#alternative-identity-providers").hide(),$(".guest_redirect_container").show()):($("#guest_hint_text").hide(),$(".guest_redirect_container").hide()),Context.username_state.enable_progress_bar||(clearInterval(Context.animationTid),$("div.progress").css("visibility","hidden"))},setupPrefetching:function(){Context.prefetch_initiated||Support.is_prefetch_supported()&&""!=Constants.PREFETCH_URL&&User.latencySensitivity()>=-1&&(Instrument.prefetch_start=Util.now(),Util.PrefetchContent(Constants.PREFETCH_URL),Context.prefetch_initiated=!0)},onLoadImage:function(){var e=$("#background_background_image");Background.background_image_ratio=Support.isDefined(e)&&Support.isDefined(e[0])&&Support.isDefined(e[0].naturalWidth)&&Support.isDefined(e[0].naturalHeight)&&0!=e[0].naturalHeight?e[0].naturalWidth/e[0].naturalHeight:e.width()/e.height(),Background.background_image_loaded=!0,Util.debug_console("OnLoadImage: Called"),Background.background_resized&&!Context.on_load_image_background_loaded&&User.IsImageLoaded(e)&&(Context.on_load_image_background_loaded=!0,TenantBranding.IsShowingDynamicBranding()?Logo.logo_image_loaded&&TenantBranding.onLoadImageHelper():User.onLoadImageHelper())},onLoadImageHelper:function(){var e=$("#background_background_image");e.hide(),$("#background_background_image_old").remove(),$("#background_page_overlay").css("visibility","visible"),e.show();var t=$("html").css("background-color");$("#background_page_overlay").css("background-color",t),$("#background_page_overlay").show(),$("#background_page_overlay").fadeOut(500,"linear"),Util.debug_console("OnLoadImage: Background was resized.")},updateGuestLink:function(){var e=$("#guest_redirect_link").attr("href");""!=e&&void 0!=e&&(e=User.addFederatedRedirectQSParameters(e),$("#guest_redirect_link").attr("href",e))},forceOrientationResize:function(){Context.original_orientation=-1,User.resize_bg(Context.original_orientation)},setupCredFieldsWithPlaceHolder:function(){var e=$("input#cred_userid_inputtext"),t=$("input#cred_password_inputtext");Constants.IS_HOLOGRAPHIC?(e.keypress(function(e){User.KeyPressEnter(e,Util.OnNext,13)}),t.keypress(function(e){User.KeyPressEnter(e,Util.OnNext,13)})):(e.focus(function(){Context.username_state.enable_redirect&&User.CancelRedirect()}),/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)&&e.blur(function(){User.forceOrientationResize()}),e.change(function(){User.RefreshDomainState(),User.UsernameOnChangeHandler()}),e.keydown(function(e){User.KeyPressEnter(e,User.RefreshDomainState,13),Context.email_discovery_workflow_state!=EmailDiscovery.WorkflowStates.INIT&&User.KeyPressEnter(e,User.RefreshDomainState,9)}),t.keypress(function(e){User.KeyPressEnter(e,Post.SubmitCreds,13)}),$("input#cred_keep_me_signed_in_checkbox").keypress(function(e){User.KeyPressEnter(e,Post.SubmitCreds,13)}),$("input#cred_keep_me_signed_in_checkbox").change(function(){User.updateGuestLink()}),t.click(function(){User.UsernameOnChangeHandler(),Context.username_state.is_empty||Context.username_state.is_partial||User.RefreshDomainState()}),t.blur(function(){User.forceOrientationResize()}),Util.debug_console("placeholder supported: "+Support.is_placeholder_supported()),Support.is_placeholder_supported()||($("input[placeholder]").each(function(){var e=$(this).attr("placeholder"),t=$(this).attr("id"),n="";t&&(n='id="'+t+'_placeholder_span"');var o=$('<span class="placeholder" '+n+">"+e+"</span>").appendTo($(this).parent());$(this).before(o),o.css("position","absolute"),o.css("display","block"),o.addClass("normaltext"),o.click(function(){$(this).siblings("input").focus()}),$(this).attr("placeholder"," ")}),$("input[placeholder]").focus(function(){""==$(this).val()?($(this).css("background","transparent"),$(this).siblings(".placeholder").css("filter","alpha(opacity=100)"),$(this).siblings(".placeholder").css("visibility","visible")):($(this).css("background","#FFFFFF"),$(this).siblings(".placeholder").css("filter","alpha(opacity=0)"),$(this).siblings(".placeholder").css("visibility","hidden"))}),$("input[placeholder]").keydown(function(){$(this).css("background","#FFFFFF"),$(this).siblings(".placeholder").css("filter","alpha(opacity=100)"),$(this).siblings(".placeholder").css("visibility","hidden")}),$("input[placeholder]").bind("paste",function(){$(this).css("background","#FFFFFF"),$(this).siblings(".placeholder").css("filter","alpha(opacity=100)"),$(this).siblings(".placeholder").css("visibility","hidden")}),$("input[placeholder]").keyup(function(){""==$(this).val()?($(this).css("background","transparent"),$(this).siblings(".placeholder").css("filter","alpha(opacity=0)"),$(this).siblings(".placeholder").css("visibility","visible")):($(this).css("background","#FFFFFF"),$(this).siblings(".placeholder").css("filter","alpha(opacity=0)"),$(this).siblings(".placeholder").css("visibility","hidden"))}),$("input[placeholder]").blur(function(){""==$(this).val()?($(this).css("background","transparent"),$(this).siblings(".placeholder").css("filter","alpha(opacity=100)"),$(this).siblings(".placeholder").css("visibility","visible")):($(this).css("background","#FFFFFF"),$(this).siblings(".placeholder").css("filter","alpha(opacity=0)"),$(this).siblings(".placeholder").css("visibility","hidden"))}),t.parent().click(function(){User.UsernameOnChangeHandler(),Context.username_state.is_empty||Context.username_state.is_partial||User.RefreshDomainState()})));var n=decodeURIComponent(Util.ExtractQSParam("username")),o=$("#cred_userid_inputtext").val();if(""!=n){var i=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,46})?$/;i.test(n)&&""==o&&$("#cred_userid_inputtext").val(n)}$("#redirect_cta_text").hide()},setupCallToActionMessages:function(){$.each(Constants.GENERIC_ERROR_CODES,function(e,t){$("#cta_client_error_text").append($("<div/>").addClass("client_error_msg").addClass(t.toString()).html(Constants.TokenizedStringMsgs.GENERIC_ERROR.replace("#~#ErrorCode#~#",t)))})},resize_bg:function(e){void 0!=e&&(Context.original_orientation=e),document.body&&document.body.offsetWidth&&(Background.winW=document.body.offsetWidth,Background.winH=document.body.offsetHeight),"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth&&(Background.winW=document.documentElement.offsetWidth,Background.winH=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(Background.winW=window.innerWidth,Background.winH=window.innerHeight);var t=document.documentMode;if(Support.isDefined(document.documentElement)&&Support.isDefined(document.documentElement.clientHeight)&&(Background.viewport_height=document.documentElement.clientHeight),$.browser.msie&&t>=10&&(navigator.userAgent.match(/IEMobile/)&&Background.viewport_height>10?$("td#login_panel_center").css("height",Background.viewport_height-10):$("td#login_panel_center").css("height",Background.winH-10)),(Background.background_image_loaded||null!=Background.delayed_background_fetch_url)&&!(Background.background_resized&&"undefined"!=typeof window.orientation&&Context.original_orientation==window.orientation||(Context.original_orientation=window.orientation,Support.isUXFeatureEnabled(512)&&"1"==Util.ExtractQSParam("popupui")))){Support.showIllustration()&&null!=Background.delayed_background_fetch_url&&($("#background_background_image").error(function(){Instrument.tenant_branding_load_error=!0}),User.UpdateBackground(Background.delayed_background_fetch_url,$("html").css("background-color"))),Util.debug_console("resize_bg Background: "+Background.winW+" x "+Background.winH);var n=Support.getViewport();if(Util.debug_console("resize_bg Viewport: "+n[0]+" x "+n[1]),Util.debug_console("resize_bg JQuery: "+$("body").width()+" x "+$("body").height()),$("img#background_background_image").error(function(){$(this).hide()}),!Background.background_image_loaded||0==Background.background_image_ratio)return void Util.debug_console("Background image not yet loaded.");var o=$(document).width()-400,i=$(document).height(),a=o,r=Math.round(a/Background.background_image_ratio);$("#background_background_image").width(a),$("#background_background_image").height(r),i>r&&(r=i,a=Math.round(r*Background.background_image_ratio),$("#background_background_image").width(a),$("#background_background_image").height(r)),Background.background_image_loaded&&!Background.background_resized&&(Util.debug_console("Background image loaded!"),Background.background_resized=!0,User.onLoadImage()),Util.debug_console("bg_image: "+a+" x "+r)}},getElementHeightSpacing:function(e,t){var n=0;return n+=$(e).height(),t&&(n+=parseInt($(e).css("padding-top")),n+=parseInt($(e).css("padding-bottom"))),n},getElementHeightMargin:function(e){var t=0;return t+=parseInt($(e).css("margin-top")),t+=parseInt($(e).css("margin-bottom"))},doesElementExist:function(e){return null!=$(e).height()},moveFooterToBottom:function(){},latencySensitivity:function(){var e=Constants.LATENCY_SENSITIVITY_DEFAULT,t=Util.ExtractQSParam("bandwidth");if(Support.isUXFeatureEnabled(16)){var n=performance.timing;n.responseEnd-n.fetchStart>Constants.LATENCY_THRESHOLD&&(t="low")}switch(Support.isUXFeatureEnabled(8)&&(t="low"),t){case"low":e=-1;break;case"high":e=1;break;case"critical":e=-2}return Instrument.latency_sensitivity=e,e},updateClientMetricsMode:function(){switch(Constants.METRICS_MODE){case 0:Constants.SUBMIT_METRICS_ON_REDIRECT=!1,Constants.SUBMIT_METRICS_ON_POST=!1;break;case 1:Constants.SUBMIT_METRICS_ON_REDIRECT=!1,Constants.SUBMIT_METRICS_ON_POST=!0;break;case 2:Constants.SUBMIT_METRICS_ON_REDIRECT=!0,Constants.SUBMIT_METRICS_ON_POST=!1;break;case 3:Constants.SUBMIT_METRICS_ON_REDIRECT=!0,Constants.SUBMIT_METRICS_ON_POST=!0;break;default:Constants.SUBMIT_METRICS_ON_REDIRECT=!1,Constants.SUBMIT_METRICS_ON_POST=!1}},GetHashedImagePath:function(e){return e},UpdateBackground:function(e,t){if((null==t||""==t||Constants.IS_CXH_REQUEST)&&(t=$("html").css("background-color")),TenantBranding.IsShowingDynamicBranding()?Context.TenantBranding.background_color=t:($("#background_page_overlay").css("background-color",t),$("#background_background_image").css("background-color",t),$("#background_branding_container").css("background-color",t),$("html").css("background-color",t)),Background.winW<Constants.MOBILE_WIDTH_THRESHOLD)return Util.debug_console("Screen size too small to fetch background."),void(Background.delayed_background_fetch_url=e);if($("#background_background_image").error(function(){$(this).show(),Context.TenantBranding.has_background_img=!1,TenantBranding.IsShowingDynamicBranding()&&Logo.logo_image_loaded&&TenantBranding.onLoadImageHelper()}),User.onLoadImage(),Background.delayed_background_fetch_url=null,!Support.showIllustration()||""==e||User.latencySensitivity()<0)Util.debug_console("Image load was cancelled."),$("#background_background_image").css("visibility","hidden"),Support.isUXFeatureEnabled(8)||Support.isUXFeatureEnabled(16)?($("#background_company_name_text").css("opacity",1),Support.isUXFeatureEnabled(16)&&""!=e&&$("#auto_low_bandwidth_background_notification").css("visibility","visible")):$("#background_company_name_text").css("opacity",0),Context.on_load_image_background_loaded=!0,Background.background_resized=!1,TenantBranding.IsShowingDynamicBranding()&&Logo.logo_image_loaded&&TenantBranding.onLoadImageHelper(),setTimeout(function(){User.setupPrefetching()
},1e3);else{var n=User.GetHashedImagePath(e);Context.on_load_image_background_loaded=!1,Background.background_resized=!1,Context.TenantBranding.has_background_img=!0,$("img#background_background_image").attr("src",n),$("img#background_background_image").css("visibility","visible"),$("#background_company_name_text").css("opacity",0),alt_background_image=e,Util.debug_console("Set background image: "+e),Instrument.background_image_start=Util.now()}Background.background_image_ratio=0,Util.debug_console("Fetched background image.")},UpdateLogo:function(e,t){""==e&&$(".login_workload_logo_container").empty(),Logo.logo_image_loaded=!1,$(".workload_img").remove();var n=User.GetHashedImagePath(e);if(""==e)Constants.IS_CXH_REQUEST||$(".login_workload_logo_container").append($("<h1/>").attr("id","login_workload_logo_text").css("visibility","visible").addClass("workload_img_text").addClass("gianttext").text(t)),Context.TenantBranding.has_logo=!1,TenantBranding.IsShowingDynamicBranding()?TenantBranding.onLoadLogoHelper():TenantBranding.setUserIdHintAndKmsi(),Util.debug_console("Set logo image failover.");else if(Constants.IS_HOLOGRAPHIC){$("header.body-header img.img-brand").remove(),TenantBranding.IsShowingDynamicBranding()&&(Context.TenantBranding.has_logo=!0),Instrument.logo_image_start=Util.now();var o=$("<img/>").hide().addClass("img-brand").error(TenantBranding.onLoadErrorLogo).attr("id","login_workload_logo_image").attr("alt",Constants.PARTNER_NAME);$("header.body-header").append(o),o.load(function(){Instrument.logo_image_end_time=Util.now(),o.show()}).attr("src",n)}else{var i=$("<img/>");Instrument.logo_image_start=Util.now(),TenantBranding.IsShowingDynamicBranding()?(Context.TenantBranding.has_logo=!0,i.load(function(){TenantBranding.onLoadLogo()}),i.hide()):(i.css("visibility","visible"),i.load(function(){Instrument.logo_image_end_time=Util.now()}),TenantBranding.setUserIdHintAndKmsi()),i.error(function(){TenantBranding.onLoadErrorLogo()}),i.attr("id","login_workload_logo_image").addClass("workload_img").attr("alt",Constants.PARTNER_NAME),$(".login_workload_logo_container").append(i),i=$(".workload_img"),i.attr("src",n),$("#login_workload_logo_text").remove(),alt_logo_image=e,Util.debug_console("Set logo image: "+e)}},RefreshDomainState:function(){var e=!1,t=$.trim($("#cred_userid_inputtext").val());return User.UpdateUsernameState(),Support.UpdatePasswordResetLink(),"strongauthcheck.2.0"===$("meta[name=PageID]").attr("content")||"proofup.2.0"===$("meta[name=PageID]").attr("content")||"i5028.2.0"===$("meta[name=PageID]").attr("content")?!1:(Context.username_state.is_empty||Context.username_state.is_partial?e=!1:(t!==Context.username_state.last_checked_email||Constants.IS_HOLOGRAPHIC)&&(e=!0),e?User.CheckUser():TenantBranding.RefreshDomainState(t),e)},CheckUser:function(){Constants.IS_NAME_COEXISTENCE_ACCOUNT||(EmailDiscovery.ShouldPerformDiscovery()?EmailDiscovery.PerformEmailBasedDiscovery():User.PerformHomeRealmDiscovery())},PerformHomeRealmDiscovery:function(){if(Context.username_state.home_realm_state!=Constants.State.PENDING){var e=$.trim($("input#cred_userid_inputtext").val());Constants.REGEX_PHONE.test(e)&&(e=e.replace(/\D/g,"")),$("div.progress").css("visibility","visible"),User.startAnimation(),Context.animationTid=setInterval(User.startAnimation,3500),Context.username_state.enable_progress_bar=!0;var t=Constants.Use_Client_Check_Msa_Flag?Constants.IS_MSA_FED_SUPPORTED:!0;$.ajax({headers:{Accept:"application/json"},url:Constants.REALM_RESOLVER_URL+encodeURI("?user="+e),dataType:"json",data:{"api-version":"2.1",stsRequest:Constants.CONTEXT,checkForMicrosoftAccount:t},beforeSend:function(){Instrument.home_realm_start=Util.now()},success:User.ReceiveTenantInfo,error:User.ReceivedHomeRealmError}),Context.username_state.home_realm_state=Constants.State.PENDING,Context.username_state.last_checked_email=e,User.resize_bg()}},showGenericError:function(e){Support.hideClientErrorMessages(),Support.hideClientMessages(),Support.showClientError(e)},ReceivedHomeRealmError:function(e,t){$("div.progress").css("visibility","hidden"),$("input#cred_password_inputtext").focus(),Util.debug_console("Received home realm error"),Context.username_state.home_realm_state=Constants.State.NONE,clearInterval(Context.animationTid),Context.username_state.home_realm_state=Constants.State.NONE,User.UsernameOnChangeHandler(),"parsererror"==t&&User.showGenericError(ErrorCodes.PARSE_ERROR)},ReceiveTenantCustom:function(e){tenant_info.background_color=e.BackgroundColor,tenant_info.background_url=e.BackgroundPath,tenant_info.logo_url=e.LogoPath,tenant_info.boilerplate1=e.BoilerPlate1,tenant_info.boilerplate2=e.BoilerPlate2,tenant_info.cta1=e.CTA1,tenant_info.cta2=e.CTA2,Util.debug_console(e.LogoPath),clearInterval(Context.animationTid),Context.username_state.home_realm_state=Constants.State.MANAGED,User.UsernameOnChangeHandler(),$("#cred_userid_inputtext").blur(),Constants.IS_HOLOGRAPHIC||$("#cred_password_inputtext").focus(),setTimeout(User.resize_bg,300)},KeyPressEnter:function(e,t,n,o){var i;if(e&&e.which?i=e.which:window.event&&(e=window.event,i=e.keyCode),i===n){if(o&&o>0){MSLogin.User.KeyPressEnterHandleOnceDelayTable=MSLogin.User.KeyPressEnterHandleOnceDelayTable||{};var a=e.timeStamp;if(MSLogin.User.KeyPressEnterHandleOnceDelayTable[n]){var r=MSLogin.User.KeyPressEnterHandleOnceDelayTable[n];if(o>a-r)return n;MSLogin.User.KeyPressEnterHandleOnceDelayTable[n]=a}else MSLogin.User.KeyPressEnterHandleOnceDelayTable[n]=a}t()}return i},StartRedirection:function(e){return Context.redirect_countdown=Constants.REDIRECT_COUNTDOWN_DEFAULT,e&&"none"==$("#cred_userid_container").css("display")||void 0==$("#cred_userid_container").css("display")?void 0:(!Support.isUXFeatureEnabled(4096)||"EmailBasedDiscovery.2.0"!=$("meta[name=PageID]").attr("content")&&"EmailBasedDiscoveryTiles.2.0"!=$("meta[name=PageID]").attr("content")||($("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),EmailDiscovery.is_enabled_workflow=!0),$("#cred_cancel_button").hide(),Context.username_state.enable_progress_bar=!0,Context.username_state.enable_redirect=!0,Context.username_state.enable_guests=!1,cancel_redirect=!1,$("#cred_password_container").css("opacity",0),User.UsernameOnChangeHandler(),Context.redirectTid=setTimeout(function(){User.ShowRedirect(),$("a#redirect_cancel_link").focus()},100),Constants.IS_CXH_REQUEST||Constants.IS_ADAL_REQUEST||$("#cred_sign_in_button").hide(),Context.redirectTid)},ReceiveTenantInfo:function(e){$(".30065,.30068").is(":visible")&&(Support.hideClientError(30065),Support.hideClientError(30068));var t=!0,n=!1;if(Instrument.home_realm_load_time=Util.now()-Instrument.home_realm_start,Context.username_state.enable_progress_bar=!1,Context.username_state.disable_password=!1,Context.username_state.last_checked_email=e.Login,1==Constants.SPLIT_VIEW_ENABLED&&1==Constants.IS_MSA_FED_SUPPORTED&&Constants.HAS_ERROR!==!0)if(0===e.MicrosoftAccount&&e.DomainName!==Context.whr){if(e.NameSpaceType==Constants.NameSpaceType.MANAGED||e.NameSpaceType==Constants.NameSpaceType.FEDERATED&&!Util.isMSA(e.AuthURL))return Context.getuserrealmresult=e,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_DISAMBIGUATION_SCREEN_TO_LOGIN),void MSLogin.SplitterControl.Render();e.NameSpaceType==Constants.NameSpaceType.UNKNOWN&&MSLogin.SplitterControl.LoginMSA()}else if(void 0===e.MicrosoftAccount||2===e.MicrosoftAccount)return Context.getuserrealmresult=e,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_DISAMBIGUATION_SCREEN_TO_LOGIN),void MSLogin.SplitterControl.Render();e.NameSpaceType==Constants.NameSpaceType.FEDERATED?e.federation_protocol==Constants.FederationProtocol.SAML20&&null!=e.federation_saml_request?t=MSLogin.User.PostToSamlIdp(e):0!==e.MicrosoftAccount&&Util.isMSA(e.AuthURL)?(clearInterval(Context.animationTid),$("div.progress").css("visibility","hidden"),t=Support.showUsernameOrDomainError(Util.htmlEncode(e.Login)),n=!0,Context.username_state.home_realm_state=Constants.State.INVALID):(Context.back_action_stack.AddAction(Constants.CancelAction.FROM_REDIRECT_TO_LOGIN),t=MSLogin.User.ReceiveFederatedDomain(e)):e.NameSpaceType==Constants.NameSpaceType.MANAGED?t=MSLogin.User.ReceiveManagedDomain(e):e.NameSpaceType==Constants.NameSpaceType.UNKNOWN&&0!==e.MicrosoftAccount?(clearInterval(Context.animationTid),$("div.progress").css("visibility","hidden"),t=Support.showUsernameOrDomainError(Util.htmlEncode(e.Login)),n=!0,Context.username_state.home_realm_state=Constants.State.INVALID):t=MSLogin.User.ReceiveUnknownDomain(e),Constants.IS_HOLOGRAPHIC?(!t||n)&&Util.OnBack():t&&($("#cred_userid_inputtext").blur(),$("#cred_password_inputtext").focus())},ReceiveUnknownDomain:function(e){if(1==e.State&&!e.FederationGlobalVersion)return Context.username_state.home_realm_state=Constants.State.INVALID,User.UsernameOnChangeHandler(),Util.debug_console("federationGlobalVersion bad"),$("#cred_password_inputtext").blur(),$("#cred_userid_inputtext").focus(),!1;var t=!Support.showUsernameOrDomainError(Util.htmlEncode(e.Login));return Context.username_state.home_realm_state=Constants.State.INVALID,clearInterval(Context.animationTid),Constants.IS_HOLOGRAPHIC||User.UsernameOnChangeHandler(),Util.debug_console("Unknown home realm reply"),$("input#cred_password_inputtext").focus(),t},ReceiveFederatedDomain:function(e){return Context.username_state.home_realm_state=Constants.State.FEDERATED,tenant_info.company_name="",tenant_info.domain=e.DomainName,Context.authn_forward_state=e.AuthNForwardType,e.DomainName.areEqualIgnoreCase(Constants.MSA_DOMAIN)&&!Constants.IS_MSA_FED_SUPPORTED?($(".pip").stop(!0,!0),$(".pip").hide(),clearInterval(Context.animationTid),Context.username_state.enable_redirect=!1,Context.username_state.home_realm_state=Constants.State.INVALID,Context.back_action_stack.RemoveLastCancelAction(),Support.showClientError(30065),!1):e.DomainName!=Context.whr||User.IsGuestUser()?(Context.federated_domain=e.DomainName,Context.redirect_auth_url=e.AuthURL,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_SHOW_USER_TO_TILES),Util.updateRedirectionMessage(e.AuthURL),e.federation_protocol==Constants.FederationProtocol.SAML20&&null!=e.federation_saml_request?(MSLogin.User.PostToSamlIdp(e),!1):(1==e.FederationGlobalVersion&&User.Redirect(User.addFederatedRedirectQSParameters(e.AuthURL)),User.StartRedirection(!1),!1)):(Context.username_state.home_realm_state=Constants.State.MANAGED,Util.debug_console("whr set already"),User.UsernameOnChangeHandler(),$("#cred_userid_inputtext").blur(),$("#cred_password_inputtext").focus(),!1)},ReceiveManagedDomain:function(e){return Context.whr=void 0!=e.DomainName?e.DomainName:e.Login.split("@@")[1],null!=e.TenantBrandingInfo&&TenantBranding.StoreBrandingInfo(e.DomainName,e.TenantBrandingInfo),TenantBranding.PerformDynamicBranding(e.DomainName),Context.TenantBranding.user=e.Login,Context.username_state.home_realm_state=Constants.State.MANAGED,tenant_info.company_name=e.FederationBrandName,tenant_info.domain=e.DomainName,tenant_info.BackgroundColor=$("#background_branding_container").css("background"),tenant_info.BackgroundPath=$("#background_background_image").attr("src"),tenant_info.LogoPath=$("#login_workload_logo_image").attr("src"),tenant_info.BoilerPlate1="",tenant_info.BoilerPlate2="",tenant_info.CTA1=$("#login_cta_text").text(),tenant_info.CTA2="",tenant_info.HadBoilerPlate=!1,Context.username_state.disable_password=!1,Context.username_state.enable_progress_bar=!1,Context.username_state.enable_redirect=!1,User.UsernameOnChangeHandler(),!0},PostToSamlIdp:function(e){if(Context.federated_domain=e.DomainName,Context.redirect_auth_url=e.AuthURL,$("#samlform").attr("action",e.AuthURL),$("#samlrequest").val(decodeURIComponent(e.federation_saml_request)),null!=e.federation_saml_request)$("#samlrelaystate").val(decodeURIComponent(e.federation_saml_relay_state));else{var t=Constants.FEDERATION_QUERY_PARAMETERS.qs("wctx");$("#samlrelaystate").val(decodeURIComponent(t))}$("#samlform").submit()},Redirect:function(e){window.location.assign(e)},ShowRedirect:function(){$("#signin_legend,#boilerplate_container,#body_header,#page_footer,#footer_content").hide(),$(".control-page").addClass("page_centered");var e;return e=Constants.IS_MSA_REDIR_SUPPORTED&&Util.isMSA(Context.federated_domain)?User.addUsernameQsParam(Constants.MSA_AUTH_URL):User.addFederatedRedirectQSParameters(Context.redirect_auth_url),Constants.SUBMIT_METRICS_ON_REDIRECT&&!Context.metrics_on_redirect_submitted&&(Post.SubmitInstrumentation(),Context.metrics_on_redirect_submitted=!0),Context.username_state.enable_guests=!1,User.UsernameOnChangeHandler(),0==Context.redirect_countdown?(MSLogin.Util.LogCxhTelemetry("AADLoginPageFederationRedirect"),Constants.FLOW_TOKEN.length>0&&Util.setCookieWithExpiration(Constants.FLOW_TOKEN_COOKIE_NAME,Constants.FLOW_TOKEN),void User.Redirect(e)):(1==Context.redirect_countdown&&$("#background_page_overlay").css("z-index",0),$("#cred_userid_container,#cred_password_container,.login_cta_container,#recover_container,input#cred_password_inputtext").hide(),$("#cred_kmsi_container,#redirect_cta_text").show(),$("#redirect_company_name_text").empty(),$("#redirect_message_container").show().css("visibility","visible").css("opacity",1).attr("aria-hidden","false"),$("#windows_redirect_message_container").show(),$("#progress_text").focus(),Context.redirect_countdown=Context.redirect_countdown-1,Context.redirectTid=setTimeout(function(){User.ShowRedirect()},1e3),void Util.debug_console("Redirecting in "+Context.redirect_countdown))},CancelRedirect:function(){clearTimeout(Context.redirectTid),Context.back_action_stack.DoesCancelActionExist()&&$("#cred_cancel_button").show(),$("#cred_kmsi_container").show(),$("#cred_userid_container").show(),$("#cred_password_container").show(),$(".login_cta_container").show(),$("#recover_container").show(),$("#redirect_cta_text").hide(),$("#cred_password_container").css("opacity",1),$("input#cred_password_inputtext").css("display","inline-block"),$("#redirect_message_container").hide(),$("input#cred_password_inputtext").blur(),$("#redirect_company_name_text").empty(),Context.username_state.home_realm_state==Constants.State.FEDERATED&&(Context.username_state.home_realm_state=Constants.State.NONE),Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.NONE,Context.username_state.disable_password=!0,Context.username_state.enable_progress_bar=!1,Context.username_state.enable_redirect=!1,Context.username_state.enable_guests=!0,User.UsernameOnChangeHandler(),$("input#cred_userid_inputtext").focus()},startAnimation:function(e){var t=100,n=$(".login_footer_container").outerWidth();e&&(n=e.outerWidth()),$(".pip").stop(!0,!0),$(".pip").each(function(){User.animatePip($(this),t,n),t+=100})},animatePip:function(e,t,n){var o=n/3,i=n-3;"ltr"==Constants.DIR?e.css("left",0).hide().delay(t).show().animate({left:o},{duration:1e3,easing:"easeOutSine"}).animate({left:i},{duration:999,easing:"easeInSine"}):e.css("right",0).hide().delay(t).show().animate({right:o},{duration:1e3,easing:"easeOutSine"}).animate({right:i},{duration:999,easing:"easeInSine"})},addFederatedRedirectQSParameters:function(e){var t=e;if(Util.isMSA(e)){e=Constants.MSA_AUTH_URL;var n=decodeURIComponent(Util.ExtractQSParam("pcexp")),o=decodeURIComponent(Util.ExtractQSParam("display"));o.areEqualIgnoreCase("popup")&&(n=!1),Background.winW<Constants.MOBILE_WIDTH_THRESHOLD&&(n=!1),e.indexOf("pcexp")<0?e+="&pcexp="+encodeURIComponent(n):Constants.IS_CXH_REQUEST||(e=e.replace(/pcexp=[^&]*/i,"pcexp="+encodeURIComponent(n)));var i=decodeURIComponent(Util.ExtractQSParam("vv"));i&&(e.indexOf("vv")<0?e+="&vv="+encodeURIComponent(i):e=e.replace(/vv=[^&]*/i,"vv="+encodeURIComponent(i))),e.indexOf("username")<0&&(e=User.addUsernameQsParam(e))}User.resize_bg();var a=decodeURIComponent(Util.ExtractQSParam("popupui"));(Constants.IS_ADAL_REQUEST||Background.winW<Constants.MOBILE_WIDTH_THRESHOLD)&&(a=1),e.indexOf("popupui")<0?e+="&popupui="+encodeURIComponent(a):e=e.replace(/popupui=[^&]*/i,"popupui="+encodeURIComponent(a)),e=e.replace(/guests%3D1/i,"");var r=t.qs("LoginOptions");if(""==r&&(r=$("#cred_keep_me_signed_in_checkbox").attr("checked")?"1":""),""!==r){var s=e.qs("wreply");""!=s?(s+=(s.indexOf("%3f")>=0?"%26":"%3f")+"LoginOptions%3d"+r,e=e.qs("wreply",s)):(s=e.qs("wctx"),""!=s&&(s+="%26LoginOptions%3d"+r,e=e.qs("wctx",s))),e=e.qs("LoginOptions",r)}return e},AddFooterLink:function(e,t,n,o){var i="footer_link_"+e;(""==o||null==o)&&(o=i),$(".corporate_footer").append($("<span/>").addClass("corp_link").append($("<a/>").attr("tabindex",40+e).attr("id",i).addClass(o).attr("href",n).html(t)))},DrawDefaultFooterLinks:function(){$.each(Constants.DEFAULT_ENABLED_FOOTER_LINKS,function(e,t){void 0!=Constants.DEFAULT_FOOTER_LINKS[t]&&User.AddFooterLink(e,Constants.DEFAULT_FOOTER_LINKS[t].label,Constants.DEFAULT_FOOTER_LINKS[t].url,"footer_link_"+t)})},ProcessFooterLinks:function(){},RegisterOnLoadImage:function(){$("#background_background_image").load(function(){void 0!=this.width&&(Background.background_image_loaded=!0),User.onLoadImage(),0==Instrument.background_image_end_time&&(Instrument.background_image_end_time=Util.now()),Instrument.background_image_load_time=Util.now()-Instrument.background_image_start,Instrument.background_image_loaded=!0,setTimeout(function(){User.setupPrefetching()},1e3),User.resize_bg()}).error(function(){$("#background_background_image").hide(),Instrument.background_image_loaded=!1,Instrument.background_image_load_time=Util.now()-Instrument.background_image_start,Instrument.background_image_error=!0,0==Instrument.background_image_end_time&&(Instrument.background_image_end_time=Util.now())})},IsImageLoaded:function(e){if(void 0==e||null==e||void 0==e[0]||null==e[0]||void 0==e[0].complete||null==e[0].complete)return!1;var t=e[0],n=document.documentMode;return t.complete||$.browser.msie&&8>=n?"undefined"!=typeof t.naturalWidth&&0==t.naturalWidth?!1:"undefined"!=typeof t.naturalHeight&&0==t.naturalHeight?!1:!0:!1},isChxOrAdalOverride:function(){return Constants.IS_CXH_REQUEST||Constants.IS_ADAL_REQUEST&&Constants.ADAL_UX_OVERRIDE},addUsernameQsParam:function(e){var t=decodeURIComponent(Util.ExtractQSParam("username")),n=$("#cred_userid_inputtext").val();return""!=n?e=Util.appendQueryString(e,"username="+encodeURIComponent(n)):""!=t&&(e=Util.appendQueryString(e,"username="+encodeURIComponent(t))),e}};var User=MSLogin.User;window.$Do&&$Do.register("User"),MSLogin.SplitterControl={Template:'<a id="{1}_link" href="#" onclick="{0}(); return false;" tabindex="1" class="tile_link tooltip">    <table id="{1}" class="user_tile">        <tbody>        <tr class="{1}" style="cursor: pointer">            <td>                <img class="ad_glyph {1}" src="{2}" alt="{3}">            </td>            <td class="tile_name">                <div class="bigtext tile_primary_name windows_tile_text wrap {1}" style="cursor: pointer">{3}</div>                <div class="smallertext tile_secondary_name  windows_tile_text text-caption2 {1}" style="cursor: pointer">{4}</div>                <div class="smallertext tile_third_name  windows_tile_text text-caption2 {1}" style="cursor: pointer">{5}</div>             </td>         </tr>         </tbody>    </table></a>',Render:function(){if(Constants.MEMBER_NAME===Context.username_state.last_checked_email&&$(".view-error-details-container:visible").length)return $("div.progress").css("visibility","hidden"),Context.username_state.home_realm_state==Constants.State.PENDING&&(Context.username_state.home_realm_state=Constants.State.MANAGED),void $("#cred_password_inputtext").focus();if($(".login_cred_field_container").hide(),$(".login_cred_container .windows_cred_block").hide(),$(".login_cred_options_container").hide(),$(".login_user_chooser").hide(),$("#cta_error_message_text").hide(),Context.back_action_stack.DoesCancelActionExist()&&($(".login_cred_options_container").show(),$("#cred_sign_in_button").hide(),$("#cred_cancel_button").show(),$("#recover_container").hide(),$("#alternative-identity-providers").hide(),$("#cred_keep_me_signed_in_checkbox").hide(),$("#keep_me_signed_in_label_text").hide()),0!=Context.getuserrealmresult.MicrosoftAccount||Context.getuserrealmresult.NameSpaceType!=Constants.NameSpaceType.MANAGED&&(Context.getuserrealmresult.NameSpaceType!=Constants.NameSpaceType.FEDERATED||Util.isMSA(Context.getuserrealmresult.AuthURL)))Support.showClientMessage(30140);else{var e=$("input#cred_userid_inputtext").val().toLowerCase();e=$.trim(e);var t=Constants.TokenizedStringMsgs.UPN_DISAMBIGUATE_MESSAGE.replace("{0}",e);$("#upn_needs_disambiguation_text").text(t),Support.showClientMessage(30139)}$.each(Constants.SplitterControlData,function(e,t){var n=MSLogin.SplitterControl.Template.format(t.link,t.id,t.image,t.name,t.login,MSLogin.Util.htmlEncode(Context.username_state.last_checked_email));$("#splitter-tiles-container").append(n)}),$(".login_splitter_control").show(),$("#disambig-container").show(),$("#splitter-tiles-container").show()},LoginAAD:function(){Context.username_state.home_realm_state=Constants.State.MANAGED,$(".login_cred_options_container").show(),$("#cred_sign_in_button").show(),$("#cred_cancel_button").hide(),$("#recover_container").show(),$("#alternative-identity-providers").show(),$("#cred_keep_me_signed_in_checkbox").show(),$("#keep_me_signed_in_label_text").show(),$("#cred_sign_in_button").removeClass("disabled_button"),$("#splitter-tiles-container").empty(),$("#splitter-tiles-container").hide(),$("#disambig-container").hide(),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$(".login_cred_container .windows_cred_block").show(),Support.hideClientErrorMessages(),Support.hideClientMessages();var e=Context.getuserrealmresult;null!=e&&e.NameSpaceType==Constants.NameSpaceType.FEDERATED&&User.ReceiveFederatedDomain(e),Support.showClientMessage(1),$("#cred_userid_container").show(),$("div.progress").css("visibility","hidden"),$("#cred_password_inputtext").focus()},LoginMSA:function(){Context.username_state.home_realm_state=Constants.State.FEDERATED,$("#splitter-tiles-container").empty(),$("#splitter-tiles-container").hide(),$("#disambig-container").hide(),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),Support.hideClientErrorMessages(),Support.hideClientMessages();var e={DomainName:Constants.MSA_DOMAIN,AuthURL:Constants.MSA_AUTH_URL};User.ReceiveFederatedDomain(e)}};var tenant_info={company_name:"",cta1:"",cta2:"",boilerplate1:"",boilerplate2:"",background_url:"",background_color:"",logo_url:"",domain:"",lang:""};$(pageOnReady),$(window).load(function(){if(Support.renderBrowserSpecific(),User.updateClientMetricsMode(),$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),Constants.IS_HOLOGRAPHIC||(void 0!=$("input#cred_userid_inputtext").val()&&-1!=$("input#cred_userid_inputtext").val().indexOf("@")?EmailDiscovery.ShouldPerformDiscovery()?($("#cred_continue_button").focus(),$("#redirect_message_container").hide(),$("#alternative-identity-providers").hide()):(Context.username_state.home_realm_state=Constants.State.MANAGED,User.UsernameOnChangeHandler(),Util.debug_console("startup"),(Constants.IS_CXH_REQUEST&&!Constants.IS_MOBILE||!Constants.IS_CXH_REQUEST)&&$("input#cred_userid_inputtext").focus()):(User.UsernameOnChangeHandler(),(Constants.IS_CXH_REQUEST&&!Constants.IS_MOBILE||!Constants.IS_CXH_REQUEST)&&$("input#cred_userid_inputtext").focus()),Constants.userRealmInfo&&(Context.getuserrealmresult=Constants.userRealmInfo,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_DISAMBIGUATION_SCREEN_TO_LOGIN),Context.username_state.last_checked_email=Constants.MEMBER_NAME,MSLogin.SplitterControl.Render())),!Support.isUXFeatureEnabled(4096)||"EmailBasedDiscovery.2.0"!=$("meta[name=PageID]").attr("content")&&"EmailBasedDiscoveryTiles.2.0"!=$("meta[name=PageID]").attr("content")||($("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),EmailDiscovery.is_enabled_workflow=!0),Support.isUXFeatureEnabled(512)&&"1"==Util.ExtractQSParam("popupui")){try{var e=$("meta[name=viewport]");e.attr("content","width=300, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, height=device-height")}catch(t){}$("html").css("background-color","#FFFFFF"),$("body").css("background-color","#FFFFFF"),$("#background_branding_container").css("background-color","#FFFFFF")}Instrument.document_load_end_time=Util.now()}),MSLogin.EmailDiscovery={Strings:{},WorkflowStates:{NONE:0,INIT:1,LOOKING:2,SPLITTER:3,MSA:4,AAD:5},is_enabled_workflow:!1,IsDiscoveryPage:function(){return Support.isUXFeatureEnabled(32)&&EmailDiscovery.is_enabled_workflow},ShouldPerformDiscovery:function(){return Support.isUXFeatureEnabled(32)&&Context.email_discovery_mode},IsTilesModeActivated:function(){return Support.isUXFeatureEnabled(32)&&Context.email_discovery_tiles_mode},Init:function(){Context.email_discovery_mode=!0,EmailDiscovery.ShouldPerformDiscovery()&&(EmailDiscovery.is_enabled_workflow=!0),$("#cred_sign_in_button").hide(),$("#cred_cancel_button").hide(),$("#cred_kmsi_container").hide(),$("#recover_container").hide(),$("#cred_password_container").hide(),$("#login_cta_text").hide(),$("#login_user_chooser").hide(),$("#forget_tile_container").hide(),$("#guest_hint_text").hide(),$(".guest_redirect_container").hide(),$(".login_cta_container").show(),$(".login_cred_options_container").addClass("email_discovery"),$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),$("#looking_container").hide(),$("div.progress").css("visibility","hidden"),Context.username_state.last_checked_email=Context.username_state.last_checked_email||"",Context.username_state.home_realm_state=Constants.State.NONE,Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.NONE;var e=decodeURIComponent(Util.ExtractQSParam("username")),t=$("#cred_userid_inputtext").val();EmailDiscovery.IsTilesModeActivated()&&e!==t&&($("input#cred_userid_inputtext").val(""),$("input#cred_userid_inputtext").focus()),EmailDiscovery.HideSplitter(),EmailDiscovery.ShowEmailDiscovery()},Initialize:function(){$("input#cred_userid_inputtext").keydown(function(e){EmailDiscovery.ShouldPerformDiscovery()&&User.KeyPressEnter(e,function(){e.preventDefault(),EmailDiscovery.ValidateUserInput()},13)}),$("#cred_continue_button").keydown(function(e){EmailDiscovery.ShouldPerformDiscovery()&&User.KeyPressEnter(e,function(){e.preventDefault(),EmailDiscovery.ValidateUserInput(),User.RefreshDomainState()},13)}),$("#cred_try_again_button").keydown(function(e){EmailDiscovery.ShouldPerformDiscovery()&&User.KeyPressEnter(e,function(){e.preventDefault(),EmailDiscovery.ValidateUserInput(),User.RefreshDomainState()},13)}),$("#iDisambigRenameLink").click(function(e){e.preventDefault(),window.open(Constants.DisambigHelpUrl,"_blank")}),$("a#looking_cancel_link").click(function(e){e.preventDefault(),Context.back_action_stack.TriggerCancelAction()})},SetupTilesForSplitter:function(){users!=Constants.EMAIL_DISCOVERY_DEFAULT_TILES&&(Context.email_discovery_splitter_shown=!0,Context.user_tiles=Tiles.users,Tiles.users=Constants.EMAIL_DISCOVERY_DEFAULT_TILES,users=Tiles.users,$.each(users,function(e,t){t.ignore_length=!0}))},RevertUserTiles:function(){users==Constants.EMAIL_DISCOVERY_DEFAULT_TILES&&(Context.email_discovery_splitter_shown=!1,Tiles.users=Context.user_tiles,users=Tiles.users)},ShowPostErrorMessage:function(){Context.email_discovery_mode=!1,EmailDiscovery.is_enabled_workflow=!0,Context.email_discovery_splitter_shown=!1,-1==$("meta[name=PageID]").attr("content").indexOf("EmailBasedDiscoveryTiles")&&Context.back_action_stack.AddAction(Constants.CancelAction.FROM_MANY_TO_EMAILDISCOVERY_INIT),$("#cred_cancel_button").show()},ValidateUserInput:function(){User.UpdateUsernameState(),Context.username_state.is_empty?(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.NONE,EmailDiscovery.ShowEmailDiscovery(30127)):Context.username_state.is_partial&&(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.NONE,EmailDiscovery.ShowEmailDiscovery(30145))},PerformEmailBasedDiscovery:function(){var e=$("input#cred_userid_inputtext").val().toLowerCase();if(e=$.trim(e),Context.email_discovery_timeout_occurred=!1,Context.email_discovery_error_message=null,!Support.validateUsernameCredInput(e))return Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.NONE,void EmailDiscovery.ShowEmailDiscovery(30064);var t=Constants.Use_Client_Check_Msa_Flag?Constants.IS_MSA_FED_SUPPORTED:!0;Context.email_discovery_lookup_xhr=$.ajax({headers:{Accept:"application/json"},url:Constants.EMAIL_DISCOVERY_SERVICE_URI.replace("{0}",encodeURI(e)),dataType:"json",data:{stsRequest:Constants.CONTEXT,checkForMicrosoftAccount:t},success:EmailDiscovery.ReceiveHomeRealmInfo,error:EmailDiscovery.ReceiveHomeRealmError,timeout:Constants.EMAIL_DISCOVERY_SERVICE_TIMEOUT}),Context.username_state.last_checked_email=e,Context.username_state.home_realm_state=Constants.State.PENDING,MSLogin.EmailDiscovery.HideEmailDiscovery(),MSLogin.EmailDiscovery.ShowLookingForAccountLayout()},ReceiveHomeRealmInfo:function(e){Context.email_discovery_response={AAD:e},EmailDiscovery.HideLookingForAccountLayout(),Context.back_action_stack.RemoveLastCancelAction();var t=EmailDiscovery.GetAccountStateFromResponse({AAD:e});EmailDiscovery.PerformUIAction(t)},GetAccountStateFromResponse:function(e){var t=Constants.EmailDiscoveryAccountState;if(null==e||null==e.AAD)return Context.username_state.home_realm_state=Constants.State.INVALID,t.ERROR;var n=e.AAD.MicrosoftAccount,o=e.AAD,i="",a="";if(null==n)i="TIMED_OUT";else if(i=EmailDiscovery.GetEnumKeyName(Constants.MSAccount,n),null==i)return t.ERROR;if("timeout"===o)a="TIMED_OUT",Context.username_state.home_realm_state=Constants.State.INVALID;else{a=EmailDiscovery.GetEnumKeyName(Constants.NameSpaceType,o.NameSpaceType);var r=o.NameSpaceType===Constants.NameSpaceType.FEDERATED&&!o.AuthURL;if(null==a||r)return Context.username_state.home_realm_state=Constants.State.INVALID,t.ERROR;Context.username_state.home_realm_state=Constants.State[a]}var s="AAD_"+a+"_AND_MSA_"+i,_=t[s];return void 0==_?t.Error:_},PerformUIAction:function(e){var t=Constants.EmailDiscoveryAccountState,n=Context.email_discovery_response;switch(Context.email_discovery_easi_user=!1,Context.email_discovery_splitter_shown=!1,Instrument.email_discovery_ui_code=e,e){case t.AAD_UNKNOWN_AND_MSA_NOT_EXIST:Constants.SHOULD_HIDE_SIGNUP||$("#create_msa_account_container").show(),EmailDiscovery.ShowEmailDiscovery(30146);break;case t.AAD_UNKNOWN_AND_MSA_EXISTS:Context.email_discovery_easi_user=!0,EmailDiscovery.LoginMSOAccount();break;case t.AAD_FEDERATED_AND_MSA_NOT_EXIST:if(Util.isMSA(n.AAD.AuthURL)){Constants.SHOULD_HIDE_SIGNUP||$("#create_msa_account_container").show(),EmailDiscovery.ShowEmailDiscovery(30146);break}case t.AAD_MANAGED_AND_MSA_NOT_EXIST:EmailDiscovery.LoginAADAccount();break;case t.AAD_FEDERATED_AND_MSA_EXISTS:if(Util.isMSA(n.AAD.AuthURL)){EmailDiscovery.LoginMSOAccount();break}EmailDiscovery.SetupTilesForSplitter(),Context.redirect_auth_url=n.AAD.AuthURL,Context.federated_domain=n.AAD.DomainName,users[0].authUrl=n.AAD.AuthURL;case t.AAD_MANAGED_AND_MSA_EXISTS:Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START),$("#cred_cancel_button").show(),EmailDiscovery.ShowSplitter();break;case t.AAD_FEDERATED_AND_MSA_THROTTLED:case t.AAD_FEDERATED_AND_MSA_TIMED_OUT:EmailDiscovery.SetupTilesForSplitter(),Context.redirect_auth_url=n.AAD.AuthURL,Context.federated_domain=n.AAD.DomainName,users[0].authUrl=n.AAD.AuthURL,Context.email_discovery_timeout_occurred=!0,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START),EmailDiscovery.ShowSplitter();break;case t.AAD_MANAGED_AND_MSA_THROTTLED:case t.AAD_MANAGED_AND_MSA_TIMED_OUT:Context.email_discovery_timeout_occurred=!0,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START),EmailDiscovery.ShowSplitter();
break;case t.AAD_TIMED_OUT_AND_MSA_THROTTLED:case t.AAD_TIMED_OUT_AND_MSA_TIMED_OUT:case t.AAD_UNKNOWN_AND_MSA_THROTTLED:case t.AAD_UNKNOWN_AND_MSA_TIMED_OUT:case t.AAD_TIMED_OUT_AND_MSA_NOT_EXIST:case t.ERROR:Constants.SHOULD_HIDE_SIGNUP||$("#create_msa_account_container").show();case t.AAD_TIMED_OUT_AND_MSA_EXISTS:default:Context.email_discovery_timeout_occurred=!0,Context.email_discovery_use_msa_api?Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START):EmailDiscovery.IsTilesModeActivated()&&Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_FALLBACK_TO_TILES),EmailDiscovery.ShowSplitter()}Context.email_discovery_easi_user&&(Instrument.possible_easi_user=1)},ReceiveHomeRealmError:function(e,t){"abort"==t?(EmailDiscovery.HideLookingForAccountLayout(),EmailDiscovery.ShowEmailDiscovery()):(Context.back_action_stack.RemoveLastCancelAction(),EmailDiscovery.HandleTimeoutHomeRealmInfo())},HandleTimeoutHomeRealmInfo:function(){Context.email_discovery_response=null,Context.email_discovery_timeout_occurred=!0,Context.username_state.home_realm_state=Constants.State.INVALID,EmailDiscovery.HideLookingForAccountLayout(),EmailDiscovery.PerformUIAction(Constants.EmailDiscoveryAccountState.ERROR)},ShowEmailDiscovery:function(e){if(Context.email_discovery_workflow_state!==EmailDiscovery.WorkflowStates.INIT){if(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.INIT,!Context.email_discovery_use_msa_api)return EmailDiscovery.HideEmailDiscovery(),EmailDiscovery.HandleTimeoutHomeRealmInfo(),void EmailDiscovery.ShowSplitter();var t=!1;Support.hideClientErrorMessages(),Support.hideClientMessages(),Context.username_state.home_realm_state=Constants.State.NONE,Context.username_state.last_checked_email=Context.username_state.last_checked_email||"",void 0==e?Support.showClientMessage(30136):(Support.showClientError(e),30146===e&&(t=!0)),Constants.IS_HOLOGRAPHIC&&$("#cred_userid_container ."+e).length>0&&Util.OnBack(),$("#forget_tile_container").hide(),$("#cred_userid_container").show(),$("#cred_userid_inputtext").show(),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$(".login_cred_options_container").addClass("email_discovery"),$("#cred_userid_inputtext").focus(),t?($("#cred_try_again_button").show(),$("#cred_continue_button").hide()):($("#cred_continue_button").show(),$("#cred_try_again_button").hide()),$("#cred_password_container").hide(),$("#recover_container").hide(),$("#cred_kmsi_container").hide(),$("#switch_user_container").hide(),$("#alternative-identity-providers").hide()}},HideEmailDiscovery:function(){$("#cred_userid_container").hide(),$("#cred_continue_button").hide(),$("#cred_cancel_button").hide(),$("#cred_try_again_button").hide(),$("#create_msa_account_container").hide(),Support.hideClientErrorMessages(),Support.hideClientMessages(),Context.username_state.enable_redirect=!1,Context.username_state.enable_guests=!1,User.UsernameOnChangeHandler()},BackToUserTiles:function(){EmailDiscovery.HideEmailDiscovery(),Context.email_discovery_mode=!1,EmailDiscovery.RevertUserTiles(),Tiles.drawUsers(),$("#tiles_cta_text").show(),$(".login_cred_options_container").removeClass("email_discovery"),$("#create_msa_account_container").hide(),Context.username_state.home_realm_state=Constants.State.NONE,Tiles.CancelTileRedirect()},ShowLookingForAccountLayout:function(){Context.email_discovery_workflow_state!=EmailDiscovery.WorkflowStates.LOOKING&&(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.LOOKING,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_LOOKING_FOR_ACCOUNT_TO_EMAILDISCOVERY_START),$("#looking_container").show(),$("a#looking_cancel_link").focus(),$("div.progress").css("visibility","visible"),User.startAnimation(),Context.animationTid=setInterval(User.startAnimation,3500))},HideLookingForAccountLayout:function(){$("#looking_container").hide(),$("div.progress").css("visibility","hidden"),clearInterval(Context.animationTid)},CancelLookingForAccount:function(){Context.email_discovery_lookup_xhr.abort()},ShowSplitter:function(){if(Context.email_discovery_workflow_state!==EmailDiscovery.WorkflowStates.SPLITTER)if(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.SPLITTER,Context.email_discovery_splitter_shown=!0,EmailDiscovery.SetupTilesForSplitter(),$(".login_cta_container").show(),$("#login_user_chooser").show(),Tiles.drawUsers(),$("#disambig-container").show(),Context.back_action_stack.DoesCancelActionExist()&&$("#cred_cancel_button").show(),Context.email_discovery_use_msa_api)if($(".login_cred_options_container").css("display","block"),Context.email_discovery_timeout_occurred)Support.showClientMessage(30140);else{var e=$("input#cred_userid_inputtext").val().toLowerCase();e=$.trim(e);var t=Constants.TokenizedStringMsgs.UPN_DISAMBIGUATE_MESSAGE.replace("{0}",e);$("#upn_needs_disambiguation_text").text(t),Support.showClientMessage(30139)}else EmailDiscovery.IsTilesModeActivated()||$(".login_cred_options_container").removeClass("email_discovery"),$(".login_cred_options_container").css("display","block"),$("#create_msa_account_container").show(),Support.showClientMessage(30173)},HideSplitter:function(){$("#cred_cancel_button").hide(),$("#login_user_chooser").empty(),$(".login_user_chooser").hide(),$("#login_user_chooser").hide(),$("#disambig-container").hide(),$("#create_msa_account_container").hide(),Support.hideClientErrorMessages(),Support.hideClientMessages()},BackSplitter:function(){EmailDiscovery.HideSplitter(),EmailDiscovery.ShowEmailDiscovery()},LoginMSOAccount:function(){if(Context.email_discovery_workflow_state!=EmailDiscovery.WorkflowStates.MSA){Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.MSA;var e={DomainName:Constants.MSA_DOMAIN,AuthURL:Constants.MSA_AUTH_URL};EmailDiscovery.HideSplitter(),EmailDiscovery.InitRedirect(),User.ReceiveFederatedDomain(e)}},LoginAADAccount:function(){Context.email_discovery_workflow_state!=EmailDiscovery.WorkflowStates.AAD&&(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.AAD,EmailDiscovery.HideSplitter(),!Context.email_discovery_use_msa_api||(Context.email_discovery_timeout_occurred||null==Context.email_discovery_response)&&Context.username_state.home_realm_state==Constants.State.INVALID?(EmailDiscovery.ShowAADLoginLayout(),Context.username_state.home_realm_state=Constants.State.NONE,$("#cred_userid_inputtext").focus()):Context.username_state.home_realm_state==Constants.State.FEDERATED?(Context.email_discovery_timeout_occurred&&!Util.isMSA(Context.email_discovery_response.AAD.AuthURL)&&(Context.email_discovery_easi_user=!1),EmailDiscovery.InitRedirect(),User.ReceiveFederatedDomain(Context.email_discovery_response.AAD)):(EmailDiscovery.ShowAADLoginLayout(),User.ReceiveManagedDomain(Context.email_discovery_response.AAD),$("#cred_password_inputtext").focus()))},InitRedirect:function(){$("input#cred_userid_inputtext").hide(),$("#cred_userid_container").show(),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$("#cred_kmsi_container").show(),$("#cred_keep_me_signed_in_checkbox").show(),Context.back_action_stack.AddAction(Context.email_discovery_splitter_shown?Constants.CancelAction.FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_SPLITTER:Constants.CancelAction.FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_START),$("div.progress").css("visibility","visible"),$(".login_cred_options_container").removeClass("email_discovery"),User.startAnimation(),Context.animationTid=setInterval(User.startAnimation,3500)},ShowAADLoginLayout:function(){Context.email_discovery_mode=!1,Context.back_action_stack.AddAction(Context.email_discovery_splitter_shown?Constants.CancelAction.FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_SPLITTER:Constants.CancelAction.FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_START),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$(".login_cred_options_container").removeClass("email_discovery"),$("#cred_userid_inputtext").show(),$("#cred_password_inputtext").show(),$("#cred_userid_container").show(),$("#cred_sign_in_button").show(),$("#cred_kmsi_container").show(),$("#recover_container").show(),$("#cred_password_container").show(),$("#login_cta_text").show(),$("#cred_cancel_button").show(),TenantBranding.setUserIdHintAndKmsi()},HideAADLoginLayout:function(){Context.email_discovery_mode=!0,TenantBranding.RemoveTenantBrandingAndApplyWorkload(),$(".login_cred_options_container").addClass("email_discovery"),$("#cred_password_inputtext").val(""),$("#cred_sign_in_button").hide(),$("#cred_kmsi_container").hide(),$("#recover_container").hide(),$("#cred_password_container").hide(),$("#login_cta_text").hide(),$("#cred_cancel_button").hide()},CancelRedirect:function(){clearTimeout(Context.redirectTid),Context.username_state.home_realm_state=Constants.State.NONE,$("div.progress").css("visibility","hidden"),clearInterval(Context.animationTid),$("#redirect_message_container").hide(),$("#cred_sign_in_button").hide(),$("#redirect_cta_text").hide(),$("#redirect_company_name_text").empty(),$("#cred_kmsi_container").hide(),$(".login_cred_options_container").addClass("email_discovery"),$("#redirect_message_container").css("opacity",0),$("#redirect_message_container").addClass("hidden"),$("#redirect_message_container").addClass("no_display"),Context.email_discovery_mode=!0},GetEnumKeyName:function(e,t){for(var n in e)if(e[n]==t)return n;return null}};var EmailDiscovery=MSLogin.EmailDiscovery;$(document).ready(function(){EmailDiscovery.Initialize()});var origHide=jQuery.fn.hide;jQuery.fn.hide=function(e,t){if(e){var n=this;origHide.apply(this,[e,function(){try{n.attr("aria-hidden","true")}catch(e){}t&&t.call(n)}])}else{origHide.apply(this,arguments);try{this.attr("aria-hidden","true")}catch(o){}}return this};var origShow=jQuery.fn.show;jQuery.fn.show=function(e,t){if(e){var n=this;origShow.apply(this,[e,function(){try{n.removeAttr("aria-hidden")}catch(e){}t&&t.call(n)}])}else{origShow.apply(this,arguments);try{this.removeAttr("aria-hidden")}catch(o){}}return this};var origAddClass=jQuery.fn.addClass;jQuery.fn.addClass=function(e){if("no_display"==e||"hidden"==e)try{this.attr("aria-hidden","true")}catch(t){}return origAddClass.apply(this,arguments),this};var origRemoveClass=jQuery.fn.removeClass;jQuery.fn.removeClass=function(e){if("no_display"==e||"hidden"==e)try{this.removeAttr("aria-hidden","true")}catch(t){}return origRemoveClass.apply(this,arguments),this},MSLogin.Support={clientErrorStrings:{},are_cookies_enabled:function(){var e=navigator.cookieEnabled?!0:!1;return"undefined"!=typeof navigator.cookieEnabled||e||(document.cookie="testcookie",e=-1!=document.cookie.indexOf("testcookie")?!0:!1),e},is_placeholder_supported:function(){if($.browser.msie){var e=document.documentMode;if(12>e)return!1}if(navigator.userAgent.indexOf("rv:11.0")>=0)return!1;var t=document.createElement("input");return"placeholder"in t},is_prefetch_supported:function(){return navigator.userAgent.match(/iPad/)?!1:!0},showClientError:function(e){var t=!1,n=[];if(0==e)$("#cta_error_message_text").hide(),$("#login_cta_text").hide(),$("#cta_client_error_text").hide(),$("#login_cta_text").show(),$("#create_msa_account_container").removeClass("no-display"),Constants.IS_HOLOGRAPHIC&&($(".footer_inner_container").show(),$("#cred_user_error_messages div.client_error_msg").hide());else{if($(".client_error_msg").each(function(){$(this).hide(),$("#"+$(this).data("elementid")).removeClass("inputState_error")}),$("#cta_error_message_text").hide(),$("#login_cta_text").hide(),Constants.IS_HOLOGRAPHIC&&$(".footer_inner_container").hide(),$("#cta_client_error_text").show(),arguments.length>1){n=new Array(arguments.length-1);for(var o=0;o<n.length;o++)n[o]=arguments[o+1]}$(".client_error_msg."+e).each(function(){n.length>=1&&(Support.clientErrorStrings[e]||(Support.clientErrorStrings[e]=$(this).html()),$(this).html(Support.clientErrorStrings[e].format(n))),$(this).show();var o=$("#"+$(this).data("elementid"));o.addClass("inputState_error"),o.length>0&&(o[o.length-1].focus(),t=!0)})}return t},hideClientError:function(e){$(".client_error_msg."+e).hide(),$("#login_cta_text").show(),$("#create_msa_account_container").removeClass("no-display")},hideClientErrorMessages:function(){$("#cta_error_message_text").hide(),$("#login_cta_text").hide(),$("#cta_client_error_text").hide(),$(".client_error_msg").hide(),$("#cta_error_message_text").hide(),$("#login_cta_text").show(),$("#create_msa_account_container").removeClass("no-display")},showClientMessage:function(e){$(".cta_message_text").hide(),$("#cta_client_message_text").show(),$(".cta_message_text."+e).show()},hideClientMessages:function(){$(".cta_message_text").hide(),$("#cta_client_message_text").hide()},showUsernameOrDomainError:function(e){var t;return t=Constants.IS_MSA_FED_SUPPORTED?Support.showClientError(30065,e):Support.showClientError(30068,e.substring(e.lastIndexOf("@")+1))},validateUsernameCredInput:function(e){var t=MSLogin.Constants;return Constants.IS_MSA_PHONE_USERNAME_SUPPORTED&&t&&t.REGEX_EMAIL&&t.REGEX_PHONE?t.REGEX_EMAIL.test(e)||t.REGEX_PHONE.test(e):t.REGEX_EMAIL.test(e)},validateCredInputs:function(){var e=Support.validateUsernameInput();0===e&&(e=Support.validatePassword());var t=!1;return Constants.IS_HOLOGRAPHIC||(t=Support.showClientError(e)),e?(Constants.IS_HOLOGRAPHIC||t||(void 0!=$("input#cred_userid_inputtext").css("display")&&"none"!=$("input#cred_userid_inputtext").css("display")&&""!=$("input#cred_password_inputtext").val()?$("input#cred_userid_inputtext").focus():$("input#cred_password_inputtext").focus()),!1):!0},validatePassword:function(){var e=$("input#cred_password_inputtext").val(),t=0;return""==e&&(t=30111,MSLogin.Util.LogCxhTelemetry("AADLoginPageClientError",t),Constants.IS_HOLOGRAPHIC||$("input#cred_password_inputtext").focus()),Constants.IS_HOLOGRAPHIC&&Support.showClientError(t),t},validateUsernameInput:function(){var e=$("input#cred_userid_inputtext").val(),t=30067;return e=e.toLowerCase(),""==e?t=30067:Constants.IS_NAME_COEXISTENCE_ACCOUNT||Support.validateUsernameCredInput(e)?t=0:(t=30064,null!=e&&-1!=e.indexOf("\\")&&(t=30066)),Constants.IS_HOLOGRAPHIC&&Support.showClientError(t),t&&MSLogin.Util.LogCxhTelemetry("AADLoginPageClientError",t),t},isUXFeatureEnabled:function(e){var t=!1,n=parseInt(Util.ExtractQSParam("msoptin-newui"));return e&Constants.FEATURE_SLOT_MASK&&(t=!0),e&n&&(t=!0),!t||e&Constants.FEATURE_SLOT_THRESHOLD||(t=!1),t},forceCredBlockHeight:function(){},renderBrowserSpecificForNarrowWidth:function(e){User.resize_bg(),Background.winW<Constants.MOBILE_WIDTH_THRESHOLD&&($.browser.msie&&e>=8&&$(".push").css("height","2em"),$.browser.msie&&7>=e&&($(".login_panel").css("padding-left","0px"),$(".login_cred_field_container").css("margin-left","0px"),$("input#cred_userid_inputtext").css("margin-left","15px"),$("input#cred_password_inputtext").css("margin-left","15px")),$.browser.msie&&6>=e&&$(".login_panel").css("padding-left","50px"))},renderBrowserSpecificForNarrowHeight:function(){if(User.resize_bg(),Background.winH<Constants.MOBILE_HEIGHT_THRESHOLD||Support.isUXFeatureEnabled(512)&&"1"==Util.ExtractQSParam("popupui")){var e=!0;navigator.userAgent.match(/IEMobile/)&&(e=!1),navigator.userAgent.match(/Android/)&&(e=!1),navigator.userAgent.match(/iPhone/)&&(e=!1),navigator.userAgent.match(/iPad/)&&(e=!1),e?$("#footer_links_container").addClass("sticky_footer"):$("#footer_links_container").removeClass("sticky_footer")}},renderBrowserSpecific:function(){var e=document.documentMode;if($.browser.msie&&e>=8&&($(".push").css("display","inline-block"),$(".push").css("height","6em")),(navigator.userAgent.match(/iPad/)||navigator.userAgent.match(/iPhone/))&&(Support.forceCredBlockHeight(),$(".cred").css("margin-bottom","-3em"),$(".login_guest_container").css("margin-bottom","0px")),$.browser.msie&&e>8&&$(".show_other").css("margin-left","-5px"),$.browser.msie&&7>=e&&($(".ie_legacy").css("display","none"),$("body").css("background-color",$("html").css("background-color")),$("a.tile_link").css("margin-left","0px"),$("table.user_tile").css("margin-left","0px"),$("table.user_tile").css("margin-bottom","10px"),$(".show_other").css("margin-left","0px")),$.browser.msie&&6>=e&&$("body").css("overflow-y","hidden"),$.browser.mozilla&&$(".input_border").addClass("high_contrast_border"),navigator.userAgent.match(/IEMobile/),navigator.userAgent.match(/Android 2\.3/)&&("optin.2.0"!=$("meta[name=PageID]").attr("content")&&$("body").css("font-size","0.5em"),$(".login_footer_container").css("margin-top","-12em"),$(".login_guest_container").css("padding-top","0px"),$(".cred").css("padding-bottom","10em"),Support.forceCredBlockHeight()),navigator.userAgent.match(/Android/)&&$("body").css("height","100vh"),$.browser.msie&&10==e){$(".cred").css("padding-bottom","100px");var t=$(window).height()-$(".login_footer_container").height()+30;$("#login_panel_center").css("height",t+"px"),document.body.onresize=function(){var e=$(window).height()-$(".login_footer_container").height()+30;$("#login_panel_center").css("height",e+"px")}}if($.browser.webkit&&$("form :input").blur(function(){User.resize_bg()}),Support.renderBrowserSpecificForNarrowWidth(e),Support.renderBrowserSpecificForNarrowHeight(e),$.browser.msie&&document.documentMode<11){$(".cred").css("padding-bottom","0px");var n=function(){var e=$(window).height()-$("#true_inner").height()-$(".push").height()-60;$("#login_panel_center").css("height",e>0?$(window).height()-15:"")};document.body.onresize=n,n()}},getViewport:function(){var e,t;return"undefined"!=typeof window.innerWidth?(e=window.innerWidth,t=window.innerHeight):"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&0!=document.documentElement.clientWidth?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):(e=document.getElementsByTagName("body")[0].clientWidth,t=document.getElementsByTagName("body")[0].clientHeight),[e,t]},showIllustration:function(){var e=Support.getViewport(),t=!0;return Background.winW<Constants.MOBILE_WIDTH_THRESHOLD?t=!1:e[0]<Constants.MOBILE_WIDTH_THRESHOLD?t=!1:navigator.userAgent.match(/IEMobile/)?t=!1:navigator.userAgent.match(/Android 2\.3/)?t=!1:Support.isUXFeatureEnabled(512)&&"1"==Util.ExtractQSParam("popupui")&&(t=!1),t},showTileTooltips:function(){var e=!0;return navigator.userAgent.match(/iPad/)?e=!1:navigator.userAgent.match(/iPhone/)&&(e=!1),e},isDefined:function(e){return null!=e&&void 0!=e&&(e.length>0||"object"==typeof e||"boolean"==typeof e||"number"==typeof e)},getDomain:function(e){var t=$.trim(e),n=function(e){return-1!=e.indexOf("@")&&e.indexOf("@")<e.length},o=function(e){return Support.isDefined(e)&&n(e)};if(o(t)){var i=e.substring(t.indexOf("@")+1);if(i.length>0)return i}return null},checkIfDomainsMatch:function(e,t){var n=Support.getDomain(e),o=Support.getDomain(t);return null!=n&&null!=o?n.toLowerCase()==o.toLowerCase():!1},GetOriginalPasswordResetLinkUrl:function(){var e=Context.password_reset_link_url;if(!Support.isDefined(e)){var t=$("a#cred_forgot_password_link");Support.isDefined(t)&&Support.isDefined(t.attr("href"))&&(e=t.attr("href")),Support.isDefined(e)?Context.password_reset_link_url=e:e=null}return e},UpdatePasswordResetLink:function(){var e=$("a#cred_forgot_password_link"),t=Support.GetOriginalPasswordResetLinkUrl();if(Support.isDefined(e)&&Support.isDefined(t)){var n=decodeURIComponent(Util.ExtractQSParam("whr")),o=$("input#cred_userid_inputtext").val();-1==t.indexOf("?")&&(t+="?"),Support.isDefined(n)&&(t+="&whr="+encodeURIComponent(n)),Support.isDefined(o)&&(t+="&username="+encodeURIComponent(o)),e.attr("href",t)}},IsBrowserVersionGreaterOrEqual:function(e,t){if("*"==t)return!0;if(!Support.isDefined(e)||!Support.isDefined(t))return!1;for(var n=e.split("."),o=t.split("."),i=!1,a=0;a<o.length;a++){var r=parseInt(n[a]),s=parseInt(o[a]);if(isNaN(r)||isNaN(s))return!1;if(s>r)return!1;if(r>s)return!0;i=!0}return i},ViewErrorDetails:function(){$(".view-error-details-title").toggleClass("no_display"),$(".view-error-details-content").toggleClass("no_display")},IForgotMyPassword:function(){$(".i-forgot-my-password-content").toggleClass("no_display")},LegalActionLink:function(e){$.ajax({url:e,data:{IsAjax:!0},success:function(e){$(".login_panel_layout").hide(),$(".legal_container").html(e).show(),$("#legal-back-button").click(function(){$(".legal_container").hide(),$(".login_panel_layout").show()})},error:function(){}})}};var Support=MSLogin.Support;jQuery.support.placeholder=function(){return Support.is_placeholder_supported()}(),jQuery.support.cookies=function(){var e=navigator.cookieEnabled?!0:!1;return"undefined"!=typeof navigator.cookieEnabled||e||(document.cookie="testcookie",e=-1!=document.cookie.indexOf("testcookie")?!0:!1),e}();var MSLogout={logoutstate:null,success:[],error:[],noOfIncompleteSites:0,thirdPartyCookieEnabled:-1,showSignOutInfo:function(){MSLogout.checkThirdPartyCookies(),$.each(MSLogout.logoutstate.sites,function(e,t){MSLogout.checkSiteCookies(t)})},checkThirdPartyCookies:function(){void 0!=MSLogout.logoutstate.thirdPartyCookieURL&&$("<img/>").attr("src",MSLogout.logoutstate.thirdPartyCookieURL).load(function(){MSLogout.thirdPartyCookieEnabled=ThirdPartyCookieStates.ENABLED}).error(function(){MSLogout.thirdPartyCookieEnabled=ThirdPartyCookieStates.DISABLED}()).addClass("hidden")},checkSiteCookies:function(e){var e=e;MSLogout.noOfIncompleteSites++;var t=$("<img/>").attr("src",e.url).load(function(){var t=e;return function(){MSLogout.noOfIncompleteSites--,MSLogout.success.push(t)}}()).error(function(){var t=e;return function(){MSLogout.noOfIncompleteSites--,MSLogout.error.push(t)}}()).addClass("hidden");$("body").append(t)},displaySiteList:function(){if(MSLogout.thirdPartyCookieEnabled!=ThirdPartyCookieStates.NOT_LOADED&&0==MSLogout.noOfIncompleteSites){$(".signed_out_sites").show(),$("#more_info_text").hide();var e="#success_signed_out_sites";MSLogout.thirdPartyCookieEnabled==ThirdPartyCookieStates.DISABLED&&(e="#error_signed_out_sites"),$.each(MSLogout.success,function(t,n){$(e).append($("<div/>").attr("id","site_"+n.id).text(n.name+" ("+n.id+")"))}),$.each(MSLogout.error,function(e,t){$("#error_signed_out_sites").append($("<div/>").attr("id","site_"+t.id).text(t.name+" ("+t.id+")"))}),MSLogout.displaySAMLList()}},displaySAMLList:function(){var e,t=MSLogout.logoutstate.samlNamespace;if(void 0!=t){e=t.status?"#success_signed_out_sites":"#error_signed_out_sites";var n=$("<div/>").html(t.name).text();$(e).append($("<div/>").attr("id","site_saml").text(n+" ("+t.domain+")"))}}};MSLogout.ThirdPartyCookieStates={NOT_LOADED:-1,DISABLED:0,ENABLED:1};var ThirdPartyCookieStates=MSLogout.ThirdPartyCookieStates,PostType={INVALID:"0",PASSWORD:"11",FEDERATION:"13",SHA1_PASSWORD:"15",SHA1HASH_PASSWORD:"16"},LoginOption={EMPTY:"0",REMEMBER_PASSWORD:"1",REMEMBER_USER_TILE:"2",NOTHING_CHECKED:"3",OTHER_SAVED_USERS:"4",ACTIVE_USER:"5"};MSLogin.Post={DetermineBrowser:function(){return $.browser.msie?"MSIE":$.browser.chrome?"Chrome":$.browser.webkit?"Webkit":$.browser.safari?"Safari":$.browser.mozilla?"Firefox":$.browser.opera?"Opera":"Unknown"},IsSubmitReady:function(){switch(Context.username_state.home_realm_state){case Constants.State.FEDERATED:return!1;case Constants.State.MANAGED:break;case Constants.State.INVALID:break;case Constants.State.NONE:if(User.UpdateUsernameState(),!Context.username_state.is_empty&&!Context.username_state.is_partial&&!Constants.IS_NAME_COEXISTENCE_ACCOUNT)return User.RefreshDomainState(),!1;break;default:return!1}if(!Support.validateCredInputs())return!1;var e=$("input#cred_userid_inputtext").val(),t=$("input#cred_password_inputtext").val();return""==e&&""==t?!0:!0},GetCredParameters:function(e){var t=[];if(Context.use_instrumentation&&e)try{var n=new Date,o=n.getTime()-n.getMilliseconds()-12e4,i=window.performance.timing;t.push({name:"n1",value:i.navigationStart-o}),t.push({name:"n2",value:i.redirectStart-o}),t.push({name:"n3",value:i.redirectEnd-o}),t.push({name:"n4",value:i.fetchStart-o}),t.push({name:"n5",value:i.domainLookupStart-o}),t.push({name:"n6",value:i.domainLookupEnd-o}),t.push({name:"n7",value:i.connectStart-o}),t.push({name:"n8",value:i.secureConnectionStart-o}),t.push({name:"n9",value:i.connectEnd-o}),t.push({name:"n10",value:i.requestStart-o}),t.push({name:"n11",value:i.responseStart-o}),t.push({name:"n12",value:i.responseEnd-o}),t.push({name:"n13",value:i.domLoading-o}),t.push({name:"n14",value:i.domInteractive-o}),t.push({name:"n15",value:i.domContentLoadedEventEnd-i.domContentLoadedEventStart}),t.push({name:"n16",value:i.domComplete-o}),t.push({name:"n17",value:i.loadEventStart-o}),t.push({name:"n18",value:i.loadEventEnd-o}),t.push({name:"n19",value:Instrument.home_realm_load_time}),t.push({name:"n20",value:Instrument.latency_sensitivity}),t.push({name:"n21",value:Instrument.prefetch_done?1:0}),t.push({name:"n22",value:Instrument.prefetch_load_time}),t.push({name:"n23",value:Instrument.background_image_loaded?1:0}),t.push({name:"n24",value:Instrument.background_image_load_time}),t.push({name:"n25",value:null!=Tiles.users?Tiles.users.length-1:0}),t.push({name:"n26",value:Instrument.email_discovery_ui_code}),t.push({name:"n27",value:Instrument.email_discovery_splitter_choice}),t.push({name:"n28",value:Instrument.possible_easi_user}),t.push({name:"n29",value:Instrument.tenant_branding_process_end_time-Instrument.tenant_branding_start_time}),t.push({name:"n30",value:Instrument.tenant_branding_json_end_time-Instrument.tenant_branding_start_time}),t.push({name:"n31",value:Instrument.tenant_branding_load_error?1:0}),t.push({name:"n32",value:Instrument.has_tenant_branding?1:0}),t.push({name:"n33",value:Instrument.has_dynamic_tenant_branding?1:0}),t.push({name:"n34",value:Instrument.logo_image_load_time}),t.push({name:"n35",value:Instrument.background_image_error?1:0}),t.push({name:"n36",value:Instrument.logo_image_error?1:0}),t.push({name:"n37",value:Instrument.tenant_branding_total_time}),t.push({name:"n38",value:Instrument.tenant_branding_number_of_switches}),t.push({name:"n39",value:Instrument.tenant_branding_right_side_time}),t.push({name:"n40",value:Instrument.logo_image_end_time}),t.push({name:"n41",value:Instrument.background_image_end_time}),t.push({name:"n42",value:Instrument.document_ready_end_time}),t.push({name:"n43",value:Instrument.document_load_end_time})}catch(a){}t.push({name:"type",value:PostType.PASSWORD}),t.push($("#cred_keep_me_signed_in_checkbox").attr("checked")?{name:"LoginOptions",value:LoginOption.REMEMBER_PASSWORD}:Support.isUXFeatureEnabled(4096)&&EmailDiscovery.IsDiscoveryPage()||Context.post_from_tile?{name:"LoginOptions",value:LoginOption.REMEMBER_USER_TILE}:{name:"LoginOptions",value:LoginOption.NOTHING_CHECKED}),t.push({name:"NewUser",value:1}),t.push({name:"idsbho",value:1}),t.push({name:"PwdPad",value:""}),t.push({name:"sso",value:""});var r=decodeURIComponent(Util.ExtractQSParam("vv"));return t.push({name:"vv",value:r}),t.push({name:"uiver",value:1}),t.push({name:"i12",value:"https:"==window.location.protocol?1:0}),t.push({name:"i13",value:Post.DetermineBrowser()}),t.push({name:"i14",value:$.browser.version}),t.push({name:"i15",value:Background.winW}),t.push({name:"i16",value:Background.winH}),t.push(Constants.IS_CXH_REQUEST?{name:"i20",value:Constants.IS_CXH_REQUEST}:{name:"i20",value:""}),Context.redirect_to_manage&&$.each(t,function(e,t){"LoginOptions"==t.name&&(t.value="1"+t.value)}),t},SubmitCreds:function(){if(Post.IsSubmitReady()){$("#cred_password_inputtext").focus();var e=[];if(e=Post.GetCredParameters(Constants.SUBMIT_METRICS_ON_POST),Constants.IS_CXH_REQUEST&&Constants.CxhFlow&&Constants.CxhFlow.toUpperCase().startsWith("FRX")&&"undefined"!=typeof CloudExperienceHost&&"undefined"!=typeof CloudExperienceHost.Bridge)try{var t=new CloudExperienceHost.Bridge;t.invoke("CloudExperienceHost.Storage.SharableData.addValue","oobe-username",$("input#cred_userid_inputtext").val()),Constants.EncryptOOBEPassword?t.invoke("CloudExperienceHost.MSA.encryptUserData",$("input#cred_password_inputtext").val()).done(function(e){t.invoke("CloudExperienceHost.Storage.PrivateData.addItem","oobe-password",e)},function(){t.invoke("CloudExperienceHost.Storage.SharableData.addValue","oobe-password",$("input#cred_password_inputtext").val())}):t.invoke("CloudExperienceHost.Storage.SharableData.addValue","oobe-password",$("input#cred_password_inputtext").val()),e.push({name:"i21",value:""})}catch(n){e.push({name:"i21",value:n.message})}var o=[];$.each(e,function(e,t){-1===$.inArray(t.name,o)&&void 0!=t.value&&($("<input />").attr("type","hidden").attr("name",t.name).attr("value",t.value).appendTo("#credentials"),o.push(t.name))}),$("form#credentials").submit()}},SubmitInstrumentation:function(){var e=[];e=Post.GetCredParameters(Constants.SUBMIT_METRICS_ON_REDIRECT),e.login="federated",e.passwd="",e.LoginOptions=LoginOption.NOTHING_CHECKED;var t={};$.each(e,function(e,n){void 0!=n.value&&(t[n.name]=n.value)}),$.ajax({headers:{Accept:"application/json"},url:$("#credentials").attr("action")+"&clientMetrics&federatedDomain="+Context.federated_domain,type:"POST",dataType:"json",data:t,async:!0,timeout:200})}};var Post=MSLogin.Post;MSStrongAuth={appendQPToURL:function(){if(0!=$("#switch_user_link").length){var e=$("#switch_user_link").attr("href"),t=/^\d+$/,n=/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/;e=Util.AddQSParamIfNotExists(e,"id",t),e=Util.AddQSParamIfNotExists(e,"lc",t),e=Util.AddQSParamIfNotExists(e,"username",n),e=Util.AddQSParamIfNotExists(e,"ru"),e=Util.AddQSParamIfNotExists(e,"whr"),e=Util.AddQSParamIfNotExists(e,"wreply"),e=Util.AddQSParamIfNotExists(e,"wauth"),$("#switch_user_link").attr("href",e)}}},MSStrongAuth.ProofUp={doSubmit:function(){var e=$("#fmProofup").attr("action"),t=-1==e.indexOf("?")?"?":"&";$("#login_workload_logo_image").length>0&&($("#login_workload_logo_image").attr("src").toLowerCase().indexOf("office365")>=0?$("#fmProofup").attr("action",e+t+"BrandContextID=O365"):$("#login_workload_logo_image").attr("src").toLowerCase().indexOf("/azure/logo.png")>=0&&$("#fmProofup").attr("action",e+t+"BrandContextID=Azure")),document.fmProofup.submit()}};var ProofUp=MSStrongAuth.ProofUp;MSStrongAuth.StrongAuthCheck={currentPoll:0,intervalId:0,enablePolling:1,authMethods:null,currentAuthMethod:null,currentAuthMethodId:"",authInProgress:0,endAuthInProgress:0,xhr:0,pollIntervalId:0,areValidMethodsPresent:function(e){if(null==e||0==e.length)return!1;for(i=0;i<e.length;i++)if(null!=e[i].AuthMethodDeviceId&&""!=e[i].AuthMethodDeviceId)return!0;return!1},initAuthMethods:function(){$("#redirect_dots_animation").show(),$("#redirect_dots_animation").css("visibility","visible"),User.setupCredFieldsWithPlaceHolder(),setTimeout(User.startAnimation,0),StrongAuthCheck.intervalId=setInterval(User.startAnimation,Constants.TWOFA_ANIMATION_INTERVAL),StrongAuthCheck.authInProgress=1,StrongAuthCheck.initAuthSuccess(Constants.StrongAuth.Context)},beginAuthUsingMethod:function(e){StrongAuthCheck.currentAuthMethod=e,StrongAuthCheck.currentAuthMethodId=e.AuthMethodId,StrongAuthCheck.authInProgress=1;var t='{ "Method": "BeginAuth",  "flowToken": "'+Constants.StrongAuth.FlowToken+'",  "ctx": "'+Constants.StrongAuth.Ctx+'",  "AuthMethodId":"'+e.AuthMethodId+'"}';0==e.AuthMethodId.toUpperCase().indexOf("TWOWAYVOICE")?($(".tfa_results_text.30050").show(),$("#tfa_button_container").hide(),$("button#tfa_signin_button").prop("disabled",!0)):0==e.AuthMethodId.toUpperCase().indexOf("TWOWAYSMS")?($(".tfa_results_text.30049").show(),Constants.IS_HOLOGRAPHIC&&$("button#tfa_signin_button").prop("disabled",!0)):0==e.AuthMethodId.toUpperCase().indexOf("PHONEAPPNOTIFICATION")&&$(".tfa_results_text.30051").show(),"none"!=e.MethodDisplayString?($("#tfa_phone_text").text(e.MethodDisplayString),$("#tfa_phone_text").show(),$(".tile_secondary_name").show(),$(".tile_secondary_name").text(e.MethodDisplayString)):($("#tfa_phone_text").hide(),$(".tile_secondary_name").hide()),$("#tfa_options_link_container").show(),StrongAuthCheck.changeCredHeight(),StrongAuthCheck.beginAuth(t)
},beginAuth:function(e){StrongAuthCheck.xhr=$.ajax({headers:{Accept:"application/json"},url:Constants.StrongAuth.SASControllerBeginAuthUrl,timeout:Constants.TWOFA_TIMEOUT,data:e,dataType:"json",type:"POST",contentType:"application/json",success:StrongAuthCheck.beginAuthSuccess,error:StrongAuthCheck.showUnknownError})},checkPolling:function(e){var t='{"Method":"EndAuth",  "SessionId":"'+e.SessionId+'",  "FlowToken":"'+e.FlowToken+'",  "Ctx":"'+e.Ctx+'",  "AuthMethodId":"'+e.AuthMethodId+'"}';1==StrongAuthCheck.enablePolling&&(StrongAuthCheck.currentPoll++,Constants.TWOFA_MAX_POLLS>=StrongAuthCheck.currentPoll?StrongAuthCheck.poll(t):StrongAuthCheck.showAuthTimeoutError(e))},poll:function(e){StrongAuthCheck.pollIntervalId=setTimeout(function(){StrongAuthCheck.xhr=$.ajax({headers:{Accept:"application/json"},url:Constants.StrongAuth.SASControllerEndAuthUrl,timeout:Constants.TWOFA_TIMEOUT,data:e,dataType:"json",type:"POST",contentType:"application/json",success:StrongAuthCheck.endAuthSuccess,error:StrongAuthCheck.showUnknownError})},Constants.TWOFA_POLLING_INTERVAL)},redirect:function(){},tryRedirect:function(){},showInitError:function(e){$(".tfa_results_text").hide(),$("#redirect_dots_animation").hide(),$(".tfa_error_text.30062").show(),StrongAuthCheck.showErrorInfo(e),clearInterval(StrongAuthCheck.intervalId)},showAuthError:function(e){if(1==StrongAuthCheck.authInProgress){$("#cred_remember_mfa_container").hide();var t="30062";switch(e.ResultValue){case"UserVoiceAuthFailedCallWentToVoicemail":t="30106";break;case"UserVoiceAuthFailedInvalidPhoneInput":case"UserVoiceAuthFailedPhoneHungUp":t="30107";break;case"UserVoiceAuthFailedInvalidPhoneNumber":case"UserVoiceAuthFailedInvalidExtension":case"InvalidFormat":t="30109";break;case"UserAuthFailedDuplicateRequest":case"UserVoiceAuthFailedPhoneUnreachable":case"UserVoiceAuthFailedProviderCouldntSendCall":t="30108";break;case"User2WaySMSAuthFailedProviderCouldntSendSMS":case"SMSAuthFailedProviderCouldntSendSMS":t="30434";break;case"User2WaySMSAuthFailedNoResponseTimeout":t="30435";break;case"SMSAuthFailedNoResponseTimeout":case"SMSAuthFailedWrongCodeEntered":case"OathCodeIncorrect":case"OathCodeDuplicate":case"OathCodeOld":t="30436";break;case"PhoneAppNoResponse":t="30437";break;case"User2WaySMSAuthFailedWrongCodeEntered":t="30438";break;case"PhoneAppInvalidResult":t="30439";break;case"PhoneAppDenied":t="30440";break;case"PhoneAppTokenChanged":t="30441"}null==StrongAuthCheck.currentAuthMethod?$(".tfa_results_text").hide():0==StrongAuthCheck.currentAuthMethod.AuthMethodId.toUpperCase().indexOf("ONEWAYSMS")?$(".tfa_results_text.30167").show():0==StrongAuthCheck.currentAuthMethod.AuthMethodId.toUpperCase().indexOf("PHONEAPPOTP")?$(".tfa_results_text.30166").show():$(".tfa_results_text").hide(),$("#redirect_dots_animation").hide(),$(".tfa_error_text."+t).show(),StrongAuthCheck.showErrorInfo(e),clearInterval(StrongAuthCheck.intervalId)}},showAuthTimeoutError:function(e){1==StrongAuthCheck.authInProgress&&(null==StrongAuthCheck.currentAuthMethod?$(".tfa_results_text").hide():0==StrongAuthCheck.currentAuthMethod.AuthMethodId.toUpperCase().indexOf("ONEWAYSMS")?$(".tfa_results_text.30167").show():0==StrongAuthCheck.currentAuthMethod.AuthMethodId.toUpperCase().indexOf("PHONEAPPOTP")?$(".tfa_results_text.30166").show():$(".tfa_results_text").hide(),$("#redirect_dots_animation").hide(),$(".tfa_error_text.30442").show(),StrongAuthCheck.showErrorInfo(e),clearInterval(StrongAuthCheck.intervalId),StrongAuthCheck.endAuthInProgress=0)},showUnknownError:function(e,t){if(1==StrongAuthCheck.authInProgress){if(null==StrongAuthCheck.currentAuthMethod?$(".tfa_results_text").hide():0==StrongAuthCheck.currentAuthMethod.AuthMethodId.toUpperCase().indexOf("ONEWAYSMS")?$(".tfa_results_text.30167").show():0==StrongAuthCheck.currentAuthMethod.AuthMethodId.toUpperCase().indexOf("PHONEAPPOTP")?$(".tfa_results_text.30166").show():$(".tfa_results_text").hide(),$("#redirect_dots_animation").hide(),"timeout"==t?$(".tfa_error_text.30442").show():$(".tfa_error_text.30062").show(),clearInterval(StrongAuthCheck.intervalId),StrongAuthCheck.endAuthInProgress=0,StrongAuthCheck.currentAuthMethod&&StrongAuthCheck.currentAuthMethod.SessionId){var n=StrongAuthCheck.errTemplate.format(StrongAuthCheck.currentAuthMethod.SessionId?Util.htmlEncode(StrongAuthCheck.currentAuthMethod.SessionId):"",StrongAuthCheck.currentAuthMethod.CorrelationId?Util.htmlEncode(StrongAuthCheck.currentAuthMethod.CorrelationId):"",(new Date).toISOString());$("#tfa_error_text").html(n).show()}StrongAuthCheck.changeCredHeight()}},initAuthSuccess:function(e){if("true"==e.Result){if(StrongAuthCheck.authMethods=e,null==e.DefaultMethod)return void $(".tfa_error_text.30126").show();StrongAuthCheck.beginAuthUsingMethod(e.DefaultMethod)}},beginAuthSuccess:function(e){if("true"==e.Result){StrongAuthCheck.FlowToken=e.FlowToken,StrongAuthCheck.Ctx=e.Ctx,StrongAuthCheck.currentAuthMethod.SessionId=e.SessionId,StrongAuthCheck.currentAuthMethod.CorrelationId=e.CorrelationId;var t,n=!1;if(0==e.AuthMethodId.toUpperCase().indexOf("ONEWAYSMS")&&StrongAuthCheck.currentAuthMethodId&&0==StrongAuthCheck.currentAuthMethodId.toUpperCase().indexOf("ONEWAYSMS")?(t="30167",n=!0):0==e.AuthMethodId.toUpperCase().indexOf("PHONEAPPOTP")&&StrongAuthCheck.currentAuthMethodId&&0==StrongAuthCheck.currentAuthMethodId.toUpperCase().indexOf("PHONEAPPOTP")&&(t="30166",n=!0),n)clearInterval(StrongAuthCheck.intervalId),Constants.IS_HOLOGRAPHIC&&("options"!==Util.HoloNavigationStack[Util.HoloNavigationStack.length-1].name&&Util.HoloNavigationStack.push({name:"options",show:StrongAuthCheck.showOptions}),Util.HoloNavigationStack.push({name:"verifyCode",show:null})),$("#tfa_signin_button").show(),$("button#tfa_signin_button").prop("disabled",!1),$("input#tfa_code_inputtext").val(""),$("#redirect_dots_animation").hide(),$(".tfa_results_text").hide(),$(".tfa_results_text."+t).show(),$("#tfa_code_container").show(),$("#tfa_pin_container").length&&($("input#tfa_pin_inputtext").val(""),$("#tfa_pin_container").show(),$("input#tfa_pin_inputtext").keypress(function(e){User.KeyPressEnter(e,StrongAuthCheck.submitCode,13)})),$("#tfa_code_inputtext").focus(),$("#tfa_button_container").show(),$("input#tfa_code_inputtext").keypress(function(e){User.KeyPressEnter(e,StrongAuthCheck.submitCode,13)}),$("#tfa_signin_button").keypress(function(e){User.KeyPressEnter(e,StrongAuthCheck.submitCode,13)}),setTimeout(function(){var t=e.SessionId;if(StrongAuthCheck.currentAuthMethod.SessionId==t&&StrongAuthCheck.authInProgress&&0==$("input#tfa_code_inputtext").val().length){$(".tfa_error_text.30442").show();var n=StrongAuthCheck.errTemplate.format(StrongAuthCheck.currentAuthMethod.SessionId?Util.htmlEncode(StrongAuthCheck.currentAuthMethod.SessionId):"",StrongAuthCheck.currentAuthMethod.CorrelationId?Util.htmlEncode(StrongAuthCheck.currentAuthMethod.CorrelationId):"",(new Date).toISOString());$("#tfa_error_text").html(n).show(),StrongAuthCheck.changeCredHeight()}},Constants.TWOFA_AUTH_TIMEOUT),StrongAuthCheck.changeCredHeight();else{var o='{ "Method":"EndAuth","SessionId":"'+e.SessionId+'","FlowToken":"'+e.FlowToken+'","Ctx":"'+e.Ctx+'", "AuthMethodId":"'+e.AuthMethodId+'"}';StrongAuthCheck.currentPoll=0,StrongAuthCheck.changeCredHeight(),StrongAuthCheck.poll(o)}}else StrongAuthCheck.showAuthError(e)},endAuthSuccess:function(e){return StrongAuthCheck.currentAuthMethod.SessionId!=e.SessionId?(StrongAuthCheck.showAuthError(e),void(StrongAuthCheck.endAuthInProgress=0)):void("true"==e.Result?StrongAuthCheck.processResult(e):"true"==e.Retry?StrongAuthCheck.checkPolling(e):(StrongAuthCheck.showAuthError(e),StrongAuthCheck.endAuthInProgress=0))},processResult:function(e){if(1==StrongAuthCheck.enablePolling){var t=document.createElement("form");t.setAttribute("method","post"),t.setAttribute("action",Constants.StrongAuth.SASControllerProcessAuthUrl);var n=document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name","request"),n.setAttribute("value",e.Ctx),t.appendChild(n);var o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name","flowToken"),o.setAttribute("value",e.FlowToken),t.appendChild(o);var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","mfaAuthMethod"),i.setAttribute("value",e.AuthMethodId),t.appendChild(i);var a=$("#cred_remember_mfa_checkbox").attr("checked")?!0:!1,r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name","rememberMFA"),r.setAttribute("value",a),t.appendChild(r),document.body.appendChild(t),t.submit()}},showOptions:function(){if(StrongAuthCheck.xhr&&StrongAuthCheck.xhr.abort(),clearInterval(StrongAuthCheck.pollIntervalId),clearInterval(StrongAuthCheck.intervalId),StrongAuthCheck.enablePolling=0,StrongAuthCheck.authInProgress=0,StrongAuthCheck.currentAuthMethodId="",$("#tfa_remember_my_device_container").hide(),$("#redirect_dots_animation").hide(),$(".tfa_results_text").hide(),$("#tfa_phone_text").hide(),$("#tfa_title_text").hide(),$(".tfa_error_text").hide(),$("#tfa_options_link_container").hide(),$("#tfa_code_container").hide(),$("#tfa_pin_container").hide(),$("#tfa_button_container").hide(),$("#header_text").text(Constants.TWOFA_HEADER_TEXT_SELECTMETHOD),$("#tfa_client_side_error_text").hide(),$("#tfa_options_title_text").show(),Constants.IS_HOLOGRAPHIC){$("#tfa_back_button").addClass("no_display").parent().addClass("buttonGroup_fullWidth"),Util.HoloNavigationStack.push({name:"options",show:StrongAuthCheck.showOptions});var e=$("#tfa_options_list").empty();$.each(StrongAuthCheck.authMethods.Methods,function(t,n){null!=n.AuthMethodDeviceId&&""!=n.AuthMethodDeviceId&&t<Constants.TWOFA_MAXMETHODS&&e.append($("<option></option>").text(n.MethodDisplayString).val(t))}),e.parent().removeClass("no_display")}else $("#tfa_options_list").show(),$("button#tfa_signin_button").prop("disabled",!0),$.each(StrongAuthCheck.authMethods.Methods,function(e,t){if(null!=t.AuthMethodDeviceId&&""!=t.AuthMethodDeviceId&&e<Constants.TWOFA_MAXMETHODS){$("#link"+e).text(t.MethodDisplayString);var n="javascript:StrongAuthCheck.beginAltAuth("+e+")";$("#link"+e).attr("href",n),$("#listItem"+e).show(),$("#link_icon"+e).removeClass("voice sms device"),$("#link_icon"+e).addClass(null!=t.AuthMethodId&&-1!=t.AuthMethodId.indexOf("Voice")?"voice":null!=t.AuthMethodId&&-1!=t.AuthMethodId.indexOf("SMS")?"sms":"device")}})},beginAltAuth:function(e){$("#redirect_dots_animation").show(),$("#tfa_phone_text").show(),$("#tfa_title_text").show(),$(".tfa_error_text").show(),$("#tfa_options_link_container").show(),$(".tfa_error_text").hide(),$("#tfa_options_title_text").hide(),$("#tfa_remember_my_device_container").show(),$("#header_text").text(Constants.TWOFA_HEADER_TEXT_PROTECTACCOUNT),Constants.IS_HOLOGRAPHIC?($("#tfa_options_list").parent().addClass("no_display"),$("#tfa_back_button").removeClass("no_display").parent().removeClass("buttonGroup_fullWidth")):$("#tfa_options_list").hide(),StrongAuthCheck.enablePolling=1,StrongAuthCheck.endAuthInProgress=0,User.startAnimation(),StrongAuthCheck.intervalId=setInterval(User.startAnimation,Constants.TWOFA_ANIMATION_INTERVAL),StrongAuthCheck.beginAuthUsingMethod(StrongAuthCheck.authMethods.Methods[e])},submitCode:function(e){if($(".tfa_error_text").hide(),1!=StrongAuthCheck.endAuthInProgress){var e=$("input#tfa_code_inputtext").val();e=$.trim(e);var t="";if($("#tfa_pin_container").length&&(t=$("input#tfa_pin_inputtext").val(),t=$.trim(t)),StrongAuthCheck.validateOTPPost(e,t)){e+=t,StrongAuthCheck.endAuthInProgress=1,$("#tfa_client_side_error_text").hide();var n='{ "Method":"EndAuth", "FlowToken":"'+StrongAuthCheck.FlowToken+'", "SessionId":"'+StrongAuthCheck.currentAuthMethod.SessionId+'", "Ctx":"'+StrongAuthCheck.Ctx+'", "AuthMethodId":"'+StrongAuthCheck.currentAuthMethod.AuthMethodId+'", "AdditionalAuthData":"'+e+'"}';StrongAuthCheck.currentPoll=0,$("#redirect_dots_animation").show(),setTimeout(User.startAnimation,0),StrongAuthCheck.intervalId=setInterval(User.startAnimation,Constants.TWOFA_ANIMATION_INTERVAL),StrongAuthCheck.poll(n)}}},validateOTPPost:function(e,t){if(e.length!=Constants.TWOFA_OTP_MAX_LEN||Math.ceil(e)!=Math.floor(e)||$("#tfa_pin_container").length&&(0==t.length||Math.ceil(t)!=Math.floor(t))){$("#tfa_client_side_error_text").show();var n=StrongAuthCheck.errTemplate.format(StrongAuthCheck.currentAuthMethod.SessionId?Util.htmlEncode(StrongAuthCheck.currentAuthMethod.SessionId):"",StrongAuthCheck.currentAuthMethod.CorrelationId?Util.htmlEncode(StrongAuthCheck.currentAuthMethod.CorrelationId):"",(new Date).toISOString());return $("#tfa_error_text").html(n).show(),StrongAuthCheck.changeCredHeight(),!1}return!0},showErrorInfo:function(e){var t=StrongAuthCheck.errTemplateWithErrorCode.format(0|e.ErrCode,e.SessionId?Util.htmlEncode(e.SessionId):"",e.CorrelationId?Util.htmlEncode(e.CorrelationId):"",(new Date).toISOString());$("#tfa_error_text").html(t).show(),StrongAuthCheck.changeCredHeight()},changeCredHeight:function(){var e=$("#tfa_outer_list_container").height();$(".cred").css("min-height",e)},hideLandingPage:function(){$("#compromised_landing_container").hide(),$("#compromised_landing_action").hide(),Constants.StrongAuth&&StrongAuthCheck.startAnimationAndSendCode(),$("#tfa_signin_button").show(),$("#tfa_outer_list_container").show()},startAnimationAndSendCode:function(){setTimeout(User.startAnimation,0),StrongAuthCheck.intervalId=setInterval(User.startAnimation,Constants.TWOFA_ANIMATION_INTERVAL),StrongAuthCheck.initAuthMethods()}};var StrongAuthCheck=MSStrongAuth.StrongAuthCheck;$(window).load(function(){"strongauthcheck.2.0"==$("meta[name=PageID]").attr("content")&&($("#redirect_dots_animation").show(),$("#redirect_dots_animation").css("visibility","visible"),User.setupCredFieldsWithPlaceHolder(),Constants.HAS_LANDING_PAGE||StrongAuthCheck.startAnimationAndSendCode(),Constants.IS_HOLOGRAPHIC&&Util.HoloNavigationStack.push({name:"finalBack",show:Util.CancelCxhFlow}))}),$(document).ready(function(){("strongauthcheck.2.0"==$("meta[name=PageID]").attr("content")||"proofup.2.0"==$("meta[name=PageID]").attr("content"))&&MSStrongAuth.appendQPToURL()}),MSLogin.TenantBranding={IsDynamicBrandingEnabled:function(){return Support.isUXFeatureEnabled(32768)&&($.browser.chrome&&Support.IsBrowserVersionGreaterOrEqual($.browser.version,"42")||$.browser.webkit&&Support.IsBrowserVersionGreaterOrEqual($.browser.version,"537.4")||$.browser.mozilla&&Support.IsBrowserVersionGreaterOrEqual($.browser.version,"5.0")||$.browser.msie&&Support.IsBrowserVersionGreaterOrEqual($.browser.version,"8.0")||$.browser.msie&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("Trident")>0)?!0:!1},IsShowingDynamicBranding:function(){return TenantBranding.IsDynamicBrandingEnabled()&&Context.TenantBranding.enabled},IsShowingDynamicWorkloadBranding:function(){return TenantBranding.IsShowingDynamicBranding()&&Context.TenantBranding.workload_branding_enabled},IsShowingDynamicWhrBranding:function(){return TenantBranding.IsShowingDynamicBranding()&&Support.isDefined(Context.TenantBranding.whr_key)&&Context.TenantBranding.whr_key==Context.TenantBranding.key},HideAndRemoveSlideAnimation:function(e){e.hide(),e.removeClass("slide")},RefreshDomainState:function(e){TenantBranding.IsDynamicBrandingEnabled()&&Support.checkIfDomainsMatch(e,Context.TenantBranding.prev_user)&&Support.isDefined(Context.TenantBranding.key)&&TenantBranding.PerformDynamicBranding(TenantBranding.IsShowingDynamicWhrBranding()?Context.TenantBranding.prev_key:Context.TenantBranding.key)},RemoveAllOldElements:function(){var e=$(".workload_text_old");e.remove();var t=$(".workload_img_old");t.hide(),t.remove(),$("#boiler_plate_old").remove(),void 0!=Constants.DEFAULT_BOILERPLATE_TEXT&&Constants.DEFAULT_BOILERPLATE_TEXT.length>0&&($("#boiler_plate_header").remove(),$("#boiler_plate").remove(),TenantBranding.AddBoilerPlateText(Constants.DEFAULT_BOILERPLATE_TEXT,Constants.DEFAULT_BOILERPLATE_HEADER))},ConfigureElementsForDelayedRemoval:function(){var e=$("#background_background_image").clone();e.attr("id","background_background_image_old").removeClass("slide"),$("#background_branding_container").prepend(e),$("#background_background_image").hide(),$(".workload_img").addClass("workload_img_old").removeClass("workload_img"),$(".workload_img_text").addClass("workload_text_old").removeClass("workload_text")},ResetOnLoadContext:function(){Background.background_resized=!1,Context.TenantBranding.has_logo=!1,Context.TenantBranding.has_background_img=!1,Context.on_load_image_background_loaded=!1,Logo.logo_image_loaded=!1},ResetDynamicBrandingContext:function(){"undefined"!=typeof LoginTenantBranding&&(Context.TenantBranding.prev_obj=LoginTenantBranding,LoginTenantBranding=null),Context.TenantBranding.prev_key=Context.TenantBranding.key,Context.TenantBranding.prev_user=Context.TenantBranding.user,Context.TenantBranding.applied=!1,Context.TenantBranding.has_logo=!1,Context.TenantBranding.has_background_img=!1},BackupWorkloadBranding:function(){if(!Context.TenantBranding.workload_branding_saved&&!Context.TenantBranding.default_page){Context.TenantBranding.workload_branding_saved=!0,Context.TenantBranding.workload_branding_illustration=$("#background_background_image").clone(),Context.TenantBranding.workload_branding_illustration_alt=$("#background_background_image").attr("alt"),Context.TenantBranding.workload_branding_logo=$("#login_workload_logo_image").clone(),Context.TenantBranding.workload_branding_logo_text=$("#login_workload_logo_text").clone(),Context.TenantBranding.workload_branding_logo_alt=$("#login_workload_logo_image").attr("alt"),Context.TenantBranding.workload_branding_color=$("html").css("background-color"),Context.TenantBranding.workload_branding_footer_height=$("#footer_links_container").height(),TenantBranding.BackupElementHeights();var e=Context.TenantBranding.cred_height;Context.TenantBranding.workload_branding_height=e}},ShouldShowWhrBranding:function(){return TenantBranding.IsShowingDynamicBranding()&&Support.isDefined(Context.TenantBranding.whr_key)?Context.TenantBranding.whr_key!=Context.TenantBranding.key||TenantBranding.IsShowingDynamicWorkloadBranding():!1},RemoveTenantBrandingAndApplyWorkload:function(){TenantBranding.IsDynamicBrandingEnabled()&&(Support.hideClientMessages(),Context.TenantBranding.enabled=!0,Support.isDefined(Context.TenantBranding.whr_key)?TenantBranding.ShouldShowWhrBranding()&&TenantBranding.PerformDynamicBranding(Context.TenantBranding.whr_key):TenantBranding.IsShowingDynamicWorkloadBranding()||TenantBranding.ApplyWorkloadBranding())},RemoveWorkloadBranding:function(){TenantBranding.BackupWorkloadBranding(),TenantBranding.ConfigureElementsForDelayedRemoval(),TenantBranding.ResetOnLoadContext()},PerformDynamicBranding:function(e){if(TenantBranding.IsDynamicBrandingEnabled()&&!Constants.FORCED_SIGN_IN){if(void 0==Context.TenantBranding.store.Get(e)&&(e=null),TenantBranding.IsShowingDynamicBranding()&&null!=Context.TenantBranding.key&&Context.TenantBranding.key==e&&!TenantBranding.IsShowingDynamicWorkloadBranding())return;Instrument.tenant_branding_getuserrealm_time=Instrument.home_realm_load_time,void 0==e||null==e||null!=Context.TenantBranding.key&&!TenantBranding.IsShowingDynamicWorkloadBranding()?void 0!=e&&null!=e&&null!=Context.TenantBranding.key&&e!=Context.TenantBranding.key?(Instrument.has_dynamic_tenant_branding=!0,Instrument.tenant_branding_number_of_switches++,Context.TenantBranding.default_page=!1,Context.TenantBranding.enabled=!0,TenantBranding.ReplaceTenantBranding(e)):null==Context.TenantBranding.key||void 0!=e&&null!=e&&""!=e||(Instrument.has_dynamic_tenant_branding=!0,Instrument.tenant_branding_number_of_switches++,Context.TenantBranding.default_page=!1,Context.TenantBranding.enabled=!0,TenantBranding.ApplyWorkloadBranding()):(Context.TenantBranding.default_page=!1,Context.TenantBranding.enabled=!0,Instrument.has_dynamic_tenant_branding=!0,Instrument.tenant_branding_number_of_switches++,Util.debug_console("workload branding -> tenant branding"),TenantBranding.RemoveWorkloadBranding(),TenantBranding.GetBrandingInfo(e))}},getTenantBrandingContext:function(e,t){var n={},o=[["BannerLogo",!0,Constants.DEFAULT_LOGO],["TileLogo",!0,""],["TileDarkLogo",!0,""],["Illustration",!0,Constants.DEFAULT_ILLUSTRATION],["BackgroundColor",!1,Constants.DEFAULT_BACKGROUND_COLOR],["CompanyName",!1,""],["UserIdLabel",!1,Constants.USERNAME_HINT_TEXT],["BoilerPlateText",!1,""],["KeepMeSignedInDisabled",!1,!1]];return $.each(o,function(o,i){var a=i[0],r=i[1];n[a]=void 0!=e[t]&&void 0!=e[t][a]&&""!=e[t][a]?e[t][a]:e[0][a],(null==n[a]||void 0==n[a])&&(n[a]=i[2]),r&&(n[a]=n[a].toLowerCase())}),n},formatTenantBrandingData:function(e){var t={};return $.each(e,function(e,n){var o=n.Locale;o>=0&&(t[o]=n)}),t},processTenantBranding:function(e){null!=e&&(Instrument.has_tenant_branding=!0,e=TenantBranding.formatTenantBrandingData(e),Context.TenantBranding.info=e,Context.TenantBranding.info_context=TenantBranding.getTenantBrandingContext(e,Constants.LCID),TenantBranding.IsShowingDynamicBranding()||(TenantBranding.ShowBrandedBoilerPlate(),TenantBranding.UpdateLoginCtaText()),TenantBranding.ShowBrandedLogo(),TenantBranding.ShowBrandedIllustration(),Instrument.tenant_branding_process_end_time=Util.now())},BackupElementHeights:function(){Context.TenantBranding.footer_height_saved||(Context.TenantBranding.footer_height_saved=!0,Context.TenantBranding.footer_height=$("#footer_links_container").height()),Context.TenantBranding.cred_height_saved||(Context.TenantBranding.cred_height_saved=!0,Context.TenantBranding.cred_height=$(".cred").height())},AddBoilerPlateText:function(e,t){var n;if(Constants.IS_HOLOGRAPHIC)n=$("<label/>").attr("id","boiler_plate").text(e),$(".footer_inner_container").html(n);else{var o=$("<div/>").attr("id","boiler_plate_header").addClass("boilerplate_header").text(t);$(".boilerplate_header_location").before(o),n=$("<div/>").attr("id","boiler_plate").addClass("tinytext").text(e),$(".footer_inner_container").before(n)}},ShowBrandedBoilerPlate:function(){$("#boiler_plate").remove(),TenantBranding.BackupElementHeights(),$("#boiler_plate_header").remove();var e=Context.TenantBranding.info_context;TenantBranding.AddBoilerPlateText(e.BoilerPlateText||Constants.DEFAULT_BOILERPLATE_TEXT,null!=e.BoilerPlateText?Constants.BOILERPLATE_HEADER:Constants.DEFAULT_BOILERPLATE_HEADER),$("#boiler_plate").show(),TenantBranding.ShouldFadeInTenantBranding()&&($("#boiler_plate").removeClass("slide"),$("#boiler_plate").addClass("slide"));var t=50+$("#boiler_plate").height()+40;$(".login_inner_container").css("margin-bottom","-"+t+"px"),$(".login_footer_container").height(t),$(".push").height(t)},ShowBrandedLogo:function(){var e=Context.TenantBranding.info_context,t=Constants.IS_CXH_REQUEST?Constants.USE_DARK_TILE_LOGO?e.TileDarkLogo||e.TileLogo:e.TileLogo:e.BannerLogo;void 0!=t&&""!=t&&(t+="?ts="+Context.tenant_branding_ts),User.UpdateLogo(t,Constants.DEFAULT_LOGO_ALT),$("#login_workload_logo_text").hide()},ShowBrandedIllustration:function(){var e=Context.TenantBranding.info_context,t=e.Illustration;void 0!=t&&""!=t&&(t+="?ts="+Context.tenant_branding_ts),User.UpdateBackground(t,e.BackgroundColor)},StoreBrandingInfo:function(e,t){Context.TenantBranding.store.Add(e,t)},GetBrandingInfo:function(e){Instrument.tenant_branding_start_time=Util.now(),Context.tenant_branding_ts="",Context.TenantBranding.key=e,Context.TenantBranding.default_page&&(Context.TenantBranding.default_key=e),Context.TenantBranding.applied=!0,Context.TenantBranding.workload_branding_enabled=!1;var t=Context.TenantBranding.store.Get(e);void 0!=t&&(LoginTenantBranding=t,TenantBranding.ApplyTenantBranding())},ApplyTenantBranding:function(){"undefined"!=typeof LoginTenantBranding&&(Instrument.tenant_branding_json_end_time=Util.now(),Context.TenantBranding.store.Add(Context.TenantBranding.key,LoginTenantBranding),Constants.TENANT_BRANDING=LoginTenantBranding),null!=Constants.TENANT_BRANDING&&""!=Constants.TENANT_BRANDING&&(clearInterval(Context.tenant_branding_tid),Context.tenant_branding_tid=null,TenantBranding.processTenantBranding(Constants.TENANT_BRANDING))},ReplaceTenantBranding:function(e){TenantBranding.RemoveTenantBrandingDelayed(),TenantBranding.GetBrandingInfo(e)},RemoveTenantBrandingDelayed:function(){var e=$("#tenantbrandingscript");void 0!=e&&null!=e&&e.remove(),t=$(".workload_img_old"),void 0!=t&&null!=t&&t.remove();var t=$(".workload_img");void 0!=t&&null!=t&&t.addClass("workload_img_old").removeClass("workload_img");var n=$(".workload_text");void 0!=n&&null!=n&&n.addClass("workload_text").removeClass("workload_text_old");var o=$("#boiler_plate");void 0!=o&&null!=o&&o.attr("id","boiler_plate_old");var i=$("#background_background_image").clone();i.removeClass("slide"),i.attr("id","background_background_image_old"),$("#background_branding_container").prepend(i),$("#background_background_image").hide(),TenantBranding.ResetDynamicBrandingContext(),TenantBranding.ResetOnLoadContext(),TenantBranding.showKmsi(),TenantBranding.replaceUsernameHint()},RemoveTenantBranding:function(){var e=$("#tenantbrandingscript");void 0!=e&&null!=e&&e.remove(),t=$(".workload_img_old"),void 0!=t&&null!=t&&t.remove();var t=$(".workload_img");void 0!=t&&null!=t&&t.remove();var n=$(".workload_img_text");void 0!=n&&null!=n&&n.remove();var o=$("#boiler_plate");void 0!=o&&null!=o&&(Constants.DEFAULT_BOILERPLATE_TEXT.length>0?($("#boiler_plate_header").text(Constants.DEFAULT_BOILERPLATE_HEADER),o.text(Constants.DEFAULT_BOILERPLATE_TEXT)):o.remove(),$(".login_inner_container").css("margin-bottom","-50px"),$(".push").height(50)),$("#background_background_image").remove(),TenantBranding.ResetDynamicBrandingContext(),TenantBranding.ResetOnLoadContext(),TenantBranding.showKmsi(),TenantBranding.replaceUsernameHint()},ApplyWorkloadBranding:function(){if(Context.TenantBranding.workload_branding_enabled=!0,!Context.TenantBranding.workload_branding_saved||Context.TenantBranding.default_page)TenantBranding.RemoveTenantBrandingDelayed(),User.UpdateLogo(Constants.DEFAULT_LOGO,Constants.DEFAULT_LOGO_ALT),User.UpdateBackground(Constants.DEFAULT_ILLUSTRATION,Constants.DEFAULT_BACKGROUND_COLOR),$("#background_background_image").show(),Background.background_resized=!1,Context.on_load_image_background_loaded=!1,Logo.logo_image_loaded=!1;else{TenantBranding.RemoveTenantBranding(),Support.isDefined(Context.TenantBranding.workload_branding_illustration)&&$("#background_branding_container").prepend(Context.TenantBranding.workload_branding_illustration.clone()),Support.isDefined(Context.TenantBranding.workload_branding_logo)&&$(".login_workload_logo_container").append(Context.TenantBranding.workload_branding_logo.clone()),Support.isDefined(Context.TenantBranding.workload_branding_logo_text)&&$(".login_workload_logo_container").append(Context.TenantBranding.workload_branding_logo_text.clone()),User.RegisterOnLoadImage();var e=Context.TenantBranding.footer_height;e>0&&($("#footer_links_container").css("height",e+"px"),$("#footer_links_container").css("margin-top","-"+e+"px")),$("#background_page_overlay").css("background-color",Constants.DEFAULT_BACKGROUND_COLOR),$("#background_background_image").css("background-color",Constants.DEFAULT_BACKGROUND_COLOR),$("#background_branding_container").css("background-color",Constants.DEFAULT_BACKGROUND_COLOR),$("html").css("background-color",Constants.DEFAULT_BACKGROUND_COLOR),$("#background_background_image").removeClass("slide"),$(".workload_img").removeClass("slide"),$(".workload_img_text").removeClass("slide"),$("#background_background_image").hide(),$("#background_background_image").show(),$("#background_page_overlay").hide(),$(".workload_img").show(),$(".workload_img_text").show(),$("#background_background_image").addClass("slide"),$(".workload_img").addClass("slide"),$(".workload_img_text").addClass("slide"),Background.background_resized=!0,Context.on_load_image_background_loaded=!0,Logo.logo_image_loaded=!0}Context.TenantBranding.cred_height&&$(".cred").css("min-height",Context.TenantBranding.cred_height),Support.isDefined(Context.TenantBranding.workload_branding_login_cta_text)&&$("#login_cta_text").text(Context.TenantBranding.workload_branding_login_cta_text)},ShouldFadeInTenantBranding:function(){return TenantBranding.IsDynamicBrandingEnabled()&&(null!=Context.TenantBranding.key||Context.TenantBranding.workload_branding_saved)&&!Context.TenantBranding.default_page},UpdateLoginCtaText:function(){if("i5030.2.0"==$("meta[name=PageID]").attr("content")){(""==Context.TenantBranding.workload_branding_login_cta_text||null==Context.TenantBranding.workload_branding_login_cta_text)&&(Context.TenantBranding.workload_branding_login_cta_text=$("#login_cta_text").text());var e=$(".workload_img"),t=!1;if(Support.isDefined(e)){var n=null;n=e.attr("src"),Support.isDefined(n)&&Support.isDefined(Constants.DEFAULT_LOGO)&&(t=n.toLowerCase().indexOf(Constants.DEFAULT_LOGO.toLowerCase())>-1)}Constants.DYNAMIC_BRANDING_CTA_ENABLED&&!t&&$("#login_cta_text").text(Constants.PARTNER_NAME)}},onLoadLogoHelper:function(){Logo.logo_image_loaded=!0;var e=$(".workload_img");TenantBranding.HideAndRemoveSlideAnimation(e);var t=$(".workload_text");if(TenantBranding.HideAndRemoveSlideAnimation(t),Context.TenantBranding.has_logo?(e.show(),Instrument.logo_image_loaded=!0):(t.show(),Instrument.logo_image_loaded=!1),Instrument.logo_image_load_time=Util.now()-Instrument.logo_image_start,Instrument.tenant_branding_right_side_time=Util.now()-Instrument.tenant_branding_start_time,TenantBranding.RemoveAllOldElements(),TenantBranding.IsShowingDynamicWorkloadBranding()||TenantBranding.ShowBrandedBoilerPlate(),TenantBranding.UpdateLoginCtaText(),TenantBranding.ShouldFadeInTenantBranding()&&(e.addClass("slide"),t.addClass("slide")),Context.on_load_image_background_loaded)TenantBranding.onLoadImageHelper();else{$("#background_background_image_old").hide().remove();var n=Context.TenantBranding.background_color;$("#background_page_overlay").css("background-color",n),$("#background_branding_container").css("background-color",n),$("html").css("background-color",n),$("#background_background_image").css("background-color",n),$("#background_background_image").hide()}TenantBranding.setUserIdHintAndKmsi(),Util.debug_console("onLoadLogo: Logo successfully loaded.")},setUserIdHintAndKmsi:function(){null!=Context.TenantBranding.info_context&&(Context.TenantBranding.info_context.KeepMeSignedInDisabled&&0==Context.TenantBranding.kmsi_checkbox_hidden&&!TenantBranding.IsShowingDynamicWorkloadBranding()?($("#cred_kmsi_container").hide(),$("#cred_keep_me_signed_in_checkbox").attr("checked",!1),$("#cred_sign_in_button").addClass("cred_sign_in_button_push"),Context.TenantBranding.kmsi_checkbox_hidden=!0):TenantBranding.showKmsi(),null==Context.TenantBranding.info_context.UserIdLabel||0==Context.TenantBranding.info_context.UserIdLabel.length||TenantBranding.IsShowingDynamicWorkloadBranding()?TenantBranding.replaceUsernameHint():(TenantBranding.setUsernameHint(Context.TenantBranding.info_context.UserIdLabel),Context.TenantBranding.username_hint_changed=!0))},showKmsi:function(){Context.TenantBranding.kmsi_checkbox_hidden&&($("#cred_kmsi_container").show(),$("#cred_sign_in_button").removeClass("cred_sign_in_button_push"),Context.TenantBranding.kmsi_checkbox_hidden=!1)},replaceUsernameHint:function(){Context.TenantBranding.username_hint_changed&&(TenantBranding.setUsernameHint(Constants.USERNAME_HINT_TEXT),Context.TenantBranding.username_hint_changed=!1)},setUsernameHint:function(e){Support.is_placeholder_supported()?$("#cred_userid_inputtext").attr("placeholder",e):$("#cred_userid_inputtext_placeholder_span").text(e),$("#cred_userid_inputtext").attr("alt",e)},onLoadImageHelper:function(){if(Logo.logo_image_loaded){Instrument.tenant_branding_total_time=Util.now()-Instrument.tenant_branding_start_time;var e=$("#background_background_image"),t=$("#background_page_overlay");TenantBranding.HideAndRemoveSlideAnimation(e),$("#background_background_image_old").remove(),t.css("visibility","visible");
var n=$("html").css("background-color");n=Context.TenantBranding.background_color,t.css("background-color",n),$("#background_branding_container").css("background-color",n),$("html").css("background-color",n),Context.TenantBranding.has_background_img&&(e.show(),TenantBranding.ShouldFadeInTenantBranding()&&e.addClass("slide"),e.css("background-color",n),t.css("z-index","-1"),t.hide()),Util.debug_console("TenantBranding OnLoadImage: Background was resized.")}},onLoadImageError:function(){TenantBranding.IsShowingDynamicBranding()&&(Context.TenantBranding.has_background_img=!1)},onLoadLogo:function(){var e=$("#login_workload_logo_image");Util.debug_console("onLoadLogo: Called"),!Logo.logo_image_loaded&&User.IsImageLoaded(e)&&TenantBranding.onLoadLogoHelper()},onLoadErrorLogo:function(){if(!Logo.logo_image_loaded){User.UpdateLogo("",Constants.DEFAULT_LOGO_ALT);var e=$(".workload_img_old");e.hide(),e.remove(),Logo.logo_image_loaded=!0,Instrument.logo_image_error=!0}},RestoreDefaultPageBranding:function(){"undefined"!=typeof Constants.DEFAULT_BRANDING?Context.TenantBranding.applied&&Context.TenantBranding.key==Constants.DEFAULT_BRANDING||TenantBranding.GetBrandingInfo(Constants.DEFAULT_BRANDING):TenantBranding.RemoveTenantBrandingAndApplyWorkload()}};var TenantBranding=MSLogin.TenantBranding,users=null;MSLogin.Tiles={tile_showing_user_cred:!0,users:null,cred_length_resized:!1,showUser:function(e,t,n){Tiles.tile_showing_user_cred||($("#login_user_chooser table").hide(),$(".login_cta_container").css("visibility","visible"),$("#login_cta_text").show(),$("#tiles_cta_text").hide(),Tiles.updateFirstUserTile(e,t,n),$("#login_user_chooser table:first").show(),$.each(users,function(o,i){i.login.toLowerCase()!=e.toLowerCase()||i.isLive!==t&&i.domainHint!==n||(""!=i.authUrl||""!=i.domainHint&&"undefined"!=typeof i.domainHint?Tiles.showFederatedTileUser(i):Tiles.showManagedTileUser(i))}),Context.back_action_stack.AddAction(Constants.CancelAction.FROM_SHOW_USER_TO_TILES),Tiles.tile_showing_user_cred=!0)},hideDisambiguationScreen:function(){$("#splitter-tiles-container").hide(),$("#cred_kmsi_container").show(),$("#cred_sign_in_button").show(),$("#cred_cancel_button").hide(),$("#recover_container").show(),$("#alternative-identity-providers").show(),$("#disambig-container").hide(),$(".login_splitter_control").hide(),$("#splitter-tiles-container").children("a").remove(),$("#splitter-tiles-container").hide(),$("#login_user_chooser").empty(),$(".login_user_chooser").hide(),$("#login_user_chooser").hide(),$("#create_msa_account_container").hide()},showUserLoginPage:function(){$(".login_user_chooser").show(),$("#cta_error_message_text").show(),$("div.progress").css("visibility","hidden"),clearInterval(Context.animationTid),Support.hideClientErrorMessages(),Support.hideClientMessages(),Context.username_state.home_realm_state=Constants.State.NONE,Context.username_state.last_checked_email=Context.username_state.last_checked_email||"",$(".cta_message_text").show(),$("#cred_userid_container").show(),$("#cred_userid_inputtext").show(),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$("#cred_userid_inputtext").focus()},showManagedTileUser:function(e){Tiles.disableActiveTile(),Context.post_from_tile=!0,$(".login_cred_container").show(),$(".login_cred_field_container").show(),$(".login_cred_container li").show(),$("#disambig-container").hide(),$("#signin_legend").hide(),$("#cred_userid_inputtext").val(e.login),$("#cred_password_container").show(),$(".login_cred_options_container").show(),Context.username_state.enable_guests=!1,$("#guest_hint_text").hide(),$(".guest_redirect_container").hide(),Tiles.isUseOtherAccountVisible()||User.isChxOrAdalOverride()?$("#cred_cancel_button").show():$("#cred_cancel_button").hide(),!Support.isUXFeatureEnabled(4096)||"EmailBasedDiscovery.2.0"!=$("meta[name=PageID]").attr("content")&&"EmailBasedDiscoveryTiles.2.0"!=$("meta[name=PageID]").attr("content")||($("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),EmailDiscovery.is_enabled_workflow=!0),$("#cred_sign_in_button").show(),$("#cred_password_inputtext").focus(),User.RefreshDomainState(),Tiles.isUseOtherAccountVisible()||User.isChxOrAdalOverride()||$("#cred_cancel_button").hide()},showFederatedTileUser:function(e){Context.username_state.home_realm_state=Constants.State.FEDERATED,Context.post_from_tile=!0,Tiles.disableActiveTile(),$("#cred_userid_inputtext").val(e.login),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$(".login_cred_options_container div.subtext").hide(),$("#cred_sign_in_button").hide(),$("#forget_tile_container").show(),$("#cred_password_container").hide(),$(".login_cta_container").hide(),$("#recover_container").hide(),$("#redirect_cta_text").show(),$("input#cred_password_inputtext").hide(),$("#redirect_company_name_text").empty(),$("#cred_kmsi_container").show(),$("#alternative-identity-providers").hide(),$("div.progress").css("visibility","visible"),User.startAnimation(),Context.animationTid=setInterval(User.startAnimation,3500),Context.username_state.enable_progress_bar=!0,Context.username_state.enable_redirect=!0,Context.username_state.enable_guests=!1,!Support.isUXFeatureEnabled(4096)||"EmailBasedDiscovery.2.0"!=$("meta[name=PageID]").attr("content")&&"EmailBasedDiscoveryTiles.2.0"!=$("meta[name=PageID]").attr("content")||($("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),EmailDiscovery.is_enabled_workflow=!0),Util.updateRedirectionMessage(e.authUrl),Context.redirect_auth_url=e.authUrl,User.UsernameOnChangeHandler(),User.StartRedirection(!1)},disableActiveTile:function(){$("#login_user_chooser .tile_link:first .user_tile").addClass("disabled_tile"),$("#login_user_chooser .tile_link:first").addClass("disabled_tile"),$("#login_user_chooser .tile_link:first").attr("tabindex","-1"),$("#login_user_chooser .tile_link:first tr").css("cursor","default"),$(".tile_primary_name").css("cursor","default"),$(".tile_secondary_name").css("cursor","default")},enableActiveTile:function(){$("#login_user_chooser .tile_link:first .user_tile").removeClass("disabled_tile"),$("#login_user_chooser .tile_link:first").removeClass("disabled_tile"),$("#login_user_chooser .tile_link:first").attr("tabindex","1"),$("#login_user_chooser .tile_link:first tr").css("cursor","pointer"),$(".tile_primary_name").css("cursor","pointer"),$(".tile_secondary_name").css("cursor","pointer")},showOtherOption:function(){if(!Tiles.tile_showing_user_cred){if($("#alternative-identity-providers").show(),EmailDiscovery.IsTilesModeActivated()||EmailDiscovery.ShouldPerformDiscovery())return Tiles.tile_showing_user_cred=!0,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_START_TO_TILES),EmailDiscovery.Init(),void $("#cred_userid_inputtext").val("");Context.back_action_stack.AddAction(Constants.CancelAction.FROM_SHOW_USER_TO_TILES),Context.username_state.enable_progress_bar=!0,User.UsernameOnChangeHandler(),$(".login_cred_container").show(),$(".login_cred_container .windows_cred_block").show(),$(".login_cred_field_container").addClass("show_other"),$(".login_cred_field_container").show(),$("#cred_userid_container").show(),$("#login_user_chooser").hide(),$(".login_cred_options_container").show(),$(".login_cta_container").css("visibility","visible"),$("#login_cta_text").show(),$("#tiles_cta_text").hide(),$("#forget_tile_container").hide(),$("#cred_sign_in_button").show(),$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),$("#cred_userid_inputtext").val(""),$("#cred_userid_inputtext").focus(),Context.username_state.enable_guests=!0,Tiles.tile_showing_user_cred=!0,Support.renderBrowserSpecific(),Tiles.isUseOtherAccountVisible()||User.isChxOrAdalOverride()?$("#cred_cancel_button").show():$("#cred_cancel_button").hide()}},CancelTileRedirect:function(){Context.redirect_to_manage=!1,Constants.IS_CXH_REQUEST||Constants.IS_ADAL_REQUEST||$("#cred_kmsi_container").show(),$("#cred_password_inputtext").val(""),Context.username_state.last_checked_email="",Tiles.enableActiveTile(),$("#cred_password_inputtext").val(""),$("#cta_error_message_text").remove(),""!=Constants.DEFAULT_CTA_MESSAGE,$(".login_cred_field_container").removeClass("show_other"),$(".login_cred_field_container").hide(),$(".login_cred_options_container").hide(),$(".login_userid_container").hide(),$(".login_cred_options_container div.subtext").show(),$("#create_msa_account_container").hide(),$("#cred_sign_in_button").show(),$("#cred_kmsi_container").show(),$("#forget_tile_container").show(),Tiles.tile_showing_user_cred=!1,Support.hideClientErrorMessages(),User.CancelRedirect(),$("#login_user_chooser").empty(),Tiles.drawUsers()},getStringTileID:function(e,t){var n;if(void 0==e.id){for(n=e.login.replace("@","_");n.indexOf(".")>0;)n=n.replace(".","_");for(;n.indexOf(" ")>0;)n=n.replace(" ","_");for(;n.indexOf("'")>0;)n=n.replace("'","_");(e.isLive||"msa"===e.domainHint)&&(n+="-live"),t&&(n="use_another_account"),n=n.toLowerCase()}else n=e.id;return n},drawTile:function(e,t,n){var o=e.name,i=e.login,a=e.name,r=e.login,s=null,_=null;e.isLive?(s=Constants.MSA_ACCOUNT_TILE_ALT_TEXT.replace("{0}",e.name),_=Constants.MSA_ACCOUNT_IMG_ALT_TEXT):(s=Constants.AAD_ACCOUNT_TILE_ALT_TEXT.replace("{0}",e.name),_=e.domainHint?e.domainHint:Constants.AAD_ACCOUNT_IMG_ALT_TEXT);var d=e.sessionID?e.sessionID:"";""===o&&""!==i&&(o=i,a=r,i=r=""),o.toLowerCase()==i.toLowerCase()&&(i=r="");var c=void 0==e.ignore_length||0==e.ignore_length;(!c||o.length<Constants.MAX_TILE_TEXT_LENGTH)&&(a=""),(!c||i.length<1.6*Constants.MAX_TILE_TEXT_LENGTH)&&(r="");var l="javascript:void(0)",u="",g="",h=null;$("meta[name=PageID]").attr("content").indexOf("reauth")>=0?(l="",u="<div/>",g="alt"):e.isWindows?(u="<a />",g="href",h=function(){WindowsBrowserSso.LoginWindowsUser(e.link,Tiles.getStringTileID(e,!1))}):Context.email_discovery_mode?(u="<a/>",g="href",h=e.isLive?function(){Context.email_discovery_easi_user=!0,Instrument.email_discovery_splitter_choice=EmailDiscovery.WorkflowStates.MSA,EmailDiscovery.LoginMSOAccount()}:function(){Instrument.email_discovery_splitter_choice=EmailDiscovery.WorkflowStates.AAD,EmailDiscovery.LoginAADAccount()},s=e.name,_=e.name):"other"==e.link?(u="<a/>",g="href",h=Tiles.showOtherOption,s=e.name,_=e.name):e.isSigned?(u="<a />",g="href",h=Constants.IS_MSA_REDIR_SUPPORTED&&e.isLive?function(){var t=Util.appendQueryString(Constants.MSA_AUTH_URL,"username="+encodeURIComponent(e.login));User.Redirect(t)}:function(){var t=Constants.BASE_URL+$.param({sessionId:e.sessionID,ctx:Constants.CONTEXT});User.Redirect(t)}):""!=e.link?(u="<a/>",g="href",h=function(){Tiles.showUser(e.link,e.isLive,e.domainHint)}):(l="",u="<div/>",g="alt");var m="other"==e.link||Context.email_discovery_mode||""===l||n||!1,p=Tiles.getStringTileID(e,m),C=this.generateUserTileHtml(Util.htmlEncode(p),d,t,Util.htmlEncode(_),Util.htmlEncode(o),Util.htmlEncode(a),Util.htmlEncode(i),Util.htmlEncode(r),m?null:e.isSigned?e.isWindows?Constants.CONNECTEDTOWINDOWS:Constants.SIGNEDIN:Constants.CLICKTOSIGNIN,m||e.isWindows||Constants.IS_LOGOUT_REQUEST?null:e.isSigned?"signedin":"signedout",e.isWindows);return $("#login_user_chooser").append($(u).attr("id",p+"_link").attr("data-session-id",d).attr(g,"#").attr("tabindex","1").addClass("tile_link").addClass("tooltip").prop("aria-label",s).click(h).append(C)),$("#use_another_account_link").attr("tabindex","4"),$("#"+p+"_menulink").keydown(function(e){var t=$(this).attr("data-ref"),n=$("#"+t+"-dropdown");switch(e.which){case 32:case 13:$(this).click(),e.preventDefault();break;case 27:n.hide()}}).click(function(e){e.preventDefault(),e.stopPropagation();var t=$(this).attr("data-ref"),n=$(this).attr("data-session-id"),o=$("#"+t+"-dropdown"),i=$(".dropdownPanel");if(o.is(":visible"))i.hide();else{var a=$(this).position();i.hide(),o.removeClass("hidden").removeAttr("aria-hidden").css({left:a.left-o.width()+20+"px",top:a.top+15+"px"}).show(),o.find("li").removeAttr("aria-hidden").attr("data-session-id",n).attr("tabindex","3").show(),$("html").one("click",function(){i.hide()})}}),p+"_link"},drawUsers:function(){Tiles.users||(Tiles.users=users=[]),Tiles.users.length>1||1===Tiles.users.length&&"other"!=Tiles.users[0].link?($(".login_cta_container").css("visibility","visible"),$("#login_cta_text").hide(),$("#tiles_cta_text").show(),$(".login_cred_container li").hide(),$(".login_cred_container .windows_cred_block").hide(),$("#login_user_chooser").show(),$("#cred_userid_container").hide(),$("#switch_user_container").hide(),Tiles.drawUserTiles()):Tiles.showOtherOption()},drawUserTiles:function(){Tiles.cred_length_resized=!0;var e="";if($.each(users,function(t,n){e=Tiles.getUserImage(n);var o="";if("other"==n.link||t<Constants.MAX_USER_TILES||Context.email_discovery_mode){var i=!Constants.IS_MSA_FED_SUPPORTED&&n.isLive;o=Tiles.drawTile(n,e,i)}""!=o&&0==t&&$("#"+o).focus()}),Tiles.tile_showing_user_cred=!1,Context.username_state.enable_guests=!0,!Tiles.cred_length_resized){var t=$(".cred").height();t+=$(".login_user_chooser").height(),$(".cred").css("min-height",t),Tiles.cred_length_resized=!0}Support.renderBrowserSpecific(),Context.TenantBranding.cred_height?$(".cred").css("min-height",Context.TenantBranding.cred_height):$(".cred").css("min-height","")},forgetAccount:function(){Tiles.tile_showing_user_cred=!1,$("#forget_tile_container").hide(),$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),$(".login_cta_container").css("visibility","visible"),$("#login_cta_text").show(),$("#tiles_cta_text").hide(),Util.eraseCookie("MSPPre"),Tiles.CancelTileRedirect(),Tiles.showOtherOption(),$("#cred_cancel_button").hide()},forceSignIn:function(e){Tiles.disableActiveTile(),Tiles.tile_showing_user_cred=!1,$("#login_cta_text").show(),$("#tiles_cta_text").hide(),$("#login_user_chooser table").hide(),$("#login_user_chooser table:first").show(),$("#switch_user_container").show();var t=null;$.each(users,function(n,o){o.login.toLowerCase()!=e.toLowerCase()||o.isLive||"undefined"!=typeof o.domainHint&&""!=o.domainHint||(Tiles.showManagedTileUser(o),t=o)}),$("#cred_cancel_button").hide(),$("#forget_tile_container").hide();var n=!1;null!=t&&null!=t.isLive&&Tiles.ApplyToEachSavedUsers(function(o){0!=o[0].length&&o[0].toLowerCase()==e.toLowerCase()&&o[1]==(t.isLive?"1":"0")&&(n=!1)}),n?$("#cred_keep_me_signed_in_checkbox").attr("checked","checked"):$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),$(".login_cta_container").show()},hasUserNameQS:function(){var e=Util.ExtractQSParam("username")+Util.ExtractQSParam("login_hint");return""!=e},showUserName:function(){var e=Util.ExtractQSParam("username");""==e&&(e=Util.ExtractQSParam("login_hint")),e=decodeURIComponent(e);var t=null,n=!1;$.each(Tiles.users,function(o,i){i.login.toLowerCase()!=e.toLowerCase()||n||(n=!0,t=i)}),n?(Tiles.showUser(e,t.isLive,t.domainHint),$("#cred_password_inputtext").focus()):(Tiles.showOtherOption(),$("#cred_userid_inputtext").val(e),$("#cred_userid_inputtext").focus())},showIsNotMe:function(e,t,n){Tiles.drawUsers(),Tiles.showUser(e,t,n),$(".login_cred_container li").hide(),$("#login_user_chooser").show("slow"),$(".login_cta_container").show(),$(".login_cta_container").css("visibility","visible"),$(".login_cred_options_container").show(),$(".login_cred_options_container div.subtext").hide(),$("#submit_button").hide(),$("#continue_as_user_container").show(),$("#continue_as_user_link").focus(),$("#switch_user_container").show()},updateContinueAsUserUrl:function(e){var t=$("#continue_as_user_link").attr("href");t=t.replace("post.srf","secure.srf"),t=t.replace(new RegExp("username=[^\\&]*","gm"),""),t.indexOf("msoptin-newui")<0&&(t+="&msoptin-newui"),$("#continue_as_user_link").attr("href",t),t=Util.ExtractQSParam("ru"),""!=t&&(t=e,$("#continue_as_user_link").attr("href",t))},forgetUserFromCookie:function(e,t){Tiles.tile_showing_user_cred=!1,$("#forget_tile_container").hide(),$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),$(".login_cta_container").css("visibility","visible"),$("#login_cta_text").show(),$("#tiles_cta_text").hide(),$("#login_userid_inputtext").val(""),$("#login_password_inputtext").val(""),Tiles.CancelTileRedirect(),TenantBranding.RemoveTenantBrandingAndApplyWorkload();var n=[];Tiles.ApplyToEachSavedUsers(function(o){(0==o[0].length||o[0].toLowerCase()!=e.toLowerCase()||o[1]!=Number(t).toString())&&n.push([o[0],o[1],o[2]])});var o=Util.getCookie(Constants.PREFILL_USER_COOKIE);if(0==n.length)return Util.eraseCookie(Constants.SAVED_USER_COOKIE),EmailDiscovery.IsTilesModeActivated()&&(Context.email_discovery_tiles_mode=!1,Context.email_discovery_mode=!0),Tiles.showOtherOption(),$("#login_user_chooser").hide(),Context.back_action_stack.ClearCancelActions(),$("#cred_cancel_button").hide(),void(null!=o&&o.indexOf(e)>=0&&Util.eraseCookie(Constants.PREFILL_USER_COOKIE));var i=Constants.SAVED_USER_COOKIE_INFO_DELIMITER,a="";$.each(n,function(e,t){e&&(a+=Constants.SAVED_USER_COOKIE_USER_DELIMITER),a+=t[0]+i+t[1]+i+t[2]}),Util.setCookie(Constants.SAVED_USER_COOKIE,a,30),Util.eraseCookie(Constants.PREFILL_USER_COOKIE),location.reload()},ApplyToEachSavedUsers:function(e){var t=Util.getCookie(Constants.SAVED_USER_COOKIE),n=Constants.SAVED_USER_COOKIE_USER_DELIMITER,o=Constants.SAVED_USER_COOKIE_INFO_DELIMITER;void 0!=t&&null!=t&&""!=t&&$.each(t.split(n),function(t,n){if(void 0!=n&&null!=n&&""!=n){var i=n.split(o);3==i.length&&0!=i[0].length&&e(i)}})},getUser:function(e,t,n){e=e.toLowerCase();var o=null;return $.each(Tiles.users,function(i,a){(a.login.toLowerCase()==e&&(a.isLive===t||a.domainHint===n)||a.sessionID==e)&&(o=a)}),o},forgetRememberedUser:function(e){var t=$(this).parent().attr("data-session-id");Support.isDefined(t)?$.ajax({headers:{Accept:"application/json"},url:"/forgetuser",dataType:"json",data:{sessionId:encodeURI(t)},success:function(e){Tiles.UpdateUsers(e)},error:function(e,t,n){Support.showClientError(n)},timeout:2e3}):Util.debug_console("sessionId is not defined"),e.preventDefault()},indexOfPropValue:function(e,t,n){for(var o=0;o<e.length;o++)if(e[o][t]==n)return o;return-1},mergeUsers:function(e,t){e=e.slice(0),t=t.slice(0);for(var n=0;n<e.length;n++){var o=e[n],i=Tiles.indexOfPropValue(t,"login",o.login);if(i>-1&&(o.isSigned||(e[n]=t[i]),t.splice(i,1),0==t.length))break}return e.concat(t)},redirectToManage:function(){var e=$(this).parent().attr("data-session-id"),t=$(this).attr("data-ref"),n=$("#"+t+"-dropdown");n.hide(),$("#login_user_chooser table").hide(),$(".login_cta_container").css("visibility","visible"),$("#login_cta_text").show(),$("#tiles_cta_text").hide();var o=Tiles.getUser(e);Tiles.updateFirstUserTile(o.login,o.isLive,o.domainHint),$("#login_user_chooser table:first").show(),Context.redirect_to_manage=!0,o.isSigned?window.location.href=o.isLive||"msa"===o.domainHint?"@Html.Raw(CloudStsSettings.ManageMicrosoftAccountProfileUri)":"@Html.Raw(CloudStsSettings.ManageUserProfileUri)":""==o.authUrl?Tiles.showManagedTileUser(o):(o.authUrl+="&LoginOptions=1"+($("#cred_keep_me_signed_in_checkbox").attr("checked")?"1":"0"),Tiles.showFederatedTileUser(o)),Context.back_action_stack.AddAction(Constants.CancelAction.FROM_SHOW_USER_TO_TILES),Tiles.tile_showing_user_cred=!0},UpdateUsers:function(e){Tiles.sso_users&&(e=Tiles.mergeUsers(e,Tiles.sso_users)),Constants.IS_USE_OTHER_ACCOUNT_VISIBLE&&e.push(Tiles.otherJSON),Tiles.users=users=e,$("#login_user_chooser").empty(),Tiles.drawUsers()},signoutAndForgetUser:function(e){var t=$(this).parent().attr("data-session-id"),n=e.data.shouldForgetUser,o=$("#title3_"+t);Support.isDefined(t)?(o.text(Constants.SIGNINGOUT),$(this).append('<iframe name="logoutFrame" src="'+Constants.SIGNOUTFORGET_URL_TEMPLATE.format(t,n)+'" style="display: none"></iframe>')):Util.debug_console("seesionId is not defined"),e.preventDefault()},updateFirstUserTile:function(e,t,n){$("input#cred_userid_inputtext").val(e),$("#login_user_chooser").empty();var o=Tiles.getUser(e,t,n),i=Tiles.getUserImage(o),a=Tiles.drawTile(o,i,!0);$("#"+a).focus()},isUseOtherAccountVisible:function(){return null!=Tiles.users&&0!==Tiles.users.length&&(1!==Tiles.users.length||"other"!==Tiles.users[0].link)&&Constants.IS_USE_OTHER_ACCOUNT_VISIBLE},getUserImage:function(e){return image_path="work_account.png",image_path=e.domainHint&&!Constants.IS_CXH_REQUEST?-1!=$.inArray(e.domainHint,["amazon","facebook","google","instagram","linkedin","qq","renren","twitter","weibo","yahoo"])?e.domainHint+"_80.png":"msa"===e.domainHint?"personal_account.png":"use_another_account.png":"other"===e.link?"use_another_account.png":e.isLive?"personal_account.png":"work_account.png",Constants.CDN_IMAGE_PATH+image_path},generateUserTileHtml:function(e,t,n,o,i,a,r,s,_,d,c){var l="";null!=_?l='            <div class="smallertext tile_third_name windows_tile_text text-caption2 {0}" style="cursor: pointer" id="title3_{1}">                {2}            </div>'.format(e,t,_):Context.username_state.last_checked_email&&(l='            <div class="smallertext tile_third_name windows_tile_text text-caption2 {0}" style="cursor: pointer">                {1}            </div>'.format(e,Context.username_state.last_checked_email));var u="";null!=d&&(u=('        <td class="dots" rowspan="2">            <div id="{0}_menulink" tabindex="2" data-ref="{2}" data-session-id="{1}" title="'+Constants.CLICKFORMORE+'" aria-label="'+Constants.CLICKFORMORE+'">                &bull;&bull;&bull;            </div>        </td>').format(e,t,d));var g="";c&&(g='                         <div class="progress">                             <div class="pip pip_darker"></div>                             <div class="pip pip_darker"></div>                             <div class="pip pip_darker"></div>                             <div class="pip pip_darker"></div>                             <div class="pip pip_darker"></div>                         </div>');var h=('<table id="{0}" data-session-id="{1}" class="user_tile">    <tr>        <td>            <table>                 <tr>                     <td colspan="2">'+g+"                     </td>"+u+'                 </tr>                 <tr class="{0} {1}" style="cursor: pointer">                     <td>                         <img class="ad_glyph {0}" src="{2}" alt="{3}" />                     </td>                     <td class="tile_name tile_name_padding">                         <div class="bigtext tile_primary_name windows_tile_text wrap {0}" style="cursor: pointer" {5}>                             {4}                         </div>                         <div class="smallertext tile_secondary_name windows_tile_text text-caption2 {0}" style="cursor: pointer" {7}>                             {6}                         </div>'+l+"                     </td>                 </tr>            </table>        </td>    </tr></table>").format(e,t,n,o,i,a?'title="'+a+'"':"",r,s?'title="'+s+'"':"");return h}};var Tiles=MSLogin.Tiles;!function(){var e=window,t=e.MSLogin=e.MSLogin||{};t.Util={HoloNavigationStack:[],PrefetchContent:function(e){$("#login_prefetch_container").append($("<iframe/>").attr("src",e).attr("seamless","seamless").attr("scrolling","no").attr("id","login_prefetch_iframe").load(function(){Instrument.prefetch_load_time=new Date-Instrument.prefetch_start,Instrument.prefetch_done=!0}))},getCookie:function(e,t){var n,o,i,a=document.cookie.split(";");for(n=0;n<a.length;n++)if(o=a[n].substr(0,a[n].indexOf("=")),i=a[n].substr(a[n].indexOf("=")+1),o=o.replace(/^\s+|\s+$/g,""),o==e)return(t||unescape)(i)},setCookieWithExpiration:function(e,t,n,o){var i=";secure";"undefined"!=typeof Constants&&"undefined"!=typeof Constants.SET_COOKIE_SUFFIX&&(i=Constants.SET_COOKIE_SUFFIX);var a=t+(o?";domain="+o:"")+";path=/"+(n?";expires="+n.toUTCString():"")+i;document.cookie=e+"="+a},setCookie:function(e,t,n){var o=new Date;o.setDate(o.getDate()+n);var i=document.location.hostname.split("."),a=i.length,r="."+i[a-2]+"."+i[a-1];Util.setCookieWithExpiration(e,t,o,r)},eraseCookie:function(e){var t=document.location.hostname.split("."),n=t.length,o=e+"= ;domain=."+t[n-2]+"."+t[n-1]+";path=/;expires=Thu, 30-Oct-1980 00:00:01 GMT;";Util.debug_console(o),document.cookie=o,o=e+"= ;domain=."+document.location.hostname+";path=/;expires=Thu, 30-Oct-1980 00:00:01 GMT;",Util.debug_console(o),document.cookie=o},exists:function(e){return e?!0:0==e||0==e||""==e},valOrDefault:function(e,t){return Util.exists(e)?e:t},debug_console:function(){},ExtractToken:function(e,t,n,o,i){n=Util.valOrDefault(n,"&"),o=Util.valOrDefault(o,"=");var a=Util.valOrDefault(i,null);if(!e)return a;var r=e.indexOf(t+o);if(0==r?r+=t.length+1:r>0&&(r=e.indexOf(n+t+o),r>0&&(r+=n.length+t.length+1)),-1!=r){var s=e.indexOf(n,r);-1==s&&(s=e.length),a=e.substring(r,s)}return a},ExtractQSParam:function(e){var t=Context.query_search_params.toLowerCase();return t&&(t=t.substr(1)),Util.ExtractToken(t,e.toLowerCase(),"&","=","")},AddQSParamIfNotExists:function(e,t,n){var o="[?&]"+t+"=([^&]+?)($|&)",i=new RegExp(o,"i"),a=e.match(i);if(!a){var r="([?&])"+t+"=?(&|$)",s=new RegExp(r,"i");e=e.replace(s,"$1");var _=Util.ExtractQSParam(t);!_||n&&!n.test(_)||(-1==e.indexOf("?")?e+="?":e.indexOf("?")<e.length-1&&(e+="&"),e+=t+"="+_)}return e},appendQueryString:function(e,t){var n=-1===e.indexOf("?")?"?":"&";return e+n+t},isMSA:function(e){return-1!=e.indexOf("login.live.com")||-1!=e.indexOf("login.live-int.com")||-1!=e.indexOf("login.microsoft.com")?!0:!1},updateRedirectionMessage:function(e){var t;Util.isMSA(e)?t=Constants.REDIRECT_MESSAGES.MSA:(t=Constants.REDIRECT_MESSAGES.AAD,$("#alternative-identity-providers").hide()),$("#redirect_message_text").text(t)},htmlEncode:function(e){return $("<span/>").text(e).html()},now:function(){var e=window.performance||{};return e.now=function(){return e.now||e.webkitNow||e.msNow||e.oNow||e.mozNow||function(){return(new Date).getTime()}}(),e.now()},StartLocalAccountCxhFlow:function(){try{var e=new CloudExperienceHost.Bridge;return e.fireEvent(CloudExperienceHost.Events.loadIdentityProvider,CloudExperienceHost.SignInIdentityProviders.Local),!1}catch(t){}return!0},CancelCxhFlow:function(){try{var e=new CloudExperienceHost.Bridge;return e.fireEvent(CloudExperienceHost.Events.done,CloudExperienceHost.AppResult.cancel),!1}catch(t){}return!0},OnBack:function(){var e=Util.HoloNavigationStack;return e.pop(),e[e.length-1].show&&e[e.length-1].show(),!1},NavigateCxh:function(e){try{var t=new CloudExperienceHost.Bridge;return t.fireEvent(CloudExperienceHost.Events.navigate,e),!1}catch(n){}return!0},LogCxhTelemetry:function(e,t){try{var n=new CloudExperienceHost.Bridge;void 0==t?n.invoke("CloudExperienceHost.Telemetry.logEvent",e):n.invoke("CloudExperienceHost.Telemetry.logEvent",e,t)}catch(o){}}},e.Util=t.Util}(),MSLogin.WindowsBrowserSso={STATE:{START:"start",INPROGRESS:"in-progress",END:"end",END_SSO:"end-sso",END_USERS:"end-users"},Initialize:function(e){this.options=e||{forceTiles:!1,overallTimeoutMs:4e3},this.options.initiatePullTimeoutMs=this.options.initiatePullTimeoutMs||this.options.overallTimeoutMs,this.options.initiatePullTimeoutAction=this.options.initiatePullTimeoutAction||"abort",this.bsso=Util.ExtractQSParam("bsso").toLowerCase(),this.log=[]},LoginWindowsUser:function(e,t){if(!window.navigator||!$.isFunction(window.navigator.msLaunchUri)||"disable"==this.bsso)return this.updateStatus(this.STATE.START,null,t),this.reportTelemetry("BSSO.info","disable"==this.bsso?"disabled":"not-supported"),void this.updateStatus(this.STATE.END,"disable"==this.bsso?"Browser SSO is disabled":"window.navigator.msLaunchUri is not available",t);var n,o=this;$.when($.Deferred(function(i){n=o.callTokenBroker(e,i,"Windows user login",t)})).then(function(){var e,i=setInterval(function(){if(Util.getCookie("ESTSSSO")){clearInterval(i),clearTimeout(e);var a=(new Date).getTime()-n;o.reportTelemetry("ESTSSSO.cookie.ms",a),o.reloadPage(t)}},100);e=setTimeout(function(){clearInterval(i);var e=(new Date).getTime()-n;o.reportTelemetry("TB.response.timeout.ms",e),o.updateStatus(o.STATE.END,"Windows user login timed out.",t)},o.options.overallTimeoutMs)})},PullBrowserSsoCookie:function(){if(!window.navigator||!$.isFunction(window.navigator.msLaunchUri)||"disable"==this.bsso)return this.updateStatus(this.STATE.START,null),this.reportTelemetry("BSSO.info","disable"==this.bsso?"disabled":"not-supported"),void this.updateStatus(this.STATE.END,"disable"==this.bsso?"Browser SSO is disabled":"window.navigator.msLaunchUri is not available");var e=Util.getCookie("ESTSSSOTILES")||this.options.forceTiles;if(!e&&Util.getCookie("SSOCOOKIEPULLED"))return this.updateStatus(this.STATE.START,null),this.reportTelemetry("BSSO.info","throttled"),void this.updateStatus(this.STATE.END,"Cookie pull throttled");var t,n=this,o="tbauth://login.windows.net?context="+encodeURIComponent(window.location.href.split("/",3).join("/"))+(n.options.nonce?"&request_nonce="+encodeURIComponent(n.options.nonce):"")+(n.options.rid?"&rid="+encodeURIComponent(n.options.rid):"");$.when($.Deferred(function(i){var a=o;e&&(a=Util.appendQueryString(a,"user_id=*"),Util.eraseCookie("ESTSSSOTILES")),t=n.callTokenBroker(a,i,"cookie pull")})).then(function(){var e,i=setInterval(function(){var a=Util.getCookie("ESTSUSERLIST",decodeURIComponent);if(a){clearInterval(i),clearTimeout(e);var r=(new Date).getTime()-t;n.reportTelemetry("ESTSUSERLIST.cookie.ms",r),n.updateStatus(n.STATE.INPROGRESS,"Users list cookie detected"),Util.eraseCookie("ESTSUSERLIST"),n.processUsersList(a.replace(/\+/g," "),o)}else if(Util.getCookie("ESTSSSO")){clearInterval(i),clearTimeout(e);var r=(new Date).getTime()-t;n.reportTelemetry("ESTSSSO.cookie.ms",r),n.reloadPage()}},250);e=setTimeout(function(){clearInterval(i);var e=(new Date).getTime()-t;n.reportTelemetry("TB.response.timeout.ms",e),n.updateStatus(n.STATE.END,"Pull cookie timed out.")},n.options.overallTimeoutMs)})},callTokenBroker:function(e,t,n,o){this.updateStatus(this.STATE.START,"Initiating "+n,o);var i,a=this,r=(new Date).getTime();return window.navigator.msLaunchUri(e,function(){clearTimeout(i);var e=(new Date).getTime()-r;t.resolve(),a.reportTelemetry("msLaunchUri.success.ms",e),a.updateStatus(a.STATE.INPROGRESS,n+" initiated successfully (took "+e+" ms)",o)},function(){clearTimeout(i);var e=(new Date).getTime()-r,s="pending"===t.state();t.reject(),a.reportTelemetry("msLaunchUri.failure.ms",e),a.updateStatus(s?a.STATE.END:a.STATE.INPROGRESS,n+" was NOT initiated successfully (took "+e+" ms)",o)}),i=setTimeout(function(){clearTimeout(i),"pending"===t.state()&&("abort"==a.options.initiatePullTimeoutAction?(t.reject(),a.reportTelemetry("msLaunchUri.response","timeout"),a.updateStatus(a.STATE.END,"Initiating "+n+" timed out.",o)):(t.resolve(),a.reportTelemetry("msLaunchUri.response","timeout-continue"),a.updateStatus(a.STATE.INPROGRESS,"Initiating "+n+" timed out but starting polling anyway in case cookie was pulled.",o)))},this.options.initiatePullTimeoutMs),r},reloadPage:function(e){var t=new Date;t.setSeconds(t.getSeconds()+60),"debug"==this.bsso?(this.updateStatus(this.STATE.END_SSO,"SSO cookie detected. Refreshing page in 5 seconds (due to debug mode).",e),setTimeout(function(){Util.setCookieWithExpiration("SSOCOOKIEPULLED","1",t),-1==window.location.href.toLowerCase().indexOf("prompt=select_account")?window.location.reload(!0):window.location.replace(window.location.href.replace(/prompt=[^&]*/i,""))},5e3)):(this.updateStatus(this.STATE.END_SSO,"SSO cookie detected. Refreshing page.",e),Util.setCookieWithExpiration("SSOCOOKIEPULLED","1",t),-1==window.location.href.toLowerCase().indexOf("prompt=select_account")?setTimeout(function(){window.location.reload(!0)},0):setTimeout(function(){window.location.replace(window.location.href.replace(/prompt=[^&]*/i,""))},0))},processUsersList:function(e,t){try{if(Tiles.users||(Tiles.users=[]),Tiles.sso_users=[],$.each($.parseJSON(e).users,function(e,n){var o={name:n.display_name||"",login:n.upn,imageAAD:"ad_glyph.png",imageMSA:"ad_glyph.png",isLive:!1,isWindows:!0,isSigned:!0,link:t,authUrl:"",sessionID:"",domainHint:""};
Tiles.sso_users.push(o)}),Tiles.sso_users.length>0){var n=Context.email_discovery_mode;Context.email_discovery_mode=!1,Constants.IS_USE_OTHER_ACCOUNT_VISIBLE&&Tiles.users.splice(Tiles.users.length-1,1),Tiles.UpdateUsers(Tiles.users),Context.email_discovery_mode=n,this.updateStatus(this.STATE.END_USERS,"User list processed.")}else this.updateStatus(this.STATE.END,"User list is empty.")}catch(o){this.reportTelemetry("BSSO.exception","processUsersList"),this.updateStatus(this.STATE.END,"WindowsBrowserSso.processUsersList: exception: "+o)}},updateStatus:function(e,t,n){if(this.options.statusCallback&&$.isFunction(this.options.statusCallback)){this.log.push(t);try{this.options.statusCallback({state:e,message:t,tileId:n})}catch(o){this.reportTelemetry("BSSO.exception","updateStatus")}}},reportTelemetry:function(e,t){this.options.telemetryCallback&&$.isFunction(this.options.telemetryCallback)&&this.options.telemetryCallback(e,t)}};var WindowsBrowserSso=MSLogin.WindowsBrowserSso;