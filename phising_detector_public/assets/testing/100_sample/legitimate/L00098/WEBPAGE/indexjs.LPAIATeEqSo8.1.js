!function(e){function t(e,t){return(e+1)%t}function o(e,t){return 0>=e?t-1:(e-1)%t}e.ui={},e.ui.Slide=function(s,n,i,r,a,l,u){if(arguments.length){var c=this;if(c.total=n.length,s&&c.total!==s.length)throw"can not match ctrls("+s.length+") and contents("+c.total+")";if(c.constructor=arguments.callee,c._curIndex=-1,c._ctrls=s,c._contents=n,c._css=i,c._eventName=r,c.interval=a,c.playMode=t,c.rollbackMode=o,c.delay=l,c.onShow=u||function(){},c._ctrls&&c._ctrls.length&&c._eventName){var p,f;l?(p=function(e,t){!this._delayTimer&&(this._delayTimer=setTimeout(this.show.bind(this,t),this.delay)),e.preventDefault()}.bind(c),f=function(){this._delayTimer&&(clearTimeout(this._delayTimer),delete this._delayTimer)}.bind(c)):p=function(e,t){this.show(t),e.preventDefault()}.bind(c);for(var d=c.total-1;d>=0;d--)e.event.addEvent(c._ctrls[d],r,p,new Number(d)),f&&e.event.addEvent(c._ctrls[d],"mouseout",f)}c.interval&&c.play()}},e.ui.Slide.prototype={show:function(t){var o=this;t=0>t?0:t>=o.total?o.total-1:t;var s=o._ctrls?o._ctrls[t]:null,n=o._contents[t];-1===o._curIndex&&(o._curIndex=0),e.style.removeCss(o._ctrls,o._css),e.style.removeCss(o._contents,o._css),e.style.addCss(s,o._css),e.style.addCss(n,o._css),o.onShow&&o.onShow(t,s,n),o._curIndex=t},showNext:function(){this.show(this.playMode(this._curIndex,this.total))},showPrevious:function(){this.show(this.rollbackMode(this._curIndex,this.total))},play:function(t){var o=this;if(isNaN(t)||(o.interval=parseInt(t)),!o._playTimer){if(!o._hasEvent){var s=o.pause.bind(o),n=o.play.bind(o);e.event.addEvent(o._ctrls,"mouseover",s),e.event.addEvent(o._ctrls,"mouseout",n),e.event.addEvent(o._contents,"mouseover",s),e.event.addEvent(o._contents,"mouseout",n),o._hasEvent=1}o._playTimer=setInterval(o.showNext.bind(o),o.interval)}},pause:function(){var e=this;if(e._playTimer&&(clearInterval(e._playTimer),delete e._playTimer,e.onStop)){var t=e._curIndex;e.onStop(t,e._ctrls[t],e._contents[t])}}}}(NTES),function(e,t){var o=e.NTES||{};o.ui||(o.ui={}),o.ui.version="0.1.9 Build 201005070941",o.ui.Template=function(){this._cache={}},o.ui.Template.prototype={get:function(e){return null==this._cache[e]?"":this._cache[e]},parse:function(e,t){return o.util.parseTpl(this.get(e),t)},load:function(e){var t;if(o.util.isArray(e))for(t=e.length;--t>=0;)this._cache[e[t].title]=e[t].innerHTML.replace(/(?:^\s*<!--)|(?:-->\s*$)/g,"");else for(t in e)e.hasOwnProperty(t)&&(this._cache[t]=e[t])}},o.ui.Template._cache={},o.ui.Template.get=o.ui.Template.prototype.get,o.ui.Template.parse=o.ui.Template.prototype.parse,o.ui.Template.load=function(e){e=e||o("#templates > *"),o.ui.Template.prototype.load.call(this,e)},o.ui.PopupLayer=function(e,t,s,n){if(arguments.length){var i=this;i.constructor=arguments.callee,i._ctrl=e,i._content=t,i.delay=isNaN(n)?300:n;var r=i.delayHide.bind(i),a=i.clearDelay.bind(i);o.event.addEvent(e,s,i.show.bind(i)),o.event.addEvent(e,"mouseout",r),o.event.addEvent(e,"mouseover",a),o.event.addEvent(t,"mouseover",a),o.event.addEvent(t,"mouseout",r)}},o.ui.PopupLayer.prototype={show:function(){o.style.addCss(this._content,"display:block;"),this.onShow&&this.onShow()},hide:function(){o.style.addCss(this._content,"display:none;"),this.onHide&&this.onHide()},delayHide:function(){this._timerId===t&&(this._timerId=setTimeout(this.hide.bind(this),this.delay))},clearDelay:function(){this._timerId!==t&&(clearTimeout(this._timerId),this._timerId=t)}};var s={left:function(e){var t=this,o=t._wrapper.scrollLeft+e;t._wrapper.scrollLeft=t._copy.offsetWidth-o<=0?o-t._body.offsetWidth:o},right:function(e){var t,o=this,s=o._wrapper.scrollLeft;0>=s&&(s+=o._body.offsetWidth),t=s-e,o._wrapper.scrollLeft=0>t?o._body.offsetWidth+t:t},top:function(e){var t=this,o=t._wrapper.scrollTop+e;t._wrapper.scrollTop=t._copy.offsetHeight-o<=0?o-t._body.offsetHeight:o},bottom:function(e){var t,o=this,s=o._wrapper.scrollTop;0>=s&&(s+=o._body.offsetHeight),t=s-e,o._wrapper.scrollTop=0>t?o._body.offsetHeight+t:t}};o.ui.Marquee=function(e,t,o,s){if(arguments.length){var n=this;n.constructor=arguments.callee,n._body=e,n._wrapper=e.parentNode,n._copy=document.createElement(e.tagName),n._copy.className=e.className,n._copy.innerHTML=e.innerHTML,n._wrapper.appendChild(n._copy),n._wrapper=n._wrapper.parentNode,t=t?t.toLowerCase():"left",n.setDirection(t),n.fps=isNaN(o)?15:o,n.lpf=isNaN(s)?1:s,n._timerIds=[]}},o.ui.Marquee.prototype={setDirection:function(e){if(this.move=s[e],!this.move)throw"not such direction"},_scroll:function(e){var t=this,o=t.lpf;t._isPause||(0!==e.length?(e.length>0&&(o=Math.min(e.length,o),e.length-=o),t.move(o)):(t.stop(),e.callback&&e.callback()))},start:function(){var e=this;if(0===e._timerIds.length){var s,n,i,r=arguments;switch(typeof r[0]){case"number":s=r[0],"string"==typeof r[1]?(n=r[1],i=r[2]):i=r[1];break;case"string":n=r[0],s=r[1],i=r[2]}n&&e.setDirection(n);var a={length:isNaN(s)?-1:parseInt(s)};a.length>0&&(a.callback=o.util.isFunction(i)?i:t),e._currentScroll=e._scroll.bind(e,a),e._timerIds.push(setInterval(e._currentScroll,e.fps))}},stop:function(){for(var e=this;e._timerIds.length;)clearInterval(e._timerIds.pop());e._currentScroll=t},speedUp:function(){var e=this;e._timerIds.length&&e._timerIds.push(setInterval(e._currentScroll,e.fps))},slowDown:function(){this._timerIds.length>1&&clearInterval(this._timerIds.pop())},go:function(){this._isPause=!1},stay:function(){this._isPause=!0}};var n=[31,28,31,30,31,30,31,31,30,31,30,31];o.ui.Calendar=function(e,t){this.constructor=arguments.callee,this.setDate(e,t)},o.ui.Calendar.prototype={getYear:function(){return this._year},getMonth:function(){return this._month+1},setDate:function(e,t){var o=new Date;this._year=isNaN(e)?o.getFullYear():e,this._month=isNaN(t)?o.getMonth():t-1},build:function(){var e,t,o,s=NTES.ui.Calendar.getDayCount(this._year,this._month+1),n=new Date(this._year,this._month,1),i=new Date,r=n.getDay(),a={year:this._year,month:this._month+1,weeks:[]},l=[];for(i.setHours(0,0,0,0),i=i.getTime();r-->0;)l.push({value:""});for(e=1;s>=e;e++)n.setDate(e),o=n.getTime(),t=o>i?1:i>o?-1:0,l.push({value:e,state:t}),7===l.length&&(a.weeks.push(l),l=[]);if(l.length%7!==0){for(;l.length<7;)l.push({value:""});a.weeks.push(l)}return a}},o.ui.Calendar.getDayCount=function(e,t){return 2==t?0==e%4&&0!=e%100||0==e%400?29:28:n[t-1]}}(window),function(e,t){var o=e.NTES||{};o.ui||(o.ui={});var s={forward:function(e){var t=this,o=t._bPos-e;o=o>0?o:0,t._setPos(o),0==o&&t.stop()},backward:function(e){var t=this,o=t._bPos+e;o=o<t._bRange?o:t._bRange,t._setPos(o),o==t._bRange&&t.stop()}};o.ui.Scroll=function(e,s,n){if(arguments.length){var i=this;if(i.constructor=arguments.callee,i._axis="y"==s?"y":"x",i._fix="x"==i._axis?{pos:"left",offsetSize:"offsetWidth",pageAxis:"pageX",offsetPos:"offsetLeft",scrollPos:"scrollLeft"}:{pos:"top",offsetSize:"offsetHeight",pageAxis:"pageY",offsetPos:"offsetTop",scrollPos:"scrollTop"},i.fps=13,i.lpf=10,i.speed=40,o.browser.msie&&(i.speed=20),i._body=e,i._bCnt=e.parentNode,i._bPos=0,i._bRange=Math.max(0,i._body[i._fix.offsetSize]-i._bCnt[i._fix.offsetSize]),n!==t){i._handle=n,i._hCnt=n.parentNode,i._hPos=0,i._hRange=Math.max(0,i._hCnt[i._fix.offsetSize]-i._handle[i._fix.offsetSize]),i.bhRate=i._hRange?i._bRange/i._hRange:0;var r=new o.ui.Mouse(i._handle);r.mouseStart=i._mouseStart.bind(i),r.mouseDrag=i._mouseDrag.bind(i),r.mouseStop=i._mouseStop.bind(i),o(i._hCnt).addEvent("click",i._mouseClick.bind(i))}}},o.ui.Scroll.prototype={start:function(e,o){var n=this;if(n._timer==t){e="forward"==e?"forward":"backward",n._move=s[e];var i={length:isNaN(o)?-1:parseInt(o)};n._timer=setInterval(n._scroll.bind(n,i),n.fps),n.onStart&&n.onStart()}},stop:function(){var e=this;return e._timer!==t&&(clearTimeout(e._timer),e._timer=t,e.onStop&&e.onStop()),this},scrollTo:function(e){var t=this,o=e-t._bPos;0>o?t.stop().start("forward",-1*o):t.stop().start("backward",o)},_scroll:function(e){var t=this,o=t.lpf;0!==e.length?(e.length>0&&(o=Math.min(t.lpf*Math.ceil(e.length/t.speed),e.length),e.length-=o),t._move(o)):t.stop()},_setPos:function(e){var t=this;t._bPos=e,t._bCnt[t._fix.scrollPos]=t._bPos,t._handle&&(t._hPos=t.bhRate?e/t.bhRate:0,t._handle.addCss(t._fix.pos+":"+t._hPos+"px"))},_mouseStart:function(e){var t=this;return t._diffPos=e[t._fix.pageAxis]-t._handle[t._fix.offsetPos],!0},_mouseDrag:function(e){var t=this,o=Math.max(0,Math.min(e[t._fix.pageAxis]-t._diffPos,t._hRange));return t._setPos(o*t.bhRate),!1},_mouseStop:function(e){return!1},_mouseClick:function(e){for(var t=this,o=t._hCnt,s=o[t._fix.offsetPos];o.offsetParent;)o=o.offsetParent,s+=o[t._fix.offsetPos];t.scrollTo((e[t._fix.pageAxis]-t._handle[t._fix.offsetSize]/2-s)*t.bhRate)}},o.ui.Mouse=function(e){var t=this;e=o(e),e.addEvent("mousedown",t._mouseDown.bind(t)).addEvent("click",function(e){return t._preventClickEvent?(t._preventClickEvent=!1,e.cancelBubble=!0,!1):void 0}),o.browser.msie&&(this._mouseUnselectable=e.attr("unselectable"),e.attr("unselectable","on")),this.started=!1},o.ui.Mouse.prototype={_mouseDown:function(e){var t=this;t._mouseStarted&&t._mouseUp(e),t._mouseDownEvent=e;var s=1==e.which;return s&&this.mouseCapture(e)?t._mouseDistanceMet(e)&&(t._mouseStarted=t.mouseStart(e)!==!1,!t._mouseStarted)?(e.preventDefault(),!0):(t._mouseMoveDelegate=t._mouseMove.bind(t),t._mouseUpDelegate=t._mouseUp.bind(t),o(document).addEvent("mousemove",t._mouseMoveDelegate).addEvent("mouseup",t._mouseUpDelegate),e.preventDefault(),!0):!0},_mouseMove:function(e){var t=this;return o.browser.msie&&!e.button?t._mouseUp(e):t._mouseStarted?(t.mouseDrag(e),e.preventDefault()):(t._mouseDistanceMet(e)&&(t._mouseStarted=t.mouseStart(t._mouseDownEvent,e)!==!1,t._mouseStarted?t.mouseDrag(e):t._mouseUp(e)),!t._mouseStarted)},_mouseUp:function(e){var t=this;return o(document).removeEvent("mousemove",t._mouseMoveDelegate).removeEvent("mouseup",t._mouseUpDelegate),t._mouseStarted&&(t._mouseStarted=!1,t._preventClickEvent=e.target==t._mouseDownEvent.target,t.mouseStop(e)),!1},_mouseDistanceMet:function(e){var t=this;return Math.max(Math.abs(t._mouseDownEvent.pageX-e.pageX),Math.abs(t._mouseDownEvent.pageY-e.pageY))>=1},mouseStart:function(e){},mouseDrag:function(e){},mouseStop:function(e){},mouseCapture:function(e){return!0}}}(window),function(e,t){var o=e.NTES||{};o.ui||(o.ui={});var s={forward:function(e){var t=this,o=Math.abs(t._bPos)-e;t._setPos(o),0==o&&t.stop()},backward:function(e){var t=this,o=t._bPos+e;o=o<t._bRange?o:t._bRange,t._setPos(o),o==t._bRange&&t.stop()}};o.ui.ScrollCarousel=function(e,s,n,i){if(arguments.length){var r=this;if(r.constructor=arguments.callee,r._axis="y"==s?"y":"x",r._fix="x"==r._axis?{pos:"left",offsetSize:"offsetWidth",pageAxis:"pageX",offsetPos:"left",scrollPos:"scrollLeft"}:{pos:"top",offsetSize:"offsetHeight",pageAxis:"pageY",offsetPos:"offsetTop",scrollPos:"scrollTop"},r.fps=i&&Math.ceil(i.fps/50)||13,r.fps=r.fps<13?13:r.fps,r.lpf=10,r.speed=40,o.browser.msie&&(r.speed=20),r._body=e,r._bCnt=e.parentNode,r._bRange=Math.max(0,r._body[r._fix.offsetSize]-r._bCnt[r._fix.offsetSize]),r._bPos=r._body.offsetLeft,o(r._bCnt).addCss("overflow:hidden"),n!==t){r._handle=n,r._hCnt=n.parentNode,r._hPos=0,r._hRange=Math.max(0,r._hCnt[r._fix.offsetSize]-r._handle[r._fix.offsetSize]),r.bhRate=r._hRange?r._bRange/r._hRange:0;var a=new o.ui.Mouse(r._handle);a.mouseStart=r._mouseStart.bind(r),a.mouseDrag=r._mouseDrag.bind(r),a.mouseStop=r._mouseStop.bind(r),o(r._hCnt).addEvent("click",r._mouseClick.bind(r))}}},o.ui.ScrollCarousel.prototype={start:function(e,o){var n=this;if(n._timer==t){e="forward"==e?"forward":"backward",n._move=s[e];var i={length:isNaN(o)?-1:parseInt(o)};n._timer=setInterval(n._scroll.bind(n,i),n.fps),n.onStart&&n.onStart()}},stop:function(){var e=this;return e._timer!==t&&(clearTimeout(e._timer),e._timer=t,e.onStop&&e.onStop()),this},scrollTo:function(e){var t=this,o=e;0>o?t.stop().start("forward",-1*o):t.stop().start("backward",o)},_scroll:function(e){var t=this,o=t.lpf;0!==e.length?(e.length>0&&(o=Math.min(t.lpf*Math.ceil(e.length/t.speed),e.length),e.length-=o),t._move(o)):t.stop()},_setPos:function(e){var t=this;t._bPos=e,t._body.style.left=-t._bPos+"px",t._handle&&(t._hPos=t.bhRate?e/t.bhRate:0,t._handle.addCss(t._fix.pos+":"+t._hPos+"px"))},_mouseStart:function(e){var t=this;return t._diffPos=e[t._fix.pageAxis]-t._handle[t._fix.offsetPos],!0},_mouseDrag:function(e){var t=this,o=Math.max(0,Math.min(e[t._fix.pageAxis]-t._diffPos,t._hRange));return t._setPos(o*t.bhRate),!1},_mouseStop:function(e){return!1},_mouseClick:function(e){for(var t=this,o=t._hCnt,s=o[t._fix.offsetPos];o.offsetParent;)o=o.offsetParent,s+=o[t._fix.offsetPos];t.scrollTo((e[t._fix.pageAxis]-t._handle[t._fix.offsetSize]/2-s)*t.bhRate)}},o.ui.Carousel=function(e,t,s,n){var i=this;if(i.ctrls=e,i.cons=t,i.css=s,i.defaults={auto:!1,interval:2e3,duration:5e3,pause:"mouseover",goOn:"mouseout",event:"mouseover",onSwitch:function(){},width:310},i.options=o.util.extend(i.defaults,n),i.event=i.options.event||i.defaults.event,i.btn={},i.scrol=[],i.step,i.btn.prev=i.options.prev,i.btn.next=i.options.next,i.current=null,!(arguments.length<3)){if(i.wrap=i.options.wrap||i.cons[0].parentNode,i.activeMap={prev:function(e){for(var t=e.previousSibling;t;t=t.previousSibling)if(1===t.nodeType&&t!==e)return t},next:function(e){for(var t=e.nextSibling;t;t=t.nextSibling)if(1===t.nodeType&&t!==e)return t}},i.consMap={first:function(e){return e[0]},last:function(e){return e[e.length-1]}},i.stepMap={x:function(e){return e.offsetWidth},y:function(e){return e.offsetHeight}},i.step=i.stepMap.x(i.cons[0]),i.step=i.step||i.options.width,i.current||(i.cons.each(function(e){this.className.indexOf(i.css)>-1&&(i.current=e)}),null===i.current&&(i.current=0,o(i.cons.get(0)).addCss(i.css)),i.options.onSwitch&&i.options.onSwitch(i.current+1,i.cons.length)),i.options.auto)try{o(i.wrap).addEvent(i.options.goOn,i.cycle.bind(i)),o(i.wrap).addEvent(i.options.pause,i.pause.bind(i))}catch(r){}i.ctrls&&i.ctrls[i.current]&&(o(i.ctrls[i.current]).addCss(i.css),i.ctrls.each(function(e){o(i.ctrls[e]).addEvent(i.event,function(){i.to(e)})})),i.btn.prev&&("click"!=i.event&&i.btn.prev.addEvent("click",function(e){return i.prev(),!1}),i.btn.prev.addEvent(i.event,i.prev.bind(i))),i.btn.next&&("click"!=i.event&&i.btn.next.addEvent("click",function(e){return i.next(),!1}),i.btn.next.addEvent(i.event,i.next.bind(i))),i.total=i.cons.length,i.cycle()}},o.ui.Carousel.prototype={getStyle:function(e,t){var o="";return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(e,"").getPropertyValue(t):e.currentStyle&&(t=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),o=e.currentStyle[t]),o},cycle:function(e){var t=this;return t.paused=!1,t.options.auto&&(t.interval=setInterval(function(){t.next()},t.options.interval)),this},to:function(e){var t=this;t.cons[t.current]||t.cons[0];if(!(e>t.cons.length-1||0>e))return t.current==e?t.pause().cycle():t.slide(e>t.current?"next":"prev",t.cons[e])},pause:function(e){var t=this;return t.paused=!0,clearInterval(t.interval),t.interval=null,t},next:function(e){var t=this;return e&&e.preventDefault(),t.sliding?void 0:t.slide("next")},prev:function(e){var t=this;return e&&e.preventDefault(),t.sliding?!1:t.slide("prev")},slide:function(e,s){var n,i,r=this,a=r.interval,l="next"==e?"left":"right",u="next"==e?"first":"last",c=r.options.onSwitch;if(n=r.cons[r.current]||r.cons[0],i=s||r.activeMap[e](n),i=i||r.consMap[u](r.cons),this.sliding=!0,a&&r.pause(),!(i.className.indexOf(r.css)>-1)){if((0==r.step||null==r.step)&&(r.step=r.stepMap.x(n),0==r.step||null==r.step))throw"carsousel slide get a wrong step";switch("left"==l?(o(n.parentNode).addCss("position:relative;width:"+2*r.step+"px;overflow:hidden;zoom:1;position:relative;left:0px;height:"+r.stepMap.y(n)+"px;"),o(n.parentNode.parentNode).addCss("position:relative;overflow:hidden;zoom:1;width:"+r.step+"px;"),o(i).addCss("position:absolute;top:0px;left:"+r.step+"px;zoom:1;display:block"),o(n).addCss("position:absolute;top:0px;left:0;display:block;zoom:1;")):(o(n.parentNode).addCss("position:relative;width:"+2*r.step+"px;overflow:hidden;zoom:1;position:relative;left:-"+r.step+"px;height:"+r.stepMap.y(n)+"px;"),o(n.parentNode.parentNode).addCss("position:relative;overflow:hidden;zoom:1;width:"+r.step+"px;"),o(i).addCss("position:absolute;top:0px;left:0px;zoom:1;display:block"),o(n).addCss("position:absolute;top:0px;left:"+r.step+"px;display:block;zoom:1;")),r.s=new NTES.ui.ScrollCarousel(n.parentNode,"x",t,{fps:r.options.duration}),r.cons.each(function(e){r.cons[e]==i&&(r.nextIndex=e)}),r.ctrls&&r.ctrls[r.current]&&(o(r.ctrls[r.current]).removeCss(r.css),r.ctrls[r.nextIndex]&&o(r.ctrls[r.nextIndex]).addCss(r.css)),r.s.onStart=function(){r.sliding=!0},r.s.onStop=function(){"left"==l?(n.removeCss(r.css),n.removeCss("position:absolute;top:0px;left:0;display:block;"),o(i).removeCss("left:"+r.step+"px;"),o(n.parentNode).removeCss("width:"+2*r.step+"px;left:-"+r.step+"px;"),i.addCss(r.css),r.sliding=!1):(n.removeCss(r.css),i.addCss(r.css),o(i.parentNode).removeCss("position:relative;width:"+2*r.step+"px;overflow:hidden;left:0px;"),o(i).removeCss("position:absolute;top:0px;left:0px;zoom:1;display:block"),o(n).removeCss("position:absolute;top:0px;left:"+r.step+"px;display:block;zoom:1;"),r.sliding=!1)},r.current=r.nextIndex,a&&r.cycle(),c&&c(r.current+1,r.cons.length),l){case"left":r.s.scrollTo(r.step);break;case"right":r.s.scrollTo(-r.step)}return r}}}}(window);
