(function(){function n(n,t){var u,r,i;for(typeof n!="string"||n.length===0,t=t||window,u=n.split("."),r=0;r<u.length;r++)i=u[r],typeof t[i]=="undefined"&&(t[i]={}),typeof t[i]!="object",t=t[i];return t}var t=n("microsoft.advertising.sdk.products");t.tools={createNS:n,fireImpression:function(n,t,i){var r=this.buildURL(n,t,i);this.sendImpression(r)},sendImpression:function(n){var t=new Image;t.src=n},buildURL:function(n,t,i){n.indexOf("?")===-1?n+="?":n.charAt(n.length-1)!=="?"&&n.charAt(n.length-1)!=="&"&&(n+="&");for(var r in t)t.hasOwnProperty(r)&&(!i||i[r])&&(n+=r+"="+t[r]+"&");return n+="msts="+ +new Date},perfData:{},monitorPerformance:function(n){this.perfData[n]={start:null,end:null},this.perfData[n].start=typeof performance!="undefined"&&typeof performance.now!="undefined"?performance.now():+new Date,this.perfRegistered||(dapMgr.addEventListener(dapMgr.eventTypes.AdRefreshed,this.perfResults),this.perfRegistered=!0)},perfResults:function(n){var t=microsoft.advertising.sdk.products.tools;t.perfData[n.ifrmid].end=typeof performance!="undefined"&&typeof performance.now!="undefined"?performance.now():+new Date},isNullOrUndefined:function(n){return typeof n=="undefined"||n===null}}})();function verifyDapResize(n){var t=dapMgr.adCont;dapMgr.fireEvent(dapMgr.eventTypes.BeforeAdRender,{ifrmid:t[n].ifrmid,divid:t[n].divid}),t[n].resizeCalled||dap_Resize(t[n].ifrmid,t[n].w,t[n].h)}function dap_Resize(n,t,i){var r=document.getElementById(n);r&&(r.width=t,r.height=i,t>0&&i>0&&dapMgr.saveAdResize(n,t,i))}function setCreativeData(n,t){dapMgr.creativeData[n]=t,t.Viewability&&t.Viewability=="true"&&microsoft.advertising.sdk.products.viewability.viewableImpression(50,document.getElementById(n),t),t.DISABLEIAF&&t.DISABLEIAF=="0"&&dapMgr.startIAF(n,t)}function ShowAcb(){}var _dapUtils=new function(){var n=navigator.userAgent.toLowerCase(),f=navigator.appVersion.toLowerCase(),i=parseFloat(f),u=parseInt(i),s=n.indexOf("mac")!=-1,o,e,r,t;this.is_opera=n.indexOf("opera")!=-1,this.is_ff=n.indexOf("firefox")!=-1,e=f.indexOf("trident/"),e!=-1&&(o=parseFloat(f.substr(e+8,3))),r=f.indexOf("msie"),r!=-1&&(s?(r=n.indexOf("msie"),i=parseFloat(n.substring(r+5,n.indexOf(";",r)))):i=parseFloat(f.substring(r+5,f.indexOf(";",r))),u=parseInt(i)),r==-1&&e!=-1&&(i=parseFloat(o)+4,u=parseInt(i)),t=(r!=-1||e!=-1)&&!this.is_opera,this.is_ie=t,this.is_ie5up=t&&i>=5,this.is_ie5_5=t&&n.indexOf("msie 5.5")!=-1,this.is_ie5_5up=t&&i>=5.5,this.is_ie6=t&&u==6,this.is_ie6up=t&&i>=6,this.is_ie9=t&&u==9,this.is_ie9down=t&&i<=9,this.is_ie9up=t&&i>=9,this.is_trident4up=t&&o>=4,this.is_trident5up=t&&o>=5,this.is_trident6up=t&&o>=6,this.is_win=n.indexOf("win")!=-1||n.indexOf("16bit")!=-1,s&&(this.is_win=!s),this.is_ff&&(this.ffPos=n.indexOf("firefox"),n.length>this.ffPos+8&&(u=parseInt(n.substring(this.ffPos+8))),n.length>this.ffPos+10&&(i=parseInt(n.substring(this.ffPos+10)))),this.is_mac=s,this.minorVer=i,this.majorVer=u,this.getCurrentStyle=function(n){return window.getComputedStyle?window.getComputedStyle(n,null)?window.getComputedStyle(n,null):document.defaultView.getComputedStyle(n,null):n.currentStyle}},dapMgr=new function(){var t=["//rad.msn.com/ADSAdClient31.dll?GetSAd=","//a.rad.msn.com/ADSAdClient31.dll?GetSAd=","//b.rad.msn.com/ADSAdClient31.dll?GetSAd="],s,e,f,n,u,h,o,i,r;this.creativeData={},this.debug=!1,this._instOn=!1,this._noAdOn=!1,this._isTest=!1,s=0,this.tools=microsoft.advertising.sdk.products.tools,e=100,f=_dapUtils.is_ie&&_dapUtils.majorVer<8?2:6,this.adCont=[],this.unblockingOnLoad=!1,this.eventTypes={AdRequested:"AdRequested",BeforeAdRender:"BeforeAdRender",AdRefreshed:"AdRefreshed",ErrorOccurred:"ErrorOccurred",EngagedIAF:"EngagedIAF"},u="",h=18e5,this.renderAd=function(n,i,r,u,f){f=false;var s,h,c,l;dapMgr.refresh(n),s=i.split("+"),s&&s[0]==="test"?(t=["","",""],i=s[1],this._isTest=!0):s&&s[0]==="creative"?(this._isTest=!0,t=["http://rad.msn.com/ADSAdClient31.dll?GetSCreative?cid="+s[1],"http://a.rad.msn.com/ADSAdClient31.dll?GetSCreative?cid="+s[1],"http://b.rad.msn.com/ADSAdClient31.dll?GetSCreative?cid="+s[1]]):s&&s[0]==="si"?(this._isTest=!0,t=["http://rad1.dap.msn-tst.com/ADSAdClient31.dll?GetSCreative?cid="+s[1],"http://rad1.dap.msn-tst.com/ADSAdClient31.dll?GetSCreative?cid="+s[1],"http://rad1.dap.msn-tst.com/ADSAdClient31.dll?GetSCreative?cid="+s[1]]):this._isTest&&(t=["//rad.msn.com/ADSAdClient31.dll?GetSAd=","//a.rad.msn.com/ADSAdClient31.dll?GetSAd=","//b.rad.msn.com/ADSAdClient31.dll?GetSAd="]),f&&!dapMgr._instOn&&(dapMgr.addEventListener(dapMgr.eventTypes.ErrorOccurred,microsoft.advertising.sdk.products.instrumentation.errorOccurredCallback),dapMgr._instOn=!0),h=this.adCont,c=dapMgr.getAdItemIndex(n);if(c>-1)h[c].qs=i,h[c].divid=n,h[c].w=r,h[c].h=u;else{if(h.length<e)l=new o(i,n,"dapIfM"+h.length,r,u),h.push(l);else return;c=h.length-1}dapMgr.debug==!0&&microsoft.advertising.sdk.products.tools.monitorPerformance(h[c].ifrmid),dapMgr.displayAd(c)},this.refresh=function(n){var i=dapMgr.getAdItemIndex(n),t;if(i==-1)return;t=dapMgr.adCont[i];if(!t)return;microsoft.advertising.sdk.products.viewability.stopTimer(t.ifrmid)},this.displayAd=function(n){var u=dapMgr.adCont,e=t[Math.floor(s++%(t.length*f)/f)],o=document.getElementById(u[n].divid),l,a,h,i,v,c;if(!o)return;if(!u[n].qs||u[n].qs.length==0)return;l=_dapUtils.getCurrentStyle(o);if(l){a=l.display;if(a=="none"||a=="hidden")return}h=u[n].ifrmid,dapMgr.hasEvent(dapMgr.eventTypes.ErrorOccurred)&&!dapMgr._noAdOn&&(dapMgr.addEventListener(dapMgr.eventTypes.AdRefreshed,dapMgr.checkNoAd),dapMgr._noAdOn=!0),i=document.createElement("iframe"),i.id=h,i.name=h,i.src="about:blank",i.width=u[n].w,i.height=u[n].h,i.scrolling="no",i.frameBorder="0",i.allowTransparency=!0;if(e.length>0){e+="&DPJS=8.4",e+=microsoft.advertising.sdk.products.viewability.canReachTop==!0?"&VWS=1":"&VWS=0";try{e+=dapMgr.appendBlacklist()}catch(y){}}(r.indexOf("&ID=")===-1||r.indexOf("&MUID=")===-1)&&(r=dapMgr.dapQSTracking()),e+=r,v=u[n].qs.replace(/'/g,""),c=dapMgr.getDapOutput(e+v,h,n);if(_dapUtils.is_ie&&(_dapUtils.is_trident5up||dapMgr.unblockingOnLoad==!0&&(_dapUtils.majorVer>=8||_dapUtils.is_trident4up)))o.insertBefore(i,o.firstChild),dapMgr.setOnloadHandler(i,function(){dapMgr.onloadHandler(i,n,c,u)});else{o.insertBefore(i,o.firstChild);dapMgr.onloadHandler(i,n,c,u)}},this.appendBlacklist=function(){var t,i,r,u;if(localStorage==null)return"";t=localStorage.getItem("MSIAF_CID_BL");if(t==null)return"";var e=new Date,f=e.getTime(),n=t.split(":");if(isNaN(n[0]))return localStorage.removeItem("MSIAF_CID_BL"),"";i=parseInt(n[0]);if(i>f)return localStorage.removeItem("MSIAF_CID_BL"),"";r=f-i,u=r>h;if(u||!n[1])localStorage.removeItem("MSIAF_CID_BL");else return"&RTBLOCKCRE="+n[1];return""},this.getDapOutput=function(n,t,i){var r='<html><head><title>Advertisement</title></head><body id="'+t+'" leftmargin="0" topmargin="0" style="background-color:transparent"><script type="text/javascript">var inDapIF=true; var inDapMgrIf=true; var hasVerified=false; var idx ='+i+";";return document.domain&&location.hostname!=document.domain&&(r+='document.domain="'+document.domain+'";'),r+='<\/script><script type="text/javascript">function startTimer() {if (event.srcElement.readyState == "complete" && !hasVerified) {hasVerified = true; parent.verifyDapResize(idx); window.setTimeout("document.close();", 2000);}}function loadCallback() {if (!hasVerified) {hasVerified = true; parent.verifyDapResize(idx);}}',r+=dapMgr.debug==!0?dapMgr.iafPluginString:'(function iaf(){window.iafPlugin={iafData:{},categoryFeedbackUrl:"//ads1.msads.net/CAE/IAFScreens/CategoryFeedback.html",thankYouUrl:"//ads1.msads.net/CAE/IAFScreens/thankYou.html",closeXToolTip:"Don\'t like this ad",expireTime:18e5,URL_LOAD_DELAY:100,supportLevel:"none",fullSizes:[[300,250],[300,600],[728,90],[650,170],[160,600],[160,555]],mediumSizes:[[234,60],[320,50]],xImage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABJUlEQVQ4y82SP0uFYBTGxUUXEdwddHfxszj4PRwFd0FXhbhdzIhEQYhwCrOhK9zqQpegwSBwbHARzfBvHkiIQAkaug8ceHl4z+895+FFEAQ5+mMdEgDH8dWoe9d19xiGrSafoqg1eIqi3CwCBEG4KIqi6vt+sG17N0F9338aRqVpmvE8fz4LoGn6xDTNu7ZtOyhoDILgGYBlWX7IsnwN0yxmAC+qqnpbVVXddV0PyvP8XZKkKxRFfxciy7KnSZK8DV8KwzD5nskiANaIougFGmGCaZ0x3AeCII4XARzHncVx/ArNdV23nuftLcvawRk8x3EeGYaxZwEQUtM0HexvGMZ28iHY0W+zLCtEUbycBZAkuR4vb3Vd3/wcFYCapm0O/Cv/C+ATPSAuJEiHpasAAAAASUVORK5CYII=",loadIAF:function(e){if(Date.now||(Date.now=function(){return(new Date).getTime()}),this.iafData=e,this.supportLevel=this.getSupportLevel(e),"none"===this.supportLevel)return void(this.validateImpressionData(e)&&this.fireBeacon("IAFI",{disable:"true"}));var t=document.createElement("img");t.style.position="absolute",t.style.right="0px",t.style.top="0px",t.style.cursor="pointer",t.style.zIndex=2147483647,t.width=16,t.height=16,t.title=this.closeXToolTip;var i=this;t.onclick=function(){i.closeClicked(i)},t.src=this.xImage,document.body.appendChild(t)},getSupportLevel:function(e){if(!e||!e.width||!e.height||isNaN(e.width)||isNaN(e.height)||"string"!=typeof e.IAFCategories||"string"!=typeof e.IAFScreen||!this.validateImpressionData(e))return"none";var t=parseInt(e.width,10),i=parseInt(e.height,10);if(!isNaN(e.IAFCategories)&&-1===parseInt(e.IAFCategories,10))return"medium";for(var a=0;a<this.fullSizes.length;a++)if(t===this.fullSizes[a][0]&&i===this.fullSizes[a][1])return"full";for(a=0;a<this.mediumSizes.length;a++)if(t===this.mediumSizes[a][0]&&i===this.mediumSizes[a][1])return"medium";return"none"},validateImpressionData:function(e){return e&&"string"==typeof e.GBING&&0!==e.GBING.length&&"string"==typeof e.CID&&0!==e.CID.length&&("string"==typeof e.ANID&&0!==e.ANID.length||"string"==typeof e.MUID&&0!==e.MUID.length)?!0:!1},closeClicked:function(e){e.iafData&&e.iafData.platform&&"web"===e.iafData.platform&&e.blacklistCID(e.iafData.CID),e.fireBeacon("feedback",{Action:"dislike"}),e.loadScreen("full"===e.supportLevel?e.categoryFeedbackUrl:e.thankYouUrl)},loadScreen:function(e){e+="#";for(var t in this.iafData)this.iafData.hasOwnProperty(t)&&(e+=t+"="+this.iafData[t]+"&");setTimeout(function(){window.location.href=e},this.URL_LOAD_DELAY)},blacklistCID:function(e){if(null!==e&&"string"==typeof e&&""!==e&&"undefined"!=typeof window.localStorage&&null!=window.localStorage){var t=localStorage.getItem("MSIAF_CID_BL"),i=Date.now();if(null===t)localStorage.setItem("MSIAF_CID_BL",i+":"+e);else{var a=t.split(":"),n=a[0],o=a[1]?a[1].split("."):[];(isNaN(n)||i-parseInt(n,10)>this.expireTime)&&(o=[],localStorage.removeItem("MSIAF_CID_BL")),-1===o.indexOf(e)&&o.push(e),localStorage.setItem("MSIAF_CID_BL",i+":"+o.join("."))}}},fireBeacon:function(e,t){t="object"==typeof t?t:{},t.ANID=this.iafData.ANID,t.MUID=this.iafData.MUID,t.ASID="string"==typeof this.iafData.ASID?this.iafData.ASID:"";var i=this.buildURL(this.iafData.GBING+"/"+e+"/"+this.iafData.CID,t),a=new Image;a.onabort=a.onload=a.onerror=function(){a.onabort=a.onload=a.onerror=null,a.src=""},a.src=i},buildURL:function(e,t){-1===e.indexOf("?")?e+="?":"?"!==e.charAt(e.length-1)&&"&"!==e.charAt(e.length-1)&&(e+="&");for(var i in t)t.hasOwnProperty(i)&&(e+=i+"="+t[i]+"&");return e+="msts="+ +new Date}}}());',r+='function onerrorClosure(error, url, lineNumber, column, errorObj) {parent.dapMgr.fireEvent(parent.dapMgr.eventTypes.ErrorOccurred, { "errorType": "CreativeError", "ifrmid": parent.dapMgr.adCont[idx].ifrmid, "divid": parent.dapMgr.adCont[idx].divid, "error": error, "url": url, "lineNumber": lineNumber, "column": column, "errorObj": errorObj });}window.onerror = onerrorClosure;<\/script><script type="text/javascript" onerror="parent.dapMgr.radError('+i+')" src="'+n+'" onreadystatechange="startTimer();" onload="loadCallback();"><\/script></body></html>'},this.onloadHandler=function(n,t,i,r){var u;try{u=n.contentDocument||n.contentWindow.document}catch(f){u=null}u&&u.write?(u.write(i),dapMgr.fireEvent(dapMgr.eventTypes.AdRequested,{ifrmid:r[t].ifrmid,divid:r[t].divid,ifrm:n}),_dapUtils.is_ie9down||_dapUtils.is_opera||u.close()):n.src="javascript:'"+i+"'"},this.enableUnblockingOnload=function(n){dapMgr.unblockingOnLoad=n,n==!0&&dapMgr.setOnloadHandler(window,function(){dapMgr.enableUnblockingOnload(!1)})},o=function(n,t,i,r,u){this.qs=n,this.divid=t,this.ifrmid=i,this.w=r,this.h=u,this.resizeCalled=!1},this.lg=function(n){this.debug&&console.log(n)},this.getLocale=function(){if(u!="")return u;try{if(window.navigator){if(window.navigator.language)return window.navigator.language;if(window.navigator.browserLanguage)return window.navigator.browserLanguage;if(window.navigator.systemLanguage)return window.navigator.systemLanguage;if(window.navigator.userLanguage)return window.navigator.userLanguage}return null}catch(n){return null}},this.setLocale=function(n){if(typeof n!="string")return;u=n},this.saveAdResize=function(n,t,i){for(var u=this.adCont,r=0;r<u.length;r++)if(u[r].ifrmid==n){u[r].w=t,u[r].h=i,u[r].resizeCalled=!0;return}},this.enableACB=function(){},this.getAdItemIndex=function(n){for(var t=0;t<dapMgr.adCont.length;t++)if(dapMgr.adCont[t].divid==n)return t;return-1},this.getAdItemIndexByIFrameId=function(n){for(var t=0;t<dapMgr.adCont.length;t++)if(dapMgr.adCont[t].ifrmid==n)return t;return-1},this.setOnloadHandler=function(n,t){var i=function(){n.attachEvent?(n.detachEvent("onload",i),t()):n.addEventListener&&(n.removeEventListener("load",i,!1),t())};n.attachEvent?n.attachEvent("onload",i):n.addEventListener&&n.addEventListener("load",i,!1)},this.startIAF=function(n,t){var r,i;if(!window.frames[n].iafPlugin)return;r=document.getElementById(n),t.locale=dapMgr.getLocale(),t.height=r.height,t.width=r.width,t.scale=1,t.platform="web",i=dapMgr.getAdItemIndexByIFrameId(n),i!=-1&&(t.idx=i),window.frames[n].iafPlugin.loadIAF(t)},this.engagedIAF=function(n){dapMgr.fireEvent(dapMgr.eventTypes.EngagedIAF,{started:n.started,ifrmid:dapMgr.adCont[n.idx].ifrmid,divid:dapMgr.adCont[n.idx].divid})},this.radError=function(n){dapMgr.fireEvent(dapMgr.eventTypes.ErrorOccurred,{errorType:"ServerSideError",ifrmid:dapMgr.adCont[n].ifrmid,divid:dapMgr.adCont[n].divid})},i=function(n,t,i){var u,r;if(n!=null){u=n.toLowerCase().indexOf(t.toLowerCase()+"=");if(u!=-1)return u+=t.length+1,r=n.indexOf(i,u),r=r==-1?n.length:r,n.substring(u,r)}return""},this.dapQSTracking=function(){var u=document.cookie,f=escape(i(u,"mh",";")),r=f!=""?"&PN="+f:"",n=escape(i(i(u,"ANON",";"),"A","&")),t=escape(i(u,"MUID",";"));return n==""&&(n=t),r+=n!=""?"&ID="+n:"",r+=t!=""?"&MUID="+t:""},this.addEventListener=function(t,i){if(t===null||typeof t!="string")return;if(i===null||typeof i!="function")return;n==null&&(n=[]),n[t]==null&&(n[t]=[]),n[t].push(i)},this.hasEvent=function(t){return n&&n[t]!=null&&n[t].length>0},this.removeEventListener=function(t,i){var u,r,f;if(t===null||typeof t!="string")return;if(i===null||typeof i!="function")return;if(n===null)return;u=n[t];if(u===null)return;for(r=0;r<u.length;r++)if(u[r]==i){f=u.splice(r,1);break}},this.fireEvent=function(t,i){var u,f,r;if(t===null||typeof t!="string")return;t==dapMgr.eventTypes.AdRequested&&dapMgr.hasEvent(dapMgr.eventTypes.AdRefreshed)&&i&&i.ifrmid&&typeof i.ifrmid=="string"&&(u=document.getElementById(i.ifrmid),u!=null&&dapMgr.setupAdRefreshedEvent(i,u));if(dapMgr.hasEvent(t))for(f=n[t],r=0;r<f.length;r++)f[r](i)},this.setupAdRefreshedEvent=function(t,i){var u=n[dapMgr.eventTypes.AdRefreshed],f=dapMgr.getAdItemIndexByIFrameId(t.ifrmid),r;if(f==-1)return;r=dapMgr.adCont[f].divid;if(!r)return;dapMgr.setOnloadHandler(i,function(){for(var n=0;n<u.length;n++)u[n]({ifrmid:t.ifrmid,divid:r})})},this.checkNoAd=function(n){var i,t;if(dapMgr.tools.isNullOrUndefined(n)||dapMgr.tools.isNullOrUndefined(n.ifrmid))return;i=document.getElementById(n.ifrmid);if(dapMgr.tools.isNullOrUndefined(i))return;t=i.contentDocument||i.contentWindow.document;if(dapMgr.tools.isNullOrUndefined(t)||dapMgr.tools.isNullOrUndefined(t.body)||dapMgr.tools.isNullOrUndefined(t.body.innerHTML))return;var r=t.body.innerHTML,f=r.substring(r.length-200,r.length),u=f.match(/<!--NOAD-->/g);dapMgr.tools.isNullOrUndefined(u)||dapMgr.fireEvent(dapMgr.eventTypes.ErrorOccurred,{errorType:"NoAdAvailable",ifrmid:n.ifrmid,divid:n.divid,ifrm:i})},r=this.dapQSTracking(),this.iafPlugin=function(){window.iafPlugin={iafData:{},categoryFeedbackUrl:"//ads1.msads.net/CAE/IAFScreens/CategoryFeedback.html",thankYouUrl:"//ads1.msads.net/CAE/IAFScreens/thankYou.html",closeXToolTip:"Don't like this ad",expireTime:18e5,URL_LOAD_DELAY:100,supportLevel:"none",fullSizes:[[300,250],[300,600],[728,90],[650,170],[160,600],[160,555]],mediumSizes:[[234,60],[320,50]],xImage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABJUlEQVQ4y82SP0uFYBTGxUUXEdwddHfxszj4PRwFd0FXhbhdzIhEQYhwCrOhK9zqQpegwSBwbHARzfBvHkiIQAkaug8ceHl4z+895+FFEAQ5+mMdEgDH8dWoe9d19xiGrSafoqg1eIqi3CwCBEG4KIqi6vt+sG17N0F9338aRqVpmvE8fz4LoGn6xDTNu7ZtOyhoDILgGYBlWX7IsnwN0yxmAC+qqnpbVVXddV0PyvP8XZKkKxRFfxciy7KnSZK8DV8KwzD5nskiANaIougFGmGCaZ0x3AeCII4XARzHncVx/ArNdV23nuftLcvawRk8x3EeGYaxZwEQUtM0HexvGMZ28iHY0W+zLCtEUbycBZAkuR4vb3Vd3/wcFYCapm0O/Cv/C+ATPSAuJEiHpasAAAAASUVORK5CYII=",loadIAF:function(n){var t,i;Date.now||(Date.now=function(){return+new Date}),this.iafData=n,this.supportLevel=this.getSupportLevel(n);if(this.supportLevel==="none"){parent.dapMgr.lg("IAFplugin.loadIAF() support=none;"),this.validateImpressionData(n)&&this.fireBeacon("IAFI",{disable:"true"});return}parent.dapMgr.lg("IAFplugin.loadIAF() showing X;"),t=document.createElement("img"),t.style.position="absolute",t.style.right="0px",t.style.top="0px",t.style.cursor="pointer",t.style.zIndex=2147483647,t.width=16,t.height=16,t.title=this.closeXToolTip,i=this,t.onclick=function(){i.closeClicked(i)},t.src=this.xImage,document.body.appendChild(t)},getSupportLevel:function(n){var i,r,t;if(!n||!n.width||!n.height||isNaN(n.width)||isNaN(n.height)||typeof n.IAFCategories!="string"||typeof n.IAFScreen!="string"||!this.validateImpressionData(n))return parent.dapMgr.lg("IAFplugin.getSupportLevel() none; invalid data"),"none";i=parseInt(n.width,10),r=parseInt(n.height,10);if(!isNaN(n.IAFCategories)&&parseInt(n.IAFCategories,10)===-1)return parent.dapMgr.lg("IAFplugin.getSupportLevel() medium; categories -1"),"medium";for(t=0;t<this.fullSizes.length;t++)if(i===this.fullSizes[t][0]&&r===this.fullSizes[t][1])return parent.dapMgr.lg("IAFplugin.getSupportLevel() full; supported size"),"full";for(t=0;t<this.mediumSizes.length;t++)if(i===this.mediumSizes[t][0]&&r===this.mediumSizes[t][1])return parent.dapMgr.lg("IAFplugin.getSupportLevel() medium; medium size"),"medium";return parent.dapMgr.lg("IAFplugin.getSupportLevel() none; invalid size"),"none"},validateImpressionData:function(n){return!n||typeof n.GBING!="string"||n.GBING.length===0||typeof n.CID!="string"||n.CID.length===0?(parent.dapMgr.lg("IAFplugin.validateImpressionData() false; data or GBING or CID invalid"),!1):(typeof n.ANID!="string"||n.ANID.length===0)&&(typeof n.MUID!="string"||n.MUID.length===0)?(parent.dapMgr.lg("IAFplugin.validateImpressionData() false; ANID and MUID invalid"),!1):!0},closeClicked:function(n){n.iafData&&n.iafData.platform&&n.iafData.platform==="web"&&n.blacklistCID(n.iafData.CID),parent.dapMgr.engagedIAF({started:!0,idx:n.iafData.idx,CID:n.iafData.CID}),n.fireBeacon("feedback",{Action:"dislike"}),n.supportLevel==="full"?n.loadScreen(n.categoryFeedbackUrl):n.loadScreen(n.thankYouUrl)},loadScreen:function(n){parent.dapMgr.lg("IAFplugin.loadScreen() "+n),n+="#";for(var t in this.iafData)this.iafData.hasOwnProperty(t)&&(n+=t+"="+this.iafData[t]+"&");setTimeout(function(){parent.dapMgr.lg("IAFplugin.loadScreen() redirecting to:"+n),window.location.href=n},this.URL_LOAD_DELAY)},blacklistCID:function(n){var r,i;if(n===null||typeof n!="string"||n==="")return;if(typeof window.localStorage=="undefined"||window.localStorage==null)return;r=localStorage.getItem("MSIAF_CID_BL"),i=Date.now();if(r===null)localStorage.setItem("MSIAF_CID_BL",i+":"+n);else{var u=r.split(":"),f=u[0],t=u[1]?u[1].split("."):[];(isNaN(f)||i-parseInt(f,10)>this.expireTime)&&(t=[],localStorage.removeItem("MSIAF_CID_BL")),Array.prototype.indexOf||(Array.prototype.indexOf=function(n,t){for(var i=t||0,r=this.length;i<r;i++)if(this[i]===n)return i;return-1}),t.indexOf(n)===-1&&t.push(n),localStorage.setItem("MSIAF_CID_BL",i+":"+t.join("."))}},fireBeacon:function(n,t){var r,i;t=typeof t=="object"?t:{},t.ANID=this.iafData.ANID,t.MUID=this.iafData.MUID,t.ASID=typeof this.iafData.ASID=="string"?this.iafData.ASID:"",r=this.buildURL(this.iafData.GBING+"/"+n+"/"+this.iafData.CID,t),parent.dapMgr.lg("IAFplugin.fireBeacon; trackingURL : "+r),i=new Image,i.onabort=i.onload=i.onerror=function(){i.onabort=i.onload=i.onerror=null,i.src=""},i.src=r},buildURL:function(n,t){n.indexOf("?")===-1?n+="?":n.charAt(n.length-1)!=="?"&&n.charAt(n.length-1)!=="&"&&(n+="&");for(var i in t)t.hasOwnProperty(i)&&(n+=i+"="+t[i]+"&");return n+="msts="+ +new Date}}}};(function(){var n=microsoft.advertising.sdk.products.tools,i="/_ClientSDK/Inst",r="//g.msn.com",t="";microsoft.advertising.sdk.products.instrumentation={errorOccurredCallback:function(u){var f;if(n.isNullOrUndefined(u))return;if(n.isNullOrUndefined(u.errorType))return;if(u.errorType=="NoAdAvailable")return;if(u.errorType=="ServerSideError")t=r+i,f={errcode:"C000001",plat:"web"};else if(u.errorType=="CreativeError"){if(n.isNullOrUndefined(u.ifrmid))return;if(n.isNullOrUndefined(dapMgr.creativeData[u.ifrmid]))return;if(n.isNullOrUndefined(dapMgr.creativeData[u.ifrmid].CID))return;if(n.isNullOrUndefined(dapMgr.creativeData[u.ifrmid].GSERV))return;if(n.isNullOrUndefined(dapMgr.creativeData[u.ifrmid].ASID))return;t=dapMgr.creativeData[u.ifrmid].GSERV+i+"?",f={PG:dapMgr.creativeData[u.ifrmid].PG,ASID:dapMgr.creativeData[u.ifrmid].ASID,CID:dapMgr.creativeData[u.ifrmid].CID,errcode:"C000010",plat:"web"}}n.fireImpression(t,f)}}})();(function(){var n=microsoft.advertising.sdk.products.tools,o=1e3,c,u,s="/view/",t,i,r,e={PID:!0,UIT:!0,TargetID:!0,PG:!0,ASID:!0,ANID:!0,FN:!0},f;microsoft.advertising.sdk.products.viewability={impressionEvents:{Viewed:"EV",ViewabilityUndetermined:"EVU"},canReachTop:!0,webViewViewable:!0,viewableAds:{},checkAll:function(){for(var n in this.viewableAds)this.viewableAds.hasOwnProperty(n)&&this.checkViewability(n)},checkViewability:function(t){if(!this.viewableAds[t])return;if(n.isNullOrUndefined(this.viewableAds[t].ifrm)){delete this.viewableAds[t],this.objectSize(this.viewableAds)>0||this.destroy();return}if(!document.hasFocus())return;if(!this.webViewViewable)return;var i=this.percentOfAdOnWebpage(this.viewableAds[t].ifrm);if(i<this.viewableAds[t].percent)return;this.startTimer(t,i)},objectSize:function(n){var i=0,t;for(t in n)n.hasOwnProperty(t)&&i++;return i},deleteEntry:function(n){delete this.viewableAds[n],this.objectSize(this.viewableAds)>0||this.destroy()},viewableImpression:function(u,f,e){if(this.canReachTop==!1)return;if(n.isNullOrUndefined(e))return;if(n.isNullOrUndefined(e.GSERV))return;e.CID||(e.CID="");if(n.isNullOrUndefined(f))return;if(n.isNullOrUndefined(u))return;if(this.invalidPercentage(u))return;var o=this,s=u/100;this.viewableAds[f.id]={percent:s,ifrm:f,creativeData:e,url:e.GSERV,viewableCheckTimer:null},this.checkViewability(f.id),this.objectSize(this.viewableAds)>1||(t=function(){o.restartAllTimers()},i=function(){o.restartAllTimers()},r=function(){o.restartAllTimers()},this.registerEvent(top,"scroll","onscroll",t),this.registerEvent(top,"resize","onresize",i),this.registerEvent(top,"focus","onfocus",r))},startTimer:function(t,i){var r=this;i=Math.round(i*100),clearTimeout(this.viewableAds[t].viewableCheckTimer),this.viewableAds[t].viewableCheckTimer=setTimeout(function(){if(n.isNullOrUndefined(r.viewableAds[t]))return;n.fireImpression(r.viewableAds[t].url+s+r.viewableAds[t].creativeData.CID+"?EVT="+r.impressionEvents.Viewed+"&PER="+i,r.viewableAds[t].creativeData,e),r.deleteEntry(t)},o)},restartAllTimers:function(){var n,t;clearTimeout(u);for(n in this.viewableAds)this.viewableAds.hasOwnProperty(n)&&this.viewableAds[n].viewableCheckTimer&&clearTimeout(this.viewableAds[n].viewableCheckTimer);t=this,u=setTimeout(function(){t.checkAll()},200)},stopTimer:function(n){var i=this.viewableAds[n],t;if(!i)return;t=i.viewableCheckTimer;if(!t)return;clearTimeout(t)},registerEvent:function(n,t,i,r){n.addEventListener?n.addEventListener(t,r,!1):n.attachEvent&&n.attachEvent(i,r)},removeEvent:function(n,t,i,r){n.addEventListener?n.removeEventListener(t,r,!1):n.attachEvent&&n.detachEvent(i,r)},invalidPercentage:function(n){return n>100||n<0},percentOfAdOnWebpage:function(n){var t=n.getBoundingClientRect(),o=top.innerWidth||top.document.documentElement.clientWidth,f=top.innerHeight||top.document.documentElement.clientHeight,i,r;if(t.top>f)return 0;var a=parseInt(t.top),l=parseInt(t.bottom),y=parseInt(t.right),v=parseInt(t.left),e=y-v,u=l-a;if(u<=2||e<=2)return 0;i=e,r=u,t.left<0?(i=Math.max(0,t.left+e),i>o&&(i=o)):t.left+e>o&&(i=Math.max(0,o-t.left)),t.top<0?(r=Math.max(0,t.top+u),r>f&&(r=f)):t.top+u>f&&(r=Math.max(0,f-t.top));var h=Math.max(1,u*e),s=i*r;return s/h},destroy:function(){t&&this.removeEvent(top,"scroll","onscroll",t),i&&this.removeEvent(top,"resize","onresize",i),r&&this.removeEvent(top,"focus","onfocus",r)},lg:function(){typeof dapMgr!="undefined"}};try{f=top.document,self!==top&&(microsoft.advertising.sdk.products.viewability.canReachTop=!1)}catch(h){microsoft.advertising.sdk.products.viewability.canReachTop=!1}f===undefined&&(microsoft.advertising.sdk.products.viewability.canReachTop=!1)})();typeof define=="function"&&define.amd&&define("dapmgr",[],function(){return dapMgr})