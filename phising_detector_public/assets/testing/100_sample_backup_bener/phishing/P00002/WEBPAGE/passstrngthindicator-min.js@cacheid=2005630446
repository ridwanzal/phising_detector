USAA.namespace("ec");USAA.ec.PassStrngthIndicator=function(K){var O=YAHOO.util.Dom;var H=YAHOO.util.Event;var B=K.rulesObj||USAA.ec.PassStrngthDefltRulesConfig;var Q=K.totPnts||8;var J=K.errMsgCont;var C=K.strngthIndicator;var E=K.ratingCont;var D=K.initialRating||"Too Weak";var L=K.fireEvaluation.maxPswdLen;var F=K.fireEvaluation.minPswdLen;var M="";var I=-1;var G=function(T,V,S,W){var U=(T/Q)*100;C.className=S;O.setStyle(C,"width",U+"%");E.className=W;if(V.length>0){V="<span class='hiddenMessage'>Password Strength:</span>"+V}E.innerHTML=V};var N=function(T,S){J.innerHTML=S};var A=function(V,a,Z,T){var c=a.length;var Y="";for(var X=0;X<c;X++){var U=a[X].true_if;var W=a[X].regExFun;var b=W=="test"?(U.test(T)):b;b=W=="match"?((T.match(U)).length>=a[X].result):b;if(W=="externalEvalFn"){var S=a[X].externalEvalFn(T);b=typeof (S)!="boolean"?S.passFlag:S;S.msgOutput?a[X].fail_message=S.msgOutput:null}if(b){V+=a[X].points}else{Z?null:Z=a[X].fail_message+"<br/>";a[X].errorMsg?Y+="<span class='messageError'>"+a[X].errorMsg+"</span><br/>":Y=Y}M=Y}return{finalPoints:V,msgOutput:Z}};var R=function(){clearTimeout(I);I=setTimeout(P,200)};var P=function(){var Z=O.get(K.fireEvaluation.fieldId);var S=0;var X="";var U=1;var a=B.length;var V;var W=0;if((Z.value).length>0){for(var T=0;T<a;T++){V=B[T][0].totalPoints;S=0;var Y=A(S,B[T],X,Z.value);X=Y.msgOutput;S=Y.finalPoints;W+=V;if(S===V){G(W,B[T][0].rating,"greenStatus slider","greenStatusTxt fl")}else{T-1<0?G(S,D,"redStatus slider","redStatusTxt fl"):G(W-(V-S),B[T-1][0].rating,"greenStatus slider","greenStatusTxt fl")}N("",X);if(X){break}}}else{G(0,"","redStatus slider","redStatusTxt fl");N("","")}};K.fireEvaluation?H.addListener(K.fireEvaluation.fieldId,K.fireEvaluation.eventType,R):null;K.fireEvaluation&&K.fireEvaluation.blurFlag?H.addListener(K.fireEvaluation.fieldId,"blur",function(S){M&&(this.value).length>0?N(S,M):null}):null};USAA.ec.PassStrngthDefltRulesConfig=[[{true_if:new RegExp("^[^A-Z]"),points:0,regExFun:"test",result:true,fail_message:"<span class='messageError'>Your password cannot start with an uppercase letter.</span>",errorMsg:"",required:true,rating:"Good",totalPoints:4},{true_if:new RegExp("^[^A-Z].*[A-Z]"),points:1,regExFun:"test",result:true,fail_message:"Tip: <strong>You need to have at least 1 uppercase character</strong> and it may not be at the start.",errorMsg:"Your password must contain, but not start with an uppercase letter.",required:true,rating:"Good",totalPoints:4},{true_if:true,points:1,regExFun:"externalEvalFn",result:true,externalEvalFn:function(C){var A=C.length;var D=8-A;var E=A<8?"Tip: <strong>Add at least "+D+" more characters</strong> to your password.<br/>":"";var B=E?{passFlag:false,msgOutput:E}:{passFlag:true};return B},errorMsg:"Your password must be between 8-12 characters.",required:true,rating:"Good",totalPoints:4},{true_if:new RegExp("[a-z]"),points:1,regExFun:"test",result:true,fail_message:"Tip: <strong>Add a lowercase letter</strong> to your password.",errorMsg:"Your password must contain a lowercase letter.",required:true,rating:"Good",totalPoints:4},{true_if:new RegExp("[0-9].*[^0-9]$"),points:1,regExFun:"test",result:true,fail_message:"Tip: <strong>You need to have at least 1 number</strong> and it may not be at the end.",errorMsg:"Your password must contain, but not end with a number.",required:true,rating:"Good",totalPoints:4}],[{true_if:new RegExp("[^A-Za-z0-9s]"),points:1,regExFun:"test",result:true,fail_message:"Tip: <strong>Use a special character</strong> (such as &, >, @ or !) to make your password stronger.",required:true,rating:"Strong",totalPoints:1}],[{true_if:new RegExp(/[A-Z]{1}/g),regExFun:"match",result:2,points:0.5,fail_message:"Tip: <strong>Use two uppercase and two lowercase letters</strong> to make your password stronger.",required:true,rating:"Superior",totalPoints:3},{true_if:new RegExp(/[a-z]{1}/g),regExFun:"match",result:2,points:0.5,fail_message:"Tip: <strong>Use two uppercase and two lowercase letters</strong> to make your password stronger.",required:true,rating:"Superior",totalPoints:3},{true_if:new RegExp(".{10}"),regExFun:"test",result:true,points:1,fail_message:"Tip: <strong>Use 10 or more characters</strong> to make your password stronger.",required:true,rating:"Superior",totalPoints:3},{true_if:new RegExp(/[^A-Za-z0-9\s]{1}/g),points:1,regExFun:"externalEvalFn",result:2,fail_message:"Tip: <strong>Use at least two different special characters</strong> (such as &, >, @ or !) to make your password stronger.",required:true,rating:"Superior",totalPoints:3,externalEvalFn:function(D){var B=D.match(new RegExp(/[^A-Za-z0-9\s]{1}/g));var E=B.length;for(var C=0;C<E;C++){for(var A=C;A<E;A++){if(B[C]!=B[A]){return true}}}return false}}]];