var usaa=usaa||{};usaa.ent=usaa.ent||{};usaa.ent.social=usaa.ent.social||{};usaa.ent.social.share=usaa.ent.social.share||{};usaa.ent.social.share.socialamp=usaa.ent.social.share.socialamp||{};usaa.ent.social.share.socialamp.UsaaSocialSharebar=function(){var A=null;parentThis=this;this.initializeSharebar=function(E){B("https://content.usaa.com/mcontent/static_assets/Includes/socialMediaBar_redesign.css");if(window.addEventListener){window.addEventListener("load",F,false)}else{if(window.attachEvent){window.attachEvent("onload",F)}}function F(){var G;if(typeof (YUI)==="undefined"){G=C("https://s.usaa.com/inet/resources/aggregator?type=-min&fv=3.0&embed=true&k_3.16.0_yui");G.onload=function(){D()}}else{D()}}function D(){var G=C("/javascript/ent/ent_core.js");G.onload=function(){C("/javascript/ent/services_client/Md5Util.js");C("/javascript/ent/services_client/UsaaServiceRequest.js");C("/javascript/ent/services_client/UsaaServiceResponse.js");C("/javascript/ent/services_client/UsaaServiceClientUtilities.js");C("/javascript/ent/services_client/UsaaServiceClientManager.js");C("/javascript/ent/services_client/UnifiedMessage.js");C("/javascript/ec/utilities/ASIClient.js");parentThis.createSharebar(E)}}function C(G){var H=document.createElement("script");H.setAttribute("type","text/javascript");H.setAttribute("language","javascript");H.setAttribute("src",G);document.getElementsByTagName("head")[0].appendChild(H);return H}function B(G){var H=document.createElement("link");H.setAttribute("rel","stylesheet");H.setAttribute("type","text/css");H.setAttribute("href",G);document.getElementsByTagName("head")[0].appendChild(H)}};this.createSharebar=function(C){var B=C;YUI.GlobalConfig={filter:"raw",combine:true,comboBase:"https://s.usaa.com/inet/resources/aggregator?type=-min&fv=3.0&",root:"p_/javascript/ent/thirdparty/yui/yui3_16_0/",maxURLLength:"10000"};YUI().use("node","event","json-stringify","io","dump","json-parse","panel",function(E){var G=B.consoleLogEnabled;var P="";var a=B.sharebarconfig;var N=B.lob;var L=B.baseUSAAURL;var b=B.contentConfigId;if(G===undefined){G=false}if(L===undefined){L=window.location.protocol+"//"+window.location.hostname}else{if(L===""){L=window.location.protocol+"//"+window.location.hostname}}K("externalLinkPath = "+L);K("sharebarconfig = "+a);K("lob = "+N);var D=function(j,Y){K("SocialShareWidgetView constructor called...");this.id=j;this.model=Y;return this};var d=function(j,l){var Y=this;var k=window.location.href;this.openWindow=function(n,o){K(j+" window openWindow START");var p=this.getParams();var m=Y;YUI().use("node",function(q){if(q.UA.mobile){window.open(L+"/inet/ent_social_shareWEB/?"+p)}else{m.popUp(L+"/inet/ent_social_shareWEB/?"+p,n,o)}});K(j+" window openWindow END")};this.getParams=function(){var o=l.imageUrl;var u=l.title;var q=l.shareRedirectURLDescription;var m=l.shareRedirectURL;if(m==="http://www.usaa.com"||m==="https://www.usaa.com"||m==="https://mobile.usaa.com"||m==="http://mobile.usaa.com"||m===""){m=window.location.href}var n="network="+j+"&mMediaUrl="+o+"&mTitle="+u+"&mDesc="+q+"&url="+encodeURIComponent(m);var t=l.contentData;var r=null;if(t===null||t.length===0){return n}for(var p=0;p<t.length;p++){var s=t[p];if(j===s.domainId){r=s;break}}if(r!==null){if(j==="email"){n=n+"&emailSubject="+r.emailSubject;n=n+"&emailContentTxt="+r.emailContentTxt;n=n+"&emailTemplateId="+r.emailTemplateId}else{n=n+"&mMessage="+r.message}}return n};this.popUp=function(n,m,o){var r=(screen.width/2)-(o/2);var q=(screen.height/2)-(m/2);var p=window.open(n,"","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+o+", height="+m+", top="+q+", left="+r);return p};return this};var F=function(){this.render=function(j){var Y=E.Node.create("<div>").set("id","linkContainer");var k="wa_ref=sb_share_copy";var l=window.location.href;var n="?";var o;var m;var p;var q;if(j&&E.Lang.trim(j)!==""){l=E.Lang.trim(j)}if(l.indexOf(n)>-1){n="&"}if(l){l=l+n+k}o=E.Node.create("<input>").set("id","copyLinkTextbox").set("type","text").set("value",l);m=E.Node.create("<span>").set("id","textCopyLabel").setHTML("Right click to copy link to your clip board.");o.on("click",function(){o.focus();o.select()});o.on("blur",function(){var r=o.value;if(l!==r){o.set("value",l)}});o.on("copy",function(r){W("copylink")});Y.append(m);Y.append(o);p=E.one("#copylink");q=h(p.getDOMNode());Y.setAttribute("style","position:absolute; left:"+(q.x-400)+"px;top:"+(q.y+30)+"px;");E.one("body").insert(Y);Y.hide()};this.toggle=function(){var Y=E.one("#linkContainer");var j=Y.getAttribute("hidden")==="true";Y.toggleView();if(!j){var k=E.one("#copyLinkTextbox");k.focus();k.select()}};this.selectAll=function(){var Y=E.one("#copyLinkTextbox");Y.focus();Y.select()};return this};D.prototype.render=function(o){this.linkView=null;o=J(o);if(o==="render_widget"){K("View Creation: START");var m=E.one("#usaa_social_share_bar");m.setHTML(this.renderSocialSharingBar());return }var j=true;var k=true;YUI().use("node",function(s){var r=s.one("#"+o);var q=r.hasClass("socialNetworkIcon");j=(!r.hasClass("disabled"))&&q;var p=s.one("#vbarContainer");if(!s.UA.mobile&&p!==null){k=p.getDOMNode().style.display==="none"}});if(o==="more"){i(A.socialShareBarConfig,k)}else{if(o==="copylink"&&j){var n=A.socialShareContentConfig.shareRedirectURL;var l=S()["lookAndFeel"];if(l==="iPhoneApp"||l==="androidApp"||l==="iPadApp"||l==="Android"){window.location=L+"/inet/ent_social_shareWEB/?wa_ref=sb_share_copy&action=copy&sharedURL="+n}else{if(this.linkView===null){this.linkView=new F();this.linkView.render(n)}this.linkView.toggle();window.onresize=function(){var q=E.one("#copylink");var p=h(q.getDOMNode());var r=E.one("#linkContainer");r.setAttribute("style","position:absolute; left:"+(p.x-400)+"px;top:"+(p.y+30)+"px;")}}}else{if(j){K("Window "+o+" Initialize");var Y=new d(o,A.socialShareContentConfig);Y.openWindow(400,580);delete Y}}}};D.prototype.renderSocialSharingBar=function(){K("Social Share Widget View : Output function called");if(this.model.socialShareBarConfig.isVisible){if(E.UA.mobile){return H(this.model.socialShareBarConfig)}else{return Q(this.model.socialShareBarConfig)}}};var c=function(Y){K("Model Creation: Started");this.socialShareBarConfig=null;this.socialShareContentConfig=null;if(Y==="render_widget"){K("Model Creation: Data required for rendering the widget");if(typeof (P.customLayout)!=="undefined"){this.socialShareBarConfig=P.customLayout}else{this.socialShareBarConfig=P.defaultLayout}var o=P.customContent;var v=P.defaultContent;var w=null;var m=null;var n=null;var q=document.getElementsByTagName("meta");for(var l=0;l<q.length;l++){var r=q[l].getAttribute("name");var t=q[l].getAttribute("content");if(r===null||r===""||t===null||t===""){continue}var u=r.toString();var p=t.toString();if(u==="title"){w=p}else{if(u==="description"){m=p}else{if(u==="image"){n=p}}}}function k(){if(w!==null){return w}else{return v.title}}function s(){if(m!==null){return m}else{return v.shareRedirectURLDescription}}function j(){if(n!==null){return n}else{return v.imageUrl}}if(o!==undefined){this.socialShareContentConfig=o;if(o.title===null){this.socialShareContentConfig.title=k()}if(o.shareRedirectURLDescription===null){this.socialShareContentConfig.shareRedirectURLDescription=s()}if(o.imageUrl===null){this.socialShareContentConfig.imageUrl=j()}}else{this.socialShareContentConfig=v;this.socialShareContentConfig.title=k();this.socialShareContentConfig.shareRedirectURLDescription=s();this.socialShareContentConfig.imageUrl=j()}}K("Model Creation: Completed.");return this};var X=function(){return this};X.prototype.processRequest=function(j){K("SocialShareWidgetController.prototype.processRequest invoked...");if(A===null){A=new c(j)}var Y=new D(j,A);Y.render(j,A)};function O(j){var l=window.location.search.substr(1).split("&");for(var Y=0;Y<l.length;Y++){var k=l[Y].split("=");if(k[0]===j){return decodeURIComponent(k[1])}}return false}function H(AI){var m=null;var s=null;var j=null;var y=null;var x=null;var AC=null;var q=null;var AF=null;var AG=null;var w=null;if(AI.isVisible){m=E.Node.create("<div>").set("id","sharebar-mobile");shareIconsContainer=E.Node.create("<span>").set("id","shareIconsContainer-mobile");shareIcons=E.Node.create("<span>").set("id","shareIcons");moreIcons=E.Node.create("<span>").set("id","moreIcons")}else{K("Sharebar visibility is set to false.");return null}var AH=AI.displayIcons;var o=AI.menuIcons;var t=o.length>0;function n(AK,AL){return AK.priority-AL.priority}AH.sort(n);o.sort(n);var k=AH.length;for(var AA=0;AA<k;AA++){if(!AH[AA].isVisible){continue}var AE=E.Node.create("<a>").set("id",AH[AA].domainId).set("href","javascript:;");AE.addClass("socialNetworkIcon");AE.append(I("USAA Share article via "+AH[AA].domainId+"(Opens new window)"));if(AA===k-1){AE.setAttribute("style","margin-right: 0px;")}shareIcons.append(AE);K("Visible icon["+AA+"], priority="+AH[AA].priority+", id="+AH[AA].domainId);delete AE}if(t){AC=E.Node.create("<div>").set("id","vbarContainer-mobile");var l=E.Node.create("<div>").set("id","vbar-mobile-header").set("text","Share To");var v=o.length;var u=(v)*42;var p="height:"+(u+30)+"px";AC.setAttribute("style",p);s=E.Node.create("<div>").set("id","vbar-mobile");s.insert(l);for(var AA=0;AA<v;AA++){var z=E.Node.create("<div>").set("id","moreHldr-"+o[AA].domainId);var AB=E.Node.create("<div>").set("id","moreLbl-"+o[AA].domainId);AB.set("className","holderLbl-mobile");AB.set("text",o[AA].labelName);if(AA<v-1){AB.addClass("vbar-holder-divider")}var AE=E.Node.create("<a>").set("id",o[AA].domainId).set("href","javascript:;");AE.append(I("USAA Share article via "+AH[AA].domainId+"(Opens new window)"));AE.addClass("socialNetworkIcon");K("More icon["+AA+"], priority="+o[AA].priority+", id="+o[AA].domainId);z.append(AE);z.append(AB);s.append(z);delete AE}var AJ=E.Node.create("<a>").set("id","more").set("href","javascript:;");AJ.setAttribute("style","margin-right: 0px; margin-left: 5px;");AJ.append(I("USAA Show more Social Medias"));shareIcons.insert(AJ);AC.insert(s);E.one("body").insert(AC);shareIconsContainer.insert(moreIcons)}shareIconsContainer.insert(shareIcons);m.insert(shareIconsContainer);var AD=AI.isShareCountVisible;var r=AI.isViewCountVisible;var Y=false;if(AD||r||Y){j=E.Node.create("<div>").set("id","countContainer");if(AD){K("jsonShareCount="+AI.shareCount);x=E.Node.create("<span>").set("id","shareLbl");x.setHTML(AI.shareLabelTxt);j.insert(x)}if(r){K("jsonViewCount="+AI.viewCount);q=E.Node.create("<span>").set("id","viewCount");AF=E.Node.create("<span>").set("id","viewLbl");AF.setHTML(AI.viewLabelTxt);j.insert(q);j.insert(AF)}if(Y){K("jsonViewCount="+AI.likeCount);AG=E.Node.create("<span>").set("id","likeCount");w=E.Node.create("<span>").set("id","likeLbl");w.setHTML(AI.likeLabelTxt);j.insert(AG);j.insert(w)}m.insert(j)}this.ModalPanel=new E.Panel({srcNode:"#vbarContainer-mobile",headerContent:"",width:"80%",modal:true,centered:true,render:true,visible:false,hideOn:[{eventName:"clickoutside"},{node:E.one("#vbarContainer-mobile"),eventName:"click"}]});E.one(".yui3-panel .yui3-widget-hd").removeClass("yui3-widget-hd");E.one(".yui3-panel div div .yui3-widget-buttons").get("childNodes").each(function(AK){AK.remove()});return m}function Q(AH){var l=null;var r=null;var x=null;var w=null;var AB=null;var j=null;var p=null;var AE=null;var AF=null;var v=null;if(AH.isVisible){l=E.Node.create("<div>").set("id","sharebar");shareIconsContainer=E.Node.create("<span>").set("id","shareIconsContainer");shareIcons=E.Node.create("<span>").set("id","shareIcons");moreIcons=E.Node.create("<span>").set("id","moreIcons")}else{K("Sharebar visibility is set to false.");return null}var AG=AH.displayIcons;var n=AH.menuIcons;var s=n.length>0;function m(AJ,AK){return AJ.priority-AK.priority}AG.sort(m);n.sort(m);var k=AG.length;for(var z=0;z<k;z++){if(!AG[z].isVisible){continue}var AD=E.Node.create("<a>").set("id",AG[z].domainId).set("href","javascript:;");AD.addClass("socialNetworkIcon");AD.append(I("USAA Share article via "+AG[z].domainId+"(Opens new window)"));if(z===k-1){AD.setAttribute("style","margin-right: 0px;")}shareIcons.append(AD);K("Visible icon["+z+"], priority="+AG[z].priority+", id="+AG[z].domainId);delete AD}if(s){var AI=E.Node.create("<a>").set("id","more").set("href","javascript:;");AI.append(I("USAA Show more Social Medias"));AI.setAttribute("style","margin-right: 0px; margin-left: 5px;");shareIcons.append(AI);AB=E.Node.create("<div>").set("id","vbarContainer");var u=n.length;var t=u*42;var o="height:"+t+"px";AB.setAttribute("style",o);r=E.Node.create("<div>").set("id","vbar");for(var z=0;z<u;z++){var y=E.Node.create("<div>").set("id","moreHldr-"+n[z].domainId);var AA=E.Node.create("<div>").set("id","moreLbl-"+n[z].domainId);AA.set("className","holderLbl");AA.set("text",n[z].labelName);var AD=E.Node.create("<a>").set("id",n[z].domainId).set("href","javascript:;");AD.addClass("socialNetworkIcon");AD.append(I("USAA Share article via "+AG[z].domainId+"(Opens new window)"));K("More icon["+z+"], priority="+n[z].priority+", id="+n[z].domainId);if(z<u-1){y.addClass("vbar-holder-divider")}y.append(AD);y.append(AA);r.append(y);delete AD}AB.insert(r);moreIcons.insert(AB);shareIconsContainer.insert(moreIcons);AB.hide();AI.show()}var AC=AH.isShareCountVisible;var q=AH.isViewCountVisible;var Y=false;if(AC||q||Y){shareCountContainer=E.Node.create("<div>").set("id","shareCountContainer");if(AC){K("jsonShareCount="+AH.shareCount);w=E.Node.create("<div>").set("id","shareLbl");w.setHTML(AH.shareLabelTxt);shareCountContainer.insert(w)}if(q){K("jsonViewCount="+AH.viewCount);p=E.Node.create("<div>").set("id","viewCount");AE=E.Node.create("<div>").set("id","viewLbl");AE.setHTML(AH.viewLabelTxt);shareCountContainer.insert(p);shareCountContainer.insert(AE)}if(Y){K("jsonViewCount="+AH.likeCount);AF=E.Node.create("<div>").set("id","likeCount");v=E.Node.create("<div>").set("id","likeLbl");v.setHTML(AH.likeLabelTxt);shareCountContainer.insert(AF);shareCountContainer.insert(v)}l.insert(shareCountContainer)}shareIconsContainer.insert(shareIcons);l.insert(shareIconsContainer);l.insert(j);return l}function I(Y){var j=E.Node.create("<span>");j.addClass("soc-hidden hiddenMessage");j.append(Y);return j}function i(Y,j){YUI().use("event-mouseenter","transition","panel",function(p){if(p.UA.mobile){this.ModalPanel.show().centered()}else{var l=Y.displayIcons;var m=l.length;var n=j?"disabled":"enabled";var o=j?"enabled":"disabled";for(var k=0;k<m;k++){if(!l[k].isVisible){continue}p.one("#"+l[k].domainId).removeClass(o);p.one("#"+l[k].domainId).addClass(n)}if(j){p.one("#vbarContainer").show()}else{p.one("#vbarContainer").hide()}}})}function K(Y){if(G){window.console&&console.log(Y)}}function h(Y){var k=0;var j=0;while(Y){k+=(Y.offsetLeft-Y.scrollLeft+Y.clientLeft);j+=(Y.offsetTop-Y.scrollTop+Y.clientTop);Y=Y.offsetParent}return{x:k,y:j}}this.onResize=function(){window.onresize=function(){var j=E.one("#copylink");var Y=h(j.getDOMNode());var k=E.one("#linkContainer");k.setAttribute("style","position:absolute; left:"+(Y.x-400)+"px;top:"+(Y.y+30)+"px;");K("onResize() invoked...")}};function W(j){var m=window.location.href;var n=undefined;if(b===undefined){n=A.socialShareContentConfig.shareRedirectURL}else{n=b}if(n==="http://www.usaa.com"||n==="https://www.usaa.com"||n==="https://mobile.usaa.com"||n==="http://mobile.usaa.com"||n===""){n=window.location.href}var o="share";var k=j;var l="Copy Link";var q="share_success";var p=A.socialShareContentConfig.title;var r="Copy Link";var Y='{"socialLocationName":"'+m+'","socialContentConfigId":"'+n+'","socialActionName":"'+o+'","socialActionDomain":"'+k+'","socialActivityTypeCd":"'+l+'","socialActivityStatus":"'+q+'","title":"'+p+'","message":"'+r+'"}';Z("createSocialBarActivity","1",Y)}function Z(m,j,l){K("ASI "+m+" Start");var k="/inet/ent_social_shareWEB/ShareBarService";if(L!==""&&L!==undefined){k=L+k}var Y=USAA.ec.util.ASIClient.processRequest(this,"ShareBarService",k,m,l,"");return Y}this.onSuccessResponse=function(l,m){if(typeof m!==undefined&&m!==null){var k=m.returnCode;if(k!==0){var j="";if(m.displayMessages){j=m.displayMessages[0].msgText}else{j=GLOBAL_ERROR_MESSAGE}}else{var Y=l.operationName;if(Y==="retrieveSocialBar"){P=m.responseObject;K("Response Object is "+P);responseJson=E.JSON.stringify(P);K(responseJson);f();M("usaa_social_share_bar");M("vbarContainer-mobile")}else{if(Y==="createSocialBarActivity"){K("createSocialBarActivity success")}}K("Operation "+Y+" Successful");K("ASI "+Y+" End")}}};this.onFailureResponse=function(j,Y){K("Failed to fetch ERDC data from ASI");K(Y)};function f(){var Y=new X;Y.processRequest("render_widget")}var V=a;var g=window.location.href;if(b!==undefined){g=b}var R=window.location.href;var T='{"socialLayoutConfigId":"'+V+'","socialContentConfigId":"'+g+'","socialLocationName":"'+R+'"}';Z("retrieveSocialBar","1",T);function M(j){var Y=E.one("#"+j);if(Y===null){E.on("available",function(){U(e)},"#"+j)}else{Y.on("click",function(k){U(k)})}}function U(k){K(k);K("Clicked image id:: "+k.target.get("id"));var j=k.target.get("id");if(j===null||""===j){return }var Y=new X;Y.processRequest(j)}function J(j){if(j.indexOf("moreHldr")>=0){var Y=j.split("-");return Y[1].trim()}else{if(j.indexOf("moreLbl")>=0){var Y=j.split("-");return Y[1].trim()}else{return j}}}function S(){var l=[],k;var Y=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var j=0;j<Y.length;j++){k=Y[j].split("=");l.push(k[0]);l[k[0]]=k[1]}return l}})};return this};