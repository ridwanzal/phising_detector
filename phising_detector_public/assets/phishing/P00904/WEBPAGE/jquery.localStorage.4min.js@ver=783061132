(function(C){function E(F,G){this.origin=F;this.path=G;this._iframe=null;this._iframeReady=false;this._queue=[];this._requests={};this._id=0}E.prototype={constructor:E,init:function(){var F=this;if(!this._iframe){if(window.postMessage&&window.JSON&&window.localStorage){this._iframe=document.createElement("iframe");this._iframe.style.cssText="position:absolute;width:1px;height:1px;bottom:10px;border:0;opacity:0;";document.body.appendChild(this._iframe);if(window.addEventListener){this._iframe.addEventListener("load",function(){F._iframeLoaded()},false);window.addEventListener("message",function(G){F._handleMessage(G)},false)}else{if(this._iframe.attachEvent){this._iframe.attachEvent("onload",function(){F._iframeLoaded()},false);window.attachEvent("onmessage",function(G){F._handleMessage(G)})}}}else{throw new Error("Unsupported browser.")}}this._iframe.src=this.origin+this.path},requestValue:function(G,J,F,K){var H={key:G,value:J,id:++this._id,operation:F},I={request:H,callback:K};if(this._iframeReady){this._sendRequest(I)}else{this._queue.push(I)}if(!this._iframe){this.init()}},_sendRequest:function(F){this._requests[F.request.id]=F;this._iframe.contentWindow.postMessage(JSON.stringify(F.request),this.origin)},_iframeLoaded:function(){this._iframeReady=true;if(this._queue.length){for(var G=0,F=this._queue.length;G<F;G++){this._sendRequest(this._queue[G])}this._queue=[]}},_handleMessage:function(F){if(this.origin.indexOf(F.origin)==0){var G=JSON.parse(F.data);if(G.messageType=="CrossDomainStorage"){this._requests[G.id].callback(G.key,G.value);delete this._requests[G.id]}}}};var B=true;var A=null;if(typeof localStorage==="undefined"||typeof localStorage==="unknown"||typeof JSON==="undefined"){B=false}else{A=window.localStorage}var D=null;if(B){D=new E((Config.mainSiteUrlHttpsPath||"/"),"js/plugins/cross_domain_storage/server.jsp")}this.supportsLS=function(){return B};this.setItem=function(F,G,H){if(!B){return false}if(H){D.requestValue(F,G,"set",H)}else{A.setItem(F,JSON.stringify(G));return G}return true};this.getItem=function(F,G){if(!B){return false}if(G){D.requestValue(F,null,"get",G)}else{return JSON.parse(A.getItem(F))}return true};this.removeItem=function(F,H){if(!B){return false}if(H){D.requestValue(F,null,"remove",H)}else{var G=JSON.parse(A.getItem(F));A.removeItem(F);return G}return true};this.clearAll=function(F){if(!B){return false}if(F){D.requestValue(null,null,"clear",F)}else{A.clear()}return true};jQuery.localStorage=this})(jQuery);